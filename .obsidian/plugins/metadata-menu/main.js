/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __reflectGet = Reflect.get;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __superGet = (cls, obj, key) => __reflectGet(__getProtoOf(cls), key, obj);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetadataMenu
});
module.exports = __toCommonJS(main_exports);
var import_obsidian68 = require("obsidian");

// src/commands/paletteCommands.ts
var import_obsidian49 = require("obsidian");

// src/components/NoteFields.ts
var import_obsidian44 = require("obsidian");

// src/fileClass/FileClassAttributeModal.ts
var import_obsidian35 = require("obsidian");

// src/fields/fieldManagers/InputField.ts
var import_obsidian10 = require("obsidian");

// src/modals/fields/InputModal.ts
var import_obsidian4 = require("obsidian");

// src/commands/postValues.ts
var import_obsidian2 = require("obsidian");

// src/utils/fileUtils.ts
var import_obsidian = require("obsidian");
function resolve_tfolder(plugin, folder_str) {
  folder_str = (0, import_obsidian.normalizePath)(folder_str);
  const folder = plugin.app.vault.getAbstractFileByPath(folder_str);
  if (!folder) {
    throw new Error(`Folder "${folder_str}" doesn't exist`);
  }
  if (!(folder instanceof import_obsidian.TFolder)) {
    throw new Error(`${folder_str} is a file, not a folder`);
  }
  return folder;
}
function get_tfiles_from_folder(plugin, folder_str) {
  const folder = resolve_tfolder(plugin, folder_str);
  const files = [];
  import_obsidian.Vault.recurseChildren(folder, (file) => {
    if (file instanceof import_obsidian.TFile) {
      files.push(file);
    }
  });
  files.sort((a, b) => {
    return a.basename.localeCompare(b.basename);
  });
  return files;
}
function getFileFromFileOrPath(plugin, fileOrFilePath) {
  let file;
  if (fileOrFilePath instanceof import_obsidian.TFile) {
    file = fileOrFilePath;
  } else {
    const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
    if (_file instanceof import_obsidian.TFile && _file.extension == "md") {
      file = _file;
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
  }
  return file;
}

// src/utils/list.ts
function getListBounds(plugin, file, parent) {
  var _a;
  const listItems = ((_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.listItems) || [];
  return getListBoundsFromListItemCacheList(listItems, parent);
}
function getListBoundsFromListItemCacheList(listItems, parent) {
  const subParentsLines = [-parent - 1];
  let start2 = parent;
  let end2 = -1;
  let outOfList = false;
  listItems.sort((a, b) => a.position.start.line - b.position.start.line).forEach((listItem) => {
    if (subParentsLines.includes(listItem.parent) && !outOfList) {
      subParentsLines.push(listItem.position.start.line);
      if (start2 > listItem.position.start.line)
        start2 = listItem.position.start.line;
      if (end2 <= listItem.position.end.line) {
        if (listItem.position.end.line == listItem.position.start.line) {
          end2 = listItem.position.end.line;
        } else {
          end2 = listItem.position.start.line;
          outOfList = true;
        }
      }
    }
  });
  if (end2 >= 0) {
    return { start: start2, end: end2 };
  }
  return;
}

// src/types/lookupTypes.ts
var BuiltinSummarizing = /* @__PURE__ */ ((BuiltinSummarizing2) => {
  BuiltinSummarizing2["Sum"] = "Sum";
  BuiltinSummarizing2["Count"] = "Count";
  BuiltinSummarizing2["CountAll"] = "CountAll";
  BuiltinSummarizing2["Average"] = "Average";
  BuiltinSummarizing2["Max"] = "Max";
  BuiltinSummarizing2["Min"] = "Min";
  return BuiltinSummarizing2;
})(BuiltinSummarizing || {});
var BuiltinSummarizingFunctionDescription = {
  "Sum": "Returns the sum of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Count": "Counts all pages matching the query where <{{summarizedFieldName}}> is non empty",
  "CountAll": "Counts all pages matching the query (including empty fields)",
  "Average": "Returns the average value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Max": "Returns the maximum value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Min": "Returns the minimum value of <{{summarizedFieldName}}> fields in the pages matching the query"
};
var BuiltinSummarizingFunction = {
  "Sum": 'const i=0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum',
  "CountAll": "return pages.length",
  "Count": 'return pages.filter(p => !!p["{{summarizedFieldName}}"]).length',
  "Average": 'const i=0.0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum / pages.length',
  "Max": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"] >= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]',
  "Min": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"]!==null && p["{{summarizedFieldName}}"] <= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]'
};
var Type = /* @__PURE__ */ ((Type3) => {
  Type3["LinksList"] = "LinksList";
  Type3["LinksBulletList"] = "LinksBulletList";
  Type3["BuiltinSummarizing"] = "BuiltinSummarizing";
  Type3["CustomList"] = "CustomList";
  Type3["CustomBulletList"] = "CustomBulletList";
  Type3["CustomSummarizing"] = "CustomSummarizing";
  return Type3;
})(Type || {});
var ShortDescription = {
  "LinksList": "Inline list of links",
  "LinksBulletList": "Bullet list of links",
  "BuiltinSummarizing": "",
  "CustomList": "Inline list of customized links",
  "CustomBulletList": "Bullet list of customized links",
  "CustomSummarizing": "Custom summarizing function"
};
var Description = {
  "LinksList": "List of related links displayed inline",
  "LinksBulletList": "List of related links displayed below the field",
  "BuiltinSummarizing": "Built-in summarizing function",
  "CustomList": "Custom list rendering function displayed inline",
  "CustomBulletList": "Custom list rendering function displayed below the field",
  "CustomSummarizing": "Custom summarizing function"
};
var OptionLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Built-in summarize function:",
  "CustomList": "Query's results' list's rendering function:",
  "CustomBulletList": "Query's results' list's rendering function:",
  "CustomSummarizing": "Query's results' list's summarizing function:"
};
var OptionSubLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": `function(page) { return <function using "page">; }`,
  "CustomBulletList": `function(page) { return <function using "page">; }`,
  "CustomSummarizing": `function(page) { return <function using "page">; }`
};
var Helper = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomBulletList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomSummarizing": 'Javascript string, the "pages" (dataview pages type) variable is available\nexample: \nconst initialValue = 0;\nconst sumWithInitial = pages.reduce(\n    (previousValue, currentValue) => previousValue + currentValue,\n    initialValue\n);\nreturn `${sumWithInitial}`\n'
};
var Default = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Count" /* Count */,
  "CustomList": "page.file.name",
  "CustomBulletList": "page.file.name",
  "CustomSummarizing": "return pages.length"
};
var bulletListLookupTypes = [
  "LinksBulletList" /* LinksBulletList */,
  "CustomBulletList" /* CustomBulletList */
];

// src/utils/parser.ts
var fieldComponents = ["inQuote", "inList", "preSpacer", "startStyle", "attribute", "endStyle", "beforeSeparatorSpacer", "afterSeparatorSpacer", "values"];
var genericFieldRegex = "(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<preSpacer>(\\s+)?)?(?<startStyle>[_\\*~`]*)(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*)(?<endStyle>[_\\*~`]*)(?<beforeSeparatorSpacer>\\s*)";
var inlineFieldRegex = (attribute) => `(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<preSpacer>(\\s+)?)?(?<startStyle>[_\\*~\`]*)(?<attribute>${attribute})(?<endStyle>[_\\*~\`]*)(?<beforeSeparatorSpacer>\\s*)::(?<afterSeparatorSpacer>\\s*)`;
var fullLineRegex = new RegExp(`^${genericFieldRegex}::\\s*(?<values>.*)?`, "u");
var inSentenceRegexBrackets = new RegExp(`\\[${genericFieldRegex}::\\s*(?<values>[^\\]]+)?\\]`, "gu");
var inSentenceRegexPar = new RegExp(`\\(${genericFieldRegex}::\\s*(?<values>[^\\)]+)?\\)`, "gu");
var encodeLink = (value) => {
  return value ? value.replace(/\[\[/g, "\u{1F527}\u{1F400}").replace(/\]\]/g, "\u{1F413}\u{1F54C}") : value;
};
var decodeLink = (value) => {
  return value ? value.replace(/ðŸ”§ðŸ€/gu, "[[").replace(/ðŸ“ðŸ•Œ/gu, "]]") : value;
};
var frontMatterLineField = (line) => {
  const frontMatterRegex = new RegExp(new RegExp("(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*[^\\s])(?<beforeSeparatorSpacer>\\s*):(?<afterSeparatorSpacer>\\s*)(?<values>.*)", "u"));
  const fR = line.match(frontMatterRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    return attribute;
  }
};
var getLineFields = (line) => {
  const fields = [];
  const fR = line.match(fullLineRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    fields.push({ attribute, values, index: 0, length: line.length });
  } else {
    const sRBk = encodeLink(line).matchAll(inSentenceRegexBrackets);
    let next = sRBk.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBk.next();
    }
    const sRBc = encodeLink(line).matchAll(inSentenceRegexPar);
    next = sRBc.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBc.next();
    }
  }
  fields.sort((a, b) => {
    if (a.index < b.index)
      return -1;
    if (a.index > b.index)
      return 1;
    return 0;
  });
  return fields;
};

// src/utils/dataviewUtils.ts
function genuineKeys(dvFile) {
  const genuineKeys2 = [];
  Object.keys(dvFile).forEach((key) => {
    if (!genuineKeys2.map((k) => k.toLowerCase().replace(/\s/g, "-")).includes(key.toLowerCase().replace(/\s/g, "-"))) {
      genuineKeys2.push(key);
    } else {
      if (key !== key.toLowerCase().replace(/\s/g, "-")) {
        genuineKeys2[genuineKeys2.indexOf(key.toLowerCase().replace(/\s/g, "-"))] = key;
      }
    }
  });
  return genuineKeys2;
}
function compareDuration(dvDurA, dvDurB) {
  const normalizedA = dvDurA.shiftTo("years", "months", "weeks", "days", "hours", "minutes", "seconds", "milliseconds").normalize();
  const normalizedB = dvDurB.shiftTo("years", "months", "weeks", "days", "hours", "minutes", "seconds", "milliseconds").normalize();
  return normalizedA.equals(normalizedB);
}

// src/commands/postValues.ts
var LocationWrapper = {
  "fullLine": { start: "", end: "" },
  "brackets": { start: "[", end: "]" },
  "parenthesis": { start: "(", end: ")" }
};
function renderField(plugin, file, fieldName, rawValue, location) {
  var _a;
  const field = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName);
  const parseFieldValue = (_rawValue) => {
    if (_rawValue) {
      if (_rawValue.startsWith("[[")) {
        return `"${_rawValue}"`;
      } else if (_rawValue.startsWith("#")) {
        return `${_rawValue}`;
      } else {
        return (0, import_obsidian2.parseYaml)(_rawValue);
      }
      ;
    } else {
      return "";
    }
  };
  const renderMultiFields = (rawValue2, itemRendering) => {
    const values = rawValue2.replace(/(\,\s+)/g, ",").split(",").filter((v) => !!v).map((value) => itemRendering(value));
    return values.length ? values : "";
  };
  switch (location) {
    case "yaml":
      switch (field == null ? void 0 : field.type) {
        case "Lookup" /* Lookup */:
          return renderMultiFields(rawValue, (item) => parseFieldValue(item));
        case "Multi" /* Multi */:
          return renderMultiFields(rawValue, (item) => parseFieldValue(item));
        case "MultiFile" /* MultiFile */:
          return renderMultiFields(rawValue, (item) => `"${item}"`);
        case "Canvas" /* Canvas */:
          return renderMultiFields(rawValue, (item) => item ? `${item}` : "");
        case void 0:
          if ([...ReservedMultiAttributes, plugin.settings.fileClassAlias].includes(fieldName)) {
            return renderMultiFields(rawValue, (item) => `${item}`);
          } else {
            return parseFieldValue(rawValue);
          }
          ;
        default:
          return parseFieldValue(rawValue);
      }
    case "inline":
      return rawValue;
  }
}
var matchInlineFields = (regex, line, attribute, input, location = "fullLine") => {
  const sR = line.matchAll(regex);
  let next = sR.next();
  const newFields = [];
  while (!next.done) {
    const match = next.value;
    if (match.groups && Object.keys(match.groups).every((j) => fieldComponents.includes(j))) {
      const { inList, inQuote, preSpacer, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = match.groups;
      const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
      const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
      const start2 = LocationWrapper[location].start;
      const end2 = LocationWrapper[location].end;
      newFields.push({
        oldField: match[0],
        newField: `${inQuote || ""}${start2}${inList || ""}${preSpacer || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer || " "}${newValue}${end2}`
      });
    }
    next = sR.next();
  }
  return newFields;
};
function postFieldsInYaml(plugin, file, fields) {
  return __async(this, null, function* () {
    var _a;
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const newContent = [];
    const currentFile = yield app.vault.read(file);
    const skippedLines = [];
    const pushNewField = (fieldName, payload) => {
      var _a2;
      const newValue = renderField(plugin, file, fieldName, payload.value, "yaml");
      if (Array.isArray(newValue)) {
        const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((f) => f.name === fieldName);
        if ((field == null ? void 0 : field.getDisplay(plugin)) === "asList" /* asList */) {
          newContent.push(`${fieldName}:`);
          newValue.filter((v) => !!v).forEach((item) => {
            newContent.push(`  - ${item}`);
          });
        } else {
          newContent.push(`${fieldName}: [${newValue.join(" ,")}]`);
        }
      } else {
        newContent.push(`${fieldName}: ${newValue}`);
      }
    };
    if (!frontmatter) {
      newContent.push("---");
      Object.entries(fields).forEach(([fieldName, payload]) => pushNewField(fieldName, payload));
      newContent.push("---");
      newContent.push(...currentFile.split("\n"));
    } else {
      const currentContent = currentFile.split("\n");
      currentContent.forEach((line, lineNumber) => {
        if (lineNumber > frontmatter.position.end.line) {
          newContent.push(line);
        } else if (lineNumber === frontmatter.position.end.line) {
          Object.entries(fields).filter(([fieldName, payload]) => !Object.keys(frontmatter).includes(fieldName)).forEach(([fieldName, payload]) => {
            pushNewField(fieldName, payload);
          });
          newContent.push(line);
        } else if (!skippedLines.includes(lineNumber)) {
          const matchedField = { name: void 0, payload: void 0 };
          Object.entries(fields).forEach(([fieldName, payload]) => {
            const regex = new RegExp(`^${fieldName}:`, "u");
            const r = line.match(regex);
            if (r && r.length > 0) {
              let j = 1;
              while (currentContent[lineNumber + j].startsWith("  - ")) {
                skippedLines.push(lineNumber + j);
                j = j + 1;
              }
              matchedField.name = fieldName;
              matchedField.payload = payload;
            }
          });
          if (matchedField.name && matchedField.payload) {
            pushNewField(matchedField.name, matchedField.payload);
          } else {
            newContent.push(line);
          }
        }
      });
    }
    const updatedFile = newContent.join("\n");
    yield plugin.app.vault.modify(file, updatedFile);
  });
}
function postFieldsInline(plugin, file, fieldsToUpdate, fieldsToCreate, lineNumber, after = true, asList = false, asComment = false) {
  return __async(this, null, function* () {
    var _a;
    const skippedLines = [];
    let newContent = [];
    const currentContent = yield plugin.app.vault.read(file);
    currentContent.split("\n").forEach((line, _lineNumber) => {
      if (_lineNumber == lineNumber) {
        if (after)
          newContent.push(line);
        Object.entries(fieldsToCreate).forEach(([fieldName, payload]) => {
          const newLine = `${asComment ? ">" : ""}${asList ? "- " : ""}${fieldName}:: ${payload.value}`;
          newContent.push(newLine);
        });
        if (!after)
          newContent.push(line);
      } else {
        newContent.push(line);
      }
    });
    const updateContentWithField = (content, fieldName, payload) => {
      return content.map((line, i) => {
        var _a2;
        const encodedInput = encodeLink(payload.value);
        let encodedLine = encodeLink(line);
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(fieldName)}(?<values>[^\\]]*)`, "u");
        const fR = encodedLine.match(fullLineRegex2);
        if ((fR == null ? void 0 : fR.groups) && Object.keys(fR.groups).every((j) => fieldComponents.includes(j))) {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((f) => f.name === fieldName);
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */) {
            const bounds = getListBounds(plugin, file, i);
            if (bounds) {
              const { start: start2, end: end2 } = bounds;
              for (let j = start2 + 1; j < start2 + (payload.previousItemsCount || 0) + 1 && j < end2 + 1; j++) {
                skippedLines.push(j);
              }
            }
          }
          const { inList, inQuote, preSpacer, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = fR.groups;
          const inputArray = payload.value ? payload.value.replace(/(\,\s+)/g, ",").split(",").sort() : [];
          let newValue;
          let hiddenValue = "";
          let emptyLineAfterList = "";
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */ && bulletListLookupTypes.includes(field == null ? void 0 : field.options.outputType)) {
            emptyLineAfterList = content[i + (payload.previousItemsCount || 0) + 1] !== "" ? "\n" : "";
            newValue = inputArray.length === 1 ? "\n- " + inputArray[0] : `${inputArray.length > 0 ? "\n" : ""}${inputArray.map((item) => "- " + item).join("\n")}`;
            hiddenValue = `<div hidden id="${field.name}_values">${payload.value}</div>`;
          } else {
            newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          }
          return `${inQuote || ""}${inList || ""}${preSpacer || ""}${startStyle}${fieldName}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer || " "}${hiddenValue + newValue + emptyLineAfterList}`;
        } else {
          const newFields = [];
          const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(fieldName)}(?<values>[^\\]]+)?\\]`, "gu");
          const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(fieldName)}(?<values>[^\\)]+)?\\)`, "gu");
          newFields.push(...matchInlineFields(inSentenceRegexBrackets2, encodedLine, fieldName, encodedInput, "brackets" /* brackets */));
          newFields.push(...matchInlineFields(inSentenceRegexPar2, encodedLine, fieldName, encodedInput, "parenthesis" /* parenthesis */));
          newFields.forEach((field) => {
            const fieldRegex = new RegExp(field.oldField.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "u");
            encodedLine = encodedLine.replace(fieldRegex, field.newField);
          });
          return decodeLink(encodedLine);
        }
      });
    };
    Object.entries(fieldsToUpdate).forEach(([fieldName, payload]) => {
      newContent = updateContentWithField(newContent, fieldName, payload);
    });
    const updatedFile = newContent.filter((line, i) => !skippedLines.includes(i)).join("\n");
    yield plugin.app.vault.modify(file, updatedFile);
    const editor = (_a = plugin.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView)) == null ? void 0 : _a.editor;
    if (editor) {
      const lineNumber2 = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber2).length });
    }
  });
}
function postValues(plugin, payload, fileOrFilePath, lineNumber, after = true, asList = false, asComment = false) {
  return __async(this, null, function* () {
    var _a, _b;
    const file = getFileFromFileOrPath(plugin, fileOrFilePath);
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const dvAPi = (_b = plugin.app.plugins.plugins.dataview) == null ? void 0 : _b.api;
    const inFrontmatter = !!(lineNumber === -1 || lineNumber && start2 && end2 && lineNumber >= start2.line && lineNumber <= end2.line);
    const toCreateInline = {};
    const toUpdateInline = {};
    const toYaml = {};
    payload.forEach((item) => __async(this, null, function* () {
      var _a2, _b2, _c;
      const create = !genuineKeys(dvAPi.page(file.path)).includes(item.name);
      if (create) {
        if (!lineNumber || inFrontmatter) {
          toYaml[item.name] = item.payload;
        } else {
          toCreateInline[item.name] = item.payload;
        }
      } else {
        const dvApi = (_a2 = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a2.api;
        const currentValue = dvApi && ((_b2 = dvApi.page(file.path)) == null ? void 0 : _b2[item.name]);
        const field = (_c = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _c.find((f) => f.name === item.name);
        const multi = field && multiTypes.includes(field.type);
        const newValue = currentValue && item.payload.addToCurrentValues && (multi || ReservedMultiAttributes.includes(item.name)) ? `${currentValue}, ${item.payload.value}` : item.payload.value;
        item.payload.value = newValue;
        if (frontmatter && Object.keys(frontmatter).includes(item.name)) {
          toYaml[item.name] = item.payload;
        } else {
          toUpdateInline[item.name] = item.payload;
        }
      }
    }));
    console.log(toYaml, toCreateInline, toUpdateInline);
    if (Object.keys(toYaml).length)
      yield plugin.fileTaskManager.pushTask(() => {
        postFieldsInYaml(plugin, file, toYaml);
      });
    if (Object.keys(toCreateInline).length || Object.keys(toUpdateInline).length)
      yield plugin.fileTaskManager.pushTask(() => {
        postFieldsInline(plugin, file, toUpdateInline, toCreateInline, lineNumber, after, asList, asComment);
      });
  });
}

// src/modals/baseModal.ts
var import_obsidian3 = require("obsidian");
var BaseModal = class extends import_obsidian3.Modal {
  constructor(plugin) {
    super(plugin.app);
    this.plugin = plugin;
  }
  onOpen() {
    this.containerEl.onkeydown = (e) => __async(this, null, function* () {
      if (e.key == "Enter") {
        e.preventDefault();
        yield this.save();
      }
    });
  }
  save(e) {
    return __async(this, null, function* () {
      throw Error("Subclass should implement a save method");
    });
  }
  buildSaveBtn(fieldContainer) {
    fieldContainer.createDiv({ cls: "spacer" });
    const saveBtn = new import_obsidian3.ButtonComponent(fieldContainer);
    saveBtn.setIcon("checkmark");
    saveBtn.onClick((e) => __async(this, null, function* () {
      yield this.save(e);
    }));
  }
};

// src/modals/fields/InputModal.ts
var InputModal = class extends BaseModal {
  constructor(plugin, file, field, value, lineNumber = -1, after = false, asList = false, asComment = false) {
    super(plugin);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.templateValues = {};
  }
  onOpen() {
    super.onOpen();
    if (this.field.options.template) {
      const templateFieldRegex = new RegExp(`\\{\\{(?<field>[^\\}]+?)\\}\\}`, "gu");
      const tF = this.field.options.template.matchAll(templateFieldRegex);
      let next = tF.next();
      while (!next.done) {
        if (next.value.groups) {
          const value = next.value.groups.field;
          const [name, optionsString] = value.split(new RegExp(":(.*)", "s")).map((v) => v.trim());
          this.templateValues[name] = "";
          if (optionsString) {
            const options2 = JSON.parse(optionsString);
            this.buildTemplateSelectItem(this.contentEl.createDiv({ cls: "field-container" }), name, options2);
          } else {
            this.buildTemplateInputItem(this.contentEl.createDiv({ cls: "field-container" }), name);
          }
        }
        next = tF.next();
      }
      this.contentEl.createDiv({ text: "Result preview" });
      this.buildResultPreview(this.contentEl.createDiv({ cls: "field-container" }));
    } else {
      this.buildInputEl(this.contentEl.createDiv({ cls: "field-container" }));
    }
    this.buildSaveBtn(this.contentEl.createDiv({ cls: "footer-actions" }));
    this.containerEl.addClass("metadata-menu");
  }
  renderValue() {
    let renderedString = this.field.options.template.slice();
    Object.keys(this.templateValues).forEach((k) => {
      const fieldRegex = new RegExp(`\\{\\{${k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")}(:[^\\}]*)?\\}\\}`, "u");
      renderedString = renderedString.replace(fieldRegex, this.templateValues[k]);
    });
    this.renderedValue.setValue(renderedString);
    this.newValue = renderedString;
  }
  buildTemplateInputItem(fieldContainer, name) {
    fieldContainer.createDiv({ cls: "label", text: name });
    const input = new import_obsidian4.TextComponent(fieldContainer);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    input.setPlaceholder(`Enter a value for ${name}`);
    input.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildTemplateSelectItem(fieldContainer, name, options2) {
    fieldContainer.createDiv({ text: name, cls: "label" });
    fieldContainer.createDiv({ cls: "spacer" });
    const selectEl = new import_obsidian4.DropdownComponent(fieldContainer);
    selectEl.addOption("", "--select--");
    options2.forEach((o) => selectEl.addOption(o, o));
    selectEl.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildResultPreview(fieldContainer) {
    this.renderedValue = new import_obsidian4.TextAreaComponent(fieldContainer);
    this.renderedValue.inputEl.addClass("full-width");
    this.renderedValue.inputEl.rows = 3;
    this.renderedValue.setValue(this.value);
  }
  buildInputEl(container) {
    const inputEl = new import_obsidian4.TextAreaComponent(container);
    inputEl.inputEl.rows = 3;
    inputEl.inputEl.focus();
    inputEl.inputEl.addClass("full-width");
    inputEl.setValue(`${this.value || ""}`);
    inputEl.onChange((value) => this.newValue = value);
  }
  save() {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: this.newValue } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
      this.close();
    });
  }
};

// src/fields/FieldManager.ts
var import_obsidian9 = require("obsidian");

// src/modals/insertFieldSuggestModal.ts
var import_obsidian6 = require("obsidian");

// src/modals/addNewFieldModal.ts
var import_obsidian5 = require("obsidian");
var addNewFieldModal = class extends import_obsidian5.Modal {
  constructor(plugin, lineNumber, file, after) {
    super(plugin.app);
    this.plugin = plugin;
    this.lineNumber = lineNumber;
    this.file = file;
    this.after = after;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    this.titleEl.setText("Insert new field");
    const nameContainer = this.contentEl.createDiv({ cls: "field-container" });
    nameContainer.createDiv({ text: "Field name: ", cls: "label" });
    const nameInput = new import_obsidian5.TextComponent(nameContainer);
    nameInput.inputEl.addClass("with-label");
    nameInput.inputEl.addClass("full-width");
    const valueContainer = this.contentEl.createDiv({ cls: "field-container" });
    valueContainer.createDiv({ text: "Field value: ", cls: "label" });
    const valueInput = new import_obsidian5.TextComponent(valueContainer);
    valueInput.inputEl.addClass("with-label");
    valueInput.inputEl.addClass("full-width");
    const footerButtons = this.contentEl.createDiv({
      cls: "footer-actions"
    });
    footerButtons.createDiv({ cls: "spacer" });
    const saveButton = new import_obsidian5.ButtonComponent(footerButtons);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: nameInput.getValue(), payload: { value: valueInput.getValue() } }], this.file, this.lineNumber, this.after);
      this.close();
    }));
    const cancelButton = new import_obsidian5.ButtonComponent(footerButtons);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
  }
};

// src/modals/insertFieldSuggestModal.ts
var InsertFieldSuggestModal = class extends import_obsidian6.FuzzySuggestModal {
  constructor(plugin, file, lineNumber, after) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.lineNumber = lineNumber;
    this.after = after;
    this.containerEl.addClass("metadata-menu");
  }
  getItems() {
    var _a;
    return [{ actionLabel: "++New++" }].concat(((_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.map((field) => {
      return { actionLabel: field.name, type: field.type };
    })) || []);
  }
  getItemText(item) {
    return item.actionLabel;
  }
  renderSuggestion(item, el) {
    el.addClass("value-container");
    const iconContainer = el.createDiv({ cls: "icon-container" });
    item.item.type ? (0, import_obsidian6.setIcon)(iconContainer, FieldIcon[item.item.type]) : (0, import_obsidian6.setIcon)(iconContainer, "plus-with-circle");
    el.createDiv({ text: item.item.actionLabel });
    el.createDiv({ cls: "spacer" });
    if (item.item.type)
      el.createDiv({ cls: `chip ${FieldTypeTagClass[item.item.type]}`, text: item.item.type });
  }
  onChooseItem(item, evt) {
    var _a;
    if (item.actionLabel === "++New++") {
      const newFieldModal = new addNewFieldModal(this.plugin, this.lineNumber, this.file, this.after);
      newFieldModal.open();
      this.close();
    } else {
      const field = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field2) => field2.name === item.actionLabel);
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.createAndOpenFieldModal(this.file, item.actionLabel, "", this.lineNumber, this.after, false, false);
      }
    }
  }
};

// src/settings/FieldSettingsModal.ts
var import_obsidian8 = require("obsidian");

// src/fields/Field.ts
var Field = class {
  constructor(name = "", options2 = {}, id = "", type = "Input" /* Input */, fileClassName, command, display) {
    this.name = name;
    this.options = options2;
    this.id = id;
    this.type = type;
    this.fileClassName = fileClassName;
    this.command = command;
    this.display = display;
  }
  getDisplay(plugin) {
    return this.display || plugin.settings.frontmatterListDisplay;
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.type = source.type;
    Object.keys(source.options).forEach((k) => {
      target.options[k] = source.options[k];
    });
    Object.keys(target.options).forEach((k) => {
      if (!Object.keys(source.options).includes(k)) {
        delete target.options[k];
      }
      ;
    });
    target.command = source.command;
    target.display = source.display;
  }
  static createDefault(name) {
    const field = new Field();
    field.type = "Input" /* Input */;
    field.name = name;
    return field;
  }
};
var Field_default = Field;

// src/settings/FieldSetting.ts
var import_obsidian7 = require("obsidian");
var FieldSetting = class extends import_obsidian7.Setting {
  constructor(containerEl, field, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.field = field;
    this.plugin = plugin;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
    this.settingEl.addClass("no-border");
  }
  setTextContentWithname() {
    const manager = new FieldManager[this.field.type](this.plugin, this.field);
    this.infoEl.textContent = "";
    this.infoEl.addClass("setting-item");
    this.fieldNameContainer = this.infoEl.createEl("div", "name");
    this.fieldNameContainer.setText(this.field.name);
    this.typeContainer = this.infoEl.createEl("div");
    this.typeContainer.setAttr("class", `chip ${FieldTypeTagClass[this.field.type]}`);
    this.typeContainer.setText(this.field.type);
    this.fieldOptionsContainer = this.infoEl.createEl("div");
    this.fieldOptionsContainer.setText(`${manager.getOptionsStr()}`);
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FieldSettingsModal(this.plugin, this.containerEl, this, this.field);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
        if (currentExistingProperty) {
          this.plugin.initialProperties.remove(currentExistingProperty);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  static getValuesListFromNote(plugin, notePath) {
    return __async(this, null, function* () {
      let values = [];
      const file = plugin.app.vault.getAbstractFileByPath(notePath);
      if (file instanceof import_obsidian7.TFile && file.extension == "md") {
        const result = yield plugin.app.vault.read(file);
        result.split("\n").forEach((line) => {
          if (/^(.*)$/.test(line)) {
            values.push(line.trim());
          }
          ;
        });
        return values;
      } else {
        return [];
      }
      ;
    });
  }
};

// src/settings/FieldSettingsModal.ts
var FieldSettingsModal = class extends import_obsidian8.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, field) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialField = new Field_default();
    if (field) {
      this.new = false;
      this.field = field;
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      let newId = 1;
      this.plugin.initialProperties.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.field = new Field_default();
      this.field.id = newId.toString();
      this.initialField.id = newId.toString();
    }
    ;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.addCommand = this.field.command !== void 0;
    this.command = this.field.command || {
      id: this.field ? `insert__${this.field.fileClassName || "presetField"}__${this.field.name}` : "",
      icon: "list-plus",
      label: this.field ? `Insert ${this.field.name} field` : "",
      hotkey: void 0
    };
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      if (this.field.name == "") {
        this.titleEl.setText(`Add a field and define options`);
      } else {
        this.titleEl.setText(`Manage settings options for ${this.field.name}`);
      }
      ;
      this.createnameInputContainer();
      this.contentEl.createEl("hr");
      this.createCommandContainer();
      this.createFrontmatterListDisplayContainer();
      const typeSelectContainer = this.contentEl.createDiv({ cls: "field-container" });
      this.contentEl.createEl("hr");
      this.fieldOptionsContainer = this.contentEl.createDiv();
      const footer = this.contentEl.createDiv({ cls: "footer-actions" });
      footer.createDiv({ cls: "spacer" });
      this.createSaveButton(footer);
      this.createCancelButton(footer);
      this.createTypeSelectorContainer(typeSelectContainer);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  onClose() {
    Object.assign(this.field, this.initialField);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FieldSetting(this.parentSettingContainer, this.field, this.plugin);
    }
    ;
  }
  createnameInputContainer() {
    const container = this.contentEl.createDiv({ cls: "field-container" });
    container.createDiv({ cls: "label", text: "Field Name: " });
    const input = new import_obsidian8.TextComponent(container);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    const name = this.field.name;
    input.setValue(name);
    input.setPlaceholder("Name of the field");
    input.onChange((value) => {
      this.field.name = value;
      this.command.id = `insert__${this.field.fileClassName || "presetField"}__${value}`;
      this.command.label = `Insert ${value} field`;
      this.titleEl.setText(`Manage predefined options for ${this.field.name}`);
      FieldSettingsModal.removeValidationError(input);
    });
    this.namePromptComponent = input;
  }
  createTypeSelectorContainer(parentNode) {
    const typeSelectorContainerLabel = parentNode.createDiv({ cls: "label" });
    typeSelectorContainerLabel.setText(`Field type:`);
    parentNode.createDiv({ cls: "spacer" });
    const select = new import_obsidian8.DropdownComponent(parentNode);
    Object.keys(FieldTypeLabelMapping).forEach((f) => select.addOption(f, FieldTypeTooltip[f]));
    if (this.field.type) {
      select.setValue(this.field.type);
      if (["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(this.field.type)) {
        this.frontmatterListDisplayContainer.show();
      } else {
        this.frontmatterListDisplayContainer.hide();
      }
    }
    select.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.namePromptComponent.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      if (["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(this.field.type)) {
        this.frontmatterListDisplayContainer.show();
      } else {
        this.frontmatterListDisplayContainer.hide();
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  createFrontmatterListDisplayContainer() {
    this.frontmatterListDisplayContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.frontmatterListDisplayContainer.createDiv({ text: "Frontmatter list display type", cls: "label" });
    this.frontmatterListDisplayContainer.createDiv({ cls: "spacer" });
    const frontmatterListDisplay = new import_obsidian8.DropdownComponent(this.frontmatterListDisplayContainer);
    const options2 = {};
    options2["asArray"] = "display as array";
    options2["asList"] = "display as indented list";
    options2["undefined"] = `Plugin Default (${this.plugin.settings.frontmatterListDisplay})`;
    frontmatterListDisplay.addOptions(options2);
    switch (this.field.display) {
      case "asArray" /* asArray */:
        frontmatterListDisplay.setValue("asArray");
        break;
      case "asList" /* asList */:
        frontmatterListDisplay.setValue("asList");
        break;
      case void 0:
        frontmatterListDisplay.setValue("undefined");
        break;
    }
    frontmatterListDisplay.onChange((value) => {
      switch (value) {
        case "asArray":
          this.frontmatterListDisplay = "asArray" /* asArray */;
          break;
        case "asList":
          this.frontmatterListDisplay = "asList" /* asList */;
          break;
        case "undefined":
          this.frontmatterListDisplay = void 0;
          break;
        default:
          this.frontmatterListDisplay = void 0;
      }
    });
  }
  createCommandContainer() {
    const commandContainer = this.contentEl.createDiv({ cls: "field-container" });
    commandContainer.createDiv({ text: "set a command for this field?", cls: "label" });
    commandContainer.createDiv({ cls: "spacer" });
    const addCommandToggler = new import_obsidian8.ToggleComponent(commandContainer);
    addCommandToggler.setValue(this.addCommand);
    const iconContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.addCommand ? iconContainer.show() : iconContainer.hide();
    iconContainer.createDiv({ text: "Icon name", cls: "label" });
    this.iconName = new import_obsidian8.TextComponent(iconContainer);
    this.iconName.inputEl.addClass("full-width");
    this.iconName.inputEl.addClass("with-label");
    const iconPreview = iconContainer.createDiv({ cls: "icon-preview" });
    this.iconName.setValue(this.command.icon);
    (0, import_obsidian8.setIcon)(iconPreview, this.command.icon);
    this.iconName.onChange((value) => {
      this.command.icon = value;
      (0, import_obsidian8.setIcon)(iconPreview, value);
    });
    addCommandToggler.onChange((value) => {
      this.addCommand = value;
      this.addCommand ? iconContainer.show() : iconContainer.hide();
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.namePromptComponent, this.contentEl) && this.fieldManager.validateOptions();
  }
  createSaveButton(container) {
    const b = new import_obsidian8.ButtonComponent(container);
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      let error = !this.validateFields();
      if (error) {
        new import_obsidian8.Notice("Fix errors before saving.");
        return;
      }
      ;
      if (this.addCommand) {
        this.field.command = this.command;
      } else {
        delete this.field.command;
      }
      if (this.frontmatterListDisplay !== void 0) {
        this.field.display = this.frontmatterListDisplay;
      } else {
        delete this.field.display;
      }
      this.saved = true;
      const currentExistingField = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
      if (currentExistingField) {
        Field_default.copyProperty(currentExistingField, this.field);
      } else {
        this.plugin.initialProperties.push(this.field);
      }
      ;
      Field_default.copyProperty(this.initialField, this.field);
      if (this.parentSetting)
        Field_default.copyProperty(this.parentSetting.field, this.field);
      (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
      this.plugin.saveSettings();
      this.close();
    }));
  }
  createCancelButton(container) {
    const b = new import_obsidian8.ButtonComponent(container);
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialField.name != "") {
        Object.assign(this.field, this.initialField);
      }
      ;
      this.close();
    });
  }
  static setValidationError(textInput, message) {
    textInput.inputEl.addClass("is-invalid");
    const fieldContainer = textInput.inputEl.parentElement;
    const fieldsContainer = fieldContainer == null ? void 0 : fieldContainer.parentElement;
    if (message && fieldsContainer) {
      let mDiv = fieldsContainer.querySelector(".field-error");
      if (!mDiv)
        mDiv = createDiv({ cls: "field-error" });
      mDiv.innerText = message;
      fieldsContainer.insertBefore(mDiv, fieldContainer);
    }
  }
  static removeValidationError(textInput) {
    if (textInput.inputEl.hasClass("is-invalid"))
      textInput.inputEl.removeClass("is-invalid");
    const fieldContainer = textInput.inputEl.parentElement;
    const fieldsContainer = fieldContainer == null ? void 0 : fieldContainer.parentElement;
    const fieldError = fieldsContainer == null ? void 0 : fieldsContainer.querySelector(".field-error");
    if (fieldError)
      fieldsContainer.removeChild(fieldError);
  }
};

// src/fields/FieldManager.ts
var FieldManager2 = class {
  constructor(plugin, field, type) {
    this.plugin = plugin;
    this.field = field;
    this.type = type;
    this.showModalOption = true;
    if (field.type !== type)
      throw Error(`This field is not of type ${type}`);
  }
  static buildMarkDownLink(plugin, file, path, subPath, alias) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, subPath, alias);
    }
    return "";
  }
  validateName(textInput, contentEl) {
    let error = false;
    if (/^[#>-]/.test(this.field.name)) {
      FieldSettingsModal.setValidationError(textInput, "Field name cannot start with #, >, -");
      error = true;
    }
    ;
    if (this.field.name == "") {
      FieldSettingsModal.setValidationError(textInput, "Field name can not be Empty");
      error = true;
    }
    ;
    return !error;
  }
  validateValue(value) {
    return true;
  }
  static replaceValues(plugin, path, fieldName, value) {
    return __async(this, null, function* () {
      const file = plugin.app.vault.getAbstractFileByPath(path);
      if (file instanceof import_obsidian9.TFile && file.extension == "md") {
        yield postValues(plugin, [{ name: fieldName, payload: { value } }], file);
      }
    });
  }
  static isMenu(location) {
    return location.addItem !== void 0;
  }
  static isSuggest(location) {
    return location.getItems !== void 0;
  }
  static isInsertFieldCommand(location) {
    return location === "InsertFieldCommand";
  }
  static isFieldOptions(location) {
    return location.addOption !== void 0;
  }
  static createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, after, asList, asComment) {
    if (field) {
      const fieldManager = new FieldManager[field.type](plugin, field);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, after, asList, asComment);
    } else {
      const fieldManager = FieldManager2.createDefault(plugin, fieldName);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, after, asList, asComment);
    }
  }
  static openFieldModal(plugin, file, fieldName, value, lineNumber, after, asList, asComment) {
    var _a;
    if (!fieldName) {
      const modal = new InsertFieldSuggestModal(plugin, file, lineNumber, after);
      modal.open();
    } else {
      const field = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
      if (field)
        this.createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, after, asList, asComment);
    }
  }
  static createDefault(plugin, name) {
    const field = Field_default.createDefault(name);
    return new FieldManager[field.type](plugin, field);
  }
  static stringToBoolean(value) {
    let toBooleanValue = false;
    if (isBoolean(value)) {
      toBooleanValue = value;
    } else if (/true/i.test(value) || /1/.test(value)) {
      toBooleanValue = true;
    } else if (/false/i.test(value) || /0/.test(value)) {
      toBooleanValue = false;
    }
    ;
    return toBooleanValue;
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let valueText;
    if (dvApi) {
      switch (dvApi.page(file.path)[fieldName]) {
        case void 0:
          valueText = "";
          break;
        case null:
          valueText = "";
          break;
        case false:
          valueText = "false";
          break;
        case 0:
          valueText = "0";
          break;
        default:
          valueText = dvApi.page(file.path)[fieldName];
      }
    } else {
      valueText = "";
    }
    container.createDiv({ text: valueText });
  }
};

// src/fields/fieldManagers/InputField.ts
var InputField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Input" /* Input */);
  }
  getOptionsStr() {
    return this.field.options.template || "";
  }
  addFieldOption(name, value, file, location) {
    const modal = new InputModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    const iconName = FieldIcon["Input" /* Input */];
    const action = () => modal.open();
    if (InputField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (InputField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: iconName
      });
    } else if (InputField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Input" /* Input */], action, `Update ${name}'s value`);
    }
  }
  createSettingContainer(container, plugin) {
    container.createEl("span", { text: "Template", cls: "label" });
    const templateContainer = container.createDiv({ cls: "field-container" });
    const templateValue = new import_obsidian10.TextAreaComponent(templateContainer);
    templateValue.inputEl.cols = 50;
    templateValue.inputEl.rows = 4;
    templateValue.inputEl.addClass("full-width");
    templateValue.setValue(this.field.options.template || "");
    templateValue.onChange((value) => {
      this.field.options.template = value;
    });
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new InputModal(this.plugin, file, this.field, value || "", lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a, _b;
    attrs.cls = "value-container";
    const editBtn = fieldContainer.createEl("button");
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
    const inputContainer = fieldContainer.createDiv({});
    inputContainer.hide();
    const input = inputContainer.createEl("input");
    input.value = p[this.field.name];
    const spacer = fieldContainer.createDiv({ cls: "spacer-1" });
    if ((_a = attrs.options) == null ? void 0 : _a.alwaysOn)
      spacer.hide();
    (0, import_obsidian10.setIcon)(editBtn, FieldIcon["Input" /* Input */]);
    if (!((_b = attrs == null ? void 0 : attrs.options) == null ? void 0 : _b.alwaysOn)) {
      editBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        if (!inputContainer.isShown()) {
          editBtn.show();
          spacer.hide();
        }
      };
      fieldContainer.onmouseout = () => {
        var _a2;
        editBtn.hide();
        if (!((_a2 = attrs.options) == null ? void 0 : _a2.alwaysOn))
          spacer.show();
      };
    }
    const validateIcon = inputContainer.createEl("button");
    (0, import_obsidian10.setIcon)(validateIcon, "checkmark");
    validateIcon.onclick = (e) => {
      InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
      inputContainer.hide();
    };
    const cancelIcon = inputContainer.createEl("button");
    (0, import_obsidian10.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      var _a2;
      inputContainer.hide();
      fieldValue.show();
      editBtn.show();
      if (!((_a2 = attrs.options) == null ? void 0 : _a2.alwaysOn))
        spacer.show();
    };
    input.focus();
    input.onkeydown = (e) => {
      var _a2;
      if (e.key === "Enter") {
        InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
        inputContainer.hide();
      }
      if (e.key === "Escape") {
        inputContainer.hide();
        fieldValue.show();
        editBtn.show();
        if (!((_a2 = attrs.options) == null ? void 0 : _a2.alwaysOn))
          spacer.show();
      }
    };
    editBtn.onclick = () => {
      if (this.field.options.template) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian10.TFile && file.extension === "md") {
          const inputModal = new InputModal(this.plugin, file, this.field, p[this.field.name]);
          inputModal.open();
        }
      } else {
        inputContainer.show();
        input.focus();
      }
      fieldValue.hide();
      editBtn.hide();
      spacer.hide();
    };
  }
};

// src/modals/fields/BooleanModal.ts
var import_obsidian11 = require("obsidian");
var BooleanModal = class extends import_obsidian11.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.field = field;
  }
  onOpen() {
    this.containerEl.addClass("metadata-menu");
    this.containerEl.addClass("narrow");
    this.buildToggleEl();
  }
  buildToggleEl() {
    const choicesContainer = this.contentEl.createDiv({ cls: "value-container" });
    choicesContainer.createDiv({ cls: "spacer" });
    const trueButton = new import_obsidian11.ButtonComponent(choicesContainer);
    trueButton.setButtonText("True");
    trueButton.setClass("left");
    choicesContainer.createDiv({ cls: "spacer" });
    const falseButton = new import_obsidian11.ButtonComponent(choicesContainer);
    falseButton.setButtonText("False");
    choicesContainer.createDiv({ cls: "spacer" });
    if (this.value) {
      trueButton.setCta();
      falseButton.removeCta();
    } else {
      falseButton.setCta();
      trueButton.removeCta();
    }
    falseButton.onClick(() => {
      this.value = false;
      falseButton.setCta();
      trueButton.removeCta();
    });
    trueButton.onClick(() => {
      this.value = true;
      trueButton.setCta();
      falseButton.removeCta();
    });
    const saveButton = new import_obsidian11.ButtonComponent(choicesContainer);
    saveButton.setClass("right");
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const value = this.value.toString();
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
      this.close();
    }));
  }
};

// src/fields/fieldManagers/BooleanField.ts
var BooleanField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Boolean" /* Boolean */);
    this.showModalOption = false;
  }
  toggle(name, value, file) {
    return __async(this, null, function* () {
      const bValue = BooleanField.stringToBoolean(value);
      yield postValues(this.plugin, [{ name, payload: { value: (!bValue).toString() } }], file);
    });
  }
  addFieldOption(name, value, file, location) {
    const bValue = BooleanField.stringToBoolean(value);
    const iconName = FieldIcon["Boolean" /* Boolean */];
    const action = () => __async(this, null, function* () {
      return yield this.toggle(name, value, file);
    });
    if (BooleanField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`<${name}> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (BooleanField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span><b>${name}</b> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}</span>`,
        action,
        icon: iconName
      });
    } else if (BooleanField.isFieldOptions(location)) {
      location.addOption(bValue ? "x-square" : "check-square", action, bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705");
    }
    ;
  }
  getOptionsStr() {
    return "";
  }
  createSettingContainer(parentContainer, plugin) {
  }
  validateValue(value) {
    try {
      const bValue = BooleanField.stringToBoolean(value);
      return isBoolean(bValue);
    } catch (error) {
      return false;
    }
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const bValue = BooleanField.stringToBoolean(value || "false");
    const fieldModal = new BooleanModal(this.plugin, file, this.field, bValue, lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Set value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const checkbox = dv.el("input", "", __spreadProps(__spreadValues({}, attrs), { "type": "checkbox" }));
    checkbox.checked = p[this.field.name];
    fieldContainer.appendChild(checkbox);
    checkbox.onchange = (value) => {
      BooleanField.replaceValues(this.plugin, p.file.path, this.field.name, checkbox.checked.toString());
    };
  }
};

// src/fields/fieldManagers/NumberField.ts
var import_obsidian13 = require("obsidian");

// src/modals/fields/NumberModal.ts
var import_obsidian12 = require("obsidian");
var NumberModal = class extends BaseModal {
  constructor(plugin, file, field, value, lineNumber = -1, after = false, asList = false, asComment = false) {
    super(plugin);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    super.onOpen();
    this.buildInputEl();
  }
  decrement(numberInput) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      numberInput.setValue((parseFloat(numberInput.getValue()) - fStep).toString());
    } else {
      numberInput.setValue((parseFloat(numberInput.getValue()) - 1).toString());
    }
  }
  increment(numberInput) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      numberInput.setValue((parseFloat(numberInput.getValue()) + fStep).toString());
    } else {
      numberInput.setValue((parseFloat(numberInput.getValue()) + 1).toString());
    }
  }
  toggleButtonsState(minusBtn, plusBtn, numberInput) {
    minusBtn.setDisabled(!this.fieldManager.canDecrement(numberInput.getValue()));
    plusBtn.setDisabled(!this.fieldManager.canIncrement(numberInput.getValue()));
    if (this.fieldManager.canDecrement(numberInput.getValue())) {
      minusBtn.setCta();
    } else {
      minusBtn.removeCta();
    }
    if (this.fieldManager.canIncrement(numberInput.getValue())) {
      plusBtn.setCta();
    } else {
      plusBtn.removeCta();
    }
  }
  buildInputEl() {
    const { step } = this.field.options;
    const fieldContainer = this.contentEl.createEl("div", { cls: "field-container" });
    this.numberInput = new import_obsidian12.TextComponent(fieldContainer);
    const numberInput = this.numberInput;
    numberInput.inputEl.focus();
    numberInput.setValue(`${this.value}`);
    const minusBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    minusBtn.setButtonText(`- ${!!step ? step : 1}`);
    minusBtn.setDisabled(!this.fieldManager.canDecrement(numberInput.getValue()));
    const plusBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    plusBtn.setButtonText(`+ ${!!step ? step : 1}`);
    plusBtn.setDisabled(!this.fieldManager.canIncrement(numberInput.getValue()));
    fieldContainer.createDiv({ cls: "spacer" });
    const validateBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    validateBtn.setIcon("checkmark");
    const cancelBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    cancelBtn.setIcon("cross");
    this.errorField = this.contentEl.createEl("div", { cls: "field-error" });
    this.errorField.hide();
    this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    numberInput.onChange(() => {
      numberInput.inputEl.removeClass("is-invalid");
      this.errorField.hide();
      this.errorField.setText("");
      this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    });
    plusBtn.onClick((e) => {
      e.preventDefault();
      this.increment(numberInput);
      this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    });
    minusBtn.onClick((e) => {
      e.preventDefault();
      this.decrement(numberInput);
      this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    });
    cancelBtn.onClick((e) => {
      e.preventDefault();
      this.close();
    });
    validateBtn.onClick(() => __async(this, null, function* () {
      this.save();
    }));
  }
  save() {
    return __async(this, null, function* () {
      const inputValue = this.numberInput.getValue();
      if (!this.fieldManager.validateValue(inputValue)) {
        const { min: min2, max: max2 } = this.field.options;
        this.errorField.show();
        this.errorField.setText(`value must be numeric${min2 ? " and >= " + min2 : ""} ${max2 ? " and <= " + max2 : ""}`);
        this.numberInput.inputEl.setAttr("class", "is-invalid");
        return;
      }
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: inputValue } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
      this.close();
    });
  }
};

// src/fields/fieldManagers/NumberField.ts
var NumberField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Number" /* Number */);
  }
  getOptionsStr() {
    const options2 = [];
    Object.keys(this.field.options).forEach((k) => {
      if (this.field.options[k])
        options2.push(`${k}: ${this.field.options[k]}`);
    });
    return options2.join(" | ");
  }
  canDecrement(value) {
    const { step, min: min2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMin = parseFloat(min2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMin) && (!isNaN(fStep) && (parseFloat(value) - fStep < fMin || parseFloat(value) - 1 < fMin)));
  }
  canIncrement(value) {
    const { step, max: max2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMax = parseFloat(max2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMax) && (!isNaN(fStep) && (parseFloat(value) + fStep > fMax || parseFloat(value) + 1 > fMax)));
  }
  validateValue(value) {
    const { min: min2, max: max2 } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fValue = parseFloat(value);
    return !isNaN(fValue) && (isNaN(fMin) || fValue >= fMin) && (isNaN(fMax) || fValue <= fMax);
  }
  addFieldOption(name, value, file, location) {
    const modal = new NumberModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    const { min: min2, max: max2, step } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fStep = parseFloat(step);
    const fValue = parseFloat(value);
    const canDecrease = !isNaN(fMin) && fValue - fStep >= fMin;
    const canIncrease = !isNaN(fMax) && fValue + fStep <= fMax;
    const action = () => modal.open();
    const decrease = () => __async(this, null, function* () {
      return yield postValues(this.plugin, [{ name, payload: { value: (fValue - fStep).toString() } }], file);
    });
    const increase = () => __async(this, null, function* () {
      return yield postValues(this.plugin, [{ name, payload: { value: (fValue + fStep).toString() } }], file);
    });
    if (NumberField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Number" /* Number */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
      if (fStep) {
        if (canDecrease)
          location.addItem((item) => {
            item.setIcon("minus-square");
            item.setTitle(`<${name}> \u2198\uFE0F ${fValue - fStep}`);
            item.onClick(decrease);
            item.setSection("metadata-menu.fields");
          });
        if (canIncrease)
          location.addItem((item) => {
            item.setIcon("plus-square");
            item.setTitle(`<${name}> \u2197\uFE0F ${fValue + fStep}`);
            item.onClick(increase);
            item.setSection("metadata-menu.fields");
          });
      }
    } else if (NumberField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Number" /* Number */]
      });
    } else if (NumberField.isFieldOptions(location)) {
      if (step) {
        if (canDecrease) {
          location.addOption("minus-square", decrease, `Decrease ${name} by ${step}`);
        }
        if (canIncrease) {
          location.addOption("plus-square", increase, `Increase ${name} by ${step}`);
        }
      }
      location.addOption(FieldIcon["Number" /* Number */], action, `Update ${name}'s value`);
    }
    ;
  }
  createNumberContainer(container) {
    const numberStepValueContainer = container.createDiv({ cls: "field-container" });
    numberStepValueContainer.createEl("span", { text: "Step (optional)", cls: "label" });
    numberStepValueContainer.createDiv({ cls: "spacer" });
    this.numberStepValue = new import_obsidian13.TextComponent(numberStepValueContainer);
    this.numberStepValue.inputEl.addClass("with-label");
    this.numberStepValue.setValue(this.field.options.step || "");
    const numberMinValueContainer = container.createDiv({ cls: "field-container" });
    numberMinValueContainer.createEl("span", { text: "Min value (optional)", cls: "label" });
    this.numberMinValue = new import_obsidian13.TextComponent(numberMinValueContainer);
    this.numberMinValue.inputEl.addClass("full-width");
    this.numberMinValue.inputEl.addClass("with-label");
    this.numberMinValue.setValue(this.field.options.min || "");
    const numberMaxValueContainer = container.createDiv({ cls: "field-container" });
    numberMaxValueContainer.createEl("span", { text: "Max value (optional)", cls: "label" });
    this.numberMaxValue = new import_obsidian13.TextComponent(numberMaxValueContainer);
    this.numberMaxValue.inputEl.addClass("full-width");
    this.numberMaxValue.inputEl.addClass("with-label");
    this.numberMaxValue.setValue(this.field.options.max || "");
    this.numberStepValue.onChange((value) => {
      this.field.options.step = value;
      FieldSettingsModal.removeValidationError(this.numberStepValue);
    });
    this.numberMinValue.onChange((value) => {
      this.field.options.min = value;
      FieldSettingsModal.removeValidationError(this.numberMinValue);
    });
    this.numberMaxValue.onChange((value) => {
      this.field.options.max = value;
      FieldSettingsModal.removeValidationError(this.numberMaxValue);
    });
  }
  createSettingContainer(container, plugin) {
    this.createNumberContainer(container);
  }
  validateOptions() {
    let error = false;
    if (this.field.options.step && isNaN(parseFloat(this.field.options.step))) {
      FieldSettingsModal.setValidationError(this.numberStepValue, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.min && isNaN(parseFloat(this.field.options.min))) {
      FieldSettingsModal.setValidationError(this.numberMinValue, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.max && isNaN(parseFloat(this.field.options.max))) {
      FieldSettingsModal.setValidationError(this.numberMaxValue, "Values must be numeric.");
      error = true;
    }
    return !error;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new NumberModal(this.plugin, file, this.field, value || "", lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  toggleDvButtons(decrementBtn, incrementBtn, value) {
    if (this.canDecrement(value)) {
      decrementBtn.removeClass("disabled");
    } else {
      decrementBtn.addClass("disabled");
    }
    if (this.canIncrement(value)) {
      incrementBtn.removeClass("disabled");
    } else {
      incrementBtn.addClass("disabled");
      ;
    }
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
    const inputContainer = fieldContainer.createDiv({});
    const input = inputContainer.createEl("input");
    input.value = p[this.field.name];
    const tripleSpacer = fieldContainer.createDiv({ cls: "spacer-3" });
    const editButton = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(editButton, FieldIcon["Number" /* Number */]);
    const decrementButton = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(decrementButton, "left-arrow");
    const incrementButton = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(incrementButton, "right-arrow");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      editButton.hide();
      decrementButton.hide();
      incrementButton.hide();
      tripleSpacer.show();
      fieldContainer.onmouseover = () => {
        editButton.show();
        decrementButton.show();
        incrementButton.show();
        tripleSpacer.hide();
      };
      fieldContainer.onmouseout = () => {
        editButton.hide();
        decrementButton.hide();
        incrementButton.hide();
        tripleSpacer.show();
      };
    }
    const validateIcon = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(validateIcon, "checkmark");
    validateIcon.onclick = () => __async(this, null, function* () {
      if (this.validateValue(input.value)) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          yield postValues(this.plugin, [{ name: this.field.name, payload: { value: input.value } }], file);
          this.toggleDvButtons(decrementButton, incrementButton, input.value);
        }
        fieldContainer.removeChild(inputContainer);
      }
    });
    inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
    const cancelIcon = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(decrementButton);
      fieldContainer.appendChild(editButton);
      fieldContainer.appendChild(incrementButton);
      fieldContainer.appendChild(tripleSpacer);
    };
    inputContainer.appendChild(cancelIcon);
    input.focus();
    input.onkeyup = (e) => {
      if (!this.validateValue(input.value)) {
        input.addClass("is-invalid");
        validateIcon.addClass("disabled");
      } else {
        input.removeClass("is-invalid");
        validateIcon.removeClass("disabled");
      }
    };
    input.onkeydown = (e) => __async(this, null, function* () {
      if (e.key === "Enter") {
        if (this.validateValue(input.value)) {
          const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
          if (file instanceof import_obsidian13.TFile && file.extension == "md") {
            yield postValues(this.plugin, [{ name: this.field.name, payload: { value: input.value } }], file);
            this.toggleDvButtons(decrementButton, incrementButton, input.value);
          }
          fieldContainer.removeChild(inputContainer);
        }
      }
      if (e.key === "Escape") {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(decrementButton);
        fieldContainer.appendChild(editButton);
        fieldContainer.appendChild(incrementButton);
        fieldContainer.appendChild(tripleSpacer);
      }
    });
    editButton.onclick = () => {
      fieldContainer.removeChild(fieldValue);
      fieldContainer.removeChild(editButton);
      fieldContainer.removeChild(decrementButton);
      fieldContainer.removeChild(incrementButton);
      fieldContainer.removeChild(tripleSpacer);
      fieldContainer.appendChild(inputContainer);
      input.focus();
    };
    decrementButton.onclick = () => __async(this, null, function* () {
      if (this.canDecrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] - fStep : p[this.field.name] - 1).toString();
          yield postValues(this.plugin, [{ name: this.field.name, payload: { value: newValue } }], file);
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    incrementButton.onclick = () => __async(this, null, function* () {
      if (this.canIncrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] + fStep : p[this.field.name] + 1).toString();
          yield postValues(this.plugin, [{ name: this.field.name, payload: { value: newValue } }], file);
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    fieldContainer.removeChild(inputContainer);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(decrementButton);
    fieldContainer.appendChild(editButton);
    fieldContainer.appendChild(incrementButton);
    fieldContainer.appendChild(tripleSpacer);
    this.toggleDvButtons(decrementButton, incrementButton, p[this.field.name]);
  }
};

// src/fields/fieldManagers/SelectField.ts
var import_obsidian18 = require("obsidian");

// src/modals/fields/SelectModal.ts
var import_obsidian14 = require("obsidian");

// src/types/selectValuesSourceTypes.ts
var Type2 = /* @__PURE__ */ ((Type3) => {
  Type3["ValuesList"] = "ValuesList";
  Type3["ValuesListNotePath"] = "ValuesListNotePath";
  Type3["ValuesFromDVQuery"] = "ValuesFromDVQuery";
  return Type3;
})(Type2 || {});
var Key = {
  "ValuesList": "valuesList",
  "ValuesListNotePath": "valuesListNotePath",
  "ValuesFromDVQuery": "valuesFromDVQuery"
};
var typeDisplay = {
  "ValuesList": "Values defined in these settings",
  "ValuesListNotePath": "Values from a note",
  "ValuesFromDVQuery": "Values returned from a dataview query"
};

// src/modals/fields/SelectModal.ts
var ValueSuggestModal = class extends import_obsidian14.SuggestModal {
  constructor(plugin, file, value, field, lineNumber = -1, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.field = field;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(ValueSuggestModal.prototype, this, "onOpen").call(this);
      const inputContainer = this.containerEl.createDiv({ cls: "suggester-input" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "footer-actions" });
      buttonContainer.createDiv({ cls: "spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "info" });
      infoContainer.setText("Shift+Enter to save");
      this.addButton = new import_obsidian14.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => this.addNewValueToSettings());
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      const cancelButton = new import_obsidian14.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => this.close());
      cancelButton.setTooltip("Cancel");
      const clearButton = new import_obsidian14.ButtonComponent(buttonContainer);
      clearButton.setIcon("eraser");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("danger");
      clearButton.setTooltip("Clear the field value");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      var _a, _b;
      const newValue = this.inputEl.value;
      const fileClassName = (_b = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field) => field.name === this.field.name)) == null ? void 0 : _b.fileClassName;
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length + 1}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian14.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length + 1}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian14.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.saveItem(newValue);
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("value-container");
    if (value === this.value)
      el.addClass("value-checked");
  }
  saveItem(item) {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: item.toString() } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
    });
  }
  onChooseSuggestion(item, evt) {
    return __async(this, null, function* () {
      this.saveItem(item);
    });
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var import_obsidian17 = require("obsidian");

// src/suggester/FileSuggester.ts
var import_obsidian16 = require("obsidian");

// src/suggester/suggest.ts
var import_obsidian15 = require("obsidian");

// node_modules/@popperjs/core/lib/enums.js
var top = "top";
var bottom = "bottom";
var right = "right";
var left = "left";
var auto = "auto";
var basePlacements = [top, bottom, right, left];
var start = "start";
var end = "end";
var clippingParents = "clippingParents";
var viewport = "viewport";
var popper = "popper";
var reference = "reference";
var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []);
var beforeRead = "beforeRead";
var read = "read";
var afterRead = "afterRead";
var beforeMain = "beforeMain";
var main = "main";
var afterMain = "afterMain";
var beforeWrite = "beforeWrite";
var write = "write";
var afterWrite = "afterWrite";
var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];

// node_modules/@popperjs/core/lib/dom-utils/getNodeName.js
function getNodeName(element) {
  return element ? (element.nodeName || "").toLowerCase() : null;
}

// node_modules/@popperjs/core/lib/dom-utils/getWindow.js
function getWindow(node) {
  if (node == null) {
    return window;
  }
  if (node.toString() !== "[object Window]") {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }
  return node;
}

// node_modules/@popperjs/core/lib/dom-utils/instanceOf.js
function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}
function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}
function isShadowRoot(node) {
  if (typeof ShadowRoot === "undefined") {
    return false;
  }
  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

// node_modules/@popperjs/core/lib/modifiers/applyStyles.js
function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function(name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name];
    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    }
    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function(name2) {
      var value = attributes[name2];
      if (value === false) {
        element.removeAttribute(name2);
      } else {
        element.setAttribute(name2, value === true ? "" : value);
      }
    });
  });
}
function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: "0",
      top: "0",
      margin: "0"
    },
    arrow: {
      position: "absolute"
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;
  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }
  return function() {
    Object.keys(state.elements).forEach(function(name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
      var style = styleProperties.reduce(function(style2, property) {
        style2[property] = "";
        return style2;
      }, {});
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
}
var applyStyles_default = {
  name: "applyStyles",
  enabled: true,
  phase: "write",
  fn: applyStyles,
  effect,
  requires: ["computeStyles"]
};

// node_modules/@popperjs/core/lib/utils/getBasePlacement.js
function getBasePlacement(placement) {
  return placement.split("-")[0];
}

// node_modules/@popperjs/core/lib/utils/math.js
var max = Math.max;
var min = Math.min;
var round = Math.round;

// node_modules/@popperjs/core/lib/utils/userAgent.js
function getUAString() {
  var uaData = navigator.userAgentData;
  if (uaData != null && uaData.brands) {
    return uaData.brands.map(function(item) {
      return item.brand + "/" + item.version;
    }).join(" ");
  }
  return navigator.userAgent;
}

// node_modules/@popperjs/core/lib/dom-utils/isLayoutViewport.js
function isLayoutViewport() {
  return !/^((?!chrome|android).)*safari/i.test(getUAString());
}

// node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js
function getBoundingClientRect(element, includeScale, isFixedStrategy) {
  if (includeScale === void 0) {
    includeScale = false;
  }
  if (isFixedStrategy === void 0) {
    isFixedStrategy = false;
  }
  var clientRect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;
  if (includeScale && isHTMLElement(element)) {
    scaleX = element.offsetWidth > 0 ? round(clientRect.width) / element.offsetWidth || 1 : 1;
    scaleY = element.offsetHeight > 0 ? round(clientRect.height) / element.offsetHeight || 1 : 1;
  }
  var _ref = isElement(element) ? getWindow(element) : window, visualViewport = _ref.visualViewport;
  var addVisualOffsets = !isLayoutViewport() && isFixedStrategy;
  var x = (clientRect.left + (addVisualOffsets && visualViewport ? visualViewport.offsetLeft : 0)) / scaleX;
  var y = (clientRect.top + (addVisualOffsets && visualViewport ? visualViewport.offsetTop : 0)) / scaleY;
  var width = clientRect.width / scaleX;
  var height = clientRect.height / scaleY;
  return {
    width,
    height,
    top: y,
    right: x + width,
    bottom: y + height,
    left: x,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js
function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element);
  var width = element.offsetWidth;
  var height = element.offsetHeight;
  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }
  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }
  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width,
    height
  };
}

// node_modules/@popperjs/core/lib/dom-utils/contains.js
function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode();
  if (parent.contains(child)) {
    return true;
  } else if (rootNode && isShadowRoot(rootNode)) {
    var next = child;
    do {
      if (next && parent.isSameNode(next)) {
        return true;
      }
      next = next.parentNode || next.host;
    } while (next);
  }
  return false;
}

// node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js
function getComputedStyle2(element) {
  return getWindow(element).getComputedStyle(element);
}

// node_modules/@popperjs/core/lib/dom-utils/isTableElement.js
function isTableElement(element) {
  return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js
function getDocumentElement(element) {
  return ((isElement(element) ? element.ownerDocument : element.document) || window.document).documentElement;
}

// node_modules/@popperjs/core/lib/dom-utils/getParentNode.js
function getParentNode(element) {
  if (getNodeName(element) === "html") {
    return element;
  }
  return element.assignedSlot || element.parentNode || (isShadowRoot(element) ? element.host : null) || getDocumentElement(element);
}

// node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js
function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || getComputedStyle2(element).position === "fixed") {
    return null;
  }
  return element.offsetParent;
}
function getContainingBlock(element) {
  var isFirefox = /firefox/i.test(getUAString());
  var isIE = /Trident/i.test(getUAString());
  if (isIE && isHTMLElement(element)) {
    var elementCss = getComputedStyle2(element);
    if (elementCss.position === "fixed") {
      return null;
    }
  }
  var currentNode = getParentNode(element);
  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }
  while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle2(currentNode);
    if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }
  return null;
}
function getOffsetParent(element) {
  var window2 = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);
  while (offsetParent && isTableElement(offsetParent) && getComputedStyle2(offsetParent).position === "static") {
    offsetParent = getTrueOffsetParent(offsetParent);
  }
  if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle2(offsetParent).position === "static")) {
    return window2;
  }
  return offsetParent || getContainingBlock(element) || window2;
}

// node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js
function getMainAxisFromPlacement(placement) {
  return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
}

// node_modules/@popperjs/core/lib/utils/within.js
function within(min2, value, max2) {
  return max(min2, min(value, max2));
}
function withinMaxClamp(min2, value, max2) {
  var v = within(min2, value, max2);
  return v > max2 ? max2 : v;
}

// node_modules/@popperjs/core/lib/utils/getFreshSideObject.js
function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}

// node_modules/@popperjs/core/lib/utils/mergePaddingObject.js
function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}

// node_modules/@popperjs/core/lib/utils/expandToHashMap.js
function expandToHashMap(value, keys) {
  return keys.reduce(function(hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}

// node_modules/@popperjs/core/lib/modifiers/arrow.js
var toPaddingObject = function toPaddingObject2(padding, state) {
  padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
};
function arrow(_ref) {
  var _state$modifiersData$;
  var state = _ref.state, name = _ref.name, options2 = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? "height" : "width";
  if (!arrowElement || !popperOffsets2) {
    return;
  }
  var paddingObject = toPaddingObject(options2.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === "y" ? top : left;
  var maxProp = axis === "y" ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
  var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2;
  var min2 = paddingObject[minProp];
  var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset2 = within(min2, center, max2);
  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
}
function effect2(_ref2) {
  var state = _ref2.state, options2 = _ref2.options;
  var _options$element = options2.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
  if (arrowElement == null) {
    return;
  }
  if (typeof arrowElement === "string") {
    arrowElement = state.elements.popper.querySelector(arrowElement);
    if (!arrowElement) {
      return;
    }
  }
  if (true) {
    if (!isHTMLElement(arrowElement)) {
      console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).', "To use an SVG arrow, wrap it in an HTMLElement that will be used as", "the arrow."].join(" "));
    }
  }
  if (!contains(state.elements.popper, arrowElement)) {
    if (true) {
      console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper', "element."].join(" "));
    }
    return;
  }
  state.elements.arrow = arrowElement;
}
var arrow_default = {
  name: "arrow",
  enabled: true,
  phase: "main",
  fn: arrow,
  effect: effect2,
  requires: ["popperOffsets"],
  requiresIfExists: ["preventOverflow"]
};

// node_modules/@popperjs/core/lib/utils/getVariation.js
function getVariation(placement) {
  return placement.split("-")[1];
}

// node_modules/@popperjs/core/lib/modifiers/computeStyles.js
var unsetSides = {
  top: "auto",
  right: "auto",
  bottom: "auto",
  left: "auto"
};
function roundOffsetsByDPR(_ref) {
  var x = _ref.x, y = _ref.y;
  var win = window;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}
function mapToStyles(_ref2) {
  var _Object$assign2;
  var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, variation = _ref2.variation, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets, isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x, x = _offsets$x === void 0 ? 0 : _offsets$x, _offsets$y = offsets.y, y = _offsets$y === void 0 ? 0 : _offsets$y;
  var _ref3 = typeof roundOffsets === "function" ? roundOffsets({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty("x");
  var hasY = offsets.hasOwnProperty("y");
  var sideX = left;
  var sideY = top;
  var win = window;
  if (adaptive) {
    var offsetParent = getOffsetParent(popper2);
    var heightProp = "clientHeight";
    var widthProp = "clientWidth";
    if (offsetParent === getWindow(popper2)) {
      offsetParent = getDocumentElement(popper2);
      if (getComputedStyle2(offsetParent).position !== "static" && position === "absolute") {
        heightProp = "scrollHeight";
        widthProp = "scrollWidth";
      }
    }
    offsetParent = offsetParent;
    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : offsetParent[heightProp];
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }
    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : offsetParent[widthProp];
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }
  var commonStyles = Object.assign({
    position
  }, adaptive && unsetSides);
  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref4.x;
  y = _ref4.y;
  if (gpuAcceleration) {
    var _Object$assign;
    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }
  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
}
function computeStyles(_ref5) {
  var state = _ref5.state, options2 = _ref5.options;
  var _options$gpuAccelerat = options2.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options2.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options2.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
  if (true) {
    var transitionProperty = getComputedStyle2(state.elements.popper).transitionProperty || "";
    if (adaptive && ["transform", "top", "right", "bottom", "left"].some(function(property) {
      return transitionProperty.indexOf(property) >= 0;
    })) {
      console.warn(["Popper: Detected CSS transitions on at least one of the following", 'CSS properties: "transform", "top", "right", "bottom", "left".', "\n\n", 'Disable the "computeStyles" modifier\'s `adaptive` option to allow', "for smooth transitions, or remove these properties from the CSS", "transition declaration on the popper element if only transitioning", "opacity or background-color for example.", "\n\n", "We recommend using the popper element as a wrapper around an inner", "element that can have any CSS property transitioned for animations."].join(" "));
    }
  }
  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration,
    isFixed: state.options.strategy === "fixed"
  };
  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive,
      roundOffsets
    })));
  }
  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: "absolute",
      adaptive: false,
      roundOffsets
    })));
  }
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-placement": state.placement
  });
}
var computeStyles_default = {
  name: "computeStyles",
  enabled: true,
  phase: "beforeWrite",
  fn: computeStyles,
  data: {}
};

// node_modules/@popperjs/core/lib/modifiers/eventListeners.js
var passive = {
  passive: true
};
function effect3(_ref) {
  var state = _ref.state, instance = _ref.instance, options2 = _ref.options;
  var _options$scroll = options2.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options2.resize, resize = _options$resize === void 0 ? true : _options$resize;
  var window2 = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
  if (scroll) {
    scrollParents.forEach(function(scrollParent) {
      scrollParent.addEventListener("scroll", instance.update, passive);
    });
  }
  if (resize) {
    window2.addEventListener("resize", instance.update, passive);
  }
  return function() {
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.removeEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.removeEventListener("resize", instance.update, passive);
    }
  };
}
var eventListeners_default = {
  name: "eventListeners",
  enabled: true,
  phase: "write",
  fn: function fn() {
  },
  effect: effect3,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getOppositePlacement.js
var hash = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function(matched) {
    return hash[matched];
  });
}

// node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js
var hash2 = {
  start: "end",
  end: "start"
};
function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function(matched) {
    return hash2[matched];
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js
function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft,
    scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js
function getWindowScrollBarX(element) {
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}

// node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js
function getViewportRect(element, strategy) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;
  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    var layoutViewport = isLayoutViewport();
    if (layoutViewport || !layoutViewport && strategy === "fixed") {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }
  return {
    width,
    height,
    x: x + getWindowScrollBarX(element),
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js
function getDocumentRect(element) {
  var _element$ownerDocumen;
  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;
  if (getComputedStyle2(body || html).direction === "rtl") {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }
  return {
    width,
    height,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js
function isScrollParent(element) {
  var _getComputedStyle = getComputedStyle2(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}

// node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js
function getScrollParent(node) {
  if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
    return node.ownerDocument.body;
  }
  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }
  return getScrollParent(getParentNode(node));
}

// node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js
function listScrollParents(element, list) {
  var _element$ownerDocumen;
  if (list === void 0) {
    list = [];
  }
  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : updatedList.concat(listScrollParents(getParentNode(target)));
}

// node_modules/@popperjs/core/lib/utils/rectToClientRect.js
function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js
function getInnerBoundingClientRect(element, strategy) {
  var rect = getBoundingClientRect(element, false, strategy === "fixed");
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}
function getClientRectFromMixedType(element, clippingParent, strategy) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element, strategy)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent, strategy) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
}
function getClippingParents(element) {
  var clippingParents2 = listScrollParents(getParentNode(element));
  var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle2(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
  if (!isElement(clipperElement)) {
    return [];
  }
  return clippingParents2.filter(function(clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
  });
}
function getClippingRect(element, boundary, rootBoundary, strategy) {
  var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
  var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents2[0];
  var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent, strategy);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent, strategy));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}

// node_modules/@popperjs/core/lib/utils/computeOffsets.js
function computeOffsets(_ref) {
  var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference2.x + reference2.width / 2 - element.width / 2;
  var commonY = reference2.y + reference2.height / 2 - element.height / 2;
  var offsets;
  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference2.y - element.height
      };
      break;
    case bottom:
      offsets = {
        x: commonX,
        y: reference2.y + reference2.height
      };
      break;
    case right:
      offsets = {
        x: reference2.x + reference2.width,
        y: commonY
      };
      break;
    case left:
      offsets = {
        x: reference2.x - element.width,
        y: commonY
      };
      break;
    default:
      offsets = {
        x: reference2.x,
        y: reference2.y
      };
  }
  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
  if (mainAxis != null) {
    var len = mainAxis === "y" ? "height" : "width";
    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
        break;
      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
        break;
      default:
    }
  }
  return offsets;
}

// node_modules/@popperjs/core/lib/utils/detectOverflow.js
function detectOverflow(state, options2) {
  if (options2 === void 0) {
    options2 = {};
  }
  var _options = options2, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$strategy = _options.strategy, strategy = _options$strategy === void 0 ? state.strategy : _options$strategy, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary, strategy);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets2 = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: "absolute",
    placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset;
  if (elementContext === popper && offsetData) {
    var offset2 = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function(key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
      overflowOffsets[key] += offset2[axis] * multiply;
    });
  }
  return overflowOffsets;
}

// node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js
function computeAutoPlacement(state, options2) {
  if (options2 === void 0) {
    options2 = {};
  }
  var _options = options2, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements2 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
    return getVariation(placement2) === variation;
  }) : basePlacements;
  var allowedPlacements = placements2.filter(function(placement2) {
    return allowedAutoPlacements.indexOf(placement2) >= 0;
  });
  if (allowedPlacements.length === 0) {
    allowedPlacements = placements2;
    if (true) {
      console.error(["Popper: The `allowedAutoPlacements` option did not allow any", "placements. Ensure the `placement` option matches the variation", "of the allowed placements.", 'For example, "auto" cannot be used to allow "bottom-start".', 'Use "auto-start" instead.'].join(" "));
    }
  }
  var overflows = allowedPlacements.reduce(function(acc, placement2) {
    acc[placement2] = detectOverflow(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding
    })[getBasePlacement(placement2)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function(a, b) {
    return overflows[a] - overflows[b];
  });
}

// node_modules/@popperjs/core/lib/modifiers/flip.js
function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }
  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}
function flip(_ref) {
  var state = _ref.state, options2 = _ref.options, name = _ref.name;
  if (state.modifiersData[name]._skip) {
    return;
  }
  var _options$mainAxis = options2.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options2.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options2.fallbackPlacements, padding = options2.padding, boundary = options2.boundary, rootBoundary = options2.rootBoundary, altBoundary = options2.altBoundary, _options$flipVariatio = options2.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options2.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
    return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding,
      flipVariations,
      allowedAutoPlacements
    }) : placement2);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = /* @__PURE__ */ new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements2[0];
  for (var i = 0; i < placements2.length; i++) {
    var placement = placements2[i];
    var _basePlacement = getBasePlacement(placement);
    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? "width" : "height";
    var overflow = detectOverflow(state, {
      placement,
      boundary,
      rootBoundary,
      altBoundary,
      padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }
    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];
    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }
    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }
    if (checks.every(function(check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }
    checksMap.set(placement, checks);
  }
  if (makeFallbackChecks) {
    var numberOfChecks = flipVariations ? 3 : 1;
    var _loop = function _loop2(_i2) {
      var fittingPlacement = placements2.find(function(placement2) {
        var checks2 = checksMap.get(placement2);
        if (checks2) {
          return checks2.slice(0, _i2).every(function(check) {
            return check;
          });
        }
      });
      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };
    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);
      if (_ret === "break")
        break;
    }
  }
  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
}
var flip_default = {
  name: "flip",
  enabled: true,
  phase: "main",
  fn: flip,
  requiresIfExists: ["offset"],
  data: {
    _skip: false
  }
};

// node_modules/@popperjs/core/lib/modifiers/hide.js
function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }
  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}
function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function(side) {
    return overflow[side] >= 0;
  });
}
function hide(_ref) {
  var state = _ref.state, name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: "reference"
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets,
    popperEscapeOffsets,
    isReferenceHidden,
    hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-reference-hidden": isReferenceHidden,
    "data-popper-escaped": hasPopperEscaped
  });
}
var hide_default = {
  name: "hide",
  enabled: true,
  phase: "main",
  requiresIfExists: ["preventOverflow"],
  fn: hide
};

// node_modules/@popperjs/core/lib/modifiers/offset.js
function distanceAndSkiddingToXY(placement, rects, offset2) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
  var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
    placement
  })) : offset2, skidding = _ref[0], distance = _ref[1];
  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}
function offset(_ref2) {
  var state = _ref2.state, options2 = _ref2.options, name = _ref2.name;
  var _options$offset = options2.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function(acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }
  state.modifiersData[name] = data;
}
var offset_default = {
  name: "offset",
  enabled: true,
  phase: "main",
  requires: ["popperOffsets"],
  fn: offset
};

// node_modules/@popperjs/core/lib/modifiers/popperOffsets.js
function popperOffsets(_ref) {
  var state = _ref.state, name = _ref.name;
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: "absolute",
    placement: state.placement
  });
}
var popperOffsets_default = {
  name: "popperOffsets",
  enabled: true,
  phase: "read",
  fn: popperOffsets,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getAltAxis.js
function getAltAxis(axis) {
  return axis === "x" ? "y" : "x";
}

// node_modules/@popperjs/core/lib/modifiers/preventOverflow.js
function preventOverflow(_ref) {
  var state = _ref.state, options2 = _ref.options, name = _ref.name;
  var _options$mainAxis = options2.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options2.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options2.boundary, rootBoundary = options2.rootBoundary, altBoundary = options2.altBoundary, padding = options2.padding, _options$tether = options2.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options2.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary,
    rootBoundary,
    padding,
    altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === "number" ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };
  if (!popperOffsets2) {
    return;
  }
  if (checkMainAxis) {
    var _offsetModifierState$;
    var mainSide = mainAxis === "y" ? top : left;
    var altSide = mainAxis === "y" ? bottom : right;
    var len = mainAxis === "y" ? "height" : "width";
    var offset2 = popperOffsets2[mainAxis];
    var min2 = offset2 + overflow[mainSide];
    var max2 = offset2 - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide];
    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset2 + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset2 + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? min(min2, tetherMin) : min2, offset2, tether ? max(max2, tetherMax) : max2);
    popperOffsets2[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset2;
  }
  if (checkAltAxis) {
    var _offsetModifierState$2;
    var _mainSide = mainAxis === "x" ? top : left;
    var _altSide = mainAxis === "x" ? bottom : right;
    var _offset = popperOffsets2[altAxis];
    var _len = altAxis === "y" ? "height" : "width";
    var _min = _offset + overflow[_mainSide];
    var _max = _offset - overflow[_altSide];
    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;
    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;
    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;
    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;
    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);
    popperOffsets2[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }
  state.modifiersData[name] = data;
}
var preventOverflow_default = {
  name: "preventOverflow",
  enabled: true,
  phase: "main",
  fn: preventOverflow,
  requiresIfExists: ["offset"]
};

// node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js
function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js
function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}

// node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js
function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
}
function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }
  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled, isFixed);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };
  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== "body" || isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }
    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }
  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}

// node_modules/@popperjs/core/lib/utils/orderModifiers.js
function order(modifiers) {
  var map = /* @__PURE__ */ new Map();
  var visited = /* @__PURE__ */ new Set();
  var result = [];
  modifiers.forEach(function(modifier) {
    map.set(modifier.name, modifier);
  });
  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function(dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);
        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }
  modifiers.forEach(function(modifier) {
    if (!visited.has(modifier.name)) {
      sort(modifier);
    }
  });
  return result;
}
function orderModifiers(modifiers) {
  var orderedModifiers = order(modifiers);
  return modifierPhases.reduce(function(acc, phase) {
    return acc.concat(orderedModifiers.filter(function(modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}

// node_modules/@popperjs/core/lib/utils/debounce.js
function debounce(fn2) {
  var pending;
  return function() {
    if (!pending) {
      pending = new Promise(function(resolve) {
        Promise.resolve().then(function() {
          pending = void 0;
          resolve(fn2());
        });
      });
    }
    return pending;
  };
}

// node_modules/@popperjs/core/lib/utils/format.js
function format(str) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }
  return [].concat(args).reduce(function(p, c) {
    return p.replace(/%s/, c);
  }, str);
}

// node_modules/@popperjs/core/lib/utils/validateModifiers.js
var INVALID_MODIFIER_ERROR = 'Popper: modifier "%s" provided an invalid %s property, expected %s but got %s';
var MISSING_DEPENDENCY_ERROR = 'Popper: modifier "%s" requires "%s", but "%s" modifier is not available';
var VALID_PROPERTIES = ["name", "enabled", "phase", "fn", "effect", "requires", "options"];
function validateModifiers(modifiers) {
  modifiers.forEach(function(modifier) {
    [].concat(Object.keys(modifier), VALID_PROPERTIES).filter(function(value, index, self) {
      return self.indexOf(value) === index;
    }).forEach(function(key) {
      switch (key) {
        case "name":
          if (typeof modifier.name !== "string") {
            console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '"name"', '"string"', '"' + String(modifier.name) + '"'));
          }
          break;
        case "enabled":
          if (typeof modifier.enabled !== "boolean") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"enabled"', '"boolean"', '"' + String(modifier.enabled) + '"'));
          }
          break;
        case "phase":
          if (modifierPhases.indexOf(modifier.phase) < 0) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"phase"', "either " + modifierPhases.join(", "), '"' + String(modifier.phase) + '"'));
          }
          break;
        case "fn":
          if (typeof modifier.fn !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"fn"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "effect":
          if (modifier.effect != null && typeof modifier.effect !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"effect"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "requires":
          if (modifier.requires != null && !Array.isArray(modifier.requires)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requires"', '"array"', '"' + String(modifier.requires) + '"'));
          }
          break;
        case "requiresIfExists":
          if (!Array.isArray(modifier.requiresIfExists)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requiresIfExists"', '"array"', '"' + String(modifier.requiresIfExists) + '"'));
          }
          break;
        case "options":
        case "data":
          break;
        default:
          console.error('PopperJS: an invalid property has been provided to the "' + modifier.name + '" modifier, valid properties are ' + VALID_PROPERTIES.map(function(s) {
            return '"' + s + '"';
          }).join(", ") + '; but "' + key + '" was provided.');
      }
      modifier.requires && modifier.requires.forEach(function(requirement) {
        if (modifiers.find(function(mod) {
          return mod.name === requirement;
        }) == null) {
          console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));
        }
      });
    });
  });
}

// node_modules/@popperjs/core/lib/utils/uniqueBy.js
function uniqueBy(arr, fn2) {
  var identifiers = /* @__PURE__ */ new Set();
  return arr.filter(function(item) {
    var identifier = fn2(item);
    if (!identifiers.has(identifier)) {
      identifiers.add(identifier);
      return true;
    }
  });
}

// node_modules/@popperjs/core/lib/utils/mergeByName.js
function mergeByName(modifiers) {
  var merged = modifiers.reduce(function(merged2, current) {
    var existing = merged2[current.name];
    merged2[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged2;
  }, {});
  return Object.keys(merged).map(function(key) {
    return merged[key];
  });
}

// node_modules/@popperjs/core/lib/createPopper.js
var INVALID_ELEMENT_ERROR = "Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.";
var INFINITE_LOOP_ERROR = "Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.";
var DEFAULT_OPTIONS = {
  placement: "bottom",
  modifiers: [],
  strategy: "absolute"
};
function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  return !args.some(function(element) {
    return !(element && typeof element.getBoundingClientRect === "function");
  });
}
function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }
  var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper2(reference2, popper2, options2) {
    if (options2 === void 0) {
      options2 = defaultOptions;
    }
    var state = {
      placement: "bottom",
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference2,
        popper: popper2
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state,
      setOptions: function setOptions(setOptionsAction) {
        var options3 = typeof setOptionsAction === "function" ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options3);
        state.scrollParents = {
          reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
          popper: listScrollParents(popper2)
        };
        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
        state.orderedModifiers = orderedModifiers.filter(function(m) {
          return m.enabled;
        });
        if (true) {
          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function(_ref) {
            var name = _ref.name;
            return name;
          });
          validateModifiers(modifiers);
          if (getBasePlacement(state.options.placement) === auto) {
            var flipModifier = state.orderedModifiers.find(function(_ref2) {
              var name = _ref2.name;
              return name === "flip";
            });
            if (!flipModifier) {
              console.error(['Popper: "auto" placements require the "flip" modifier be', "present and enabled to work."].join(" "));
            }
          }
          var _getComputedStyle = getComputedStyle2(popper2), marginTop = _getComputedStyle.marginTop, marginRight = _getComputedStyle.marginRight, marginBottom = _getComputedStyle.marginBottom, marginLeft = _getComputedStyle.marginLeft;
          if ([marginTop, marginRight, marginBottom, marginLeft].some(function(margin) {
            return parseFloat(margin);
          })) {
            console.warn(['Popper: CSS "margin" styles cannot be used to apply padding', "between the popper and its reference element or boundary.", "To replicate margin, use the `offset` modifier, as well as", "the `padding` option in the `preventOverflow` and `flip`", "modifiers."].join(" "));
          }
        }
        runModifierEffects();
        return instance.update();
      },
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }
        var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
        if (!areValidElements(reference3, popper3)) {
          if (true) {
            console.error(INVALID_ELEMENT_ERROR);
          }
          return;
        }
        state.rects = {
          reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
          popper: getLayoutRect(popper3)
        };
        state.reset = false;
        state.placement = state.options.placement;
        state.orderedModifiers.forEach(function(modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        var __debug_loops__ = 0;
        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (true) {
            __debug_loops__ += 1;
            if (__debug_loops__ > 100) {
              console.error(INFINITE_LOOP_ERROR);
              break;
            }
          }
          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }
          var _state$orderedModifie = state.orderedModifiers[index], fn2 = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
          if (typeof fn2 === "function") {
            state = fn2({
              state,
              options: _options,
              name,
              instance
            }) || state;
          }
        }
      },
      update: debounce(function() {
        return new Promise(function(resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };
    if (!areValidElements(reference2, popper2)) {
      if (true) {
        console.error(INVALID_ELEMENT_ERROR);
      }
      return instance;
    }
    instance.setOptions(options2).then(function(state2) {
      if (!isDestroyed && options2.onFirstUpdate) {
        options2.onFirstUpdate(state2);
      }
    });
    function runModifierEffects() {
      state.orderedModifiers.forEach(function(_ref3) {
        var name = _ref3.name, _ref3$options = _ref3.options, options3 = _ref3$options === void 0 ? {} : _ref3$options, effect4 = _ref3.effect;
        if (typeof effect4 === "function") {
          var cleanupFn = effect4({
            state,
            name,
            instance,
            options: options3
          });
          var noopFn = function noopFn2() {
          };
          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }
    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function(fn2) {
        return fn2();
      });
      effectCleanupFns = [];
    }
    return instance;
  };
}

// node_modules/@popperjs/core/lib/popper.js
var defaultModifiers = [eventListeners_default, popperOffsets_default, computeStyles_default, applyStyles_default, offset_default, flip_default, preventOverflow_default, arrow_default, hide_default];
var createPopper = /* @__PURE__ */ popperGenerator({
  defaultModifiers
});

// src/suggester/suggest.ts
var wrapAround = (value, size) => {
  return (value % size + size) % size;
};
var Suggest = class {
  constructor(owner, containerEl, scope) {
    this.owner = owner;
    this.containerEl = containerEl;
    containerEl.on("click", ".suggestion-item", this.onSuggestionClick.bind(this));
    containerEl.on("mousemove", ".suggestion-item", this.onSuggestionMouseover.bind(this));
    scope.register([], "ArrowUp", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem - 1, true);
        return false;
      }
    });
    scope.register([], "ArrowDown", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem + 1, true);
        return false;
      }
    });
    scope.register([], "Enter", (event) => {
      if (!event.isComposing) {
        this.useSelectedItem(event);
        return false;
      }
    });
  }
  onSuggestionClick(event, el) {
    event.preventDefault();
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
    this.useSelectedItem(event);
  }
  onSuggestionMouseover(_event, el) {
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
  }
  setSuggestions(values) {
    this.containerEl.empty();
    const suggestionEls = [];
    values.forEach((value) => {
      const suggestionEl = this.containerEl.createDiv("suggestion-item");
      this.owner.renderSuggestion(value, suggestionEl);
      suggestionEls.push(suggestionEl);
    });
    this.values = values;
    this.suggestions = suggestionEls;
    this.setSelectedItem(0, false);
  }
  useSelectedItem(event) {
    const currentValue = this.values[this.selectedItem];
    if (currentValue) {
      this.owner.selectSuggestion(currentValue, event);
    }
  }
  setSelectedItem(selectedIndex, scrollIntoView) {
    const normalizedIndex = wrapAround(selectedIndex, this.suggestions.length);
    const prevSelectedSuggestion = this.suggestions[this.selectedItem];
    const selectedSuggestion = this.suggestions[normalizedIndex];
    prevSelectedSuggestion == null ? void 0 : prevSelectedSuggestion.removeClass("is-selected");
    selectedSuggestion == null ? void 0 : selectedSuggestion.addClass("is-selected");
    this.selectedItem = normalizedIndex;
    if (scrollIntoView) {
      selectedSuggestion.scrollIntoView(false);
    }
  }
};
var TextInputSuggest = class {
  constructor(inputEl) {
    this.inputEl = inputEl;
    this.scope = new import_obsidian15.Scope();
    this.suggestEl = createDiv("suggestion-container");
    const suggestion = this.suggestEl.createDiv("suggestion");
    this.suggest = new Suggest(this, suggestion, this.scope);
    this.scope.register([], "Escape", this.close.bind(this));
    this.inputEl.addEventListener("input", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("focus", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("blur", this.close.bind(this));
    this.suggestEl.on("mousedown", ".suggestion-container", (event) => {
      event.preventDefault();
    });
  }
  onInputChanged() {
    const inputStr = this.inputEl.value;
    const suggestions = this.getSuggestions(inputStr);
    if (!suggestions) {
      this.close();
      return;
    }
    if (suggestions.length > 0) {
      this.suggest.setSuggestions(suggestions);
      this.open(app.dom.appContainerEl, this.inputEl);
    } else {
      this.close();
    }
  }
  open(container, inputEl) {
    app.keymap.pushScope(this.scope);
    container.appendChild(this.suggestEl);
    this.popper = createPopper(inputEl, this.suggestEl, {
      placement: "bottom-start",
      modifiers: [
        {
          name: "sameWidth",
          enabled: true,
          fn: ({ state, instance }) => {
            const targetWidth = `${state.rects.reference.width}px`;
            if (state.styles.popper.width === targetWidth) {
              return;
            }
            state.styles.popper.width = targetWidth;
            instance.update();
          },
          phase: "beforeWrite",
          requires: ["computeStyles"]
        }
      ]
    });
  }
  close() {
    app.keymap.popScope(this.scope);
    this.suggest.setSuggestions([]);
    if (this.popper)
      this.popper.destroy();
    this.suggestEl.detach();
  }
};

// src/suggester/FileSuggester.ts
var FileSuggest = class extends TextInputSuggest {
  constructor(inputEl, plugin, folder, extenstion = "md") {
    super(inputEl);
    this.inputEl = inputEl;
    this.plugin = plugin;
    this.folder = folder;
    this.extenstion = extenstion;
    this.plugin = plugin;
  }
  getSuggestions(input_str) {
    const all_files = [];
    try {
      all_files.push(...get_tfiles_from_folder(this.plugin, this.folder));
    } catch (error) {
    }
    const files = [];
    const lower_input_str = input_str.toLowerCase();
    all_files.forEach((file) => {
      if (file instanceof import_obsidian16.TFile && file.extension === this.extenstion && file.path.toLowerCase().contains(lower_input_str)) {
        files.push(file);
      }
    });
    return files;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var AbstractListBasedField = class extends FieldManager2 {
  constructor(plugin, field, type) {
    super(plugin, field, type);
  }
  createListNotePathContainer(container, plugin) {
    const valuesListNotePathContainer = container.createDiv({ cls: "field-container" });
    valuesListNotePathContainer.createDiv({ text: `Path of the note`, cls: "label" });
    const input = new import_obsidian17.TextComponent(valuesListNotePathContainer);
    input.inputEl.addClass("full-width");
    input.inputEl.addClass("with-label");
    new FileSuggest(input.inputEl, plugin, "/");
    const listNotePath = this.field.options.valuesListNotePath;
    input.setValue(listNotePath || "");
    input.setPlaceholder("Path/of/the/note.md");
    input.onChange((value) => this.field.options.valuesListNotePath = value);
    return valuesListNotePathContainer;
  }
  removePresetValue(key) {
    let newValues = {};
    for (let _key in this.field.options.valuesList) {
      if (key !== _key) {
        newValues[_key] = this.field.options.valuesList[_key];
      }
      ;
    }
    ;
    this.field.options.valuesList = newValues;
  }
  createValuesListContainer(parentContainer) {
    const presetValuesFields = parentContainer.createDiv();
    const valuesList = presetValuesFields.createDiv();
    const valuesListBody = valuesList.createDiv();
    Object.keys(this.field.options.valuesList).forEach((key) => {
      this.valuesPromptComponents.push(this.createValueContainer(valuesListBody, key));
    });
    this.createAddButton(valuesList, valuesListBody);
    return presetValuesFields;
  }
  createValueContainer(parentNode, key) {
    const values = this.field.options.valuesList || {};
    const presetValue = values[key];
    const valueContainer = parentNode.createDiv({ cls: "field-container" });
    const input = new import_obsidian17.TextComponent(valueContainer);
    input.inputEl.addClass("full-width");
    this.valuesPromptComponents.push(input);
    input.setValue(presetValue);
    input.onChange((value) => {
      this.field.options.valuesList[key] = value;
      FieldSettingsModal.removeValidationError(input);
    });
    const valueRemoveButton = new import_obsidian17.ButtonComponent(valueContainer);
    valueRemoveButton.setIcon("trash").onClick((evt) => {
      evt.preventDefault;
      this.removePresetValue(key);
      parentNode.removeChild(valueContainer);
      this.valuesPromptComponents.remove(input);
    });
    if (key != Object.keys(this.field.options)[0]) {
      const valueUpgradeButton = new import_obsidian17.ButtonComponent(valueContainer);
      (0, import_obsidian17.setIcon)(valueUpgradeButton.buttonEl, "up-chevron-glyph");
      valueUpgradeButton.onClick((evt) => {
        const thisValue = values[key];
        const inputIndex = this.valuesPromptComponents.indexOf(input);
        const upperComponent = inputIndex !== -1 ? this.valuesPromptComponents[inputIndex - 1] : this.valuesPromptComponents.last();
        if (upperComponent) {
          const upperValue = upperComponent.inputEl.value;
          const upperKey = Object.keys(values).filter((k) => values[k] == upperValue)[0];
          if (upperKey) {
            upperComponent.setValue(thisValue);
            values[upperKey] = thisValue;
            input.setValue(upperValue);
            values[key] = upperValue;
          }
          ;
        }
        ;
      });
    }
    ;
    return input;
  }
  validateValue(value) {
    return true;
  }
  getOptionsStr() {
    switch (this.field.options.sourceType) {
      case "ValuesList" /* ValuesList */:
        return Object.values(this.field.options.valuesList).join(", ");
      case "ValuesListNotePath" /* ValuesListNotePath */:
        return this.field.options.valuesListNotePath;
      case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
        return this.field.options.valuesFromDVQuery;
      default:
        return "";
    }
  }
  getOptionsList(dvFile = void 0) {
    var _a;
    let values = [];
    if (Array.isArray(this.field.options)) {
      values = this.field.options;
    } else if (!this.field.options.sourceType) {
      values = Object.values(this.field.options);
    } else {
      switch (this.field.options.sourceType) {
        case "ValuesList" /* ValuesList */:
          values = Object.values(this.field.options.valuesList);
          break;
        case "ValuesListNotePath" /* ValuesListNotePath */:
          values = this.plugin.fieldIndex.valuesListNotePathValues.get(this.field.options.valuesListNotePath) || [];
          break;
        case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
          {
            const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
            if (dvApi) {
              values = new Function("dv", "current", `return ${this.field.options.valuesFromDVQuery}`)(dvApi, dvFile);
            } else {
              values = [];
            }
          }
          break;
        default:
          values = [];
          break;
      }
    }
    return values;
  }
  validateOptions() {
    let error = false;
    this.valuesPromptComponents.forEach((input) => {
      var _a, _b;
      if (/[,]/gu.test(input.inputEl.value) && ((_a = input.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, "Values cannot contain a comma");
        error = true;
      }
      ;
      if (input.inputEl.value == "" && ((_b = input.inputEl.parentElement) == null ? void 0 : _b.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, "Values can't be null.");
        error = true;
      }
      ;
    });
    return !error;
  }
  createAddButton(valuesList, valuesListBody) {
    const valuesListFooter = valuesList.createDiv();
    const addValue = valuesListFooter.createEl("button");
    addValue.type = "button";
    addValue.textContent = "Add a value";
    addValue.onClickEvent((evt) => __async(this, null, function* () {
      evt.preventDefault;
      let newKeyNumber = 1;
      Object.keys(this.field.options.valuesList).forEach((key) => {
        if (parseInt(key) && parseInt(key) >= newKeyNumber) {
          newKeyNumber = parseInt(key) + 1;
        }
        ;
      });
      const newKey = newKeyNumber.toString();
      this.field.options.valuesList[newKey] = "";
      this.createValueContainer(valuesListBody, newKey);
    }));
    valuesList.createEl("hr");
  }
  createValuesFromDVQueryContainer(parentContainer) {
    const valuesFromDVQueryTopContainer = parentContainer.createDiv({ cls: "vstacked" });
    valuesFromDVQueryTopContainer.createEl("span", { text: "Dataview function" });
    valuesFromDVQueryTopContainer.createEl("span", { text: "Dataview query returning a list of string (<dv> object is available)", cls: "sub-text" });
    const valuesFromDVQueryContainer = valuesFromDVQueryTopContainer.createDiv({ cls: "field-container" });
    const valuesFromDVQuery = new import_obsidian17.TextAreaComponent(valuesFromDVQueryContainer);
    valuesFromDVQuery.inputEl.addClass("full-width");
    valuesFromDVQuery.inputEl.cols = 65;
    valuesFromDVQuery.inputEl.rows = 8;
    valuesFromDVQuery.setPlaceholder("ex: dv.pages('#student').map(p => p.name)");
    valuesFromDVQuery.setValue(this.field.options.valuesFromDVQuery || "");
    valuesFromDVQuery.onChange((value) => {
      this.field.options.valuesFromDVQuery = value;
    });
    return valuesFromDVQueryTopContainer;
  }
  displaySelectedTypeContainer(optionContainers, value) {
    Object.keys(optionContainers).forEach((key) => {
      if (key === value) {
        optionContainers[key].show();
      } else {
        optionContainers[key].hide();
      }
    });
  }
  createSettingContainer(container, plugin, location) {
    const sourceTypeContainer = container.createDiv({ cls: "field-container" });
    sourceTypeContainer.createDiv({ text: "Values source type", cls: "label" });
    sourceTypeContainer.createDiv({ cls: "spacer" });
    const sourceType = new import_obsidian17.DropdownComponent(sourceTypeContainer);
    if (!this.field.options.sourceType) {
      if (typeof this.field.options === "object" && Object.keys(this.field.options).every((key) => !isNaN(parseInt(key)))) {
        const valuesList = {};
        Object.keys(this.field.options).forEach((key) => valuesList[key] = this.field.options[key]);
        this.field.options = {};
        this.field.options.valuesList = valuesList;
      } else {
        this.field.options = {};
      }
      this.field.options.sourceType = "ValuesList" /* ValuesList */;
      this.field.options.valuesListNotePath = "";
      this.field.options.valuesFromDVQuery = "";
    }
    Object.keys(Type2).forEach((option) => sourceType.addOption(option, typeDisplay[option]));
    sourceType.setValue(this.field.options.sourceType || "ValuesList" /* ValuesList */);
    const valuesListNotePathContainer = this.createListNotePathContainer(container, plugin);
    const presetValuesFieldsContainer = this.createValuesListContainer(container);
    const valuesFromDVQueryContainer = this.createValuesFromDVQueryContainer(container);
    const valuesContainers = {
      "ValuesList": presetValuesFieldsContainer,
      "ValuesListNotePath": valuesListNotePathContainer,
      "ValuesFromDVQuery": valuesFromDVQueryContainer
    };
    sourceType.onChange((value) => {
      this.field.options.sourceType = value;
      this.displaySelectedTypeContainer(valuesContainers, value);
    });
    this.displaySelectedTypeContainer(valuesContainers, this.field.options.sourceType);
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
  }
};

// src/fields/fieldManagers/SelectField.ts
var SelectField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Select" /* Select */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new ValueSuggestModal(this.plugin, file, value, this.field);
    modal.titleEl.setText("Select value");
    const action = () => modal.open();
    if (SelectField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["Select" /* Select */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (SelectField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Select" /* Select */]
      });
    } else if (SelectField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Multi" /* Multi */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name] || "", attrs));
    const spacer = fieldContainer.createEl("div", { cls: "spacer-1" });
    const dropDownButton = fieldContainer.createEl("button");
    (0, import_obsidian18.setIcon)(dropDownButton, "down-chevron-glyph");
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian18.TFile && file.extension == "md") {
      fieldModal = new ValueSuggestModal(this.plugin, file, p[this.field.name], this.field);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    dropDownButton.onclick = () => fieldModal.open();
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      dropDownButton.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        dropDownButton.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        dropDownButton.hide();
        spacer.show();
      };
    }
  }
};

// src/fields/fieldManagers/CycleField.ts
var import_obsidian19 = require("obsidian");
var CycleField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Cycle" /* Cycle */);
    this.valuesPromptComponents = [];
    this.showModalOption = false;
  }
  createSettingContainer(container, plugin, location) {
    const allowNullValueContainer = container.createDiv({ cls: "field-container" });
    allowNullValueContainer.createDiv({ cls: "label", text: "Cycle begins by a null value" });
    allowNullValueContainer.createDiv({ cls: "spacer" });
    const allowNullToggler = new import_obsidian19.ToggleComponent(allowNullValueContainer);
    allowNullToggler.setValue(this.field.options.allowNull || false);
    allowNullToggler.onChange((value) => this.field.options.allowNull = value);
    super.createSettingContainer(container, plugin, location);
  }
  nextOption(rawValue) {
    let nextOption;
    const values = this.getOptionsList();
    const value = !rawValue ? "" : rawValue;
    if (values.indexOf(value) === -1) {
      nextOption = values[0] || "";
    } else {
      nextOption = values[(values.indexOf(value) + 1) % values.length];
    }
    return nextOption;
  }
  getOptionsList() {
    return this.field.options.allowNull ? ["", ...super.getOptionsList()] : super.getOptionsList();
  }
  getRawOptionFromDuration(duration2) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let matchedValue = void 0;
    if (dvApi && dvApi.value.isDuration(duration2)) {
      this.getOptionsList().forEach((option) => {
        const dvOption = dvApi.duration(option);
        if (Object.keys(duration2.values).every((j) => !duration2.values[j] && !dvOption.values[j] || duration2.values[j] === dvOption.values[j])) {
          matchedValue = option;
        }
      });
    }
    return matchedValue;
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let valueText;
    if (dvApi) {
      switch (dvApi.page(file.path)[fieldName]) {
        case void 0:
          valueText = "";
          break;
        case null:
          valueText = "";
          break;
        case false:
          valueText = "false";
          break;
        case 0:
          valueText = "0";
          break;
        default:
          valueText = dvApi.page(file.path)[fieldName];
      }
    } else {
      valueText = "";
    }
    container.createDiv({ text: this.getRawOptionFromDuration(valueText) || valueText });
  }
  next(name, value, file) {
    return __async(this, null, function* () {
      let matchedValue = this.getRawOptionFromDuration(value) || value;
      yield postValues(this.plugin, [{ name, payload: { value: this.nextOption(matchedValue).toString() } }], file);
    });
  }
  addFieldOption(name, value, file, location) {
    let matchedValue = this.getRawOptionFromDuration(value) || value;
    const iconName = FieldIcon["Cycle" /* Cycle */];
    const action = () => __async(this, null, function* () {
      return this.next(name, value, file);
    });
    if (CycleField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`${name} : ${matchedValue} \u25B7 ${this.nextOption(matchedValue)}`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (CycleField.isSuggest(location)) {
      location.options.push({
        id: `${name}_${matchedValue}_${this.nextOption(matchedValue)}`,
        actionLabel: `<span><b>${name}</b> : ${matchedValue} \u25B7 ${this.nextOption(matchedValue)}</span>`,
        action,
        icon: iconName
      });
    } else if (CycleField.isFieldOptions(location)) {
      location.addOption(iconName, action, `${matchedValue} \u25B7 ${this.nextOption(matchedValue)}`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
    const nextOption = this.nextOption(p[this.field.name]);
    const spacer = fieldContainer.createEl("div", { cls: "spacer" });
    const cycleBtn = fieldContainer.createEl("button");
    (0, import_obsidian19.setIcon)(cycleBtn, FieldIcon["Cycle" /* Cycle */]);
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      cycleBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        cycleBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        cycleBtn.hide();
        spacer.show();
      };
    }
    cycleBtn.onclick = (e) => {
      var _a2;
      CycleField.replaceValues(this.plugin, p.file.path, this.field.name, nextOption);
      if (!((_a2 = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a2.alwaysOn)) {
        cycleBtn.hide();
        spacer.show();
      }
    };
  }
};

// src/fields/fieldManagers/MultiField.ts
var import_obsidian23 = require("obsidian");

// src/modals/fields/MultiSelectModal.ts
var import_obsidian22 = require("obsidian");

// src/fields/fieldManagers/FileField.ts
var import_obsidian21 = require("obsidian");

// src/modals/fields/SingleFileModal.ts
var import_obsidian20 = require("obsidian");
var FileFuzzySuggester = class extends import_obsidian20.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      if (dvApi.value.isLink(initialValueObject)) {
        const file2 = this.plugin.app.vault.getAbstractFileByPath(initialValueObject.path);
        if (file2 instanceof import_obsidian20.TFile)
          this.selectedFile = file2;
      }
    }
    this.containerEl.addClass("metadata-menu");
  }
  getItems() {
    const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
      return a.basename < b.basename ? -1 : 1;
    };
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file).sort(sortingMethod);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  renderSuggestion(value, el) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "item-with-add-on" });
      suggestionContainer.createDiv({
        text: new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path))
      });
      const filePath = suggestionContainer.createDiv({ cls: "add-on" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("value-container");
    const spacer = this.containerEl.createDiv({ cls: "spacer" });
    el.appendChild(spacer);
    if (((_b = this.selectedFile) == null ? void 0 : _b.path) === value.item.path) {
      el.addClass("value-checked");
      const iconContainer = el.createDiv({ cls: "icon-container" });
      (0, import_obsidian20.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
      var _a;
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      let alias = void 0;
      if (dvApi && this.field.options.customRendering) {
        alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(item.path));
      }
      const value = FileField.buildMarkDownLink(this.plugin, this.file, item.basename, void 0, alias);
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value } }], this.file, this.lineNumber, this.asList, this.asComment);
    });
  }
};

// src/fields/fieldManagers/FileField.ts
var FileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "File" /* File */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian21.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  addFieldOption(name, value, file, location) {
    const modal = new FileFuzzySuggester(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select value");
    const action = () => modal.open();
    if (FileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (FileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["File" /* File */]
      });
    } else if (FileField.isFieldOptions(location)) {
      location.addOption(FieldIcon["File" /* File */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const value = dvApi.page(file.path)[fieldName];
      if (dvApi.value.isLink(value)) {
        const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
        link.onclick = () => {
          this.plugin.app.workspace.openLinkText(value.path, file.path, true);
          onClicked();
        };
      } else {
        container.createDiv({ text: value });
      }
    }
    container.createDiv();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
    const searchBtn = fieldContainer.createEl("button");
    (0, import_obsidian21.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    const spacer = fieldContainer.createEl("div", { cls: "spacer" });
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian21.TFile && file.extension == "md") {
      fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn) || true) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
  }
  createFileContainer(container) {
    const dvQueryStringTopContainer = container.createDiv({ cls: "vstacked" });
    dvQueryStringTopContainer.createEl("span", { text: "Dataview Query (optional)" });
    const dvQueryStringContainer = dvQueryStringTopContainer.createDiv({ cls: "field-container" });
    this.dvQueryString = new import_obsidian21.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.inputEl.addClass("full-width");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingTopContainer = container.createDiv({ cls: "vstacked" });
    customeRenderingTopContainer.createEl("span", { text: "Alias" });
    customeRenderingTopContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "sub-text" });
    customeRenderingTopContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customeRenderingContainer = customeRenderingTopContainer.createDiv({ cls: "field-container" });
    const customRendering = new import_obsidian21.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.inputEl.addClass("full-width");
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
    const customSortingTopContainer = container.createDiv({ cls: "vstacked" });
    customSortingTopContainer.createEl("span", { text: "Sorting order" });
    customSortingTopContainer.createEl("span", { text: "Personalise the sorting order of your links with a instruction taking 2 files (a, b) and returning -1, 0 or 1", cls: "sub-text" });
    customSortingTopContainer.createEl("code", {
      text: `(a: TFile, b: TFile): number`
    });
    const customSortingContainer = customSortingTopContainer.createDiv({ cls: "field-container" });
    const customSorting = new import_obsidian21.TextAreaComponent(customSortingContainer);
    customSorting.inputEl.cols = 50;
    customSorting.inputEl.rows = 4;
    customSorting.inputEl.addClass("full-width");
    customSorting.setValue(this.field.options.customSorting || "");
    customSorting.setPlaceholder("Javascript instruction, (a: TFile, b: TFile): number\nexample 1 (alphabetical order): a.basename < b.basename ? 1 : -1 \nexample 2 (creation time newer to older): b.stat.ctime - b.stat.ctime");
    customSorting.onChange((value) => {
      this.field.options.customSorting = value;
      FieldSettingsModal.removeValidationError(customSorting);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.createFileContainer(parentContainer);
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    return true;
  }
};

// src/modals/fields/MultiSelectModal.ts
var MultiSuggestModal = class extends import_obsidian22.SuggestModal {
  constructor(plugin, file, field, initialOptions, lineNumber = -1, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    if (initialOptions) {
      if (Array.isArray(initialOptions)) {
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        if (dvApi && initialOptions.some((o) => dvApi.value.isLink(o))) {
          this.selectedOptions = initialOptions.map((item) => {
            if (dvApi.value.isLink(item)) {
              return FileField.buildMarkDownLink(this.plugin, this.file, item.path);
            } else {
              return item.toString();
            }
          });
        }
        this.selectedOptions = initialOptions.map((item) => item.toString());
      } else if (typeof initialOptions === "string" && initialOptions.toString().startsWith("[[")) {
        this.selectedOptions = initialOptions.split(",").map((item) => item.trim());
      } else {
        if (Object.keys(initialOptions).includes("path")) {
          this.selectedOptions = [`[[${initialOptions.path.replace(".md", "")}]]`];
        } else if (typeof initialOptions === "string") {
          this.selectedOptions = initialOptions.toString().replace(/^\[(.*)\]$/, "$1").split(",").map((item) => item.trim());
        }
      }
    } else {
      this.selectedOptions = [];
    }
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(MultiSuggestModal.prototype, this, "onOpen").call(this);
      this.containerEl.onkeydown = (e) => __async(this, null, function* () {
        if (e.key == "Enter" && e.altKey) {
          yield this.replaceValues();
          this.close();
        }
      });
      const updateSettingsInfoContainer = this.containerEl.createDiv({ cls: "value-add-notice" });
      const notice = updateSettingsInfoContainer.createDiv({ cls: "label" });
      updateSettingsInfoContainer.createDiv({ cls: "spacer" });
      updateSettingsInfoContainer.hide();
      this.containerEl.find(".prompt").prepend(updateSettingsInfoContainer);
      const inputContainer = this.containerEl.createDiv({ cls: "suggester-input" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "footer-actions" });
      buttonContainer.createDiv({ cls: "spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "info" });
      infoContainer.setText("Alt+Enter to save");
      this.addButton = new import_obsidian22.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => __async(this, null, function* () {
        yield this.addNewValueToSettings();
        notice.setText(`${this.inputEl.value} added to the field settings
click on reload`);
        this.addButton.buttonEl.hide();
        updateSettingsInfoContainer.show();
      }));
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      this.reloadButton = new import_obsidian22.ButtonComponent(updateSettingsInfoContainer);
      this.reloadButton.setIcon("refresh-cw");
      this.reloadButton.setCta();
      this.reloadButton.onClick(() => __async(this, null, function* () {
        this.inputEl.value = "";
        this.updateSuggestions();
        updateSettingsInfoContainer.hide();
        this.addButton.buttonEl.hide();
      }));
      const confirmButton = new import_obsidian22.ButtonComponent(buttonContainer);
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => __async(this, null, function* () {
        yield this.replaceValues();
        this.close();
      }));
      const cancelButton = new import_obsidian22.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => {
        this.close();
      });
      const clearButton = new import_obsidian22.ButtonComponent(buttonContainer);
      clearButton.setIcon("trash");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("danger");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      var _a, _b;
      const newValue = this.inputEl.value;
      const fileClassName = (_b = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field) => field.name === this.field.name)) == null ? void 0 : _b.fileClassName;
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian22.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length + 1}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian22.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.plugin.fieldIndex.fullIndex("valueAdd");
      this.selectedOptions.push(newValue);
    });
  }
  replaceValues() {
    return __async(this, null, function* () {
      const options2 = this.selectedOptions;
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: options2.join(", ") } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
    });
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedOptions.includes(values[i].toString())) {
        s.addClass("value-checked");
        if (s.querySelectorAll(".icon-container").length == 0) {
          const iconContainer = s.createDiv({ cls: "icon-container" });
          (0, import_obsidian22.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("value-checked");
        s.querySelectorAll(".icon-container").forEach((icon) => icon.remove());
      }
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("value-container");
    const spacer = this.containerEl.createDiv({ cls: "spacer" });
    el.appendChild(spacer);
    if (this.selectedOptions.includes(value.toString())) {
      el.addClass("value-checked");
      const iconContainer = el.createDiv({ cls: "icon-container" });
      (0, import_obsidian22.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  selectSuggestion(value, evt) {
    if (this.selectedOptions.includes(value.toString())) {
      this.selectedOptions.remove(value.toString());
    } else {
      this.selectedOptions.push(value.toString());
    }
    this.renderSelected();
  }
  onChooseSuggestion(item, evt) {
  }
};

// src/fields/fieldManagers/MultiField.ts
var MultiField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Multi" /* Multi */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiSuggestModal(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select values");
    const action = () => modal.open();
    if (MultiField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Multi" /* Multi */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Multi" /* Multi */]
      });
    } else if (MultiField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Multi" /* Multi */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new MultiSuggestModal(this.plugin, file, this.field, value || "", lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Select options for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a, _b, _c;
    let valueHovered = false;
    let currentValues = [];
    if (p[this.field.name]) {
      if (Object.keys(p[this.field.name]).includes("path")) {
        currentValues = [`[[${p[this.field.name].path.replace(".md", "")}]]`];
      } else if (Array.isArray(p[this.field.name])) {
        p[this.field.name].forEach((item) => {
          if (Object.keys(item).includes("path")) {
            currentValues.push(`[[${item.path.replace(".md", "")}]]`);
          } else {
            currentValues.push(item.trim());
          }
        });
      } else {
        currentValues = ((_a = p[this.field.name]) == null ? void 0 : _a.split(",").map((v) => v.trim())) || [];
      }
    }
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian23.TFile && file.extension == "md") {
      fieldModal = new MultiSuggestModal(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    const valuesContainer = fieldContainer.createDiv({ cls: "values-container" });
    currentValues.forEach((v) => {
      const valueContainer = valuesContainer.createDiv({ cls: "item-container" });
      const valueRemoveBtn = valueContainer.createEl("button");
      const valueLabel = valueContainer.createDiv({ cls: "label", text: v });
      (0, import_obsidian23.setIcon)(valueRemoveBtn, "cross");
      valueRemoveBtn.hide();
      valueRemoveBtn.onclick = () => __async(this, null, function* () {
        const remainingValues = currentValues.filter((cV) => cV !== v).join(", ");
        MultiField.replaceValues(this.plugin, p.file.path, this.field.name, remainingValues);
      });
      valueContainer.onmouseover = () => {
        valueHovered = true;
        doubleSpacer.hide();
        singleSpacer.hide();
        valueRemoveBtn.show();
        valueLabel.addClass("hovered");
      };
      valueContainer.onmouseout = () => {
        valueHovered = false;
        valueRemoveBtn.hide();
        singleSpacer.show();
        doubleSpacer.hide();
        valueLabel.removeClass("hovered");
      };
    });
    const addBtn = valuesContainer.createEl("button");
    (0, import_obsidian23.setIcon)(addBtn, "list-plus");
    addBtn.onclick = () => fieldModal.open();
    const singleSpacer = valuesContainer.createDiv({ cls: "spacer-1" });
    const doubleSpacer = valuesContainer.createDiv({ cls: "spacer-2" });
    if (!((_b = attrs == null ? void 0 : attrs.options) == null ? void 0 : _b.alwaysOn)) {
      addBtn.hide();
      fieldContainer.onmouseover = () => {
        addBtn.show();
        doubleSpacer.hide();
        if (!valueHovered)
          singleSpacer.show();
      };
      fieldContainer.onmouseout = () => {
        addBtn.hide();
        singleSpacer.hide();
        doubleSpacer.show();
      };
    }
    if (!((_c = attrs == null ? void 0 : attrs.options) == null ? void 0 : _c.alwaysOn)) {
      singleSpacer.hide();
      doubleSpacer.show();
      addBtn.hide();
    } else {
      singleSpacer.show();
      doubleSpacer.hide();
      addBtn.show();
    }
  }
};

// src/fields/fieldManagers/DateField.ts
var import_obsidian26 = require("obsidian");

// src/modals/fields/DateModal.ts
var import_obsidian24 = require("obsidian");
var import_obsidian25 = require("obsidian");

// node_modules/flatpickr/dist/esm/types/options.js
var HOOKS = [
  "onChange",
  "onClose",
  "onDayCreate",
  "onDestroy",
  "onKeyDown",
  "onMonthChange",
  "onOpen",
  "onParseConfig",
  "onReady",
  "onValueUpdate",
  "onYearChange",
  "onPreCalendarPosition"
];
var defaults = {
  _disable: [],
  allowInput: false,
  allowInvalidPreload: false,
  altFormat: "F j, Y",
  altInput: false,
  altInputClass: "form-control input",
  animate: typeof window === "object" && window.navigator.userAgent.indexOf("MSIE") === -1,
  ariaDateFormat: "F j, Y",
  autoFillDefaultTime: true,
  clickOpens: true,
  closeOnSelect: true,
  conjunction: ", ",
  dateFormat: "Y-m-d",
  defaultHour: 12,
  defaultMinute: 0,
  defaultSeconds: 0,
  disable: [],
  disableMobile: false,
  enableSeconds: false,
  enableTime: false,
  errorHandler: function(err) {
    return typeof console !== "undefined" && console.warn(err);
  },
  getWeek: function(givenDate) {
    var date = new Date(givenDate.getTime());
    date.setHours(0, 0, 0, 0);
    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
    var week1 = new Date(date.getFullYear(), 0, 4);
    return 1 + Math.round(((date.getTime() - week1.getTime()) / 864e5 - 3 + (week1.getDay() + 6) % 7) / 7);
  },
  hourIncrement: 1,
  ignoredFocusElements: [],
  inline: false,
  locale: "default",
  minuteIncrement: 5,
  mode: "single",
  monthSelectorType: "dropdown",
  nextArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",
  noCalendar: false,
  now: new Date(),
  onChange: [],
  onClose: [],
  onDayCreate: [],
  onDestroy: [],
  onKeyDown: [],
  onMonthChange: [],
  onOpen: [],
  onParseConfig: [],
  onReady: [],
  onValueUpdate: [],
  onYearChange: [],
  onPreCalendarPosition: [],
  plugins: [],
  position: "auto",
  positionElement: void 0,
  prevArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",
  shorthandCurrentMonth: false,
  showMonths: 1,
  static: false,
  time_24hr: false,
  weekNumbers: false,
  wrap: false
};

// node_modules/flatpickr/dist/esm/l10n/default.js
var english = {
  weekdays: {
    shorthand: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
    longhand: [
      "Sunday",
      "Monday",
      "Tuesday",
      "Wednesday",
      "Thursday",
      "Friday",
      "Saturday"
    ]
  },
  months: {
    shorthand: [
      "Jan",
      "Feb",
      "Mar",
      "Apr",
      "May",
      "Jun",
      "Jul",
      "Aug",
      "Sep",
      "Oct",
      "Nov",
      "Dec"
    ],
    longhand: [
      "January",
      "February",
      "March",
      "April",
      "May",
      "June",
      "July",
      "August",
      "September",
      "October",
      "November",
      "December"
    ]
  },
  daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
  firstDayOfWeek: 0,
  ordinal: function(nth) {
    var s = nth % 100;
    if (s > 3 && s < 21)
      return "th";
    switch (s % 10) {
      case 1:
        return "st";
      case 2:
        return "nd";
      case 3:
        return "rd";
      default:
        return "th";
    }
  },
  rangeSeparator: " to ",
  weekAbbreviation: "Wk",
  scrollTitle: "Scroll to increment",
  toggleTitle: "Click to toggle",
  amPM: ["AM", "PM"],
  yearAriaLabel: "Year",
  monthAriaLabel: "Month",
  hourAriaLabel: "Hour",
  minuteAriaLabel: "Minute",
  time_24hr: false
};
var default_default = english;

// node_modules/flatpickr/dist/esm/utils/index.js
var pad = function(number, length) {
  if (length === void 0) {
    length = 2;
  }
  return ("000" + number).slice(length * -1);
};
var int = function(bool) {
  return bool === true ? 1 : 0;
};
function debounce2(fn2, wait) {
  var t;
  return function() {
    var _this = this;
    var args = arguments;
    clearTimeout(t);
    t = setTimeout(function() {
      return fn2.apply(_this, args);
    }, wait);
  };
}
var arrayify = function(obj) {
  return obj instanceof Array ? obj : [obj];
};

// node_modules/flatpickr/dist/esm/utils/dom.js
function toggleClass(elem, className, bool) {
  if (bool === true)
    return elem.classList.add(className);
  elem.classList.remove(className);
}
function createElement(tag, className, content) {
  var e = window.document.createElement(tag);
  className = className || "";
  content = content || "";
  e.className = className;
  if (content !== void 0)
    e.textContent = content;
  return e;
}
function clearNode(node) {
  while (node.firstChild)
    node.removeChild(node.firstChild);
}
function findParent(node, condition) {
  if (condition(node))
    return node;
  else if (node.parentNode)
    return findParent(node.parentNode, condition);
  return void 0;
}
function createNumberInput(inputClassName, opts) {
  var wrapper = createElement("div", "numInputWrapper"), numInput = createElement("input", "numInput " + inputClassName), arrowUp = createElement("span", "arrowUp"), arrowDown = createElement("span", "arrowDown");
  if (navigator.userAgent.indexOf("MSIE 9.0") === -1) {
    numInput.type = "number";
  } else {
    numInput.type = "text";
    numInput.pattern = "\\d*";
  }
  if (opts !== void 0)
    for (var key in opts)
      numInput.setAttribute(key, opts[key]);
  wrapper.appendChild(numInput);
  wrapper.appendChild(arrowUp);
  wrapper.appendChild(arrowDown);
  return wrapper;
}
function getEventTarget(event) {
  try {
    if (typeof event.composedPath === "function") {
      var path = event.composedPath();
      return path[0];
    }
    return event.target;
  } catch (error) {
    return event.target;
  }
}

// node_modules/flatpickr/dist/esm/utils/formatting.js
var doNothing = function() {
  return void 0;
};
var monthToStr = function(monthNumber, shorthand, locale) {
  return locale.months[shorthand ? "shorthand" : "longhand"][monthNumber];
};
var revFormat = {
  D: doNothing,
  F: function(dateObj, monthName, locale) {
    dateObj.setMonth(locale.months.longhand.indexOf(monthName));
  },
  G: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  H: function(dateObj, hour) {
    dateObj.setHours(parseFloat(hour));
  },
  J: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  K: function(dateObj, amPM, locale) {
    dateObj.setHours(dateObj.getHours() % 12 + 12 * int(new RegExp(locale.amPM[1], "i").test(amPM)));
  },
  M: function(dateObj, shortMonth, locale) {
    dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));
  },
  S: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  U: function(_, unixSeconds) {
    return new Date(parseFloat(unixSeconds) * 1e3);
  },
  W: function(dateObj, weekNum, locale) {
    var weekNumber = parseInt(weekNum);
    var date = new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);
    date.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);
    return date;
  },
  Y: function(dateObj, year) {
    dateObj.setFullYear(parseFloat(year));
  },
  Z: function(_, ISODate) {
    return new Date(ISODate);
  },
  d: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  h: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  i: function(dateObj, minutes) {
    dateObj.setMinutes(parseFloat(minutes));
  },
  j: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  l: doNothing,
  m: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  n: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  s: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  u: function(_, unixMillSeconds) {
    return new Date(parseFloat(unixMillSeconds));
  },
  w: doNothing,
  y: function(dateObj, year) {
    dateObj.setFullYear(2e3 + parseFloat(year));
  }
};
var tokenRegex = {
  D: "",
  F: "",
  G: "(\\d\\d|\\d)",
  H: "(\\d\\d|\\d)",
  J: "(\\d\\d|\\d)\\w+",
  K: "",
  M: "",
  S: "(\\d\\d|\\d)",
  U: "(.+)",
  W: "(\\d\\d|\\d)",
  Y: "(\\d{4})",
  Z: "(.+)",
  d: "(\\d\\d|\\d)",
  h: "(\\d\\d|\\d)",
  i: "(\\d\\d|\\d)",
  j: "(\\d\\d|\\d)",
  l: "",
  m: "(\\d\\d|\\d)",
  n: "(\\d\\d|\\d)",
  s: "(\\d\\d|\\d)",
  u: "(.+)",
  w: "(\\d\\d|\\d)",
  y: "(\\d{2})"
};
var formats = {
  Z: function(date) {
    return date.toISOString();
  },
  D: function(date, locale, options2) {
    return locale.weekdays.shorthand[formats.w(date, locale, options2)];
  },
  F: function(date, locale, options2) {
    return monthToStr(formats.n(date, locale, options2) - 1, false, locale);
  },
  G: function(date, locale, options2) {
    return pad(formats.h(date, locale, options2));
  },
  H: function(date) {
    return pad(date.getHours());
  },
  J: function(date, locale) {
    return locale.ordinal !== void 0 ? date.getDate() + locale.ordinal(date.getDate()) : date.getDate();
  },
  K: function(date, locale) {
    return locale.amPM[int(date.getHours() > 11)];
  },
  M: function(date, locale) {
    return monthToStr(date.getMonth(), true, locale);
  },
  S: function(date) {
    return pad(date.getSeconds());
  },
  U: function(date) {
    return date.getTime() / 1e3;
  },
  W: function(date, _, options2) {
    return options2.getWeek(date);
  },
  Y: function(date) {
    return pad(date.getFullYear(), 4);
  },
  d: function(date) {
    return pad(date.getDate());
  },
  h: function(date) {
    return date.getHours() % 12 ? date.getHours() % 12 : 12;
  },
  i: function(date) {
    return pad(date.getMinutes());
  },
  j: function(date) {
    return date.getDate();
  },
  l: function(date, locale) {
    return locale.weekdays.longhand[date.getDay()];
  },
  m: function(date) {
    return pad(date.getMonth() + 1);
  },
  n: function(date) {
    return date.getMonth() + 1;
  },
  s: function(date) {
    return date.getSeconds();
  },
  u: function(date) {
    return date.getTime();
  },
  w: function(date) {
    return date.getDay();
  },
  y: function(date) {
    return String(date.getFullYear()).substring(2);
  }
};

// node_modules/flatpickr/dist/esm/utils/dates.js
var createDateFormatter = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c, _d = _a.isMobile, isMobile = _d === void 0 ? false : _d;
  return function(dateObj, frmt, overrideLocale) {
    var locale = overrideLocale || l10n;
    if (config.formatDate !== void 0 && !isMobile) {
      return config.formatDate(dateObj, frmt, locale);
    }
    return frmt.split("").map(function(c, i, arr) {
      return formats[c] && arr[i - 1] !== "\\" ? formats[c](dateObj, locale, config) : c !== "\\" ? c : "";
    }).join("");
  };
};
var createDateParser = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;
  return function(date, givenFormat, timeless, customLocale) {
    if (date !== 0 && !date)
      return void 0;
    var locale = customLocale || l10n;
    var parsedDate;
    var dateOrig = date;
    if (date instanceof Date)
      parsedDate = new Date(date.getTime());
    else if (typeof date !== "string" && date.toFixed !== void 0)
      parsedDate = new Date(date);
    else if (typeof date === "string") {
      var format2 = givenFormat || (config || defaults).dateFormat;
      var datestr = String(date).trim();
      if (datestr === "today") {
        parsedDate = new Date();
        timeless = true;
      } else if (config && config.parseDate) {
        parsedDate = config.parseDate(date, format2);
      } else if (/Z$/.test(datestr) || /GMT$/.test(datestr)) {
        parsedDate = new Date(date);
      } else {
        var matched = void 0, ops = [];
        for (var i = 0, matchIndex = 0, regexStr = ""; i < format2.length; i++) {
          var token = format2[i];
          var isBackSlash = token === "\\";
          var escaped = format2[i - 1] === "\\" || isBackSlash;
          if (tokenRegex[token] && !escaped) {
            regexStr += tokenRegex[token];
            var match = new RegExp(regexStr).exec(date);
            if (match && (matched = true)) {
              ops[token !== "Y" ? "push" : "unshift"]({
                fn: revFormat[token],
                val: match[++matchIndex]
              });
            }
          } else if (!isBackSlash)
            regexStr += ".";
        }
        parsedDate = !config || !config.noCalendar ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0) : new Date(new Date().setHours(0, 0, 0, 0));
        ops.forEach(function(_a2) {
          var fn2 = _a2.fn, val = _a2.val;
          return parsedDate = fn2(parsedDate, val, locale) || parsedDate;
        });
        parsedDate = matched ? parsedDate : void 0;
      }
    }
    if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {
      config.errorHandler(new Error("Invalid date provided: " + dateOrig));
      return void 0;
    }
    if (timeless === true)
      parsedDate.setHours(0, 0, 0, 0);
    return parsedDate;
  };
};
function compareDates(date1, date2, timeless) {
  if (timeless === void 0) {
    timeless = true;
  }
  if (timeless !== false) {
    return new Date(date1.getTime()).setHours(0, 0, 0, 0) - new Date(date2.getTime()).setHours(0, 0, 0, 0);
  }
  return date1.getTime() - date2.getTime();
}
var isBetween = function(ts, ts1, ts2) {
  return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);
};
var calculateSecondsSinceMidnight = function(hours, minutes, seconds) {
  return hours * 3600 + minutes * 60 + seconds;
};
var parseSeconds = function(secondsSinceMidnight) {
  var hours = Math.floor(secondsSinceMidnight / 3600), minutes = (secondsSinceMidnight - hours * 3600) / 60;
  return [hours, minutes, secondsSinceMidnight - hours * 3600 - minutes * 60];
};
var duration = {
  DAY: 864e5
};
function getDefaultHours(config) {
  var hours = config.defaultHour;
  var minutes = config.defaultMinute;
  var seconds = config.defaultSeconds;
  if (config.minDate !== void 0) {
    var minHour = config.minDate.getHours();
    var minMinutes = config.minDate.getMinutes();
    var minSeconds = config.minDate.getSeconds();
    if (hours < minHour) {
      hours = minHour;
    }
    if (hours === minHour && minutes < minMinutes) {
      minutes = minMinutes;
    }
    if (hours === minHour && minutes === minMinutes && seconds < minSeconds)
      seconds = config.minDate.getSeconds();
  }
  if (config.maxDate !== void 0) {
    var maxHr = config.maxDate.getHours();
    var maxMinutes = config.maxDate.getMinutes();
    hours = Math.min(hours, maxHr);
    if (hours === maxHr)
      minutes = Math.min(maxMinutes, minutes);
    if (hours === maxHr && minutes === maxMinutes)
      seconds = config.maxDate.getSeconds();
  }
  return { hours, minutes, seconds };
}

// node_modules/flatpickr/dist/esm/utils/polyfills.js
if (typeof Object.assign !== "function") {
  Object.assign = function(target) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
      args[_i - 1] = arguments[_i];
    }
    if (!target) {
      throw TypeError("Cannot convert undefined or null to object");
    }
    var _loop_1 = function(source2) {
      if (source2) {
        Object.keys(source2).forEach(function(key) {
          return target[key] = source2[key];
        });
      }
    };
    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {
      var source = args_1[_a];
      _loop_1(source);
    }
    return target;
  };
}

// node_modules/flatpickr/dist/esm/index.js
var __assign = function() {
  __assign = Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s)
        if (Object.prototype.hasOwnProperty.call(s, p))
          t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};
var __spreadArrays = function() {
  for (var s = 0, i = 0, il = arguments.length; i < il; i++)
    s += arguments[i].length;
  for (var r = Array(s), k = 0, i = 0; i < il; i++)
    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
      r[k] = a[j];
  return r;
};
var DEBOUNCED_CHANGE_MS = 300;
function FlatpickrInstance(element, instanceConfig) {
  var self = {
    config: __assign(__assign({}, defaults), flatpickr.defaultConfig),
    l10n: default_default
  };
  self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  self._handlers = [];
  self.pluginElements = [];
  self.loadedPlugins = [];
  self._bind = bind;
  self._setHoursFromDate = setHoursFromDate;
  self._positionCalendar = positionCalendar;
  self.changeMonth = changeMonth;
  self.changeYear = changeYear;
  self.clear = clear;
  self.close = close;
  self.onMouseOver = onMouseOver;
  self._createElement = createElement;
  self.createDay = createDay;
  self.destroy = destroy;
  self.isEnabled = isEnabled;
  self.jumpToDate = jumpToDate;
  self.updateValue = updateValue;
  self.open = open;
  self.redraw = redraw;
  self.set = set;
  self.setDate = setDate;
  self.toggle = toggle;
  function setupHelperFunctions() {
    self.utils = {
      getDaysInMonth: function(month, yr) {
        if (month === void 0) {
          month = self.currentMonth;
        }
        if (yr === void 0) {
          yr = self.currentYear;
        }
        if (month === 1 && (yr % 4 === 0 && yr % 100 !== 0 || yr % 400 === 0))
          return 29;
        return self.l10n.daysInMonth[month];
      }
    };
  }
  function init() {
    self.element = self.input = element;
    self.isOpen = false;
    parseConfig();
    setupLocale();
    setupInputs();
    setupDates();
    setupHelperFunctions();
    if (!self.isMobile)
      build();
    bindEvents();
    if (self.selectedDates.length || self.config.noCalendar) {
      if (self.config.enableTime) {
        setHoursFromDate(self.config.noCalendar ? self.latestSelectedDateObj : void 0);
      }
      updateValue(false);
    }
    setCalendarWidth();
    var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    if (!self.isMobile && isSafari) {
      positionCalendar();
    }
    triggerEvent("onReady");
  }
  function getClosestActiveElement() {
    var _a;
    return ((_a = self.calendarContainer) === null || _a === void 0 ? void 0 : _a.getRootNode()).activeElement || document.activeElement;
  }
  function bindToInstance(fn2) {
    return fn2.bind(self);
  }
  function setCalendarWidth() {
    var config = self.config;
    if (config.weekNumbers === false && config.showMonths === 1) {
      return;
    } else if (config.noCalendar !== true) {
      window.requestAnimationFrame(function() {
        if (self.calendarContainer !== void 0) {
          self.calendarContainer.style.visibility = "hidden";
          self.calendarContainer.style.display = "block";
        }
        if (self.daysContainer !== void 0) {
          var daysWidth = (self.days.offsetWidth + 1) * config.showMonths;
          self.daysContainer.style.width = daysWidth + "px";
          self.calendarContainer.style.width = daysWidth + (self.weekWrapper !== void 0 ? self.weekWrapper.offsetWidth : 0) + "px";
          self.calendarContainer.style.removeProperty("visibility");
          self.calendarContainer.style.removeProperty("display");
        }
      });
    }
  }
  function updateTime(e) {
    if (self.selectedDates.length === 0) {
      var defaultDate = self.config.minDate === void 0 || compareDates(new Date(), self.config.minDate) >= 0 ? new Date() : new Date(self.config.minDate.getTime());
      var defaults2 = getDefaultHours(self.config);
      defaultDate.setHours(defaults2.hours, defaults2.minutes, defaults2.seconds, defaultDate.getMilliseconds());
      self.selectedDates = [defaultDate];
      self.latestSelectedDateObj = defaultDate;
    }
    if (e !== void 0 && e.type !== "blur") {
      timeWrapper(e);
    }
    var prevValue = self._input.value;
    setHoursFromInputs();
    updateValue();
    if (self._input.value !== prevValue) {
      self._debouncedChange();
    }
  }
  function ampm2military(hour, amPM) {
    return hour % 12 + 12 * int(amPM === self.l10n.amPM[1]);
  }
  function military2ampm(hour) {
    switch (hour % 24) {
      case 0:
      case 12:
        return 12;
      default:
        return hour % 12;
    }
  }
  function setHoursFromInputs() {
    if (self.hourElement === void 0 || self.minuteElement === void 0)
      return;
    var hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== void 0 ? (parseInt(self.secondElement.value, 10) || 0) % 60 : 0;
    if (self.amPM !== void 0) {
      hours = ampm2military(hours, self.amPM.textContent);
    }
    var limitMinHours = self.config.minTime !== void 0 || self.config.minDate && self.minDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.minDate, true) === 0;
    var limitMaxHours = self.config.maxTime !== void 0 || self.config.maxDate && self.maxDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.maxDate, true) === 0;
    if (self.config.maxTime !== void 0 && self.config.minTime !== void 0 && self.config.minTime > self.config.maxTime) {
      var minBound = calculateSecondsSinceMidnight(self.config.minTime.getHours(), self.config.minTime.getMinutes(), self.config.minTime.getSeconds());
      var maxBound = calculateSecondsSinceMidnight(self.config.maxTime.getHours(), self.config.maxTime.getMinutes(), self.config.maxTime.getSeconds());
      var currentTime = calculateSecondsSinceMidnight(hours, minutes, seconds);
      if (currentTime > maxBound && currentTime < minBound) {
        var result = parseSeconds(minBound);
        hours = result[0];
        minutes = result[1];
        seconds = result[2];
      }
    } else {
      if (limitMaxHours) {
        var maxTime = self.config.maxTime !== void 0 ? self.config.maxTime : self.config.maxDate;
        hours = Math.min(hours, maxTime.getHours());
        if (hours === maxTime.getHours())
          minutes = Math.min(minutes, maxTime.getMinutes());
        if (minutes === maxTime.getMinutes())
          seconds = Math.min(seconds, maxTime.getSeconds());
      }
      if (limitMinHours) {
        var minTime = self.config.minTime !== void 0 ? self.config.minTime : self.config.minDate;
        hours = Math.max(hours, minTime.getHours());
        if (hours === minTime.getHours() && minutes < minTime.getMinutes())
          minutes = minTime.getMinutes();
        if (minutes === minTime.getMinutes())
          seconds = Math.max(seconds, minTime.getSeconds());
      }
    }
    setHours(hours, minutes, seconds);
  }
  function setHoursFromDate(dateObj) {
    var date = dateObj || self.latestSelectedDateObj;
    if (date && date instanceof Date) {
      setHours(date.getHours(), date.getMinutes(), date.getSeconds());
    }
  }
  function setHours(hours, minutes, seconds) {
    if (self.latestSelectedDateObj !== void 0) {
      self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);
    }
    if (!self.hourElement || !self.minuteElement || self.isMobile)
      return;
    self.hourElement.value = pad(!self.config.time_24hr ? (12 + hours) % 12 + 12 * int(hours % 12 === 0) : hours);
    self.minuteElement.value = pad(minutes);
    if (self.amPM !== void 0)
      self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];
    if (self.secondElement !== void 0)
      self.secondElement.value = pad(seconds);
  }
  function onYearInput(event) {
    var eventTarget = getEventTarget(event);
    var year = parseInt(eventTarget.value) + (event.delta || 0);
    if (year / 1e3 > 1 || event.key === "Enter" && !/[^\d]/.test(year.toString())) {
      changeYear(year);
    }
  }
  function bind(element2, event, handler, options2) {
    if (event instanceof Array)
      return event.forEach(function(ev) {
        return bind(element2, ev, handler, options2);
      });
    if (element2 instanceof Array)
      return element2.forEach(function(el) {
        return bind(el, event, handler, options2);
      });
    element2.addEventListener(event, handler, options2);
    self._handlers.push({
      remove: function() {
        return element2.removeEventListener(event, handler, options2);
      }
    });
  }
  function triggerChange() {
    triggerEvent("onChange");
  }
  function bindEvents() {
    if (self.config.wrap) {
      ["open", "close", "toggle", "clear"].forEach(function(evt) {
        Array.prototype.forEach.call(self.element.querySelectorAll("[data-" + evt + "]"), function(el) {
          return bind(el, "click", self[evt]);
        });
      });
    }
    if (self.isMobile) {
      setupMobile();
      return;
    }
    var debouncedResize = debounce2(onResize, 50);
    self._debouncedChange = debounce2(triggerChange, DEBOUNCED_CHANGE_MS);
    if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))
      bind(self.daysContainer, "mouseover", function(e) {
        if (self.config.mode === "range")
          onMouseOver(getEventTarget(e));
      });
    bind(self._input, "keydown", onKeyDown);
    if (self.calendarContainer !== void 0) {
      bind(self.calendarContainer, "keydown", onKeyDown);
    }
    if (!self.config.inline && !self.config.static)
      bind(window, "resize", debouncedResize);
    if (window.ontouchstart !== void 0)
      bind(window.document, "touchstart", documentClick);
    else
      bind(window.document, "mousedown", documentClick);
    bind(window.document, "focus", documentClick, { capture: true });
    if (self.config.clickOpens === true) {
      bind(self._input, "focus", self.open);
      bind(self._input, "click", self.open);
    }
    if (self.daysContainer !== void 0) {
      bind(self.monthNav, "click", onMonthNavClick);
      bind(self.monthNav, ["keyup", "increment"], onYearInput);
      bind(self.daysContainer, "click", selectDate);
    }
    if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0) {
      var selText = function(e) {
        return getEventTarget(e).select();
      };
      bind(self.timeContainer, ["increment"], updateTime);
      bind(self.timeContainer, "blur", updateTime, { capture: true });
      bind(self.timeContainer, "click", timeIncrement);
      bind([self.hourElement, self.minuteElement], ["focus", "click"], selText);
      if (self.secondElement !== void 0)
        bind(self.secondElement, "focus", function() {
          return self.secondElement && self.secondElement.select();
        });
      if (self.amPM !== void 0) {
        bind(self.amPM, "click", function(e) {
          updateTime(e);
        });
      }
    }
    if (self.config.allowInput) {
      bind(self._input, "blur", onBlur);
    }
  }
  function jumpToDate(jumpDate, triggerChange2) {
    var jumpTo = jumpDate !== void 0 ? self.parseDate(jumpDate) : self.latestSelectedDateObj || (self.config.minDate && self.config.minDate > self.now ? self.config.minDate : self.config.maxDate && self.config.maxDate < self.now ? self.config.maxDate : self.now);
    var oldYear = self.currentYear;
    var oldMonth = self.currentMonth;
    try {
      if (jumpTo !== void 0) {
        self.currentYear = jumpTo.getFullYear();
        self.currentMonth = jumpTo.getMonth();
      }
    } catch (e) {
      e.message = "Invalid date supplied: " + jumpTo;
      self.config.errorHandler(e);
    }
    if (triggerChange2 && self.currentYear !== oldYear) {
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    if (triggerChange2 && (self.currentYear !== oldYear || self.currentMonth !== oldMonth)) {
      triggerEvent("onMonthChange");
    }
    self.redraw();
  }
  function timeIncrement(e) {
    var eventTarget = getEventTarget(e);
    if (~eventTarget.className.indexOf("arrow"))
      incrementNumInput(e, eventTarget.classList.contains("arrowUp") ? 1 : -1);
  }
  function incrementNumInput(e, delta, inputElem) {
    var target = e && getEventTarget(e);
    var input = inputElem || target && target.parentNode && target.parentNode.firstChild;
    var event = createEvent("increment");
    event.delta = delta;
    input && input.dispatchEvent(event);
  }
  function build() {
    var fragment = window.document.createDocumentFragment();
    self.calendarContainer = createElement("div", "flatpickr-calendar");
    self.calendarContainer.tabIndex = -1;
    if (!self.config.noCalendar) {
      fragment.appendChild(buildMonthNav());
      self.innerContainer = createElement("div", "flatpickr-innerContainer");
      if (self.config.weekNumbers) {
        var _a = buildWeeks(), weekWrapper = _a.weekWrapper, weekNumbers = _a.weekNumbers;
        self.innerContainer.appendChild(weekWrapper);
        self.weekNumbers = weekNumbers;
        self.weekWrapper = weekWrapper;
      }
      self.rContainer = createElement("div", "flatpickr-rContainer");
      self.rContainer.appendChild(buildWeekdays());
      if (!self.daysContainer) {
        self.daysContainer = createElement("div", "flatpickr-days");
        self.daysContainer.tabIndex = -1;
      }
      buildDays();
      self.rContainer.appendChild(self.daysContainer);
      self.innerContainer.appendChild(self.rContainer);
      fragment.appendChild(self.innerContainer);
    }
    if (self.config.enableTime) {
      fragment.appendChild(buildTime());
    }
    toggleClass(self.calendarContainer, "rangeMode", self.config.mode === "range");
    toggleClass(self.calendarContainer, "animate", self.config.animate === true);
    toggleClass(self.calendarContainer, "multiMonth", self.config.showMonths > 1);
    self.calendarContainer.appendChild(fragment);
    var customAppend = self.config.appendTo !== void 0 && self.config.appendTo.nodeType !== void 0;
    if (self.config.inline || self.config.static) {
      self.calendarContainer.classList.add(self.config.inline ? "inline" : "static");
      if (self.config.inline) {
        if (!customAppend && self.element.parentNode)
          self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);
        else if (self.config.appendTo !== void 0)
          self.config.appendTo.appendChild(self.calendarContainer);
      }
      if (self.config.static) {
        var wrapper = createElement("div", "flatpickr-wrapper");
        if (self.element.parentNode)
          self.element.parentNode.insertBefore(wrapper, self.element);
        wrapper.appendChild(self.element);
        if (self.altInput)
          wrapper.appendChild(self.altInput);
        wrapper.appendChild(self.calendarContainer);
      }
    }
    if (!self.config.static && !self.config.inline)
      (self.config.appendTo !== void 0 ? self.config.appendTo : window.document.body).appendChild(self.calendarContainer);
  }
  function createDay(className, date, _dayNumber, i) {
    var dateIsEnabled = isEnabled(date, true), dayElement = createElement("span", className, date.getDate().toString());
    dayElement.dateObj = date;
    dayElement.$i = i;
    dayElement.setAttribute("aria-label", self.formatDate(date, self.config.ariaDateFormat));
    if (className.indexOf("hidden") === -1 && compareDates(date, self.now) === 0) {
      self.todayDateElem = dayElement;
      dayElement.classList.add("today");
      dayElement.setAttribute("aria-current", "date");
    }
    if (dateIsEnabled) {
      dayElement.tabIndex = -1;
      if (isDateSelected(date)) {
        dayElement.classList.add("selected");
        self.selectedDateElem = dayElement;
        if (self.config.mode === "range") {
          toggleClass(dayElement, "startRange", self.selectedDates[0] && compareDates(date, self.selectedDates[0], true) === 0);
          toggleClass(dayElement, "endRange", self.selectedDates[1] && compareDates(date, self.selectedDates[1], true) === 0);
          if (className === "nextMonthDay")
            dayElement.classList.add("inRange");
        }
      }
    } else {
      dayElement.classList.add("flatpickr-disabled");
    }
    if (self.config.mode === "range") {
      if (isDateInRange(date) && !isDateSelected(date))
        dayElement.classList.add("inRange");
    }
    if (self.weekNumbers && self.config.showMonths === 1 && className !== "prevMonthDay" && i % 7 === 6) {
      self.weekNumbers.insertAdjacentHTML("beforeend", "<span class='flatpickr-day'>" + self.config.getWeek(date) + "</span>");
    }
    triggerEvent("onDayCreate", dayElement);
    return dayElement;
  }
  function focusOnDayElem(targetNode) {
    targetNode.focus();
    if (self.config.mode === "range")
      onMouseOver(targetNode);
  }
  function getFirstAvailableDay(delta) {
    var startMonth = delta > 0 ? 0 : self.config.showMonths - 1;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    for (var m = startMonth; m != endMonth; m += delta) {
      var month = self.daysContainer.children[m];
      var startIndex = delta > 0 ? 0 : month.children.length - 1;
      var endIndex = delta > 0 ? month.children.length : -1;
      for (var i = startIndex; i != endIndex; i += delta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj))
          return c;
      }
    }
    return void 0;
  }
  function getNextAvailableDay(current, delta) {
    var givenMonth = current.className.indexOf("Month") === -1 ? current.dateObj.getMonth() : self.currentMonth;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    var loopDelta = delta > 0 ? 1 : -1;
    for (var m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {
      var month = self.daysContainer.children[m];
      var startIndex = givenMonth - self.currentMonth === m ? current.$i + delta : delta < 0 ? month.children.length - 1 : 0;
      var numMonthDays = month.children.length;
      for (var i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj) && Math.abs(current.$i - i) >= Math.abs(delta))
          return focusOnDayElem(c);
      }
    }
    self.changeMonth(loopDelta);
    focusOnDay(getFirstAvailableDay(loopDelta), 0);
    return void 0;
  }
  function focusOnDay(current, offset2) {
    var activeElement = getClosestActiveElement();
    var dayFocused = isInView(activeElement || document.body);
    var startElem = current !== void 0 ? current : dayFocused ? activeElement : self.selectedDateElem !== void 0 && isInView(self.selectedDateElem) ? self.selectedDateElem : self.todayDateElem !== void 0 && isInView(self.todayDateElem) ? self.todayDateElem : getFirstAvailableDay(offset2 > 0 ? 1 : -1);
    if (startElem === void 0) {
      self._input.focus();
    } else if (!dayFocused) {
      focusOnDayElem(startElem);
    } else {
      getNextAvailableDay(startElem, offset2);
    }
  }
  function buildMonthDays(year, month) {
    var firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;
    var prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12, year);
    var daysInMonth = self.utils.getDaysInMonth(month, year), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? "prevMonthDay hidden" : "prevMonthDay", nextMonthDayClass = isMultiMonth ? "nextMonthDay hidden" : "nextMonthDay";
    var dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;
    for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));
    }
    for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day", new Date(year, month, dayNumber), dayNumber, dayIndex));
    }
    for (var dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth && (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));
    }
    var dayContainer = createElement("div", "dayContainer");
    dayContainer.appendChild(days);
    return dayContainer;
  }
  function buildDays() {
    if (self.daysContainer === void 0) {
      return;
    }
    clearNode(self.daysContainer);
    if (self.weekNumbers)
      clearNode(self.weekNumbers);
    var frag = document.createDocumentFragment();
    for (var i = 0; i < self.config.showMonths; i++) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));
    }
    self.daysContainer.appendChild(frag);
    self.days = self.daysContainer.firstChild;
    if (self.config.mode === "range" && self.selectedDates.length === 1) {
      onMouseOver();
    }
  }
  function buildMonthSwitch() {
    if (self.config.showMonths > 1 || self.config.monthSelectorType !== "dropdown")
      return;
    var shouldBuildMonth = function(month2) {
      if (self.config.minDate !== void 0 && self.currentYear === self.config.minDate.getFullYear() && month2 < self.config.minDate.getMonth()) {
        return false;
      }
      return !(self.config.maxDate !== void 0 && self.currentYear === self.config.maxDate.getFullYear() && month2 > self.config.maxDate.getMonth());
    };
    self.monthsDropdownContainer.tabIndex = -1;
    self.monthsDropdownContainer.innerHTML = "";
    for (var i = 0; i < 12; i++) {
      if (!shouldBuildMonth(i))
        continue;
      var month = createElement("option", "flatpickr-monthDropdown-month");
      month.value = new Date(self.currentYear, i).getMonth().toString();
      month.textContent = monthToStr(i, self.config.shorthandCurrentMonth, self.l10n);
      month.tabIndex = -1;
      if (self.currentMonth === i) {
        month.selected = true;
      }
      self.monthsDropdownContainer.appendChild(month);
    }
  }
  function buildMonth() {
    var container = createElement("div", "flatpickr-month");
    var monthNavFragment = window.document.createDocumentFragment();
    var monthElement;
    if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
      monthElement = createElement("span", "cur-month");
    } else {
      self.monthsDropdownContainer = createElement("select", "flatpickr-monthDropdown-months");
      self.monthsDropdownContainer.setAttribute("aria-label", self.l10n.monthAriaLabel);
      bind(self.monthsDropdownContainer, "change", function(e) {
        var target = getEventTarget(e);
        var selectedMonth = parseInt(target.value, 10);
        self.changeMonth(selectedMonth - self.currentMonth);
        triggerEvent("onMonthChange");
      });
      buildMonthSwitch();
      monthElement = self.monthsDropdownContainer;
    }
    var yearInput = createNumberInput("cur-year", { tabindex: "-1" });
    var yearElement = yearInput.getElementsByTagName("input")[0];
    yearElement.setAttribute("aria-label", self.l10n.yearAriaLabel);
    if (self.config.minDate) {
      yearElement.setAttribute("min", self.config.minDate.getFullYear().toString());
    }
    if (self.config.maxDate) {
      yearElement.setAttribute("max", self.config.maxDate.getFullYear().toString());
      yearElement.disabled = !!self.config.minDate && self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();
    }
    var currentMonth = createElement("div", "flatpickr-current-month");
    currentMonth.appendChild(monthElement);
    currentMonth.appendChild(yearInput);
    monthNavFragment.appendChild(currentMonth);
    container.appendChild(monthNavFragment);
    return {
      container,
      yearElement,
      monthElement
    };
  }
  function buildMonths() {
    clearNode(self.monthNav);
    self.monthNav.appendChild(self.prevMonthNav);
    if (self.config.showMonths) {
      self.yearElements = [];
      self.monthElements = [];
    }
    for (var m = self.config.showMonths; m--; ) {
      var month = buildMonth();
      self.yearElements.push(month.yearElement);
      self.monthElements.push(month.monthElement);
      self.monthNav.appendChild(month.container);
    }
    self.monthNav.appendChild(self.nextMonthNav);
  }
  function buildMonthNav() {
    self.monthNav = createElement("div", "flatpickr-months");
    self.yearElements = [];
    self.monthElements = [];
    self.prevMonthNav = createElement("span", "flatpickr-prev-month");
    self.prevMonthNav.innerHTML = self.config.prevArrow;
    self.nextMonthNav = createElement("span", "flatpickr-next-month");
    self.nextMonthNav.innerHTML = self.config.nextArrow;
    buildMonths();
    Object.defineProperty(self, "_hidePrevMonthArrow", {
      get: function() {
        return self.__hidePrevMonthArrow;
      },
      set: function(bool) {
        if (self.__hidePrevMonthArrow !== bool) {
          toggleClass(self.prevMonthNav, "flatpickr-disabled", bool);
          self.__hidePrevMonthArrow = bool;
        }
      }
    });
    Object.defineProperty(self, "_hideNextMonthArrow", {
      get: function() {
        return self.__hideNextMonthArrow;
      },
      set: function(bool) {
        if (self.__hideNextMonthArrow !== bool) {
          toggleClass(self.nextMonthNav, "flatpickr-disabled", bool);
          self.__hideNextMonthArrow = bool;
        }
      }
    });
    self.currentYearElement = self.yearElements[0];
    updateNavigationCurrentMonth();
    return self.monthNav;
  }
  function buildTime() {
    self.calendarContainer.classList.add("hasTime");
    if (self.config.noCalendar)
      self.calendarContainer.classList.add("noCalendar");
    var defaults2 = getDefaultHours(self.config);
    self.timeContainer = createElement("div", "flatpickr-time");
    self.timeContainer.tabIndex = -1;
    var separator = createElement("span", "flatpickr-time-separator", ":");
    var hourInput = createNumberInput("flatpickr-hour", {
      "aria-label": self.l10n.hourAriaLabel
    });
    self.hourElement = hourInput.getElementsByTagName("input")[0];
    var minuteInput = createNumberInput("flatpickr-minute", {
      "aria-label": self.l10n.minuteAriaLabel
    });
    self.minuteElement = minuteInput.getElementsByTagName("input")[0];
    self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;
    self.hourElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getHours() : self.config.time_24hr ? defaults2.hours : military2ampm(defaults2.hours));
    self.minuteElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getMinutes() : defaults2.minutes);
    self.hourElement.setAttribute("step", self.config.hourIncrement.toString());
    self.minuteElement.setAttribute("step", self.config.minuteIncrement.toString());
    self.hourElement.setAttribute("min", self.config.time_24hr ? "0" : "1");
    self.hourElement.setAttribute("max", self.config.time_24hr ? "23" : "12");
    self.hourElement.setAttribute("maxlength", "2");
    self.minuteElement.setAttribute("min", "0");
    self.minuteElement.setAttribute("max", "59");
    self.minuteElement.setAttribute("maxlength", "2");
    self.timeContainer.appendChild(hourInput);
    self.timeContainer.appendChild(separator);
    self.timeContainer.appendChild(minuteInput);
    if (self.config.time_24hr)
      self.timeContainer.classList.add("time24hr");
    if (self.config.enableSeconds) {
      self.timeContainer.classList.add("hasSeconds");
      var secondInput = createNumberInput("flatpickr-second");
      self.secondElement = secondInput.getElementsByTagName("input")[0];
      self.secondElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getSeconds() : defaults2.seconds);
      self.secondElement.setAttribute("step", self.minuteElement.getAttribute("step"));
      self.secondElement.setAttribute("min", "0");
      self.secondElement.setAttribute("max", "59");
      self.secondElement.setAttribute("maxlength", "2");
      self.timeContainer.appendChild(createElement("span", "flatpickr-time-separator", ":"));
      self.timeContainer.appendChild(secondInput);
    }
    if (!self.config.time_24hr) {
      self.amPM = createElement("span", "flatpickr-am-pm", self.l10n.amPM[int((self.latestSelectedDateObj ? self.hourElement.value : self.config.defaultHour) > 11)]);
      self.amPM.title = self.l10n.toggleTitle;
      self.amPM.tabIndex = -1;
      self.timeContainer.appendChild(self.amPM);
    }
    return self.timeContainer;
  }
  function buildWeekdays() {
    if (!self.weekdayContainer)
      self.weekdayContainer = createElement("div", "flatpickr-weekdays");
    else
      clearNode(self.weekdayContainer);
    for (var i = self.config.showMonths; i--; ) {
      var container = createElement("div", "flatpickr-weekdaycontainer");
      self.weekdayContainer.appendChild(container);
    }
    updateWeekdays();
    return self.weekdayContainer;
  }
  function updateWeekdays() {
    if (!self.weekdayContainer) {
      return;
    }
    var firstDayOfWeek = self.l10n.firstDayOfWeek;
    var weekdays = __spreadArrays(self.l10n.weekdays.shorthand);
    if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {
      weekdays = __spreadArrays(weekdays.splice(firstDayOfWeek, weekdays.length), weekdays.splice(0, firstDayOfWeek));
    }
    for (var i = self.config.showMonths; i--; ) {
      self.weekdayContainer.children[i].innerHTML = "\n      <span class='flatpickr-weekday'>\n        " + weekdays.join("</span><span class='flatpickr-weekday'>") + "\n      </span>\n      ";
    }
  }
  function buildWeeks() {
    self.calendarContainer.classList.add("hasWeeks");
    var weekWrapper = createElement("div", "flatpickr-weekwrapper");
    weekWrapper.appendChild(createElement("span", "flatpickr-weekday", self.l10n.weekAbbreviation));
    var weekNumbers = createElement("div", "flatpickr-weeks");
    weekWrapper.appendChild(weekNumbers);
    return {
      weekWrapper,
      weekNumbers
    };
  }
  function changeMonth(value, isOffset) {
    if (isOffset === void 0) {
      isOffset = true;
    }
    var delta = isOffset ? value : value - self.currentMonth;
    if (delta < 0 && self._hidePrevMonthArrow === true || delta > 0 && self._hideNextMonthArrow === true)
      return;
    self.currentMonth += delta;
    if (self.currentMonth < 0 || self.currentMonth > 11) {
      self.currentYear += self.currentMonth > 11 ? 1 : -1;
      self.currentMonth = (self.currentMonth + 12) % 12;
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    buildDays();
    triggerEvent("onMonthChange");
    updateNavigationCurrentMonth();
  }
  function clear(triggerChangeEvent, toInitial) {
    if (triggerChangeEvent === void 0) {
      triggerChangeEvent = true;
    }
    if (toInitial === void 0) {
      toInitial = true;
    }
    self.input.value = "";
    if (self.altInput !== void 0)
      self.altInput.value = "";
    if (self.mobileInput !== void 0)
      self.mobileInput.value = "";
    self.selectedDates = [];
    self.latestSelectedDateObj = void 0;
    if (toInitial === true) {
      self.currentYear = self._initialDate.getFullYear();
      self.currentMonth = self._initialDate.getMonth();
    }
    if (self.config.enableTime === true) {
      var _a = getDefaultHours(self.config), hours = _a.hours, minutes = _a.minutes, seconds = _a.seconds;
      setHours(hours, minutes, seconds);
    }
    self.redraw();
    if (triggerChangeEvent)
      triggerEvent("onChange");
  }
  function close() {
    self.isOpen = false;
    if (!self.isMobile) {
      if (self.calendarContainer !== void 0) {
        self.calendarContainer.classList.remove("open");
      }
      if (self._input !== void 0) {
        self._input.classList.remove("active");
      }
    }
    triggerEvent("onClose");
  }
  function destroy() {
    if (self.config !== void 0)
      triggerEvent("onDestroy");
    for (var i = self._handlers.length; i--; ) {
      self._handlers[i].remove();
    }
    self._handlers = [];
    if (self.mobileInput) {
      if (self.mobileInput.parentNode)
        self.mobileInput.parentNode.removeChild(self.mobileInput);
      self.mobileInput = void 0;
    } else if (self.calendarContainer && self.calendarContainer.parentNode) {
      if (self.config.static && self.calendarContainer.parentNode) {
        var wrapper = self.calendarContainer.parentNode;
        wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);
        if (wrapper.parentNode) {
          while (wrapper.firstChild)
            wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);
          wrapper.parentNode.removeChild(wrapper);
        }
      } else
        self.calendarContainer.parentNode.removeChild(self.calendarContainer);
    }
    if (self.altInput) {
      self.input.type = "text";
      if (self.altInput.parentNode)
        self.altInput.parentNode.removeChild(self.altInput);
      delete self.altInput;
    }
    if (self.input) {
      self.input.type = self.input._type;
      self.input.classList.remove("flatpickr-input");
      self.input.removeAttribute("readonly");
    }
    [
      "_showTimeInput",
      "latestSelectedDateObj",
      "_hideNextMonthArrow",
      "_hidePrevMonthArrow",
      "__hideNextMonthArrow",
      "__hidePrevMonthArrow",
      "isMobile",
      "isOpen",
      "selectedDateElem",
      "minDateHasTime",
      "maxDateHasTime",
      "days",
      "daysContainer",
      "_input",
      "_positionElement",
      "innerContainer",
      "rContainer",
      "monthNav",
      "todayDateElem",
      "calendarContainer",
      "weekdayContainer",
      "prevMonthNav",
      "nextMonthNav",
      "monthsDropdownContainer",
      "currentMonthElement",
      "currentYearElement",
      "navigationCurrentMonth",
      "selectedDateElem",
      "config"
    ].forEach(function(k) {
      try {
        delete self[k];
      } catch (_) {
      }
    });
  }
  function isCalendarElem(elem) {
    return self.calendarContainer.contains(elem);
  }
  function documentClick(e) {
    if (self.isOpen && !self.config.inline) {
      var eventTarget_1 = getEventTarget(e);
      var isCalendarElement = isCalendarElem(eventTarget_1);
      var isInput = eventTarget_1 === self.input || eventTarget_1 === self.altInput || self.element.contains(eventTarget_1) || e.path && e.path.indexOf && (~e.path.indexOf(self.input) || ~e.path.indexOf(self.altInput));
      var lostFocus = !isInput && !isCalendarElement && !isCalendarElem(e.relatedTarget);
      var isIgnored = !self.config.ignoredFocusElements.some(function(elem) {
        return elem.contains(eventTarget_1);
      });
      if (lostFocus && isIgnored) {
        if (self.config.allowInput) {
          self.setDate(self._input.value, false, self.config.altInput ? self.config.altFormat : self.config.dateFormat);
        }
        if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0 && self.input.value !== "" && self.input.value !== void 0) {
          updateTime();
        }
        self.close();
        if (self.config && self.config.mode === "range" && self.selectedDates.length === 1)
          self.clear(false);
      }
    }
  }
  function changeYear(newYear) {
    if (!newYear || self.config.minDate && newYear < self.config.minDate.getFullYear() || self.config.maxDate && newYear > self.config.maxDate.getFullYear())
      return;
    var newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;
    self.currentYear = newYearNum || self.currentYear;
    if (self.config.maxDate && self.currentYear === self.config.maxDate.getFullYear()) {
      self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);
    } else if (self.config.minDate && self.currentYear === self.config.minDate.getFullYear()) {
      self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);
    }
    if (isNewYear) {
      self.redraw();
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
  }
  function isEnabled(date, timeless) {
    var _a;
    if (timeless === void 0) {
      timeless = true;
    }
    var dateToCheck = self.parseDate(date, void 0, timeless);
    if (self.config.minDate && dateToCheck && compareDates(dateToCheck, self.config.minDate, timeless !== void 0 ? timeless : !self.minDateHasTime) < 0 || self.config.maxDate && dateToCheck && compareDates(dateToCheck, self.config.maxDate, timeless !== void 0 ? timeless : !self.maxDateHasTime) > 0)
      return false;
    if (!self.config.enable && self.config.disable.length === 0)
      return true;
    if (dateToCheck === void 0)
      return false;
    var bool = !!self.config.enable, array = (_a = self.config.enable) !== null && _a !== void 0 ? _a : self.config.disable;
    for (var i = 0, d = void 0; i < array.length; i++) {
      d = array[i];
      if (typeof d === "function" && d(dateToCheck))
        return bool;
      else if (d instanceof Date && dateToCheck !== void 0 && d.getTime() === dateToCheck.getTime())
        return bool;
      else if (typeof d === "string") {
        var parsed = self.parseDate(d, void 0, true);
        return parsed && parsed.getTime() === dateToCheck.getTime() ? bool : !bool;
      } else if (typeof d === "object" && dateToCheck !== void 0 && d.from && d.to && dateToCheck.getTime() >= d.from.getTime() && dateToCheck.getTime() <= d.to.getTime())
        return bool;
    }
    return !bool;
  }
  function isInView(elem) {
    if (self.daysContainer !== void 0)
      return elem.className.indexOf("hidden") === -1 && elem.className.indexOf("flatpickr-disabled") === -1 && self.daysContainer.contains(elem);
    return false;
  }
  function onBlur(e) {
    var isInput = e.target === self._input;
    var valueChanged = self._input.value.trimEnd() !== getDateStr();
    if (isInput && valueChanged && !(e.relatedTarget && isCalendarElem(e.relatedTarget))) {
      self.setDate(self._input.value, true, e.target === self.altInput ? self.config.altFormat : self.config.dateFormat);
    }
  }
  function onKeyDown(e) {
    var eventTarget = getEventTarget(e);
    var isInput = self.config.wrap ? element.contains(eventTarget) : eventTarget === self._input;
    var allowInput = self.config.allowInput;
    var allowKeydown = self.isOpen && (!allowInput || !isInput);
    var allowInlineKeydown = self.config.inline && isInput && !allowInput;
    if (e.keyCode === 13 && isInput) {
      if (allowInput) {
        self.setDate(self._input.value, true, eventTarget === self.altInput ? self.config.altFormat : self.config.dateFormat);
        self.close();
        return eventTarget.blur();
      } else {
        self.open();
      }
    } else if (isCalendarElem(eventTarget) || allowKeydown || allowInlineKeydown) {
      var isTimeObj = !!self.timeContainer && self.timeContainer.contains(eventTarget);
      switch (e.keyCode) {
        case 13:
          if (isTimeObj) {
            e.preventDefault();
            updateTime();
            focusAndClose();
          } else
            selectDate(e);
          break;
        case 27:
          e.preventDefault();
          focusAndClose();
          break;
        case 8:
        case 46:
          if (isInput && !self.config.allowInput) {
            e.preventDefault();
            self.clear();
          }
          break;
        case 37:
        case 39:
          if (!isTimeObj && !isInput) {
            e.preventDefault();
            var activeElement = getClosestActiveElement();
            if (self.daysContainer !== void 0 && (allowInput === false || activeElement && isInView(activeElement))) {
              var delta_1 = e.keyCode === 39 ? 1 : -1;
              if (!e.ctrlKey)
                focusOnDay(void 0, delta_1);
              else {
                e.stopPropagation();
                changeMonth(delta_1);
                focusOnDay(getFirstAvailableDay(1), 0);
              }
            }
          } else if (self.hourElement)
            self.hourElement.focus();
          break;
        case 38:
        case 40:
          e.preventDefault();
          var delta = e.keyCode === 40 ? 1 : -1;
          if (self.daysContainer && eventTarget.$i !== void 0 || eventTarget === self.input || eventTarget === self.altInput) {
            if (e.ctrlKey) {
              e.stopPropagation();
              changeYear(self.currentYear - delta);
              focusOnDay(getFirstAvailableDay(1), 0);
            } else if (!isTimeObj)
              focusOnDay(void 0, delta * 7);
          } else if (eventTarget === self.currentYearElement) {
            changeYear(self.currentYear - delta);
          } else if (self.config.enableTime) {
            if (!isTimeObj && self.hourElement)
              self.hourElement.focus();
            updateTime(e);
            self._debouncedChange();
          }
          break;
        case 9:
          if (isTimeObj) {
            var elems = [
              self.hourElement,
              self.minuteElement,
              self.secondElement,
              self.amPM
            ].concat(self.pluginElements).filter(function(x) {
              return x;
            });
            var i = elems.indexOf(eventTarget);
            if (i !== -1) {
              var target = elems[i + (e.shiftKey ? -1 : 1)];
              e.preventDefault();
              (target || self._input).focus();
            }
          } else if (!self.config.noCalendar && self.daysContainer && self.daysContainer.contains(eventTarget) && e.shiftKey) {
            e.preventDefault();
            self._input.focus();
          }
          break;
        default:
          break;
      }
    }
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      switch (e.key) {
        case self.l10n.amPM[0].charAt(0):
        case self.l10n.amPM[0].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[0];
          setHoursFromInputs();
          updateValue();
          break;
        case self.l10n.amPM[1].charAt(0):
        case self.l10n.amPM[1].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[1];
          setHoursFromInputs();
          updateValue();
          break;
      }
    }
    if (isInput || isCalendarElem(eventTarget)) {
      triggerEvent("onKeyDown", e);
    }
  }
  function onMouseOver(elem, cellClass) {
    if (cellClass === void 0) {
      cellClass = "flatpickr-day";
    }
    if (self.selectedDates.length !== 1 || elem && (!elem.classList.contains(cellClass) || elem.classList.contains("flatpickr-disabled")))
      return;
    var hoverDate = elem ? elem.dateObj.getTime() : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], void 0, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());
    var containsDisabled = false;
    var minRange = 0, maxRange = 0;
    for (var t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {
      if (!isEnabled(new Date(t), true)) {
        containsDisabled = containsDisabled || t > rangeStartDate && t < rangeEndDate;
        if (t < initialDate && (!minRange || t > minRange))
          minRange = t;
        else if (t > initialDate && (!maxRange || t < maxRange))
          maxRange = t;
      }
    }
    var hoverableCells = Array.from(self.rContainer.querySelectorAll("*:nth-child(-n+" + self.config.showMonths + ") > ." + cellClass));
    hoverableCells.forEach(function(dayElem) {
      var date = dayElem.dateObj;
      var timestamp = date.getTime();
      var outOfRange = minRange > 0 && timestamp < minRange || maxRange > 0 && timestamp > maxRange;
      if (outOfRange) {
        dayElem.classList.add("notAllowed");
        ["inRange", "startRange", "endRange"].forEach(function(c) {
          dayElem.classList.remove(c);
        });
        return;
      } else if (containsDisabled && !outOfRange)
        return;
      ["startRange", "inRange", "endRange", "notAllowed"].forEach(function(c) {
        dayElem.classList.remove(c);
      });
      if (elem !== void 0) {
        elem.classList.add(hoverDate <= self.selectedDates[0].getTime() ? "startRange" : "endRange");
        if (initialDate < hoverDate && timestamp === initialDate)
          dayElem.classList.add("startRange");
        else if (initialDate > hoverDate && timestamp === initialDate)
          dayElem.classList.add("endRange");
        if (timestamp >= minRange && (maxRange === 0 || timestamp <= maxRange) && isBetween(timestamp, initialDate, hoverDate))
          dayElem.classList.add("inRange");
      }
    });
  }
  function onResize() {
    if (self.isOpen && !self.config.static && !self.config.inline)
      positionCalendar();
  }
  function open(e, positionElement) {
    if (positionElement === void 0) {
      positionElement = self._positionElement;
    }
    if (self.isMobile === true) {
      if (e) {
        e.preventDefault();
        var eventTarget = getEventTarget(e);
        if (eventTarget) {
          eventTarget.blur();
        }
      }
      if (self.mobileInput !== void 0) {
        self.mobileInput.focus();
        self.mobileInput.click();
      }
      triggerEvent("onOpen");
      return;
    } else if (self._input.disabled || self.config.inline) {
      return;
    }
    var wasOpen = self.isOpen;
    self.isOpen = true;
    if (!wasOpen) {
      self.calendarContainer.classList.add("open");
      self._input.classList.add("active");
      triggerEvent("onOpen");
      positionCalendar(positionElement);
    }
    if (self.config.enableTime === true && self.config.noCalendar === true) {
      if (self.config.allowInput === false && (e === void 0 || !self.timeContainer.contains(e.relatedTarget))) {
        setTimeout(function() {
          return self.hourElement.select();
        }, 50);
      }
    }
  }
  function minMaxDateSetter(type) {
    return function(date) {
      var dateObj = self.config["_" + type + "Date"] = self.parseDate(date, self.config.dateFormat);
      var inverseDateObj = self.config["_" + (type === "min" ? "max" : "min") + "Date"];
      if (dateObj !== void 0) {
        self[type === "min" ? "minDateHasTime" : "maxDateHasTime"] = dateObj.getHours() > 0 || dateObj.getMinutes() > 0 || dateObj.getSeconds() > 0;
      }
      if (self.selectedDates) {
        self.selectedDates = self.selectedDates.filter(function(d) {
          return isEnabled(d);
        });
        if (!self.selectedDates.length && type === "min")
          setHoursFromDate(dateObj);
        updateValue();
      }
      if (self.daysContainer) {
        redraw();
        if (dateObj !== void 0)
          self.currentYearElement[type] = dateObj.getFullYear().toString();
        else
          self.currentYearElement.removeAttribute(type);
        self.currentYearElement.disabled = !!inverseDateObj && dateObj !== void 0 && inverseDateObj.getFullYear() === dateObj.getFullYear();
      }
    };
  }
  function parseConfig() {
    var boolOpts = [
      "wrap",
      "weekNumbers",
      "allowInput",
      "allowInvalidPreload",
      "clickOpens",
      "time_24hr",
      "enableTime",
      "noCalendar",
      "altInput",
      "shorthandCurrentMonth",
      "inline",
      "static",
      "enableSeconds",
      "disableMobile"
    ];
    var userConfig = __assign(__assign({}, JSON.parse(JSON.stringify(element.dataset || {}))), instanceConfig);
    var formats2 = {};
    self.config.parseDate = userConfig.parseDate;
    self.config.formatDate = userConfig.formatDate;
    Object.defineProperty(self.config, "enable", {
      get: function() {
        return self.config._enable;
      },
      set: function(dates) {
        self.config._enable = parseDateRules(dates);
      }
    });
    Object.defineProperty(self.config, "disable", {
      get: function() {
        return self.config._disable;
      },
      set: function(dates) {
        self.config._disable = parseDateRules(dates);
      }
    });
    var timeMode = userConfig.mode === "time";
    if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {
      var defaultDateFormat = flatpickr.defaultConfig.dateFormat || defaults.dateFormat;
      formats2.dateFormat = userConfig.noCalendar || timeMode ? "H:i" + (userConfig.enableSeconds ? ":S" : "") : defaultDateFormat + " H:i" + (userConfig.enableSeconds ? ":S" : "");
    }
    if (userConfig.altInput && (userConfig.enableTime || timeMode) && !userConfig.altFormat) {
      var defaultAltFormat = flatpickr.defaultConfig.altFormat || defaults.altFormat;
      formats2.altFormat = userConfig.noCalendar || timeMode ? "h:i" + (userConfig.enableSeconds ? ":S K" : " K") : defaultAltFormat + (" h:i" + (userConfig.enableSeconds ? ":S" : "") + " K");
    }
    Object.defineProperty(self.config, "minDate", {
      get: function() {
        return self.config._minDate;
      },
      set: minMaxDateSetter("min")
    });
    Object.defineProperty(self.config, "maxDate", {
      get: function() {
        return self.config._maxDate;
      },
      set: minMaxDateSetter("max")
    });
    var minMaxTimeSetter = function(type) {
      return function(val) {
        self.config[type === "min" ? "_minTime" : "_maxTime"] = self.parseDate(val, "H:i:S");
      };
    };
    Object.defineProperty(self.config, "minTime", {
      get: function() {
        return self.config._minTime;
      },
      set: minMaxTimeSetter("min")
    });
    Object.defineProperty(self.config, "maxTime", {
      get: function() {
        return self.config._maxTime;
      },
      set: minMaxTimeSetter("max")
    });
    if (userConfig.mode === "time") {
      self.config.noCalendar = true;
      self.config.enableTime = true;
    }
    Object.assign(self.config, formats2, userConfig);
    for (var i = 0; i < boolOpts.length; i++)
      self.config[boolOpts[i]] = self.config[boolOpts[i]] === true || self.config[boolOpts[i]] === "true";
    HOOKS.filter(function(hook) {
      return self.config[hook] !== void 0;
    }).forEach(function(hook) {
      self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);
    });
    self.isMobile = !self.config.disableMobile && !self.config.inline && self.config.mode === "single" && !self.config.disable.length && !self.config.enable && !self.config.weekNumbers && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    for (var i = 0; i < self.config.plugins.length; i++) {
      var pluginConf = self.config.plugins[i](self) || {};
      for (var key in pluginConf) {
        if (HOOKS.indexOf(key) > -1) {
          self.config[key] = arrayify(pluginConf[key]).map(bindToInstance).concat(self.config[key]);
        } else if (typeof userConfig[key] === "undefined")
          self.config[key] = pluginConf[key];
      }
    }
    if (!userConfig.altInputClass) {
      self.config.altInputClass = getInputElem().className + " " + self.config.altInputClass;
    }
    triggerEvent("onParseConfig");
  }
  function getInputElem() {
    return self.config.wrap ? element.querySelector("[data-input]") : element;
  }
  function setupLocale() {
    if (typeof self.config.locale !== "object" && typeof flatpickr.l10ns[self.config.locale] === "undefined")
      self.config.errorHandler(new Error("flatpickr: invalid locale " + self.config.locale));
    self.l10n = __assign(__assign({}, flatpickr.l10ns.default), typeof self.config.locale === "object" ? self.config.locale : self.config.locale !== "default" ? flatpickr.l10ns[self.config.locale] : void 0);
    tokenRegex.D = "(" + self.l10n.weekdays.shorthand.join("|") + ")";
    tokenRegex.l = "(" + self.l10n.weekdays.longhand.join("|") + ")";
    tokenRegex.M = "(" + self.l10n.months.shorthand.join("|") + ")";
    tokenRegex.F = "(" + self.l10n.months.longhand.join("|") + ")";
    tokenRegex.K = "(" + self.l10n.amPM[0] + "|" + self.l10n.amPM[1] + "|" + self.l10n.amPM[0].toLowerCase() + "|" + self.l10n.amPM[1].toLowerCase() + ")";
    var userConfig = __assign(__assign({}, instanceConfig), JSON.parse(JSON.stringify(element.dataset || {})));
    if (userConfig.time_24hr === void 0 && flatpickr.defaultConfig.time_24hr === void 0) {
      self.config.time_24hr = self.l10n.time_24hr;
    }
    self.formatDate = createDateFormatter(self);
    self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  }
  function positionCalendar(customPositionElement) {
    if (typeof self.config.position === "function") {
      return void self.config.position(self, customPositionElement);
    }
    if (self.calendarContainer === void 0)
      return;
    triggerEvent("onPreCalendarPosition");
    var positionElement = customPositionElement || self._positionElement;
    var calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, function(acc, child) {
      return acc + child.offsetHeight;
    }, 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(" "), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === "above" || configPosVertical !== "below" && distanceFromBottom < calendarHeight && inputBounds.top > calendarHeight;
    var top2 = window.pageYOffset + inputBounds.top + (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);
    toggleClass(self.calendarContainer, "arrowTop", !showOnTop);
    toggleClass(self.calendarContainer, "arrowBottom", showOnTop);
    if (self.config.inline)
      return;
    var left2 = window.pageXOffset + inputBounds.left;
    var isCenter = false;
    var isRight = false;
    if (configPosHorizontal === "center") {
      left2 -= (calendarWidth - inputBounds.width) / 2;
      isCenter = true;
    } else if (configPosHorizontal === "right") {
      left2 -= calendarWidth - inputBounds.width;
      isRight = true;
    }
    toggleClass(self.calendarContainer, "arrowLeft", !isCenter && !isRight);
    toggleClass(self.calendarContainer, "arrowCenter", isCenter);
    toggleClass(self.calendarContainer, "arrowRight", isRight);
    var right2 = window.document.body.offsetWidth - (window.pageXOffset + inputBounds.right);
    var rightMost = left2 + calendarWidth > window.document.body.offsetWidth;
    var centerMost = right2 + calendarWidth > window.document.body.offsetWidth;
    toggleClass(self.calendarContainer, "rightMost", rightMost);
    if (self.config.static)
      return;
    self.calendarContainer.style.top = top2 + "px";
    if (!rightMost) {
      self.calendarContainer.style.left = left2 + "px";
      self.calendarContainer.style.right = "auto";
    } else if (!centerMost) {
      self.calendarContainer.style.left = "auto";
      self.calendarContainer.style.right = right2 + "px";
    } else {
      var doc = getDocumentStyleSheet();
      if (doc === void 0)
        return;
      var bodyWidth = window.document.body.offsetWidth;
      var centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);
      var centerBefore = ".flatpickr-calendar.centerMost:before";
      var centerAfter = ".flatpickr-calendar.centerMost:after";
      var centerIndex = doc.cssRules.length;
      var centerStyle = "{left:" + inputBounds.left + "px;right:auto;}";
      toggleClass(self.calendarContainer, "rightMost", false);
      toggleClass(self.calendarContainer, "centerMost", true);
      doc.insertRule(centerBefore + "," + centerAfter + centerStyle, centerIndex);
      self.calendarContainer.style.left = centerLeft + "px";
      self.calendarContainer.style.right = "auto";
    }
  }
  function getDocumentStyleSheet() {
    var editableSheet = null;
    for (var i = 0; i < document.styleSheets.length; i++) {
      var sheet = document.styleSheets[i];
      if (!sheet.cssRules)
        continue;
      try {
        sheet.cssRules;
      } catch (err) {
        continue;
      }
      editableSheet = sheet;
      break;
    }
    return editableSheet != null ? editableSheet : createStyleSheet();
  }
  function createStyleSheet() {
    var style = document.createElement("style");
    document.head.appendChild(style);
    return style.sheet;
  }
  function redraw() {
    if (self.config.noCalendar || self.isMobile)
      return;
    buildMonthSwitch();
    updateNavigationCurrentMonth();
    buildDays();
  }
  function focusAndClose() {
    self._input.focus();
    if (window.navigator.userAgent.indexOf("MSIE") !== -1 || navigator.msMaxTouchPoints !== void 0) {
      setTimeout(self.close, 0);
    } else {
      self.close();
    }
  }
  function selectDate(e) {
    e.preventDefault();
    e.stopPropagation();
    var isSelectable = function(day) {
      return day.classList && day.classList.contains("flatpickr-day") && !day.classList.contains("flatpickr-disabled") && !day.classList.contains("notAllowed");
    };
    var t = findParent(getEventTarget(e), isSelectable);
    if (t === void 0)
      return;
    var target = t;
    var selectedDate = self.latestSelectedDateObj = new Date(target.dateObj.getTime());
    var shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth || selectedDate.getMonth() > self.currentMonth + self.config.showMonths - 1) && self.config.mode !== "range";
    self.selectedDateElem = target;
    if (self.config.mode === "single")
      self.selectedDates = [selectedDate];
    else if (self.config.mode === "multiple") {
      var selectedIndex = isDateSelected(selectedDate);
      if (selectedIndex)
        self.selectedDates.splice(parseInt(selectedIndex), 1);
      else
        self.selectedDates.push(selectedDate);
    } else if (self.config.mode === "range") {
      if (self.selectedDates.length === 2) {
        self.clear(false, false);
      }
      self.latestSelectedDateObj = selectedDate;
      self.selectedDates.push(selectedDate);
      if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)
        self.selectedDates.sort(function(a, b) {
          return a.getTime() - b.getTime();
        });
    }
    setHoursFromInputs();
    if (shouldChangeMonth) {
      var isNewYear = self.currentYear !== selectedDate.getFullYear();
      self.currentYear = selectedDate.getFullYear();
      self.currentMonth = selectedDate.getMonth();
      if (isNewYear) {
        triggerEvent("onYearChange");
        buildMonthSwitch();
      }
      triggerEvent("onMonthChange");
    }
    updateNavigationCurrentMonth();
    buildDays();
    updateValue();
    if (!shouldChangeMonth && self.config.mode !== "range" && self.config.showMonths === 1)
      focusOnDayElem(target);
    else if (self.selectedDateElem !== void 0 && self.hourElement === void 0) {
      self.selectedDateElem && self.selectedDateElem.focus();
    }
    if (self.hourElement !== void 0)
      self.hourElement !== void 0 && self.hourElement.focus();
    if (self.config.closeOnSelect) {
      var single = self.config.mode === "single" && !self.config.enableTime;
      var range = self.config.mode === "range" && self.selectedDates.length === 2 && !self.config.enableTime;
      if (single || range) {
        focusAndClose();
      }
    }
    triggerChange();
  }
  var CALLBACKS = {
    locale: [setupLocale, updateWeekdays],
    showMonths: [buildMonths, setCalendarWidth, buildWeekdays],
    minDate: [jumpToDate],
    maxDate: [jumpToDate],
    positionElement: [updatePositionElement],
    clickOpens: [
      function() {
        if (self.config.clickOpens === true) {
          bind(self._input, "focus", self.open);
          bind(self._input, "click", self.open);
        } else {
          self._input.removeEventListener("focus", self.open);
          self._input.removeEventListener("click", self.open);
        }
      }
    ]
  };
  function set(option, value) {
    if (option !== null && typeof option === "object") {
      Object.assign(self.config, option);
      for (var key in option) {
        if (CALLBACKS[key] !== void 0)
          CALLBACKS[key].forEach(function(x) {
            return x();
          });
      }
    } else {
      self.config[option] = value;
      if (CALLBACKS[option] !== void 0)
        CALLBACKS[option].forEach(function(x) {
          return x();
        });
      else if (HOOKS.indexOf(option) > -1)
        self.config[option] = arrayify(value);
    }
    self.redraw();
    updateValue(true);
  }
  function setSelectedDate(inputDate, format2) {
    var dates = [];
    if (inputDate instanceof Array)
      dates = inputDate.map(function(d) {
        return self.parseDate(d, format2);
      });
    else if (inputDate instanceof Date || typeof inputDate === "number")
      dates = [self.parseDate(inputDate, format2)];
    else if (typeof inputDate === "string") {
      switch (self.config.mode) {
        case "single":
        case "time":
          dates = [self.parseDate(inputDate, format2)];
          break;
        case "multiple":
          dates = inputDate.split(self.config.conjunction).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        case "range":
          dates = inputDate.split(self.l10n.rangeSeparator).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        default:
          break;
      }
    } else
      self.config.errorHandler(new Error("Invalid date supplied: " + JSON.stringify(inputDate)));
    self.selectedDates = self.config.allowInvalidPreload ? dates : dates.filter(function(d) {
      return d instanceof Date && isEnabled(d, false);
    });
    if (self.config.mode === "range")
      self.selectedDates.sort(function(a, b) {
        return a.getTime() - b.getTime();
      });
  }
  function setDate(date, triggerChange2, format2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = false;
    }
    if (format2 === void 0) {
      format2 = self.config.dateFormat;
    }
    if (date !== 0 && !date || date instanceof Array && date.length === 0)
      return self.clear(triggerChange2);
    setSelectedDate(date, format2);
    self.latestSelectedDateObj = self.selectedDates[self.selectedDates.length - 1];
    self.redraw();
    jumpToDate(void 0, triggerChange2);
    setHoursFromDate();
    if (self.selectedDates.length === 0) {
      self.clear(false);
    }
    updateValue(triggerChange2);
    if (triggerChange2)
      triggerEvent("onChange");
  }
  function parseDateRules(arr) {
    return arr.slice().map(function(rule) {
      if (typeof rule === "string" || typeof rule === "number" || rule instanceof Date) {
        return self.parseDate(rule, void 0, true);
      } else if (rule && typeof rule === "object" && rule.from && rule.to)
        return {
          from: self.parseDate(rule.from, void 0),
          to: self.parseDate(rule.to, void 0)
        };
      return rule;
    }).filter(function(x) {
      return x;
    });
  }
  function setupDates() {
    self.selectedDates = [];
    self.now = self.parseDate(self.config.now) || new Date();
    var preloadedDate = self.config.defaultDate || ((self.input.nodeName === "INPUT" || self.input.nodeName === "TEXTAREA") && self.input.placeholder && self.input.value === self.input.placeholder ? null : self.input.value);
    if (preloadedDate)
      setSelectedDate(preloadedDate, self.config.dateFormat);
    self._initialDate = self.selectedDates.length > 0 ? self.selectedDates[0] : self.config.minDate && self.config.minDate.getTime() > self.now.getTime() ? self.config.minDate : self.config.maxDate && self.config.maxDate.getTime() < self.now.getTime() ? self.config.maxDate : self.now;
    self.currentYear = self._initialDate.getFullYear();
    self.currentMonth = self._initialDate.getMonth();
    if (self.selectedDates.length > 0)
      self.latestSelectedDateObj = self.selectedDates[0];
    if (self.config.minTime !== void 0)
      self.config.minTime = self.parseDate(self.config.minTime, "H:i");
    if (self.config.maxTime !== void 0)
      self.config.maxTime = self.parseDate(self.config.maxTime, "H:i");
    self.minDateHasTime = !!self.config.minDate && (self.config.minDate.getHours() > 0 || self.config.minDate.getMinutes() > 0 || self.config.minDate.getSeconds() > 0);
    self.maxDateHasTime = !!self.config.maxDate && (self.config.maxDate.getHours() > 0 || self.config.maxDate.getMinutes() > 0 || self.config.maxDate.getSeconds() > 0);
  }
  function setupInputs() {
    self.input = getInputElem();
    if (!self.input) {
      self.config.errorHandler(new Error("Invalid input element specified"));
      return;
    }
    self.input._type = self.input.type;
    self.input.type = "text";
    self.input.classList.add("flatpickr-input");
    self._input = self.input;
    if (self.config.altInput) {
      self.altInput = createElement(self.input.nodeName, self.config.altInputClass);
      self._input = self.altInput;
      self.altInput.placeholder = self.input.placeholder;
      self.altInput.disabled = self.input.disabled;
      self.altInput.required = self.input.required;
      self.altInput.tabIndex = self.input.tabIndex;
      self.altInput.type = "text";
      self.input.setAttribute("type", "hidden");
      if (!self.config.static && self.input.parentNode)
        self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);
    }
    if (!self.config.allowInput)
      self._input.setAttribute("readonly", "readonly");
    updatePositionElement();
  }
  function updatePositionElement() {
    self._positionElement = self.config.positionElement || self._input;
  }
  function setupMobile() {
    var inputType = self.config.enableTime ? self.config.noCalendar ? "time" : "datetime-local" : "date";
    self.mobileInput = createElement("input", self.input.className + " flatpickr-mobile");
    self.mobileInput.tabIndex = 1;
    self.mobileInput.type = inputType;
    self.mobileInput.disabled = self.input.disabled;
    self.mobileInput.required = self.input.required;
    self.mobileInput.placeholder = self.input.placeholder;
    self.mobileFormatStr = inputType === "datetime-local" ? "Y-m-d\\TH:i:S" : inputType === "date" ? "Y-m-d" : "H:i:S";
    if (self.selectedDates.length > 0) {
      self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);
    }
    if (self.config.minDate)
      self.mobileInput.min = self.formatDate(self.config.minDate, "Y-m-d");
    if (self.config.maxDate)
      self.mobileInput.max = self.formatDate(self.config.maxDate, "Y-m-d");
    if (self.input.getAttribute("step"))
      self.mobileInput.step = String(self.input.getAttribute("step"));
    self.input.type = "hidden";
    if (self.altInput !== void 0)
      self.altInput.type = "hidden";
    try {
      if (self.input.parentNode)
        self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);
    } catch (_a) {
    }
    bind(self.mobileInput, "change", function(e) {
      self.setDate(getEventTarget(e).value, false, self.mobileFormatStr);
      triggerEvent("onChange");
      triggerEvent("onClose");
    });
  }
  function toggle(e) {
    if (self.isOpen === true)
      return self.close();
    self.open(e);
  }
  function triggerEvent(event, data) {
    if (self.config === void 0)
      return;
    var hooks = self.config[event];
    if (hooks !== void 0 && hooks.length > 0) {
      for (var i = 0; hooks[i] && i < hooks.length; i++)
        hooks[i](self.selectedDates, self.input.value, self, data);
    }
    if (event === "onChange") {
      self.input.dispatchEvent(createEvent("change"));
      self.input.dispatchEvent(createEvent("input"));
    }
  }
  function createEvent(name) {
    var e = document.createEvent("Event");
    e.initEvent(name, true, true);
    return e;
  }
  function isDateSelected(date) {
    for (var i = 0; i < self.selectedDates.length; i++) {
      var selectedDate = self.selectedDates[i];
      if (selectedDate instanceof Date && compareDates(selectedDate, date) === 0)
        return "" + i;
    }
    return false;
  }
  function isDateInRange(date) {
    if (self.config.mode !== "range" || self.selectedDates.length < 2)
      return false;
    return compareDates(date, self.selectedDates[0]) >= 0 && compareDates(date, self.selectedDates[1]) <= 0;
  }
  function updateNavigationCurrentMonth() {
    if (self.config.noCalendar || self.isMobile || !self.monthNav)
      return;
    self.yearElements.forEach(function(yearElement, i) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
        self.monthElements[i].textContent = monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) + " ";
      } else {
        self.monthsDropdownContainer.value = d.getMonth().toString();
      }
      yearElement.value = d.getFullYear().toString();
    });
    self._hidePrevMonthArrow = self.config.minDate !== void 0 && (self.currentYear === self.config.minDate.getFullYear() ? self.currentMonth <= self.config.minDate.getMonth() : self.currentYear < self.config.minDate.getFullYear());
    self._hideNextMonthArrow = self.config.maxDate !== void 0 && (self.currentYear === self.config.maxDate.getFullYear() ? self.currentMonth + 1 > self.config.maxDate.getMonth() : self.currentYear > self.config.maxDate.getFullYear());
  }
  function getDateStr(specificFormat) {
    var format2 = specificFormat || (self.config.altInput ? self.config.altFormat : self.config.dateFormat);
    return self.selectedDates.map(function(dObj) {
      return self.formatDate(dObj, format2);
    }).filter(function(d, i, arr) {
      return self.config.mode !== "range" || self.config.enableTime || arr.indexOf(d) === i;
    }).join(self.config.mode !== "range" ? self.config.conjunction : self.l10n.rangeSeparator);
  }
  function updateValue(triggerChange2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = true;
    }
    if (self.mobileInput !== void 0 && self.mobileFormatStr) {
      self.mobileInput.value = self.latestSelectedDateObj !== void 0 ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr) : "";
    }
    self.input.value = getDateStr(self.config.dateFormat);
    if (self.altInput !== void 0) {
      self.altInput.value = getDateStr(self.config.altFormat);
    }
    if (triggerChange2 !== false)
      triggerEvent("onValueUpdate");
  }
  function onMonthNavClick(e) {
    var eventTarget = getEventTarget(e);
    var isPrevMonth = self.prevMonthNav.contains(eventTarget);
    var isNextMonth = self.nextMonthNav.contains(eventTarget);
    if (isPrevMonth || isNextMonth) {
      changeMonth(isPrevMonth ? -1 : 1);
    } else if (self.yearElements.indexOf(eventTarget) >= 0) {
      eventTarget.select();
    } else if (eventTarget.classList.contains("arrowUp")) {
      self.changeYear(self.currentYear + 1);
    } else if (eventTarget.classList.contains("arrowDown")) {
      self.changeYear(self.currentYear - 1);
    }
  }
  function timeWrapper(e) {
    e.preventDefault();
    var isKeyDown = e.type === "keydown", eventTarget = getEventTarget(e), input = eventTarget;
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
    }
    var min2 = parseFloat(input.getAttribute("min")), max2 = parseFloat(input.getAttribute("max")), step = parseFloat(input.getAttribute("step")), curValue = parseInt(input.value, 10), delta = e.delta || (isKeyDown ? e.which === 38 ? 1 : -1 : 0);
    var newValue = curValue + step * delta;
    if (typeof input.value !== "undefined" && input.value.length === 2) {
      var isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;
      if (newValue < min2) {
        newValue = max2 + newValue + int(!isHourElem) + (int(isHourElem) && int(!self.amPM));
        if (isMinuteElem)
          incrementNumInput(void 0, -1, self.hourElement);
      } else if (newValue > max2) {
        newValue = input === self.hourElement ? newValue - max2 - int(!self.amPM) : min2;
        if (isMinuteElem)
          incrementNumInput(void 0, 1, self.hourElement);
      }
      if (self.amPM && isHourElem && (step === 1 ? newValue + curValue === 23 : Math.abs(newValue - curValue) > step)) {
        self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
      }
      input.value = pad(newValue);
    }
  }
  init();
  return self;
}
function _flatpickr(nodeList, config) {
  var nodes = Array.prototype.slice.call(nodeList).filter(function(x) {
    return x instanceof HTMLElement;
  });
  var instances = [];
  for (var i = 0; i < nodes.length; i++) {
    var node = nodes[i];
    try {
      if (node.getAttribute("data-fp-omit") !== null)
        continue;
      if (node._flatpickr !== void 0) {
        node._flatpickr.destroy();
        node._flatpickr = void 0;
      }
      node._flatpickr = FlatpickrInstance(node, config || {});
      instances.push(node._flatpickr);
    } catch (e) {
      console.error(e);
    }
  }
  return instances.length === 1 ? instances[0] : instances;
}
if (typeof HTMLElement !== "undefined" && typeof HTMLCollection !== "undefined" && typeof NodeList !== "undefined") {
  HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
  HTMLElement.prototype.flatpickr = function(config) {
    return _flatpickr([this], config);
  };
}
var flatpickr = function(selector, config) {
  if (typeof selector === "string") {
    return _flatpickr(window.document.querySelectorAll(selector), config);
  } else if (selector instanceof Node) {
    return _flatpickr([selector], config);
  } else {
    return _flatpickr(selector, config);
  }
};
flatpickr.defaultConfig = {};
flatpickr.l10ns = {
  en: __assign({}, default_default),
  default: __assign({}, default_default)
};
flatpickr.localize = function(l10n) {
  flatpickr.l10ns.default = __assign(__assign({}, flatpickr.l10ns.default), l10n);
};
flatpickr.setDefaults = function(config) {
  flatpickr.defaultConfig = __assign(__assign({}, flatpickr.defaultConfig), config);
};
flatpickr.parseDate = createDateParser({});
flatpickr.formatDate = createDateFormatter({});
flatpickr.compareDates = compareDates;
if (typeof jQuery !== "undefined" && typeof jQuery.fn !== "undefined") {
  jQuery.fn.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
}
Date.prototype.fp_incr = function(days) {
  return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === "string" ? parseInt(days, 10) : days));
};
if (typeof window !== "undefined") {
  window.flatpickr = flatpickr;
}
var esm_default = flatpickr;

// src/modals/fields/DateModal.ts
var DateModal = class extends BaseModal {
  constructor(plugin, file, field, initialValue, lineNumber = -1, after = false, asList = false, asComment = false) {
    var _a, _b;
    super(plugin);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.initialValue = initialValue;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.pushNextInterval = false;
    this.initialValue = initialValue ? ((_a = initialValue.toString().replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last()) || "" : "";
    this.insertAsLink = FieldManager2.stringToBoolean(this.field.options.defaultInsertAsLink || "false") || false;
    this.format = this.field.options.dateFormat || this.field.options.defaultDateFormat;
    this.dvApi = (_b = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _b.api;
    if (this.dvApi)
      this.dateManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.value = this.initialValue;
  }
  onOpen() {
    super.onOpen();
    this.containerEl.addClass("metadata-menu");
    const fieldContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.buildFields(fieldContainer);
    this.errorField = this.contentEl.createEl("div", { cls: "field-error" });
    this.errorField.hide();
  }
  save(e) {
    return __async(this, null, function* () {
      let newValue;
      if (this.plugin.app.plugins.enabledPlugins.has("nldates-obsidian")) {
        try {
          const nldates = this.plugin.app.plugins.plugins["nldates-obsidian"];
          newValue = nldates.parseDate(this.value).moment;
        } catch (error) {
          console.log(error);
          newValue = (0, import_obsidian25.moment)(this.value, this.format);
        }
      } else {
        newValue = (0, import_obsidian25.moment)(this.value, this.format);
      }
      if (newValue.isValid()) {
        const linkPath = this.plugin.app.metadataCache.getFirstLinkpathDest(this.field.options.linkPath || "" + newValue.format(this.format), this.file.path);
        const formattedValue = this.insertAsLink ? `[[${this.field.options.linkPath || ""}${newValue.format(this.format)}${linkPath ? "|" + linkPath.basename : ""}]]` : newValue.format(this.format);
        yield postValues(this.plugin, [{ name: this.field.name, payload: { value: formattedValue } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
        if (this.nextIntervalField && this.pushNextInterval && this.nextShift) {
          yield postValues(this.plugin, [{ name: this.nextIntervalField.name, payload: { value: this.nextShift } }], this.file.path);
          this.close();
        }
        this.close();
      } else if (!this.value) {
        yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
        this.close();
      } else {
        this.errorField.show();
        this.errorField.setText(`value must be a valid date`);
        this.inputEl.inputEl.addClass("is-invalid");
        return;
      }
    });
  }
  buildFields(dateFieldsContainer) {
    this.buildInputEl(dateFieldsContainer);
    this.buildInsertAsLinkButton(dateFieldsContainer);
    this.buildSaveBtn(dateFieldsContainer);
  }
  buildInsertAsLinkButton(container) {
    const insertAsLinkBtn = new import_obsidian24.ButtonComponent(container);
    const setLinkBtnIcon = () => {
      insertAsLinkBtn.setIcon(this.insertAsLink ? "link" : "unlink");
      insertAsLinkBtn.setTooltip(this.insertAsLink ? "Click to insert date as text" : "Click to insert date as link");
    };
    setLinkBtnIcon();
    insertAsLinkBtn.onClick(() => {
      this.insertAsLink = !this.insertAsLink;
      setLinkBtnIcon();
    });
  }
  toggleButton(button, value) {
    button.setDisabled(!!value);
    if (value) {
      button.buttonEl.addClass("disabled");
    } else {
      button.buttonEl.removeClass("disabled");
    }
  }
  buildInputEl(container) {
    if (this.dateManager)
      [this.currentShift, this.nextIntervalField, this.nextShift] = this.dateManager.shiftDuration(this.file);
    this.inputEl = new import_obsidian24.TextComponent(container);
    this.inputEl.inputEl.focus();
    this.inputEl.setPlaceholder(this.initialValue ? (0, import_obsidian25.moment)(this.initialValue, this.field.options.dateFormat).format(this.field.options.dateFormat) : "");
    this.inputEl.onChange((value) => {
      this.inputEl.inputEl.removeClass("is-invalid");
      this.errorField.hide();
      this.errorField.setText("");
      this.value = value;
      this.toggleButton(shiftFromTodayBtn, value);
    });
    const calendarDisplayBtn = new import_obsidian24.ButtonComponent(container);
    calendarDisplayBtn.setIcon(FieldIcon["Date" /* Date */]);
    calendarDisplayBtn.setTooltip("open date picker");
    const shiftFromTodayBtn = new import_obsidian24.ButtonComponent(container);
    shiftFromTodayBtn.setIcon("skip-forward");
    shiftFromTodayBtn.setTooltip(`Shift ${this.field.name} ${this.currentShift || "1 day"} ahead`);
    const datePickerContainer = container.createDiv();
    const datePicker = esm_default(datePickerContainer, {
      locale: {
        firstDayOfWeek: this.plugin.settings.firstDayOfWeek
      },
      defaultDate: (0, import_obsidian25.moment)(Date.now()).format("YYYY-MM-DD")
    });
    datePicker.config.onChange.push((value) => {
      const newDate = (0, import_obsidian25.moment)(value.toString()).format(this.format);
      this.inputEl.setValue(newDate);
      this.value = newDate;
      this.toggleButton(shiftFromTodayBtn, this.value);
    });
    calendarDisplayBtn.onClick((e) => {
      e.preventDefault();
      datePicker.setDate(datePicker.parseDate(this.inputEl.getValue()) || new Date());
      datePicker.open();
    });
    shiftFromTodayBtn.onClick((e) => __async(this, null, function* () {
      const currentDvDate = this.dvApi.date((0, import_obsidian25.moment)(this.initialValue, this.format).toISOString());
      const newDate = currentDvDate.plus(this.dvApi.duration(this.currentShift || "1 day"));
      const newValue = (0, import_obsidian25.moment)(newDate.toString()).format(this.format);
      this.inputEl.setValue(newValue);
      this.value = newValue;
      this.pushNextInterval = true;
      this.toggleButton(shiftFromTodayBtn, this.inputEl.getValue());
    }));
    if (!this.dvApi) {
      shiftFromTodayBtn.buttonEl.hide();
      shiftFromTodayBtn.setDisabled(true);
    }
  }
};

// src/fields/fieldManagers/DateField.ts
var DateField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Date" /* Date */);
    this.defaultDateFormat = "YYYY-MM-DD";
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    var _a;
    const modal = new DateModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change date for <${name}>`);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    const dateIconName = FieldIcon["Date" /* Date */];
    const dateModalAction = () => modal.open();
    const p = dvApi.page(file.path);
    const shiftDateAction = () => this.shiftDate(dvApi, p, file);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const [currentShift] = fieldManager.shiftDuration(file);
    if (DateField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(dateIconName);
        item.onClick(dateModalAction);
        item.setSection("metadata-menu.fields");
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        location.addItem((item) => {
          item.setTitle(`Shift <${name}> ${currentShift} ahead`);
          item.setIcon("skip-forward");
          item.onClick(shiftDateAction);
          item.setSection("metadata-menu.fields");
        });
      }
    } else if (DateField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: dateModalAction,
        icon: dateIconName
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        location.options.push({
          id: `update_${name}`,
          actionLabel: `<span>Shift <b>${name}</b> ${currentShift} ahead</span>`,
          action: shiftDateAction,
          icon: "skip-forward"
        });
      }
    } else if (DateField.isFieldOptions(location)) {
      location.addOption("skip-forward", shiftDateAction, `Shift ${name} ahead by ${currentShift}`);
      location.addOption(dateIconName, dateModalAction, `Set ${name}'s date`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new DateModal(this.plugin, file, this.field, value || "", lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter date for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDateContainer(container) {
    if (!this.field.options.dateFormat)
      this.field.options.dateFormat = this.defaultDateFormat;
    if (!this.field.options.defaultInsertAsLink)
      this.field.options.defaultInsertAsLink = "false";
    const dateFormatContainer = container.createDiv({ cls: "field-container" });
    dateFormatContainer.createEl("span", { text: "Date format", cls: "label" });
    const dateExample = dateFormatContainer.createEl("span", { cls: "more-info" });
    dateFormatContainer.createDiv({ cls: "spacer" });
    const dateFormatInput = new import_obsidian26.TextComponent(dateFormatContainer);
    dateFormatInput.setValue(this.field.options.dateFormat);
    dateExample.setText(`${(0, import_obsidian26.moment)().format(dateFormatInput.getValue())}`);
    dateFormatInput.onChange((value) => {
      this.field.options.dateFormat = value;
      dateExample.setText(`${(0, import_obsidian26.moment)().format(value)}`);
    });
    const defaultInsertAsLinkContainer = container.createDiv({ cls: "field-container" });
    defaultInsertAsLinkContainer.createEl("span", { text: "Insert as link by default", cls: "label" });
    defaultInsertAsLinkContainer.createDiv({ cls: "spacer" });
    const defaultInsertAsLink = new import_obsidian26.ToggleComponent(defaultInsertAsLinkContainer);
    defaultInsertAsLink.setValue(DateField.stringToBoolean(this.field.options.defaultInsertAsLink));
    defaultInsertAsLink.onChange((value) => {
      this.field.options.defaultInsertAsLink = value.toString();
    });
    const dateLinkPathContainer = container.createDiv({ cls: "field-container" });
    dateLinkPathContainer.createEl("span", { text: "Link path (optional)", cls: "label" });
    dateLinkPathContainer.createDiv({ cls: "spacer" });
    const dateLinkPathInput = new import_obsidian26.TextComponent(dateLinkPathContainer);
    dateLinkPathInput.setValue(this.field.options.linkPath);
    dateLinkPathInput.onChange((value) => {
      this.field.options.linkPath = value + (!value.endsWith("/") && !!value.length ? "/" : "");
    });
    const dateShiftIntervalContainer = container.createDiv({ cls: "field-container" });
    dateShiftIntervalContainer.createEl("span", { text: "Define a shift interval", cls: "label" });
    dateShiftIntervalContainer.createDiv({ cls: "spacer" });
    const dateShiftInterval = new import_obsidian26.TextComponent(dateShiftIntervalContainer);
    dateShiftInterval.setPlaceholder("ex: 1 month 2 days");
    dateShiftInterval.setValue(this.field.options.dateShiftInterval);
    dateShiftInterval.onChange((value) => {
      if (!value) {
        delete this.field.options.dateShiftInterval;
      } else {
        this.field.options.dateShiftInterval = value.toString();
      }
    });
    const nextShiftIntervalFieldContainer = container.createDiv({ cls: "field-container" });
    nextShiftIntervalFieldContainer.createEl("span", {
      text: "Field containing shift intervals",
      cls: "label"
    });
    nextShiftIntervalFieldContainer.createDiv({ cls: "spacer" });
    const nextShiftIntervalField = new import_obsidian26.TextComponent(nextShiftIntervalFieldContainer);
    nextShiftIntervalField.setValue(this.field.options.nextShiftIntervalField);
    nextShiftIntervalField.onChange((value) => {
      if (!value) {
        delete this.field.options.nextShiftIntervalField;
      } else {
        this.field.options.nextShiftIntervalField = value.toString();
      }
    });
  }
  createSettingContainer(container, plugin, location) {
    this.createDateContainer(container);
  }
  shiftDate(dv, p, file) {
    return __async(this, null, function* () {
      const { dateFormat, defaultInsertAsLink, linkPath } = this.field.options;
      const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      const [currentShift, nextIntervalField, nextShift] = fieldManager.shiftDuration(file);
      const dvDate = p[this.field.name];
      const currentDateValue = dv.value.isLink(dvDate) ? dvDate.path.split("/").last() : dv.value.isDate(dvDate) ? (0, import_obsidian26.moment)(dvDate.toJSDate()).format(dateFormat) : dvDate;
      const currentDvDate = dv.date((0, import_obsidian26.moment)(currentDateValue, dateFormat).toISOString());
      const newDate = currentDvDate.plus(dv.duration(currentShift || "1 day"));
      const newValue = (0, import_obsidian26.moment)(newDate.toString()).format(dateFormat);
      if (nextIntervalField && nextShift) {
        yield postValues(this.plugin, [{ name: nextIntervalField.name, payload: { value: nextShift } }], file.path);
      }
      const linkFile = this.plugin.app.metadataCache.getFirstLinkpathDest(linkPath || "" + newValue.format(dateFormat), file.path);
      const formattedValue = DateField.stringToBoolean(defaultInsertAsLink) ? `[[${linkPath || ""}${newValue}${linkFile ? "|" + linkFile.basename : ""}]]` : newValue;
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: formattedValue } }], file);
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const dateBtn = fieldContainer.createEl("button");
    (0, import_obsidian26.setIcon)(dateBtn, FieldIcon["Date" /* Date */]);
    const spacer = fieldContainer.createDiv({ cls: "spacer-1" });
    if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField) {
      this.shiftBtn = fieldContainer.createEl("button");
      (0, import_obsidian26.setIcon)(this.shiftBtn, "skip-forward");
      spacer.setAttr("class", "spacer-2");
    } else {
      spacer.setAttr("class", "spacer-1");
    }
    const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
    let fieldModal;
    if (file instanceof import_obsidian26.TFile && file.extension == "md") {
      if (p[this.field.name] && p[this.field.name].hasOwnProperty("path")) {
        const dateFile = this.plugin.app.vault.getAbstractFileByPath(p[this.field.name]);
        if (dateFile instanceof import_obsidian26.TFile && dateFile.extension == "md") {
          fieldModal = new DateModal(this.plugin, file, this.field, dateFile.name);
        } else {
          fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name].path.split("/").last().replace(".md", ""));
        }
      } else if (p[this.field.name]) {
        fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name]);
      } else {
        fieldModal = new DateModal(this.plugin, file, this.field, "");
      }
      if (this.shiftBtn)
        this.shiftBtn.onclick = () => {
          this.shiftDate(dv, p, file);
        };
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    fieldModal.onClose = () => {
      fieldModal.contentEl.innerHTML = "";
    };
    dateBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      dateBtn.hide();
      if (this.shiftBtn)
        this.shiftBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        dateBtn.show();
        if (this.shiftBtn)
          this.shiftBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        dateBtn.hide();
        if (this.shiftBtn)
          this.shiftBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(dateBtn);
    if (this.shiftBtn)
      fieldContainer.appendChild(this.shiftBtn);
    fieldContainer.appendChild(spacer);
  }
  getOptionsStr() {
    return this.field.options.dateFormat;
  }
  validateOptions() {
    return true;
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const value = dvApi.page(file.path)[fieldName];
      if (dvApi.value.isDate(value)) {
        container.createDiv({ text: (0, import_obsidian26.moment)(value.toJSDate()).format(this.field.options.dateFormat) });
      } else if (dvApi.value.isLink(value)) {
        const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
        link.onclick = () => {
          this.plugin.app.workspace.openLinkText(value.path, file.path, true);
          onClicked();
        };
      } else {
        container.createDiv({ text: value });
      }
    }
    container.createDiv({});
  }
  validateValue(value) {
    var _a, _b;
    if (!value) {
      return true;
    } else {
      if (typeof value == "string") {
        return (0, import_obsidian26.moment)((_a = value.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last(), this.field.options.dateFormat).isValid();
      } else {
        return (0, import_obsidian26.moment)((_b = value.path.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _b.split("/").last(), this.field.options.dateFormat).isValid();
      }
    }
  }
  shiftDuration(file) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const interval = this.field.options.dateShiftInterval;
      const cycleIntervalField = this.field.options.nextShiftIntervalField;
      const cycle = (_b = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _b.find((field) => field.name === cycleIntervalField);
      if (cycle) {
        const cycleManager = new FieldManager[cycle.type](this.plugin, cycle);
        const options2 = cycleManager.getOptionsList();
        const currentValue = dvApi.page(file.path)[cycle.name];
        if (currentValue) {
          const currentValueString = options2.filter((o) => dvApi.duration(o) !== null).find((o) => compareDuration(dvApi.duration(o), currentValue));
          if (currentValueString) {
            const nextValue = cycleManager.nextOption(currentValueString);
            return [currentValueString, cycle, nextValue];
          }
        }
        return [options2[0], cycle, options2[1] || options2[0]];
      } else if (interval && dvApi.duration(interval)) {
        return [interval, void 0, void 0];
      }
    }
    return [void 0, void 0, void 0];
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var import_obsidian28 = require("obsidian");

// src/modals/fields/MultiFileModal.ts
var import_obsidian27 = require("obsidian");
var MultiFileFuzzySuggester = class extends import_obsidian27.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.selectedFiles = [];
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const selectedValues = Array.isArray(initialValueObject) ? initialValueObject : [initialValueObject];
      selectedValues.forEach((value) => {
        if (dvApi.value.isLink(value)) {
          const file2 = this.plugin.app.vault.getAbstractFileByPath(value.path);
          if (file2 instanceof import_obsidian27.TFile)
            this.selectedFiles.push(file2);
        }
      });
    }
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    super.onOpen();
    this.containerEl.onkeydown = (e) => __async(this, null, function* () {
      if (e.key == "Enter" && e.altKey) {
        e.preventDefault();
        yield this.replaceValues();
        this.close();
      }
    });
    const buttonContainer = this.containerEl.createDiv({ cls: "footer-actions" });
    buttonContainer.createDiv({ cls: "spacer" });
    const infoContainer = buttonContainer.createDiv({ cls: "info" });
    infoContainer.setText("Alt+Enter to save");
    const confirmButton = new import_obsidian27.ButtonComponent(buttonContainer);
    confirmButton.setIcon("checkmark");
    confirmButton.onClick(() => __async(this, null, function* () {
      yield this.replaceValues();
      this.close();
    }));
    const cancelButton = new import_obsidian27.ButtonComponent(buttonContainer);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
    const clearButton = new import_obsidian27.ButtonComponent(buttonContainer);
    clearButton.setIcon("trash");
    clearButton.onClick(() => __async(this, null, function* () {
      yield this.clearValues();
      this.close();
    }));
    clearButton.buttonEl.addClass("danger");
    this.modalEl.appendChild(buttonContainer);
  }
  getItems() {
    const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
      return a.basename < b.basename ? -1 : 1;
    };
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file).sort(sortingMethod);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  replaceValues() {
    return __async(this, null, function* () {
      const result = this.selectedFiles.map((file) => {
        var _a;
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        let alias = void 0;
        if (dvApi && this.field.options.customRendering) {
          alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(file.path));
        }
        return FieldManager2.buildMarkDownLink(this.plugin, this.file, file.basename, void 0, alias);
      });
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: result.join(", ") } }], this.file, this.lineNumber, this.after, this.asList, this.asComment);
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], this.file);
    });
  }
  renderSuggestion(value, el) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "item-with-add-on" });
      suggestionContainer.createDiv({
        text: new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path))
      });
      const filePath = suggestionContainer.createDiv({ cls: "add-on" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("value-container");
    const spacer = this.containerEl.createDiv({ cls: "spacer" });
    el.appendChild(spacer);
    if (this.selectedFiles.some((file) => file.path === value.item.path)) {
      el.addClass("value-checked");
      const iconContainer = el.createDiv({ cls: "icon-container" });
      (0, import_obsidian27.setIcon)(iconContainer, "check-circle");
    }
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedFiles.some((file) => file.path === values[i].item.path)) {
        s.addClass("value-checked");
        if (s.querySelectorAll(".icon-container").length == 0) {
          const iconContainer = s.createDiv({ cls: "icon-container" });
          (0, import_obsidian27.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("value-checked");
        s.querySelectorAll(".icon-container").forEach((icon) => icon.remove());
      }
    });
  }
  selectSuggestion(value, evt) {
    if (this.selectedFiles.includes(value.item)) {
      this.selectedFiles.remove(value.item);
    } else {
      this.selectedFiles.push(value.item);
    }
    this.renderSelected();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
    });
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var MultiFileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "MultiFile" /* MultiFile */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian28.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  static buildMarkDownLink(plugin, file, path) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, void 0, destFile.basename);
    }
    return "";
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value);
    const action = () => modal.open();
    if (MultiFileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiFileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["File" /* File */]
      });
    } else if (MultiFileField.isFieldOptions(location)) {
      location.addOption(FieldIcon["File" /* File */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    const fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
    const searchBtn = fieldContainer.createEl("button");
    (0, import_obsidian28.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    const spacer = fieldContainer.createEl("div", { cls: "spacer" });
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian28.TFile && file.extension == "md") {
      fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
  }
  createFileContainer(container) {
    const dvQueryStringTopContainer = container.createDiv({ cls: "vstacked" });
    dvQueryStringTopContainer.createEl("span", { text: "Dataview Query (optional)", cls: "field-option" });
    const dvQueryStringContainer = dvQueryStringTopContainer.createDiv({ cls: "field-container" });
    this.dvQueryString = new import_obsidian28.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.inputEl.addClass("full-width");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingTopContainer = container.createDiv({ cls: "vstacked" });
    customeRenderingTopContainer.createEl("span", { text: "Alias" });
    customeRenderingTopContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "sub-text" });
    customeRenderingTopContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customeRenderingContainer = customeRenderingTopContainer.createDiv({ cls: "field-container" });
    const customRendering = new import_obsidian28.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.inputEl.addClass("full-width");
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
    const customSortingTopContainer = container.createDiv({ cls: "vstacked" });
    customSortingTopContainer.createEl("span", { text: "Sorting order" });
    customSortingTopContainer.createEl("span", { text: "Personalise the sorting order of your links with a instruction taking 2 files (a, b) and returning -1, 0 or 1", cls: "sub-text" });
    customSortingTopContainer.createEl("code", {
      text: `(a: TFile, b: TFile): number`
    });
    const customSortingContainer = customSortingTopContainer.createDiv({ cls: "field-container" });
    const customSorting = new import_obsidian28.TextAreaComponent(customSortingContainer);
    customSorting.inputEl.cols = 50;
    customSorting.inputEl.rows = 4;
    customSorting.inputEl.addClass("full-width");
    customSorting.setValue(this.field.options.customSorting || "");
    customSorting.setPlaceholder("Javascript instruction, (a: TFile, b: TFile): number\nexample 1 (alphabetical order): a.basename < b.basename ? 1 : -1 \nexample 2 (creation time newer to older): b.stat.ctime - b.stat.ctime");
    customSorting.onChange((value) => {
      this.field.options.customSorting = value;
      FieldSettingsModal.removeValidationError(customSorting);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.createFileContainer(parentContainer);
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    return true;
  }
  displayValue(container, file, fieldName, onClick) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvValue = dvApi.page(file.path)[fieldName];
      const values = Array.isArray(dvValue) ? dvValue : [dvValue];
      values.forEach((value, i) => {
        if (dvApi.value.isLink(value)) {
          const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
          link.onclick = () => {
            this.plugin.app.workspace.openLinkText(value.path, file.path, true);
            onClick();
          };
        } else {
          container.createDiv({ text: value });
        }
        if (i < values.length - 1) {
          container.createEl("span", { text: " | " });
        }
      });
    }
    container.createDiv();
  }
};

// src/fields/fieldManagers/LookupField.ts
var import_obsidian31 = require("obsidian");

// src/commands/updateLookups.ts
var import_obsidian30 = require("obsidian");

// src/commands/getValues.ts
var import_obsidian29 = require("obsidian");
function getValues(plugin, fileOrfilePath, attribute) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrfilePath instanceof import_obsidian29.TFile) {
      file = fileOrfilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
      if (_file instanceof import_obsidian29.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.read(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const result = [];
    content.map((line, i) => {
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`${attribute}:(.*)`, "u");
        const r = line.match(regex);
        if (r && r.length > 0)
          result.push(r[1]);
      } else {
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodeLink(line).match(fullLineRegex2);
        if (fR == null ? void 0 : fR.groups) {
          result.push(decodeLink(fR.groups.values));
        }
        ;
        const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
        const sRB = encodeLink(line).matchAll(inSentenceRegexBrackets2);
        let next = sRB.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRB.next();
        }
        const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
        const sRP = encodeLink(line).matchAll(inSentenceRegexPar2);
        next = sRP.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRP.next();
        }
      }
    });
    return result;
  });
}

// src/commands/updateLookups.ts
function arraysAsStringAreEqual(a, b) {
  const aAsArray = a.split(",").map((v) => v.trim());
  const bAsArray = b.split(",").map((v) => v.trim());
  return aAsArray.every((item) => bAsArray.includes(item)) && bAsArray.every((item) => aAsArray.includes(item));
}
function parseFieldValues(plugin, file, fieldName) {
  return __async(this, null, function* () {
    var _a;
    const rawValue = (_a = yield getValues(plugin, file, fieldName)) == null ? void 0 : _a[0];
    const regex = new RegExp(`<div hidden id="${fieldName}_values">(?<values>.*)</div>`);
    const fR = rawValue.match(regex);
    return (fR == null ? void 0 : fR.groups) && "values" in (fR == null ? void 0 : fR.groups) ? fR.groups.values : rawValue;
  });
}
function updateLookups(plugin, source = "", forceUpdateOne, forceUpdateAll = false) {
  return __async(this, null, function* () {
    var _a, _b, _c;
    const start2 = Date.now();
    const f = plugin.fieldIndex;
    let renderingErrors = [];
    const payloads = {};
    const updatedFields = [];
    for (let id of f.fileLookupFiles.keys()) {
      const matchRegex = new RegExp("(?<filePath>.*)__related__(?<fileClassName>.*)___(?<fieldName>.*)");
      const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
      const tFile = plugin.app.vault.getAbstractFileByPath(filePath);
      const dvApi = (_b = plugin.app.plugins.plugins.dataview) == null ? void 0 : _b.api;
      const dvFile = dvApi && dvApi.page(tFile.path);
      if (tFile && dvFile) {
        payloads[filePath] = payloads[filePath] || [];
        let newValue = "";
        const pages = f.fileLookupFiles.get(id);
        const field = (_c = f.filesFields.get(filePath)) == null ? void 0 : _c.find((field2) => field2.name == fieldName);
        if (field) {
          const outputType = field.options.outputType;
          if (!f.fileLookupFieldLastOutputType.get(id))
            f.fileLookupFieldLastOutputType.set(id, outputType);
          switch (outputType) {
            case "LinksList" /* LinksList */:
            case "LinksBulletList" /* LinksBulletList */:
              {
                const newValuesArray = pages == null ? void 0 : pages.map((dvFile2) => {
                  return FieldManager2.buildMarkDownLink(plugin, tFile, dvFile2.file.path);
                });
                newValue = (newValuesArray || []).join(", ");
              }
              break;
            case "CustomList" /* CustomList */:
            case "CustomBulletList" /* CustomBulletList */:
              {
                const renderingFunction = new Function("page", `return ${field.options.customListFunction}`);
                const newValuesArray = pages == null ? void 0 : pages.map((dvFile2) => {
                  try {
                    return renderingFunction(dvFile2);
                  } catch (e) {
                    if (!renderingErrors.includes(field.name))
                      renderingErrors.push(field.name);
                    return "";
                  }
                });
                newValue = (newValuesArray || []).join(", ");
              }
              break;
            case "CustomSummarizing" /* CustomSummarizing */:
              {
                const customSummarizingFunction = field.options.customSummarizingFunction;
                const summarizingFunction = new Function("pages", customSummarizingFunction.replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
                try {
                  newValue = summarizingFunction(pages).toString();
                } catch (e) {
                  if (!renderingErrors.includes(field.name))
                    renderingErrors.push(field.name);
                  newValue = "";
                }
              }
              break;
            case "BuiltinSummarizing" /* BuiltinSummarizing */:
              {
                const builtinFunction = field.options.builtinSummarizingFunction;
                const summarizingFunction = new Function("pages", BuiltinSummarizingFunction[builtinFunction].replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
                try {
                  newValue = summarizingFunction(pages).toString();
                } catch (e) {
                  if (!renderingErrors.includes(field.name))
                    renderingErrors.push(field.name);
                  newValue = "";
                }
              }
              break;
            default:
              break;
          }
          const currentValue = f.fileLookupFieldLastValue.get(id) || (yield parseFieldValues(plugin, tFile, field.name)) || "";
          const shouldCheckForUpdate = field.options.autoUpdate || field.options.autoUpdate === void 0 || forceUpdateAll || (forceUpdateOne == null ? void 0 : forceUpdateOne.file.path) === tFile.path && (forceUpdateOne == null ? void 0 : forceUpdateOne.fieldName) === field.name;
          const valueHasChanged = !currentValue && newValue !== "" || !arraysAsStringAreEqual(currentValue, newValue);
          const formatHasChanged = outputType !== f.fileLookupFieldLastOutputType.get(id);
          if (shouldCheckForUpdate) {
            f.fileLookupFieldLastValue.set(id, newValue);
            f.fileLookupFieldLastOutputType.set(id, outputType);
          }
          if (shouldCheckForUpdate && (valueHasChanged || formatHasChanged)) {
            const previousValuesCount = plugin.fieldIndex.previousFileLookupFilesValues.get(id) || 0;
            payloads[filePath].push({ name: fieldName, payload: { value: newValue, previousItemsCount: previousValuesCount } });
            updatedFields.push(`${filePath}__${fieldName}`);
          } else if (source !== "full Index") {
            plugin.fieldIndex.fileChanged = false;
          }
          if (!valueHasChanged && !formatHasChanged) {
            f.fileLookupFieldsStatus.set(`${filePath}__${fieldName}`, "upToDate" /* upToDate */);
          }
        }
      }
    }
    Object.entries(payloads).forEach((_0) => __async(this, [_0], function* ([filePath, payload]) {
      if (payload.length)
        yield postValues(plugin, payload, filePath);
    }));
    updatedFields.forEach((field) => f.fileLookupFieldsStatus.set(field, "upToDate" /* upToDate */));
    if (renderingErrors.length)
      new import_obsidian30.Notice(`Those fields have incorrect output rendering functions:
${renderingErrors.join(",\n")}`);
  });
}

// src/fields/fieldManagers/LookupField.ts
var LookupField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Lookup" /* Lookup */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    if (!this.field.options.autoUpdate && this.field.options.autoUpdate !== void 0) {
      const f = this.plugin.fieldIndex;
      const id = `${file.path}__${this.field.name}`;
      let status;
      status = f.fileLookupFieldsStatus.get(id) || "changed" /* changed */;
      if (f.fileLookupFieldLastOutputType.get(`${file.path}__related__${this.field.fileClassName}___${this.field.name}`) !== this.field.options.outputType)
        status = "changed" /* changed */;
      const icon = status === "changed" /* changed */ ? "refresh-ccw" : "file-check";
      const action = () => {
        updateLookups(this.plugin, "single_command", { file, fieldName: this.field.name });
      };
      if (LookupField.isMenu(location) && status === "changed" /* changed */) {
        location.addItem((item) => {
          item.setTitle(`Update <${name}>`);
          item.setIcon(icon);
          item.onClick(action);
          item.setSection("metadata-menu.fields");
        });
      } else if (LookupField.isSuggest(location) && status === "changed" /* changed */) {
        location.options.push({
          id: `update_${name}`,
          actionLabel: `<span>Update <b>${name}</b></span>`,
          action,
          icon
        });
      } else if (LookupField.isFieldOptions(location) && status === "changed" /* changed */) {
        location.addOption(icon, action, `Update ${name}'s value`);
      } else if (LookupField.isFieldOptions(location) && status === "upToDate" /* upToDate */) {
        location.addOption(icon, () => {
        }, `${name} is up to date`);
      }
    } else if (LookupField.isFieldOptions(location)) {
      location.addOption("server-cog", () => {
      }, `${name} is auto-updated`, "disabled");
    }
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], file, lineNumber, after, asList, asComment);
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a, _b;
    const file = p.file;
    const fieldName = this.field.name;
    const fileClassName = ((_b = (_a = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName)) == null ? void 0 : _b.fileClassName) || "presetField";
    const fieldValue = dv.el("span", this.plugin.fieldIndex.fileLookupFieldLastValue.get(`${file.path}__related__${fileClassName}___${fieldName}`), attrs);
    fieldContainer.appendChild(fieldValue);
  }
  displaySelectedOutputOptionContainer(optionContainers, value) {
    optionContainers.forEach((options_set) => {
      var _a, _b;
      if (options_set[0].includes(value)) {
        (_a = options_set[1]) == null ? void 0 : _a.show();
      } else {
        (_b = options_set[1]) == null ? void 0 : _b.hide();
      }
    });
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a, _b;
    const fileClassName = ((_b = (_a = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName)) == null ? void 0 : _b.fileClassName) || "presetField";
    container.createDiv({ text: this.plugin.fieldIndex.fileLookupFieldLastValue.get(`${file.path}__related__${fileClassName}___${fieldName}`) });
  }
  displaySelectedOutputWarningContainer(optionWarningContainer, value) {
    ["LinksBulletList" /* LinksBulletList */.toString(), "CustomBulletList" /* CustomBulletList */.toString()].includes(value) ? optionWarningContainer.show() : optionWarningContainer.hide();
  }
  createLookupContainer(container) {
    const autoUpdateTopContainer = container.createDiv({ cls: "vstacked" });
    const autoUpdateContainer = autoUpdateTopContainer.createDiv({ cls: "field-container" });
    autoUpdateContainer.createEl("span", { text: "Auto update this field ", cls: "label" });
    autoUpdateContainer.createDiv({ cls: "spacer" });
    const autoUpdate = new import_obsidian31.ToggleComponent(autoUpdateContainer);
    autoUpdateTopContainer.createEl("span", { text: "This could lead to latencies depending on the queries", cls: "sub-text warning" });
    if (this.field.options.autoUpdate === void 0)
      this.field.options.autoUpdate = false;
    autoUpdate.setValue(this.field.options.autoUpdate);
    autoUpdate.onChange((value) => {
      this.field.options.autoUpdate = value;
    });
    const dvQueryStringTopContainer = container.createDiv({ cls: "vstacked" });
    dvQueryStringTopContainer.createEl("span", { text: "Pages to look for in your vault (DataviewJS Query)", cls: "label" });
    dvQueryStringTopContainer.createEl("span", { text: "DataviewJS query of the form `dv.pages(...)`", cls: "sub-text" });
    const dvQueryStringContainer = dvQueryStringTopContainer.createDiv({ cls: "field-container" });
    const dvQueryString = new import_obsidian31.TextAreaComponent(dvQueryStringContainer);
    dvQueryString.inputEl.addClass("full-width");
    dvQueryString.inputEl.cols = 50;
    dvQueryString.inputEl.rows = 4;
    dvQueryString.setValue(this.field.options.dvQueryString || "");
    dvQueryString.setPlaceholder("exampe: dv.pages('#student')");
    dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(dvQueryString);
    });
    const targetFieldTopContainer = container.createDiv({ cls: "vstacked" });
    const targetFieldContainer = targetFieldTopContainer.createDiv({ cls: "field-container" });
    targetFieldContainer.createEl("span", { text: "Name of the related field", cls: "label" });
    const targetFieldName = new import_obsidian31.TextComponent(targetFieldContainer);
    targetFieldName.inputEl.addClass("full-width");
    targetFieldName.inputEl.addClass("with-label");
    targetFieldTopContainer.createEl("span", { text: "field in the target pages that contains a link to the page where this lookup field is", cls: "sub-text" });
    targetFieldName.setValue(this.field.options.targetFieldName || "");
    targetFieldName.onChange((value) => {
      this.field.options.targetFieldName = value;
      FieldSettingsModal.removeValidationError(targetFieldName);
    });
    const outputTypeContainer = container.createDiv({ cls: "field-container" });
    this.field.options.outputType = this.field.options.outputType || "LinksList" /* LinksList */;
    outputTypeContainer.createEl("span", { text: "Type of output", cls: "label" });
    outputTypeContainer.createDiv({ cls: "spacer" });
    const outputTypeList = new import_obsidian31.DropdownComponent(outputTypeContainer);
    Object.keys(Type).forEach((outputType) => {
      outputTypeList.addOption(outputType, Description[outputType]);
    });
    outputTypeList.setValue(this.field.options.outputType);
    const outputWarningContainer = container.createDiv();
    outputWarningContainer.createEl("p", {
      text: "Warning: this may override some lines under your list. There shouldn't be an extra manual item in the list that is automatically rendered by this field: it would be overriden after each field indexing",
      cls: "field-warning"
    });
    const builtinOptionsContainer = container.createDiv();
    const builtinSummarizeFunctionTopContainer = builtinOptionsContainer.createDiv({ cls: "vstacked" });
    const builtinSummarizeFunctionContainer = builtinSummarizeFunctionTopContainer.createDiv({ cls: "field-container" });
    this.field.options.builtinSummarizingFunction = this.field.options.builtinSummarizingFunction || Default.BuiltinSummarizing;
    builtinSummarizeFunctionContainer.createEl("span", { text: OptionLabel.BuiltinSummarizing, cls: "label" });
    builtinSummarizeFunctionContainer.createDiv({ cls: "spacer" });
    const builtinSummarizeFunctionList = new import_obsidian31.DropdownComponent(builtinSummarizeFunctionContainer);
    Object.keys(BuiltinSummarizing).forEach((builtinFunction2) => {
      builtinSummarizeFunctionList.addOption(builtinFunction2, BuiltinSummarizing[builtinFunction2]);
    });
    const builtinOptionsDescriptionContainer = builtinSummarizeFunctionTopContainer.createDiv({ cls: "sub-text" });
    const builtinFunction = this.field.options.builtinSummarizingFunction;
    builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[builtinFunction].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    builtinSummarizeFunctionList.setValue(this.field.options.builtinSummarizingFunction);
    builtinSummarizeFunctionList.onChange((value) => {
      this.field.options.builtinSummarizingFunction = value;
      builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[value].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    });
    const summarizedFieldNameTopContainer = builtinOptionsContainer.createDiv({ cls: "vstacked" });
    this.field.options.summarizedFieldName = this.field.options.summarizedFieldName;
    const summarizedFieldNameContainer = summarizedFieldNameTopContainer.createDiv({ cls: "field-container" });
    summarizedFieldNameContainer.createEl("span", { text: "Summarized field name", cls: "label" });
    const summarizedFieldName = new import_obsidian31.TextComponent(summarizedFieldNameContainer);
    summarizedFieldName.inputEl.addClass("full-width");
    summarizedFieldName.inputEl.addClass("with-label");
    summarizedFieldNameTopContainer.createEl("span", { text: "Name of the field containing summarized value used for the summarizing function", cls: "sub-text" });
    summarizedFieldName.setValue(this.field.options.summarizedFieldName);
    summarizedFieldName.onChange((value) => {
      this.field.options.summarizedFieldName = value;
    });
    const outputRenderingFunctionTopContainer = container.createDiv({ cls: "vstacked" });
    this.field.options.customListFunction = this.field.options.customListFunction || Default.CustomList;
    outputRenderingFunctionTopContainer.createEl("span", { text: OptionLabel.CustomList, cls: "label" });
    outputRenderingFunctionTopContainer.createEl("code", { text: OptionSubLabel.CustomList });
    const outputRenderingFunctionContainer = outputRenderingFunctionTopContainer.createDiv({ cls: "field-container" });
    const outputRenderingFunction = new import_obsidian31.TextAreaComponent(outputRenderingFunctionContainer);
    outputRenderingFunction.inputEl.addClass("full-width");
    outputRenderingFunction.setPlaceholder(Helper.CustomList);
    outputRenderingFunction.setValue(this.field.options.customListFunction);
    outputRenderingFunction.inputEl.cols = 65;
    outputRenderingFunction.inputEl.rows = 4;
    outputRenderingFunction.onChange((value) => {
      this.field.options.customListFunction = value;
    });
    const outputSummarizingFunctionTopContainer = container.createDiv({ cls: "vstacked" });
    this.field.options.customSummarizingFunction = this.field.options.customSummarizingFunction || Default.CustomSummarizing;
    outputSummarizingFunctionTopContainer.createEl("span", { text: OptionLabel.CustomSummarizing, cls: "label" });
    outputSummarizingFunctionTopContainer.createEl("code", { text: OptionSubLabel.CustomSummarizing });
    const outputSummarizingFunctionContainer = outputSummarizingFunctionTopContainer.createDiv({ cls: "field-container" });
    const outputSummarizingFunction = new import_obsidian31.TextAreaComponent(outputSummarizingFunctionContainer);
    outputSummarizingFunction.inputEl.addClass("full-width");
    outputSummarizingFunction.setPlaceholder(Helper.CustomSummarizing);
    outputSummarizingFunction.setValue(this.field.options.customSummarizingFunction);
    outputSummarizingFunction.inputEl.cols = 65;
    outputSummarizingFunction.inputEl.rows = 8;
    outputSummarizingFunction.onChange((value) => {
      this.field.options.customSummarizingFunction = value;
    });
    const optionContainers = [
      [["LinksList", "LinksBulletList"], void 0],
      [["BuiltinSummarizing"], builtinOptionsContainer],
      [["CustomList", "CustomBulletList"], outputRenderingFunctionTopContainer],
      [["CustomSummarizing"], outputSummarizingFunctionTopContainer]
    ];
    this.displaySelectedOutputOptionContainer(optionContainers, outputTypeList.getValue());
    this.displaySelectedOutputWarningContainer(outputWarningContainer, outputTypeList.getValue());
    outputTypeList.onChange((value) => {
      this.field.options.outputType = value;
      this.displaySelectedOutputOptionContainer(optionContainers, value);
      this.displaySelectedOutputWarningContainer(outputWarningContainer, value);
    });
  }
  createSettingContainer(container, plugin, location) {
    this.createLookupContainer(container);
  }
  getOptionsStr() {
    const shortDescription = ShortDescription[this.field.options.outputType];
    let complement = "";
    if (this.field.options.outputType === "BuiltinSummarizing" /* BuiltinSummarizing */) {
      complement = ` ${this.field.options.builtinSummarizingFunction}${this.field.options.builtinSummarizingFunction !== "CountAll" /* CountAll */ ? " " + this.field.options.summarizedFieldName : ""}`;
    }
    return shortDescription + complement;
  }
  validateOptions() {
    return true;
  }
};

// src/fields/fieldManagers/FormulaField.ts
var import_obsidian33 = require("obsidian");

// src/commands/updateFormulas.ts
var import_obsidian32 = require("obsidian");
function cleanRemovedFormulasFromIndex(plugin) {
  var _a, _b;
  const f = plugin.fieldIndex;
  for (let id of f.fileFormulaFieldLastValue.keys()) {
    const matchRegex = new RegExp("(?<filePath>.*)__calculated__(?<fileClassName>.*)___(?<fieldName>.*)");
    const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
    const existingFormulaFieldWithNameAndFileClassName = (_b = f.filesFields.get(filePath)) == null ? void 0 : _b.find((field) => field.name === fieldName && (field.fileClassName === void 0 && fileClassName === "presetField" || field.fileClassName === fileClassName));
    const dvPage = f.dv.api.page(filePath);
    if (dvPage === void 0 || dvPage[fieldName] === void 0 || !existingFormulaFieldWithNameAndFileClassName) {
      f.fileFormulaFieldLastValue.delete(id);
    }
  }
}
function updateFormulas(plugin, forceUpdateOne, forceUpdateAll = false) {
  return __async(this, null, function* () {
    const start2 = Date.now();
    const f = plugin.fieldIndex;
    let renderingErrors = [];
    const fileFormulasFields = /* @__PURE__ */ new Map();
    [...f.filesLookupAndFormulaFieldsExists].forEach(([filePath, fields]) => {
      fields.filter((field) => field.type === "Formula" /* Formula */).forEach((field) => {
        fileFormulasFields.set(`${filePath}__calculated__${field.fileClassName || "presetField"}___${field.name}`, field);
      });
    });
    [...fileFormulasFields].forEach((_0) => __async(this, [_0], function* ([id, field]) {
      var _a;
      const matchRegex = new RegExp("(?<filePath>.*)__calculated__(?<fileClassName>.*)___(?<fieldName>.*)");
      const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
      const shouldUpdate = forceUpdateAll || (forceUpdateOne == null ? void 0 : forceUpdateOne.file.path) === filePath && (forceUpdateOne == null ? void 0 : forceUpdateOne.fieldName) === fieldName || field.options.autoUpdate === true;
      const dvFile = f.dv.api.page(filePath);
      const currentdvValue = dvFile && dvFile[field.name];
      const currentValue = currentdvValue ? currentdvValue.toString() : "";
      f.fileFormulaFieldLastValue.set(id, currentValue);
      try {
        const newValue = new Function("current, dv", `return ${field.options.formula}`)(dvFile, f.dv.api).toString();
        const valueHasChanged = !currentValue && newValue !== "" || !arraysAsStringAreEqual(currentValue, newValue) || currentValue !== newValue;
        if (!valueHasChanged) {
          f.fileFormulaFieldsStatus.set(`${filePath}__${fieldName}`, "upToDate" /* upToDate */);
          return;
        } else {
          if (!shouldUpdate) {
            f.fileFormulaFieldsStatus.set(`${filePath}__${field.name}`, "changed" /* changed */);
          } else {
            yield postValues(plugin, [{ name: field.name, payload: { value: newValue } }], filePath);
            f.fileFormulaFieldLastValue.set(id, newValue);
            f.fileFormulaFieldsStatus.set(`${filePath}__${field.name}`, "upToDate" /* upToDate */);
          }
        }
      } catch (e) {
        if (renderingErrors.includes(field.name))
          renderingErrors.push(field.name);
      }
    }));
    if (renderingErrors.length)
      new import_obsidian32.Notice(`Those fields have incorrect output rendering functions:
${renderingErrors.join(",\n")}`);
    cleanRemovedFormulasFromIndex(plugin);
  });
}

// src/fields/fieldManagers/FormulaField.ts
var FormulaField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Formula" /* Formula */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    const f = this.plugin.fieldIndex;
    const id = `${file.path}__${this.field.name}`;
    let status;
    status = f.fileFormulaFieldsStatus.get(id) || "changed" /* changed */;
    const icon = status === "changed" /* changed */ ? "refresh-ccw" : "file-check";
    const action = () => {
      updateFormulas(this.plugin, { file, fieldName: this.field.name });
    };
    if (FormulaField.isMenu(location) && status === "changed" /* changed */) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(icon);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (FormulaField.isSuggest(location) && status === "changed" /* changed */) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon
      });
    } else if (FormulaField.isFieldOptions(location) && status === "changed" /* changed */) {
      location.addOption(icon, action, `Update ${name}'s value`);
    } else if (FormulaField.isFieldOptions(location) && status === "upToDate" /* upToDate */) {
      location.addOption(icon, () => {
      }, `${name} is up to date`);
    }
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], file, lineNumber, after, asList, asComment);
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a, _b;
    const fileClassName = ((_b = (_a = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName)) == null ? void 0 : _b.fileClassName) || "presetField";
    container.createDiv({ text: this.plugin.fieldIndex.fileFormulaFieldLastValue.get(`${file.path}__calculated__${fileClassName}___${fieldName}`) });
  }
  createFormulaContainer(container) {
    const autoUpdateTopContainer = container.createDiv({ cls: "vstacked" });
    const autoUpdateContainer = autoUpdateTopContainer.createDiv({ cls: "field-container" });
    autoUpdateContainer.createEl("span", { text: "Auto update this field ", cls: "label" });
    autoUpdateContainer.createDiv({ cls: "spacer" });
    const autoUpdate = new import_obsidian33.ToggleComponent(autoUpdateContainer);
    autoUpdateTopContainer.createEl("span", { text: "This could lead to latencies depending on the queries", cls: "sub-text warning" });
    if (this.field.options.autoUpdate === void 0)
      this.field.options.autoUpdate = false;
    autoUpdate.setValue(this.field.options.autoUpdate);
    autoUpdate.onChange((value) => {
      this.field.options.autoUpdate = value;
    });
    const formulaTopContainer = container.createDiv({ cls: "vstacked" });
    formulaTopContainer.createEl("span", { text: "javascript formula", cls: "label" });
    formulaTopContainer.createEl("span", { text: "current and pages variables are available`", cls: "sub-text" });
    const formulaContainer = formulaTopContainer.createDiv({ cls: "field-container" });
    const formula = new import_obsidian33.TextAreaComponent(formulaContainer);
    formula.inputEl.addClass("full-width");
    formula.inputEl.cols = 50;
    formula.inputEl.rows = 4;
    formula.setValue(this.field.options.formula || "");
    formula.setPlaceholder("exampe: current.apple + current.bananas - 3");
    formula.onChange((value) => {
      this.field.options.formula = value;
      FieldSettingsModal.removeValidationError(formula);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.createFormulaContainer(parentContainer);
  }
  getOptionsStr() {
    return this.field.options.formula;
  }
  validateOptions() {
    return true;
  }
};

// src/fields/fieldManagers/AbstractCanvasBasedField.ts
var import_obsidian34 = require("obsidian");
var AbstractListBasedField2 = class extends FieldManager2 {
  constructor(plugin, field, type) {
    super(plugin, field, type);
    this.standardColors = ["1", "2", "3", "4", "5", "6"];
    this.sides = [
      ["top", "chevron-up"],
      ["right", "chevron-right"],
      ["bottom", "chevron-down"],
      ["left", "chevron-left"]
    ];
    this.buildColorsContainer = (container, colorList, label) => {
      container.replaceChildren(...[]);
      container.createEl("span", { text: label, cls: "label" });
      container.createDiv({ cls: "spacer" });
      const toggleStandardColorButton = (container2, color) => {
        if (colorList.includes(color)) {
          container2.addClass("active");
          (0, import_obsidian34.setIcon)(container2, "cross");
        } else {
          container2.removeClass("active");
          (0, import_obsidian34.setIcon)(container2, "plus");
        }
        ;
      };
      this.standardColors.forEach((color) => {
        const colorContainer = container.createDiv({ cls: `node-color color-${color}` });
        toggleStandardColorButton(colorContainer, color);
        colorContainer.onmouseover = () => {
          colorContainer.setAttr("style", `color: white`);
        };
        colorContainer.onmouseout = () => {
          colorContainer.removeAttribute("style");
        };
        colorContainer.onclick = () => {
          const colors = colorList;
          if (colors.includes(color)) {
            colors.remove(color);
          } else {
            colors.push(color);
          }
          ;
          toggleStandardColorButton(colorContainer, color);
        };
      });
      const toggleAltColors = () => {
        const altGroupColors = colorList && colorList.filter((color) => !this.standardColors.includes(color)) || [];
        altGroupColors.forEach((color) => {
          const colorContainer = container.createDiv({ cls: `node-color` });
          colorContainer.setAttr("style", `background-color: ${color}; color: ${color}`);
          colorContainer.onmouseover = () => {
            colorContainer.setAttr("style", `background-color: ${color}; color: white`);
          };
          colorContainer.onmouseout = () => {
            colorContainer.setAttr("style", `background-color: ${color}; color: ${color}`);
          };
          (0, import_obsidian34.setIcon)(colorContainer, "cross");
          colorContainer.onclick = () => {
            colorList.remove(color);
            container.removeChild(colorContainer);
          };
        });
      };
      toggleAltColors();
      const altColorPickerContainer = container.createDiv({ cls: `node-color picker` });
      const altColorPicker = new import_obsidian34.ColorComponent(altColorPickerContainer);
      altColorPicker.onChange((value) => {
        colorList.push(value);
        this.buildColorsContainer(container, colorList, label);
      });
    };
    this.buildEdgeSideContainer = (container, edgeList, label) => {
      container.createDiv({ cls: "label", text: label });
      container.createDiv({ cls: "spacer" });
      this.sides.forEach(([side, iconName]) => {
        edgeList = edgeList || this.sides.map((side2) => side2[0]);
        const edgeSideContainer = container.createDiv({ cls: "edge-side" });
        const sideIconContainer = edgeSideContainer.createDiv({ cls: "side-icon" });
        (0, import_obsidian34.setIcon)(sideIconContainer, iconName);
        const sideTogglerContainer = new import_obsidian34.ToggleComponent(edgeSideContainer);
        sideTogglerContainer.setValue(edgeList.includes(side));
        sideTogglerContainer.onChange((value) => value ? edgeList.push(side) : edgeList.remove(side));
      });
    };
    this.buildLabelsContainer = (container, labels, title) => {
      container.replaceChildren(...[]);
      container.createDiv({ cls: "label", text: title });
      labels.forEach((label) => {
        const labelContainer = container.createDiv({ cls: "item chip", text: label });
        new import_obsidian34.ButtonComponent(labelContainer).setIcon("x-circle").setClass("item-remove").onClick(() => {
          labels.remove(label);
          container.removeChild(labelContainer);
        });
      });
    };
    this.buildNewLabelContainer = (currentLabelsContainer, currentLabelsTitle, newLabelContainer, labels, title) => {
      newLabelContainer.createDiv({ cls: "label", text: title });
      newLabelContainer.createDiv({ cls: "spacer" });
      const labelInput = new import_obsidian34.TextComponent(newLabelContainer);
      const labelValidate = new import_obsidian34.ButtonComponent(newLabelContainer);
      labelInput.onChange((value) => value ? labelValidate.setCta() : labelValidate.removeCta());
      labelValidate.setIcon("plus-circle");
      labelValidate.onClick(() => {
        labels.push(labelInput.getValue());
        this.buildLabelsContainer(currentLabelsContainer, labels, currentLabelsTitle);
        labelInput.setValue("");
        labelValidate.removeCta();
      });
    };
    this.createCanvasPathContainer = (container) => {
      container.createDiv({ text: `Path of the canvas`, cls: "label" });
      const canvasPathInput = new import_obsidian34.TextComponent(container);
      canvasPathInput.inputEl.addClass("full-width");
      canvasPathInput.inputEl.addClass("with-label");
      new FileSuggest(canvasPathInput.inputEl, this.plugin, "/", "canvas");
      const canvasPath = this.field.options.canvasPath;
      canvasPathInput.setValue(canvasPath || "");
      canvasPathInput.setPlaceholder("Path/of/the/file.canvas");
      canvasPathInput.onChange((value) => {
        FieldSettingsModal.removeValidationError(canvasPathInput);
        this.field.options.canvasPath = value;
      });
      this.canvasPathInput = canvasPathInput;
    };
    this.createDirectionContainer = (container, title) => {
      container.createDiv({ text: title, cls: "label" });
      container.createDiv({ cls: "spacer" });
      const directionSelection = new import_obsidian34.DropdownComponent(container);
      [
        ["incoming", "Incoming"],
        ["outgoing", "Outgoing"],
        ["bothsides", "Both sides"]
      ].forEach(([direction, label]) => directionSelection.addOption(direction, label));
      directionSelection.setValue(this.field.options.direction || "incoming");
      directionSelection.onChange((value) => this.field.options.direction = value);
    };
    this.createDvQueryContainer = (container, title) => {
      container.createEl("span", { text: title });
      container.createEl("span", { text: "Dataview query returning a list of files (<dv> object is available)", cls: "sub-text" });
      const filesFromDVQueryContainer = container.createDiv({ cls: "field-container" });
      const filesFromDVQuery = new import_obsidian34.TextAreaComponent(filesFromDVQueryContainer);
      filesFromDVQuery.inputEl.addClass("full-width");
      filesFromDVQuery.inputEl.cols = 65;
      filesFromDVQuery.inputEl.rows = 3;
      filesFromDVQuery.setPlaceholder("ex: dv.pages('#student')");
      filesFromDVQuery.setValue(this.field.options.filesFromDVQuery || "");
      filesFromDVQuery.onChange((value) => {
        this.field.options.filesFromDVQuery = value;
      });
    };
  }
};

// src/fields/fieldManagers/CanvasField.ts
var CanvasField = class extends AbstractListBasedField2 {
  constructor(plugin, field) {
    super(plugin, field, "Canvas" /* Canvas */);
  }
  displayValue(container, file, fieldName, onClick) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvValue = dvApi.page(file.path)[fieldName];
      const values = Array.isArray(dvValue) ? dvValue : [dvValue];
      values.forEach((value, i) => {
        if (dvApi.value.isLink(value)) {
          const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
          link.onclick = () => {
            this.plugin.app.workspace.openLinkText(value.path, file.path, true);
            onClick();
          };
        } else {
          container.createDiv({ text: value });
        }
        if (i < values.length - 1) {
          container.createEl("span", { text: " | " });
        }
      });
    }
    container.createDiv();
  }
  addFieldOption(name, value, file, location) {
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], file, lineNumber, after, asList, asComment);
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
  }
  createSettingContainer(container, plugin, location) {
    const options2 = this.field.options;
    options2.direction = options2.direction || "bothsides";
    options2.nodeColors = options2.nodeColors || [];
    options2.edgeColors = options2.edgeColors || [];
    options2.edgeFromSides = options2.edgeFromSides || [];
    options2.edgeToSides = options2.edgeToSides || [];
    options2.edgeLabels = options2.edgeLabels || [];
    const canvasPathContainer = container.createDiv({ cls: "field-container" });
    container.createEl("hr");
    const directionContainer = container.createDiv({ cls: "field-container" });
    const edgeColorsContainer = container.createDiv({ cls: "field-container colors" });
    const edgeFromSidesContainer = container.createDiv({ cls: "field-container edges" });
    container.createDiv({ cls: "sub-text", text: "No edge selected is equivalent to all edges selected" });
    const edgeToSidesContainer = container.createDiv({ cls: "field-container egdes" });
    container.createDiv({ cls: "sub-text", text: "No edge selected is equivalent to all edges selected" });
    const edgeLabelsContainer = container.createDiv({ cls: "field-container labels" });
    const newEdgeLabelContainer = container.createDiv({ cls: "field-container" });
    container.createEl("hr");
    const nodeColorsContainer = container.createDiv({ cls: "field-container colors" });
    const filesFromDVQueryTopContainer = container.createDiv({ cls: "vstacked" });
    this.createCanvasPathContainer(canvasPathContainer);
    this.createDirectionContainer(directionContainer, `Direction of the edges pointing to those nodes`);
    this.createDvQueryContainer(filesFromDVQueryTopContainer, "Matching files");
    this.buildColorsContainer(nodeColorsContainer, options2.nodeColors, "Node matching colors:");
    this.buildColorsContainer(edgeColorsContainer, options2.edgeColors, "Edge matching colors:");
    this.buildEdgeSideContainer(edgeFromSidesContainer, options2.edgeFromSides, "Edges matchin From side:");
    this.buildEdgeSideContainer(edgeToSidesContainer, options2.edgeToSides, "Edges matchin To side:");
    this.buildLabelsContainer(edgeLabelsContainer, options2.edgeLabels, "Edges matching labels: ");
    this.buildNewLabelContainer(edgeLabelsContainer, "Edges matching labels: ", newEdgeLabelContainer, options2.edgeLabels, "Add a new matching edge label");
  }
  getOptionsStr() {
    return "";
  }
  validateOptions() {
    var _a;
    let error = false;
    if (!((_a = this.field.options.canvasPath) == null ? void 0 : _a.endsWith(".canvas"))) {
      error = true;
      FieldSettingsModal.setValidationError(this.canvasPathInput, "This is not a canvas file");
    }
    return !error;
  }
};

// src/fields/fieldManagers/CanvasGroupField.ts
var CanvasGroupField = class extends AbstractListBasedField2 {
  constructor(plugin, field) {
    super(plugin, field, "CanvasGroup" /* CanvasGroup */);
  }
  addFieldOption(name, value, file, location) {
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], file, lineNumber, after, asList, asComment);
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
  }
  createSettingContainer(container, plugin, location) {
    const options2 = this.field.options;
    options2.groupColors = options2.groupColors || [];
    options2.groupLabels = options2.groupLabels || [];
    const canvasPathContainer = container.createDiv({ cls: "field-container" });
    container.createEl("hr");
    const groupColorsContainer = container.createDiv({ cls: "field-container colors" });
    const groupLabelsContainer = container.createDiv({ cls: "field-container labels" });
    const newLabelContainer = container.createDiv({ cls: "field-container" });
    this.createCanvasPathContainer(canvasPathContainer);
    this.buildColorsContainer(groupColorsContainer, options2.groupColors, "Groups matching colors:");
    this.buildLabelsContainer(groupLabelsContainer, options2.groupLabels, "Groups matching labels: ");
    this.buildNewLabelContainer(groupLabelsContainer, "Groups matching labels: ", newLabelContainer, options2.groupLabels, "Add a new matching group name");
  }
  getOptionsStr() {
    return "";
  }
  validateOptions() {
    var _a;
    let error = false;
    if (!((_a = this.field.options.canvasPath) == null ? void 0 : _a.endsWith(".canvas"))) {
      error = true;
      FieldSettingsModal.setValidationError(this.canvasPathInput, "This is not a canvas file");
    }
    return !error;
  }
};

// src/fields/fieldManagers/CanvasGroupLinkField.ts
var CanvasGroupLinkField = class extends AbstractListBasedField2 {
  constructor(plugin, field) {
    super(plugin, field, "CanvasGroupLink" /* CanvasGroupLink */);
  }
  addFieldOption(name, value, file, location) {
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, after, asList, asComment) {
    return __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: this.field.name, payload: { value: "" } }], file, lineNumber, after, asList, asComment);
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
  }
  createSettingContainer(container, plugin, location) {
    const options2 = this.field.options;
    options2.groupColors = options2.groupColors || [];
    options2.nodeColors = options2.nodeColors || [];
    options2.edgeColors = options2.edgeColors || [];
    options2.edgeFromSides = options2.edgeFromSides || [];
    options2.edgeToSides = options2.edgeToSides || [];
    options2.groupLabels = options2.groupLabels || [];
    options2.edgeLabels = options2.edgeLabels || [];
    options2.direction = options2.direction || "bothsides";
    const canvasPathContainer = container.createDiv({ cls: "field-container" });
    const groupColorsContainer = container.createDiv({ cls: "field-container colors" });
    const groupLabelsContainer = container.createDiv({ cls: "field-container labels" });
    const newGroupLabelContainer = container.createDiv({ cls: "field-container" });
    container.createEl("hr");
    const directionContainer = container.createDiv({ cls: "field-container" });
    const edgeColorsContainer = container.createDiv({ cls: "field-container colors" });
    const edgeFromSidesContainer = container.createDiv({ cls: "field-container edges" });
    container.createDiv({ cls: "sub-text", text: "No edge selected is equivalent to all edges selected" });
    const edgeToSidesContainer = container.createDiv({ cls: "field-container egdes" });
    container.createDiv({ cls: "sub-text", text: "No edge selected is equivalent to all edges selected" });
    const edgeLabelsContainer = container.createDiv({ cls: "field-container labels" });
    const newEdgeLabelContainer = container.createDiv({ cls: "field-container" });
    container.createEl("hr");
    const nodeColorsContainer = container.createDiv({ cls: "field-container colors" });
    const filesFromDVQueryTopContainer = container.createDiv({ cls: "vstacked" });
    const groupLabelsTitle = "Groups matching labels: ";
    const edgeLabelsTitle = "Edges matching labels: ";
    this.createCanvasPathContainer(canvasPathContainer);
    this.createDirectionContainer(directionContainer, `Direction of the edges pointing to those groups`);
    this.createDvQueryContainer(filesFromDVQueryTopContainer, "Matching files connected to those groups");
    this.buildColorsContainer(groupColorsContainer, options2.groupColors, "Groups matching colors:");
    this.buildColorsContainer(nodeColorsContainer, options2.nodeColors, "Groups' connected nodes matching colors:");
    this.buildColorsContainer(edgeColorsContainer, options2.edgeColors, "Groups' edges matching colors:");
    this.buildLabelsContainer(groupLabelsContainer, options2.groupLabels, groupLabelsTitle);
    this.buildLabelsContainer(edgeLabelsContainer, options2.edgeLabels, edgeLabelsTitle);
    this.buildEdgeSideContainer(edgeFromSidesContainer, options2.edgeFromSides, "Groups' edges matchin From side:");
    this.buildEdgeSideContainer(edgeToSidesContainer, options2.edgeToSides, "Groups' edges matchin To side:");
    this.buildNewLabelContainer(groupLabelsContainer, groupLabelsTitle, newGroupLabelContainer, options2.groupLabels, "Add a new matching group name");
    this.buildNewLabelContainer(edgeLabelsContainer, edgeLabelsTitle, newEdgeLabelContainer, options2.edgeLabels, "Add a new matching edge label");
  }
  getOptionsStr() {
    return "";
  }
  validateOptions() {
    var _a;
    let error = false;
    if (!((_a = this.field.options.canvasPath) == null ? void 0 : _a.endsWith(".canvas"))) {
      error = true;
      FieldSettingsModal.setValidationError(this.canvasPathInput, "This is not a canvas file");
    }
    return !error;
  }
};

// src/fields/fieldManagers/Managers.ts
var Managers = {
  Input: InputField,
  Boolean: BooleanField,
  Number: NumberField,
  Select: SelectField,
  Cycle: CycleField,
  Multi: MultiField,
  File: FileField,
  Date: DateField,
  MultiFile: MultiFileField,
  Lookup: LookupField,
  Formula: FormulaField,
  Canvas: CanvasField,
  CanvasGroup: CanvasGroupField,
  CanvasGroupLink: CanvasGroupLinkField
};
var Managers_default = Managers;

// src/types/fieldTypes.ts
var FieldTypeLabelMapping = {
  "Input": "Input" /* Input */,
  "Select": "Select" /* Select */,
  "Multi": "Multi" /* Multi */,
  "Cycle": "Cycle" /* Cycle */,
  "Boolean": "Boolean" /* Boolean */,
  "Number": "Number" /* Number */,
  "File": "File" /* File */,
  "MultiFile": "MultiFile" /* MultiFile */,
  "Date": "Date" /* Date */,
  "Lookup": "Lookup" /* Lookup */,
  "Formula": "Formula" /* Formula */,
  "Canvas": "Canvas" /* Canvas */,
  "CanvasGroup": "CanvasGroup" /* CanvasGroup */,
  "CanvasGroupLink": "CanvasGroupLink" /* CanvasGroupLink */
};
var FieldTypeTagClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file",
  "MultiFile": "file",
  "Date": "date",
  "Lookup": "lookup",
  "Formula": "formula",
  "Canvas": "canvas-links",
  "CanvasGroup": "canvas-links",
  "CanvasGroupLink": "canvas-links"
};
var FieldTypeTooltip = {
  "Input": "Accept any value",
  "Select": "Accept a single value from a list",
  "Multi": "Accept multiple values from a list",
  "Cycle": "Cycle through values from a list",
  "Boolean": "Accept true of false",
  "Number": "Accept a number",
  "File": "Accept a link",
  "MultiFile": "Accept multiple links",
  "Date": "Accept a date",
  "Lookup": "Accept a lookup query",
  "Formula": "Accept a formula",
  "Canvas": "Updates with links in canvas",
  "CanvasGroup": "Updates with groups in canvas",
  "CanvasGroupLink": "Updates with links to groups in canvas"
};
var FieldManager = {
  "Input": Managers_default.Input,
  "Select": Managers_default.Select,
  "Multi": Managers_default.Multi,
  "Cycle": Managers_default.Cycle,
  "Boolean": Managers_default.Boolean,
  "Number": Managers_default.Number,
  "File": Managers_default.File,
  "MultiFile": Managers_default.MultiFile,
  "Date": Managers_default.Date,
  "Lookup": Managers_default.Lookup,
  "Formula": Managers_default.Formula,
  "Canvas": Managers_default.Canvas,
  "CanvasGroup": Managers_default.CanvasGroup,
  "CanvasGroupLink": Managers_default.CanvasGroupLink
};
var FieldIcon = {
  "Input": "pencil",
  "Select": "right-triangle",
  "Multi": "bullet-list",
  "Cycle": "switch",
  "Boolean": "checkmark",
  "Number": "plus-minus-glyph",
  "File": "link",
  "MultiFile": "link",
  "Date": "calendar-with-checkmark",
  "Lookup": "file-search",
  "Formula": "function-square",
  "Canvas": "layout-dashboard",
  "CanvasGroup": "box-select",
  "CanvasGroupLink": "box-select"
};
var FieldBackgroundColorClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file",
  "MultiFile": "file",
  "Date": "date",
  "Lookup": "lookup",
  "Formula": "lookup",
  "Canvas": "file",
  "CanvasGroup": "file",
  "CanvasGroupLink": "file"
};
var multiTypes = [
  "Multi" /* Multi */,
  "MultiFile" /* MultiFile */,
  "Canvas" /* Canvas */,
  "CanvasGroup" /* CanvasGroup */,
  "CanvasGroupLink" /* CanvasGroupLink */
];
var ReservedMultiAttributes = ["tags", "tagNames", "excludes", "aliases"];

// src/fileClass/FileClassAttributeModal.ts
var FileClassAttributeModal = class extends import_obsidian35.Modal {
  constructor(plugin, fileClass, attr) {
    super(plugin.app);
    this.plugin = plugin;
    this.fileClass = fileClass;
    this.attr = attr;
    this.initialField = new Field_default();
    if (this.attr) {
      this.field = attr.getField();
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      this.field = new Field_default();
    }
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.addCommand = this.field.command !== void 0;
    this.command = this.field.command || {
      id: this.field ? `insert__${this.field.fileClassName || "presetField"}__${this.field.name}` : "",
      icon: "list-plus",
      label: this.field ? `Insert ${this.field.name} field` : "",
      hotkey: void 0
    };
  }
  onOpen() {
    this.containerEl.addClass("metadata-menu");
    this.titleEl.setText(this.attr ? `Manage ${this.attr.name}` : `Create a new attribute for ${this.fileClass.name}`);
    this.buildNameInputContainer();
    this.buildHeader();
    this.contentEl.createEl("hr");
    this.buildCommandContainer();
    this.createFrontmatterListDisplayContainer();
    const typeSelectContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.contentEl.createEl("hr");
    this.fieldOptionsContainer = this.contentEl.createDiv();
    const footer = this.contentEl.createDiv({ cls: "footer-actions" });
    footer.createDiv({ cls: "spacer" });
    this.createSaveBtn(footer);
    if (this.attr)
      this.createRemovelBtn(footer);
    this.createCancelBtn(footer);
    this.buildTypeSelectContainer(typeSelectContainer);
    this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
  }
  buildNameInputContainer() {
    const container = this.contentEl.createDiv({ cls: "field-container" });
    container.createDiv({ cls: "label", text: "Field Name: " });
    const input = new import_obsidian35.TextComponent(container);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    this.attr ? input.setValue(this.field.name) : input.setPlaceholder("Name of the field");
    input.inputEl.focus();
    input.onChange((value) => {
      this.field.name = value;
      this.command.id = `insert__${this.field.fileClassName || "presetField"}__${value}`;
      this.command.label = `Insert ${value} field`;
      this.attrName.setText(`<${value}>`);
      FieldSettingsModal.removeValidationError(input);
    });
    this.nameInput = input;
  }
  createFrontmatterListDisplayContainer() {
    this.frontmatterListDisplayContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.frontmatterListDisplayContainer.createDiv({ text: "Frontmatter list display type", cls: "label" });
    this.frontmatterListDisplayContainer.createDiv({ cls: "spacer" });
    const frontmatterListDisplay = new import_obsidian35.DropdownComponent(this.frontmatterListDisplayContainer);
    const options2 = {};
    options2["asArray"] = "display as array";
    options2["asList"] = "display as indented list";
    options2["undefined"] = `Plugin Default (${this.plugin.settings.frontmatterListDisplay})`;
    frontmatterListDisplay.addOptions(options2);
    switch (this.field.display) {
      case "asArray" /* asArray */:
        frontmatterListDisplay.setValue("asArray");
        break;
      case "asList" /* asList */:
        frontmatterListDisplay.setValue("asList");
        break;
      case void 0:
        frontmatterListDisplay.setValue("undefined");
        break;
    }
    frontmatterListDisplay.onChange((value) => {
      switch (value) {
        case "asArray":
          this.frontmatterListDisplay = "asArray" /* asArray */;
          break;
        case "asList":
          this.frontmatterListDisplay = "asList" /* asList */;
          break;
        case "undefined":
          this.frontmatterListDisplay = void 0;
          break;
        default:
          this.frontmatterListDisplay = void 0;
      }
    });
  }
  buildCommandContainer() {
    const commandContainer = this.contentEl.createDiv({ cls: "field-container" });
    commandContainer.createDiv({ text: "set a command for this field?", cls: "label" });
    commandContainer.createDiv({ cls: "spacer" });
    const addCommandToggler = new import_obsidian35.ToggleComponent(commandContainer);
    addCommandToggler.setValue(this.addCommand);
    const iconContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.addCommand ? iconContainer.show() : iconContainer.hide();
    iconContainer.createDiv({ text: "Icon name", cls: "label" });
    this.iconName = new import_obsidian35.TextComponent(iconContainer);
    this.iconName.inputEl.addClass("full-width");
    this.iconName.inputEl.addClass("with-label");
    const iconPreview = iconContainer.createDiv({ cls: "icon-preview" });
    this.iconName.setValue(this.command.icon);
    (0, import_obsidian35.setIcon)(iconPreview, this.command.icon);
    this.iconName.onChange((value) => {
      this.command.icon = value;
      (0, import_obsidian35.setIcon)(iconPreview, value);
    });
    addCommandToggler.onChange((value) => {
      this.addCommand = value;
      this.addCommand ? iconContainer.show() : iconContainer.hide();
    });
  }
  buildHeader() {
    const container = this.contentEl.createDiv({ cls: "field-container" });
    const typeSelectHeader = container.createDiv();
    const attrLine = typeSelectHeader.createEl("div");
    this.attrName = attrLine.createEl("strong");
    this.attrName.setText(`<${this.field.name}>`);
    attrLine.append(` available in files with ${this.plugin.settings.fileClassAlias} = ${this.fileClass.name}`);
  }
  buildTypeSelectContainer(container) {
    const typeSelectorContainerLabel = container.createDiv({ cls: "label" });
    typeSelectorContainerLabel.setText(`Field type:`);
    container.createDiv({ cls: "spacer" });
    const typeSelect = new import_obsidian35.DropdownComponent(container);
    Object.keys(FieldTypeTooltip).forEach((key) => typeSelect.addOption(key, FieldTypeTooltip[key]));
    if (this.field.type) {
      typeSelect.setValue(this.field.type);
      if (["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(this.field.type)) {
        this.frontmatterListDisplayContainer.show();
      } else {
        this.frontmatterListDisplayContainer.hide();
      }
    }
    typeSelect.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.nameInput.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      if (["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(this.field.type)) {
        this.frontmatterListDisplayContainer.show();
      } else {
        this.frontmatterListDisplayContainer.hide();
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.nameInput, this.contentEl) && this.fieldManager.validateOptions();
  }
  createSaveBtn(container) {
    const saveButton = new import_obsidian35.ButtonComponent(container);
    saveButton.setTooltip("Save");
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      let error = !this.validateFields();
      if (error) {
        new import_obsidian35.Notice("Fix errors before saving.");
        return;
      }
      ;
      if (this.addCommand) {
        this.field.command = this.command;
      } else {
        delete this.field.command;
      }
      if (this.frontmatterListDisplay) {
        this.field.display = this.frontmatterListDisplay;
      } else {
        delete this.field.display;
      }
      yield this.fileClass.updateAttribute(this.field.type, this.field.name, this.field.options, this.attr, this.field.command, this.field.display);
      this.close();
    }));
  }
  createRemovelBtn(container) {
    const removeButton = new import_obsidian35.ButtonComponent(container);
    removeButton.setIcon("trash");
    removeButton.onClick(() => {
      var _a;
      const confirmModal = new import_obsidian35.Modal(this.plugin.app);
      confirmModal.containerEl.addClass("metadata-menu");
      confirmModal.titleEl.setText("Please confirm");
      confirmModal.contentEl.createDiv().setText(`Do you really want to remove ${(_a = this.attr) == null ? void 0 : _a.name} attribute from ${this.fileClass.name}?`);
      const confirmFooter = confirmModal.contentEl.createDiv({ cls: "footer-actions" });
      confirmFooter.createDiv({ cls: "spacer" });
      const confirmButton = new import_obsidian35.ButtonComponent(confirmFooter);
      confirmButton.setWarning();
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => {
        if (this.attr)
          this.fileClass.removeAttribute(this.attr);
        confirmModal.close();
        this.close();
      });
      const dismissButton = new import_obsidian35.ButtonComponent(confirmFooter);
      dismissButton.setIcon("cross");
      dismissButton.onClick(() => this.close());
      confirmModal.open();
    });
  }
  createCancelBtn(container) {
    const cancelButton = new import_obsidian35.ButtonComponent(container);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => this.close());
  }
};

// src/modals/chooseSectionModal.ts
var import_obsidian36 = require("obsidian");
var chooseSectionModal = class extends import_obsidian36.SuggestModal {
  constructor(plugin, file, onSelect) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.onSelect = onSelect;
    this.addAsListItem = false;
    this.addAsComment = false;
    this.addAtEndOfFrontMatter = false;
    this.onSelect = onSelect;
    this.containerEl.addClass("metadata-menu");
    this.resultContainerEl.addClass("sections");
  }
  onOpen() {
    super.onOpen();
    const inputContainer = this.containerEl.createDiv({ cls: "suggester-input" });
    inputContainer.appendChild(this.inputEl);
    this.containerEl.find(".prompt").prepend(inputContainer);
    const addAsListItemBtn = new import_obsidian36.ButtonComponent(inputContainer);
    addAsListItemBtn.setIcon("list");
    addAsListItemBtn.onClick(() => {
      if (this.addAsListItem) {
        addAsListItemBtn.removeCta();
        this.addAsListItem = false;
      } else {
        addAsListItemBtn.setCta();
        this.addAsListItem = true;
      }
    });
    addAsListItemBtn.setDisabled(this.addAtEndOfFrontMatter);
    addAsListItemBtn.setTooltip("Add this field as a list item");
    const addAsCommentItemBtn = new import_obsidian36.ButtonComponent(inputContainer);
    addAsCommentItemBtn.setIcon("message-square");
    addAsCommentItemBtn.onClick(() => {
      if (this.addAsComment) {
        addAsCommentItemBtn.removeCta();
        this.addAsComment = false;
      } else {
        addAsCommentItemBtn.setCta();
        this.addAsComment = true;
      }
    });
    addAsCommentItemBtn.setDisabled(this.addAtEndOfFrontMatter);
    addAsCommentItemBtn.setTooltip("Add this field as a comment item");
    const addAtEndOfFrontMatterBtn = new import_obsidian36.ButtonComponent(inputContainer);
    addAtEndOfFrontMatterBtn.setIcon("list-end");
    addAtEndOfFrontMatterBtn.onClick(() => {
      this.onSelect(-1, false, false, false);
      this.close();
    });
    addAtEndOfFrontMatterBtn.setTooltip("Add this field at the end of the frontmatter");
  }
  getSuggestions(query) {
    return __async(this, null, function* () {
      const content = yield this.plugin.app.vault.read(this.file);
      const suggestions = [{
        lineNumber: -1,
        lineText: "----------Add on top of the file--------"
      }];
      content.split("\n").forEach((lineContent, i) => {
        if (lineContent.toLowerCase().includes(query.toLowerCase())) {
          suggestions.push({
            lineNumber: i,
            lineText: lineContent.substring(0, 57) + (lineContent.length < 57 ? "" : "...")
          });
        }
      });
      return suggestions;
    });
  }
  renderSuggestion(value, el) {
    el.addClass("item");
    const container = el.createDiv({ cls: "line" });
    container.createDiv({ text: `${value.lineNumber + 1}`, cls: "lineNumber" });
    container.createDiv({ text: value.lineText, cls: "lineText" });
  }
  onChooseSuggestion(item, evt) {
    const after = item.lineNumber == -1 ? false : true;
    this.onSelect(item.lineNumber == -1 ? 0 : item.lineNumber, after, this.addAsListItem, this.addAsComment);
  }
};

// src/commands/insertMissingFields.ts
function insertMissingFields(plugin, fileOrFilePath, lineNumber, after = false, asList = false, asComment = false, fileClassName) {
  return __async(this, null, function* () {
    var _a, _b;
    const file = getFileFromFileOrPath(plugin, fileOrFilePath);
    const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const f = plugin.fieldIndex;
      const tm = plugin.fileTaskManager;
      const fields = f.filesFields.get(file.path);
      const currentFieldsNames = genuineKeys(dvApi.page(file.path));
      const filteredClassFields = fileClassName ? ((_b = plugin.fieldIndex.fileClassesFields.get(fileClassName)) == null ? void 0 : _b.filter((field) => field.fileClassName === fileClassName)) || void 0 : void 0;
      const fieldsToInsert = [];
      fields == null ? void 0 : fields.filter((field) => !currentFieldsNames.includes(field.name)).filter((field) => filteredClassFields ? filteredClassFields.map((f2) => f2.name).includes(field.name) : true).forEach((field) => __async(this, null, function* () {
        fieldsToInsert.push({ name: field.name, payload: { value: "" } });
      }));
      if (fieldsToInsert.length)
        yield postValues(plugin, fieldsToInsert, file, lineNumber, after, asList, asComment);
    }
  });
}

// src/components/fileClassManager.ts
var import_obsidian43 = require("obsidian");

// src/fileClass/fileClassView.ts
var import_obsidian41 = require("obsidian");

// src/fileClass/fileClassFieldsView.ts
var import_obsidian38 = require("obsidian");

// src/commands/removeFileClassAttribute.ts
function removeFileClassAttributeWithName(plugin, fileClass, name) {
  return __async(this, null, function* () {
    const file = fileClass.getClassFile();
    if (file) {
      const content = (yield plugin.app.vault.read(file)).split("\n");
      const newContent = content.map((line, i) => {
        if (!line.startsWith(name))
          return line;
      });
      yield plugin.app.vault.modify(file, newContent.join("\n"));
    }
  });
}

// src/fileClass/fileClassAttribute.ts
var FileClassAttribute = class {
  constructor(origin, name, type = "Input" /* Input */, options2 = [], fileClassName, command, display) {
    this.origin = origin;
    this.name = name;
    this.type = type;
    this.options = options2;
    this.fileClassName = fileClassName;
    this.command = command;
    this.display = display;
  }
  getField() {
    var _a;
    let options2 = {};
    if (Array.isArray(this.options)) {
      (_a = this.options) == null ? void 0 : _a.forEach((option, index) => {
        options2[index] = option;
      });
    } else {
      options2 = this.options;
    }
    return new Field_default(this.name, options2, this.name, this.type, this.fileClassName, this.command, this.display);
  }
  getOptionsString(plugin) {
    const field = this.getField();
    const manager = new FieldManager[field.type](plugin, field);
    return manager.getOptionsStr();
  }
};

// src/fileClass/fileClass.ts
var import_obsidian37 = require("obsidian");

// src/utils/textUtils.ts
var capitalize = (s) => {
  return s && s[0].toUpperCase() + s.slice(1);
};

// src/fileClass/fileClass.ts
var options = {
  "limit": { name: "limit", toValue: (value) => `${value || ""}` },
  "mapWithTag": { name: "mapWithTag", toValue: (value) => value.toString() },
  "icon": { name: "icon", toValue: (value) => `${value || ""}` },
  "tagNames": { name: "tagNames", toValue: (values) => values.join(", ") },
  "excludes": { name: "excludes", toValue: (values) => values.map((attr) => attr.name).join(", ") },
  "parent": { name: "extends", toValue: (value) => `${(value == null ? void 0 : value.name) || ""}` }
};
var FileClassOptions = class {
  constructor(limit, icon, parent, excludes, tagNames, mapWithTag = false) {
    this.limit = limit;
    this.icon = icon;
    this.parent = parent;
    this.excludes = excludes;
    this.tagNames = tagNames;
    this.mapWithTag = mapWithTag;
  }
};
var AddFileClassToFileModal = class extends import_obsidian37.SuggestModal {
  constructor(plugin, file) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
  }
  getSuggestions(query) {
    return [...this.plugin.fieldIndex.fileClassesName.keys()].filter((fileClassName) => {
      var _a;
      return !((_a = this.plugin.fieldIndex.filesFileClasses.get(this.file.path)) == null ? void 0 : _a.map((fileClass) => fileClass.name).includes(fileClassName));
    }).filter((fileClassName) => fileClassName.toLocaleLowerCase().contains(query.toLowerCase())).sort();
  }
  renderSuggestion(value, el) {
    el.setText(value);
  }
  onChooseSuggestion(item, evt) {
    this.insertFileClassToFile(item);
  }
  insertFileClassToFile(value) {
    return __async(this, null, function* () {
      const fileClassAlias = this.plugin.settings.fileClassAlias;
      const currentFileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path);
      const newValue = currentFileClasses ? [...currentFileClasses.map((fc) => fc.name), value].join(", ") : value;
      yield postValues(this.plugin, [{ name: fileClassAlias, payload: { value: newValue } }], this.file);
    });
  }
};
var FileClassObjects = class {
  constructor(instance) {
    this.instance = instance;
  }
  all() {
    const filesWithFileClassName = this.instance.plugin.app.vault.getMarkdownFiles().filter((file) => {
      const cache = this.instance.plugin.app.metadataCache.getFileCache(file);
      const fileClassAlias = this.instance.plugin.settings.fileClassAlias;
      return (cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).includes(fileClassAlias) && cache.frontmatter[fileClassAlias] == this.instance.name;
    });
    return filesWithFileClassName;
  }
  get(name) {
    const filesWithName = this.all().filter((file) => file.path.replace(/md$/, "").endsWith(name));
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
  getPath(path) {
    const filesWithName = this.all().filter((file) => file.path == path);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
};
var FileClass = class {
  constructor(plugin, name) {
    this.plugin = plugin;
    this.name = name;
    this.objects = new FileClassObjects(this);
    this.attributes = [];
  }
  getFileClassOptions() {
    var _a, _b;
    const {
      extends: _parent,
      limit: _limit,
      excludes: _excludes,
      mapWithTag: _mapWithTag,
      tagNames: _tagNames,
      icon: _icon
    } = ((_a = this.plugin.app.metadataCache.getFileCache(this.getClassFile())) == null ? void 0 : _a.frontmatter) || {};
    const index = this.plugin.fieldIndex;
    const parent = this.plugin.fieldIndex.fileClassesName.get(_parent);
    const excludedNames = FileClass.getExcludedFieldsFromFrontmatter(_excludes);
    const excludes = [];
    (_b = index.fileClassesAncestors.get(this.getClassFile().basename)) == null ? void 0 : _b.forEach((ancestorName) => {
      var _a2;
      (_a2 = index.fileClassesName.get(ancestorName)) == null ? void 0 : _a2.attributes.forEach((attr) => {
        if (excludedNames.includes(attr.name) && !excludes.map((attr2) => attr2.name).includes(attr.name))
          excludes.push(attr);
      });
    });
    const limit = typeof _limit === "number" ? _limit : this.plugin.settings.tableViewMaxRecords;
    const mapWithTag = FieldManager2.stringToBoolean(_mapWithTag);
    const tagNames = FileClass.getTagNamesFromFrontMatter(_tagNames);
    const icon = typeof _icon === "string" ? _icon : this.plugin.settings.buttonIcon;
    return new FileClassOptions(limit, icon, parent, excludes, tagNames, mapWithTag);
  }
  isMappedWithTag() {
    var _a, _b;
    try {
      const fileClassFile = this.getClassFile();
      const mapWithTag = (_b = (_a = this.plugin.app.metadataCache.getFileCache(fileClassFile)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.mapWithTag;
      return !!mapWithTag;
    } catch (error) {
      return false;
    }
  }
  getClassFile() {
    const filesClassPath = this.plugin.settings.classFilesPath;
    const file = this.plugin.app.vault.getAbstractFileByPath(`${filesClassPath}${this.name}.md`);
    if (file instanceof import_obsidian37.TFile && file.extension == "md") {
      return file;
    } else {
      const error = new Error(`no file named <${this.name}.md> in <${filesClassPath}> folder to match <${this.plugin.settings.fileClassAlias}: ${this.name}> in one of these notes`);
      throw error;
    }
  }
  getIcon() {
    const parents = [this.name, ...this.plugin.fieldIndex.fileClassesAncestors.get(this.name) || []];
    let icon;
    parents.some((fileClassName, i) => {
      var _a, _b;
      const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
      if (fileClass) {
        const file = fileClass.getClassFile();
        const _icon = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.icon;
        if (_icon) {
          icon = _icon;
          return true;
        }
        ;
      }
    });
    return icon;
  }
  static getFileClassAttributes(plugin, fileClass, excludes) {
    var _a;
    const file = fileClass.getClassFile();
    let attributes = [];
    const dvApi = (_a = plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(file.path);
      try {
        genuineKeys(dvFile).forEach((key) => {
          if (key !== "file" && !Object.keys(dvFile.file.frontmatter || {}).includes(key)) {
            const item = typeof dvFile[key] !== "string" ? JSON.stringify(dvFile[key]) : dvFile[key];
            try {
              const { type, options: options2, command, display } = JSON.parse(item);
              const fieldType = FieldTypeLabelMapping[capitalize(type)];
              const attr = new FileClassAttribute(this.name, key, fieldType, options2, fileClass.name, command, display);
              attributes.push(attr);
            } catch (e) {
            }
          }
        });
      } catch (error) {
        throw error;
      }
    }
    if (excludes) {
      return attributes.filter((attr) => !excludes.includes(attr.name));
    } else {
      return attributes;
    }
  }
  static getExcludedFieldsFromFrontmatter(excludedFields) {
    if (Array.isArray(excludedFields)) {
      return excludedFields;
    } else if (excludedFields) {
      return excludedFields.split(",");
    } else {
      return [];
    }
  }
  static getTagNamesFromFrontMatter(_tagNames) {
    if (Array.isArray(_tagNames)) {
      return _tagNames;
    } else if (_tagNames) {
      return _tagNames.split(",");
    } else {
      return [];
    }
  }
  getAttributes() {
    var _a, _b;
    try {
      const file = this.getClassFile();
      const ancestors = this.plugin.fieldIndex.fileClassesAncestors.get(this.name);
      const _excludedFields = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.excludes;
      let excludedFields = FileClass.getExcludedFieldsFromFrontmatter(_excludedFields);
      const ancestorsAttributes = /* @__PURE__ */ new Map();
      ancestorsAttributes.set(this.name, FileClass.getFileClassAttributes(this.plugin, this, excludedFields));
      ancestors == null ? void 0 : ancestors.forEach((ancestorName) => {
        var _a2, _b2;
        const ancestorFile = this.plugin.app.vault.getAbstractFileByPath(`${this.plugin.settings.classFilesPath}${ancestorName}.md`);
        const ancestor = new FileClass(this.plugin, ancestorName);
        ancestorsAttributes.set(ancestorName, FileClass.getFileClassAttributes(this.plugin, ancestor, excludedFields));
        if (ancestorFile instanceof import_obsidian37.TFile && ancestorFile.extension === "md") {
          const _excludedFields2 = (_b2 = (_a2 = this.plugin.app.metadataCache.getFileCache(ancestorFile)) == null ? void 0 : _a2.frontmatter) == null ? void 0 : _b2.excludes;
          excludedFields.push(...FileClass.getExcludedFieldsFromFrontmatter(_excludedFields2));
        }
      });
      for (const [fileClassName, fileClassAttributes] of ancestorsAttributes) {
        this.attributes.push(...fileClassAttributes.filter((attr) => !this.attributes.map((_attr) => _attr.name).includes(attr.name)));
      }
    } catch (error) {
      throw error;
    }
  }
  getVersion() {
    var _a, _b;
    const currentVersion = (_b = (_a = this.plugin.app.metadataCache.getFileCache(this.getClassFile())) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.version;
    return currentVersion && !isNaN(currentVersion) ? currentVersion : 0;
  }
  updateOptions(newOptions) {
    return __async(this, null, function* () {
      const path = this.getClassFile().path;
      const payload = [];
      Object.keys(options).forEach((key) => __async(this, null, function* () {
        const { name, toValue } = options[key];
        payload.push({ name, payload: { value: toValue(newOptions[key]) } });
      }));
      payload.push({ name: "version", payload: { value: `${this.getVersion() + 1}` } });
      yield postValues(this.plugin, payload, path);
    });
  }
  updateAttribute(newType, newName, newOptions, attr, newCommand, newDisplay) {
    return __async(this, null, function* () {
      const fileClass = attr ? this.plugin.fieldIndex.fileClassesName.get(attr.fileClassName) : this;
      const file = fileClass.getClassFile();
      let result = yield this.plugin.app.vault.read(file);
      if (attr) {
        let newContent = [];
        result.split("\n").forEach((line) => {
          if (line.startsWith(attr.name)) {
            let settings = {};
            settings["type"] = newType;
            if (newOptions)
              settings["options"] = newOptions;
            if (newCommand)
              settings["command"] = newCommand;
            if (newDisplay)
              settings["display"] = newDisplay;
            newContent.push(`${newName}:: ${JSON.stringify(settings)}`);
          } else {
            newContent.push(line);
          }
        });
        yield this.plugin.app.vault.modify(file, newContent.join("\n"));
      } else {
        let settings = {};
        settings["type"] = newType;
        if (newOptions)
          settings["options"] = newOptions;
        if (newCommand)
          settings["command"] = newCommand;
        if (newDisplay)
          settings["display"] = newDisplay;
        result += `
${newName}:: ${JSON.stringify(settings)}`;
        yield this.plugin.app.vault.modify(file, result);
      }
    });
  }
  removeAttribute(attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      const result = yield this.plugin.app.vault.read(file);
      let newContent = [];
      result.split("\n").forEach((line) => {
        if (!line.startsWith(attr.name)) {
          newContent.push(line);
        }
      });
      yield this.plugin.app.vault.modify(file, newContent.join("\n"));
    });
  }
  static createFileClass(plugin, name, excludeParent = false) {
    const fileClass = new FileClass(plugin, name);
    fileClass.options = fileClass.getFileClassOptions();
    fileClass.getAttributes();
    return fileClass;
  }
  static getFileClassNameFromPath(plugin, path) {
    var _a, _b;
    const fileClassNameRegex = new RegExp(`${plugin.settings.classFilesPath}(?<fileClassName>.*).md`);
    return (_b = (_a = path.match(fileClassNameRegex)) == null ? void 0 : _a.groups) == null ? void 0 : _b.fileClassName;
  }
};

// src/fileClass/fileClassFieldsView.ts
var FileClassFieldSetting = class {
  constructor(container, fileClass, fileClassAttribute, plugin) {
    this.container = container;
    this.fileClass = fileClass;
    this.fileClassAttribute = fileClassAttribute;
    this.plugin = plugin;
    this.buildSetting();
  }
  buildSetting() {
    const fieldNameContainer = this.container.createDiv({ cls: "name-container" });
    fieldNameContainer.createEl("span", { text: this.fileClassAttribute.name, cls: "title" });
    const typeContainer = this.container.createDiv({ cls: "type-container" });
    const chip = typeContainer.createDiv({ cls: `chip ${FieldTypeTagClass[this.fileClassAttribute.type]}` });
    chip.setText(this.fileClassAttribute.type);
    const fieldButtonsContainer = this.container.createDiv({ cls: "buttons-container" });
    this.addEditButton(fieldButtonsContainer);
    this.addDeleteButton(fieldButtonsContainer);
    const fieldOptionsContainer = this.container.createDiv({ cls: "options-container" });
    fieldOptionsContainer.createEl("span", { cls: "description", text: `${this.fileClassAttribute.getOptionsString(this.plugin)}` });
  }
  addEditButton(container) {
    const btn = new import_obsidian38.ButtonComponent(container);
    btn.setIcon("pencil");
    btn.setTooltip("Edit");
    btn.onClick(() => {
      let modal = new FileClassAttributeModal(this.plugin, this.fileClass, this.fileClassAttribute);
      modal.open();
    });
  }
  addDeleteButton(container) {
    const btn = new import_obsidian38.ButtonComponent(container);
    btn.setIcon("trash");
    btn.setTooltip("Delete");
    btn.setClass("cell");
    btn.onClick(() => {
      removeFileClassAttributeWithName(this.plugin, this.fileClass, this.fileClassAttribute.name);
    });
  }
};
var FileClassFieldsView = class {
  constructor(plugin, viewContainer, fileClass) {
    this.viewContainer = viewContainer;
    this.fileClass = fileClass;
    this.plugin = plugin;
    this.container = this.viewContainer.createDiv({ cls: "fv-fields" });
    this.buildSettings();
  }
  builAddBtn() {
    const footer = this.container.createDiv({ cls: "footer" });
    const btnContainer = footer.createDiv({ cls: "cell" });
    const addBtn = btnContainer.createEl("button");
    (0, import_obsidian38.setIcon)(addBtn, "list-plus");
    addBtn.onclick = () => __async(this, null, function* () {
      const fileClassAttributeModal = new FileClassAttributeModal(this.plugin, FileClass.createFileClass(this.plugin, this.fileClass.name));
      fileClassAttributeModal.open();
    });
  }
  buildSettings() {
    this.container.replaceChildren();
    const fieldsContainer = this.container.createDiv({ cls: "fields-container" });
    const attributes = FileClass.getFileClassAttributes(this.plugin, this.fileClass);
    attributes.forEach((attribute) => {
      new FileClassFieldSetting(fieldsContainer, this.fileClass, attribute, this.plugin);
    });
    this.builAddBtn();
  }
};

// src/fileClass/fileClassSettingsView.ts
var import_obsidian39 = require("obsidian");
var ParentSuggestModal = class extends import_obsidian39.SuggestModal {
  constructor(view) {
    super(view.plugin.app);
    this.view = view;
  }
  getSuggestions(query) {
    const fileClassesNames = [...this.view.plugin.fieldIndex.fileClassesName.keys()];
    const currentName = this.view.fileClass.name;
    return fileClassesNames.sort().filter((name) => name !== currentName && name.toLowerCase().includes(query.toLowerCase()));
  }
  onChooseSuggestion(item, evt) {
    const options2 = this.view.fileClass.getFileClassOptions();
    const parent = this.view.plugin.fieldIndex.fileClassesName.get(item);
    if (parent) {
      options2.parent = parent;
      this.view.fileClass.updateOptions(options2);
    }
  }
  renderSuggestion(value, el) {
    el.setText(value);
  }
};
var TagSuggestModal = class extends import_obsidian39.SuggestModal {
  constructor(view) {
    super(view.plugin.app);
    this.view = view;
  }
  getSuggestions(query) {
    const tags = Object.keys(this.view.plugin.app.metadataCache.getTags());
    return tags.filter((t) => t.toLowerCase().includes(query.toLowerCase()));
  }
  onChooseSuggestion(item, evt) {
    const options2 = this.view.fileClass.getFileClassOptions();
    const tagNames = options2.tagNames || [];
    tagNames.push(item.replace(/^#(.*)/, "$1"));
    options2.tagNames = tagNames;
    this.view.fileClass.updateOptions(options2);
  }
  renderSuggestion(value, el) {
    el.setText(value);
  }
};
var FieldSuggestModal = class extends import_obsidian39.SuggestModal {
  constructor(view) {
    super(view.plugin.app);
    this.view = view;
  }
  getSuggestions(query) {
    const fileClassName = this.view.fileClass.name;
    const fileClassFields = this.view.plugin.fieldIndex.fileClassesFields.get(fileClassName) || [];
    const excludedFields = this.view.fileClass.getFileClassOptions().excludes;
    return fileClassFields.filter((fCA) => {
      var _a;
      return fCA.fileClassName !== fileClassName && ((_a = fCA.fileClassName) == null ? void 0 : _a.toLowerCase().includes(query.toLowerCase())) && !(excludedFields == null ? void 0 : excludedFields.map((attr) => attr.name).includes(fCA.name));
    }).map((fCA) => fCA.name);
  }
  onChooseSuggestion(item, evt) {
    const options2 = this.view.fileClass.getFileClassOptions();
    const excludedFields = options2.excludes || [];
    const excludedField = this.view.fileClass.attributes.find((field) => field.name === item);
    if (excludedField) {
      excludedFields.push(excludedField);
      options2.excludes = excludedFields;
      this.view.fileClass.updateOptions(options2);
    }
  }
  renderSuggestion(value, el) {
    el.setText(value);
  }
};
var FileClassSetting = class {
  constructor(container, label, toolTipText, buildOptionAndAction) {
    this.container = container;
    this.label = label;
    this.toolTipText = toolTipText;
    this.buildOptionAndAction = buildOptionAndAction;
    this.buildSetting();
  }
  buildSetting() {
    this.container.createDiv({ text: this.label, cls: "label" });
    const toolTipBtnContainer = this.container.createDiv({ cls: "tooltip-btn" });
    const tooltipBtn = new import_obsidian39.ButtonComponent(toolTipBtnContainer).setIcon("help-circle").setClass("tooltip-button");
    const action = this.container.createDiv({ cls: "action" });
    this.buildOptionAndAction(action);
    const tooltip = this.container.createDiv({ cls: "tooltip-text" });
    tooltip.innerHTML = this.toolTipText;
    tooltip.hide();
    tooltipBtn.buttonEl.onmouseover = () => tooltip.show();
    tooltipBtn.buttonEl.onmouseout = () => tooltip.hide();
  }
};
var FileClassSettingsView = class {
  constructor(plugin, viewContainer, fileClass) {
    this.viewContainer = viewContainer;
    this.fileClass = fileClass;
    this.plugin = plugin;
    this.container = this.viewContainer.createDiv({ cls: "fv-settings" });
    this.buildSettings();
  }
  buildSettings() {
    this.fileClassOptions = this.fileClass.getFileClassOptions();
    this.container.replaceChildren();
    const settingsContainer = this.container.createDiv({ cls: "settings-container" });
    new FileClassSetting(settingsContainer, "Max records per page", "Maximum lines displayed per page in the table view", (action) => this.buildLimitComponent(action));
    new FileClassSetting(settingsContainer, "Map with tag", `Bind tags with ${this.plugin.settings.fileClassAlias}<br/>If Tag Names are empty this fileClass will be bound with the tag of same name`, (action) => this.buildMapWithTagComponent(action));
    new FileClassSetting(settingsContainer, "Button Icon", "Name of the icon for the metadata menu button<br/>(lucide.dev)", (action) => this.buildIconComponent(action));
    new FileClassSetting(settingsContainer, "Tag Names", `Names of tags to bind this ${this.plugin.settings.fileClassAlias} with`, (action) => this.buildTagNamesComponent(action));
    new FileClassSetting(settingsContainer, "Parent Fileclass", "Choose a fileClass to inherit fields from", (action) => this.buildExtendComponent(action));
    new FileClassSetting(settingsContainer, "Excluded Fields", `Names of fields to exclude from ancestor fileclasses`, (action) => this.buildExcludesComponent(action));
    this.buildSaveBtn();
    this.saveBtn.removeClass("active");
  }
  buildSaveBtn() {
    const footer = this.container.createDiv({ cls: "footer" });
    const btnContainer = footer.createDiv({ cls: "cell" });
    this.saveBtn = btnContainer.createEl("button");
    (0, import_obsidian39.setIcon)(this.saveBtn, "save");
    this.saveBtn.onclick = () => __async(this, null, function* () {
      yield this.fileClass.updateOptions(this.fileClassOptions);
    });
  }
  buildLimitComponent(action) {
    const input = new import_obsidian39.TextComponent(action);
    input.setValue(`${this.fileClassOptions.limit}`);
    input.onChange((value) => {
      this.saveBtn.addClass("active");
      this.fileClassOptions.limit = parseInt(value) || this.fileClassOptions.limit;
    });
  }
  buildMapWithTagComponent(action) {
    const toggler = new import_obsidian39.ToggleComponent(action);
    toggler.setValue(this.fileClassOptions.mapWithTag);
    toggler.onChange((value) => {
      this.saveBtn.addClass("active");
      this.fileClassOptions.mapWithTag = value;
    });
  }
  buildIconComponent(action) {
    const iconManagerContainer = action.createDiv({ cls: "icon-manager" });
    const input = new import_obsidian39.TextComponent(iconManagerContainer);
    const iconContainer = iconManagerContainer.createDiv({});
    input.setValue(this.fileClassOptions.icon);
    (0, import_obsidian39.setIcon)(iconContainer, this.fileClassOptions.icon);
    input.onChange((value) => {
      this.saveBtn.addClass("active");
      this.fileClassOptions.icon = value;
      (0, import_obsidian39.setIcon)(iconContainer, this.fileClassOptions.icon);
    });
  }
  buildTagNamesComponent(action) {
    var _a;
    const tagsContainer = action.createDiv({ cls: "items" });
    (_a = this.fileClassOptions.tagNames) == null ? void 0 : _a.forEach((tagName) => {
      const tagContainer = tagsContainer.createDiv({ cls: "item chip", text: tagName });
      new import_obsidian39.ButtonComponent(tagContainer).setIcon("x-circle").setClass("item-remove").onClick(() => __async(this, null, function* () {
        var _a2;
        (_a2 = this.fileClassOptions.tagNames) == null ? void 0 : _a2.remove(tagName);
        yield this.fileClass.updateOptions(this.fileClassOptions);
      }));
    });
    const tagAddBtn = tagsContainer.createEl("button", { cls: "item add" });
    (0, import_obsidian39.setIcon)(tagAddBtn, "plus-circle");
    tagAddBtn.onclick = () => {
      new TagSuggestModal(this).open();
    };
  }
  buildExcludesComponent(action) {
    var _a;
    const fieldsContainer = action.createDiv({ cls: "items" });
    (_a = this.fileClassOptions.excludes) == null ? void 0 : _a.forEach((field) => {
      const fieldontainer = fieldsContainer.createDiv({ cls: "item chip", text: field.name });
      new import_obsidian39.ButtonComponent(fieldontainer).setIcon("x-circle").setClass("item-remove").onClick(() => __async(this, null, function* () {
        var _a2;
        const excludedFields = (_a2 = this.fileClassOptions.excludes) == null ? void 0 : _a2.filter((attr) => attr.name !== field.name);
        this.fileClassOptions.excludes = excludedFields;
        yield this.fileClass.updateOptions(this.fileClassOptions);
      }));
    });
    const fieldAddBtn = fieldsContainer.createEl("button", { cls: "item" });
    (0, import_obsidian39.setIcon)(fieldAddBtn, "plus-circle");
    fieldAddBtn.onclick = () => {
      new FieldSuggestModal(this).open();
    };
  }
  buildExtendComponent(action) {
    var _a;
    const parentManagerContainer = action.createDiv({ cls: "items" });
    const parentLinkContainer = parentManagerContainer.createDiv({ cls: "item" });
    const parent = this.fileClassOptions.parent;
    if (parent) {
      const path = this.fileClass.getClassFile().path;
      const component = this.plugin;
      import_obsidian39.MarkdownRenderer.renderMarkdown(`[[${parent.name}]]`, parentLinkContainer, path, component);
      (_a = parentLinkContainer.querySelector("a.internal-link")) == null ? void 0 : _a.addEventListener("click", (e) => {
        var _a2;
        this.plugin.app.workspace.openLinkText((_a2 = e.target.getAttr("data-href").split("/").last()) == null ? void 0 : _a2.replace(/(.*).md/, "$1"), path, "tab");
      });
    }
    parentManagerContainer.createDiv({ cls: "item spacer" });
    if (parent) {
      const parentRemoveBtn = parentManagerContainer.createEl("button", { cls: "item" });
      (0, import_obsidian39.setIcon)(parentRemoveBtn, "trash");
      parentRemoveBtn.onclick = () => __async(this, null, function* () {
        delete this.fileClassOptions.parent;
        yield this.fileClass.updateOptions(this.fileClassOptions);
      });
    }
    const parentChangeBtn = parentManagerContainer.createEl("button", { cls: "item right-align" });
    (0, import_obsidian39.setIcon)(parentChangeBtn, "edit");
    parentChangeBtn.onclick = () => {
      new ParentSuggestModal(this).open();
    };
  }
};

// src/fileClass/fileClassTableView.ts
var import_obsidian40 = require("obsidian");
var oppositeDirection = {
  "asc": "desc",
  "desc": "asc"
};
var FileClassTableView = class {
  constructor(plugin, component, viewContainer, fileClass) {
    this.component = component;
    this.viewContainer = viewContainer;
    this.fileClass = fileClass;
    this.filters = {};
    this.sorters = {};
    this.sliceStart = 0;
    this.plugin = plugin;
    this.container = this.viewContainer.createDiv({ cls: "fv-table" });
    this.limit = this.fileClass.getFileClassOptions().limit;
    this.createHeader();
  }
  createHeader() {
    const header = this.container.createDiv({ cls: "options" });
    const limitContainer = header.createDiv({ cls: "limit" });
    this.paginationContainer = header.createDiv({ cls: "pagination" });
    const fieldsContainer = header.createDiv({ cls: "fields" });
    const applyContainer = header.createDiv({ cls: "footer" });
    this.buildLimitManager(limitContainer);
    this.buildPaginationManager(this.paginationContainer);
    this.buildFiltersAndSortManager(fieldsContainer);
    this.buildRefreshManager(applyContainer);
    this.buildCleanFilters(applyContainer);
  }
  udpate() {
    this.buildTable();
    this.buildPaginationComponent(this.paginationContainer);
    this.refreshButton.removeCta();
  }
  buildTable() {
    var _a;
    if (this.tableContainer) {
      this.tableContainer.remove();
    }
    ;
    this.tableContainer = this.container.createDiv({ attr: { id: `table-container-${Math.floor(Date.now() / 1e3)}` } });
    this.tableContainer.onscroll = (e) => {
      var _a2;
      const table = this.tableContainer;
      const firstColl = this.tableContainer.querySelectorAll("tbody > tr > td:first-child");
      const firstFileLink = (_a2 = firstColl[0]) == null ? void 0 : _a2.querySelector("a.internal-link");
      if (firstColl && firstFileLink) {
        if (!this.firstCollWidth)
          this.firstCollWidth = parseFloat(getComputedStyle(firstColl[0]).width);
        if (!this.tableFontSize)
          this.tableFontSize = parseFloat(getComputedStyle(firstFileLink).width);
        const position = e.target.scrollLeft;
        if (window.matchMedia("(max-width: 400px)").matches) {
          if (position !== 0) {
            table.addClass("scrolled");
            table.querySelectorAll("tbody > tr > td:first-child").forEach((item) => {
              item.querySelector("a:first-child").style.maxWidth = `${Math.max(3 * this.tableFontSize, this.firstCollWidth - this.tableFontSize - position)}px`;
            });
          } else {
            this.tableContainer.removeClass("scrolled");
            table.querySelectorAll("tbody > tr > td:first-child").forEach((item) => {
              item.querySelector("a:first-child").style.maxWidth = "100%";
            });
          }
        }
      }
    };
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      dvApi.executeJs(this.buildDvJSRendering(), this.tableContainer, this.plugin, this.fileClass.getClassFile().path);
    }
    this.addClickEventToLink();
  }
  addClickEventToLink() {
    this.container.querySelectorAll("a.internal-link").forEach((link) => {
      link.addEventListener("click", () => {
        var _a;
        return this.plugin.app.workspace.openLinkText((_a = link.getAttr("data-href").split("/").last()) == null ? void 0 : _a.replace(/(.*).md/, "$1"), this.fileClass.getClassFile().path, "tab");
      });
    });
  }
  buildPaginationComponent(container) {
    var _a;
    container.replaceChildren();
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const values = new Function("dv", "current", `return ${this.buildDvJSQuery()}`)(dvApi).values;
      const count = values.length;
      for (let i = 0; i <= Math.floor(count / this.limit); i++) {
        if (i * this.limit < count) {
          const rangeComponent = container.createDiv({
            cls: `range ${i === this.sliceStart / this.limit ? "active" : ""}`,
            text: `${i * this.limit + 1} - ${Math.min((i + 1) * this.limit, count)}`
          });
          rangeComponent.onclick = () => {
            this.sliceStart = i * this.limit;
            this.udpate();
          };
        }
      }
    }
  }
  buildPaginationManager(container) {
    this.buildPaginationComponent(container);
  }
  buildLimitManager(container) {
    container.replaceChildren();
    container.createDiv({ text: "Results per page: ", cls: "label" });
    const limitInput = new import_obsidian40.TextComponent(container);
    limitInput.setValue(`${this.limit}`);
    limitInput.onChange((value) => {
      this.limit = parseInt(value) || this.limit;
      this.refreshButton.setCta();
    });
  }
  toggleBtnState(name, direction) {
    const btnName = `${name}__${direction}`;
    const oppositeBtnName = `${name}__${oppositeDirection[direction]}`;
    const { btn, active } = this.sorters[btnName];
    const { btn: oppBtn } = this.sorters[oppositeBtnName];
    if (active) {
      btn.buttonEl.removeClass("active");
      this.sorters[btnName].active = false;
    } else {
      btn.setClass("active");
      oppBtn.buttonEl.removeClass("active");
      this.sorters[btnName].active = true;
      this.sorters[oppositeBtnName].active = false;
    }
  }
  buildSortBtn(name, direction, component) {
    const btn = new import_obsidian40.ButtonComponent(component);
    btn.setIcon(direction === "asc" ? "chevron-up" : "chevron-down");
    this.sorters[`${name}__${direction}`] = { btn, active: false, name, direction };
    btn.onClick(() => {
      this.toggleBtnState(name, direction);
      this.udpate();
    });
  }
  buildFieldNameAndSortComponent(name, label, container) {
    const fieldNameAndSortContainer = container.createDiv({ cls: "field-header" });
    this.buildSortBtn(name, "asc", fieldNameAndSortContainer);
    this.buildSortBtn(name, "desc", fieldNameAndSortContainer);
    fieldNameAndSortContainer.createDiv({ text: label, cls: "field-name" });
  }
  buildFilterComponent(name, container) {
    const fieldFilterContainer = container.createDiv({ cls: "filter-input" });
    const filter = new import_obsidian40.TextComponent(fieldFilterContainer);
    filter.setValue("");
    filter.onChange(() => this.refreshButton.setCta());
    this.filters[name] = filter;
  }
  buildFiltersAndSortManager(container) {
    const fieldContainer = container.createDiv({ cls: "field-container" });
    this.buildFieldNameAndSortComponent("file", "File name", fieldContainer);
    this.buildFilterComponent("file", fieldContainer);
    const fields = this.plugin.fieldIndex.fileClassesFields.get(this.fileClass.name) || [];
    fields.forEach((field) => {
      const fieldContainer2 = container.createDiv({ cls: "field-container" });
      this.buildFieldNameAndSortComponent(field.name, field.name, fieldContainer2);
      this.buildFilterComponent(field.name, fieldContainer2);
    });
  }
  buildRefreshManager(container) {
    const btnContainer = container.createDiv({ cls: "cell" });
    this.refreshButton = new import_obsidian40.ButtonComponent(btnContainer);
    this.refreshButton.setIcon("refresh-ccw");
    this.refreshButton.onClick(() => {
      this.udpate();
    });
  }
  buildCleanFilters(container) {
    const btnContainer = container.createDiv({ cls: "cell" });
    const cleanFilterBtn = new import_obsidian40.ButtonComponent(btnContainer);
    cleanFilterBtn.setIcon("eraser");
    cleanFilterBtn.onClick(() => {
      Object.values(this.filters).forEach((filter) => filter.setValue(""));
      this.refreshButton.setCta();
    });
  }
  buildFilterQuery() {
    return Object.entries(this.filters).map(([fieldName, input]) => {
      const field = fieldName === "file" ? `p.file.name` : `p["${fieldName}"]`;
      if (input.getValue()) {
        return `    .filter(p => ${field} && ${field}.toString().toLowerCase().includes("${input.getValue()}".toLowerCase()))
`;
      } else {
        return "";
      }
    }).join("");
  }
  buildSorterQuery() {
    return Object.entries(this.sorters).map(([fieldSorter, { btn, active, direction, name }]) => {
      const fieldKey = name === "file" ? "p.file.name" : `p["${name}"]`;
      if (active) {
        return `    .sort(p => ${fieldKey}, "${direction}")
`;
      } else {
        return "";
      }
    }).join("");
  }
  buildDvJSQuery() {
    var _a;
    const tagsMappedToFileClass = [];
    this.plugin.fieldIndex.tagsMatchingFileClasses.forEach((cls, tag) => {
      if (this.fileClass.name === cls.name) {
        tagsMappedToFileClass.push("#" + tag);
      }
    });
    let dvQuery = "";
    const fileClassAlias = this.plugin.settings.fileClassAlias;
    const classFilesPath = this.plugin.settings.classFilesPath;
    const templatesFolder = (_a = this.plugin.app.plugins.plugins["templater-obsidian"]) == null ? void 0 : _a.settings["templates_folder"];
    dvQuery += `dv.pages()
`;
    dvQuery += `    .where(p =>

        (

            (typeof(p['${fileClassAlias}']) === 'string' && p['${fileClassAlias}'] === '${this.fileClass.name}')

            || (Array.isArray(p['${fileClassAlias}']) && p['${fileClassAlias}'].includes('${this.fileClass.name}'))

            || p.file.etags.values.some(et => ${JSON.stringify(tagsMappedToFileClass)}.some(t => et.startsWith(t)))

        )

        ${!!classFilesPath ? "        && !p.file.path.includes('" + classFilesPath + "')\n" : ""}
        ${templatesFolder ? "        && !p.file.path.includes('" + templatesFolder + "')\n" : ""}
        )
`;
    dvQuery += this.buildFilterQuery();
    return dvQuery;
  }
  buildDvJSRendering() {
    const fields = this.plugin.fieldIndex.fileClassesFields.get(this.fileClass.name) || [];
    let dvJS = 'const {fieldModifier: f} = this.app.plugins.plugins["metadata-menu"].api;\ndv.table(["File",';
    dvJS += fields.map((field) => `"${field.name}"`).join(",");
    dvJS += `], 
`;
    dvJS += this.buildDvJSQuery();
    dvJS += this.buildSorterQuery();
    dvJS += `    .slice(${this.sliceStart}, ${this.sliceStart + this.limit})
`;
    dvJS += '    .map(p => [\n        dv.el("span", p.file.link, {cls: "field-name"}),\n';
    dvJS += fields.map((field) => `        f(dv, p, "${field.name}", {options: {alwaysOn: false, showAddField: true}})`).join(",\n");
    dvJS += "    \n])";
    dvJS += "\n);";
    return dvJS;
  }
};

// src/fileClass/fileClassView.ts
var FILECLASS_VIEW_TYPE = "FileClassView";
var MenuOption = class {
  constructor(menu, id, name, relatedView, view) {
    this.menu = menu;
    this.id = id;
    this.name = name;
    this.relatedView = relatedView;
    this.view = view;
    this.itemContainer = this.menu.createDiv({ cls: "fv-menu-item", attr: { id: this.id } });
    this.itemContainer.createEl("h2", { text: this.name });
    this.itemContainer.onclick = () => {
      this.view.updateDisplayView(this.id);
    };
  }
  toggleInactive() {
    this.itemContainer.removeClass("active");
    this.relatedView.hide();
  }
  toggleActive() {
    this.itemContainer.addClass("active");
    this.relatedView.show();
  }
};
var FileClassView = class extends import_obsidian41.ItemView {
  constructor(leaf, plugin, component, name, fileClass) {
    super(leaf);
    this.leaf = leaf;
    this.plugin = plugin;
    this.component = component;
    this.name = name;
    this.fileClass = fileClass;
    this.menuOptions = [];
    this.views = [];
    this.containerEl.addClass("metadata-menu");
    this.containerEl.addClass("fileclass-view");
    this.contentEl.addClass("fileclass-view-content");
    this.navigation = false;
    this.icon = "file-spreadsheet";
    this.onunload = () => {
      this.plugin.app.viewRegistry.unregisterView(FILECLASS_VIEW_TYPE + "__" + this.fileClass.name);
      this.plugin.removeChild(this.component);
      this.unload();
    };
    this.buildLayout();
  }
  updateDisplayView(id) {
    [...this.viewContainer.children].forEach((view) => view.hide());
    this.menuOptions.forEach((option) => option.id === id ? option.toggleActive() : option.toggleInactive());
  }
  buildLayout() {
    this.menu = this.contentEl.createDiv({ cls: "fv-menu" });
    this.viewContainer = this.contentEl.createDiv({ cls: "view-container" });
    this.buildSettingsView();
    this.buildFieldsView();
    this.buildTableView();
    this.buildMenu();
    this.updateDisplayView("tableOption");
  }
  buildMenu() {
    this.menuOptions.push(new MenuOption(this.menu, "tableOption", "Table view", this.tableView.container, this));
    this.menuOptions.push(new MenuOption(this.menu, "fieldsOption", "Fileclass fields", this.fieldsView.container, this));
    this.menuOptions.push(new MenuOption(this.menu, "settingsOption", "Fileclass settings", this.settingsView.container, this));
  }
  buildSettingsView() {
    this.settingsView = new FileClassSettingsView(this.plugin, this.viewContainer, this.fileClass);
    this.views.push(this.settingsView.container);
  }
  buildFieldsView() {
    this.fieldsView = new FileClassFieldsView(this.plugin, this.viewContainer, this.fileClass);
    this.views.push(this.fieldsView.container);
  }
  buildTableView() {
    this.tableView = new FileClassTableView(this.plugin, this.component, this.viewContainer, this.fileClass);
    this.views.push(this.tableView.container);
  }
  getDisplayText() {
    return this.name || "FileClass";
  }
  getViewType() {
    return this.fileClass ? FILECLASS_VIEW_TYPE + "__" + this.fileClass.name : FILECLASS_VIEW_TYPE;
  }
  updateFieldsView() {
    this.fileClass.getAttributes();
    this.fieldsView.buildSettings();
  }
  updateSettingsView() {
    this.settingsView.buildSettings();
  }
  onOpen() {
    return __async(this, null, function* () {
      var _a;
      this.icon = ((_a = this.fileClass) == null ? void 0 : _a.getIcon()) || "file-spreadsheet";
      this.tableView.buildTable();
    });
  }
};

// src/fileClass/fileClassChoiceModal.ts
var import_obsidian42 = require("obsidian");
var FileClassChoiceModal = class extends import_obsidian42.SuggestModal {
  constructor(plugin, fileClassManager, tagsAndFileClasses) {
    super(plugin.app);
    this.plugin = plugin;
    this.fileClassManager = fileClassManager;
    this.tagsAndFileClasses = tagsAndFileClasses;
    this.containerEl.addClass("metadata-menu");
  }
  getSuggestions(query) {
    const index = this.plugin.fieldIndex;
    const values = [.../* @__PURE__ */ new Set([...index.fileClassesName.keys(), ...index.tagsMatchingFileClasses.keys()])].filter((name) => name.toLowerCase().includes(query.toLowerCase())).sort((a, b) => a.localeCompare(b));
    if (this.tagsAndFileClasses.length) {
      return values.filter((value) => this.tagsAndFileClasses.includes(value));
    } else {
      return values;
    }
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("value-container");
  }
  onChooseSuggestion(item, evt) {
    return __async(this, null, function* () {
      var _a;
      const index = this.plugin.fieldIndex;
      const fileClass = index.fileClassesName.get(item) || index.tagsMatchingFileClasses.get(item);
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (fileClass && dvApi) {
        this.fileClassManager.name = item;
        this.fileClassManager.fileClass = fileClass;
        this.fileClassManager.fileClassViewType = FILECLASS_VIEW_TYPE + "__" + fileClass.name;
        this.fileClassManager.openFileClassView();
      }
      this.close();
    });
  }
};

// src/components/fileClassManager.ts
var FileClassManager = class extends import_obsidian43.Component {
  constructor(plugin, fileClass) {
    super();
    this.plugin = plugin;
    this.fileClass = fileClass;
    if (!this.fileClass) {
      this.fileClassViewType = FILECLASS_VIEW_TYPE;
    } else {
      this.fileClassViewType = FILECLASS_VIEW_TYPE + "__" + this.fileClass.name;
    }
  }
  onload() {
    return __async(this, null, function* () {
      if (this.fileClass) {
        this.name = this.fileClass.name;
        this.fileClassViewType = FILECLASS_VIEW_TYPE + "__" + this.fileClass.name;
        yield this.openFileClassView();
      } else {
        const tagsAndFileClasses = this.getActiveFileTagsAndFileClasses();
        if (tagsAndFileClasses.length === 1) {
          const index = this.plugin.fieldIndex;
          const fileClassName = tagsAndFileClasses[0];
          const fileClass = index.fileClassesName.get(fileClassName) || index.tagsMatchingFileClasses.get(fileClassName);
          if (fileClass) {
            this.name = fileClass.name;
            this.fileClass = fileClass;
            this.fileClassViewType = FILECLASS_VIEW_TYPE + "__" + fileClass.name;
            yield this.openFileClassView();
          } else {
            this.plugin.removeChild(this);
            this.unload();
          }
        } else {
          const choiceModal = new FileClassChoiceModal(this.plugin, this, tagsAndFileClasses);
          choiceModal.onClose = () => {
            if (!this.fileClass) {
              this.plugin.removeChild(this);
              this.unload();
            }
          };
          choiceModal.open();
        }
      }
    });
  }
  onunload() {
    this.plugin.app.workspace.detachLeavesOfType(this.fileClassViewType);
    this.plugin.app.viewRegistry.unregisterView(this.fileClassViewType);
  }
  openFileClassView() {
    return __async(this, null, function* () {
      if (this.fileClass) {
        const fileClass = this.fileClass;
        this.plugin.app.workspace.detachLeavesOfType(this.fileClassViewType);
        this.plugin.registerView(this.fileClassViewType, (leaf) => {
          const fileClassView = new FileClassView(leaf, this.plugin, this, this.name, fileClass);
          this.fileClassView = fileClassView;
          return fileClassView;
        });
        yield this.plugin.app.workspace.getLeaf("tab", "vertical").setViewState({
          type: this.fileClassViewType,
          active: true
        });
        this.plugin.app.workspace.revealLeaf(this.plugin.app.workspace.getLeavesOfType(this.fileClassViewType).last());
        this.registerEvent(this.plugin.app.workspace.on("metadata-menu:updated-index", () => {
          var _a;
          const view = (_a = this.plugin.app.workspace.getLeavesOfType(this.fileClassViewType)[0]) == null ? void 0 : _a.view;
          if (view) {
            view.updateFieldsView();
            view.updateSettingsView();
          }
        }));
      }
    });
  }
  getActiveFileTagsAndFileClasses() {
    var _a, _b, _c;
    const index = this.plugin.fieldIndex;
    const activeFilePath = (_a = this.plugin.app.workspace.getActiveFile()) == null ? void 0 : _a.path;
    const tagsAndFileClasses = [];
    const dvApi = (_b = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _b.api;
    if (activeFilePath && activeFilePath.endsWith(".md") && dvApi) {
      tagsAndFileClasses.push(...((_c = dvApi.page(activeFilePath).etags) == null ? void 0 : _c.filter((tag) => [...index.tagsMatchingFileClasses.keys()].includes(tag))) || []);
      tagsAndFileClasses.push(...index.filesFileClassesNames.get(activeFilePath) || []);
    }
    return [...new Set(tagsAndFileClasses)];
  }
};

// src/components/NoteFields.ts
var FieldOptions = class {
  constructor(container) {
    this.container = container;
  }
  addOption(icon, onclick, tooltip, className) {
    const fieldOptionContainer = this.container.createDiv({ cls: "field-item field-option" });
    const fieldOption = new import_obsidian44.ButtonComponent(fieldOptionContainer);
    fieldOption.setIcon(icon);
    if (className)
      fieldOption.buttonEl.addClass(className);
    fieldOption.onClick(() => onclick());
    if (tooltip)
      fieldOption.setTooltip(tooltip);
  }
};
var FieldsModal = class extends import_obsidian44.Modal {
  constructor(plugin, file) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.fieldContainers = [];
    this.missingFields = false;
    this.dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    this.getFields();
    this.containerEl.addClass("metadata-menu");
    this.containerEl.addClass("note-fields-modal");
  }
  onOpen() {
    this.titleEl.setText(`Fields of ${this.file.basename}.${this.file.extension}`);
    this.buildFieldsContainer();
  }
  getFields() {
    this.fields = this.plugin.fieldIndex.filesFields.get(this.file.path) || [];
  }
  buildFieldContainer(container, field, value) {
    const fieldManager = new FieldManager[field.type](this.plugin, field);
    const fieldNameWrapper = container.createDiv({ cls: "field-name-wrapper" });
    const fieldNameContainer = fieldNameWrapper.createDiv({ text: `${field.name}`, cls: "field-item field-name" });
    const fieldSettingsWrapper = container.createDiv({ cls: "field-settings-wrapper" });
    fieldSettingsWrapper.createDiv({ cls: "field-settings-spacer" });
    const fileClass = field.fileClassName ? this.plugin.fieldIndex.fileClassesName.get(field.fileClassName) : void 0;
    if (fileClass) {
      fieldNameContainer.addClass(`fileClassField__${fileClass.name.replace("/", "___").replace(" ", "_")}`);
    }
    const fieldSettingContainer = fieldSettingsWrapper.createDiv({ cls: "field-item field-setting" });
    const fieldSettingBtn = new import_obsidian44.ButtonComponent(fieldSettingContainer);
    fieldSettingBtn.setIcon("gear");
    fieldSettingBtn.setTooltip(`${field.fileClassName ? field.fileClassName + " > " : "Preset Field > "} ${field.name} settings`);
    fieldSettingBtn.onClick(() => {
      const _fileClass = field.fileClassName ? this.plugin.fieldIndex.fileClassesName.get(field.fileClassName) : void 0;
      const fileClassAttribute = _fileClass == null ? void 0 : _fileClass.attributes.find((attr) => attr.name === field.name);
      if (fileClassAttribute && _fileClass) {
        const fileClassAttributeModal = new FileClassAttributeModal(this.plugin, _fileClass, fileClassAttribute);
        fileClassAttributeModal.open();
      }
    });
    const fieldTypeContainer = fieldSettingsWrapper.createDiv({ cls: `field-item` });
    fieldTypeContainer.createDiv({ text: field.type, cls: `chip field-type ${FieldBackgroundColorClass[field.type]}` });
    const fieldValueWrapper = container.createDiv({ cls: "field-value-wrapper" });
    const fieldValueContainer = fieldValueWrapper.createDiv({
      cls: value !== void 0 && value !== null ? "field-item field-value" : "field-item field-value emptyfield"
    });
    if (value === null) {
      fieldValueContainer.setText(field.type === "Lookup" /* Lookup */ ? "---auto---" : "<empty>");
    } else if (value === void 0) {
      this.missingFields = true;
      fieldValueContainer.setText("<missing>");
    } else {
      fieldManager.displayValue(fieldValueContainer, this.file, field.name, () => {
        this.close();
      });
    }
    const fieldOptionsWrapper = container.createDiv({ cls: "field-options-wrapper" });
    fieldOptionsWrapper.createDiv({ cls: "field-options-spacer" });
    const fieldOptions = new FieldOptions(fieldOptionsWrapper);
    if (value !== void 0) {
      fieldManager.addFieldOption(field.name, value, this.file, fieldOptions);
    } else {
      const fieldBtnContainer = fieldOptionsWrapper.createDiv({ cls: "field-item field-option" });
      const fieldBtn = new import_obsidian44.ButtonComponent(fieldBtnContainer);
      fieldBtn.setIcon("list-plus");
      fieldBtn.setTooltip("Add field at section");
      fieldBtn.onClick(() => {
        new chooseSectionModal(this.plugin, this.file, (lineNumber, after, asList, asComment) => FieldManager2.openFieldModal(this.plugin, this.file, field.name, "", lineNumber, after, asList, asComment)).open();
      });
    }
    ;
  }
  openInsertMissingFieldsForFileClassModal(fileClass) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      if (dvFile) {
        const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, after, asList, asComment, fileClass.name));
        modal.open();
      }
    }
  }
  missingFieldsForFileClass(fileClass) {
    var _a, _b;
    const currentFieldsNames = [];
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      if (dvFile) {
        currentFieldsNames.push(...genuineKeys(dvFile));
      }
    }
    ;
    const missingFields = fileClass && this.file ? !((_b = this.plugin.fieldIndex.fileClassesFields.get(fileClass.name)) == null ? void 0 : _b.map((f) => f.name).every((fieldName) => currentFieldsNames.includes(fieldName))) : false;
    return missingFields;
  }
  buildFileClassManager(container) {
    const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
    fileClasses.forEach((fileClass) => {
      const fileClassManagerContainer = container.createDiv({ cls: "fields-inheritance-manager-container" });
      const _ancestors = this.plugin.fieldIndex.fileClassesAncestors.get(fileClass.name) || [];
      const ancestors = [..._ancestors].reverse();
      ancestors.push(fileClass.name);
      ancestors.forEach((fileClassName, i) => {
        const _fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        if (_fileClass) {
          const fileClassOptionsContainer = fileClassManagerContainer.createDiv({ cls: "fileclass-manager-container" });
          const fileClassNameContainer = fileClassOptionsContainer.createDiv({ cls: "name", text: _fileClass.name });
          fileClassNameContainer.setAttr("id", `fileClass__${_fileClass.name.replace("/", "___").replace(" ", "_")}`);
          if (this.missingFieldsForFileClass(_fileClass)) {
            const fileClassInsertMissingFieldsBtn = new import_obsidian44.ButtonComponent(fileClassOptionsContainer);
            fileClassInsertMissingFieldsBtn.setIcon("battery-full");
            fileClassInsertMissingFieldsBtn.setTooltip(`Insert missing fields for ${_fileClass.name}`);
            fileClassInsertMissingFieldsBtn.onClick(() => {
              this.openInsertMissingFieldsForFileClassModal(_fileClass);
            });
          }
          const fileClassAddAttributeBtn = new import_obsidian44.ButtonComponent(fileClassOptionsContainer);
          fileClassAddAttributeBtn.setIcon("plus-circle");
          fileClassAddAttributeBtn.setTooltip(`Add field definition in ${_fileClass.name}`);
          fileClassAddAttributeBtn.onClick(() => {
            const fileClassAttributeModal = new FileClassAttributeModal(this.plugin, _fileClass);
            fileClassAttributeModal.open();
          });
          if (i < ancestors.length - 1) {
            fileClassManagerContainer.createDiv({ text: ">", cls: "separator" });
          }
          const fileClassFieldsContainers = this.containerEl.querySelectorAll(`[class*="fileClassField__${fileClassName.replace("/", "___").replace(" ", "_")}"]`);
          fileClassFieldsContainers.forEach((fieldNameContainer) => {
            fieldNameContainer.onmouseover = () => {
              fileClassNameContainer == null ? void 0 : fileClassNameContainer.addClass("active");
            };
            fieldNameContainer.onmouseout = () => {
              fileClassNameContainer == null ? void 0 : fileClassNameContainer.removeClass("active");
            };
          });
          fileClassNameContainer.onmouseover = () => {
            this.containerEl.querySelectorAll(`.field-item.field-name.fileClassField__${fileClassName.replace("/", "___").replace(" ", "_")}`).forEach((cont) => {
              cont.addClass("active");
            });
          };
          fileClassNameContainer.onmouseout = () => {
            this.containerEl.querySelectorAll(`.field-item.field-name.fileClassField__${fileClassName.replace("/", "___").replace(" ", "_")}`).forEach((cont) => {
              cont.removeClass("active");
            });
          };
          fileClassNameContainer.onclick = () => {
            const fileClassComponent = new FileClassManager(this.plugin, _fileClass);
            this.plugin.addChild(fileClassComponent);
            this.close();
          };
        }
      });
    });
  }
  buildFieldsContainer() {
    this.missingFields = false;
    this.contentEl.replaceChildren();
    this.contentEl.createEl("hr");
    const fieldsContainer = this.contentEl.createDiv({ cls: "note-fields-container" });
    this.fields.forEach((field) => {
      const value = this.dvApi ? this.dvApi.page(this.file.path)[field.name] : void 0;
      this.buildFieldContainer(fieldsContainer, field, value);
    });
    if (this.missingFields) {
      const insertMissingFieldsContainer = this.contentEl.createDiv({ cls: "insert-all-fields" });
      insertMissingFieldsContainer.createDiv({ text: "Insert missing fields" });
      const insertMissingFieldsBtn = new import_obsidian44.ButtonComponent(insertMissingFieldsContainer);
      insertMissingFieldsBtn.setIcon("battery-full");
      insertMissingFieldsBtn.onClick(() => {
        var _a;
        const dvFile = (_a = this.dvApi) == null ? void 0 : _a.page(this.file.path);
        if (dvFile) {
          new chooseSectionModal(this.plugin, this.file, (lineNumber, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, after, asList, asComment)).open();
        }
      });
    }
    this.contentEl.createEl("hr");
    const fileClassManagersContainer = this.contentEl.createDiv({ cls: "fields-container" });
    this.buildFileClassManager(fileClassManagersContainer);
  }
};
var NoteFieldsComponent = class extends import_obsidian44.Component {
  constructor(plugin, cacheVersion, onChange, file) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.file = file;
    this.fieldsModal = new FieldsModal(this.plugin, file);
    this.fieldsModal.onClose = () => {
      this.plugin.removeChild(this);
      this.unload();
    };
  }
  onload() {
    this.plugin.registerEvent(this.plugin.app.metadataCache.on("dataview:metadata-change", () => {
      this.fieldsModal.getFields();
      this.fieldsModal.buildFieldsContainer();
    }));
    this.fieldsModal.open();
  }
};

// src/options/FieldCommandSuggestModal.ts
var import_obsidian45 = require("obsidian");
var FieldCommandSuggestModal = class extends import_obsidian45.FuzzySuggestModal {
  constructor(app2) {
    super(app2);
    this.options = [];
    this.containerEl.addClass("metadata-menu");
  }
  getItems() {
    return this.options;
  }
  getItemText(item) {
    return item.actionLabel;
  }
  onChooseItem(item, evt) {
    item.action();
  }
  renderSuggestion(item, el) {
    el.addClass("value-container");
    const iconContainer = el.createDiv({ cls: "icon-container" });
    item.item.icon ? (0, import_obsidian45.setIcon)(iconContainer, item.item.icon) : (0, import_obsidian45.setIcon)(iconContainer, "pencil");
    const actionLabel = el.createDiv();
    actionLabel.innerHTML = item.item.actionLabel;
  }
};

// src/options/FileClassOptionsList.ts
var import_obsidian46 = require("obsidian");
function isMenu(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand(location) {
  return location === "InsertFieldCommand";
}
function isSuggest(location) {
  return location.getItems !== void 0;
}
var FileClassOptionsList = class {
  constructor(plugin, file, location, fromFile) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.fromFile = fromFile;
    this.fileClass = this.plugin.fieldIndex.fileClassesPath.get(this.file.path);
  }
  createExtraOptionList(openAfterCreate = true) {
    var _a, _b;
    const mapWithTagAction = () => __async(this, null, function* () {
      yield postValues(this.plugin, [{ name: "mapWithTag", payload: { value: "true" } }], this.file);
    });
    const openFileClassTableViewAction = () => {
      const fileClassComponent = new FileClassManager(this.plugin, fileClass);
      this.plugin.addChild(fileClassComponent);
    };
    if (isMenu(this.location)) {
      this.location.addSeparator();
    }
    ;
    const fileClass = this.fileClass;
    const currentFieldsNames = [];
    let addMissingFieldsAction = () => {
      new import_obsidian46.Notice("Something went wrong, please check your fileClass definitions");
    };
    if (this.fromFile) {
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (dvApi) {
        const dvFile = dvApi.page(this.fromFile.path);
        if (dvFile) {
          currentFieldsNames.push(...genuineKeys(dvFile));
          const modal = new chooseSectionModal(this.plugin, this.fromFile, (lineNumber, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, after, asList, asComment, fileClass == null ? void 0 : fileClass.name));
          addMissingFieldsAction = () => {
            modal.open();
          };
        }
      }
      ;
    }
    const missingFields = fileClass && this.fromFile ? !((_b = this.plugin.fieldIndex.fileClassesFields.get(fileClass.name)) == null ? void 0 : _b.map((f) => f.name).every((fieldName) => currentFieldsNames.includes(fieldName))) : false;
    if (isInsertFieldCommand(this.location) && fileClass) {
      const modal = new FileClassAttributeModal(this.plugin, fileClass);
      modal.open();
    } else if (isSuggest(this.location)) {
      if (fileClass) {
        this.location.options.push({
          id: `display_table_view_for_${fileClass.name.replace("/", "_")}`,
          actionLabel: `Display ${fileClass.name} table view`,
          action: openFileClassTableViewAction,
          icon: "file-spreadsheet"
        });
      }
      if (fileClass && !fileClass.isMappedWithTag()) {
        this.location.options.push({
          id: "map_fileClass_with_tag",
          actionLabel: `<span>Map <b>${fileClass.name}</b> with tag of same name</span>`,
          action: mapWithTagAction,
          icon: "hash"
        });
      }
      if (fileClass && missingFields && this.fromFile) {
        this.location.options.push({
          id: `insert_missig_fields_from_${fileClass.name.replace("/", "_")}`,
          actionLabel: `<span>Insert missing fields from <b>${fileClass.name}</b></span>`,
          action: addMissingFieldsAction,
          icon: "battery-full"
        });
      }
      this.buildFieldOptions();
      if (openAfterCreate)
        this.location.open();
    } else if (isMenu(this.location)) {
      if (fileClass) {
        this.location.addItem((item) => {
          item.setTitle(`Display ${fileClass.name} table view`);
          item.onClick(openFileClassTableViewAction);
          item.setIcon("file-spreadsheet");
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      if (fileClass && !fileClass.isMappedWithTag()) {
        this.location.addItem((item) => {
          item.setTitle(`Map ${fileClass.name} with tag`);
          item.setIcon("hash");
          item.onClick(mapWithTagAction);
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      if (fileClass && missingFields && this.fromFile) {
        this.location.addItem((item) => {
          item.setTitle(`Insert missing fields from ${fileClass.name}`);
          item.setIcon("battery-full");
          item.onClick(addMissingFieldsAction);
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      this.buildFieldOptions();
    } else {
      this.buildFieldOptions;
    }
  }
  buildFieldOptions() {
    var _a;
    (_a = this.fileClass) == null ? void 0 : _a.attributes.forEach((attr) => {
      const modal2 = new FileClassAttributeModal(this.plugin, this.fileClass, attr);
      if (isMenu(this.location)) {
        this.location.addItem((item) => {
          item.setTitle(`${this.fileClass.name} - ${attr.name}`);
          item.setIcon("wrench");
          item.onClick(() => {
            modal2.open();
          });
          item.setSection(`metadata-menu-fileclass.${this.fileClass.name}.fileclass-fields`);
        });
      } else if (isSuggest(this.location)) {
        this.location.options.push({
          id: `update_${attr.name}`,
          actionLabel: `<span>${attr.name}</span>`,
          action: () => modal2.open(),
          icon: "gear"
        });
      }
    });
    const modal = new FileClassAttributeModal(this.plugin, this.fileClass);
    const action = () => modal.open();
    if (isMenu(this.location) && this.fileClass) {
      this.location.addItem((item) => {
        item.setTitle("Add new field");
        item.setIcon("plus-circle");
        item.onClick(action);
        item.setSection(`metadata-menu-fileclass.${this.fileClass.name}.fileclass-fields`);
      });
    } else if (isSuggest(this.location) && this.fileClass) {
      this.location.options.push({
        id: "add_fileClass_attribute",
        actionLabel: `<span>Insert an attribute for <b>${this.fileClass.name}</b> fileClass</span>`,
        action,
        icon: "plus-circle"
      });
    }
  }
};

// src/options/OptionsList.ts
var import_obsidian48 = require("obsidian");

// src/modals/addNewFileClassModal.ts
var import_obsidian47 = require("obsidian");

// src/commands/createFileClass.ts
function createFileClass(_0, _1) {
  return __async(this, arguments, function* (plugin, name, mapWithTag = false, tagNames = []) {
    const classFilesPath = plugin.settings.classFilesPath;
    if (classFilesPath) {
      try {
        const content = mapWithTag ? `---
mapWithTag: true
${tagNames.length ? "tagNames: [" + tagNames.join(", ") + "]\n" : ""}---
` : "";
        yield plugin.app.vault.create(`${classFilesPath}${name}.md`, content);
      } catch (error) {
        throw error;
      }
    }
  });
}

// src/modals/addNewFileClassModal.ts
var AddNewFileClassModal = class extends import_obsidian47.Modal {
  constructor(plugin) {
    super(plugin.app);
    this.plugin = plugin;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    this.titleEl.setText("Add a new fileClass");
    this.buildAddFileClassForm();
  }
  buildAddFileClassForm() {
    const fileClassesPath = this.plugin.settings.classFilesPath;
    const fileClassAlias = this.plugin.settings.fileClassAlias;
    const nameContainer = this.contentEl.createDiv({ cls: "field-container" });
    nameContainer.createDiv({ text: `${fileClassAlias} name`, cls: "label" });
    const nameInput = new import_obsidian47.TextComponent(nameContainer);
    nameInput.inputEl.addClass("with-label");
    nameInput.inputEl.addClass("full-width");
    const nameErrorContainer = this.contentEl.createDiv({ cls: "field-error", text: `This ${fileClassAlias} file already exists` });
    const mapWithTagContainer = this.contentEl.createDiv({ cls: "field-container" });
    mapWithTagContainer.createDiv({ cls: "label", text: `Map this ${fileClassAlias} file with the tag of same name` });
    mapWithTagContainer.createDiv({ cls: "spacer" });
    const mapWithTagToggler = new import_obsidian47.ToggleComponent(mapWithTagContainer);
    mapWithTagToggler.setValue(false);
    mapWithTagToggler.onChange((value) => {
      if (value) {
        tagNamesContainer.show();
      } else {
        tagNamesContainer.hide();
      }
    });
    const tagNamesContainer = this.contentEl.createDiv({ cls: "field-container" });
    tagNamesContainer.createDiv({ cls: "label", text: "Aliases (optional)" });
    const tagNamesInput = new import_obsidian47.TextComponent(tagNamesContainer);
    tagNamesInput.inputEl.addClass("with-label");
    tagNamesInput.inputEl.addClass("full-width");
    tagNamesInput.setPlaceholder("Leave empty to map with the tag of same name as fileclass");
    tagNamesContainer.hide();
    const actionsContainer = this.contentEl.createDiv({ cls: "footer-actions" });
    actionsContainer.createDiv({ cls: "spacer" });
    const saveBtn = new import_obsidian47.ButtonComponent(actionsContainer);
    saveBtn.setDisabled(true);
    saveBtn.setIcon("file-plus-2");
    nameErrorContainer.hide();
    nameInput.onChange((value) => __async(this, null, function* () {
      nameErrorContainer.hide();
      saveBtn.setDisabled(false);
      saveBtn.setCta();
      if (yield this.plugin.app.vault.adapter.exists(`${fileClassesPath}${value}.md`)) {
        nameErrorContainer.show();
        saveBtn.setDisabled(true);
        saveBtn.removeCta();
      } else {
        saveBtn.setDisabled(false);
        saveBtn.setCta();
      }
    }));
    saveBtn.onClick(() => {
      createFileClass(this.plugin, nameInput.getValue(), mapWithTagToggler.getValue(), tagNamesInput.getValue().split(",").map((t) => t.trim()));
      this.close();
    });
  }
};

// src/options/OptionsList.ts
function isMenu2(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand2(location) {
  return location === "InsertFieldCommand";
}
function isSuggest2(location) {
  return location.getItems !== void 0;
}
var OptionsList = class {
  constructor(plugin, file, location, includedFields) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.includedFields = includedFields;
    this.fieldsFromIndex = {};
    this.file = file;
    this.location = location;
    this.attributes = {};
    this.includedFields = includedFields ? [this.plugin.settings.fileClassAlias, ...includedFields] : [this.plugin.settings.fileClassAlias];
    this.getFieldsFromIndex();
    this.getFieldsValues();
  }
  getFieldsValues() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      try {
        genuineKeys(dvFile).forEach((key) => this.addAttribute(key, dvFile[key]));
      } catch (error) {
        throw error;
      }
    }
  }
  addAttribute(key, value) {
    const includedFields = this.includedFields.filter((f) => f !== this.plugin.settings.fileClassAlias);
    if (includedFields.length > 0) {
      if (this.includedFields.includes(key) && !this.plugin.settings.globallyIgnoredFields.includes(key)) {
        this.attributes[key] = value;
      }
    } else if (!this.plugin.settings.globallyIgnoredFields.includes(key)) {
      this.attributes[key] = value;
    }
  }
  getFieldsFromIndex() {
    const index = this.plugin.fieldIndex;
    const fields = index.filesFields.get(this.file.path);
    fields == null ? void 0 : fields.forEach((field) => this.fieldsFromIndex[field.name] = field);
  }
  createAndOpenFieldModal(fieldName) {
    const field = this.fieldsFromIndex[fieldName];
    if (field) {
      const fieldManager = new FieldManager[field.type](this.plugin, field);
      switch (fieldManager.type) {
        case "Boolean" /* Boolean */:
          fieldManager.toggle(field.name, this.attributes[field.name], this.file);
          break;
        case "Cycle" /* Cycle */:
          fieldManager.next(field.name, this.attributes[field.name], this.file);
          break;
        default:
          fieldManager.createAndOpenFieldModal(this.file, field.name, this.attributes[field.name]);
          break;
      }
    } else {
      const defaultField = new Field_default(fieldName);
      defaultField.type = "Input" /* Input */;
      if (fieldName === this.plugin.settings.fileClassAlias) {
        this.buildFileClassFieldOptions(defaultField, this.attributes[fieldName]);
      } else if (this.location === "ManageAtCursorCommand") {
        const fieldManager = new Managers_default.Input(this.plugin, defaultField);
        fieldManager.createAndOpenFieldModal(this.file, fieldName, this.attributes[fieldName]);
      }
    }
  }
  createExtraOptionList(openAfterCreate = true) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    const location = this.location;
    if (isMenu2(location)) {
      location.addSeparator();
    }
    ;
    if (isInsertFieldCommand2(location)) {
      this.addFieldAtCurrentPositionOption();
    } else if (isSuggest2(location)) {
      this.openNoteFieldModalOption();
      this.buildFieldOptions();
      this.addFieldAtCurrentPositionOption();
      this.addSectionSelectModalOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (dvApi) {
        const currentFieldsNames = genuineKeys(dvApi.page(this.file.path));
        if (![...this.plugin.fieldIndex.filesFields.get(this.file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          this.addAllMissingFieldsAtSection();
        }
      }
      const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
      fileClasses.forEach((fileClass) => {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
        const optionsList = new FileClassOptionsList(this.plugin, fileClass.getClassFile(), fieldCommandSuggestModal, this.file);
        optionsList.createExtraOptionList(false);
        location.options.push({
          id: "manage_fileClass_attributes",
          actionLabel: `<span>Manage <b>${fileClass.name}</b> fileClass fields</span>`,
          action: () => {
            fieldCommandSuggestModal.open();
          },
          icon: "wrench"
        });
      });
      this.addFileClassToFileOption();
      this.addNewFileClassOption();
      if (openAfterCreate)
        location.open();
    } else if (isMenu2(location)) {
      this.openNoteFieldModalOption();
      this.buildFieldOptions();
      this.addSectionSelectModalOption();
      this.addFieldAtCurrentPositionOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (dvApi) {
        const currentFieldsNames = genuineKeys(dvApi.page(this.file.path));
        if (![...this.plugin.fieldIndex.filesFields.get(this.file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          this.addAllMissingFieldsAtSection();
        }
      }
      const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
      fileClasses.forEach((fileClass) => {
        const fileClassOptionsList = new FileClassOptionsList(this.plugin, fileClass.getClassFile(), location, this.file);
        fileClassOptionsList.createExtraOptionList(false);
      });
      this.addFileClassToFileOption();
      this.addNewFileClassOption();
    }
  }
  buildFileClassFieldOptions(field, value) {
    const modal = new InputModal(this.plugin, this.file, field, value);
    modal.titleEl.setText(`Change Value for <${field.name}>`);
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setTitle(`Update ${field.name}`);
        item.setIcon("wrench");
        item.onClick(() => modal.open());
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: `update_${field.name}`,
        actionLabel: `<span>Update <b>${field.name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Input" /* Input */]
      });
    }
    ;
  }
  openNoteFieldModalOption() {
    var _a;
    const lastFileClassName = (_a = this.plugin.fieldIndex.filesFileClassesNames.get(this.file.path)) == null ? void 0 : _a.last();
    if (lastFileClassName) {
      const fileClass = this.plugin.fieldIndex.fileClassesName.get(lastFileClassName);
      if (fileClass) {
        const icon = fileClass.getIcon() || "clipboard-list";
        const noteFieldsComponent = new NoteFieldsComponent(this.plugin, "1", () => {
        }, this.file);
        const action = () => this.plugin.addChild(noteFieldsComponent);
        if (isMenu2(this.location)) {
          this.location.addItem((item) => {
            item.setTitle(`Open fields modal`);
            item.setIcon(icon);
            item.onClick(action);
            item.setSection("metadata-menu");
          });
        } else if (isSuggest2(this.location)) {
          this.location.options.push({
            id: `open_fields_modal`,
            actionLabel: `<span>Open fields modal</span>`,
            action,
            icon
          });
        }
        ;
      }
    }
  }
  buildFieldOptions() {
    Object.keys(this.attributes).forEach((key) => {
      const value = this.attributes[key];
      const field = this.fieldsFromIndex[key];
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.addFieldOption(key, value, this.file, this.location);
      } else if (key !== "file" && (isSuggest2(this.location) || isMenu2(this.location))) {
        const defaultField = new Field_default(key);
        defaultField.type = "Input" /* Input */;
        if (key === this.plugin.settings.fileClassAlias) {
          this.buildFileClassFieldOptions(defaultField, value);
        } else {
          const fieldManager = new Managers_default.Input(this.plugin, defaultField);
          fieldManager.addFieldOption(key, value || "", this.file, this.location);
        }
      }
    });
  }
  addSectionSelectModalOption() {
    const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, after, asList, asComment) => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, after, asList, asComment));
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setIcon("enter");
        item.setTitle("Add field at section...");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: "add_field_at_section",
        actionLabel: "Add field at section...",
        action: () => modal.open(),
        icon: "enter"
      });
    }
    ;
  }
  addAllMissingFieldsAtSection() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, after, asList, asComment));
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("battery-full");
          item.setTitle("Add missing fields at section...");
          item.onClick((evt) => {
            modal.open();
          });
          item.setSection("metadata-menu");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_missing_fields_at_section",
          actionLabel: "Add missing fields at section...",
          action: () => modal.open(),
          icon: "battery-full"
        });
      }
      ;
    }
  }
  addFieldAtTheEndOfFrontmatterOption() {
    var _a;
    if ((_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter) {
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field in frontmatter");
          item.onClick((evt) => __async(this, null, function* () {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", -1, false, false, false);
          }));
          item.setSection("metadata-menu");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_in_frontmatter",
          actionLabel: "Add a field in frontmatter...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", -1, false, false, false),
          icon: "pin"
        });
      }
    }
  }
  addFieldAtCurrentPositionOption() {
    var _a;
    const currentView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian48.MarkdownView);
    const currentLineNumber = currentView == null ? void 0 : currentView.editor.getCursor().line;
    if (currentLineNumber !== void 0 && this.file.path == (currentView == null ? void 0 : currentView.file.path)) {
      const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter;
      let lineNumber = currentLineNumber;
      if (frontmatter) {
        const { position: { start: start2, end: end2 } } = frontmatter;
        if (currentLineNumber >= start2.line && currentLineNumber < end2.line)
          lineNumber = -1;
      }
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field at cursor");
          item.onClick((evt) => {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, false, false, false);
          });
          item.setSection("metadata-menu");
        });
      } else if (isInsertFieldCommand2(this.location)) {
        FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, false, false, false);
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_at_cursor",
          actionLabel: "Add field at cursor...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, false, false, false),
          icon: "pin"
        });
      }
      ;
    }
  }
  addFileClassToFileOption() {
    const modal = new AddFileClassToFileModal(this.plugin, this.file);
    const action = () => modal.open();
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setIcon("plus-square");
        item.setTitle(`Add ${this.plugin.settings.fileClassAlias} to ${this.file.basename}`);
        item.onClick(action);
        item.setSection("metadata-menu-fileclass");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: "add_fileclass_to_file",
        actionLabel: `Add ${this.plugin.settings.fileClassAlias} to ${this.file.basename}`,
        action,
        icon: "plus-square"
      });
    }
    ;
  }
  addNewFileClassOption() {
    const modal = new AddNewFileClassModal(this.plugin);
    const action = () => modal.open();
    if (this.plugin.settings.classFilesPath) {
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("file-plus-2");
          item.setTitle(`Add a new ${this.plugin.settings.fileClassAlias}`);
          item.onClick(action);
          item.setSection("metadata-menu-fileclass");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_new_fileclass",
          actionLabel: `Add a new ${this.plugin.settings.fileClassAlias}`,
          action,
          icon: "file-plus-2"
        });
      }
    }
  }
};

// src/commands/paletteCommands.ts
function addFileClassAttributeOptions(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "fileClassAttr_options",
    name: "All fileClass attributes options",
    icon: "gear",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFileClass = !!(classFilesPath && !!(view == null ? void 0 : view.file) && view.file.path.startsWith(classFilesPath));
      if (checking) {
        return inFileClass;
      }
      if (inFileClass) {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(plugin.app);
        const optionsList = new FileClassOptionsList(plugin, view.file, fieldCommandSuggestModal);
        optionsList.createExtraOptionList();
      }
    }
  });
}
function addInsertFileClassAttribute(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "insert_fileClassAttr",
    name: "Insert a new fileClass attribute",
    icon: "list-plus",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFileClass = !!(classFilesPath && !!(view == null ? void 0 : view.file) && view.file.path.startsWith(classFilesPath));
      if (checking) {
        return inFileClass;
      }
      if (inFileClass) {
        try {
          const fileClassName = FileClass.getFileClassNameFromPath(plugin, view.file.path);
          if (fileClassName) {
            const fileClassAttributeModal = new FileClassAttributeModal(plugin, FileClass.createFileClass(plugin, fileClassName));
            fileClassAttributeModal.open();
          }
        } catch (error) {
          new import_obsidian49.Notice("plugin is not a valid fileClass");
        }
      }
    }
  });
}
function addInsertFieldAtPositionCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "insert_field_at_cursor",
    name: "Choose a field to insert at cursor",
    icon: "list-plus",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const optionsList = new OptionsList(plugin, view.file, "InsertFieldCommand");
        optionsList.createExtraOptionList();
      }
    }
  });
}
function addFieldOptionsCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "field_options",
    name: "Fields options",
    icon: "gear",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(plugin.app);
        const optionsList = new OptionsList(plugin, view.file, fieldCommandSuggestModal);
        optionsList.createExtraOptionList();
      }
    }
  });
}
function addManageFieldAtCursorCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "field_at_cursor_options",
    name: "Manage field at cursor",
    icon: "text-cursor-input",
    checkCallback: (checking) => {
      var _a;
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const editor = view == null ? void 0 : view.editor;
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile && editor !== void 0;
      }
      if (inFile && editor !== void 0) {
        const optionsList = new OptionsList(plugin, view.file, "ManageAtCursorCommand");
        const frontmatter = (_a = plugin.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter;
        if (frontmatter && editor && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
          const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        } else if (editor) {
          const { attribute, values } = getLineFields(editor.getLine(editor.getCursor().line)).find((field) => editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) || {};
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        }
      }
    }
  });
}
function insertMissingFieldsCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "insert_missing_fields",
    name: "Bulk insert missing fields",
    icon: "battery-full",
    checkCallback: (checking) => {
      var _a;
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (dvApi && inFile) {
        const file = view.file;
        const currentFieldsNames = genuineKeys(dvApi.page(file.path));
        if (![...plugin.fieldIndex.filesFields.get(file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          new chooseSectionModal(plugin, file, (lineNumber, after, asList, asComment) => insertMissingFields(plugin, file.path, lineNumber, after, asList, asComment)).open();
        }
      }
    }
  });
}
function addOpenFieldsModalCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "open_fields_modal",
    name: "Open this note's fields modal",
    icon: "clipboard-list",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const file = view.file;
        if (inFile && file instanceof import_obsidian49.TFile && file.extension === "md") {
          const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
          }, file);
          plugin.addChild(noteFieldsComponent);
        }
      }
    }
  });
}
function addInsertFieldCommand(plugin) {
  const fields = [];
  plugin.settings.presetFields.forEach((f) => {
    if (f.command)
      fields.push(f);
  });
  [...plugin.fieldIndex.fileClassesFields].forEach(([fileClassName, _fields]) => {
    _fields.forEach((field) => {
      if (field.command) {
        fields.push(field);
      }
    });
  });
  fields.forEach((field) => {
    if (field.command) {
      const command = field.command;
      plugin.addCommand({
        id: command.id,
        name: command.label,
        icon: command.icon,
        checkCallback: (checking) => {
          var _a;
          const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
          const fR = command.id.match(new RegExp("insert__(?<fileClassName>.*)__(?<fieldName>.*)"));
          if (checking) {
            const fileClasses = (view == null ? void 0 : view.file) ? plugin.fieldIndex.filesFileClasses.get(view == null ? void 0 : view.file.path) : void 0;
            return (view == null ? void 0 : view.file) && (fileClasses && fileClasses.some((fileClass) => {
              var _a2;
              return fileClass.name === ((_a2 = fR == null ? void 0 : fR.groups) == null ? void 0 : _a2.fileClassName);
            }) || !fileClasses && ((_a = fR == null ? void 0 : fR.groups) == null ? void 0 : _a.fileClassName) === "presetField");
          }
          if ((fR == null ? void 0 : fR.groups) && (view == null ? void 0 : view.file)) {
            const fieldName = fR.groups.fieldName;
            new chooseSectionModal(plugin, view.file, (lineNumber, after, asList, asComment) => FieldManager2.openFieldModal(plugin, view.file, fieldName, "", lineNumber, after, asList, asComment)).open();
          }
        }
      });
    }
  });
}
function addFileClassTableViewCommand(plugin) {
  plugin.addCommand({
    id: "open_fileclass_view",
    name: "Open fileClass view",
    icon: "file-spreadsheet",
    checkCallback: (checking) => {
      var _a;
      if (checking) {
        return true;
      }
      const activeFilePath = (_a = plugin.app.workspace.getActiveFile()) == null ? void 0 : _a.path;
      const fileClass = activeFilePath ? plugin.fieldIndex.fileClassesPath.get(activeFilePath) : void 0;
      const fileClassComponent = new FileClassManager(plugin, fileClass);
      plugin.addChild(fileClassComponent);
    }
  });
}
function addUpdateLookupsAndFormulas(plugin) {
  plugin.addCommand({
    id: "update_all_lookups",
    name: "Update all lookups and formulas",
    icon: "file-search",
    checkCallback: (checking) => {
      if (checking)
        return true;
      plugin.fieldIndex.fullIndex("command", true);
    }
  });
}
function addUpdateFileLookupsCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "update_file_lookups",
    name: "Update active file lookups fields",
    icon: "file-search",
    checkCallback: (checking) => {
      var _a;
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const file = view.file;
        if (inFile && file instanceof import_obsidian49.TFile && file.extension === "md") {
          const lookupFields = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.filter((field) => field.type === "Lookup" /* Lookup */);
          lookupFields == null ? void 0 : lookupFields.forEach((field) => __async(this, null, function* () {
            yield updateLookups(plugin, "single_command", { file, fieldName: field.name });
          }));
        }
      }
    }
  });
}
function addUpdateFileFormulasCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "update_file_formulas",
    name: "Update active file formulas fields",
    icon: "function-square",
    checkCallback: (checking) => {
      var _a;
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian49.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const file = view.file;
        if (inFile && file instanceof import_obsidian49.TFile && file.extension === "md") {
          const formulaFields = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.filter((field) => field.type === "Formula" /* Formula */);
          formulaFields == null ? void 0 : formulaFields.forEach((field) => __async(this, null, function* () {
            yield updateFormulas(plugin, { file, fieldName: field.name });
          }));
        }
      }
    }
  });
}
function addCommands(plugin, view) {
  const classFilesPath = plugin.settings.classFilesPath;
  if (view && view instanceof import_obsidian49.FileView) {
    const file = plugin.app.vault.getAbstractFileByPath(view.file.path);
    if (file instanceof import_obsidian49.TFile && file.extension === "md") {
      if (classFilesPath && file.path.startsWith(classFilesPath)) {
        addFileClassAttributeOptions(plugin);
        addInsertFileClassAttribute(plugin);
      } else {
        addFieldOptionsCommand(plugin);
        addInsertFieldAtPositionCommand(plugin);
        addManageFieldAtCursorCommand(plugin);
        insertMissingFieldsCommand(plugin);
        addOpenFieldsModalCommand(plugin);
        addInsertFieldCommand(plugin);
        addUpdateFileLookupsCommand(plugin);
        addUpdateFileFormulasCommand(plugin);
      }
    }
  }
  addFileClassTableViewCommand(plugin);
  addUpdateLookupsAndFormulas(plugin);
}

// src/components/ContextMenu.ts
var import_obsidian50 = require("obsidian");
var ContextMenu = class extends import_obsidian50.Component {
  constructor(plugin) {
    super();
    this.plugin = plugin;
  }
  onload() {
    this.plugin.registerEvent(this.plugin.app.workspace.on("file-menu", (menu, abstractFile, source) => {
      const file = this.plugin.app.vault.getAbstractFileByPath(abstractFile.path);
      this.buildOptions(file, menu);
    }));
    this.plugin.registerEvent(this.plugin.app.workspace.on("editor-menu", (menu, editor, view) => {
      var _a;
      const file = this.plugin.app.workspace.getActiveFile();
      const includedFields = [];
      const frontmatter = view.file && ((_a = this.plugin.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter);
      if (frontmatter && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
        const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
        if (attribute)
          includedFields.push(attribute);
      } else {
        getLineFields(editor.getLine(editor.getCursor().line)).forEach((field) => {
          if (editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) {
            includedFields.push(field.attribute);
          }
        });
      }
      if (includedFields.length) {
        this.buildOptions(file, menu, includedFields);
      } else {
        this.buildOptions(file, menu);
      }
    }));
  }
  buildOptions(file, menu, includedFields) {
    const classFilesPath = this.plugin.settings.classFilesPath;
    if (file instanceof import_obsidian50.TFile && file.extension === "md") {
      if (!import_obsidian50.Platform.isMobile && (0, import_obsidian50.requireApiVersion)("0.16.0")) {
        if (classFilesPath && file.path.startsWith(classFilesPath)) {
          const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, file.path);
          menu.setSectionSubmenu(`metadata-menu-fileclass.${fileClassName}.fileclass-fields`, { title: "Manage fields", icon: "wrench" });
        } else {
          menu.setSectionSubmenu("metadata-menu.current_field", { title: "Current field", icon: "pencil" });
          menu.setSectionSubmenu("metadata-menu.fields", { title: "Manage fields", icon: "pencil" });
          const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(file.path) || [];
          fileClasses.forEach((fileClass) => {
            menu.setSectionSubmenu(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`, { title: `Manage ${fileClass.name} fields`, icon: "wrench" });
          });
        }
      }
      if (this.plugin.settings.displayFieldsInContextMenu) {
        if (classFilesPath && file.path.startsWith(classFilesPath)) {
          const fileClassOptionsList = new FileClassOptionsList(this.plugin, file, menu);
          fileClassOptionsList.createExtraOptionList();
        } else {
          const optionsList = new OptionsList(this.plugin, file, menu, includedFields);
          optionsList.createExtraOptionList();
        }
        ;
      } else {
        menu.addItem((item) => {
          item.setIcon("list");
          item.setTitle("Field Options");
          item.onClick(() => {
            const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
            const optionsList = new OptionsList(this.plugin, file, fieldCommandSuggestModal);
            optionsList.createExtraOptionList();
          });
        });
      }
    }
    ;
  }
};

// src/components/ExtraButton.ts
var import_obsidian53 = require("obsidian");

// src/options/linkAttributes.ts
var import_obsidian51 = require("obsidian");
function clearExtraAttributes(link) {
  Object.values(link.attributes).forEach((attr) => {
    if (attr.name.includes("fileclass-name")) {
      link.removeAttribute(attr.name);
      const el = link.nextElementSibling;
      if (el == null ? void 0 : el.hasClass("fileclass-icon")) {
        el.remove();
      }
    }
  });
}
function setLinkMetadataFormButton(plugin, link, destPath, viewTypeName, fileClassName) {
  var _a, _b;
  if (link.classList.contains("metadata-menu-button-hidden"))
    return;
  switch (viewTypeName) {
    case "a.internal-link":
      if (!plugin.settings.enableLinks)
        return;
      break;
    case "tabHeader":
      if (!plugin.settings.enableTabHeader)
        return;
      break;
    case "starred":
      if (!plugin.settings.enableStarred)
        return;
      break;
    case "file-explorer":
      if (!plugin.settings.enableFileExplorer)
        return;
      break;
    case "backlink":
      if (!plugin.settings.enableBacklinks)
        return;
      break;
    case "search":
      if (!plugin.settings.enableSearch)
        return;
      break;
    default:
      return;
  }
  for (const a of link.attributes) {
    if (a.name.includes("fileclass-name") && a.name !== fileClassName) {
      link.removeAttribute(a.name);
      const el = link.nextElementSibling;
      if (el == null ? void 0 : el.hasClass("fileclass-icon")) {
        el.remove();
      }
    }
  }
  const classFilessPath = plugin.settings.classFilesPath;
  const fileClass = plugin.fieldIndex.fileClassesPath.get(destPath + ".md");
  if (classFilessPath && fileClass) {
    const icon = "file-spreadsheet";
    link.setAttribute("fileclass-name", fileClass.name);
    const el = link.nextElementSibling;
    if (!(el == null ? void 0 : el.hasClass("fileclass-icon"))) {
      const metadataMenuBtn = plugin.app.workspace.containerEl.createEl("a", { cls: "metadata-menu fileclass-icon" });
      if (metadataMenuBtn) {
        (0, import_obsidian51.setIcon)(metadataMenuBtn, icon);
        (_a = link.parentElement) == null ? void 0 : _a.insertBefore(metadataMenuBtn, link.nextSibling);
        metadataMenuBtn.onclick = (event) => {
          plugin.addChild(new FileClassManager(plugin, fileClass));
          event.stopPropagation();
        };
      }
    }
  } else if (fileClassName) {
    const fileClass2 = plugin.fieldIndex.fileClassesName.get(fileClassName);
    if (fileClass2) {
      const icon = fileClass2.getIcon();
      link.setAttribute("fileclass-name", fileClassName);
      const el = link.nextElementSibling;
      if (!(el == null ? void 0 : el.hasClass("fileclass-icon"))) {
        const metadataMenuBtn = plugin.app.workspace.containerEl.createEl("a", { cls: "metadata-menu fileclass-icon" });
        if (metadataMenuBtn) {
          (0, import_obsidian51.setIcon)(metadataMenuBtn, icon || plugin.settings.buttonIcon);
          (_b = link.parentElement) == null ? void 0 : _b.insertBefore(metadataMenuBtn, link.nextSibling);
          metadataMenuBtn.onclick = (event) => {
            const file = plugin.app.vault.getAbstractFileByPath(`${destPath}.md`);
            if (file instanceof import_obsidian51.TFile && file.extension === "md") {
              const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
              }, file);
              plugin.addChild(noteFieldsComponent);
            }
            event.stopPropagation();
          };
        }
      }
    }
  }
}
function updateLinkMetadataMenuFormButton(app2, plugin, link, viewTypeName, source) {
  var _a, _b;
  const linkHref = (_a = link.getAttribute("href")) == null ? void 0 : _a.split("#")[0];
  const dest = linkHref && app2.metadataCache.getFirstLinkpathDest(linkHref, source);
  if (dest) {
    const fileClassName = (_b = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _b.last();
    setLinkMetadataFormButton(plugin, link, dest.path.replace(/(.*).md/, "$1"), viewTypeName, fileClassName);
  }
}
function updateDivExtraAttributes(app2, plugin, link, viewTypeName, sourceName, _linkName) {
  var _a;
  const linkName = _linkName || link.textContent;
  const dest = linkName && app2.metadataCache.getFirstLinkpathDest((0, import_obsidian51.getLinkpath)(linkName), sourceName);
  if (dest) {
    const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _a.last();
    setLinkMetadataFormButton(plugin, link, dest.path.replace(/(.*).md/, "$1"), viewTypeName, fileClassName);
  }
}
function updateElLinks(app2, plugin, el, ctx) {
  const links = el.querySelectorAll("a.internal-link");
  const source = ctx.sourcePath.replace(/(.*).md/, "$1");
  links.forEach((link) => {
    updateLinkMetadataMenuFormButton(app2, plugin, link, "a.internal-link", source);
  });
}
function updateVisibleLinks(app2, plugin) {
  const settings = plugin.settings;
  app2.workspace.iterateRootLeaves((leaf) => {
    if (leaf.view instanceof import_obsidian51.MarkdownView && leaf.view.file) {
      const file = leaf.view.file;
      const cachedFile = app2.metadataCache.getFileCache(file);
      const fileName = file.path.replace(/(.*).md/, "$1");
      const tabHeader = leaf.tabHeaderInnerTitleEl;
      if (settings.enableTabHeader) {
        updateDivExtraAttributes(app2, plugin, tabHeader, "tabHeader", fileName);
      } else {
        clearExtraAttributes(tabHeader);
      }
      if ((cachedFile == null ? void 0 : cachedFile.links) && settings.enableLinks) {
        cachedFile.links.forEach((link) => {
          var _a;
          const dest = app2.metadataCache.getFirstLinkpathDest(link.link, fileName);
          if (dest) {
            const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _a.last();
            const internalLinks = leaf.view.containerEl.querySelectorAll(`a.internal-link[href="${link.link}"]`);
            internalLinks.forEach((internalLink) => setLinkMetadataFormButton(plugin, internalLink, dest.path.replace(/(.*).md/, "$1"), `a.internal-link`, fileClassName));
          }
        });
      }
    }
  });
}

// src/components/ExtraButton.ts
var import_state2 = require("@codemirror/state");

// src/options/livePreview.ts
var import_obsidian52 = require("obsidian");
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var import_language = require("@codemirror/language");
var import_language2 = require("@codemirror/language");
function buildCMViewPlugin(plugin) {
  class HeaderWidget extends import_view.WidgetType {
    constructor(fileClassName, after, destName) {
      super();
      this.fileClassName = fileClassName;
      this.after = after;
      this.destName = destName;
    }
    toDOM() {
      let metadataMenuBtn = document.createElement("span");
      if (this.fileClassName) {
        metadataMenuBtn.setAttr("fileclass-name", this.fileClassName);
        metadataMenuBtn.addClass("fileclass-icon");
        metadataMenuBtn.addClass("metadata-menu");
        let fileClass = plugin.fieldIndex.fileClassesName.get(this.fileClassName);
        const classFilesPath = plugin.settings.classFilesPath;
        if (classFilesPath && this.destName.includes(classFilesPath)) {
          const icon = "file-spreadsheet";
          fileClass = plugin.fieldIndex.fileClassesPath.get(this.destName + ".md");
          if (fileClass) {
            (0, import_obsidian52.setIcon)(metadataMenuBtn, icon || settings.buttonIcon);
            metadataMenuBtn.onclick = (event) => {
              plugin.addChild(new FileClassManager(plugin, fileClass));
              event.stopPropagation();
            };
          }
        } else if (fileClass) {
          const icon = fileClass.getIcon();
          (0, import_obsidian52.setIcon)(metadataMenuBtn, icon || settings.buttonIcon);
          metadataMenuBtn.onclick = (event) => {
            const file = plugin.app.vault.getAbstractFileByPath(`${this.destName}.md`);
            if (file instanceof import_obsidian52.TFile && file.extension === "md") {
              const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
              }, file);
              plugin.addChild(noteFieldsComponent);
            }
            event.stopPropagation();
          };
        }
      }
      return metadataMenuBtn;
    }
    ignoreEvent() {
      return true;
    }
  }
  const settings = plugin.settings;
  const viewPlugin = import_view.ViewPlugin.fromClass(class {
    constructor(view) {
      this.decorations = this.buildDecorations(view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = this.buildDecorations(update.view);
      }
    }
    destroy() {
    }
    buildDecorations(view) {
      let builder = new import_state.RangeSetBuilder();
      if (!settings.enableEditor) {
        return builder.finish();
      }
      const mdView = view.state.field(import_obsidian52.editorViewField);
      let lastAttributes = {};
      let iconDecoAfter = null;
      let iconDecoAfterWhere = null;
      let mdAliasFrom = null;
      let mdAliasTo = null;
      for (let { from, to } of view.visibleRanges) {
        (0, import_language.syntaxTree)(view.state).iterate({
          from,
          to,
          enter: (node) => {
            var _a;
            const tokenProps = node.type.prop(import_language2.tokenClassNodeProp);
            if (tokenProps) {
              const props = new Set(tokenProps.split(" "));
              const isLink = props.has("hmd-internal-link");
              const isAlias = props.has("link-alias");
              const isPipe = props.has("link-alias-pipe");
              const isMDLink = props.has("link");
              const isMDUrl = props.has("url");
              const isMDFormatting = props.has("formatting-link");
              if (isMDLink && !isMDFormatting) {
                mdAliasFrom = node.from;
                mdAliasTo = node.to;
              }
              if (!isPipe && !isAlias) {
                if (iconDecoAfter && iconDecoAfterWhere) {
                  builder.add(iconDecoAfterWhere, iconDecoAfterWhere, iconDecoAfter);
                  iconDecoAfter = null;
                  iconDecoAfterWhere = null;
                }
              }
              if (isLink && !isAlias && !isPipe || isMDUrl) {
                let linkText = view.state.doc.sliceString(node.from, node.to);
                linkText = linkText.split("#")[0];
                let file = plugin.app.metadataCache.getFirstLinkpathDest(linkText, mdView.file.basename);
                if (isMDUrl && !file) {
                  try {
                    file = plugin.app.vault.getAbstractFileByPath(decodeURIComponent(linkText));
                  } catch (e) {
                  }
                }
                if (file) {
                  const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(file.path)) == null ? void 0 : _a.last();
                  if (fileClassName) {
                    const attributes = { "fileclass-name": fileClassName };
                    let deco = import_view.Decoration.mark({
                      attributes,
                      class: "fileclass-text"
                    });
                    iconDecoAfter = import_view.Decoration.widget({
                      widget: new HeaderWidget(fileClassName, true, file.path.replace(/(.*).md/, "$1"))
                    });
                    if (isMDUrl && mdAliasFrom && mdAliasTo) {
                      let deco2 = import_view.Decoration.mark({
                        attributes,
                        class: "fileclass-text"
                      });
                      builder.add(mdAliasFrom, mdAliasTo, deco2);
                      if (iconDecoAfter) {
                        builder.add(mdAliasTo, mdAliasTo, iconDecoAfter);
                        iconDecoAfter = null;
                        iconDecoAfterWhere = null;
                        mdAliasFrom = null;
                        mdAliasTo = null;
                      }
                    }
                    builder.add(node.from, node.to, deco);
                    lastAttributes = attributes;
                    iconDecoAfterWhere = node.to;
                  }
                }
              } else if (isLink && isAlias) {
                let deco = import_view.Decoration.mark({
                  attributes: lastAttributes,
                  class: "fileclass-text"
                });
                builder.add(node.from, node.to, deco);
                if (iconDecoAfter) {
                  builder.add(node.to, node.to, iconDecoAfter);
                  iconDecoAfter = null;
                  iconDecoAfterWhere = null;
                }
              }
            }
          }
        });
      }
      return builder.finish();
    }
  }, {
    decorations: (v) => v.decorations
  });
  return viewPlugin;
}

// src/components/ExtraButton.ts
var ExtraButton = class extends import_obsidian53.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.modalObservers = [];
  }
  onload() {
    this.plugin.registerMarkdownPostProcessor((el, ctx) => {
      updateElLinks(this.plugin.app, this.plugin, el, ctx);
    });
    const ext = import_state2.Prec.lowest(buildCMViewPlugin(this.plugin));
    this.plugin.registerEditorExtension(ext);
    this.plugin.registerMarkdownPostProcessor((el, ctx) => {
      updateElLinks(this.plugin.app, this.plugin, el, ctx);
    });
    const plugin = this.plugin;
    const updateLinks = (_file) => {
      updateVisibleLinks(plugin.app, plugin);
      this.observers.forEach(([observer, type, own_class]) => {
        const leaves = plugin.app.workspace.getLeavesOfType(type);
        leaves.forEach((leaf) => {
          this.updateContainer(leaf.view.containerEl, own_class, type);
        });
      });
    };
    this.observers = [];
    this.plugin.app.workspace.onLayoutReady(() => {
      this.initViewObservers();
      this.initModalObservers(document);
      updateVisibleLinks(this.plugin.app, this.plugin);
    });
    this.registerEvent(this.plugin.app.metadataCache.on("changed", (0, import_obsidian53.debounce)(updateLinks, 500, true)));
    this.registerEvent(this.plugin.app.workspace.on("layout-change", (0, import_obsidian53.debounce)(updateLinks, 10, true)));
    this.registerEvent(this.plugin.app.workspace.on("window-open", (window2, win) => this.initModalObservers(window2.getContainer().doc)));
    this.registerEvent(this.plugin.app.workspace.on("layout-change", () => this.initViewObservers()));
    this.registerEvent(this.plugin.app.workspace.on("metadata-menu:indexed", () => this.reloadObservers()));
  }
  initViewObservers() {
    var _a, _b, _c, _d, _e, _f;
    this.observers.forEach(([observer, type]) => {
      observer.disconnect();
    });
    this.observers = [];
    this.registerViewType("backlink", ".tree-item-inner", true);
    this.registerViewType("outgoing-link", ".tree-item-inner", true);
    this.registerViewType("search", ".tree-item-inner", true);
    this.registerViewType("BC-matrix", ".BC-Link");
    this.registerViewType("BC-ducks", ".internal-link");
    this.registerViewType("BC-tree", "a.internal-link");
    this.registerViewType("graph-analysis", ".internal-link");
    this.registerViewType("starred", ".nav-file-title-content", true);
    this.registerViewType("file-explorer", ".nav-file-title-content", true);
    this.registerViewType("recent-files", ".nav-file-title-content", true);
    if ((_f = (_e = (_d = (_c = (_b = (_a = this.plugin.app) == null ? void 0 : _a.internalPlugins) == null ? void 0 : _b.plugins) == null ? void 0 : _c.backlink) == null ? void 0 : _d.instance) == null ? void 0 : _e.options) == null ? void 0 : _f.backlinkInDocument) {
      this.registerViewType("markdown", ".tree-item-inner", true);
    }
  }
  initModalObservers(doc) {
    var _a;
    const config = {
      subtree: false,
      childList: true,
      attributes: false
    };
    this.modalObservers.push(new MutationObserver((records) => {
      records.forEach((mutation) => {
        if (mutation.type === "childList") {
          mutation.addedNodes.forEach((n) => {
            if ("className" in n && (n.className.includes("modal-container") && this.plugin.settings.enableQuickSwitcher || n.className.includes("suggestion-container") && this.plugin.settings.enableSuggestor)) {
              let selector = ".suggestion-title, .suggestion-note, .another-quick-switcher__item__title, .omnisearch-result__title";
              if (n.className.includes("suggestion-container")) {
                selector = ".suggestion-title, .suggestion-note";
              }
              this.updateContainer(n, selector, null);
              this._watchContainer(null, n, selector);
            }
          });
        }
      });
    }));
    (_a = this.modalObservers.last()) == null ? void 0 : _a.observe(doc.body, config);
  }
  registerViewType(viewTypeName, selector, updateDynamic = false) {
    const leaves = this.plugin.app.workspace.getLeavesOfType(viewTypeName);
    if (leaves.length > 1) {
      for (let i = 0; i < leaves.length; i++) {
        const container = leaves[i].view.containerEl;
        if (updateDynamic) {
          this._watchContainerDynamic(viewTypeName + i, container, selector);
        } else {
          this._watchContainer(viewTypeName + i, container, selector);
        }
      }
    } else if (leaves.length < 1)
      return;
    else {
      const container = leaves[0].view.containerEl;
      this.updateContainer(container, selector, viewTypeName);
      if (updateDynamic) {
        this._watchContainerDynamic(viewTypeName, container, selector);
      } else {
        this._watchContainer(viewTypeName, container, selector);
      }
    }
  }
  updateContainer(container, selector, viewTypeName) {
    var _a, _b;
    const nodes = container.findAll(selector);
    for (let i = 0; i < nodes.length; ++i) {
      const el = nodes[i];
      const isCanvasFileLink = (_b = (_a = el.parentElement) == null ? void 0 : _a.getAttr("data-path")) == null ? void 0 : _b.includes(".canvas");
      if (!isCanvasFileLink) {
        updateDivExtraAttributes(this.plugin.app, this.plugin, el, viewTypeName, "");
      }
    }
  }
  removeFromContainer(container, selector) {
    const nodes = container.findAll(selector);
    for (let i = 0; i < nodes.length; ++i) {
      const el = nodes[i];
      clearExtraAttributes(el);
    }
  }
  _watchContainer(viewType, container, selector) {
    let observer = new MutationObserver((records, _) => {
      this.updateContainer(container, selector, viewType);
    });
    observer.observe(container, { subtree: true, childList: true, attributes: false });
    if (viewType) {
      this.observers.push([observer, viewType, selector]);
    }
  }
  _watchContainerDynamic(viewType, container, selector, ownClass = "tree-item-inner", parent_class = "tree-item") {
    let observer = new MutationObserver((records, _) => {
      records.forEach((mutation) => {
        if (mutation.type === "childList") {
          mutation.addedNodes.forEach((n) => {
            if ("className" in n) {
              if (n.className.includes && typeof n.className.includes === "function" && n.className.includes(parent_class)) {
                const fileDivs = n.getElementsByClassName(ownClass);
                for (let i = 0; i < fileDivs.length; ++i) {
                  const link = fileDivs[i];
                  updateDivExtraAttributes(this.plugin.app, this.plugin, link, viewType, "");
                }
              }
            }
          });
        }
      });
    });
    observer.observe(container, { subtree: true, childList: true, attributes: false });
    this.observers.push([observer, viewType, selector]);
  }
  reloadObservers() {
    this.disconnectObservers();
    this.initModalObservers(document);
    this.initViewObservers();
    updateVisibleLinks(this.plugin.app, this.plugin);
  }
  disconnectObservers() {
    this.observers.forEach(([observer, type, own_class]) => {
      observer.disconnect();
      const leaves = this.plugin.app.workspace.getLeavesOfType(type);
      leaves.forEach((leaf) => {
        this.removeFromContainer(leaf.view.containerEl, own_class);
      });
    });
    for (const observer of this.modalObservers) {
      observer.disconnect();
    }
  }
  onunload() {
    this.disconnectObservers();
  }
};

// src/components/FieldIndex.ts
var import_obsidian56 = require("obsidian");

// src/fileClass/FileClassQuery.ts
var import_obsidian54 = require("obsidian");
var FileClassQuery = class {
  constructor(name = "", id = "", query = "", fileClassName = "") {
    this.name = name;
    this.id = id;
    this.query = query;
    this.fileClassName = fileClassName;
  }
  getResults(api) {
    try {
      return new Function("dv", `return ${this.query}`)(api);
    } catch (error) {
      new import_obsidian54.Notice(`Wrong query for <${this.name}>. Check your settings`);
      return [];
    }
  }
  matchFile(file) {
    const dataview = app.plugins.plugins.dataview;
    if (this.query && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
      try {
        const filesPath = this.getResults(dataview.api).values.map((v) => v.file.path);
        return filesPath.includes(file.path);
      } catch (error) {
        return false;
      }
    } else {
      return false;
    }
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.query = source.query;
    target.fileClassName = source.fileClassName;
  }
};
var FileClassQuery_default = FileClassQuery;

// src/commands/resolveLookups.ts
function resolveLookups(plugin, source = "") {
  var _a, _b;
  const f = plugin.fieldIndex;
  const lookupQueryResults = /* @__PURE__ */ new Map();
  [...f.lookupQueries].forEach(([lookupName, field]) => {
    const queryRelatedDVFiles = new Function("dv", `return ${field.options.dvQueryString}`)(f.dv.api).values;
    lookupQueryResults.set(lookupName, queryRelatedDVFiles);
  });
  [...f.filesLookupAndFormulaFieldsExists].forEach(([filePath, fields]) => {
    fields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((lookupField) => {
      const queryRelatedDVFiles = lookupQueryResults.get(`${lookupField.fileClassName || "presetField"}___${lookupField.name}`) || [];
      const fileRelatedDVFiles = queryRelatedDVFiles.filter((dvFile) => {
        const targetValue = dvFile[lookupField.options.targetFieldName];
        if (Array.isArray(targetValue)) {
          return targetValue.filter((v) => f.dv.api.value.isLink(v)).map((v) => v.path).includes(filePath);
        } else {
          return (targetValue == null ? void 0 : targetValue.path) === filePath;
        }
      });
      const relatedFieldName = `${filePath}__related__${lookupField.fileClassName || "presetField"}___${lookupField.name}`;
      const existingFileLookupFields = f.fileLookupFiles.get(relatedFieldName);
      f.fileLookupFiles.set(relatedFieldName, fileRelatedDVFiles);
      if (!(f.fileLookupFieldsStatus.get(`${filePath}__${lookupField.name}`) === "changed" /* changed */))
        f.previousFileLookupFilesValues.set(relatedFieldName, (existingFileLookupFields || fileRelatedDVFiles).length);
      f.fileLookupFieldsStatus.set(`${filePath}__${lookupField.name}`, "changed" /* changed */);
    });
  });
  for (let id of f.fileLookupFiles.keys()) {
    const matchRegex = new RegExp("(?<filePath>.*)__related__(?<fileClassName>.*)___(?<fieldName>.*)");
    const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
    const existingLookFieldWithNameAndFileClassName = (_b = f.filesFields.get(filePath)) == null ? void 0 : _b.find((field) => field.name === fieldName && (field.fileClassName === void 0 && fileClassName === "presetField" || field.fileClassName === fileClassName));
    const dvPage = f.dv.api.page(filePath);
    if (dvPage === void 0 || dvPage[fieldName] === void 0 || !existingLookFieldWithNameAndFileClassName) {
      f.fileLookupFiles.delete(id);
      f.fileLookupFieldLastValue.delete(id);
      f.fileLookupFieldLastOutputType.delete(id);
      f.previousFileLookupFilesValues.delete(id);
      f.fileLookupFieldsStatus.delete(`${filePath}__${fieldName}`);
    }
  }
}

// src/commands/updateCanvas.ts
var import_obsidian55 = require("obsidian");
function updateCanvas(plugin, forceUpdateOne) {
  return __async(this, null, function* () {
    var _a;
    const start2 = Date.now();
    const f = plugin.fieldIndex;
    const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    const canvases = forceUpdateOne ? [forceUpdateOne.canvas] : plugin.app.vault.getFiles().filter((t) => t.extension === "canvas");
    const isNodeInGroup = (node, group) => {
      const { x: x1, y: y1, width: w1, height: h1 } = node;
      const { x: x2, y: y2, width: w2, height: h2 } = group;
      return x2 <= x1 && y2 <= y1 && x2 + w2 >= x1 + w1 && y2 + h2 >= y1 + h1;
    };
    const orientedEdges = (direction, edges, node) => {
      switch (direction) {
        case "incoming":
          return edges.filter((edge) => edge.toNode === node.id);
        case "outgoing":
          return edges.filter((edge) => edge.fromNode === node.id);
        case "bothsides":
          return edges.filter((edge) => edge.fromNode === node.id || edge.toNode === node.id);
        default:
          return [];
      }
    };
    const targetNode = (direction, edge, nodes, currentNode) => {
      switch (direction) {
        case "incoming":
          return nodes.find((node) => node.id !== currentNode.id && node.id === edge.fromNode);
        case "outgoing":
          return nodes.find((node) => node.id !== currentNode.id && node.id === edge.toNode);
        case "bothsides":
          return nodes.find((node) => node.id !== currentNode.id && (node.id === edge.toNode || node.id === edge.fromNode));
        default:
          return void 0;
      }
    };
    const resolveFieldLinksForNode = (field, targetFilePath, edges, nodes, node, cumulativeSet) => {
      const { nodeColors, edgeColors, edgeFromSides, edgeToSides, edgeLabels, filesFromDVQuery, direction } = field.options;
      const matchingFiles = filesFromDVQuery ? new Function("dv", "current", `return ${filesFromDVQuery}`)(dvApi, dvApi.page(targetFilePath)) : void 0;
      const matchingEdges = orientedEdges(direction, edges, node);
      const linkNodes = matchingEdges.filter((edge) => !edgeLabels || edgeLabels.length === 0 || edgeLabels.includes(edge.label)).filter((edge) => !edgeColors || edgeColors.length === 0 || !edge.color && edgeColors.includes("0") || edgeColors.includes(edge.color)).filter((edge) => !edgeFromSides || edgeFromSides.length === 0 || edgeFromSides.includes(edge.fromSide)).filter((edge) => !edgeToSides || edgeToSides.length === 0 || edgeToSides.includes(edge.toSide)).map((edge) => targetNode(direction, edge, nodes, node)).filter((node2) => !!node2 && node2.type === "file").filter((node2) => !nodeColors || nodeColors.length === 0 || !node2.color && nodeColors.includes("0") || nodeColors.includes(node2.color)).filter((node2) => {
        return matchingFiles === void 0 || matchingFiles.map((f2) => f2.file.path).includes(node2.file);
      });
      const uniqueLinkNodes = [...new Map(linkNodes.map((link) => [link.file, link])).values()];
      cumulativeSet.set(field.name, [
        ...cumulativeSet.get(field.name) || [],
        ...uniqueLinkNodes.filter((link) => {
          var _a2;
          return !((_a2 = cumulativeSet.get(field.name)) == null ? void 0 : _a2.map((link2) => link2.id).includes(link.id));
        })
      ]);
    };
    const filterGroupsForField = (field, canvasGroups, node) => {
      const { groupColors, groupLabels } = field.options;
      const groupNodes = canvasGroups.filter((group) => !groupColors || groupColors.length === 0 || !group.color && groupColors.includes("0") || groupColors.includes(group.color)).filter((group) => !groupLabels || groupLabels.length === 0 || groupLabels.includes(group.label)).filter((group) => isNodeInGroup(node, group));
      return groupNodes;
    };
    const resolveFieldGroupsForNode = (field, canvasGroups, node, cumulatedGroupsFields) => {
      const groupNodes = filterGroupsForField(field, canvasGroups, node);
      cumulatedGroupsFields.set(field.name, [
        ...cumulatedGroupsFields.get(field.name) || [],
        ...groupNodes.filter((group) => {
          var _a2;
          return !((_a2 = cumulatedGroupsFields.get(field.name)) == null ? void 0 : _a2.map((group2) => group2.id).includes(group.id));
        })
      ]);
    };
    canvases.forEach((canvas) => __async(this, null, function* () {
      const previousFilesPaths = plugin.fieldIndex.canvasLastFiles.get(canvas.path) || [];
      const currentFilesPaths = [];
      let { nodes, edges } = { nodes: [], edges: [] };
      const rawContent = yield plugin.app.vault.read(canvas);
      if (rawContent) {
        try {
          const canvasContent = JSON.parse(rawContent);
          nodes = canvasContent.nodes;
          edges = canvasContent.edges;
        } catch (error) {
          console.log(error);
          new import_obsidian55.Notice(`Couldn't read ${canvas.path}`);
        }
      }
      const canvasGroups = nodes.filter((node) => node.type === "group");
      const currentFiles = /* @__PURE__ */ new Map();
      nodes.forEach((node) => __async(this, null, function* () {
        if (node.type === "file" && dvApi) {
          const { cumulatedLinksFields, cumulatedGroupsFields, cumulatedGroupsLinksFields } = currentFiles.get(node.file) || {
            cumulatedGroupsFields: /* @__PURE__ */ new Map(),
            cumulatedLinksFields: /* @__PURE__ */ new Map(),
            cumulatedGroupsLinksFields: /* @__PURE__ */ new Map()
          };
          const targetFilePath = node.file;
          if (!currentFilesPaths.includes(targetFilePath))
            currentFilesPaths.push(targetFilePath);
          const fileFields2 = f.filesFields.get(targetFilePath);
          const linksFields = fileFields2 == null ? void 0 : fileFields2.filter((field) => field.type === "Canvas" /* Canvas */ && field.options.canvasPath === canvas.path);
          const groupsFields = fileFields2 == null ? void 0 : fileFields2.filter((field) => field.type === "CanvasGroup" /* CanvasGroup */ && field.options.canvasPath === canvas.path);
          const groupsLinksFields = fileFields2 == null ? void 0 : fileFields2.filter((field) => field.type === "CanvasGroupLink" /* CanvasGroupLink */ && field.options.canvasPath === canvas.path);
          linksFields == null ? void 0 : linksFields.forEach((field) => {
            resolveFieldLinksForNode(field, targetFilePath, edges, nodes, node, cumulatedLinksFields);
          });
          groupsFields == null ? void 0 : groupsFields.forEach((field) => {
            resolveFieldGroupsForNode(field, canvasGroups, node, cumulatedGroupsFields);
          });
          groupsLinksFields == null ? void 0 : groupsLinksFields.forEach((field) => {
            const groupNodes = filterGroupsForField(field, canvasGroups, node);
            groupNodes.forEach((node2) => {
              resolveFieldLinksForNode(field, targetFilePath, edges, nodes, node2, cumulatedGroupsLinksFields);
            });
            if (groupNodes.length === 0) {
              cumulatedGroupsLinksFields.set(field.name, [...cumulatedGroupsLinksFields.get(field.name) || []]);
            }
          });
          currentFiles.set(node.file, {
            cumulatedLinksFields,
            cumulatedGroupsFields,
            cumulatedGroupsLinksFields
          });
        }
      }));
      currentFiles.forEach((_0, _1) => __async(this, [_0, _1], function* ({ cumulatedLinksFields, cumulatedGroupsFields, cumulatedGroupsLinksFields }, filePath) {
        const file = app.vault.getAbstractFileByPath(filePath);
        if (file && file instanceof import_obsidian55.TFile) {
          const payload = [];
          cumulatedLinksFields.forEach((linkNodes, name) => {
            const values = linkNodes.map((node) => FieldManager2.buildMarkDownLink(plugin, file, node.file, node.subpath));
            payload.push({ name, payload: { value: values ? [...new Set(values)].join(",") : "" } });
          });
          cumulatedGroupsFields.forEach((groupNodes, name) => {
            const values = groupNodes.map((group) => group.label);
            payload.push({ name, payload: { value: values ? [...new Set(values.filter((v) => !!v))].join(",") : "" } });
          });
          cumulatedGroupsLinksFields.forEach((linkNodes, name) => {
            const values = linkNodes.map((node) => FieldManager2.buildMarkDownLink(plugin, file, node.file, node.subpath));
            payload.push({ name, payload: { value: values ? [...new Set(values)].join(",") : "" } });
          });
          if (payload.length)
            yield postValues(plugin, payload, file);
        }
      }));
      previousFilesPaths.filter((f2) => !currentFilesPaths.includes(f2)).forEach((filePath) => __async(this, null, function* () {
        var _a2, _b, _c;
        const targetFile = app.vault.getAbstractFileByPath(filePath);
        if (targetFile && targetFile instanceof import_obsidian55.TFile) {
          const payload = [];
          const canvasFields = (_a2 = f.filesFields.get(filePath)) == null ? void 0 : _a2.filter((field) => field.type === "Canvas" /* Canvas */ && field.options.canvasPath === canvas.path);
          canvasFields == null ? void 0 : canvasFields.forEach((field) => {
            payload.push({ name: field.name, payload: { value: "" } });
          });
          const canvasGroupFields = (_b = f.filesFields.get(filePath)) == null ? void 0 : _b.filter((field) => field.type === "CanvasGroup" /* CanvasGroup */ && field.options.canvasPath === canvas.path);
          canvasGroupFields == null ? void 0 : canvasGroupFields.forEach((field) => {
            payload.push({ name: field.name, payload: { value: "" } });
          });
          const canvasGroupLinksFields = (_c = f.filesFields.get(filePath)) == null ? void 0 : _c.filter((field) => field.type === "CanvasGroupLink" /* CanvasGroupLink */ && field.options.canvasPath === canvas.path);
          canvasGroupLinksFields == null ? void 0 : canvasGroupLinksFields.forEach((field) => {
            payload.push({ name: field.name, payload: { value: "" } });
          });
          if (payload.length)
            yield postValues(plugin, payload, targetFile);
        }
      }));
      plugin.fieldIndex.canvasLastFiles.set(canvas.path, currentFilesPaths);
    }));
  });
}

// src/components/FieldIndex.ts
var FieldIndex = class extends import_obsidian56.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.fileChanged = false;
    this.dvReady = false;
    this.firstIndexingDone = false;
    this.flushCache();
    this.fileLookupFiles = /* @__PURE__ */ new Map();
    this.fileLookupFieldLastValue = /* @__PURE__ */ new Map();
    this.fileLookupFieldsStatus = /* @__PURE__ */ new Map();
    this.fileFormulaFieldsStatus = /* @__PURE__ */ new Map();
    this.previousFileLookupFilesValues = /* @__PURE__ */ new Map();
    this.fileLookupFieldLastOutputType = /* @__PURE__ */ new Map();
    this.fileFormulaFieldLastValue = /* @__PURE__ */ new Map();
    this.canvasLastFiles = /* @__PURE__ */ new Map();
    this.dv = this.plugin.app.plugins.plugins.dataview;
    this.classFilesPath = plugin.settings.classFilesPath;
  }
  onload() {
    return __async(this, null, function* () {
      var _a;
      this.loadTime = Date.now();
      yield (() => __async(this, null, function* () {
      }))();
      if ((_a = this.dv) == null ? void 0 : _a.api.index.initialized) {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.lastRevision = this.dv.api.index.revision;
        this.dvReady = true;
        yield this.fullIndex("dv is running", false);
      }
      this.registerEvent(this.plugin.app.metadataCache.on("dataview:index-ready", () => __async(this, null, function* () {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.dvReady = true;
        yield this.fullIndex("dv index", false);
        this.lastRevision = this.dv.api.index.revision;
      })));
      this.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        var _a2;
        if (this.plugin.app.metadataCache.inProgressTaskCount === 0) {
          this.fileChanged = true;
          yield this.fullIndex("cache resolved", false, true);
          this.lastRevision = ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) || 0;
        }
      })));
      this.registerEvent(this.plugin.app.vault.on("modify", (file) => __async(this, null, function* () {
        if (file instanceof import_obsidian56.TFile && file.extension === "canvas") {
          yield updateCanvas(this.plugin, { canvas: file });
        }
      })));
      this.registerEvent(this.plugin.app.metadataCache.on("dataview:metadata-change", (op, file) => __async(this, null, function* () {
        var _a2, _b, _c;
        if (op === "update" && this.plugin.app.metadataCache.fileCache[file.path].mtime >= this.loadTime && ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) !== this.lastRevision && this.fileChanged && this.dvReady) {
          cleanRemovedFormulasFromIndex(this.plugin);
          this.getFilesLookupAndFormulaFieldsExists(file);
          if (this.classFilesPath && file.path.startsWith(this.classFilesPath)) {
            yield this.fullIndex("fileClass changed");
            const fileClassName = (_b = this.fileClassesPath.get(file.path)) == null ? void 0 : _b.name;
            const canvasFields = fileClassName && ((_c = this.fileClassesFields.get(fileClassName)) == null ? void 0 : _c.filter((field) => field.type === "Canvas" /* Canvas */)) || [];
            canvasFields.forEach((field) => __async(this, null, function* () {
              const canvasFile = this.plugin.app.vault.getAbstractFileByPath(field.options.canvasPath);
              if (canvasFile instanceof import_obsidian56.TFile && canvasFile.extension === "canvas") {
                yield updateCanvas(this.plugin, { canvas: canvasFile });
              }
            }));
          } else {
            yield this.updateFormulas(false);
            this.resolveLookups(false);
            const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, file.path);
            yield this.updateLookups(fileClassName, false, false);
          }
          this.lastRevision = this.dv.api.index.revision;
        }
      })));
      this.plugin.app.workspace.trigger("metadata-menu:indexed");
    });
  }
  flushCache() {
    this.filesFields = /* @__PURE__ */ new Map();
    this.filesLookupsAndFormulasFields = /* @__PURE__ */ new Map();
    this.filesLookupAndFormulaFieldsExists = /* @__PURE__ */ new Map();
    this.fileClassesFields = /* @__PURE__ */ new Map();
    this.fieldsFromGlobalFileClass = [];
    this.filesFieldsFromTags = /* @__PURE__ */ new Map();
    this.filesFieldsFromFileClassQueries = /* @__PURE__ */ new Map();
    this.filesFieldsFromInnerFileClasses = /* @__PURE__ */ new Map();
    this.fileClassesPath = /* @__PURE__ */ new Map();
    this.fileClassesName = /* @__PURE__ */ new Map();
    this.fileClassesAncestors = /* @__PURE__ */ new Map();
    this.valuesListNotePathValues = /* @__PURE__ */ new Map();
    this.tagsMatchingFileClasses = /* @__PURE__ */ new Map();
    this.filesFileClasses = /* @__PURE__ */ new Map();
    this.filesFileClassesNames = /* @__PURE__ */ new Map();
    this.lookupQueries = /* @__PURE__ */ new Map();
  }
  fullIndex(event, force_update_all = false, without_lookups = false) {
    return __async(this, null, function* () {
      let start2 = Date.now(), time = Date.now();
      this.flushCache();
      this.getFileClassesAncestors();
      this.getGlobalFileClass();
      this.getFileClasses();
      this.getLookupQueries();
      this.resolveFileClassMatchingTags();
      this.resolveFileClassQueries();
      this.getFilesFieldsFromFileClass();
      this.getFilesFields();
      this.getFilesLookupAndFormulaFieldsExists();
      yield this.getCanvasesFiles();
      yield this.getValuesListNotePathValues();
      this.resolveLookups(without_lookups);
      yield this.updateLookups("full Index", without_lookups, force_update_all);
      if (force_update_all || !this.firstIndexingDone)
        yield this.updateFormulas(force_update_all);
      this.firstIndexingDone = true;
      this.plugin.app.workspace.trigger("metadata-menu:updated-index");
    });
  }
  resolveLookups(without_lookups) {
    if (!without_lookups)
      resolveLookups(this.plugin);
  }
  getCanvasesFiles() {
    return __async(this, null, function* () {
      const canvases = this.plugin.app.vault.getFiles().filter((t) => t.extension === "canvas");
      canvases.forEach((canvas) => __async(this, null, function* () {
        const currentFilesPaths = [];
        let { nodes, edges } = { nodes: [], edges: [] };
        const rawContent = yield this.plugin.app.vault.read(canvas);
        if (rawContent) {
          try {
            const canvasContent = JSON.parse(rawContent);
            nodes = canvasContent.nodes;
            edges = canvasContent.edges;
          } catch (error) {
            console.log(error);
            new import_obsidian56.Notice(`Couldn't read ${canvas.path}`);
          }
        }
        nodes == null ? void 0 : nodes.forEach((node) => __async(this, null, function* () {
          if (node.type === "file") {
            const targetFilePath = node.file;
            if (!currentFilesPaths.includes(targetFilePath))
              currentFilesPaths.push(targetFilePath);
          }
        }));
        this.canvasLastFiles.set(canvas.path, currentFilesPaths);
      }));
    });
  }
  updateLookups(source = "", without_lookups, force_update_all) {
    return __async(this, null, function* () {
      if (!without_lookups) {
        if (force_update_all) {
          yield updateLookups(this.plugin, source, void 0, true);
        } else {
          yield updateLookups(this.plugin, source);
        }
      }
    });
  }
  updateFormulas(force_update_all) {
    return __async(this, null, function* () {
      yield updateFormulas(this.plugin, void 0, force_update_all);
    });
  }
  getValuesListNotePathValues() {
    return __async(this, null, function* () {
      this.fileClassesName.forEach((fileClass) => {
        fileClass.attributes.forEach((attr) => __async(this, null, function* () {
          if (typeof attr.options === "object" && !!attr.options["valuesListNotePath"]) {
            this.valuesListNotePathValues.set(attr.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, attr.options.valuesListNotePath));
          }
        }));
      });
      this.plugin.settings.presetFields.forEach((setting) => __async(this, null, function* () {
        if (setting.options.valuesListNotePath) {
          this.valuesListNotePathValues.set(setting.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, setting.options.valuesListNotePath));
        }
      }));
    });
  }
  getFileClassesAncestors() {
    const classFilesPath = this.plugin.settings.classFilesPath;
    if (classFilesPath) {
      this.plugin.app.vault.getMarkdownFiles().filter((f) => f.path.includes(classFilesPath)).forEach((f) => {
        var _a, _b;
        const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, f.path);
        if (fileClassName) {
          const parent = (_b = (_a = this.plugin.app.metadataCache.getFileCache(f)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.extends;
          if (parent) {
            const parentFile = this.plugin.app.vault.getAbstractFileByPath(`${classFilesPath}${parent}.md`);
            if (parentFile) {
              this.fileClassesAncestors.set(fileClassName, [parent]);
            } else {
              this.fileClassesAncestors.set(fileClassName, []);
            }
          } else {
            this.fileClassesAncestors.set(fileClassName, []);
          }
        }
      });
    }
    [...this.fileClassesAncestors].forEach(([fileClassName, ancestors]) => {
      if (ancestors.length > 0) {
        this.getAncestorsRecursively(fileClassName);
      }
    });
  }
  getAncestorsRecursively(fileClassName) {
    var _a;
    const ancestors = this.fileClassesAncestors.get(fileClassName);
    if (ancestors && ancestors.length) {
      const lastAncestor = ancestors.last();
      const lastAncestorParent = (_a = this.fileClassesAncestors.get(lastAncestor)) == null ? void 0 : _a[0];
      if (lastAncestorParent && lastAncestorParent !== fileClassName) {
        this.fileClassesAncestors.set(fileClassName, [...ancestors, lastAncestorParent]);
        this.getAncestorsRecursively(fileClassName);
      }
    }
  }
  getGlobalFileClass() {
    const globalFileClass = this.plugin.settings.globalFileClass;
    if (!globalFileClass) {
      this.fieldsFromGlobalFileClass = [];
    } else {
      try {
        this.fieldsFromGlobalFileClass = FileClass.createFileClass(this.plugin, globalFileClass).attributes.map((attr) => attr.getField());
      } catch (error) {
      }
    }
  }
  getFileClasses() {
    const classFilesPath = this.classFilesPath;
    if (classFilesPath) {
      this.plugin.app.vault.getMarkdownFiles().filter((f) => f.path.includes(classFilesPath)).forEach((f) => {
        var _a, _b, _c;
        const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, f.path);
        if (fileClassName) {
          try {
            const fileClass = FileClass.createFileClass(this.plugin, fileClassName);
            this.fileClassesFields.set(fileClassName, fileClass.attributes.map((attr) => attr.getField()));
            this.fileClassesPath.set(f.path, fileClass);
            this.fileClassesName.set(fileClass.name, fileClass);
            const cache = this.plugin.app.metadataCache.getFileCache(f);
            if ((_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a.mapWithTag) {
              if ((_b = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _b.tagNames) {
                const _tagNames = (_c = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _c.tagNames;
                const tagNames = Array.isArray(_tagNames) ? [..._tagNames] : _tagNames.split(",").map((t) => t.trim());
                tagNames.forEach((tag) => {
                  if (!tag.includes(" ")) {
                    this.tagsMatchingFileClasses.set(tag, fileClass);
                  }
                });
              } else if (!fileClassName.includes(" ")) {
                this.tagsMatchingFileClasses.set(fileClassName, fileClass);
              }
            }
          } catch (error) {
          }
        }
      });
    }
  }
  getLookupQueries() {
    this.plugin.settings.presetFields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((field) => {
      this.lookupQueries.set(`presetField___${field.name}`, field);
    });
    [...this.fileClassesFields].forEach(([fileClassName, fields]) => {
      fields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((field) => {
        this.lookupQueries.set(`${fileClassName}___${field.name}`, field);
      });
    });
  }
  resolveFileClassMatchingTags() {
    if (![...this.tagsMatchingFileClasses].length)
      return;
    const mappedTags = [...this.tagsMatchingFileClasses.keys()];
    const filesWithMappedTagQuery = mappedTags.map((t) => `#${t}`).join(" or ");
    this.dv.api.pages(filesWithMappedTagQuery).forEach((dvFile) => {
      dvFile.file.tags.forEach((_tag) => {
        const tag = _tag.replace(/^\#/, "");
        const fileClass = this.tagsMatchingFileClasses.get(tag);
        const filePath = dvFile.file.path;
        if (fileClass) {
          this.filesFileClasses.set(filePath, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(filePath) || [], fileClass])]);
          this.filesFileClassesNames.set(dvFile.file.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(filePath) || [], fileClass.name])]);
          const fileFileClassesFieldsFromTag = this.fileClassesFields.get(fileClass.name);
          const currentFields = this.filesFieldsFromTags.get(filePath);
          if (fileFileClassesFieldsFromTag) {
            const newFields = [...fileFileClassesFieldsFromTag];
            const filteredCurrentFields = (currentFields == null ? void 0 : currentFields.filter((field) => {
              var _a, _b;
              return !newFields.map((f) => f.name).includes(field.name) && !((_b = (_a = fileClass.options) == null ? void 0 : _a.excludes) == null ? void 0 : _b.map((attr) => attr.name).includes(field.name));
            })) || [];
            newFields.push(...filteredCurrentFields);
            this.filesFieldsFromTags.set(filePath, newFields);
          }
        }
      });
    });
  }
  resolveFileClassQueries() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    this.plugin.settings.fileClassQueries.forEach((sfcq) => {
      const fcq = new FileClassQuery_default(sfcq.name, sfcq.id, sfcq.query, sfcq.fileClassName);
      fcq.getResults(dvApi).forEach((result) => {
        const fileClass = this.fileClassesName.get(fcq.fileClassName);
        if (fileClass) {
          const f = result.file;
          this.filesFileClasses.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(f.path) || [], fileClass])]);
          this.filesFileClassesNames.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(f.path) || [], fileClass.name])]);
        }
        const fileFileClassesFieldsFromQuery = this.fileClassesFields.get(fcq.fileClassName);
        if (fileFileClassesFieldsFromQuery)
          this.filesFieldsFromFileClassQueries.set(result.file.path, fileFileClassesFieldsFromQuery);
      });
    });
  }
  getFilesFieldsFromFileClass() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.classFilesPath || !f.path.includes(this.classFilesPath)).forEach((f) => {
      var _a, _b;
      const fileFileClassesNames = [];
      const fileClassesCache = (_b = (_a = this.plugin.app.metadataCache.getFileCache(f)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b[this.plugin.settings.fileClassAlias];
      if (fileClassesCache) {
        Array.isArray(fileClassesCache) ? fileFileClassesNames.push(...fileClassesCache) : fileFileClassesNames.push(...fileClassesCache.split(",").map((fcn) => fcn.trim()));
        fileFileClassesNames.forEach((fileFileClassName) => {
          const fileClass = this.fileClassesName.get(fileFileClassName);
          if (fileClass) {
            this.filesFileClasses.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(f.path) || [], fileClass])]);
            this.filesFileClassesNames.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(f.path) || [], fileClass.name])]);
            const fileClassesFieldsFromFile = this.fileClassesFields.get(fileFileClassName);
            const currentFields = this.filesFieldsFromInnerFileClasses.get(f.path);
            if (fileClassesFieldsFromFile) {
              const newFields = [...fileClassesFieldsFromFile];
              const filteredCurrentFields = (currentFields == null ? void 0 : currentFields.filter((field) => {
                var _a2, _b2;
                return !newFields.map((f2) => f2.name).includes(field.name) && !((_b2 = (_a2 = fileClass.options) == null ? void 0 : _a2.excludes) == null ? void 0 : _b2.map((attr) => attr.name).includes(field.name));
              })) || [];
              newFields.push(...filteredCurrentFields);
              this.filesFieldsFromInnerFileClasses.set(f.path, newFields);
            } else {
              this.filesFieldsFromInnerFileClasses.set(f.path, []);
            }
          } else {
            this.filesFieldsFromInnerFileClasses.set(f.path, []);
          }
        });
      } else {
        this.filesFieldsFromInnerFileClasses.set(f.path, []);
      }
    });
  }
  isLookupOrFormula(field) {
    return ["Lookup" /* Lookup */, "Formula" /* Formula */].includes(field.type);
  }
  getFilesFields() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.classFilesPath || !f.path.includes(this.classFilesPath)).forEach((f) => {
      const fileFieldsFromInnerFileClasses = this.filesFieldsFromInnerFileClasses.get(f.path);
      const fileFieldsFromQuery = this.filesFieldsFromFileClassQueries.get(f.path);
      const fileFieldsFromTag = this.filesFieldsFromTags.get(f.path);
      if ((fileFieldsFromInnerFileClasses == null ? void 0 : fileFieldsFromInnerFileClasses.length) || (fileFieldsFromQuery == null ? void 0 : fileFieldsFromQuery.length) || (fileFieldsFromTag == null ? void 0 : fileFieldsFromTag.length)) {
        const filesFields = fileFieldsFromInnerFileClasses || [];
        filesFields.push(...(fileFieldsFromTag || []).filter((field) => !filesFields.map((f2) => f2.name).includes(field.name)));
        filesFields.push(...(fileFieldsFromQuery || []).filter((field) => !filesFields.map((f2) => f2.name).includes(field.name)));
        this.filesFields.set(f.path, filesFields);
        const filesLookupAndFormulasFields = filesFields.filter((f2) => this.isLookupOrFormula(f2));
        filesLookupAndFormulasFields.push(...(fileFieldsFromTag || []).filter((field) => !filesLookupAndFormulasFields.map((f2) => f2.name).includes(field.name) && this.isLookupOrFormula(field)));
        filesLookupAndFormulasFields.push(...(fileFieldsFromQuery || []).filter((field) => !filesLookupAndFormulasFields.map((f2) => f2.name).includes(field.name) && this.isLookupOrFormula(field)));
        if (filesLookupAndFormulasFields.length)
          this.filesLookupsAndFormulasFields.set(f.path, filesLookupAndFormulasFields);
      } else if (this.fieldsFromGlobalFileClass.length) {
        this.filesFields.set(f.path, this.fieldsFromGlobalFileClass);
        const filesLookupAndFormulasFields = this.fieldsFromGlobalFileClass.filter((f2) => this.isLookupOrFormula(f2));
        if (filesLookupAndFormulasFields.length)
          this.filesLookupsAndFormulasFields.set(f.path, this.fieldsFromGlobalFileClass.filter((f2) => this.isLookupOrFormula(f2)));
        this.filesFileClasses.set(f.path, [this.fileClassesName.get(this.plugin.settings.globalFileClass)]);
        this.filesFileClassesNames.set(f.path, [this.plugin.settings.globalFileClass]);
      } else {
        const fields = this.plugin.settings.presetFields.map((prop) => {
          const property = new Field_default();
          return Object.assign(property, prop);
        });
        this.filesFields.set(f.path, fields);
        const filesLookupAndFormulasFields = fields.filter((f2) => this.isLookupOrFormula(f2));
        if (filesLookupAndFormulasFields.length)
          this.filesLookupsAndFormulasFields.set(f.path, fields.filter((f2) => this.isLookupOrFormula(f2)));
      }
    });
  }
  getFilesLookupAndFormulaFieldsExists(file) {
    let fileFields2;
    if (file) {
      fileFields2 = [[file.path, this.filesLookupsAndFormulasFields.get(file.path) || []]];
    } else {
      fileFields2 = [...this.filesLookupsAndFormulasFields];
    }
    fileFields2.forEach(([filePath, fields]) => {
      const dvFile = this.dv.api.page(filePath);
      const existingFields = [];
      fields.filter((f) => ["Lookup" /* Lookup */, "Formula" /* Formula */].includes(f.type)).forEach((field) => {
        if (dvFile && dvFile[field.name] !== void 0) {
          existingFields.push(field);
        }
      });
      if (existingFields.length) {
        this.filesLookupAndFormulaFieldsExists.set(filePath, existingFields);
      } else {
        this.filesLookupAndFormulaFieldsExists.delete(filePath);
      }
    });
  }
};

// src/components/FileTaskManager.ts
var import_obsidian57 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset2 = 0) {
  return (byteToHex[arr[offset2 + 0]] + byteToHex[arr[offset2 + 1]] + byteToHex[arr[offset2 + 2]] + byteToHex[arr[offset2 + 3]] + "-" + byteToHex[arr[offset2 + 4]] + byteToHex[arr[offset2 + 5]] + "-" + byteToHex[arr[offset2 + 6]] + byteToHex[arr[offset2 + 7]] + "-" + byteToHex[arr[offset2 + 8]] + byteToHex[arr[offset2 + 9]] + "-" + byteToHex[arr[offset2 + 10]] + byteToHex[arr[offset2 + 11]] + byteToHex[arr[offset2 + 12]] + byteToHex[arr[offset2 + 13]] + byteToHex[arr[offset2 + 14]] + byteToHex[arr[offset2 + 15]]).toLowerCase();
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options2, buf, offset2) {
  if (native_default.randomUUID && !buf && !options2) {
    return native_default.randomUUID();
  }
  options2 = options2 || {};
  const rnds = options2.random || (options2.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset2 = offset2 || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset2 + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// src/components/FileTaskManager.ts
var Task = class {
  constructor(fn2) {
    this.fn = fn2;
    this.status = "pending";
    this.id = v4_default();
  }
};
var FileTaskManager = class extends import_obsidian57.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.busy = false;
    this.queue = /* @__PURE__ */ new Map();
  }
  onload() {
    return __async(this, null, function* () {
      this.plugin.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        this.busy = false;
        yield this.executeNext();
      })));
      this.plugin.registerEvent(this.plugin.app.vault.on("modify", (file) => __async(this, null, function* () {
        if (file instanceof import_obsidian57.TFile && file.extension === "canvas") {
          this.busy = false;
          yield this.executeNext();
        }
      })));
    });
  }
  pushTask(fn2) {
    return __async(this, null, function* () {
      const task = new Task(fn2);
      this.queue.set(task.id, task);
      if (!this.busy)
        yield this.executeNext();
    });
  }
  executeNext() {
    return __async(this, null, function* () {
      const [firstTaskInQueueId, firstTaskInQueue] = [...this.queue][0] || [void 0, void 0];
      if (firstTaskInQueue && !this.plugin.app.metadataCache.inProgressTaskCount) {
        this.busy = true;
        firstTaskInQueue.status = "ongoing";
        yield firstTaskInQueue.fn();
        firstTaskInQueue.status = "done";
        this.queue.delete(firstTaskInQueueId);
        if (!this.plugin.app.metadataCache.inProgressTaskCount)
          yield this.executeNext();
      } else if (this.plugin.app.metadataCache.inProgressTaskCount) {
      } else {
      }
    });
  }
};

// src/commands/replaceValues.ts
var import_obsidian58 = require("obsidian");
var LocationWrapper2 = {
  "fullLine": { start: "", end: "" },
  "brackets": { start: "[", end: "]" },
  "parenthesis": { start: "(", end: ")" }
};
var matchInlineFields2 = (regex, line, attribute, input, location = "fullLine") => {
  const sR = line.matchAll(regex);
  let next = sR.next();
  const newFields = [];
  while (!next.done) {
    const match = next.value;
    if (match.groups && Object.keys(match.groups).every((j) => fieldComponents.includes(j))) {
      const { inList, inQuote, preSpacer, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = match.groups;
      const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
      const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
      const start2 = LocationWrapper2[location].start;
      const end2 = LocationWrapper2[location].end;
      newFields.push({
        oldField: match[0],
        newField: `${inQuote || ""}${start2}${inList || ""}${preSpacer || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}${end2}`
      });
    }
    next = sR.next();
  }
  return newFields;
};
function replaceValues(plugin, fileOrFilePath, attribute, input, previousItemsCount = 0) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian58.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian58.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.read(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const skippedLines = [];
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const newContent = content.map((line, i) => {
      var _a2;
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`^${attribute}:`, "u");
        const r = line.match(regex);
        if (r && r.length > 0) {
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `[${inputArray.join(", ")}]`;
          return `${attribute}: ${newValue}`;
        } else {
          return line;
        }
      } else {
        const encodedInput = encodeLink(input);
        let encodedLine = encodeLink(line);
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodedLine.match(fullLineRegex2);
        if ((fR == null ? void 0 : fR.groups) && Object.keys(fR.groups).every((j) => fieldComponents.includes(j))) {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((f) => f.name === attribute);
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */) {
            const bounds = getListBounds(plugin, file, i);
            if (bounds) {
              const { start: start3, end: end3 } = bounds;
              for (let j = start3 + 1; j < start3 + previousItemsCount + 1 && j < end3 + 1; j++) {
                skippedLines.push(j);
              }
            }
          }
          const { inList, inQuote, preSpacer, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = fR.groups;
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",").sort() : [];
          let newValue;
          let hiddenValue = "";
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */ && bulletListLookupTypes.includes(field == null ? void 0 : field.options.outputType)) {
            newValue = inputArray.length == 1 ? "\n- " + inputArray[0] : `${inputArray.length > 0 ? "\n" : ""}${inputArray.map((item) => "- " + item).join("\n")}`;
            hiddenValue = `<div hidden id="${field.name}_values">${input}</div>`;
          } else {
            newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          }
          return `${inQuote || ""}${inList || ""}${preSpacer || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${hiddenValue + newValue}`;
        } else {
          const newFields = [];
          const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
          const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
          newFields.push(...matchInlineFields2(inSentenceRegexBrackets2, encodedLine, attribute, encodedInput, "brackets" /* brackets */));
          newFields.push(...matchInlineFields2(inSentenceRegexPar2, encodedLine, attribute, encodedInput, "parenthesis" /* parenthesis */));
          newFields.forEach((field) => {
            const fieldRegex = new RegExp(field.oldField.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "u");
            encodedLine = encodedLine.replace(fieldRegex, field.newField);
          });
          return decodeLink(encodedLine);
        }
      }
    });
    yield plugin.app.vault.modify(file, newContent.filter((line, i) => !skippedLines.includes(i)).join("\n"));
    const editor = (_b = plugin.app.workspace.getActiveViewOfType(import_obsidian58.MarkdownView)) == null ? void 0 : _b.editor;
    if (editor) {
      const lineNumber = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber).length });
    }
  });
}

// src/commands/insertValues.ts
var import_obsidian60 = require("obsidian");

// src/commands/insertFrontmatterWithFields.ts
var import_obsidian59 = require("obsidian");
function insertFrontmatterWithFields(plugin, fileOrFilePath, fields) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrFilePath instanceof import_obsidian59.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian59.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = yield plugin.app.vault.read(file);
    const frontmatter = "---\n" + Object.entries(fields).map(([fieldName, value]) => `${fieldName}: ${value}`).join("\n") + "\n---\n";
    yield plugin.app.vault.modify(file, frontmatter + content);
    const editor = (_a = plugin.app.workspace.getActiveViewOfType(import_obsidian59.MarkdownView)) == null ? void 0 : _a.editor;
    if (editor) {
      const lineNumber = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber).length });
    }
  });
}

// src/commands/insertValues.ts
function insertValues(plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after = true, asList = false, asComment = false) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian60.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian60.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    if (inFrontmatter && lineNumber == -2 && !frontmatter) {
      const fields = {};
      fields[fieldName] = value;
      yield insertFrontmatterWithFields(plugin, file, fields);
    } else {
      const result = yield plugin.app.vault.read(file);
      let newContent = [];
      const targetLineNumber = inFrontmatter && lineNumber == -2 && frontmatter ? frontmatter.position.end.line - 1 : lineNumber;
      result.split("\n").forEach((line, _lineNumber) => {
        if (_lineNumber == targetLineNumber) {
          if (after)
            newContent.push(line);
          const newLine = `${!inFrontmatter && asComment ? ">" : ""}${!inFrontmatter && asList ? "- " : ""}${fieldName}${inFrontmatter ? ":" : "::"} ${value}`;
          newContent.push(newLine);
          if (!after)
            newContent.push(line);
        } else {
          newContent.push(line);
        }
      });
      yield plugin.app.vault.modify(file, newContent.join("\n"));
      const editor = (_b = plugin.app.workspace.getActiveViewOfType(import_obsidian60.MarkdownView)) == null ? void 0 : _b.editor;
      if (editor) {
        const lineNumber2 = editor.getCursor().line;
        editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber2).length });
      }
    }
  });
}

// src/commands/fieldModifier.ts
var import_obsidian61 = require("obsidian");
function buildAndOpenModal(plugin, file, fieldName, attrs) {
  var _a;
  if ((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.inFrontmatter) {
    const lineNumber = -1;
    FieldManager2.openFieldModal(plugin, file, fieldName, "", lineNumber, false, false, false);
  } else {
    new chooseSectionModal(plugin, file, (lineNumber, after, asList, asComment) => FieldManager2.openFieldModal(plugin, file, fieldName, "", lineNumber, after, asList, asComment)).open();
  }
}
function createDvField(plugin, dv, p, fieldContainer, fieldName, attrs) {
  var _a;
  const field = (_a = plugin.fieldIndex.filesFields.get(p.file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
  if (field == null ? void 0 : field.type) {
    const fieldManager = new FieldManager[field.type](plugin, field);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  } else {
    const fieldManager = FieldManager2.createDefault(plugin, fieldName);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  }
}
function fieldModifier(plugin, dv, p, fieldName, attrs) {
  var _a, _b;
  const fieldContainer = dv.el("div", "");
  fieldContainer.setAttr("class", `metadata-menu-dv-field-container ${fieldName}`);
  if (p[fieldName] === void 0) {
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.showAddField)) {
      const emptyField = dv.el("span", null, attrs);
      fieldContainer.appendChild(emptyField);
    } else {
      const addFieldBtn = dv.el("button", attrs);
      (0, import_obsidian61.setIcon)(addFieldBtn, "plus-with-circle");
      addFieldBtn.onclick = () => __async(this, null, function* () {
        var _a2;
        const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian61.TFile && file.extension == "md") {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((field2) => field2.name === fieldName);
          if (field) {
            buildAndOpenModal(plugin, file, fieldName, attrs);
          } else {
            new chooseSectionModal(plugin, file, (lineNumber, after, asList, asComment) => FieldManager2.openFieldModal(plugin, file, void 0, "", lineNumber, after, asList, asComment)).open();
          }
        } else {
          throw Error("path doesn't correspond to a proper file");
        }
      });
      fieldContainer.appendChild(addFieldBtn);
    }
  } else {
    const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
    if (file instanceof import_obsidian61.TFile && file.extension == "md") {
      const field = (_b = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _b.find((field2) => field2.name === fieldName);
      if (field) {
        createDvField(plugin, dv, p, fieldContainer, fieldName, attrs);
      } else {
        const fieldManager = FieldManager2.createDefault(plugin, fieldName);
        fieldManager.createDvField(dv, p, fieldContainer, attrs);
      }
    }
  }
  return fieldContainer;
}

// src/commands/fileFields.ts
var import_obsidian62 = require("obsidian");
var FieldInfo = class {
  constructor() {
    this.type = void 0;
    this.sourceType = void 0;
    this.fileClass = void 0;
    this.options = void 0;
    this.isValid = void 0;
    this.value = "";
    this.valuesListNotePath = void 0;
    this.unique = true;
  }
  setInfos(plugin, file, fieldName, value, matchingFileClassQuery) {
    var _a;
    this.value = value;
    this.ignoreInMenu = plugin.settings.globallyIgnoredFields.includes(fieldName);
    const field = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
    if (field) {
      const fieldManager = new FieldManager[field.type](plugin, field);
      this.isValid = fieldManager.validateValue(value);
      this.fileClass = field.fileClassName;
      this.type = field.type;
      this.options = field.options;
      this.sourceType = field.fileClassName ? "fileClass" : "settings";
    }
  }
};
function fileFields(plugin, fileOrfilePath) {
  var _a;
  let file;
  if (fileOrfilePath instanceof import_obsidian62.TFile) {
    file = fileOrfilePath;
  } else {
    const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
    if (_file instanceof import_obsidian62.TFile && _file.extension == "md") {
      file = _file;
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
  }
  const fields = {};
  const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
  if (dvApi) {
    const dvFile = dvApi.page(file.path);
    try {
      genuineKeys(dvFile).forEach((key) => __async(this, null, function* () {
        if (key !== "file") {
          const fieldInfo = new FieldInfo();
          fieldInfo.unique = !Object.keys(fields).includes(key);
          fields[key] = fieldInfo;
          fieldInfo.setInfos(plugin, file, key, dvFile[key]);
        }
      }));
    } catch (error) {
      throw error;
    }
  }
  return fields;
}

// src/MetadataMenuApi.ts
var MetadataMenuApi = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  make() {
    return {
      getValues: this.getValues(),
      replaceValues: this.replaceValues(),
      insertValues: this.insertValues(),
      fieldModifier: this.fieldModifier(),
      fileFields: this.fileFields(),
      insertMissingFields: this.insertMissingFields(),
      postValues: this.postValues()
    };
  }
  getValues() {
    return (fileOrFilePath, attribute) => __async(this, null, function* () {
      return getValues(this.plugin, fileOrFilePath, attribute);
    });
  }
  replaceValues() {
    return (fileOrFilePath, attribute, input) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        console.info("replaceValues is deprecated, use postValues instead");
        replaceValues(this.plugin, fileOrFilePath, attribute, `${input}`);
      });
    });
  }
  insertValues() {
    return (fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        console.info("insertValues is deprecated, use postValues instead");
        insertValues(this.plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment);
      });
    });
  }
  fieldModifier() {
    return (dv, p, fieldName, attrs) => fieldModifier(this.plugin, dv, p, fieldName, attrs);
  }
  fileFields() {
    return (fileOrFilePath) => __async(this, null, function* () {
      return fileFields(this.plugin, fileOrFilePath);
    });
  }
  insertMissingFields() {
    return (fileOrFilePath, lineNumber, after, asList, asComment, fileClassName) => __async(this, null, function* () {
      return insertMissingFields(this.plugin, fileOrFilePath, lineNumber, after, asList, asComment, fileClassName);
    });
  }
  postValues() {
    return (fileOrFilePath, payload, lineNumber, after, asList, asComment) => __async(this, null, function* () {
      return postValues(this.plugin, payload, fileOrFilePath, lineNumber, after, asList, asComment);
    });
  }
};

// src/settings/MetadataMenuSettings.ts
var DEFAULT_SETTINGS = {
  presetFields: [],
  fileClassQueries: [],
  displayFieldsInContextMenu: true,
  globallyIgnoredFields: [],
  classFilesPath: null,
  isAutosuggestEnabled: true,
  fileClassAlias: "fileClass",
  settingsVersion: void 0,
  globalFileClass: void 0,
  firstDayOfWeek: 1,
  enableLinks: true,
  enableTabHeader: true,
  enableEditor: true,
  enableBacklinks: true,
  enableStarred: true,
  enableFileExplorer: true,
  enableSearch: true,
  buttonIcon: "clipboard-list",
  tableViewMaxRecords: 100,
  frontmatterListDisplay: "asArray" /* asArray */
};

// src/settings/MetadataMenuSettingTab.ts
var import_obsidian66 = require("obsidian");

// src/suggester/FolderSuggester.ts
var import_obsidian63 = require("obsidian");
var FolderSuggest = class extends TextInputSuggest {
  constructor(plugin, inputEl) {
    super(inputEl);
    this.plugin = plugin;
    this.inputEl = inputEl;
  }
  getSuggestions(inputStr) {
    const abstractFiles = this.plugin.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = inputStr.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian63.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/settings/FileClassQuerySettingModal.ts
var import_obsidian65 = require("obsidian");

// src/settings/FileClassQuerySetting.ts
var import_obsidian64 = require("obsidian");
var FileClassQuerySetting = class extends import_obsidian64.Setting {
  constructor(containerEl, property, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.plugin = plugin;
    this.fileClassQuery = property;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
    this.addMoveUpButton();
    this.settingEl.addClass("no-border");
  }
  setTextContentWithname() {
    this.infoEl.textContent = "";
    this.infoEl.addClass("setting-item");
    const fileClassQueryContainer = this.infoEl.createDiv();
    const nameContainer = fileClassQueryContainer.createEl("div", "name");
    nameContainer.innerHTML = `<strong>${this.fileClassQuery.name}</strong>`;
    const fileClassNameContainer = fileClassQueryContainer.createEl("div");
    fileClassNameContainer.innerHTML = `<span>FileClass</span> : ${this.fileClassQuery.fileClassName}`;
    const queryContainer = fileClassQueryContainer.createEl("div");
    queryContainer.innerHTML = `<span>Query</span> : ${this.fileClassQuery.query}`;
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FileClassQuerySettingsModal(this.plugin, this.containerEl, this, this.fileClassQuery);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.find((p) => p.id == this.fileClassQuery.id);
        if (currentExistingFileClassQuery) {
          this.plugin.initialFileClassQueries.remove(currentExistingFileClassQuery);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  addMoveUpButton() {
    this.addButton((b) => {
      b.setIcon("up-chevron-glyph").setTooltip("Move up (lower priority)").onClick(() => {
        const currentFileClassQueryIndex = this.plugin.initialFileClassQueries.map((fcq) => fcq.id).indexOf(this.fileClassQuery.id);
        if (currentFileClassQueryIndex > 0) {
          this.containerEl.insertBefore(this.settingEl, this.settingEl.previousElementSibling);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex, 1);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex - 1, 0, this.fileClassQuery);
          this.plugin.saveSettings();
        }
      });
    });
  }
};

// src/settings/FileClassQuerySettingModal.ts
var FileClassQuerySettingsModal = class extends import_obsidian65.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, fileClassQuery) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialFileClassQuery = new FileClassQuery_default();
    if (fileClassQuery) {
      this.new = false;
      this.fileClassQuery = fileClassQuery;
      FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
    } else {
      let newId = 1;
      this.plugin.initialFileClassQueries.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.fileClassQuery = new FileClassQuery_default();
      this.fileClassQuery.id = newId.toString();
      this.initialFileClassQuery.id = newId.toString();
    }
    ;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.fileClassQuery.name == "") {
        this.titleEl.setText(`Select a fileClass and add an applicable query`);
      } else {
        this.titleEl.setText(`Manage ${this.fileClassQuery.name} settings`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.fileClassQuery, this.initialFileClassQuery);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FileClassQuerySetting(this.parentSettingContainer, this.fileClassQuery, this.plugin);
    }
    ;
  }
  createnameInputContainer(container) {
    container.createDiv({ cls: "label", text: `FileClass Query Name:` });
    const input = new import_obsidian65.TextComponent(container);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    const name = this.fileClassQuery.name;
    input.setValue(name);
    input.setPlaceholder("Name of this fileClass query");
    input.onChange((value) => {
      this.fileClassQuery.name = value;
      this.titleEl.setText(`Manage options for ${this.fileClassQuery.name}`);
    });
    return input;
  }
  createFileClassSelectorContainer(container) {
    container.createDiv({ cls: "label", text: `Fileclass:` });
    container.createDiv({ cls: "spacer" });
    const select = new import_obsidian65.DropdownComponent(container);
    const classFilesPath = this.plugin.settings.classFilesPath;
    const fileClasses = this.plugin.app.vault.getFiles().filter((f) => classFilesPath && f.path.startsWith(classFilesPath)).reverse();
    select.addOption("--Select a fileClass--", "--Select a fileClass--");
    fileClasses.forEach((fileClass) => {
      const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, fileClass.path);
      if (fileClassName)
        select.addOption(fileClassName, fileClassName);
    });
    if (this.fileClassQuery.fileClassName) {
      select.setValue(this.fileClassQuery.fileClassName);
    }
    select.onChange((value) => {
      if (value != "--Select a fileClass--") {
        this.fileClassQuery.fileClassName = value;
      } else {
        this.fileClassQuery.fileClassName = "";
      }
    });
  }
  createQueryInputContainer(container) {
    container.createDiv({ text: "dataviewJS query:" });
    const queryStringInputContainer = container.createDiv({ cls: "field-container" });
    const queryStringInput = new import_obsidian65.TextAreaComponent(queryStringInputContainer);
    queryStringInput.inputEl.addClass("full-width");
    queryStringInput.inputEl.rows = 4;
    queryStringInput.setValue(this.fileClassQuery.query);
    queryStringInput.onChange((value) => this.fileClassQuery.query = value);
  }
  createForm() {
    return __async(this, null, function* () {
      const nameContainer = this.contentEl.createDiv({ cls: "field-container" });
      this.createnameInputContainer(nameContainer);
      const fileClassSelectContainer = this.contentEl.createDiv({ cls: "field-container" });
      this.createFileClassSelectorContainer(fileClassSelectContainer);
      const fileClassQueryContainer = this.contentEl.createDiv({ cls: "vstacked" });
      this.createQueryInputContainer(fileClassQueryContainer);
      const footer = this.contentEl.createDiv({ cls: "footer-actions" });
      footer.createDiv({ cls: "spacer" });
      this.createSaveButton(footer);
      this.createCancelButton(footer);
    });
  }
  createSaveButton(container) {
    const b = new import_obsidian65.ButtonComponent(container);
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      if (this.fileClassQuery.fileClassName && this.fileClassQuery.name && this.fileClassQuery.query) {
        this.saved = true;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.filter((p) => p.id == this.fileClassQuery.id)[0];
        if (currentExistingFileClassQuery) {
          FileClassQuery_default.copyProperty(currentExistingFileClassQuery, this.fileClassQuery);
        } else {
          this.plugin.initialFileClassQueries.push(this.fileClassQuery);
        }
        ;
        FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
        if (this.parentSetting)
          FileClassQuery_default.copyProperty(this.parentSetting.fileClassQuery, this.fileClassQuery);
        (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
        this.plugin.saveSettings();
        this.close();
      }
    }));
  }
  createCancelButton(container) {
    const b = new import_obsidian65.ButtonComponent(container);
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialFileClassQuery.name != "") {
        Object.assign(this.fileClassQuery, this.initialFileClassQuery);
      }
      ;
      this.close();
    });
  }
};

// src/settings/MetadataMenuSettingTab.ts
var MetadataMenuSettingTab = class extends import_obsidian66.PluginSettingTab {
  constructor(plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.containerEl.addClass("metadata-menu");
    this.containerEl.addClass("settings");
  }
  createSettingGroup(title, subTitle, withButton = false) {
    const settingHeader = this.containerEl.createEl("div");
    const settingHeaderContainer = settingHeader.createEl("div", { cls: "header-container" });
    const settingHeaderTextContainer = settingHeaderContainer.createEl("div", { cls: "text-container" });
    settingHeaderTextContainer.createEl("h4", { text: title, cls: "section-header" });
    if (subTitle)
      settingHeaderTextContainer.createEl("div", { text: subTitle, cls: "setting-item-description" });
    const settingsContainer = this.containerEl.createEl("div");
    if (withButton) {
      const settingsContainerShowButtonContainer = settingHeaderContainer.createEl("div", { cls: "setting-item-control" });
      const settingsContainerShowButton = new import_obsidian66.ButtonComponent(settingsContainerShowButtonContainer);
      settingsContainerShowButton.buttonEl.addClass("setting-item-control");
      settingsContainer.hide();
      settingsContainerShowButton.setCta();
      settingsContainerShowButton.setIcon("chevrons-up-down");
      const toggleState = () => {
        if (settingsContainer.isShown()) {
          settingsContainer.hide();
          settingsContainerShowButton.setIcon("chevrons-up-down");
          settingsContainerShowButton.setCta();
        } else {
          settingsContainer.show();
          settingsContainerShowButton.setIcon("chevrons-down-up");
          settingsContainerShowButton.removeCta();
        }
      };
      settingsContainerShowButton.onClick(() => toggleState());
    }
    return settingsContainer;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    const globalSettings = this.createSettingGroup("Global settings", "Global settings to apply to your whole vault", true);
    new import_obsidian66.Setting(globalSettings).setName("Display field options in context menu").setDesc("Choose to show or hide fields options in the context menu of a link or a file").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.displayFieldsInContextMenu);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.displayFieldsInContextMenu = value;
        yield this.plugin.saveSettings();
      }));
    }).settingEl.addClass("no-border");
    const globallyIgnoredFieldsSetting = new import_obsidian66.Setting(globalSettings).setName("Globally ignored fields").setDesc("Fields to be ignored by the plugin when adding options to the context menu").addTextArea((text) => {
      text.setPlaceholder("Enter fields as string, comma separated").setValue(this.plugin.settings.globallyIgnoredFields.join(", ")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.globallyIgnoredFields = value.split(",").map((item) => item.trim());
        yield this.plugin.saveSettings();
      }));
      text.inputEl.rows = 6;
      text.inputEl.cols = 25;
    });
    globallyIgnoredFieldsSetting.settingEl.addClass("vstacked");
    globallyIgnoredFieldsSetting.settingEl.addClass("no-border");
    globallyIgnoredFieldsSetting.controlEl.addClass("full-width");
    const enableAutoComplete = new import_obsidian66.Setting(globalSettings).setName("Autocomplete").setDesc("Activate autocomplete fields").addToggle((cb) => {
      cb.setValue(this.plugin.settings.isAutosuggestEnabled);
      cb.onChange((value) => {
        this.plugin.settings.isAutosuggestEnabled = value;
        this.plugin.saveSettings();
      });
    });
    enableAutoComplete.settingEl.addClass("no-border");
    enableAutoComplete.controlEl.addClass("full-width");
    const frontmatterListDisplay = new import_obsidian66.Setting(globalSettings).setName("Frontmatter list display").setDesc("Choose wether lists should be displayed as arrays or indented lists in frontmatter").addDropdown((cb) => {
      [["Array", "asArray"], ["Indented List", "asList"]].forEach(([display, value]) => {
        cb.addOption(value, display);
      });
      cb.setValue(this.plugin.settings.frontmatterListDisplay || "asArray" /* asArray */);
      cb.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.frontmatterListDisplay = value;
        yield this.plugin.saveSettings();
      }));
    });
    frontmatterListDisplay.settingEl.addClass("no-border");
    frontmatterListDisplay.controlEl.addClass("full-width");
    new import_obsidian66.Setting(globalSettings).setName("First day of week").setDesc("For date fields, which day the date picker's week should start with").addDropdown((cb) => {
      for (let i = 0; i < 2; i++) {
        cb.addOption(i.toString(), (0, import_obsidian66.moment)().day(i).format("dddd"));
      }
      cb.setValue(this.plugin.settings.firstDayOfWeek.toString() || "1");
      cb.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.firstDayOfWeek = parseInt(value);
        yield this.plugin.saveSettings();
      }));
    }).settingEl.addClass("no-border");
    containerEl.createDiv({ cls: "setting-divider" });
    const presetFieldsSettings = this.createSettingGroup("Preset Fields settings", "Manage globally predefined type and options for a field throughout your whole vault", true);
    new import_obsidian66.Setting(presetFieldsSettings).setName("Add New Field Setting").setDesc("Add a new Frontmatter property for which you want preset options.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("Add new").setCta().onClick(() => __async(this, null, function* () {
        let modal = new FieldSettingsModal(this.plugin, presetFieldsSettings);
        modal.open();
      }));
    }).settingEl.addClass("no-border");
    this.plugin.initialProperties.forEach((prop) => {
      const property = new Field_default();
      Object.assign(property, prop);
      new FieldSetting(presetFieldsSettings, property, this.plugin);
    });
    containerEl.createDiv({ cls: "setting-divider" });
    const classFilesSettings = this.createSettingGroup("FileClass settings", "Manage fileClass folder and alias. When a note has a fileClass defined, fileClass field properties will override global preset fields settings for the same field name", true);
    const path = new import_obsidian66.Setting(classFilesSettings).setName("class Files path").setDesc("Path to the files containing the authorized fields for a type of note").addSearch((cfs) => {
      new FolderSuggest(this.plugin, cfs.inputEl);
      cfs.setPlaceholder("Folder").setValue(this.plugin.settings.classFilesPath || "").onChange((new_folder) => {
        const newPath = new_folder.endsWith("/") || !new_folder ? new_folder : new_folder + "/";
        this.plugin.settings.classFilesPath = newPath || null;
        this.plugin.saveSettings();
      });
    });
    path.settingEl.addClass("no-border");
    path.settingEl.addClass("narrow-title");
    path.controlEl.addClass("full-width");
    const alias = new import_obsidian66.Setting(classFilesSettings).setName("fileClass field alias").setDesc("Choose another name for fileClass field in frontmatter (example: Category, type, ...").addText((text) => {
      text.setValue(this.plugin.settings.fileClassAlias).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.fileClassAlias = value || "fileClass";
        yield this.plugin.saveSettings();
      }));
    });
    alias.settingEl.addClass("no-border");
    alias.settingEl.addClass("narrow-title");
    alias.controlEl.addClass("full-width");
    const global = new import_obsidian66.Setting(classFilesSettings).setName("global fileClass").setDesc("Choose one fileClass to be applicable to all files (even it is not present as a fileClass attribute in their frontmatter). This will override the preset Fields defined above").addSearch((cfs) => {
      new FileSuggest(cfs.inputEl, this.plugin, this.plugin.settings.classFilesPath || "");
      cfs.setPlaceholder("Global fileClass");
      cfs.setValue(this.plugin.settings.globalFileClass ? this.plugin.settings.classFilesPath + this.plugin.settings.globalFileClass + ".md" : "").onChange((newPath) => {
        var _a;
        this.plugin.settings.globalFileClass = newPath ? (_a = newPath.split("\\").pop().split("/").pop()) == null ? void 0 : _a.replace(".md", "") : "";
        this.plugin.saveSettings();
      });
    });
    global.settingEl.addClass("no-border");
    global.settingEl.addClass("narrow-title");
    global.controlEl.addClass("full-width");
    containerEl.createDiv({ cls: "setting-divider" });
    const metadataMenuBtnSettings = this.createSettingGroup("Metadata Menu button", "Show extra button to access metadata menu modal of fields", true);
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("Metadata Menu button icon").setDesc("name of the default icon when not defined in fileClass").addText((text) => {
      text.setValue(this.plugin.settings.buttonIcon).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.buttonIcon = value || "clipboard-list";
        yield this.plugin.saveSettings();
      }));
    }).settingEl.addClass("no-border");
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("Reading mode links").setDesc("Display an extra button to access metadata menu form after a link in reading mode").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableLinks);
      cb.onChange((value) => {
        this.plugin.settings.enableLinks = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("Live preview mode").setDesc("Display an extra button to access metadata menu form after a link in live preview").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableEditor);
      cb.onChange((value) => {
        this.plugin.settings.enableEditor = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("Tab header").setDesc("Display an extra button to access metadata menu form in the tab header").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableTabHeader);
      cb.onChange((value) => {
        this.plugin.settings.enableTabHeader = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("Backlinks").setDesc("Display an extra button to access metadata menu form in the backlinks panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableBacklinks);
      cb.onChange((value) => {
        this.plugin.settings.enableBacklinks = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("Search").setDesc("Display an extra button to access metadata menu form in the search panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableSearch);
      cb.onChange((value) => {
        this.plugin.settings.enableSearch = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("File explorer").setDesc("Display an extra button to access metadata menu form in the file explorer").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableFileExplorer);
      cb.onChange((value) => {
        this.plugin.settings.enableFileExplorer = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian66.Setting(metadataMenuBtnSettings).setName("Starred").setDesc("Display an extra button to access metadata menu form in the starred panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableStarred);
      cb.onChange((value) => {
        this.plugin.settings.enableStarred = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    containerEl.createDiv({ cls: "setting-divider" });
    const queryFileClassSettings = this.createSettingGroup("Query based FileClass settings", "Manage globally predefined type and options for a field matching this query", true);
    new import_obsidian66.Setting(queryFileClassSettings).setName("Add New Query for fileClass").setDesc("Add a new query and a FileClass that will apply to files matching this query.").addButton((button) => {
      return button.setTooltip("Add New fileClass query").setButtonText("Add new").setCta().onClick(() => __async(this, null, function* () {
        let modal = new FileClassQuerySettingsModal(this.plugin, queryFileClassSettings);
        modal.open();
      }));
    }).settingEl.addClass("no-border");
    this.plugin.initialFileClassQueries.forEach((query) => {
      const fileClassQuery = new FileClassQuery_default();
      Object.assign(fileClassQuery, query);
      new FileClassQuerySetting(queryFileClassSettings, fileClassQuery, this.plugin);
    });
  }
};

// src/settings/migrateSetting.ts
var migrateSettingsV1toV2 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (!Object.keys(p).contains("type")) {
      if (p.isMulti)
        p.type = "Multi" /* Multi */;
      else if (p.isCycle)
        p.type = "Cycle" /* Cycle */;
      else if (p.isBoolean)
        p.type = "Boolean" /* Boolean */;
      else if (p.options && Object.keys(p.options).length > 0)
        p.type = "Select" /* Select */;
      else
        p.type = "Input" /* Input */;
    }
    delete p.isMulti;
    delete p.isCycle;
    delete p.isBoolean;
    if (Object.getOwnPropertyDescriptor(p, "values") !== void 0) {
      Object.defineProperty(p, "options", Object.getOwnPropertyDescriptor(p, "values"));
      delete p["values"];
    }
  });
  plugin.settings.settingsVersion = 2;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 2");
});
var migrateSettingsV2toV3 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (["Select" /* Select */, "Multi" /* Multi */].includes(p.type)) {
      const currentOptionKeys = Object.keys(p.options);
      p.options.valuesList = {};
      currentOptionKeys.forEach((key) => p.options.valuesList[key] = p.options[key]);
      if (p.valuesListNotePath) {
        const selectType = "ValuesListNotePath" /* ValuesListNotePath */;
        p.options.sourceType = selectType;
        p.options[Key[selectType]];
      } else {
        p.options.sourceType = "ValuesList" /* ValuesList */;
      }
      p.options.valuesListNotePath = p.valuesListNotePath;
      currentOptionKeys.forEach((key) => delete p.options[key]);
      p.options.valuesFromDVQuery = "";
    }
    delete p.valuesListNotePath;
  });
  plugin.settings.settingsVersion = 3;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 3");
});

// src/suggester/metadataSuggester.ts
var import_obsidian67 = require("obsidian");
var listPrefix = "  - ";
var ValueSuggest = class extends import_obsidian67.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.inFrontmatter = false;
    this.inFullLine = false;
    this.inSentence = false;
    this.didSelect = false;
    this.filterOption = (firstValues, lastValue, option) => {
      return !firstValues || !(firstValues == null ? void 0 : firstValues.contains(encodeLink(option))) && (!lastValue || !!lastValue && encodeLink(option).includes(lastValue));
    };
    this.plugin = plugin;
    this.setInstructions([{ command: "Shift", purpose: "remove space after::" }]);
    this.scope.register(["Shift"], "Enter", (evt) => {
      this.suggestions.useSelectedItem(evt);
      return false;
    });
  }
  isInFrontmatter(editor, cursor) {
    let frontmatterEnd = void 0;
    if (editor.getLine(0) === "---") {
      for (let i = 1; i <= editor.lastLine(); i++) {
        if (editor.getLine(i) === "---") {
          frontmatterEnd = i;
          break;
        }
      }
    }
    return !!frontmatterEnd && cursor.line < frontmatterEnd;
  }
  onTrigger(cursor, editor, file) {
    if (this.didSelect) {
      this.didSelect = false;
      return null;
    }
    if (!this.plugin.settings.isAutosuggestEnabled) {
      return null;
    }
    ;
    if ((file == null ? void 0 : file.extension) !== "md")
      return null;
    const fullLine = editor.getLine(editor.getCursor().line);
    this.inFrontmatter = this.isInFrontmatter(editor, cursor);
    if (this.inFrontmatter) {
      const regex = new RegExp(`^${genericFieldRegex}:(?<values>.*)`, "u");
      if (!regex.test(fullLine) && !fullLine.startsWith(listPrefix)) {
        return null;
      } else {
        const line = editor.getLine(cursor.line);
        const separatorPos = line.indexOf(":");
        if (!["", " "].includes(line.slice(separatorPos + 1, separatorPos + 2))) {
          editor.replaceRange(" ", { line: cursor.line, ch: separatorPos + 1 }, { line: cursor.line, ch: separatorPos + 1 });
        }
      }
      ;
    } else if (getLineFields(fullLine).length === 0) {
      return null;
    }
    return {
      start: cursor,
      end: cursor,
      query: editor.getLine(cursor.line)
    };
  }
  getAlias(tFile) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let alias = void 0;
    if (dvApi && ((_b = this.field) == null ? void 0 : _b.options.customRendering)) {
      alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(tFile.path));
    }
    return alias;
  }
  getSuggestions(context) {
    return __async(this, null, function* () {
      const suggestions = yield this.getValueSuggestions(context);
      if (suggestions.length) {
        return suggestions;
      }
      return [];
    });
  }
  getValueSuggestions(context) {
    return __async(this, null, function* () {
      var _a, _b, _c, _d;
      const lineNumber = context.start.line;
      const matchField = { attribute: void 0, values: [] };
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      const splitValues = (values) => {
        return (values == null ? void 0 : values.replace(/^\[|^\s\[|^\(|^\s\(/, "").replace(/\]$|\)$/, "").split(",").map((o) => encodeLink(o.trim()))) || [""];
      };
      const getFilteredOptionsList = (field, firstValues, lastValue) => {
        var _a2;
        const fieldManager = new FieldManager[field.type](this.plugin, this.field);
        const suggestions = fieldManager.getOptionsList(dvApi.page((_a2 = this.context) == null ? void 0 : _a2.file.path)).filter((option) => {
          return this.filterOption(firstValues, lastValue, option);
        }).map((_value) => Object({ attr: field.name, value: _value }));
        return suggestions;
      };
      if (!this.inFrontmatter) {
        const lineFields = getLineFields(encodeLink(context.editor.getLine(lineNumber)));
        const position = context.editor.getCursor().ch;
        const activeLineField = lineFields.find((lineField) => lineField.index <= position && lineField.index + lineField.length >= position);
        if (activeLineField) {
          this.inSentence = activeLineField.index > 0;
          this.inFullLine = activeLineField.index === 0;
          matchField.attribute = activeLineField.attribute;
          matchField.values = splitValues(activeLineField.values);
        }
      } else {
        const fieldRegex = new RegExp(`^${genericFieldRegex}:(?<values>.+)?`, "u");
        const listItemRegex = new RegExp(`^${listPrefix}(?<values>.+)?`, "u");
        let fieldLine = lineNumber;
        while (!context.editor.getLine(fieldLine).includes(":") && fieldLine > 0)
          fieldLine = fieldLine - 1;
        const regexResult = context.editor.getRange({ line: fieldLine, ch: 0 }, context.end).match(fieldRegex);
        if (regexResult == null ? void 0 : regexResult.groups) {
          matchField.attribute = regexResult.groups.attribute;
          matchField.values = splitValues(regexResult.groups.values);
        }
        let i = 1;
        while (context.editor.getLine(fieldLine + i).startsWith(listPrefix) && fieldLine + i <= context.editor.lastLine()) {
          const regexResult2 = context.editor.getLine(fieldLine + i).match(listItemRegex);
          if (regexResult2 == null ? void 0 : regexResult2.groups)
            (_b = matchField.values) == null ? void 0 : _b.push(...splitValues(regexResult2.groups.values));
          i += 1;
        }
      }
      ;
      if (matchField.attribute) {
        const fieldName = matchField.attribute;
        this.field = (_c = this.plugin.fieldIndex.filesFields.get(context.file.path)) == null ? void 0 : _c.find((f) => f.name === fieldName);
        const valuesList = matchField.values;
        const lastValue = valuesList == null ? void 0 : valuesList.last();
        const firstValues = valuesList == null ? void 0 : valuesList.slice(0, -1);
        if (fieldName === "tags" && this.inFrontmatter) {
          return Object.keys(this.plugin.app.metadataCache.getTags()).filter((t) => lastValue ? t.contains(lastValue) : t).sort().map((tag) => Object({ attr: fieldName, value: tag.replace(/^#/, "") }));
        }
        if (this.field && ["Cycle" /* Cycle */, "Multi" /* Multi */, "Select" /* Select */].contains(this.field.type)) {
          return getFilteredOptionsList(this.field, firstValues, lastValue);
        } else if (this.field && ["File" /* File */, "MultiFile" /* MultiFile */].includes(this.field.type)) {
          const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
            return a.basename < b.basename ? -1 : 1;
          };
          const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
          const files = fieldManager.getFiles((_d = this.context) == null ? void 0 : _d.file).sort(sortingMethod);
          if (lastValue) {
            const results = files.filter((f) => {
              var _a2;
              return f.basename.toLowerCase().includes(lastValue.toLowerCase()) || ((_a2 = this.getAlias(f)) == null ? void 0 : _a2.toLowerCase().includes(lastValue.toLowerCase()));
            }).map((f) => {
              return Object({
                attr: fieldName,
                value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, void 0, this.getAlias(f))
              });
            });
            return results;
          } else {
            return files.map((f) => {
              var _a2;
              let alias = void 0;
              if (dvApi && ((_a2 = this.field) == null ? void 0 : _a2.options.customRendering)) {
                alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(f.path));
              }
              return Object({ attr: fieldName, value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, void 0, alias) });
            });
          }
        } else {
          return [];
        }
      }
      ;
      return [];
    });
  }
  renderSuggestion(suggestion, el) {
    var _a;
    el.addClass("metadata-menu");
    el.addClass("suggester");
    const [rawValue, alias] = `${suggestion.value}`.replace(/^\[\[/, "").replace(/\]\]$/, "").split("|");
    const targetFile = this.plugin.app.metadataCache.getFirstLinkpathDest(rawValue, this.context.file.path);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field && this.field.options.customRendering && targetFile) {
      if (alias) {
        const suggestionContainer = el.createDiv({ cls: "item-with-alias" });
        suggestionContainer.createDiv({ text: alias });
        const filePath = suggestionContainer.createDiv({ cls: "item-with-alias-filepath" });
        filePath.setText(rawValue);
      } else {
        el.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(targetFile.path)));
      }
    } else {
      el.setText(rawValue);
    }
  }
  selectSuggestion(suggestion, event) {
    return __async(this, null, function* () {
      var _a, _b, _c, _d, _e;
      const activeView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian67.MarkdownView);
      if (!activeView) {
        return;
      }
      ;
      const editor = activeView.editor;
      const activeLine = editor.getLine(this.context.start.line);
      const file = (_a = this.context) == null ? void 0 : _a.file;
      const position = ((_b = this.context) == null ? void 0 : _b.editor.getCursor().ch) || 0;
      const fieldName = suggestion.attr;
      const dvApi = (_c = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _c.api;
      const clean = (item) => {
        return item == null ? void 0 : item.replace(/\s?\,$/, "");
      };
      if (this.inFrontmatter && file) {
        try {
          let beginFieldLineNumber = this.context.start.line;
          let endFieldLineNumber = this.context.start.line;
          while (!editor.getLine(beginFieldLineNumber).startsWith(`${fieldName}:`) && beginFieldLineNumber > 0)
            beginFieldLineNumber = beginFieldLineNumber - 1;
          while (!editor.getLine(endFieldLineNumber + 1).includes(":") && !(editor.getLine(endFieldLineNumber + 1) === "---") && endFieldLineNumber + 1 <= this.context.editor.lastLine())
            endFieldLineNumber = endFieldLineNumber + 1;
          const serializedField = editor.getRange({ line: beginFieldLineNumber, ch: 0 }, { line: endFieldLineNumber, ch: editor.getLine(endFieldLineNumber).length });
          let parsedField = (0, import_obsidian67.parseYaml)(serializedField);
          let [attr, pastValues] = Object.entries(parsedField)[0];
          let newField;
          if (this.field && this.field.getDisplay(this.plugin) === "asList" /* asList */) {
            const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
            const options2 = fieldManager.getOptionsList(dvApi.page((_d = this.context) == null ? void 0 : _d.file.path));
            let valuesArray = [suggestion.value];
            if (typeof pastValues == "string") {
              valuesArray = [...new Set([clean(pastValues), ...valuesArray].filter((item) => options2.includes(item)))];
            } else if (Array.isArray(pastValues)) {
              valuesArray = [...new Set([
                ...pastValues.filter((v) => !!v).map((value) => clean(value)),
                ...valuesArray
              ].filter((item) => options2.includes(item)))];
            }
            newField = `${attr}: ${valuesArray.map((value) => `
  - ${clean(value)}`).join("")}`;
          } else if (fieldName === "tags" && this.plugin.settings.frontmatterListDisplay === "asList" /* asList */) {
            let valuesArray = [suggestion.value];
            const options2 = Object.keys(this.plugin.app.metadataCache.getTags()).map((t) => t.replace(/^#/, ""));
            if (typeof pastValues == "string") {
              valuesArray = [...new Set([clean(pastValues), ...valuesArray].filter((item) => options2.includes(item)))];
            } else if (Array.isArray(pastValues)) {
              valuesArray = [...new Set([
                ...pastValues.filter((v) => !!v).map((value) => clean(value)),
                ...valuesArray
              ].filter((item) => options2.includes(item)))];
            }
            newField = `${attr}: ${valuesArray.map((value) => `
  - ${clean(value)}`).join("")}`;
          } else {
            if (!pastValues) {
              newField = attr + ": " + suggestion.value;
            } else if (typeof pastValues == "string") {
              if (!pastValues.contains(",")) {
                newField = attr + ": " + suggestion.value;
              } else {
                const pastValuesArray = pastValues.split(",").map((o) => o.trim()).slice(0, -1);
                newField = attr + ": [" + pastValuesArray.join(", ") + ", " + clean(suggestion.value) + "]";
              }
            } else if (Array.isArray(pastValues)) {
              if (activeLine.endsWith(",]") || activeLine.endsWith(", ]")) {
                newField = attr + ": [" + [...pastValues, clean(suggestion.value)].join(", ") + "]";
              } else {
                newField = attr + ": [" + [...pastValues.slice(0, -1), clean(suggestion.value)].join(", ") + "]";
              }
            } else {
              newField = attr + ": [" + [...pastValues].join(", ") + "]";
            }
          }
          editor.replaceRange(newField, { line: beginFieldLineNumber, ch: 0 }, { line: endFieldLineNumber, ch: editor.getLine(endFieldLineNumber).length });
          if (!(((_e = this.field) == null ? void 0 : _e.getDisplay(this.plugin)) === "asList" /* asList */) && !(fieldName === "tags" && this.plugin.settings.frontmatterListDisplay === "asList" /* asList */) && (Array.isArray(pastValues) || typeof pastValues === "string" && pastValues.contains(","))) {
            editor.setCursor({ line: beginFieldLineNumber, ch: newField.length - 1 });
          } else {
            let endFieldLineNumber2 = this.context.start.line;
            while (!editor.getLine(endFieldLineNumber2 + 1).includes(":") && !(editor.getLine(endFieldLineNumber2 + 1) === "---")) {
              editor.getLine(endFieldLineNumber2);
              endFieldLineNumber2 = endFieldLineNumber2 + 1;
            }
            editor.setCursor({ line: endFieldLineNumber2, ch: editor.getLine(endFieldLineNumber2).length });
          }
        } catch (error) {
          console.log(error);
          new import_obsidian67.Notice("Frontmatter wrongly formatted", 2e3);
          this.close();
          return;
        }
      } else if (this.inFullLine && this.field && file) {
        let cleanedLine = activeLine;
        while (![",", ":"].contains(cleanedLine.charAt(cleanedLine.length - 1))) {
          cleanedLine = cleanedLine.slice(0, -1);
        }
        editor.replaceRange(`${cleanedLine}${event.shiftKey ? "" : " "}` + suggestion.value, { line: this.context.start.line, ch: 0 }, this.context.end);
      } else if (this.inSentence && this.field && file) {
        let beforeCursor = activeLine.slice(0, position);
        let afterCursor = activeLine.slice(position);
        let separatorPos = position;
        let currentValueLength = 0;
        while (!beforeCursor.endsWith("::") && !beforeCursor.endsWith(",") && beforeCursor.length) {
          separatorPos = separatorPos - 1;
          currentValueLength = currentValueLength + 1;
          beforeCursor = beforeCursor.slice(0, -1);
        }
        let nextBracketPos = position;
        while (!encodeLink(afterCursor).match("(\\]|\\)).*") && afterCursor.length) {
          nextBracketPos = nextBracketPos + 1;
          afterCursor = afterCursor.slice(nextBracketPos - position);
        }
        editor.replaceRange(suggestion.value, { line: this.context.start.line, ch: separatorPos }, { line: this.context.start.line, ch: nextBracketPos });
        editor.setCursor({ line: this.context.start.line, ch: nextBracketPos - currentValueLength + suggestion.value.length });
      }
      this.didSelect = true;
      this.close();
    });
  }
};

// main.ts
var MetadataMenu = class extends import_obsidian68.Plugin {
  constructor() {
    super(...arguments);
    this.initialProperties = [];
    this.initialFileClassQueries = [];
  }
  onload() {
    return __async(this, null, function* () {
      console.log("Metadata Menu loaded");
      if (!this.app.plugins.enabledPlugins.has("dataview") || this.app.plugins.plugins["dataview"] && !this.app.plugins.plugins["dataview"].settings.enableDataviewJs) {
        new import_obsidian68.Notice(`------------------------------------------
/!\\ INFO /!\\ 
Please install and enable dataview and dataviewJS to use Metadata Menu
------------------------------------------`, 6e4);
      }
      yield this.loadSettings();
      if (this.settings.settingsVersion === void 0)
        yield migrateSettingsV1toV2(this);
      if (this.settings.settingsVersion === 2)
        yield migrateSettingsV2toV3(this);
      this.fieldIndex = this.addChild(new FieldIndex(this, "1", () => {
      }));
      this.fileTaskManager = this.addChild(new FileTaskManager(this, "1", () => {
      }));
      this.extraButton = this.addChild(new ExtraButton(this, "1", () => {
      }));
      this.contextMenu = this.addChild(new ContextMenu(this));
      this.settings.presetFields.forEach((prop) => {
        const property = new Field_default();
        Object.assign(property, prop);
        this.initialProperties.push(property);
      });
      this.settings.fileClassQueries.forEach((query) => {
        const fileClassQuery = new FileClassQuery_default();
        Object.assign(fileClassQuery, query);
        this.initialFileClassQueries.push(fileClassQuery);
      });
      this.addSettingTab(new MetadataMenuSettingTab(this));
      this.registerEditorSuggest(new ValueSuggest(this));
      this.api = new MetadataMenuApi(this).make();
      this.registerEvent(this.app.workspace.on("active-leaf-change", (leaf) => {
        const view = leaf == null ? void 0 : leaf.view;
        addCommands(this, view);
      }));
      this.registerEvent(this.app.workspace.on("metadata-menu:indexed", () => {
        addCommands(this, void 0);
      }));
      addCommands(this, this.app.workspace.getActiveViewOfType(import_obsidian68.MarkdownView));
    });
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      this.settings.presetFields = this.initialProperties;
      this.settings.fileClassQueries = this.initialFileClassQueries;
      yield this.saveData(this.settings);
      yield this.fieldIndex.fullIndex("setting", true, false);
      this.extraButton.reloadObservers();
    });
  }
  onunload() {
    console.log("Metadata Menu unloaded");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvY29tbWFuZHMvcGFsZXR0ZUNvbW1hbmRzLnRzIiwgInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHMudHMiLCAic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvSW5wdXRGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9JbnB1dE1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9wb3N0VmFsdWVzLnRzIiwgInNyYy91dGlscy9maWxlVXRpbHMudHMiLCAic3JjL3V0aWxzL2xpc3QudHMiLCAic3JjL3R5cGVzL2xvb2t1cFR5cGVzLnRzIiwgInNyYy91dGlscy9wYXJzZXIudHMiLCAic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHMudHMiLCAic3JjL21vZGFscy9iYXNlTW9kYWwudHMiLCAic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXIudHMiLCAic3JjL21vZGFscy9pbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbC50cyIsICJzcmMvbW9kYWxzL2FkZE5ld0ZpZWxkTW9kYWwudHMiLCAic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbC50cyIsICJzcmMvZmllbGRzL0ZpZWxkLnRzIiwgInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmcudHMiLCAic3JjL21vZGFscy9maWVsZHMvQm9vbGVhbk1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9Cb29sZWFuRmllbGQudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL051bWJlckZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL051bWJlck1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9TZWxlY3RGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9TZWxlY3RNb2RhbC50cyIsICJzcmMvdHlwZXMvc2VsZWN0VmFsdWVzU291cmNlVHlwZXMudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Fic3RyYWN0TGlzdEJhc2VkRmllbGQudHMiLCAic3JjL3N1Z2dlc3Rlci9GaWxlU3VnZ2VzdGVyLnRzIiwgInNyYy9zdWdnZXN0ZXIvc3VnZ2VzdC50cyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2VudW1zLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVOYW1lLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFdpbmRvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21hdGguanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy91c2VyQWdlbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvaXNMYXlvdXRWaWV3cG9ydC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9jb250YWlucy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzVGFibGVFbGVtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRQYXJlbnROb2RlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3dpdGhpbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEZyZXNoU2lkZU9iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21lcmdlUGFkZGluZ09iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9hcnJvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldFZhcmlhdGlvbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2V2ZW50TGlzdGVuZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0T3Bwb3NpdGVQbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRXaW5kb3dTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93U2Nyb2xsQmFyWC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRWaWV3cG9ydFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzU2Nyb2xsUGFyZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFNjcm9sbFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3JlY3RUb0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvY29tcHV0ZU9mZnNldHMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9kZXRlY3RPdmVyZmxvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2NvbXB1dGVBdXRvUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2ZsaXAuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvaGlkZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9vZmZzZXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcG9wcGVyT2Zmc2V0cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEFsdEF4aXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcHJldmVudE92ZXJmbG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q29tcG9zaXRlUmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZGVib3VuY2UuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9mb3JtYXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy92YWxpZGF0ZU1vZGlmaWVycy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3VuaXF1ZUJ5LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvbWVyZ2VCeU5hbWUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9jcmVhdGVQb3BwZXIuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9wb3BwZXIuanMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0N5Y2xlRmllbGQudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL011bHRpRmllbGQudHMiLCAic3JjL21vZGFscy9maWVsZHMvTXVsdGlTZWxlY3RNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRmlsZUZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL1NpbmdsZUZpbGVNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRGF0ZUZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL0RhdGVNb2RhbC50cyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3R5cGVzL29wdGlvbnMuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS9sMTBuL2RlZmF1bHQuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS91dGlscy9pbmRleC5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL2RvbS5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL2Zvcm1hdHRpbmcuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS91dGlscy9kYXRlcy5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL3BvbHlmaWxscy5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL2luZGV4LmpzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NdWx0aUZpbGVGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9NdWx0aUZpbGVNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTG9va3VwRmllbGQudHMiLCAic3JjL2NvbW1hbmRzL3VwZGF0ZUxvb2t1cHMudHMiLCAic3JjL2NvbW1hbmRzL2dldFZhbHVlcy50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRm9ybXVsYUZpZWxkLnRzIiwgInNyYy9jb21tYW5kcy91cGRhdGVGb3JtdWxhcy50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RDYW52YXNCYXNlZEZpZWxkLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9DYW52YXNGaWVsZC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQ2FudmFzR3JvdXBGaWVsZC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQ2FudmFzR3JvdXBMaW5rRmllbGQudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL01hbmFnZXJzLnRzIiwgInNyYy90eXBlcy9maWVsZFR5cGVzLnRzIiwgInNyYy9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9pbnNlcnRNaXNzaW5nRmllbGRzLnRzIiwgInNyYy9jb21wb25lbnRzL2ZpbGVDbGFzc01hbmFnZXIudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NWaWV3LnRzIiwgInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzRmllbGRzVmlldy50cyIsICJzcmMvY29tbWFuZHMvcmVtb3ZlRmlsZUNsYXNzQXR0cmlidXRlLnRzIiwgInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzQXR0cmlidXRlLnRzIiwgInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzLnRzIiwgInNyYy91dGlscy90ZXh0VXRpbHMudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NTZXR0aW5nc1ZpZXcudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NUYWJsZVZpZXcudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NDaG9pY2VNb2RhbC50cyIsICJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwudHMiLCAic3JjL29wdGlvbnMvRmlsZUNsYXNzT3B0aW9uc0xpc3QudHMiLCAic3JjL29wdGlvbnMvT3B0aW9uc0xpc3QudHMiLCAic3JjL21vZGFscy9hZGROZXdGaWxlQ2xhc3NNb2RhbC50cyIsICJzcmMvY29tbWFuZHMvY3JlYXRlRmlsZUNsYXNzLnRzIiwgInNyYy9jb21wb25lbnRzL0NvbnRleHRNZW51LnRzIiwgInNyYy9jb21wb25lbnRzL0V4dHJhQnV0dG9uLnRzIiwgInNyYy9vcHRpb25zL2xpbmtBdHRyaWJ1dGVzLnRzIiwgInNyYy9vcHRpb25zL2xpdmVQcmV2aWV3LnRzIiwgInNyYy9jb21wb25lbnRzL0ZpZWxkSW5kZXgudHMiLCAic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeS50cyIsICJzcmMvY29tbWFuZHMvcmVzb2x2ZUxvb2t1cHMudHMiLCAic3JjL2NvbW1hbmRzL3VwZGF0ZUNhbnZhcy50cyIsICJzcmMvY29tcG9uZW50cy9GaWxlVGFza01hbmFnZXIudHMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9zdHJpbmdpZnkuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsICJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlcy50cyIsICJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzLnRzIiwgInNyYy9jb21tYW5kcy9pbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHMudHMiLCAic3JjL2NvbW1hbmRzL2ZpZWxkTW9kaWZpZXIudHMiLCAic3JjL2NvbW1hbmRzL2ZpbGVGaWVsZHMudHMiLCAic3JjL01ldGFkYXRhTWVudUFwaS50cyIsICJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ3MudHMiLCAic3JjL3NldHRpbmdzL01ldGFkYXRhTWVudVNldHRpbmdUYWIudHMiLCAic3JjL3N1Z2dlc3Rlci9Gb2xkZXJTdWdnZXN0ZXIudHMiLCAic3JjL3NldHRpbmdzL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ01vZGFsLnRzIiwgInNyYy9zZXR0aW5ncy9GaWxlQ2xhc3NRdWVyeVNldHRpbmcudHMiLCAic3JjL3NldHRpbmdzL21pZ3JhdGVTZXR0aW5nLnRzIiwgInNyYy9zdWdnZXN0ZXIvbWV0YWRhdGFTdWdnZXN0ZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBhZGRDb21tYW5kcyB9IGZyb20gJ3NyYy9jb21tYW5kcy9wYWxldHRlQ29tbWFuZHMnO1xuaW1wb3J0IENvbnRleHRNZW51IGZyb20gJ3NyYy9jb21wb25lbnRzL0NvbnRleHRNZW51JztcbmltcG9ydCBFeHRyYUJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9FeHRyYUJ1dHRvbic7XG5pbXBvcnQgRmllbGRJbmRleCBmcm9tICdzcmMvY29tcG9uZW50cy9GaWVsZEluZGV4JztcbmltcG9ydCBGaWxlVGFza01hbmFnZXIgZnJvbSAnc3JjL2NvbXBvbmVudHMvRmlsZVRhc2tNYW5hZ2VyJztcbmltcG9ydCBGaWVsZCBmcm9tICdzcmMvZmllbGRzL0ZpZWxkJztcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tICdzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5JztcbmltcG9ydCB0eXBlIHsgSU1ldGFkYXRhTWVudUFwaSB9IGZyb20gJ3NyYy9NZXRhZGF0YU1lbnVBcGknO1xuaW1wb3J0IHsgTWV0YWRhdGFNZW51QXBpIH0gZnJvbSAnc3JjL01ldGFkYXRhTWVudUFwaSc7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTLCBNZXRhZGF0YU1lbnVTZXR0aW5ncyB9IGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ3NcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYlwiO1xuaW1wb3J0ICogYXMgU2V0dGluZ3NNaWdyYXRpb24gZnJvbSAnc3JjL3NldHRpbmdzL21pZ3JhdGVTZXR0aW5nJztcbmltcG9ydCBWYWx1ZVN1Z2dlc3QgZnJvbSBcInNyYy9zdWdnZXN0ZXIvbWV0YWRhdGFTdWdnZXN0ZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YWRhdGFNZW51IGV4dGVuZHMgUGx1Z2luIHtcblx0cHVibGljIGFwaTogSU1ldGFkYXRhTWVudUFwaTtcblx0cHVibGljIHNldHRpbmdzOiBNZXRhZGF0YU1lbnVTZXR0aW5ncztcblx0cHVibGljIGluaXRpYWxQcm9wZXJ0aWVzOiBBcnJheTxGaWVsZD4gPSBbXTtcblx0cHVibGljIGluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzOiBBcnJheTxGaWxlQ2xhc3NRdWVyeT4gPSBbXTtcblx0cHVibGljIHNldHRpbmdUYWI6IE1ldGFkYXRhTWVudVNldHRpbmdUYWI7XG5cdHB1YmxpYyBmaWVsZEluZGV4OiBGaWVsZEluZGV4O1xuXHRwdWJsaWMgZmlsZVRhc2tNYW5hZ2VyOiBGaWxlVGFza01hbmFnZXI7XG5cdHB1YmxpYyBleHRyYUJ1dHRvbjogRXh0cmFCdXR0b247XG5cdHB1YmxpYyBjb250ZXh0TWVudTogQ29udGV4dE1lbnU7XG5cblxuXHRhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc29sZS5sb2coJ01ldGFkYXRhIE1lbnUgbG9hZGVkJyk7XG5cdFx0aWYgKCF0aGlzLmFwcC5wbHVnaW5zLmVuYWJsZWRQbHVnaW5zLmhhcyhcImRhdGF2aWV3XCIpIHx8IChcblx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0dGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0gJiYgIXRoaXMuYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdLnNldHRpbmdzLmVuYWJsZURhdGF2aWV3SnMpXG5cdFx0KSB7XG5cdFx0XHRuZXcgTm90aWNlKFxuXHRcdFx0XHRgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXFxuYCArXG5cdFx0XHRcdGAvIVxcXFwgSU5GTyAvIVxcXFwgXFxuYCArXG5cdFx0XHRcdGBQbGVhc2UgaW5zdGFsbCBhbmQgZW5hYmxlIGRhdGF2aWV3IGFuZCBkYXRhdmlld0pTIHRvIHVzZSBNZXRhZGF0YSBNZW51XFxuYCArXG5cdFx0XHRcdGAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gLCA2MDAwMClcblx0XHR9XG5cdFx0Ly9sb2FkaW5nIGFuZCBtaWdyYXRpbmcgc2V0dGluZ3Ncblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHRcdGlmICh0aGlzLnNldHRpbmdzLnNldHRpbmdzVmVyc2lvbiA9PT0gdW5kZWZpbmVkKSBhd2FpdCBTZXR0aW5nc01pZ3JhdGlvbi5taWdyYXRlU2V0dGluZ3NWMXRvVjIodGhpcylcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5zZXR0aW5nc1ZlcnNpb24gPT09IDIpIGF3YWl0IFNldHRpbmdzTWlncmF0aW9uLm1pZ3JhdGVTZXR0aW5nc1YydG9WMyh0aGlzKVxuXG5cdFx0Ly9sb2FkaW5nIGNvbXBvbmVudHNcblx0XHR0aGlzLmZpZWxkSW5kZXggPSB0aGlzLmFkZENoaWxkKG5ldyBGaWVsZEluZGV4KHRoaXMsIFwiMVwiLCAoKSA9PiB7IH0pKVxuXHRcdHRoaXMuZmlsZVRhc2tNYW5hZ2VyID0gdGhpcy5hZGRDaGlsZChuZXcgRmlsZVRhc2tNYW5hZ2VyKHRoaXMsIFwiMVwiLCAoKSA9PiB7IH0pKVxuXHRcdHRoaXMuZXh0cmFCdXR0b24gPSB0aGlzLmFkZENoaWxkKG5ldyBFeHRyYUJ1dHRvbih0aGlzLCBcIjFcIiwgKCkgPT4geyB9KSlcblx0XHR0aGlzLmNvbnRleHRNZW51ID0gdGhpcy5hZGRDaGlsZChuZXcgQ29udGV4dE1lbnUodGhpcykpXG5cblx0XHQvL2J1aWxkaW5nIHNldHRpbmdzIHRhYlxuXHRcdHRoaXMuc2V0dGluZ3MucHJlc2V0RmllbGRzLmZvckVhY2gocHJvcCA9PiB7XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuXHRcdFx0T2JqZWN0LmFzc2lnbihwcm9wZXJ0eSwgcHJvcCk7XG5cdFx0XHR0aGlzLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2gocHJvcGVydHkpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZXR0aW5ncy5maWxlQ2xhc3NRdWVyaWVzLmZvckVhY2gocXVlcnkgPT4ge1xuXHRcdFx0Y29uc3QgZmlsZUNsYXNzUXVlcnkgPSBuZXcgRmlsZUNsYXNzUXVlcnkoKTtcblx0XHRcdE9iamVjdC5hc3NpZ24oZmlsZUNsYXNzUXVlcnksIHF1ZXJ5KTtcblx0XHRcdHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMucHVzaChmaWxlQ2xhc3NRdWVyeSk7XG5cdFx0fSlcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTWV0YWRhdGFNZW51U2V0dGluZ1RhYih0aGlzKSk7XG5cblx0XHQvL3JlZ2lzdGVyaW5nIE1ldGFkYXRhIE1lbnUgc3VnZ2VzdG9yIGZvciBsaXZlIHByZXZpZXdcblx0XHR0aGlzLnJlZ2lzdGVyRWRpdG9yU3VnZ2VzdChuZXcgVmFsdWVTdWdnZXN0KHRoaXMpKTtcblx0XHR0aGlzLmFwaSA9IG5ldyBNZXRhZGF0YU1lbnVBcGkodGhpcykubWFrZSgpO1xuXG5cdFx0Ly9yZWdpc3RlcmluZyBwYWxldHRlIGNvbW1hbmQgcmUtYnVpbGQgb24gbGVhZiBjaGFuZ2Vcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsIChsZWFmKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWFmPy52aWV3XG5cdFx0XHRcdGFkZENvbW1hbmRzKHRoaXMsIHZpZXcpO1xuXHRcdFx0fSlcblx0XHQpXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdtZXRhZGF0YS1tZW51OmluZGV4ZWQnLCAoKSA9PiB7XG5cdFx0XHRcdGFkZENvbW1hbmRzKHRoaXMsIHVuZGVmaW5lZCk7XG5cdFx0XHR9KVxuXHRcdClcblxuXHRcdC8vYnVpbGRpbmcgcGFsZXR0ZSBjb21tYW5kc1xuXHRcdGFkZENvbW1hbmRzKHRoaXMsIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldykpO1xuXHR9O1xuXG5cdC8qXG5cdC0tLS0tLS0tLS0tLVxuXHRTZXR0aW5nc1xuXHQtLS0tLS0tLS0tLS1cblx0Ki9cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH07XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MucHJlc2V0RmllbGRzID0gdGhpcy5pbml0aWFsUHJvcGVydGllcztcblx0XHR0aGlzLnNldHRpbmdzLmZpbGVDbGFzc1F1ZXJpZXMgPSB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdFx0YXdhaXQgdGhpcy5maWVsZEluZGV4LmZ1bGxJbmRleChcInNldHRpbmdcIiwgdHJ1ZSwgZmFsc2UpO1xuXHRcdHRoaXMuZXh0cmFCdXR0b24ucmVsb2FkT2JzZXJ2ZXJzKCk7XG5cdH07XG5cblx0b251bmxvYWQoKSB7XG5cdFx0Y29uc29sZS5sb2coJ01ldGFkYXRhIE1lbnUgdW5sb2FkZWQnKTtcblx0fTtcbn1cbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWxlVmlldywgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFRGaWxlLCBWaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTm90ZUZpZWxkc0NvbXBvbmVudCBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWxcIjtcbmltcG9ydCBjaG9vc2VTZWN0aW9uTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBGaWxlQ2xhc3NPcHRpb25zTGlzdCBmcm9tIFwic3JjL29wdGlvbnMvRmlsZUNsYXNzT3B0aW9uc0xpc3RcIjtcbmltcG9ydCBPcHRpb25zTGlzdCBmcm9tIFwic3JjL29wdGlvbnMvT3B0aW9uc0xpc3RcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5pbXBvcnQgeyBmcm9udE1hdHRlckxpbmVGaWVsZCwgZ2V0TGluZUZpZWxkcyB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcIi4vaW5zZXJ0TWlzc2luZ0ZpZWxkc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpbGVDbGFzc01hbmFnZXIgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvZmlsZUNsYXNzTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyB1cGRhdGVMb29rdXBzIH0gZnJvbSBcIi4vdXBkYXRlTG9va3Vwc1wiO1xuaW1wb3J0IHsgdXBkYXRlRm9ybXVsYXMgfSBmcm9tIFwiLi91cGRhdGVGb3JtdWxhc1wiO1xuXG5mdW5jdGlvbiBhZGRGaWxlQ2xhc3NBdHRyaWJ1dGVPcHRpb25zKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcImZpbGVDbGFzc0F0dHJfb3B0aW9uc1wiLFxuICAgICAgICBuYW1lOiBcIkFsbCBmaWxlQ2xhc3MgYXR0cmlidXRlcyBvcHRpb25zXCIsXG4gICAgICAgIGljb246IFwiZ2VhclwiLFxuICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcbiAgICAgICAgICAgIGNvbnN0IGluRmlsZUNsYXNzID0gISEoY2xhc3NGaWxlc1BhdGggJiYgISEodmlldz8uZmlsZSkgJiYgdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpXG4gICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5GaWxlQ2xhc3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbkZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCA9IG5ldyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwocGx1Z2luLmFwcClcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBGaWxlQ2xhc3NPcHRpb25zTGlzdChwbHVnaW4sIHZpZXchLmZpbGUsIGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGFkZEluc2VydEZpbGVDbGFzc0F0dHJpYnV0ZShwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgcGx1Z2luLmFkZENvbW1hbmQoe1xuICAgICAgICBpZDogXCJpbnNlcnRfZmlsZUNsYXNzQXR0clwiLFxuICAgICAgICBuYW1lOiBcIkluc2VydCBhIG5ldyBmaWxlQ2xhc3MgYXR0cmlidXRlXCIsXG4gICAgICAgIGljb246IFwibGlzdC1wbHVzXCIsXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuICAgICAgICAgICAgY29uc3QgaW5GaWxlQ2xhc3MgPSAhIShjbGFzc0ZpbGVzUGF0aCAmJiAhISh2aWV3Py5maWxlKSAmJiB2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbkZpbGVDbGFzc1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IEZpbGVDbGFzcy5nZXRGaWxlQ2xhc3NOYW1lRnJvbVBhdGgocGx1Z2luLCB2aWV3IS5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbChwbHVnaW4sIEZpbGVDbGFzcy5jcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBmaWxlQ2xhc3NOYW1lKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcInBsdWdpbiBpcyBub3QgYSB2YWxpZCBmaWxlQ2xhc3NcIilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGFkZEluc2VydEZpZWxkQXRQb3NpdGlvbkNvbW1hbmQocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgIHBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICAgICAgaWQ6IFwiaW5zZXJ0X2ZpZWxkX2F0X2N1cnNvclwiLFxuICAgICAgICBuYW1lOiBcIkNob29zZSBhIGZpZWxkIHRvIGluc2VydCBhdCBjdXJzb3JcIixcbiAgICAgICAgaWNvbjogXCJsaXN0LXBsdXNcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG4gICAgICAgICAgICBjb25zdCBpbkZpbGUgPSAhISh2aWV3Py5maWxlICYmICghY2xhc3NGaWxlc1BhdGggfHwgIXZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKSlcbiAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbkZpbGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbkZpbGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdChwbHVnaW4sIHZpZXchLmZpbGUsIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIpO1xuICAgICAgICAgICAgICAgIG9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gYWRkRmllbGRPcHRpb25zQ29tbWFuZChwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgcGx1Z2luLmFkZENvbW1hbmQoe1xuICAgICAgICBpZDogXCJmaWVsZF9vcHRpb25zXCIsXG4gICAgICAgIG5hbWU6IFwiRmllbGRzIG9wdGlvbnNcIixcbiAgICAgICAgaWNvbjogXCJnZWFyXCIsXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuICAgICAgICAgICAgY29uc3QgaW5GaWxlID0gISEodmlldz8uZmlsZSAmJiAoIWNsYXNzRmlsZXNQYXRoIHx8ICF2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkpXG4gICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5GaWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCA9IG5ldyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwocGx1Z2luLmFwcClcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdChwbHVnaW4sIHZpZXchLmZpbGUsIGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGFkZE1hbmFnZUZpZWxkQXRDdXJzb3JDb21tYW5kKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcImZpZWxkX2F0X2N1cnNvcl9vcHRpb25zXCIsXG4gICAgICAgIG5hbWU6IFwiTWFuYWdlIGZpZWxkIGF0IGN1cnNvclwiLFxuICAgICAgICBpY29uOiBcInRleHQtY3Vyc29yLWlucHV0XCIsXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHZpZXc/LmVkaXRvcjtcbiAgICAgICAgICAgIGNvbnN0IGluRmlsZSA9ICEhKHZpZXc/LmZpbGUgJiYgKCFjbGFzc0ZpbGVzUGF0aCB8fCAhdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpKVxuICAgICAgICAgICAgaWYgKGNoZWNraW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluRmlsZSAmJiBlZGl0b3IgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRmlsZSAmJiBlZGl0b3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHBsdWdpbiwgdmlldyEuZmlsZSwgXCJNYW5hZ2VBdEN1cnNvckNvbW1hbmRcIilcbiAgICAgICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodmlldyEuZmlsZSk/LmZyb250bWF0dGVyO1xuICAgICAgICAgICAgICAgIGlmIChmcm9udG1hdHRlciAmJiBlZGl0b3JcbiAgICAgICAgICAgICAgICAgICAgJiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPiBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lXG4gICAgICAgICAgICAgICAgICAgICYmIGVkaXRvci5nZXRDdXJzb3IoKS5saW5lIDwgZnJvbnRtYXR0ZXIucG9zaXRpb24uZW5kLmxpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gZnJvbnRNYXR0ZXJMaW5lRmllbGQoZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpKVxuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlKSBvcHRpb25zTGlzdC5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbChhdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBhdHRyaWJ1dGUsIHZhbHVlcyB9ID0gZ2V0TGluZUZpZWxkcyhlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSkpLmZpbmQoZmllbGQgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5nZXRDdXJzb3IoKS5jaCA8PSBmaWVsZC5pbmRleCArIGZpZWxkLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZWRpdG9yLmdldEN1cnNvcigpLmNoID49IGZpZWxkLmluZGV4KSB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZSkgb3B0aW9uc0xpc3QuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoYXR0cmlidXRlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGluc2VydE1pc3NpbmdGaWVsZHNDb21tYW5kKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcImluc2VydF9taXNzaW5nX2ZpZWxkc1wiLFxuICAgICAgICBuYW1lOiBcIkJ1bGsgaW5zZXJ0IG1pc3NpbmcgZmllbGRzXCIsXG4gICAgICAgIGljb246IFwiYmF0dGVyeS1mdWxsXCIsXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgIGNvbnN0IGluRmlsZSA9ICEhKHZpZXc/LmZpbGUgJiYgKCFjbGFzc0ZpbGVzUGF0aCB8fCAhdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpKVxuICAgICAgICAgICAgaWYgKGNoZWNraW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluRmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZHZBcGkgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpO1xuICAgICAgICAgICAgaWYgKGR2QXBpICYmIGluRmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB2aWV3LmZpbGU7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEZpZWxkc05hbWVzID0gZ2VudWluZUtleXMoZHZBcGkucGFnZShmaWxlLnBhdGgpKVxuICAgICAgICAgICAgICAgIGlmICghWy4uLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpIHx8IFtdXS5tYXAoZmllbGQgPT4gZmllbGQubmFtZSkuZXZlcnkoZmllbGROYW1lID0+IGN1cnJlbnRGaWVsZHNOYW1lcy5pbmNsdWRlcyhmaWVsZE5hbWUpKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICAgICAgKSA9PiBpbnNlcnRNaXNzaW5nRmllbGRzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICkub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGFkZE9wZW5GaWVsZHNNb2RhbENvbW1hbmQocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgIHBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICAgICAgaWQ6IFwib3Blbl9maWVsZHNfbW9kYWxcIixcbiAgICAgICAgbmFtZTogXCJPcGVuIHRoaXMgbm90ZSdzIGZpZWxkcyBtb2RhbFwiLFxuICAgICAgICBpY29uOiBcImNsaXBib2FyZC1saXN0XCIsXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgIGNvbnN0IGluRmlsZSA9ICEhKHZpZXc/LmZpbGUgJiYgKCFjbGFzc0ZpbGVzUGF0aCB8fCAhdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpKVxuICAgICAgICAgICAgaWYgKGNoZWNraW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluRmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB2aWV3LmZpbGU7XG4gICAgICAgICAgICAgICAgaWYgKGluRmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlRmllbGRzQ29tcG9uZW50ID0gbmV3IE5vdGVGaWVsZHNDb21wb25lbnQocGx1Z2luLCBcIjFcIiwgKCkgPT4geyB9LCBmaWxlKVxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uYWRkQ2hpbGQobm90ZUZpZWxkc0NvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gYWRkSW5zZXJ0RmllbGRDb21tYW5kKHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgY29uc3QgZmllbGRzOiBGaWVsZFtdID0gW107XG4gICAgcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKGYgPT4geyBpZiAoZi5jb21tYW5kKSBmaWVsZHMucHVzaChmKSB9KTtcbiAgICBbLi4ucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNGaWVsZHNdLmZvckVhY2goKFtmaWxlQ2xhc3NOYW1lLCBfZmllbGRzXSkgPT4ge1xuICAgICAgICBfZmllbGRzLmZvckVhY2goZmllbGQgPT4geyBpZiAoZmllbGQuY29tbWFuZCkgeyBmaWVsZHMucHVzaChmaWVsZCkgfSB9KVxuICAgIH0pO1xuICAgIGZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgaWYgKGZpZWxkLmNvbW1hbmQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmQgPSBmaWVsZC5jb21tYW5kXG4gICAgICAgICAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICAgICAgaWQ6IGNvbW1hbmQuaWQsXG4gICAgICAgICAgICAgICAgbmFtZTogY29tbWFuZC5sYWJlbCxcbiAgICAgICAgICAgICAgICBpY29uOiBjb21tYW5kLmljb24sXG4gICAgICAgICAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZSID0gY29tbWFuZC5pZC5tYXRjaCgvaW5zZXJ0X18oPzxmaWxlQ2xhc3NOYW1lPi4qKV9fKD88ZmllbGROYW1lPi4qKS8pXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzZXMgPSB2aWV3Py5maWxlID8gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQodmlldz8uZmlsZS5wYXRoKSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXc/LmZpbGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc2VzICYmIGZpbGVDbGFzc2VzLnNvbWUoZmlsZUNsYXNzID0+IGZpbGVDbGFzcy5uYW1lID09PSBmUj8uZ3JvdXBzPy5maWxlQ2xhc3NOYW1lKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZmlsZUNsYXNzZXMgJiYgZlI/Lmdyb3Vwcz8uZmlsZUNsYXNzTmFtZSA9PT0gXCJwcmVzZXRGaWVsZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChmUj8uZ3JvdXBzICYmIHZpZXc/LmZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTmFtZSA9IGZSLmdyb3Vwcy5maWVsZE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTGlzdDogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA9PiBGLm9wZW5GaWVsZE1vZGFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICApLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGFkZEZpbGVDbGFzc1RhYmxlVmlld0NvbW1hbmQocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcIm9wZW5fZmlsZWNsYXNzX3ZpZXdcIixcbiAgICAgICAgbmFtZTogXCJPcGVuIGZpbGVDbGFzcyB2aWV3XCIsXG4gICAgICAgIGljb246IFwiZmlsZS1zcHJlYWRzaGVldFwiLFxuICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhY3RpdmVGaWxlUGF0aCA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKT8ucGF0aFxuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gYWN0aXZlRmlsZVBhdGggPyBwbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc1BhdGguZ2V0KGFjdGl2ZUZpbGVQYXRoKSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQ29tcG9uZW50ID0gbmV3IEZpbGVDbGFzc01hbmFnZXIocGx1Z2luLCBmaWxlQ2xhc3MpXG4gICAgICAgICAgICBwbHVnaW4uYWRkQ2hpbGQoZmlsZUNsYXNzQ29tcG9uZW50KTtcbiAgICAgICAgfVxuICAgIH0pXG59XG5cblxuZnVuY3Rpb24gYWRkVXBkYXRlTG9va3Vwc0FuZEZvcm11bGFzKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgcGx1Z2luLmFkZENvbW1hbmQoe1xuICAgICAgICBpZDogXCJ1cGRhdGVfYWxsX2xvb2t1cHNcIixcbiAgICAgICAgbmFtZTogXCJVcGRhdGUgYWxsIGxvb2t1cHMgYW5kIGZvcm11bGFzXCIsXG4gICAgICAgIGljb246IFwiZmlsZS1zZWFyY2hcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgcGx1Z2luLmZpZWxkSW5kZXguZnVsbEluZGV4KFwiY29tbWFuZFwiLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGFkZFVwZGF0ZUZpbGVMb29rdXBzQ29tbWFuZChwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgcGx1Z2luLmFkZENvbW1hbmQoe1xuICAgICAgICBpZDogXCJ1cGRhdGVfZmlsZV9sb29rdXBzXCIsXG4gICAgICAgIG5hbWU6IFwiVXBkYXRlIGFjdGl2ZSBmaWxlIGxvb2t1cHMgZmllbGRzXCIsXG4gICAgICAgIGljb246IFwiZmlsZS1zZWFyY2hcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgY29uc3QgaW5GaWxlID0gISEodmlldz8uZmlsZSAmJiAoIWNsYXNzRmlsZXNQYXRoIHx8ICF2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkpXG4gICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5GaWxlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5GaWxlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcbiAgICAgICAgICAgICAgICBpZiAoaW5GaWxlICYmIGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvb2t1cEZpZWxkcyA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkxvb2t1cClcbiAgICAgICAgICAgICAgICAgICAgbG9va3VwRmllbGRzPy5mb3JFYWNoKGFzeW5jIChmaWVsZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlTG9va3VwcyhwbHVnaW4sIFwic2luZ2xlX2NvbW1hbmRcIiwgeyBmaWxlOiBmaWxlLCBmaWVsZE5hbWU6IGZpZWxkLm5hbWUgfSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5mdW5jdGlvbiBhZGRVcGRhdGVGaWxlRm9ybXVsYXNDb21tYW5kKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcInVwZGF0ZV9maWxlX2Zvcm11bGFzXCIsXG4gICAgICAgIG5hbWU6IFwiVXBkYXRlIGFjdGl2ZSBmaWxlIGZvcm11bGFzIGZpZWxkc1wiLFxuICAgICAgICBpY29uOiBcImZ1bmN0aW9uLXNxdWFyZVwiLFxuICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgICBjb25zdCBpbkZpbGUgPSAhISh2aWV3Py5maWxlICYmICghY2xhc3NGaWxlc1BhdGggfHwgIXZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKSlcbiAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbkZpbGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbkZpbGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdmlldy5maWxlO1xuICAgICAgICAgICAgICAgIGlmIChpbkZpbGUgJiYgZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybXVsYUZpZWxkcyA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkZvcm11bGEpXG4gICAgICAgICAgICAgICAgICAgIGZvcm11bGFGaWVsZHM/LmZvckVhY2goYXN5bmMgKGZpZWxkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVGb3JtdWxhcyhwbHVnaW4sIHsgZmlsZTogZmlsZSwgZmllbGROYW1lOiBmaWVsZC5uYW1lIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gYWRkQ29tbWFuZHMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHZpZXc6IFZpZXcgfCB1bmRlZmluZWQgfCBudWxsKSB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBpZiAodmlldyAmJiB2aWV3IGluc3RhbmNlb2YgRmlsZVZpZXcpIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHZpZXcuZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICBpZiAoY2xhc3NGaWxlc1BhdGggJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKSB7XG4gICAgICAgICAgICAgICAgYWRkRmlsZUNsYXNzQXR0cmlidXRlT3B0aW9ucyhwbHVnaW4pO1xuICAgICAgICAgICAgICAgIGFkZEluc2VydEZpbGVDbGFzc0F0dHJpYnV0ZShwbHVnaW4pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhZGRGaWVsZE9wdGlvbnNDb21tYW5kKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgYWRkSW5zZXJ0RmllbGRBdFBvc2l0aW9uQ29tbWFuZChwbHVnaW4pO1xuICAgICAgICAgICAgICAgIGFkZE1hbmFnZUZpZWxkQXRDdXJzb3JDb21tYW5kKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgaW5zZXJ0TWlzc2luZ0ZpZWxkc0NvbW1hbmQocGx1Z2luKTtcbiAgICAgICAgICAgICAgICBhZGRPcGVuRmllbGRzTW9kYWxDb21tYW5kKHBsdWdpbilcbiAgICAgICAgICAgICAgICBhZGRJbnNlcnRGaWVsZENvbW1hbmQocGx1Z2luKVxuICAgICAgICAgICAgICAgIGFkZFVwZGF0ZUZpbGVMb29rdXBzQ29tbWFuZChwbHVnaW4pO1xuICAgICAgICAgICAgICAgIGFkZFVwZGF0ZUZpbGVGb3JtdWxhc0NvbW1hbmQocGx1Z2luKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGFkZEZpbGVDbGFzc1RhYmxlVmlld0NvbW1hbmQocGx1Z2luKVxuICAgIGFkZFVwZGF0ZUxvb2t1cHNBbmRGb3JtdWxhcyhwbHVnaW4pXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgQ29tcG9uZW50LCBNb2RhbCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbFwiO1xuaW1wb3J0IENob29zZVNlY3Rpb25Nb2RhbCBmcm9tIFwic3JjL21vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWxcIlxuaW1wb3J0ICogYXMgRmllbGRUeXBlIGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiXG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0gfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGLCBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IGluc2VydE1pc3NpbmdGaWVsZHMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydE1pc3NpbmdGaWVsZHNcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCB7IEZpbGVDbGFzc01hbmFnZXIgfSBmcm9tIFwiLi9maWxlQ2xhc3NNYW5hZ2VyXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWVsZE9wdGlvbnMge1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHsgfVxuXG4gICAgcHVibGljIGFkZE9wdGlvbihpY29uOiBzdHJpbmcsIG9uY2xpY2s6ICgpID0+IHt9IHwgdm9pZCwgdG9vbHRpcD86IHN0cmluZywgY2xhc3NOYW1lPzogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkT3B0aW9uQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWl0ZW0gZmllbGQtb3B0aW9uXCIgfSlcbiAgICAgICAgY29uc3QgZmllbGRPcHRpb24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkT3B0aW9uQ29udGFpbmVyKVxuICAgICAgICBmaWVsZE9wdGlvbi5zZXRJY29uKGljb24pXG4gICAgICAgIGlmIChjbGFzc05hbWUpIGZpZWxkT3B0aW9uLmJ1dHRvbkVsLmFkZENsYXNzKGNsYXNzTmFtZSk7XG4gICAgICAgIGZpZWxkT3B0aW9uLm9uQ2xpY2soKCkgPT4gb25jbGljaygpKVxuICAgICAgICBpZiAodG9vbHRpcCkgZmllbGRPcHRpb24uc2V0VG9vbHRpcCh0b29sdGlwKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGaWVsZHNNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgZHZBcGk/OiBhbnlcbiAgICBwdWJsaWMgZmllbGRzOiBGaWVsZFtdXG4gICAgcHVibGljIGZpZWxkQ29udGFpbmVyczogSFRNTERpdkVsZW1lbnRbXSA9IFtdO1xuICAgIC8vcHJpdmF0ZSBtYXhPcHRpb25zOiBudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgbWlzc2luZ0ZpZWxkczogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5kdkFwaSA9IHBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGk7XG4gICAgICAgIHRoaXMuZ2V0RmllbGRzKCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJub3RlLWZpZWxkcy1tb2RhbFwiKVxuICAgIH1cblxuICAgIC8vb2tcbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBGaWVsZHMgb2YgJHt0aGlzLmZpbGUuYmFzZW5hbWV9LiR7dGhpcy5maWxlLmV4dGVuc2lvbn1gKVxuICAgICAgICB0aGlzLmJ1aWxkRmllbGRzQ29udGFpbmVyKCk7XG4gICAgfTtcblxuICAgIC8vb2tcbiAgICBnZXRGaWVsZHMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQodGhpcy5maWxlLnBhdGgpIHx8IFtdO1xuICAgIH1cblxuICAgIC8vXG4gICAgYnVpbGRGaWVsZENvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWVsZDogRmllbGQsIHZhbHVlPzogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRk1bZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIGZpZWxkKVxuICAgICAgICBjb25zdCBmaWVsZE5hbWVXcmFwcGVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1uYW1lLXdyYXBwZXJcIiB9KVxuICAgICAgICBjb25zdCBmaWVsZE5hbWVDb250YWluZXIgPSBmaWVsZE5hbWVXcmFwcGVyLmNyZWF0ZURpdih7IHRleHQ6IGAke2ZpZWxkLm5hbWV9YCwgY2xzOiBcImZpZWxkLWl0ZW0gZmllbGQtbmFtZVwiIH0pO1xuICAgICAgICBjb25zdCBmaWVsZFNldHRpbmdzV3JhcHBlciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtc2V0dGluZ3Mtd3JhcHBlclwiIH0pO1xuICAgICAgICBmaWVsZFNldHRpbmdzV3JhcHBlci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtc2V0dGluZ3Mtc3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gZmllbGQuZmlsZUNsYXNzTmFtZSA/IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWVsZC5maWxlQ2xhc3NOYW1lKSA6IHVuZGVmaW5lZFxuICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICBmaWVsZE5hbWVDb250YWluZXIuYWRkQ2xhc3MoYGZpbGVDbGFzc0ZpZWxkX18ke2ZpbGVDbGFzcy5uYW1lLnJlcGxhY2UoXCIvXCIsIFwiX19fXCIpLnJlcGxhY2UoXCIgXCIsIFwiX1wiKX1gKVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpZWxkU2V0dGluZ0NvbnRhaW5lciA9IGZpZWxkU2V0dGluZ3NXcmFwcGVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1pdGVtIGZpZWxkLXNldHRpbmdcIiB9KTtcbiAgICAgICAgY29uc3QgZmllbGRTZXR0aW5nQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZFNldHRpbmdDb250YWluZXIpO1xuICAgICAgICBmaWVsZFNldHRpbmdCdG4uc2V0SWNvbihcImdlYXJcIilcbiAgICAgICAgZmllbGRTZXR0aW5nQnRuLnNldFRvb2x0aXAoYCR7ZmllbGQuZmlsZUNsYXNzTmFtZSA/IGZpZWxkLmZpbGVDbGFzc05hbWUgKyBcIiA+IFwiIDogXCJQcmVzZXQgRmllbGQgPiBcIn0gJHtmaWVsZC5uYW1lfSBzZXR0aW5nc2ApXG4gICAgICAgIGZpZWxkU2V0dGluZ0J0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IF9maWxlQ2xhc3MgPSBmaWVsZC5maWxlQ2xhc3NOYW1lID8gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpZWxkLmZpbGVDbGFzc05hbWUpIDogdW5kZWZpbmVkXG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBfZmlsZUNsYXNzPy5hdHRyaWJ1dGVzLmZpbmQoYXR0ciA9PiBhdHRyLm5hbWUgPT09IGZpZWxkLm5hbWUpXG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzQXR0cmlidXRlICYmIF9maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLnBsdWdpbiwgX2ZpbGVDbGFzcywgZmlsZUNsYXNzQXR0cmlidXRlKVxuICAgICAgICAgICAgICAgIGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgZmllbGRUeXBlQ29udGFpbmVyID0gZmllbGRTZXR0aW5nc1dyYXBwZXIuY3JlYXRlRGl2KHsgY2xzOiBgZmllbGQtaXRlbWAgfSk7XG4gICAgICAgIGZpZWxkVHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBmaWVsZC50eXBlLCBjbHM6IGBjaGlwIGZpZWxkLXR5cGUgJHtGaWVsZFR5cGUuRmllbGRCYWNrZ3JvdW5kQ29sb3JDbGFzc1tmaWVsZC50eXBlXX1gIH0pXG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWVXcmFwcGVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC12YWx1ZS13cmFwcGVyXCIgfSlcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZUNvbnRhaW5lciA9IGZpZWxkVmFsdWVXcmFwcGVyLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6IHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwgPyBcImZpZWxkLWl0ZW0gZmllbGQtdmFsdWVcIiA6IFwiZmllbGQtaXRlbSBmaWVsZC12YWx1ZSBlbXB0eWZpZWxkXCJcbiAgICAgICAgfSlcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICBmaWVsZFZhbHVlQ29udGFpbmVyLnNldFRleHQoZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkZpZWxkVHlwZS5Mb29rdXAgPyBcIi0tLWF1dG8tLS1cIiA6IFwiPGVtcHR5PlwiKTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLm1pc3NpbmdGaWVsZHMgPSB0cnVlXG4gICAgICAgICAgICBmaWVsZFZhbHVlQ29udGFpbmVyLnNldFRleHQoXCI8bWlzc2luZz5cIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaWVsZE1hbmFnZXIuZGlzcGxheVZhbHVlKGZpZWxkVmFsdWVDb250YWluZXIsIHRoaXMuZmlsZSwgZmllbGQubmFtZSwgKCkgPT4geyB0aGlzLmNsb3NlKCkgfSlcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWVsZE9wdGlvbnNXcmFwcGVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1vcHRpb25zLXdyYXBwZXJcIiB9KTtcbiAgICAgICAgZmllbGRPcHRpb25zV3JhcHBlci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtb3B0aW9ucy1zcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgZmllbGRPcHRpb25zID0gbmV3IEZpZWxkT3B0aW9ucyhmaWVsZE9wdGlvbnNXcmFwcGVyKVxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmFkZEZpZWxkT3B0aW9uKGZpZWxkLm5hbWUsIHZhbHVlLCB0aGlzLmZpbGUsIGZpZWxkT3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZEJ0bkNvbnRhaW5lciA9IGZpZWxkT3B0aW9uc1dyYXBwZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWl0ZW0gZmllbGQtb3B0aW9uXCIgfSlcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZEJ0bkNvbnRhaW5lcilcbiAgICAgICAgICAgIGZpZWxkQnRuLnNldEljb24oXCJsaXN0LXBsdXNcIilcbiAgICAgICAgICAgIGZpZWxkQnRuLnNldFRvb2x0aXAoXCJBZGQgZmllbGQgYXQgc2VjdGlvblwiKVxuICAgICAgICAgICAgZmllbGRCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IENob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQ6IGJvb2xlYW5cbiAgICAgICAgICAgICAgICAgICAgKSA9PiBGaWVsZE1hbmFnZXIub3BlbkZpZWxkTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApLm9wZW4oKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgb3Blbkluc2VydE1pc3NpbmdGaWVsZHNGb3JGaWxlQ2xhc3NNb2RhbChmaWxlQ2xhc3M6IEZpbGVDbGFzcyk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpO1xuICAgICAgICAgICAgaWYgKGR2RmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IENob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQ6IGJvb2xlYW5cbiAgICAgICAgICAgICAgICAgICAgKSA9PiBpbnNlcnRNaXNzaW5nRmllbGRzKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBkdkZpbGUuZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgbW9kYWwub3BlbigpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBtaXNzaW5nRmllbGRzRm9yRmlsZUNsYXNzKGZpbGVDbGFzczogRmlsZUNsYXNzKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWVsZHNOYW1lczogc3RyaW5nW10gPSBbXVxuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpO1xuICAgICAgICAgICAgaWYgKGR2RmlsZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRGaWVsZHNOYW1lcy5wdXNoKC4uLmdlbnVpbmVLZXlzKGR2RmlsZSkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgbWlzc2luZ0ZpZWxkcyA9IGZpbGVDbGFzcyAmJiB0aGlzLmZpbGUgP1xuICAgICAgICAgICAgIXRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVDbGFzcy5uYW1lKT8ubWFwKGYgPT4gZi5uYW1lKS5ldmVyeShmaWVsZE5hbWUgPT4gY3VycmVudEZpZWxkc05hbWVzLmluY2x1ZGVzKGZpZWxkTmFtZSkpIDpcbiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgIHJldHVybiBtaXNzaW5nRmllbGRzXG4gICAgfVxuXG4gICAgYnVpbGRGaWxlQ2xhc3NNYW5hZ2VyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzZXMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXTtcbiAgICAgICAgZmlsZUNsYXNzZXMuZm9yRWFjaChmaWxlQ2xhc3MgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTWFuYWdlckNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGRzLWluaGVyaXRhbmNlLW1hbmFnZXItY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgIGNvbnN0IF9hbmNlc3RvcnMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzQW5jZXN0b3JzLmdldChmaWxlQ2xhc3MubmFtZSkgfHwgW107XG4gICAgICAgICAgICBjb25zdCBhbmNlc3RvcnMgPSBbLi4uX2FuY2VzdG9yc10ucmV2ZXJzZSgpO1xuICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2goZmlsZUNsYXNzLm5hbWUpO1xuICAgICAgICAgICAgYW5jZXN0b3JzLmZvckVhY2goKGZpbGVDbGFzc05hbWUsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBfZmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgaWYgKF9maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzT3B0aW9uc0NvbnRhaW5lciA9IGZpbGVDbGFzc01hbmFnZXJDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpbGVjbGFzcy1tYW5hZ2VyLWNvbnRhaW5lclwiIH0pXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWVDb250YWluZXIgPSBmaWxlQ2xhc3NPcHRpb25zQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJuYW1lXCIsIHRleHQ6IF9maWxlQ2xhc3MubmFtZSB9KVxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NOYW1lQ29udGFpbmVyLnNldEF0dHIoXCJpZFwiLCBgZmlsZUNsYXNzX18ke19maWxlQ2xhc3MubmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9fX1wiKS5yZXBsYWNlKFwiIFwiLCBcIl9cIil9YClcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5taXNzaW5nRmllbGRzRm9yRmlsZUNsYXNzKF9maWxlQ2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NJbnNlcnRNaXNzaW5nRmllbGRzQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWxlQ2xhc3NPcHRpb25zQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzSW5zZXJ0TWlzc2luZ0ZpZWxkc0J0bi5zZXRJY29uKFwiYmF0dGVyeS1mdWxsXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NJbnNlcnRNaXNzaW5nRmllbGRzQnRuLnNldFRvb2x0aXAoYEluc2VydCBtaXNzaW5nIGZpZWxkcyBmb3IgJHtfZmlsZUNsYXNzLm5hbWV9YClcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0luc2VydE1pc3NpbmdGaWVsZHNCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuSW5zZXJ0TWlzc2luZ0ZpZWxkc0ZvckZpbGVDbGFzc01vZGFsKF9maWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQWRkQXR0cmlidXRlQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWxlQ2xhc3NPcHRpb25zQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NBZGRBdHRyaWJ1dGVCdG4uc2V0SWNvbihcInBsdXMtY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0FkZEF0dHJpYnV0ZUJ0bi5zZXRUb29sdGlwKGBBZGQgZmllbGQgZGVmaW5pdGlvbiBpbiAke19maWxlQ2xhc3MubmFtZX1gKVxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NBZGRBdHRyaWJ1dGVCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLnBsdWdpbiwgX2ZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IGFuY2VzdG9ycy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NNYW5hZ2VyQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiPlwiLCBjbHM6IFwic2VwYXJhdG9yXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0ZpZWxkc0NvbnRhaW5lcnMgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoYFtjbGFzcyo9XCJmaWxlQ2xhc3NGaWVsZF9fJHtmaWxlQ2xhc3NOYW1lLnJlcGxhY2UoXCIvXCIsIFwiX19fXCIpLnJlcGxhY2UoXCIgXCIsIFwiX1wiKX1cIl1gKVxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NGaWVsZHNDb250YWluZXJzLmZvckVhY2goZmllbGROYW1lQ29udGFpbmVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIChmaWVsZE5hbWVDb250YWluZXIgYXMgSFRNTERpdkVsZW1lbnQpLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXI/LmFkZENsYXNzKFwiYWN0aXZlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAoZmllbGROYW1lQ29udGFpbmVyIGFzIEhUTUxEaXZFbGVtZW50KS5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXI/LnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoYC5maWVsZC1pdGVtLmZpZWxkLW5hbWUuZmlsZUNsYXNzRmllbGRfXyR7ZmlsZUNsYXNzTmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9fX1wiKS5yZXBsYWNlKFwiIFwiLCBcIl9cIil9YClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaChjb250ID0+IHsgY29udC5hZGRDbGFzcyhcImFjdGl2ZVwiKSB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbChgLmZpZWxkLWl0ZW0uZmllbGQtbmFtZS5maWxlQ2xhc3NGaWVsZF9fJHtmaWxlQ2xhc3NOYW1lLnJlcGxhY2UoXCIvXCIsIFwiX19fXCIpLnJlcGxhY2UoXCIgXCIsIFwiX1wiKX1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGNvbnQgPT4geyBjb250LnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lci5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQ29tcG9uZW50ID0gbmV3IEZpbGVDbGFzc01hbmFnZXIodGhpcy5wbHVnaW4sIF9maWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hZGRDaGlsZChmaWxlQ2xhc3NDb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBidWlsZEZpZWxkc0NvbnRhaW5lcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5taXNzaW5nRmllbGRzID0gZmFsc2VcbiAgICAgICAgdGhpcy5jb250ZW50RWwucmVwbGFjZUNoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKCdocicpXG4gICAgICAgIGNvbnN0IGZpZWxkc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJub3RlLWZpZWxkcy1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5maWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZHZBcGkgPyB0aGlzLmR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpW2ZpZWxkLm5hbWVdIDogdW5kZWZpbmVkXG4gICAgICAgICAgICB0aGlzLmJ1aWxkRmllbGRDb250YWluZXIoZmllbGRzQ29udGFpbmVyLCBmaWVsZCwgdmFsdWUpXG4gICAgICAgIH0pXG4gICAgICAgIGlmICh0aGlzLm1pc3NpbmdGaWVsZHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydE1pc3NpbmdGaWVsZHNDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiaW5zZXJ0LWFsbC1maWVsZHNcIiB9KTtcbiAgICAgICAgICAgIGluc2VydE1pc3NpbmdGaWVsZHNDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJJbnNlcnQgbWlzc2luZyBmaWVsZHNcIiB9KTtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydE1pc3NpbmdGaWVsZHNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGluc2VydE1pc3NpbmdGaWVsZHNDb250YWluZXIpXG4gICAgICAgICAgICBpbnNlcnRNaXNzaW5nRmllbGRzQnRuLnNldEljb24oXCJiYXR0ZXJ5LWZ1bGxcIilcbiAgICAgICAgICAgIGluc2VydE1pc3NpbmdGaWVsZHNCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gdGhpcy5kdkFwaT8ucGFnZSh0aGlzLmZpbGUucGF0aClcbiAgICAgICAgICAgICAgICBpZiAoZHZGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBDaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICAgICAgKSA9PiBpbnNlcnRNaXNzaW5nRmllbGRzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR2RmlsZS5maWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICkub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoJ2hyJylcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTWFuYWdlcnNDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGRzLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkRmlsZUNsYXNzTWFuYWdlcihmaWxlQ2xhc3NNYW5hZ2Vyc0NvbnRhaW5lcilcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5vdGVGaWVsZHNDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgcHJpdmF0ZSBmaWVsZHNNb2RhbDogRmllbGRzTW9kYWw7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwdWJsaWMgY2FjaGVWZXJzaW9uOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBvbkNoYW5nZTogKCkgPT4gdm9pZCxcbiAgICAgICAgcHVibGljIGZpbGU6IFRGaWxlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZmllbGRzTW9kYWwgPSBuZXcgRmllbGRzTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUpXG4gICAgICAgIHRoaXMuZmllbGRzTW9kYWwub25DbG9zZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlbW92ZUNoaWxkKHRoaXMpXG4gICAgICAgICAgICB0aGlzLnVubG9hZCgpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbmxvYWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2RhdGF2aWV3Om1ldGFkYXRhLWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGRzTW9kYWwuZ2V0RmllbGRzKCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkc01vZGFsLmJ1aWxkRmllbGRzQ29udGFpbmVyKCk7XG4gICAgICAgIH0pKVxuICAgICAgICB0aGlzLmZpZWxkc01vZGFsLm9wZW4oKVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgRHJvcGRvd25Db21wb25lbnQsIE1vZGFsLCBUZXh0Q29tcG9uZW50LCBCdXR0b25Db21wb25lbnQsIE5vdGljZSwgVG9nZ2xlQ29tcG9uZW50LCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpZWxkVHlwZVRvb2x0aXAsIEZpZWxkVHlwZSwgRmllbGRUeXBlTGFiZWxNYXBwaW5nLCBGaWVsZE1hbmFnZXIsIE11bHRpRGlzcGxheVR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkLCB7IEZpZWxkQ29tbWFuZCB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5cbmNsYXNzIEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBuYW1lSW5wdXQ6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBhdHRyTmFtZTogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGRNYW5hZ2VyOiBGO1xuICAgIHByaXZhdGUgZmllbGRPcHRpb25zQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGNvbW1hbmQ6IEZpZWxkQ29tbWFuZDtcbiAgICBwcml2YXRlIGFkZENvbW1hbmQ6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBpY29uTmFtZTogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIGF1dG9TdWdnZXN0PzogYm9vbGVhbjtcbiAgICBwcml2YXRlIGZyb250bWF0dGVyTGlzdERpc3BsYXk/OiBNdWx0aURpc3BsYXlUeXBlO1xuICAgIHByaXZhdGUgZnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG5cblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGVDbGFzczogRmlsZUNsYXNzLFxuICAgICAgICBwcml2YXRlIGF0dHI/OiBGaWxlQ2xhc3NBdHRyaWJ1dGVcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbEZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSBhdHRyIS5nZXRGaWVsZCgpXG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5pbml0aWFsRmllbGQsIHRoaXMuZmllbGQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCA9IHRoaXMuZmllbGQuY29tbWFuZCAhPT0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNvbW1hbmQgPSB0aGlzLmZpZWxkLmNvbW1hbmQgfHwge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZmllbGQgPyBgaW5zZXJ0X18ke3RoaXMuZmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X18ke3RoaXMuZmllbGQubmFtZX1gIDogXCJcIixcbiAgICAgICAgICAgIGljb246IFwibGlzdC1wbHVzXCIsXG4gICAgICAgICAgICBsYWJlbDogdGhpcy5maWVsZCA/IGBJbnNlcnQgJHt0aGlzLmZpZWxkLm5hbWV9IGZpZWxkYCA6IFwiXCIsXG4gICAgICAgICAgICBob3RrZXk6IHVuZGVmaW5lZFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgICAgICAvL3RpdGxlXG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KHRoaXMuYXR0ciA/IGBNYW5hZ2UgJHt0aGlzLmF0dHIubmFtZX1gIDogYENyZWF0ZSBhIG5ldyBhdHRyaWJ1dGUgZm9yICR7dGhpcy5maWxlQ2xhc3MubmFtZX1gKTtcblxuICAgICAgICAvKiBOYW1lICovXG4gICAgICAgIHRoaXMuYnVpbGROYW1lSW5wdXRDb250YWluZXIoKTtcbiAgICAgICAgdGhpcy5idWlsZEhlYWRlcigpO1xuICAgICAgICB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgICAgIC8qIENvbW1hbmQgKi9cbiAgICAgICAgdGhpcy5idWlsZENvbW1hbmRDb250YWluZXIoKTtcblxuICAgICAgICAvKiBmcm9udG1hdHRlciBsaXN0IGRpc3BsYXkqL1xuICAgICAgICB0aGlzLmNyZWF0ZUZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIoKTtcblxuICAgICAgICAvKiBUeXBlICovXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICAgICAgLyogT3B0aW9ucyAqL1xuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuXG4gICAgICAgIC8vIGZvb3RlciBidXR0b25zXG4gICAgICAgIGNvbnN0IGZvb3RlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmb290ZXItYWN0aW9uc1wiIH0pO1xuICAgICAgICBmb290ZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIHRoaXMuY3JlYXRlU2F2ZUJ0bihmb290ZXIpO1xuICAgICAgICBpZiAodGhpcy5hdHRyKSB0aGlzLmNyZWF0ZVJlbW92ZWxCdG4oZm9vdGVyKTtcbiAgICAgICAgdGhpcy5jcmVhdGVDYW5jZWxCdG4oZm9vdGVyKTtcblxuICAgICAgICAvKiBpbml0IHN0YXRlICovXG4gICAgICAgIHRoaXMuYnVpbGRUeXBlU2VsZWN0Q29udGFpbmVyKHR5cGVTZWxlY3RDb250YWluZXIpO1xuICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci5jcmVhdGVTZXR0aW5nQ29udGFpbmVyKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLCB0aGlzLnBsdWdpbiwgU2V0dGluZ0xvY2F0aW9uLkZpbGVDbGFzc0F0dHJpYnV0ZVNldHRpbmdzKTtcblxuICAgIH1cblxuICAgIGJ1aWxkTmFtZUlucHV0Q29udGFpbmVyKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiBcIkZpZWxkIE5hbWU6IFwiIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgdGhpcy5hdHRyID8gaW5wdXQuc2V0VmFsdWUodGhpcy5maWVsZC5uYW1lKSA6IGlucHV0LnNldFBsYWNlaG9sZGVyKFwiTmFtZSBvZiB0aGUgZmllbGRcIik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmQuaWQgPSBgaW5zZXJ0X18ke3RoaXMuZmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X18ke3ZhbHVlfWBcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5sYWJlbCA9IGBJbnNlcnQgJHt2YWx1ZX0gZmllbGRgXG4gICAgICAgICAgICB0aGlzLmF0dHJOYW1lLnNldFRleHQoYDwke3ZhbHVlfT5gKTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoaW5wdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5uYW1lSW5wdXQgPSBpbnB1dFxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlRnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIC8vbGFiZWxcbiAgICAgICAgdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5Q29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiRnJvbnRtYXR0ZXIgbGlzdCBkaXNwbGF5IHR5cGVcIiwgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIC8vYWRkIHRvZ2dsZXJcbiAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXJMaXN0RGlzcGxheSA9IG5ldyBEcm9wZG93bkNvbXBvbmVudCh0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIpO1xuICAgICAgICBjb25zdCBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cbiAgICAgICAgb3B0aW9uc1tcImFzQXJyYXlcIl0gPSBcImRpc3BsYXkgYXMgYXJyYXlcIlxuICAgICAgICBvcHRpb25zW1wiYXNMaXN0XCJdID0gXCJkaXNwbGF5IGFzIGluZGVudGVkIGxpc3RcIlxuICAgICAgICBvcHRpb25zW1widW5kZWZpbmVkXCJdID0gYFBsdWdpbiBEZWZhdWx0ICgke3RoaXMucGx1Z2luLnNldHRpbmdzLmZyb250bWF0dGVyTGlzdERpc3BsYXl9KWBcbiAgICAgICAgZnJvbnRtYXR0ZXJMaXN0RGlzcGxheS5hZGRPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICBzd2l0Y2ggKHRoaXMuZmllbGQuZGlzcGxheSkge1xuICAgICAgICAgICAgY2FzZSBNdWx0aURpc3BsYXlUeXBlLmFzQXJyYXk6IGZyb250bWF0dGVyTGlzdERpc3BsYXkuc2V0VmFsdWUoXCJhc0FycmF5XCIpOyBicmVha1xuICAgICAgICAgICAgY2FzZSBNdWx0aURpc3BsYXlUeXBlLmFzTGlzdDogZnJvbnRtYXR0ZXJMaXN0RGlzcGxheS5zZXRWYWx1ZShcImFzTGlzdFwiKTsgYnJlYWtcbiAgICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOiBmcm9udG1hdHRlckxpc3REaXNwbGF5LnNldFZhbHVlKFwidW5kZWZpbmVkXCIpOyBicmVha1xuICAgICAgICB9XG5cbiAgICAgICAgZnJvbnRtYXR0ZXJMaXN0RGlzcGxheS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImFzQXJyYXlcIjogdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5ID0gTXVsdGlEaXNwbGF5VHlwZS5hc0FycmF5OyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiYXNMaXN0XCI6IHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheSA9IE11bHRpRGlzcGxheVR5cGUuYXNMaXN0OyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwidW5kZWZpbmVkXCI6IHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheSA9IHVuZGVmaW5lZDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDogdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBidWlsZENvbW1hbmRDb250YWluZXIoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbW1hbmRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcblxuICAgICAgICAvL2xhYmVsXG4gICAgICAgIGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJzZXQgYSBjb21tYW5kIGZvciB0aGlzIGZpZWxkP1wiLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIC8vYWRkIGNvbW1hbmRcbiAgICAgICAgY29uc3QgYWRkQ29tbWFuZFRvZ2dsZXIgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGNvbW1hbmRDb250YWluZXIpO1xuICAgICAgICBhZGRDb21tYW5kVG9nZ2xlci5zZXRWYWx1ZSh0aGlzLmFkZENvbW1hbmQpO1xuXG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICB0aGlzLmFkZENvbW1hbmQgPyBpY29uQ29udGFpbmVyLnNob3coKSA6IGljb25Db250YWluZXIuaGlkZSgpO1xuXG4gICAgICAgIC8vIGljb25cbiAgICAgICAgaWNvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcIkljb24gbmFtZVwiLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgdGhpcy5pY29uTmFtZSA9IG5ldyBUZXh0Q29tcG9uZW50KGljb25Db250YWluZXIpO1xuICAgICAgICB0aGlzLmljb25OYW1lLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLmljb25OYW1lLmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICBjb25zdCBpY29uUHJldmlldyA9IGljb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tcHJldmlld1wiIH0pXG4gICAgICAgIHRoaXMuaWNvbk5hbWUuc2V0VmFsdWUodGhpcy5jb21tYW5kLmljb24pXG4gICAgICAgIHNldEljb24oaWNvblByZXZpZXcsIHRoaXMuY29tbWFuZC5pY29uKVxuICAgICAgICB0aGlzLmljb25OYW1lLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5pY29uID0gdmFsdWU7XG4gICAgICAgICAgICBzZXRJY29uKGljb25QcmV2aWV3LCB2YWx1ZSlcbiAgICAgICAgfSlcblxuICAgICAgICBhZGRDb21tYW5kVG9nZ2xlci5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZENvbW1hbmQgPSB2YWx1ZVxuICAgICAgICAgICAgdGhpcy5hZGRDb21tYW5kID8gaWNvbkNvbnRhaW5lci5zaG93KCkgOiBpY29uQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYnVpbGRIZWFkZXIoKTogdm9pZCB7XG4gICAgICAgIC8vaGVhZGVyIGZvciBzZWxlY3RcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RIZWFkZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGF0dHJMaW5lID0gdHlwZVNlbGVjdEhlYWRlci5jcmVhdGVFbChcImRpdlwiKTtcbiAgICAgICAgdGhpcy5hdHRyTmFtZSA9IGF0dHJMaW5lLmNyZWF0ZUVsKFwic3Ryb25nXCIpO1xuICAgICAgICB0aGlzLmF0dHJOYW1lLnNldFRleHQoYDwke3RoaXMuZmllbGQubmFtZX0+YCk7XG4gICAgICAgIGF0dHJMaW5lLmFwcGVuZChgIGF2YWlsYWJsZSBpbiBmaWxlcyB3aXRoICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9ID0gJHt0aGlzLmZpbGVDbGFzcy5uYW1lfWApO1xuXG4gICAgfVxuXG4gICAgYnVpbGRUeXBlU2VsZWN0Q29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcblxuICAgICAgICAvL2Ryb3Bkb3duXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RvckNvbnRhaW5lckxhYmVsID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICB0eXBlU2VsZWN0b3JDb250YWluZXJMYWJlbC5zZXRUZXh0KGBGaWVsZCB0eXBlOmApO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgT2JqZWN0LmtleXMoRmllbGRUeXBlVG9vbHRpcCkuZm9yRWFjaCgoa2V5OiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiB0eXBlU2VsZWN0LmFkZE9wdGlvbihrZXksIEZpZWxkVHlwZVRvb2x0aXBba2V5XSkpXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLnR5cGUpIHtcbiAgICAgICAgICAgIHR5cGVTZWxlY3Quc2V0VmFsdWUodGhpcy5maWVsZC50eXBlKTtcbiAgICAgICAgICAgIGlmIChbRmllbGRUeXBlLk11bHRpLCBGaWVsZFR5cGUuU2VsZWN0LCBGaWVsZFR5cGUuQ3ljbGVdLmluY2x1ZGVzKHRoaXMuZmllbGQudHlwZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIuc2hvdygpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0eXBlU2VsZWN0Lm9uQ2hhbmdlKCh0eXBlTGFiZWw6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSBuZXcgRmllbGQoKTtcbiAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eSh0aGlzLmZpZWxkLCB0aGlzLmluaXRpYWxGaWVsZCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUgPSB0aGlzLm5hbWVJbnB1dC5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB0aGlzLmZpZWxkLnR5cGUgPSBGaWVsZFR5cGVMYWJlbE1hcHBpbmdbdHlwZUxhYmVsXTtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkLnR5cGUgIT09IHRoaXMuaW5pdGlhbEZpZWxkLnR5cGUgJiZcbiAgICAgICAgICAgICAgICAhW3RoaXMuZmllbGQudHlwZSwgdGhpcy5pbml0aWFsRmllbGQudHlwZV0uZXZlcnkoZmllbGRUeXBlID0+XG4gICAgICAgICAgICAgICAgICAgIFtGaWVsZFR5cGUuTXVsdGksIEZpZWxkVHlwZS5TZWxlY3QsIEZpZWxkVHlwZS5DeWNsZV0uaW5jbHVkZXMoZmllbGRUeXBlKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucyA9IHt9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoW0ZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLkN5Y2xlXS5pbmNsdWRlcyh0aGlzLmZpZWxkLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5Q29udGFpbmVyLnNob3coKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIuaGlkZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZSAodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLnJlbW92ZUNoaWxkKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci5jcmVhdGVTZXR0aW5nQ29udGFpbmVyKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLCB0aGlzLnBsdWdpbiwgU2V0dGluZ0xvY2F0aW9uLkZpbGVDbGFzc0F0dHJpYnV0ZVNldHRpbmdzKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgdmFsaWRhdGVGaWVsZHMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU5hbWUoXG4gICAgICAgICAgICB0aGlzLm5hbWVJbnB1dCxcbiAgICAgICAgICAgIHRoaXMuY29udGVudEVsXG4gICAgICAgICkgJiZcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlT3B0aW9ucygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU2F2ZUJ0bihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0VG9vbHRpcChcIlNhdmVcIik7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGxldCBlcnJvciA9ICF0aGlzLnZhbGlkYXRlRmllbGRzKCk7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRml4IGVycm9ycyBiZWZvcmUgc2F2aW5nLlwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMuYWRkQ29tbWFuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQuY29tbWFuZCA9IHRoaXMuY29tbWFuZFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWVsZC5jb21tYW5kXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5kaXNwbGF5ID0gdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZpZWxkLmRpc3BsYXlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLnR5cGUsXG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucyxcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHIsXG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5jb21tYW5kLFxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQuZGlzcGxheVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVJlbW92ZWxCdG4oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCByZW1vdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIHJlbW92ZUJ1dHRvbi5zZXRJY29uKFwidHJhc2hcIik7XG4gICAgICAgIHJlbW92ZUJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1Nb2RhbCA9IG5ldyBNb2RhbCh0aGlzLnBsdWdpbi5hcHApO1xuICAgICAgICAgICAgY29uZmlybU1vZGFsLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKTtcbiAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC50aXRsZUVsLnNldFRleHQoXCJQbGVhc2UgY29uZmlybVwiKTtcbiAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5jb250ZW50RWwuY3JlYXRlRGl2KCkuc2V0VGV4dChgRG8geW91IHJlYWxseSB3YW50IHRvIHJlbW92ZSAke3RoaXMuYXR0cj8ubmFtZX0gYXR0cmlidXRlIGZyb20gJHt0aGlzLmZpbGVDbGFzcy5uYW1lfT9gKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1Gb290ZXIgPSBjb25maXJtTW9kYWwuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmb290ZXItYWN0aW9uc1wiIH0pO1xuICAgICAgICAgICAgY29uZmlybUZvb3Rlci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbmZpcm1Gb290ZXIpO1xuICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5zZXRXYXJuaW5nKCk7XG4gICAgICAgICAgICBjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgICAgICBjb25maXJtQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dHIpIHRoaXMuZmlsZUNsYXNzLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmF0dHIpO1xuICAgICAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjb25zdCBkaXNtaXNzQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb25maXJtRm9vdGVyKTtcbiAgICAgICAgICAgIGRpc21pc3NCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpO1xuICAgICAgICAgICAgZGlzbWlzc0J1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwub3BlbigpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlQ2FuY2VsQnRuKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpO1xuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IElucHV0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL0lucHV0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnB1dEZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLklucHV0KVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMudGVtcGxhdGUgfHwgXCJcIlxuICAgIH1cblxuICAgIHB1YmxpYyBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBJbnB1dE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSk7XG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChgQ2hhbmdlIFZhbHVlIGZvciA8JHtuYW1lfT5gKTtcbiAgICAgICAgY29uc3QgaWNvbk5hbWUgPSBGaWVsZEljb25bRmllbGRUeXBlLklucHV0XTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpO1xuICAgICAgICBpZiAoSW5wdXRGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihpY29uTmFtZSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgaWYgKElucHV0RmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IGljb25OYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChJbnB1dEZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKEZpZWxkSWNvbltGaWVsZFR5cGUuSW5wdXRdLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpOiB2b2lkIHtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiVGVtcGxhdGVcIiwgY2xzOiAnbGFiZWwnIH0pXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgY29uc3QgdGVtcGxhdGVWYWx1ZSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudCh0ZW1wbGF0ZUNvbnRhaW5lcilcbiAgICAgICAgdGVtcGxhdGVWYWx1ZS5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgdGVtcGxhdGVWYWx1ZS5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICB0ZW1wbGF0ZVZhbHVlLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpXG4gICAgICAgIHRlbXBsYXRlVmFsdWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlIHx8IFwiXCIpXG4gICAgICAgIHRlbXBsYXRlVmFsdWUub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZSA9IHZhbHVlO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIC8vYWx3YXlzIHRydWUgc2luY2UgdGhlcmUgYXJlIG5vIG9wdGlvbnNcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLFxuICAgICAgICB2YWx1ZT86IHN0cmluZyxcbiAgICAgICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICAgICAgYWZ0ZXI/OiBib29sZWFuLFxuICAgICAgICBhc0xpc3Q/OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ/OiBib29sZWFuXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgSW5wdXRNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUgfHwgXCJcIiwgbGluZU51bWJlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzOiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0gPSB7fVxuICAgICk6IHZvaWQge1xuICAgICAgICBhdHRycy5jbHMgPSBcInZhbHVlLWNvbnRhaW5lclwiXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGVkaXRCdG4gPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKTtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IChkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpIGFzIEhUTUxEaXZFbGVtZW50KTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHt9KTtcbiAgICAgICAgaW5wdXRDb250YWluZXIuaGlkZSgpO1xuICAgICAgICBjb25zdCBpbnB1dCA9IGlucHV0Q29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIik7XG4gICAgICAgIGlucHV0LnZhbHVlID0gcFt0aGlzLmZpZWxkLm5hbWVdO1xuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXItMVwiIH0pO1xuICAgICAgICBpZiAoYXR0cnMub3B0aW9ucz8uYWx3YXlzT24pIHNwYWNlci5oaWRlKCk7XG4gICAgICAgIHNldEljb24oZWRpdEJ0biwgRmllbGRJY29uW0ZpZWxkVHlwZS5JbnB1dF0pO1xuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgZWRpdEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dENvbnRhaW5lci5pc1Nob3duKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdEJ0bi5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBlZGl0QnRuLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWF0dHJzLm9wdGlvbnM/LmFsd2F5c09uKSBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmFsaWRhdGVJY29uID0gaW5wdXRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24odmFsaWRhdGVJY29uLCBcImNoZWNrbWFya1wiKTtcbiAgICAgICAgdmFsaWRhdGVJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgSW5wdXRGaWVsZC5yZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBwLmZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICBpbnB1dENvbnRhaW5lci5oaWRlKClcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjYW5jZWxJY29uID0gaW5wdXRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oY2FuY2VsSWNvbiwgXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsSWNvbi5vbmNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlucHV0Q29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgICAgIGZpZWxkVmFsdWUuc2hvdygpO1xuICAgICAgICAgICAgZWRpdEJ0bi5zaG93KCk7XG4gICAgICAgICAgICBpZiAoIWF0dHJzLm9wdGlvbnM/LmFsd2F5c09uKSBzcGFjZXIuc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgIGlucHV0LmZvY3VzKClcblxuICAgICAgICBpbnB1dC5vbmtleWRvd24gPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHtcbiAgICAgICAgICAgICAgICBJbnB1dEZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0LnZhbHVlKTtcbiAgICAgICAgICAgICAgICBpbnB1dENvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgaW5wdXRDb250YWluZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGZpZWxkVmFsdWUuc2hvdygpO1xuICAgICAgICAgICAgICAgIGVkaXRCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIGlmICghYXR0cnMub3B0aW9ucz8uYWx3YXlzT24pIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogYnV0dG9uIG9uIGNsaWNrIDogcmVtb3ZlIGJ1dHRvbiBhbmQgZmllbGQgYW5kIGRpc3BsYXkgaW5wdXQgZmllbGQqL1xuICAgICAgICBlZGl0QnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXRNb2RhbCA9IG5ldyBJbnB1dE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBwW3RoaXMuZmllbGQubmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlucHV0Q29udGFpbmVyLnNob3coKTtcbiAgICAgICAgICAgICAgICBpbnB1dC5mb2N1cygpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZFZhbHVlLmhpZGUoKTtcbiAgICAgICAgICAgIGVkaXRCdG4uaGlkZSgpO1xuICAgICAgICAgICAgc3BhY2VyLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBwb3N0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9wb3N0VmFsdWVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBCYXNlTW9kYWwgZnJvbSBcIi4uL2Jhc2VNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnB1dE1vZGFsIGV4dGVuZHMgQmFzZU1vZGFsIHtcbiAgICBwcml2YXRlIHRlbXBsYXRlVmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgcHJpdmF0ZSByZW5kZXJlZFZhbHVlOiBUZXh0QXJlYUNvbXBvbmVudDtcbiAgICBwcml2YXRlIG5ld1ZhbHVlOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHsgc3VwZXIocGx1Z2luKTsgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGVGaWVsZFJlZ2V4ID0gbmV3IFJlZ0V4cChgXFxcXHtcXFxceyg/PGZpZWxkPlteXFxcXH1dKz8pXFxcXH1cXFxcfWAsIFwiZ3VcIik7XG4gICAgICAgICAgICBjb25zdCB0RiA9IHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZS5tYXRjaEFsbCh0ZW1wbGF0ZUZpZWxkUmVnZXgpXG4gICAgICAgICAgICBsZXQgbmV4dCA9IHRGLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV4dC52YWx1ZS5ncm91cHMuZmllbGRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgW25hbWUsIG9wdGlvbnNTdHJpbmddID0gdmFsdWUuc3BsaXQoLzooLiopL3MpLm1hcCgodjogc3RyaW5nKSA9PiB2LnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZVZhbHVlc1tuYW1lXSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0gSlNPTi5wYXJzZShvcHRpb25zU3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRUZW1wbGF0ZVNlbGVjdEl0ZW0odGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pLCBuYW1lLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRUZW1wbGF0ZUlucHV0SXRlbSh0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSksIG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5leHQgPSB0Ri5uZXh0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IHRleHQ6IFwiUmVzdWx0IHByZXZpZXdcIiB9KTtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRSZXN1bHRQcmV2aWV3KHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkSW5wdXRFbCh0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYnVpbGRTYXZlQnRuKHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmb290ZXItYWN0aW9uc1wiIH0pKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSByZW5kZXJWYWx1ZSgpIHtcbiAgICAgICAgbGV0IHJlbmRlcmVkU3RyaW5nID0gdGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlLnNsaWNlKClcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy50ZW1wbGF0ZVZhbHVlcykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkUmVnZXggPSBuZXcgUmVnRXhwKGBcXFxce1xcXFx7JHtrLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyl9KDpbXlxcXFx9XSopP1xcXFx9XFxcXH1gLCBcInVcIilcbiAgICAgICAgICAgIHJlbmRlcmVkU3RyaW5nID0gcmVuZGVyZWRTdHJpbmcucmVwbGFjZShmaWVsZFJlZ2V4LCB0aGlzLnRlbXBsYXRlVmFsdWVzW2tdKVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMucmVuZGVyZWRWYWx1ZS5zZXRWYWx1ZShyZW5kZXJlZFN0cmluZylcbiAgICAgICAgdGhpcy5uZXdWYWx1ZSA9IHJlbmRlcmVkU3RyaW5nXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFRlbXBsYXRlSW5wdXRJdGVtKGZpZWxkQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgbmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiBuYW1lIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgaW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihgRW50ZXIgYSB2YWx1ZSBmb3IgJHtuYW1lfWApO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlVmFsdWVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclZhbHVlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRUZW1wbGF0ZVNlbGVjdEl0ZW0oZmllbGRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IHN0cmluZ1tdKSB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IG5hbWUsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3Qgc2VsZWN0RWwgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJcIiwgXCItLXNlbGVjdC0tXCIpXG4gICAgICAgIG9wdGlvbnMuZm9yRWFjaChvID0+IHNlbGVjdEVsLmFkZE9wdGlvbihvLCBvKSk7XG4gICAgICAgIHNlbGVjdEVsLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVWYWx1ZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyVmFsdWUoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkUmVzdWx0UHJldmlldyhmaWVsZENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlZFZhbHVlID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKVxuICAgICAgICB0aGlzLnJlbmRlcmVkVmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIilcbiAgICAgICAgdGhpcy5yZW5kZXJlZFZhbHVlLmlucHV0RWwucm93cyA9IDM7XG4gICAgICAgIHRoaXMucmVuZGVyZWRWYWx1ZS5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkSW5wdXRFbChjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGlucHV0RWwgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgaW5wdXRFbC5pbnB1dEVsLnJvd3MgPSAzO1xuICAgICAgICBpbnB1dEVsLmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgaW5wdXRFbC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZShgJHt0aGlzLnZhbHVlIHx8IFwiXCJ9YCk7XG4gICAgICAgIGlucHV0RWwub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5uZXdWYWx1ZSA9IHZhbHVlKVxuICAgIH07XG5cbiAgICBwdWJsaWMgYXN5bmMgc2F2ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiB0aGlzLm5ld1ZhbHVlIH0gfV0sIHRoaXMuZmlsZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmFmdGVyLCB0aGlzLmFzTGlzdCwgdGhpcy5hc0NvbW1lbnQpXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIHBhcnNlWWFtbCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpZWxkVHlwZSwgTXVsdGlEaXNwbGF5VHlwZSwgbXVsdGlUeXBlcyB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgZ2V0RmlsZUZyb21GaWxlT3JQYXRoIH0gZnJvbSBcInNyYy91dGlscy9maWxlVXRpbHNcIjtcbmltcG9ydCB7IGdldExpc3RCb3VuZHMgfSBmcm9tIFwic3JjL3V0aWxzL2xpc3RcIjtcbmltcG9ydCAqIGFzIExvb2t1cCBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBmaWVsZENvbXBvbmVudHMsIGlubGluZUZpZWxkUmVnZXgsIGVuY29kZUxpbmssIGRlY29kZUxpbmsgfSBmcm9tIFwic3JjL3V0aWxzL3BhcnNlclwiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCB7IFJlc2VydmVkTXVsdGlBdHRyaWJ1dGVzIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5cbmV4cG9ydCB0eXBlIEZpZWxkUGF5bG9hZCA9IHtcbiAgICB2YWx1ZTogc3RyaW5nLFxuICAgIHByZXZpb3VzSXRlbXNDb3VudD86IG51bWJlcixcbiAgICBhZGRUb0N1cnJlbnRWYWx1ZXM/OiBib29sZWFuXG59XG5cbmV4cG9ydCB0eXBlIEZpZWxkc1BheWxvYWQgPSBBcnJheTx7XG4gICAgbmFtZTogc3RyaW5nLFxuICAgIHBheWxvYWQ6IEZpZWxkUGF5bG9hZFxufT5cblxuY29uc3QgZW51bSBMb2NhdGlvbiB7XG4gICAgJ2Z1bGxMaW5lJyA9ICdmdWxsTGluZScsXG4gICAgJ2JyYWNrZXRzJyA9ICdicmFja2V0cycsXG4gICAgJ3BhcmVudGhlc2lzJyA9ICdwYXJlbnRoZXNpcydcbn1cblxuY29uc3QgTG9jYXRpb25XcmFwcGVyOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIExvY2F0aW9uLCB7IHN0YXJ0OiBcIlwiIHwgXCJbXCIgfCBcIihcIiwgZW5kOiBcIlwiIHwgXCJdXCIgfCBcIilcIiB9PiA9IHtcbiAgICBcImZ1bGxMaW5lXCI6IHsgc3RhcnQ6IFwiXCIsIGVuZDogXCJcIiB9LFxuICAgIFwiYnJhY2tldHNcIjogeyBzdGFydDogXCJbXCIsIGVuZDogXCJdXCIgfSxcbiAgICBcInBhcmVudGhlc2lzXCI6IHsgc3RhcnQ6IFwiKFwiLCBlbmQ6IFwiKVwiIH1cbn1cblxudHlwZSBGaWVsZFJlcGxhY2UgPSB7XG4gICAgb2xkRmllbGQ6IHN0cmluZyxcbiAgICBuZXdGaWVsZDogc3RyaW5nLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyRmllbGQoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZTogVEZpbGUsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgcmF3VmFsdWU6IHN0cmluZyxcbiAgICBsb2NhdGlvbjogXCJ5YW1sXCIgfCBcImlubGluZVwiLFxuKTogYW55IHtcbiAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpXG4gICAgY29uc3QgcGFyc2VGaWVsZFZhbHVlID0gKF9yYXdWYWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmIChfcmF3VmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChfcmF3VmFsdWUuc3RhcnRzV2l0aChcIltbXCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcIiR7X3Jhd1ZhbHVlfVwiYFxuICAgICAgICAgICAgfSBlbHNlIGlmIChfcmF3VmFsdWUuc3RhcnRzV2l0aChcIiNcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7X3Jhd1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZVlhbWwoX3Jhd1ZhbHVlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIlxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHJlbmRlck11bHRpRmllbGRzID0gKHJhd1ZhbHVlOiBzdHJpbmcsIGl0ZW1SZW5kZXJpbmc6IChpdGVtVmFsdWU6IHN0cmluZykgPT4gYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHJhd1ZhbHVlXG4gICAgICAgICAgICAucmVwbGFjZSgvKFxcLFxccyspL2csICcsJylcbiAgICAgICAgICAgIC5zcGxpdCgnLCcpXG4gICAgICAgICAgICAuZmlsdGVyKHYgPT4gISF2KVxuICAgICAgICAgICAgLm1hcCh2YWx1ZSA9PiBpdGVtUmVuZGVyaW5nKHZhbHVlKSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXMubGVuZ3RoID8gdmFsdWVzIDogXCJcIlxuICAgIH1cbiAgICBzd2l0Y2ggKGxvY2F0aW9uKSB7XG4gICAgICAgIGNhc2UgXCJ5YW1sXCI6XG4gICAgICAgICAgICBzd2l0Y2ggKGZpZWxkPy50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBGaWVsZFR5cGUuTG9va3VwOiByZXR1cm4gcmVuZGVyTXVsdGlGaWVsZHMocmF3VmFsdWUsIChpdGVtKSA9PiBwYXJzZUZpZWxkVmFsdWUoaXRlbSkpO1xuICAgICAgICAgICAgICAgIGNhc2UgRmllbGRUeXBlLk11bHRpOiByZXR1cm4gcmVuZGVyTXVsdGlGaWVsZHMocmF3VmFsdWUsIChpdGVtKSA9PiBwYXJzZUZpZWxkVmFsdWUoaXRlbSkpO1xuICAgICAgICAgICAgICAgIGNhc2UgRmllbGRUeXBlLk11bHRpRmlsZTogcmV0dXJuIHJlbmRlck11bHRpRmllbGRzKHJhd1ZhbHVlLCAoaXRlbSkgPT4gYFwiJHtpdGVtfVwiYCk7XG4gICAgICAgICAgICAgICAgY2FzZSBGaWVsZFR5cGUuQ2FudmFzOiByZXR1cm4gcmVuZGVyTXVsdGlGaWVsZHMocmF3VmFsdWUsIChpdGVtKSA9PiBpdGVtID8gYCR7aXRlbX1gIDogXCJcIik7XG4gICAgICAgICAgICAgICAgY2FzZSB1bmRlZmluZWQ6IGlmIChbLi4uUmVzZXJ2ZWRNdWx0aUF0dHJpYnV0ZXMsIHBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc10uaW5jbHVkZXMoZmllbGROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyTXVsdGlGaWVsZHMocmF3VmFsdWUsIChpdGVtKSA9PiBgJHtpdGVtfWApXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmllbGRWYWx1ZShyYXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gcGFyc2VGaWVsZFZhbHVlKHJhd1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgY2FzZSBcImlubGluZVwiOlxuICAgICAgICAgICAgcmV0dXJuIHJhd1ZhbHVlO1xuICAgIH1cblxufVxuXG5leHBvcnQgY29uc3QgbWF0Y2hJbmxpbmVGaWVsZHMgPSAocmVnZXg6IFJlZ0V4cCwgbGluZTogc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZywgbG9jYXRpb246IGtleW9mIHR5cGVvZiBMb2NhdGlvbiA9IFwiZnVsbExpbmVcIik6IEZpZWxkUmVwbGFjZVtdID0+IHtcbiAgICBjb25zdCBzUiA9IGxpbmUubWF0Y2hBbGwocmVnZXgpO1xuICAgIGxldCBuZXh0ID0gc1IubmV4dCgpO1xuICAgIGNvbnN0IG5ld0ZpZWxkczogRmllbGRSZXBsYWNlW10gPSBbXTtcbiAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICBjb25zdCBtYXRjaCA9IG5leHQudmFsdWU7XG4gICAgICAgIGlmIChtYXRjaC5ncm91cHMgJiYgT2JqZWN0LmtleXMobWF0Y2guZ3JvdXBzKS5ldmVyeShqID0+IGZpZWxkQ29tcG9uZW50cy5pbmNsdWRlcyhqKSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgaW5MaXN0LCBpblF1b3RlLCBwcmVTcGFjZXIsIHN0YXJ0U3R5bGUsIGVuZFN0eWxlLCBiZWZvcmVTZXBhcmF0b3JTcGFjZXIsIGFmdGVyU2VwYXJhdG9yU3BhY2VyLCB2YWx1ZXMgfSA9IG1hdGNoLmdyb3Vwc1xuICAgICAgICAgICAgY29uc3QgaW5wdXRBcnJheSA9IGlucHV0ID8gaW5wdXQucmVwbGFjZSgvKFxcLFxccyspL2csICcsJykuc3BsaXQoJywnKSA6IFtcIlwiXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9YDtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gTG9jYXRpb25XcmFwcGVyW2xvY2F0aW9uXS5zdGFydDtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IExvY2F0aW9uV3JhcHBlcltsb2NhdGlvbl0uZW5kO1xuICAgICAgICAgICAgbmV3RmllbGRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG9sZEZpZWxkOiBtYXRjaFswXSxcbiAgICAgICAgICAgICAgICBuZXdGaWVsZDogYCR7aW5RdW90ZSB8fCBcIlwifSR7c3RhcnR9JHtpbkxpc3QgfHwgXCJcIn0ke3ByZVNwYWNlciB8fCBcIlwifSR7c3RhcnRTdHlsZX0ke2F0dHJpYnV0ZX0ke2VuZFN0eWxlfSR7YmVmb3JlU2VwYXJhdG9yU3BhY2VyfTo6JHthZnRlclNlcGFyYXRvclNwYWNlciB8fCBcIiBcIn0ke25ld1ZhbHVlfSR7ZW5kfWAsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIG5leHQgPSBzUi5uZXh0KClcbiAgICB9XG4gICAgcmV0dXJuIG5ld0ZpZWxkc1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcG9zdEZpZWxkc0luWWFtbChcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlOiBURmlsZSxcbiAgICBmaWVsZHM6IFJlY29yZDxzdHJpbmcsIEZpZWxkUGF5bG9hZD5cbikge1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXJcbiAgICBjb25zdCBuZXdDb250ZW50ID0gW11cbiAgICBjb25zdCBjdXJyZW50RmlsZSA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgY29uc3Qgc2tpcHBlZExpbmVzOiBudW1iZXJbXSA9IFtdXG4gICAgY29uc3QgcHVzaE5ld0ZpZWxkID0gKGZpZWxkTmFtZTogc3RyaW5nLCBwYXlsb2FkOiBGaWVsZFBheWxvYWQpOiB2b2lkID0+IHtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSByZW5kZXJGaWVsZChwbHVnaW4sIGZpbGUsIGZpZWxkTmFtZSwgcGF5bG9hZC52YWx1ZSwgXCJ5YW1sXCIpXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG5ld1ZhbHVlKSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKT8uZmluZChmID0+IGYubmFtZSA9PT0gZmllbGROYW1lKTtcbiAgICAgICAgICAgIGlmIChmaWVsZD8uZ2V0RGlzcGxheShwbHVnaW4pID09PSBNdWx0aURpc3BsYXlUeXBlLmFzTGlzdCkge1xuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHtmaWVsZE5hbWV9OmApXG4gICAgICAgICAgICAgICAgbmV3VmFsdWUuZmlsdGVyKHYgPT4gISF2KS5mb3JFYWNoKGl0ZW0gPT4geyBuZXdDb250ZW50LnB1c2goYCAgLSAke2l0ZW19YCkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHtmaWVsZE5hbWV9OiBbJHtuZXdWYWx1ZS5qb2luKFwiICxcIil9XWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke2ZpZWxkTmFtZX06ICR7bmV3VmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWZyb250bWF0dGVyKSB7XG4gICAgICAgIG5ld0NvbnRlbnQucHVzaChcIi0tLVwiKTtcbiAgICAgICAgT2JqZWN0LmVudHJpZXMoZmllbGRzKS5mb3JFYWNoKChbZmllbGROYW1lLCBwYXlsb2FkXSkgPT4gcHVzaE5ld0ZpZWxkKGZpZWxkTmFtZSwgcGF5bG9hZCkpO1xuICAgICAgICBuZXdDb250ZW50LnB1c2goXCItLS1cIilcbiAgICAgICAgbmV3Q29udGVudC5wdXNoKC4uLmN1cnJlbnRGaWxlLnNwbGl0KFwiXFxuXCIpKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gY3VycmVudEZpbGUuc3BsaXQoXCJcXG5cIilcbiAgICAgICAgY3VycmVudENvbnRlbnQuZm9yRWFjaCgobGluZSwgbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgaWYgKGxpbmVOdW1iZXIgPiBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZSkge1xuICAgICAgICAgICAgICAgIC8vIGRvbid0IHRvdWNoIG91dHNpZGUgZnJvbnRtYXR0ZXIgOiBpdCdzIGhhbmRsZWQgYnkgcG9zdEZpZWxkc0lubGluZVxuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lTnVtYmVyID09PSBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZSkge1xuICAgICAgICAgICAgICAgIC8vaW5zZXJ0IGhlcmUgdGhlIG5ldyBmaWVsZHMgICAgXG4gICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoZmllbGRzKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKChbZmllbGROYW1lLCBwYXlsb2FkXSkgPT4gIU9iamVjdC5rZXlzKGZyb250bWF0dGVyKS5pbmNsdWRlcyhmaWVsZE5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaCgoW2ZpZWxkTmFtZSwgcGF5bG9hZF0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1c2hOZXdGaWVsZChmaWVsZE5hbWUsIHBheWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFza2lwcGVkTGluZXMuaW5jbHVkZXMobGluZU51bWJlcikpIHtcbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIGFueSBvZiBmaWVsZHMgaXMgbWF0Y2hpbmcgdGhpcyBsaW5lIGFuZCBza2lwIGxpbmVzIHVuZGVuZWF0aCBtb2RpZmllZCBtdWx0aSBmaWVsZHM6IHRoZXkgYXJlIHJlY29uc3RydWN0ZWRcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVkRmllbGQ6IHsgbmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkLCBwYXlsb2FkOiBGaWVsZFBheWxvYWQgfCB1bmRlZmluZWQgfSA9IHsgbmFtZTogdW5kZWZpbmVkLCBwYXlsb2FkOiB1bmRlZmluZWQgfVxuXG4gICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoZmllbGRzKS5mb3JFYWNoKChbZmllbGROYW1lLCBwYXlsb2FkXSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYF4ke2ZpZWxkTmFtZX06YCwgJ3UnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2VhcmNoIGZvciBpbmRlbnRlZCB2YWx1ZSBcImJlbG93XCIgYW5kIHNraXAgdGhlbVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGogPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnRDb250ZW50W2xpbmVOdW1iZXIgKyBqXS5zdGFydHNXaXRoKFwiICAtIFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRMaW5lcy5wdXNoKGxpbmVOdW1iZXIgKyBqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqID0gaiArIDFcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgaGF2ZSBhIG1hdGNoXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVkRmllbGQubmFtZSA9IGZpZWxkTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZEZpZWxkLnBheWxvYWQgPSBwYXlsb2FkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGlmIChtYXRjaGVkRmllbGQubmFtZSAmJiBtYXRjaGVkRmllbGQucGF5bG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBwdXNoTmV3RmllbGQobWF0Y2hlZEZpZWxkLm5hbWUsIG1hdGNoZWRGaWVsZC5wYXlsb2FkKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG4gICAgY29uc3QgdXBkYXRlZEZpbGUgPSBuZXdDb250ZW50LmpvaW4oJ1xcbicpXG4gICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgdXBkYXRlZEZpbGUpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcG9zdEZpZWxkc0lubGluZShcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlOiBURmlsZSxcbiAgICBmaWVsZHNUb1VwZGF0ZTogUmVjb3JkPHN0cmluZywgRmllbGRQYXlsb2FkPixcbiAgICBmaWVsZHNUb0NyZWF0ZTogUmVjb3JkPHN0cmluZywgRmllbGRQYXlsb2FkPixcbiAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgIGFmdGVyOiBib29sZWFuID0gdHJ1ZSxcbiAgICBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuKSB7XG4gICAgLy9maXJzdCBsb29rIGZvciBsb29rdXAgbGlzdHNcblxuICAgIGNvbnN0IHNraXBwZWRMaW5lczogbnVtYmVyW10gPSBbXVxuICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdXG4gICAgY29uc3QgY3VycmVudENvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcblxuICAgIC8vZmlyc3Qgc3RlcDogaW5zZXJ0IGZpZWxkcyB0byBDcmVhdGVcbiAgICBjdXJyZW50Q29udGVudC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4ge1xuICAgICAgICBpZiAoX2xpbmVOdW1iZXIgPT0gbGluZU51bWJlcikge1xuICAgICAgICAgICAgaWYgKGFmdGVyKSBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICBPYmplY3QuZW50cmllcyhmaWVsZHNUb0NyZWF0ZSkuZm9yRWFjaCgoW2ZpZWxkTmFtZSwgcGF5bG9hZF0pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMaW5lID0gYCR7YXNDb21tZW50ID8gXCI+XCIgOiBcIlwifSR7YXNMaXN0ID8gXCItIFwiIDogXCJcIn0ke2ZpZWxkTmFtZX06OiAke3BheWxvYWQudmFsdWV9YDtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobmV3TGluZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKCFhZnRlcikgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCB1cGRhdGVDb250ZW50V2l0aEZpZWxkID0gKGNvbnRlbnQ6IHN0cmluZ1tdLCBmaWVsZE5hbWU6IHN0cmluZywgcGF5bG9hZDogRmllbGRQYXlsb2FkKTogc3RyaW5nW10gPT4ge1xuICAgICAgICByZXR1cm4gY29udGVudC5tYXAoKGxpbmUsIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVuY29kZWRJbnB1dCA9IGVuY29kZUxpbmsocGF5bG9hZC52YWx1ZSlcbiAgICAgICAgICAgIGxldCBlbmNvZGVkTGluZSA9IGVuY29kZUxpbmsobGluZSlcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxMaW5lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtpbmxpbmVGaWVsZFJlZ2V4KGZpZWxkTmFtZSl9KD88dmFsdWVzPlteXFxcXF1dKilgLCBcInVcIik7XG4gICAgICAgICAgICBjb25zdCBmUiA9IGVuY29kZWRMaW5lLm1hdGNoKGZ1bGxMaW5lUmVnZXgpO1xuICAgICAgICAgICAgaWYgKGZSPy5ncm91cHMgJiYgT2JqZWN0LmtleXMoZlIuZ3JvdXBzKS5ldmVyeShqID0+IGZpZWxkQ29tcG9uZW50cy5pbmNsdWRlcyhqKSkpIHtcbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIHRoaXMgZmllbGQgaXMgYSBsb29rdXAgYW5kIGdldCBsaXN0IGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpXG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkPy50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvdW5kcyA9IGdldExpc3RCb3VuZHMocGx1Z2luLCBmaWxlLCBpKVxuICAgICAgICAgICAgICAgICAgICBpZiAoYm91bmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IGJvdW5kcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSBzdGFydCArIDE7IGogPCBzdGFydCArIChwYXlsb2FkLnByZXZpb3VzSXRlbXNDb3VudCB8fCAwKSArIDEgJiYgaiA8IGVuZCArIDE7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRMaW5lcy5wdXNoKGopXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgeyBpbkxpc3QsIGluUXVvdGUsIHByZVNwYWNlciwgc3RhcnRTdHlsZSwgZW5kU3R5bGUsIGJlZm9yZVNlcGFyYXRvclNwYWNlciwgYWZ0ZXJTZXBhcmF0b3JTcGFjZXIsIHZhbHVlcyB9ID0gZlIuZ3JvdXBzXG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXRBcnJheSA9IHBheWxvYWQudmFsdWUgPyBwYXlsb2FkLnZhbHVlLnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykuc29ydCgpIDogW107XG4gICAgICAgICAgICAgICAgbGV0IG5ld1ZhbHVlOiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgbGV0IGhpZGRlblZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBsZXQgZW1wdHlMaW5lQWZ0ZXJMaXN0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQ/LnR5cGUgPT09IEZpZWxkVHlwZS5Mb29rdXAgJiYgTG9va3VwLmJ1bGxldExpc3RMb29rdXBUeXBlcy5pbmNsdWRlcyhmaWVsZD8ub3B0aW9ucy5vdXRwdXRUeXBlIGFzIExvb2t1cC5UeXBlKSkge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGBuZXh0IGxpbmUgWyR7Y29udGVudFtpICsgKHBheWxvYWQucHJldmlvdXNJdGVtc0NvdW50IHx8IDApICsgMV19XWApXG4gICAgICAgICAgICAgICAgICAgIGVtcHR5TGluZUFmdGVyTGlzdCA9IGNvbnRlbnRbaSArIChwYXlsb2FkLnByZXZpb3VzSXRlbXNDb3VudCB8fCAwKSArIDFdICE9PSBcIlwiID8gXCJcXG5cIiA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PT0gMSA/IFwiXFxuLSBcIiArIGlucHV0QXJyYXlbMF0gOiBgJHtpbnB1dEFycmF5Lmxlbmd0aCA+IDAgPyBcIlxcblwiIDogXCJcIn0ke2lucHV0QXJyYXkubWFwKGl0ZW0gPT4gXCItIFwiICsgaXRlbSkuam9pbignXFxuJyl9YDtcbiAgICAgICAgICAgICAgICAgICAgLy8gaGlkZSB0aGUgdmFsdWVzIG5leHQgdG8gdGhlIGZpZWxkIHNvIHRoYXQgdGhleSBhcmUgcmVhZGFibGUgYnkgZ2V0VmFsdWVzLiBcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgbmVlZCBnZXRWYWx1ZXMgaW5zdGVhZCBvZiBkdi5wYWdlIHRvIGhhdmUgdGhlIHJhd1ZhbHVlIGJlY2F1c2UgZHYgaXMgdHJhbnNmb3JtaW5nIGRhdGEsIG1ha2luZyBjb21wYXJpc29uIGltcG9zc2libGVcbiAgICAgICAgICAgICAgICAgICAgaGlkZGVuVmFsdWUgPSBgPGRpdiBoaWRkZW4gaWQ9XCIke2ZpZWxkLm5hbWV9X3ZhbHVlc1wiPiR7cGF5bG9hZC52YWx1ZX08L2Rpdj5gXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkuam9pbignLCAnKX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7aW5RdW90ZSB8fCBcIlwifSR7aW5MaXN0IHx8IFwiXCJ9JHtwcmVTcGFjZXIgfHwgXCJcIn0ke3N0YXJ0U3R5bGV9JHtmaWVsZE5hbWV9JHtlbmRTdHlsZX0ke2JlZm9yZVNlcGFyYXRvclNwYWNlcn06OiR7YWZ0ZXJTZXBhcmF0b3JTcGFjZXIgfHwgXCIgXCJ9JHtoaWRkZW5WYWx1ZSArIG5ld1ZhbHVlICsgZW1wdHlMaW5lQWZ0ZXJMaXN0fWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkczogRmllbGRSZXBsYWNlW10gPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtpbmxpbmVGaWVsZFJlZ2V4KGZpZWxkTmFtZSl9KD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluU2VudGVuY2VSZWdleFBhciA9IG5ldyBSZWdFeHAoYFxcXFwoJHtpbmxpbmVGaWVsZFJlZ2V4KGZpZWxkTmFtZSl9KD88dmFsdWVzPlteXFxcXCldKyk/XFxcXClgLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKC4uLm1hdGNoSW5saW5lRmllbGRzKGluU2VudGVuY2VSZWdleEJyYWNrZXRzLCBlbmNvZGVkTGluZSwgZmllbGROYW1lLCBlbmNvZGVkSW5wdXQsIExvY2F0aW9uLmJyYWNrZXRzKSlcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5tYXRjaElubGluZUZpZWxkcyhpblNlbnRlbmNlUmVnZXhQYXIsIGVuY29kZWRMaW5lLCBmaWVsZE5hbWUsIGVuY29kZWRJbnB1dCwgTG9jYXRpb24ucGFyZW50aGVzaXMpKVxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRSZWdleCA9IG5ldyBSZWdFeHAoZmllbGQub2xkRmllbGQucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKSwgXCJ1XCIpXG4gICAgICAgICAgICAgICAgICAgIGVuY29kZWRMaW5lID0gZW5jb2RlZExpbmUucmVwbGFjZShmaWVsZFJlZ2V4LCBmaWVsZC5uZXdGaWVsZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlTGluayhlbmNvZGVkTGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLy9pdGVyYXRlIG92ZXIgZWFjaCBmaWVsZCB0byB1cGRhdGUgdGhlbSBpbiB0aGUgbmV3IGNvbnRlbnRcbiAgICBPYmplY3QuZW50cmllcyhmaWVsZHNUb1VwZGF0ZSkuZm9yRWFjaCgoW2ZpZWxkTmFtZSwgcGF5bG9hZF0pID0+IHtcbiAgICAgICAgbmV3Q29udGVudCA9IHVwZGF0ZUNvbnRlbnRXaXRoRmllbGQobmV3Q29udGVudCwgZmllbGROYW1lLCBwYXlsb2FkKVxuICAgIH0pXG5cbiAgICAvL2NvbnNvbGUubG9nKFwic3RhcnRlZCB3cml0aW5nLi4uXCIsIGlucHV0KVxuICAgIGNvbnN0IHVwZGF0ZWRGaWxlID0gbmV3Q29udGVudC5maWx0ZXIoKGxpbmUsIGkpID0+ICFza2lwcGVkTGluZXMuaW5jbHVkZXMoaSkpLmpvaW4oJ1xcbicpXG4gICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgdXBkYXRlZEZpbGUpO1xuICAgIC8vY29uc29sZS5sb2coXCJmaW5pc2hlZCB3cml0aW5nLi4uXCIsIGlucHV0KVxuICAgIGNvbnN0IGVkaXRvciA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZWRpdG9yXG4gICAgaWYgKGVkaXRvcikge1xuICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmVcbiAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lLCBjaDogZWRpdG9yLmdldExpbmUobGluZU51bWJlcikubGVuZ3RoIH0pXG4gICAgfVxufVxuXG4vL2NyZWF0ZSBvciB1cGRhdGUgdmFsdWVzIHN0YXJ0aW5nIGF0IGxpbmUgb3IgaW4gZnJvbnRtYXR0ZXIgaWYgbm8gbGluZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBvc3RWYWx1ZXMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgcGF5bG9hZDogRmllbGRzUGF5bG9hZCxcbiAgICBmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsXG4gICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICBhZnRlcjogYm9vbGVhbiA9IHRydWUsXG4gICAgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2Vcbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGZpbGUgPSBnZXRGaWxlRnJvbUZpbGVPclBhdGgocGx1Z2luLCBmaWxlT3JGaWxlUGF0aCk7XG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlclxuICAgIGNvbnN0IHsgcG9zaXRpb246IHsgc3RhcnQsIGVuZCB9IH0gPSBmcm9udG1hdHRlciA/IGZyb250bWF0dGVyIDogeyBwb3NpdGlvbjogeyBzdGFydDogdW5kZWZpbmVkLCBlbmQ6IHVuZGVmaW5lZCB9IH07XG4gICAgY29uc3QgZHZBUGkgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgY29uc3QgaW5Gcm9udG1hdHRlciA9ICEhKGxpbmVOdW1iZXIgPT09IC0xIHx8IChsaW5lTnVtYmVyICYmIHN0YXJ0ICYmIGVuZCAmJiBsaW5lTnVtYmVyID49IHN0YXJ0LmxpbmUgJiYgbGluZU51bWJlciA8PSBlbmQubGluZSkpXG4gICAgY29uc3QgdG9DcmVhdGVJbmxpbmU6IFJlY29yZDxzdHJpbmcsIEZpZWxkUGF5bG9hZD4gPSB7fTtcbiAgICBjb25zdCB0b1VwZGF0ZUlubGluZTogUmVjb3JkPHN0cmluZywgRmllbGRQYXlsb2FkPiA9IHt9O1xuICAgIGNvbnN0IHRvWWFtbDogUmVjb3JkPHN0cmluZywgRmllbGRQYXlsb2FkPiA9IHt9O1xuICAgIHBheWxvYWQuZm9yRWFjaChhc3luYyBpdGVtID0+IHtcbiAgICAgICAgY29uc3QgY3JlYXRlID0gIWdlbnVpbmVLZXlzKGR2QVBpLnBhZ2UoZmlsZS5wYXRoKSkuaW5jbHVkZXMoaXRlbS5uYW1lKVxuICAgICAgICBpZiAoY3JlYXRlKSB7XG4gICAgICAgICAgICBpZiAoIWxpbmVOdW1iZXIgfHwgaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgICAgIHRvWWFtbFtpdGVtLm5hbWVdID0gaXRlbS5wYXlsb2FkXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvQ3JlYXRlSW5saW5lW2l0ZW0ubmFtZV0gPSBpdGVtLnBheWxvYWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGR2QXBpID0gcGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGR2QXBpICYmIGR2QXBpLnBhZ2UoZmlsZS5wYXRoKT8uW2l0ZW0ubmFtZV1cbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZiA9PiBmLm5hbWUgPT09IGl0ZW0ubmFtZSlcbiAgICAgICAgICAgIGNvbnN0IG11bHRpID0gZmllbGQgJiYgbXVsdGlUeXBlcy5pbmNsdWRlcyhmaWVsZC50eXBlKVxuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBjdXJyZW50VmFsdWVcbiAgICAgICAgICAgICAgICAmJiBpdGVtLnBheWxvYWQuYWRkVG9DdXJyZW50VmFsdWVzXG4gICAgICAgICAgICAgICAgJiYgKG11bHRpIHx8IFJlc2VydmVkTXVsdGlBdHRyaWJ1dGVzLmluY2x1ZGVzKGl0ZW0ubmFtZSkpID9cbiAgICAgICAgICAgICAgICBgJHtjdXJyZW50VmFsdWV9LCAke2l0ZW0ucGF5bG9hZC52YWx1ZX1gIDpcbiAgICAgICAgICAgICAgICBpdGVtLnBheWxvYWQudmFsdWVcbiAgICAgICAgICAgIGl0ZW0ucGF5bG9hZC52YWx1ZSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgT2JqZWN0LmtleXMoZnJvbnRtYXR0ZXIpLmluY2x1ZGVzKGl0ZW0ubmFtZSkpIHtcbiAgICAgICAgICAgICAgICB0b1lhbWxbaXRlbS5uYW1lXSA9IGl0ZW0ucGF5bG9hZFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0b1VwZGF0ZUlubGluZVtpdGVtLm5hbWVdID0gaXRlbS5wYXlsb2FkXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuICAgIGNvbnNvbGUubG9nKHRvWWFtbCwgdG9DcmVhdGVJbmxpbmUsIHRvVXBkYXRlSW5saW5lKVxuICAgIGlmIChPYmplY3Qua2V5cyh0b1lhbWwpLmxlbmd0aCkgYXdhaXQgcGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAucHVzaFRhc2soKCkgPT4geyBwb3N0RmllbGRzSW5ZYW1sKHBsdWdpbiwgZmlsZSwgdG9ZYW1sKSB9KVxuICAgIGlmIChPYmplY3Qua2V5cyh0b0NyZWF0ZUlubGluZSkubGVuZ3RoIHx8IE9iamVjdC5rZXlzKHRvVXBkYXRlSW5saW5lKS5sZW5ndGgpIGF3YWl0IHBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcG9zdEZpZWxkc0lubGluZShwbHVnaW4sIGZpbGUsIHRvVXBkYXRlSW5saW5lLCB0b0NyZWF0ZUlubGluZSwgbGluZU51bWJlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KSB9KVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQge1xuICAgIG5vcm1hbGl6ZVBhdGgsXG4gICAgVEFic3RyYWN0RmlsZSxcbiAgICBURmlsZSxcbiAgICBURm9sZGVyLFxuICAgIFZhdWx0LFxufSBmcm9tIFwib2JzaWRpYW5cIjtcblxuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZV90Zm9sZGVyKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmb2xkZXJfc3RyOiBzdHJpbmcpOiBURm9sZGVyIHtcbiAgICBmb2xkZXJfc3RyID0gbm9ybWFsaXplUGF0aChmb2xkZXJfc3RyKTtcblxuICAgIGNvbnN0IGZvbGRlciA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlcl9zdHIpO1xuICAgIGlmICghZm9sZGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRm9sZGVyIFwiJHtmb2xkZXJfc3RyfVwiIGRvZXNuJ3QgZXhpc3RgKTtcbiAgICB9XG4gICAgaWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke2ZvbGRlcl9zdHJ9IGlzIGEgZmlsZSwgbm90IGEgZm9sZGVyYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvbGRlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF90ZmlsZXNfZnJvbV9mb2xkZXIoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZm9sZGVyX3N0cjogc3RyaW5nXG4pOiBBcnJheTxURmlsZT4ge1xuICAgIGNvbnN0IGZvbGRlciA9IHJlc29sdmVfdGZvbGRlcihwbHVnaW4sIGZvbGRlcl9zdHIpO1xuXG4gICAgY29uc3QgZmlsZXM6IEFycmF5PFRGaWxlPiA9IFtdO1xuICAgIFZhdWx0LnJlY3Vyc2VDaGlsZHJlbihmb2xkZXIsIChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVzLnB1c2goZmlsZSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGZpbGVzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgcmV0dXJuIGEuYmFzZW5hbWUubG9jYWxlQ29tcGFyZShiLmJhc2VuYW1lKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBmaWxlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVGcm9tRmlsZU9yUGF0aChwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nKSB7XG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JGaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JGaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPckZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpbGVcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTGlzdEl0ZW1DYWNoZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RCb3VuZHMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBwYXJlbnQ6IG51bWJlcik6IHsgc3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXIgfSB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgbGlzdEl0ZW1zOiBMaXN0SXRlbUNhY2hlW10gPSAocGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8ubGlzdEl0ZW1zIHx8IFtdKVxuICAgIHJldHVybiBnZXRMaXN0Qm91bmRzRnJvbUxpc3RJdGVtQ2FjaGVMaXN0KGxpc3RJdGVtcywgcGFyZW50KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGlzdEJvdW5kc0Zyb21MaXN0SXRlbUNhY2hlTGlzdChcbiAgICBsaXN0SXRlbXM6IExpc3RJdGVtQ2FjaGVbXSxcbiAgICBwYXJlbnQ6IG51bWJlclxuKTogeyBzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlciB9IHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBzdWJQYXJlbnRzTGluZXMgPSBbLXBhcmVudCAtIDFdO1xuICAgIGxldCBzdGFydDogbnVtYmVyID0gcGFyZW50O1xuICAgIGxldCBlbmQ6IG51bWJlciA9IC0xO1xuICAgIGxldCBvdXRPZkxpc3Q6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBsaXN0SXRlbXNcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEucG9zaXRpb24uc3RhcnQubGluZSAtIGIucG9zaXRpb24uc3RhcnQubGluZSlcbiAgICAgICAgLmZvckVhY2gobGlzdEl0ZW0gPT4ge1xuICAgICAgICAgICAgaWYgKHN1YlBhcmVudHNMaW5lcy5pbmNsdWRlcyhsaXN0SXRlbS5wYXJlbnQpICYmICFvdXRPZkxpc3QpIHtcbiAgICAgICAgICAgICAgICBzdWJQYXJlbnRzTGluZXMucHVzaChsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPiBsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lKSBzdGFydCA9IGxpc3RJdGVtLnBvc2l0aW9uLnN0YXJ0LmxpbmU7XG4gICAgICAgICAgICAgICAgaWYgKGVuZCA8PSBsaXN0SXRlbS5wb3NpdGlvbi5lbmQubGluZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGlzdEl0ZW0ucG9zaXRpb24uZW5kLmxpbmUgPT0gbGlzdEl0ZW0ucG9zaXRpb24uc3RhcnQubGluZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kID0gbGlzdEl0ZW0ucG9zaXRpb24uZW5kLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0T2ZMaXN0ID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIGlmIChlbmQgPj0gMCkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCB9KVxuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kIH1cbiAgICB9XG4gICAgcmV0dXJuXG59IiwgImV4cG9ydCBlbnVtIEJ1aWx0aW5TdW1tYXJpemluZyB7XG4gICAgXCJTdW1cIiA9IFwiU3VtXCIsXG4gICAgXCJDb3VudFwiID0gXCJDb3VudFwiLFxuICAgIFwiQ291bnRBbGxcIiA9IFwiQ291bnRBbGxcIixcbiAgICBcIkF2ZXJhZ2VcIiA9IFwiQXZlcmFnZVwiLFxuICAgIFwiTWF4XCIgPSBcIk1heFwiLFxuICAgIFwiTWluXCIgPSBcIk1pblwiXG59XG5cbmV4cG9ydCBjb25zdCBCdWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbkRlc2NyaXB0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEJ1aWx0aW5TdW1tYXJpemluZywgc3RyaW5nPiA9IHtcbiAgICBcIlN1bVwiOiBcIlJldHVybnMgdGhlIHN1bSBvZiA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGZpZWxkcyBpbiB0aGUgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5XCIsXG4gICAgXCJDb3VudFwiOiBcIkNvdW50cyBhbGwgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5IHdoZXJlIDx7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fT4gaXMgbm9uIGVtcHR5XCIsXG4gICAgXCJDb3VudEFsbFwiOiBcIkNvdW50cyBhbGwgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5IChpbmNsdWRpbmcgZW1wdHkgZmllbGRzKVwiLFxuICAgIFwiQXZlcmFnZVwiOiBcIlJldHVybnMgdGhlIGF2ZXJhZ2UgdmFsdWUgb2YgPHt7c3VtbWFyaXplZEZpZWxkTmFtZX19PiBmaWVsZHMgaW4gdGhlIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeVwiLFxuICAgIFwiTWF4XCI6IFwiUmV0dXJucyB0aGUgbWF4aW11bSB2YWx1ZSBvZiA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGZpZWxkcyBpbiB0aGUgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5XCIsXG4gICAgXCJNaW5cIjogXCJSZXR1cm5zIHRoZSBtaW5pbXVtIHZhbHVlIG9mIDx7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fT4gZmllbGRzIGluIHRoZSBwYWdlcyBtYXRjaGluZyB0aGUgcXVlcnlcIixcbn1cblxuZXhwb3J0IGNvbnN0IEJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEJ1aWx0aW5TdW1tYXJpemluZywgc3RyaW5nPiA9IHtcbiAgICBcIlN1bVwiOiBcImNvbnN0IGk9MDtjb25zdCBzdW0gPSBwYWdlcy5yZWR1Y2UoKHAsIGMpID0+IHAgKyBjW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdLCBpKTsgcmV0dXJuIHN1bVwiLFxuICAgIFwiQ291bnRBbGxcIjogXCJyZXR1cm4gcGFnZXMubGVuZ3RoXCIsXG4gICAgXCJDb3VudFwiOiBcInJldHVybiBwYWdlcy5maWx0ZXIocCA9PiAhIXBbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0pLmxlbmd0aFwiLFxuICAgIFwiQXZlcmFnZVwiOiBcImNvbnN0IGk9MC4wO2NvbnN0IHN1bSA9IHBhZ2VzLnJlZHVjZSgocCwgYykgPT4gcCArIGNbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0sIGkpOyByZXR1cm4gc3VtIC8gcGFnZXMubGVuZ3RoXCIsXG4gICAgXCJNYXhcIjogXCJyZXR1cm4gcGFnZXMucmVkdWNlKChwLGMpID0+IHBbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0gPj0gY1tcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSA/IHAgOiBjKVtcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXVwiLFxuICAgIFwiTWluXCI6IFwicmV0dXJuIHBhZ2VzLnJlZHVjZSgocCxjKSA9PiBwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdIT09bnVsbCAmJiBwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdIDw9IGNbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0gPyBwIDogYylbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl1cIlxufVxuXG5leHBvcnQgZW51bSBUeXBlIHtcbiAgICBcIkxpbmtzTGlzdFwiID0gXCJMaW5rc0xpc3RcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiID0gXCJMaW5rc0J1bGxldExpc3RcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiID0gXCJCdWlsdGluU3VtbWFyaXppbmdcIixcbiAgICBcIkN1c3RvbUxpc3RcIiA9IFwiQ3VzdG9tTGlzdFwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiID0gXCJDdXN0b21CdWxsZXRMaXN0XCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiID0gXCJDdXN0b21TdW1tYXJpemluZ1wiXG59XG5cbmV4cG9ydCBjb25zdCBTaG9ydERlc2NyaXB0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJJbmxpbmUgbGlzdCBvZiBsaW5rc1wiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiQnVsbGV0IGxpc3Qgb2YgbGlua3NcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIlwiLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBcIklubGluZSBsaXN0IG9mIGN1c3RvbWl6ZWQgbGlua3NcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJCdWxsZXQgbGlzdCBvZiBjdXN0b21pemVkIGxpbmtzXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcIkN1c3RvbSBzdW1tYXJpemluZyBmdW5jdGlvblwiXG59XG5cbmV4cG9ydCBjb25zdCBNYXBwaW5nTGFiZWw6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgVHlwZT4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogVHlwZS5MaW5rc0xpc3QsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogVHlwZS5MaW5rc0J1bGxldExpc3QsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogVHlwZS5CdWlsdGluU3VtbWFyaXppbmcsXG4gICAgXCJDdXN0b21MaXN0XCI6IFR5cGUuQ3VzdG9tTGlzdCxcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogVHlwZS5DdXN0b21CdWxsZXRMaXN0LFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogVHlwZS5DdXN0b21TdW1tYXJpemluZ1xufVxuXG5leHBvcnQgY29uc3QgRGVzY3JpcHRpb246IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIkxpbmtzTGlzdFwiOiBcIkxpc3Qgb2YgcmVsYXRlZCBsaW5rcyBkaXNwbGF5ZWQgaW5saW5lXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJMaXN0IG9mIHJlbGF0ZWQgbGlua3MgZGlzcGxheWVkIGJlbG93IHRoZSBmaWVsZFwiLFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IFwiQnVpbHQtaW4gc3VtbWFyaXppbmcgZnVuY3Rpb25cIixcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJDdXN0b20gbGlzdCByZW5kZXJpbmcgZnVuY3Rpb24gZGlzcGxheWVkIGlubGluZVwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcIkN1c3RvbSBsaXN0IHJlbmRlcmluZyBmdW5jdGlvbiBkaXNwbGF5ZWQgYmVsb3cgdGhlIGZpZWxkXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcIkN1c3RvbSBzdW1tYXJpemluZyBmdW5jdGlvblwiXG59XG5cbmV4cG9ydCBjb25zdCBPcHRpb25MYWJlbDogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIkJ1aWx0LWluIHN1bW1hcml6ZSBmdW5jdGlvbjpcIixcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJRdWVyeSdzIHJlc3VsdHMnIGxpc3QncyByZW5kZXJpbmcgZnVuY3Rpb246XCIsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IFwiUXVlcnkncyByZXN1bHRzJyBsaXN0J3MgcmVuZGVyaW5nIGZ1bmN0aW9uOlwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJRdWVyeSdzIHJlc3VsdHMnIGxpc3QncyBzdW1tYXJpemluZyBmdW5jdGlvbjpcIlxufVxuXG5cbmV4cG9ydCBjb25zdCBPcHRpb25TdWJMYWJlbDogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIlwiLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBgZnVuY3Rpb24ocGFnZSkgeyByZXR1cm4gPGZ1bmN0aW9uIHVzaW5nIFwicGFnZVwiPjsgfWAsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IGBmdW5jdGlvbihwYWdlKSB7IHJldHVybiA8ZnVuY3Rpb24gdXNpbmcgXCJwYWdlXCI+OyB9YCxcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IGBmdW5jdGlvbihwYWdlKSB7IHJldHVybiA8ZnVuY3Rpb24gdXNpbmcgXCJwYWdlXCI+OyB9YFxufVxuXG5leHBvcnQgY29uc3QgSGVscGVyOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiOiBcIlwiLFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IFwiXCIsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwiSmF2YXNjcmlwdCBzdHJpbmcsIFwiICtcbiAgICAgICAgXCJ0aGUgXFxcInBhZ2VcXFwiIChkYXRhdmlldyBwYWdlIHR5cGUpIHZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcblwiICtcbiAgICAgICAgXCJleGFtcGxlIDE6IHBhZ2UuZmlsZS5uYW1lXFxuZXhhbXBsZSAyOiBgJHtwYWdlLmZpbGUubmFtZX0gb2YgZ2VuZGVyICR7cGFnZS5nZW5kZXJ9YFwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcIkphdmFzY3JpcHQgc3RyaW5nLCBcIiArXG4gICAgICAgIFwidGhlIFxcXCJwYWdlXFxcIiAoZGF0YXZpZXcgcGFnZSB0eXBlKSB2YXJpYWJsZSBpcyBhdmFpbGFibGVcXG5cIiArXG4gICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIixcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IFwiSmF2YXNjcmlwdCBzdHJpbmcsIHRoZSBcXFwicGFnZXNcXFwiIChkYXRhdmlldyBwYWdlcyB0eXBlKSBcIiArXG4gICAgICAgIFwidmFyaWFibGUgaXMgYXZhaWxhYmxlXFxuZXhhbXBsZTogXCIgK1xuICAgICAgICBcIlxcbmNvbnN0IGluaXRpYWxWYWx1ZSA9IDA7XFxuY29uc3Qgc3VtV2l0aEluaXRpYWwgPSBwYWdlcy5yZWR1Y2UoXFxuXCIgK1xuICAgICAgICBcIiAgICAocHJldmlvdXNWYWx1ZSwgY3VycmVudFZhbHVlKSA9PiBwcmV2aW91c1ZhbHVlICsgY3VycmVudFZhbHVlLFxcblwiICtcbiAgICAgICAgXCIgICAgaW5pdGlhbFZhbHVlXFxuKTtcXG5yZXR1cm4gYCR7c3VtV2l0aEluaXRpYWx9YFxcblwiXG59XG5cbmV4cG9ydCBjb25zdCBEZWZhdWx0OiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiOiBcIlwiLFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IEJ1aWx0aW5TdW1tYXJpemluZy5Db3VudCxcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJwYWdlLmZpbGUubmFtZVwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcInBhZ2UuZmlsZS5uYW1lXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcInJldHVybiBwYWdlcy5sZW5ndGhcIlxufVxuXG5leHBvcnQgY29uc3QgYnVsbGV0TGlzdExvb2t1cFR5cGVzID0gW1xuICAgIFR5cGUuTGlua3NCdWxsZXRMaXN0LFxuICAgIFR5cGUuQ3VzdG9tQnVsbGV0TGlzdFxuXVxuXG5leHBvcnQgZW51bSBTdGF0dXMge1xuICAgIFwiY2hhbmdlZFwiID0gXCJjaGFuZ2VkXCIsXG4gICAgXCJ1cFRvRGF0ZVwiID0gXCJ1cFRvRGF0ZVwiXG59IiwgImV4cG9ydCBjb25zdCBmaWVsZENvbXBvbmVudHMgPSBbJ2luUXVvdGUnLCAnaW5MaXN0JywgJ3ByZVNwYWNlcicsICdzdGFydFN0eWxlJywgJ2F0dHJpYnV0ZScsICdlbmRTdHlsZScsICdiZWZvcmVTZXBhcmF0b3JTcGFjZXInLCAnYWZ0ZXJTZXBhcmF0b3JTcGFjZXInLCAndmFsdWVzJ11cblxuZXhwb3J0IGNvbnN0IGdlbmVyaWNGaWVsZFJlZ2V4ID0gXCIoPzxpblF1b3RlPlxcPihcXFxccyspPyk/KD88aW5MaXN0Pi0gKT8oPzxwcmVTcGFjZXI+KFxcXFxzKyk/KT8oPzxzdGFydFN0eWxlPltfXFxcXCp+YF0qKSg/PGF0dHJpYnV0ZT5bMC05XFxcXHdcXFxccHtMZXR0ZXJ9XFxcXHB7RW1vamlfUHJlc2VudGF0aW9ufV1bLTAtOVxcXFx3XFxcXHB7TGV0dGVyfVxcXFxwe0Vtb2ppX1ByZXNlbnRhdGlvbn1cXFxcc10qKSg/PGVuZFN0eWxlPltfXFxcXCp+YF0qKSg/PGJlZm9yZVNlcGFyYXRvclNwYWNlcj5cXFxccyopXCI7XG5cbmV4cG9ydCBjb25zdCBpbmxpbmVGaWVsZFJlZ2V4ID0gKGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBgKD88aW5RdW90ZT5cXD4oXFxcXHMrKT8pPyg/PGluTGlzdD4tICk/KD88cHJlU3BhY2VyPihcXFxccyspPyk/KD88c3RhcnRTdHlsZT5bX1xcXFwqflxcYF0qKSg/PGF0dHJpYnV0ZT4ke2F0dHJpYnV0ZX0pKD88ZW5kU3R5bGU+W19cXFxcKn5cXGBdKikoPzxiZWZvcmVTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKTo6KD88YWZ0ZXJTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKWA7XG5cbmV4cG9ydCBjb25zdCBmdWxsTGluZVJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9OjpcXFxccyooPzx2YWx1ZXM+LiopP2AsIFwidVwiKTtcblxuZXhwb3J0IGNvbnN0IGluU2VudGVuY2VSZWdleEJyYWNrZXRzID0gbmV3IFJlZ0V4cChgXFxcXFske2dlbmVyaWNGaWVsZFJlZ2V4fTo6XFxcXHMqKD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuXG5leHBvcnQgY29uc3QgaW5TZW50ZW5jZVJlZ2V4UGFyID0gbmV3IFJlZ0V4cChgXFxcXCgke2dlbmVyaWNGaWVsZFJlZ2V4fTo6XFxcXHMqKD88dmFsdWVzPlteXFxcXCldKyk/XFxcXClgLCBcImd1XCIpO1xuXG5leHBvcnQgY29uc3QgZW5jb2RlTGluayA9ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICAvKiByZXBsYWNlIGxpbmsgYnJhY2tldHMgYnkgXCJpbXBvc3NpYmxlXCIgY29tYmluYXRpb24gb2YgY2hhcmFjdGVycyBzbyB0aGF0IHRoZXkgd29uJ3QgYmUgbWl4ZWQgdXAgd2l0aCBpblNlbnRlbmNlIGZpZWxkIGJyYWNrZXRzIHdoZW4gc2VhY2hpbmcgd2l0aCByZWdleCovXG4gICAgcmV0dXJuIHZhbHVlID8gdmFsdWVcbiAgICAgICAgLnJlcGxhY2UoL1xcW1xcWy9nLCBcIlx1RDgzRFx1REQyN1x1RDgzRFx1REMwMFwiKVxuICAgICAgICAucmVwbGFjZSgvXFxdXFxdL2csIFwiXHVEODNEXHVEQzEzXHVEODNEXHVERDRDXCIpIDogdmFsdWVcbn1cblxuZXhwb3J0IGNvbnN0IGRlY29kZUxpbmsgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgLyogcmVwbGFjZSBsaW5rIGJyYWNrZXRzIGJ5IFwiaW1wb3NzaWJsZVwiIGNvbWJpbmF0aW9uIG9mIGNoYXJhY3RlcnMgc28gdGhhdCB0aGV5IHdvbid0IGJlIG1peGVkIHVwIHdpdGggaW5TZW50ZW5jZSBmaWVsZCBicmFja2V0cyB3aGVuIHNlYWNoaW5nIHdpdGggcmVnZXgqL1xuICAgIHJldHVybiB2YWx1ZSA/IHZhbHVlXG4gICAgICAgIC5yZXBsYWNlKC9cdUQ4M0RcdUREMjdcdUQ4M0RcdURDMDAvZ3UsIFwiW1tcIilcbiAgICAgICAgLnJlcGxhY2UoL1x1RDgzRFx1REMxM1x1RDgzRFx1REQ0Qy9ndSwgXCJdXVwiKSA6IHZhbHVlXG59XG5cbmV4cG9ydCBjb25zdCBmcm9udE1hdHRlckxpbmVGaWVsZCA9IChsaW5lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xuICAgIGNvbnN0IGZyb250TWF0dGVyUmVnZXggPSBuZXcgUmVnRXhwKC8oPzxhdHRyaWJ1dGU+WzAtOVxcd1xccHtMZXR0ZXJ9XFxwe0Vtb2ppX1ByZXNlbnRhdGlvbn1dWy0wLTlcXHdcXHB7TGV0dGVyfVxccHtFbW9qaV9QcmVzZW50YXRpb259XFxzXSpbXlxcc10pKD88YmVmb3JlU2VwYXJhdG9yU3BhY2VyPlxccyopOig/PGFmdGVyU2VwYXJhdG9yU3BhY2VyPlxccyopKD88dmFsdWVzPi4qKS91KVxuICAgIGNvbnN0IGZSID0gbGluZS5tYXRjaChmcm9udE1hdHRlclJlZ2V4KTtcblxuICAgIGlmIChmUj8uZ3JvdXBzKSB7XG4gICAgICAgIGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IGZSPy5ncm91cHNcbiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldExpbmVGaWVsZHMgPSAobGluZTogc3RyaW5nKTogeyBhdHRyaWJ1dGU6IHN0cmluZywgdmFsdWVzOiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyIH1bXSA9PiB7XG4gICAgY29uc3QgZmllbGRzOiB7IGF0dHJpYnV0ZTogc3RyaW5nLCB2YWx1ZXM6IHN0cmluZywgaW5kZXg6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIgfVtdID0gW11cbiAgICBjb25zdCBmUiA9IGxpbmUubWF0Y2goZnVsbExpbmVSZWdleCk7XG4gICAgaWYgKGZSPy5ncm91cHMpIHtcbiAgICAgICAgY29uc3QgeyBhdHRyaWJ1dGUsIHZhbHVlcyB9ID0gZlI/Lmdyb3Vwc1xuICAgICAgICBmaWVsZHMucHVzaCh7IGF0dHJpYnV0ZSwgdmFsdWVzLCBpbmRleDogMCwgbGVuZ3RoOiBsaW5lLmxlbmd0aCB9KVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHNSQmsgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoQWxsKGluU2VudGVuY2VSZWdleEJyYWNrZXRzKTtcbiAgICAgICAgbGV0IG5leHQgPSBzUkJrLm5leHQoKTtcbiAgICAgICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgICAgIGlmIChuZXh0LnZhbHVlLmdyb3Vwcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IG5leHQudmFsdWUuZ3JvdXBzO1xuICAgICAgICAgICAgICAgIGZpZWxkcy5wdXNoKHsgYXR0cmlidXRlLCB2YWx1ZXM6IGRlY29kZUxpbmsodmFsdWVzKSwgaW5kZXg6IG5leHQudmFsdWUuaW5kZXggfHwgMCwgbGVuZ3RoOiBuZXh0LnZhbHVlWzBdLmxlbmd0aCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5leHQgPSBzUkJrLm5leHQoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzUkJjID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhQYXIpO1xuICAgICAgICBuZXh0ID0gc1JCYy5uZXh0KCk7XG4gICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICBpZiAobmV4dC52YWx1ZS5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBuZXh0LnZhbHVlLmdyb3VwcztcbiAgICAgICAgICAgICAgICBmaWVsZHMucHVzaCh7IGF0dHJpYnV0ZSwgdmFsdWVzOiBkZWNvZGVMaW5rKHZhbHVlcyksIGluZGV4OiBuZXh0LnZhbHVlLmluZGV4IHx8IDAsIGxlbmd0aDogbmV4dC52YWx1ZVswXS5sZW5ndGggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXh0ID0gc1JCYy5uZXh0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmllbGRzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgaWYgKGEuaW5kZXggPCBiLmluZGV4KSByZXR1cm4gLTE7XG4gICAgICAgIGlmIChhLmluZGV4ID4gYi5pbmRleCkgcmV0dXJuIDE7XG4gICAgICAgIHJldHVybiAwXG4gICAgfSlcbiAgICByZXR1cm4gZmllbGRzXG59IiwgImV4cG9ydCBmdW5jdGlvbiBnZW51aW5lS2V5cyhkdkZpbGU6IGFueSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBnZW51aW5lS2V5czogc3RyaW5nW10gPSBbXVxuICAgIE9iamVjdC5rZXlzKGR2RmlsZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAoIWdlbnVpbmVLZXlzLm1hcChrID0+IGsudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKS5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKSkge1xuICAgICAgICAgICAgZ2VudWluZUtleXMucHVzaChrZXkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoa2V5ICE9PSBrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKSB7XG4gICAgICAgICAgICAgICAgZ2VudWluZUtleXNbZ2VudWluZUtleXMuaW5kZXhPZihrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKV0gPSBrZXlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGdlbnVpbmVLZXlzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlRHVyYXRpb24oZHZEdXJBOiBhbnksIGR2RHVyQjogYW55KTogYm9vbGVhbiB7XG4gICAgY29uc3Qgbm9ybWFsaXplZEEgPSBkdkR1ckEuc2hpZnRUbyhcInllYXJzXCIsIFwibW9udGhzXCIsIFwid2Vla3NcIiwgXCJkYXlzXCIsIFwiaG91cnNcIiwgXCJtaW51dGVzXCIsIFwic2Vjb25kc1wiLCBcIm1pbGxpc2Vjb25kc1wiKS5ub3JtYWxpemUoKVxuICAgIGNvbnN0IG5vcm1hbGl6ZWRCID0gZHZEdXJCLnNoaWZ0VG8oXCJ5ZWFyc1wiLCBcIm1vbnRoc1wiLCBcIndlZWtzXCIsIFwiZGF5c1wiLCBcImhvdXJzXCIsIFwibWludXRlc1wiLCBcInNlY29uZHNcIiwgXCJtaWxsaXNlY29uZHNcIikubm9ybWFsaXplKClcbiAgICByZXR1cm4gbm9ybWFsaXplZEEuZXF1YWxzKG5vcm1hbGl6ZWRCKVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcClcbiAgICB9XG4gICAgb25PcGVuKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLm9ua2V5ZG93biA9IGFzeW5jIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc2F2ZShlPzogRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy90byBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzc2VzXG4gICAgICAgIHRocm93IEVycm9yKFwiU3ViY2xhc3Mgc2hvdWxkIGltcGxlbWVudCBhIHNhdmUgbWV0aG9kXCIpXG4gICAgfVxuXG4gICAgcHVibGljIGJ1aWxkU2F2ZUJ0bihmaWVsZENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IHNhdmVCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgc2F2ZUJ0bi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnRuLm9uQ2xpY2soYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmUoZSk7XG4gICAgICAgIH0pXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcG9zdFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcG9zdFZhbHVlc1wiO1xuaW1wb3J0IEZDU00gZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcbmltcG9ydCBJbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL21vZGFscy9pbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEZNLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi9GaWVsZFwiO1xuXG5leHBvcnQgY29uc3QgZW51bSBTZXR0aW5nTG9jYXRpb24ge1xuICAgIFwiUGx1Z2luU2V0dGluZ3NcIixcbiAgICBcIkZpbGVDbGFzc0F0dHJpYnV0ZVNldHRpbmdzXCJcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBhYnN0cmFjdCBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZDU00gfCBGaWVsZE9wdGlvbnMpOiB2b2lkO1xuICAgIGFic3RyYWN0IHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuO1xuICAgIGFic3RyYWN0IGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZDtcbiAgICBhYnN0cmFjdCBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7XG4gICAgICAgICAgICBjbHM/OiBzdHJpbmcsXG4gICAgICAgICAgICBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPixcbiAgICAgICAgICAgIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gICAgICAgIH1cbiAgICApOiB2b2lkXG4gICAgYWJzdHJhY3QgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmc7XG4gICAgYWJzdHJhY3QgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkO1xuICAgIHB1YmxpYyBzaG93TW9kYWxPcHRpb246IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LCBwdWJsaWMgZmllbGQ6IEZpZWxkLCBwdWJsaWMgdHlwZTogRmllbGRUeXBlKSB7XG4gICAgICAgIGlmIChmaWVsZC50eXBlICE9PSB0eXBlKSB0aHJvdyBFcnJvcihgVGhpcyBmaWVsZCBpcyBub3Qgb2YgdHlwZSAke3R5cGV9YClcbiAgICB9XG5cbiAgICBzdGF0aWMgYnVpbGRNYXJrRG93bkxpbmsocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBwYXRoOiBzdHJpbmcsIHN1YlBhdGg/OiBzdHJpbmcsIGFsaWFzPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZGVzdEZpbGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocGF0aCwgZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZGVzdEZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBwbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKFxuICAgICAgICAgICAgICAgIGRlc3RGaWxlLFxuICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICBzdWJQYXRoLFxuICAgICAgICAgICAgICAgIGFsaWFzLFxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlTmFtZSh0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQsIGNvbnRlbnRFbDogRWxlbWVudCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgaWYgKC9eWyM+LV0vLnRlc3QodGhpcy5maWVsZC5uYW1lKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0ZXh0SW5wdXQsXG4gICAgICAgICAgICAgICAgXCJGaWVsZCBuYW1lIGNhbm5vdCBzdGFydCB3aXRoICMsID4sIC1cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRleHRJbnB1dCxcbiAgICAgICAgICAgICAgICBcIkZpZWxkIG5hbWUgY2FuIG5vdCBiZSBFbXB0eVwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gIWVycm9yXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHJlcGxhY2VWYWx1ZXMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHBhdGg6IHN0cmluZywgZmllbGROYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBhd2FpdCBwb3N0VmFsdWVzKHBsdWdpbiwgW3sgbmFtZTogZmllbGROYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiB2YWx1ZSB9IH1dLCBmaWxlKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpc01lbnUobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIE1lbnUge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIE1lbnUpLmFkZEl0ZW0gIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBpc1N1Z2dlc3QobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIEZDU00ge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIEZDU00pLmdldEl0ZW1zICE9PSB1bmRlZmluZWQ7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIHN0cmluZykgPT09IFwiSW5zZXJ0RmllbGRDb21tYW5kXCI7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGQ1NNIHwgRmllbGRPcHRpb25zKTogbG9jYXRpb24gaXMgRmllbGRPcHRpb25zIHtcbiAgICAgICAgcmV0dXJuIChsb2NhdGlvbiBhcyBGaWVsZE9wdGlvbnMpLmFkZE9wdGlvbiAhPT0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlQW5kT3Blbk1vZGFsKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgICAgICBmaWVsZDogRmllbGQgfCB1bmRlZmluZWQsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBhZnRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFzTGlzdD86IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudD86IGJvb2xlYW5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRk1bZmllbGQudHlwZV0ocGx1Z2luLCBmaWVsZCk7XG4gICAgICAgICAgICBmaWVsZE1hbmFnZXIuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZSwgZmllbGROYW1lLCB2YWx1ZSwgbGluZU51bWJlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEZpZWxkTWFuYWdlci5jcmVhdGVEZWZhdWx0KHBsdWdpbiwgZmllbGROYW1lISk7XG4gICAgICAgICAgICBmaWVsZE1hbmFnZXIuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZSwgZmllbGROYW1lISwgdmFsdWUsIGxpbmVOdW1iZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIG9wZW5GaWVsZE1vZGFsKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGZpZWxkTmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkLFxuICAgICAgICB2YWx1ZTogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICkge1xuICAgICAgICBpZiAoIWZpZWxkTmFtZSkge1xuICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgSW5zZXJ0RmllbGRTdWdnZXN0TW9kYWwocGx1Z2luLCBmaWxlLCBsaW5lTnVtYmVyLCBhZnRlcik7XG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICAgICAgICAgIGlmIChmaWVsZCkgdGhpcy5jcmVhdGVBbmRPcGVuTW9kYWwocGx1Z2luLCBmaWxlLCBmaWVsZE5hbWUsIGZpZWxkLCB2YWx1ZSwgbGluZU51bWJlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlRGVmYXVsdChwbHVnaW46IE1ldGFkYXRhTWVudSwgbmFtZTogc3RyaW5nKTogRmllbGRNYW5hZ2VyIHtcbiAgICAgICAgY29uc3QgZmllbGQgPSBGaWVsZC5jcmVhdGVEZWZhdWx0KG5hbWUpO1xuICAgICAgICByZXR1cm4gbmV3IEZNW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nVG9Cb29sZWFuKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHRvQm9vbGVhblZhbHVlOiBib29sZWFuID0gZmFsc2U7XG4gICAgICAgIGlmIChpc0Jvb2xlYW4odmFsdWUpKSB7XG4gICAgICAgICAgICB0b0Jvb2xlYW5WYWx1ZSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2UgaWYgKC90cnVlL2kudGVzdCh2YWx1ZSkgfHwgLzEvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICB0b0Jvb2xlYW5WYWx1ZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoL2ZhbHNlL2kudGVzdCh2YWx1ZSkgfHwgLzAvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICB0b0Jvb2xlYW5WYWx1ZSA9IGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdG9Cb29sZWFuVmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2tlZCA9ICgpID0+IHsgfSk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBsZXQgdmFsdWVUZXh0OiBzdHJpbmc7XG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgc3dpdGNoIChkdkFwaS5wYWdlKGZpbGUucGF0aClbZmllbGROYW1lXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOiB2YWx1ZVRleHQgPSBcIlwiOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIG51bGw6IHZhbHVlVGV4dCA9IFwiXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgZmFsc2U6IHZhbHVlVGV4dCA9IFwiZmFsc2VcIjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiB2YWx1ZVRleHQgPSBcIjBcIjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDogdmFsdWVUZXh0ID0gZHZBcGkucGFnZShmaWxlLnBhdGgpW2ZpZWxkTmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZVRleHQgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB2YWx1ZVRleHQgfSlcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZ1enp5TWF0Y2gsIEZ1enp5U3VnZ2VzdE1vZGFsLCBzZXRJY29uLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSwgRmllbGRUeXBlVGFnQ2xhc3MgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBhZGROZXdGaWVsZE1vZGFsIGZyb20gXCIuL2FkZE5ld0ZpZWxkTW9kYWxcIjtcblxuXG5pbnRlcmZhY2UgT3B0aW9uIHtcbiAgICBhY3Rpb25MYWJlbDogc3RyaW5nLFxuICAgIHR5cGU/OiBGaWVsZFR5cGVcbn1cblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPE9wdGlvbj4ge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuLFxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICB9O1xuXG4gICAgZ2V0SXRlbXMoKTogT3B0aW9uW10ge1xuICAgICAgICByZXR1cm4gW3sgYWN0aW9uTGFiZWw6ICcrK05ldysrJyB9XVxuICAgICAgICAgICAgLmNvbmNhdCh0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzXG4gICAgICAgICAgICAgICAgLmdldCh0aGlzLmZpbGUucGF0aCk/Lm1hcChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGFjdGlvbkxhYmVsOiBmaWVsZC5uYW1lLCB0eXBlOiBmaWVsZC50eXBlIH1cbiAgICAgICAgICAgICAgICB9KSB8fCBbXVxuICAgICAgICAgICAgKTtcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBPcHRpb24pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaXRlbS5hY3Rpb25MYWJlbDtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IEZ1enp5TWF0Y2g8T3B0aW9uPiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY29udGFpbmVyXCIpXG4gICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwiaWNvbi1jb250YWluZXJcIiB9KVxuICAgICAgICBpdGVtLml0ZW0udHlwZSA/IHNldEljb24oaWNvbkNvbnRhaW5lciwgRmllbGRJY29uW2l0ZW0uaXRlbS50eXBlXSkgOiBzZXRJY29uKGljb25Db250YWluZXIsIFwicGx1cy13aXRoLWNpcmNsZVwiKVxuICAgICAgICBlbC5jcmVhdGVEaXYoeyB0ZXh0OiBpdGVtLml0ZW0uYWN0aW9uTGFiZWwgfSlcbiAgICAgICAgZWwuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGlmIChpdGVtLml0ZW0udHlwZSkgZWwuY3JlYXRlRGl2KHsgY2xzOiBgY2hpcCAke0ZpZWxkVHlwZVRhZ0NsYXNzW2l0ZW0uaXRlbS50eXBlXX1gLCB0ZXh0OiBpdGVtLml0ZW0udHlwZSB9KVxuICAgIH1cblxuICAgIG9uQ2hvb3NlSXRlbShpdGVtOiBPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGl0ZW0uYWN0aW9uTGFiZWwgPT09IFwiKytOZXcrK1wiKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdGaWVsZE1vZGFsID0gbmV3IGFkZE5ld0ZpZWxkTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMubGluZU51bWJlciwgdGhpcy5maWxlLCB0aGlzLmFmdGVyKTtcbiAgICAgICAgICAgIG5ld0ZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldCh0aGlzLmZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gaXRlbS5hY3Rpb25MYWJlbClcbiAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIGZpZWxkKTtcbiAgICAgICAgICAgICAgICBmaWVsZE1hbmFnZXIuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwodGhpcy5maWxlLCBpdGVtLmFjdGlvbkxhYmVsLCBcIlwiLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuYWZ0ZXIsIGZhbHNlLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCB7IE1vZGFsLCBUZXh0Q29tcG9uZW50LCBCdXR0b25Db21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBwb3N0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9wb3N0VmFsdWVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGFkZE5ld0ZpZWxkTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW5cbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkluc2VydCBuZXcgZmllbGRcIik7XG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIG5hbWVDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJGaWVsZCBuYW1lOiBcIiwgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KG5hbWVDb250YWluZXIpO1xuICAgICAgICBuYW1lSW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIik7XG4gICAgICAgIG5hbWVJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHZhbHVlQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiRmllbGQgdmFsdWU6IFwiLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgY29uc3QgdmFsdWVJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgdmFsdWVJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgdmFsdWVJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgY29uc3QgZm9vdGVyQnV0dG9ucyA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6ICdmb290ZXItYWN0aW9ucydcbiAgICAgICAgfSk7XG4gICAgICAgIGZvb3RlckJ1dHRvbnMuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICBjb25zdCBzYXZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmb290ZXJCdXR0b25zKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogbmFtZUlucHV0LmdldFZhbHVlKCksIHBheWxvYWQ6IHsgdmFsdWU6IHZhbHVlSW5wdXQuZ2V0VmFsdWUoKSB9IH1dLCB0aGlzLmZpbGUsIHRoaXMubGluZU51bWJlciwgdGhpcy5hZnRlcik7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZvb3RlckJ1dHRvbnMpO1xuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpO1xuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgTm90aWNlLCBUZXh0Q29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50LCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQsIHsgRmllbGRDb21tYW5kIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgRmllbGRUeXBlLCBGaWVsZFR5cGVMYWJlbE1hcHBpbmcsIEZpZWxkVHlwZVRvb2x0aXAsIE11bHRpRGlzcGxheVR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRTZXR0aW5nc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgbmFtZVByb21wdENvbXBvbmVudDogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIHNhdmVkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBmaWVsZDogRmllbGQ7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgbmV3OiBib29sZWFuID0gdHJ1ZTtcbiAgICBwcml2YXRlIGZpZWxkT3B0aW9uc0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBmaWVsZE1hbmFnZXI6IEY7XG4gICAgcHJpdmF0ZSBjb21tYW5kOiBGaWVsZENvbW1hbmQ7XG4gICAgcHJpdmF0ZSBhZGRDb21tYW5kOiBib29sZWFuO1xuICAgIHByaXZhdGUgYXV0b1N1Z2dlc3Q/OiBib29sZWFuO1xuICAgIHByaXZhdGUgZnJvbnRtYXR0ZXJMaXN0RGlzcGxheT86IE11bHRpRGlzcGxheVR5cGU7XG4gICAgcHJpdmF0ZSBmcm9udG1hdHRlckxpc3REaXNwbGF5Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGljb25OYW1lOiBUZXh0Q29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgcGFyZW50U2V0dGluZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcGFyZW50U2V0dGluZz86IEZpZWxkU2V0dGluZyxcbiAgICAgICAgZmllbGQ/OiBGaWVsZFxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5pbml0aWFsRmllbGQgPSBuZXcgRmllbGQoKTtcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICB0aGlzLm5ldyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpZWxkLCB0aGlzLmZpZWxkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IG5ld0lkID0gMTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHByb3AuaWQpICYmIHBhcnNlSW50KHByb3AuaWQpID49IG5ld0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0lkID0gcGFyc2VJbnQocHJvcC5pZCkgKyAxO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSBuZXcgRmllbGQoKTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQuaWQgPSBuZXdJZC50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5pbml0aWFsRmllbGQuaWQgPSBuZXdJZC50b1N0cmluZygpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCA9IHRoaXMuZmllbGQuY29tbWFuZCAhPT0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNvbW1hbmQgPSB0aGlzLmZpZWxkLmNvbW1hbmQgfHwge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZmllbGQgPyBgaW5zZXJ0X18ke3RoaXMuZmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X18ke3RoaXMuZmllbGQubmFtZX1gIDogXCJcIixcbiAgICAgICAgICAgIGljb246IFwibGlzdC1wbHVzXCIsXG4gICAgICAgICAgICBsYWJlbDogdGhpcy5maWVsZCA/IGBJbnNlcnQgJHt0aGlzLmZpZWxkLm5hbWV9IGZpZWxkYCA6IFwiXCIsXG4gICAgICAgICAgICBob3RrZXk6IHVuZGVmaW5lZFxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICAgICAgaWYgKHRoaXMuZmllbGQubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgQWRkIGEgZmllbGQgYW5kIGRlZmluZSBvcHRpb25zYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIHNldHRpbmdzIG9wdGlvbnMgZm9yICR7dGhpcy5maWVsZC5uYW1lfWApO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qIE5hbWUgKi9cbiAgICAgICAgdGhpcy5jcmVhdGVuYW1lSW5wdXRDb250YWluZXIoKTtcbiAgICAgICAgdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICAvKiBDb21tYW5kICovXG4gICAgICAgIHRoaXMuY3JlYXRlQ29tbWFuZENvbnRhaW5lcigpO1xuXG4gICAgICAgIC8qIGZyb250bWF0dGVyIGxpc3QgZGlzcGxheSovXG4gICAgICAgIHRoaXMuY3JlYXRlRnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lcigpO1xuXG4gICAgICAgIC8qIFR5cGUgKi9cbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICAvKiBPcHRpb25zICovXG4gICAgICAgIHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG5cbiAgICAgICAgLyogZm9vdGVyIGJ1dHRvbnMqL1xuICAgICAgICBjb25zdCBmb290ZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KTtcbiAgICAgICAgZm9vdGVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZVNhdmVCdXR0b24oZm9vdGVyKTtcbiAgICAgICAgdGhpcy5jcmVhdGVDYW5jZWxCdXR0b24oZm9vdGVyKTtcblxuICAgICAgICAvKiBpbml0IHN0YXRlICovXG4gICAgICAgIHRoaXMuY3JlYXRlVHlwZVNlbGVjdG9yQ29udGFpbmVyKHR5cGVTZWxlY3RDb250YWluZXIpXG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uUGx1Z2luU2V0dGluZ3MpXG4gICAgfTtcblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICBpZiAoIXRoaXMubmV3ICYmIHRoaXMucGFyZW50U2V0dGluZykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnRTZXR0aW5nLnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2F2ZWQpIHtcbiAgICAgICAgICAgIG5ldyBGaWVsZFNldHRpbmcodGhpcy5wYXJlbnRTZXR0aW5nQ29udGFpbmVyLCB0aGlzLmZpZWxkLCB0aGlzLnBsdWdpbik7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlbmFtZUlucHV0Q29udGFpbmVyKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiBcIkZpZWxkIE5hbWU6IFwiIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZmllbGQubmFtZTtcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUobmFtZSk7XG4gICAgICAgIGlucHV0LnNldFBsYWNlaG9sZGVyKFwiTmFtZSBvZiB0aGUgZmllbGRcIik7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kLmlkID0gYGluc2VydF9fJHt0aGlzLmZpZWxkLmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwifV9fJHt2YWx1ZX1gXG4gICAgICAgICAgICB0aGlzLmNvbW1hbmQubGFiZWwgPSBgSW5zZXJ0ICR7dmFsdWV9IGZpZWxkYFxuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYE1hbmFnZSBwcmVkZWZpbmVkIG9wdGlvbnMgZm9yICR7dGhpcy5maWVsZC5uYW1lfWApO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcihpbnB1dCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQgPSBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVUeXBlU2VsZWN0b3JDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdG9yQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICB0eXBlU2VsZWN0b3JDb250YWluZXJMYWJlbC5zZXRUZXh0KGBGaWVsZCB0eXBlOmApO1xuICAgICAgICBwYXJlbnROb2RlLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBzZWxlY3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQocGFyZW50Tm9kZSk7XG4gICAgICAgIE9iamVjdC5rZXlzKEZpZWxkVHlwZUxhYmVsTWFwcGluZykuZm9yRWFjaCgoZjoga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSkgPT4gc2VsZWN0LmFkZE9wdGlvbihmLCBGaWVsZFR5cGVUb29sdGlwW2ZdKSlcbiAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSkge1xuICAgICAgICAgICAgc2VsZWN0LnNldFZhbHVlKHRoaXMuZmllbGQudHlwZSlcbiAgICAgICAgICAgIGlmIChbRmllbGRUeXBlLk11bHRpLCBGaWVsZFR5cGUuU2VsZWN0LCBGaWVsZFR5cGUuQ3ljbGVdLmluY2x1ZGVzKHRoaXMuZmllbGQudHlwZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIuc2hvdygpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSgodHlwZUxhYmVsOiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lID0gdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LmdldFZhbHVlKClcbiAgICAgICAgICAgIHRoaXMuZmllbGQudHlwZSA9IEZpZWxkVHlwZUxhYmVsTWFwcGluZ1t0eXBlTGFiZWxdO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSAhPT0gdGhpcy5pbml0aWFsRmllbGQudHlwZSAmJlxuICAgICAgICAgICAgICAgICFbdGhpcy5maWVsZC50eXBlLCB0aGlzLmluaXRpYWxGaWVsZC50eXBlXS5ldmVyeShmaWVsZFR5cGUgPT5cbiAgICAgICAgICAgICAgICAgICAgW0ZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLkN5Y2xlXS5pbmNsdWRlcyhmaWVsZFR5cGUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChbRmllbGRUeXBlLk11bHRpLCBGaWVsZFR5cGUuU2VsZWN0LCBGaWVsZFR5cGUuQ3ljbGVdLmluY2x1ZGVzKHRoaXMuZmllbGQudHlwZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIuc2hvdygpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZClcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uUGx1Z2luU2V0dGluZ3MpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGcm9udG1hdHRlckxpc3REaXNwbGF5Q29udGFpbmVyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgLy9sYWJlbFxuICAgICAgICB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXlDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJGcm9udG1hdHRlciBsaXN0IGRpc3BsYXkgdHlwZVwiLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgLy9hZGQgdG9nZ2xlclxuICAgICAgICBjb25zdCBmcm9udG1hdHRlckxpc3REaXNwbGF5ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheUNvbnRhaW5lcik7XG4gICAgICAgIGNvbnN0IG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuICAgICAgICBvcHRpb25zW1wiYXNBcnJheVwiXSA9IFwiZGlzcGxheSBhcyBhcnJheVwiXG4gICAgICAgIG9wdGlvbnNbXCJhc0xpc3RcIl0gPSBcImRpc3BsYXkgYXMgaW5kZW50ZWQgbGlzdFwiXG4gICAgICAgIG9wdGlvbnNbXCJ1bmRlZmluZWRcIl0gPSBgUGx1Z2luIERlZmF1bHQgKCR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheX0pYFxuICAgICAgICBmcm9udG1hdHRlckxpc3REaXNwbGF5LmFkZE9wdGlvbnMob3B0aW9ucyk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5maWVsZC5kaXNwbGF5KSB7XG4gICAgICAgICAgICBjYXNlIE11bHRpRGlzcGxheVR5cGUuYXNBcnJheTogZnJvbnRtYXR0ZXJMaXN0RGlzcGxheS5zZXRWYWx1ZShcImFzQXJyYXlcIik7IGJyZWFrXG4gICAgICAgICAgICBjYXNlIE11bHRpRGlzcGxheVR5cGUuYXNMaXN0OiBmcm9udG1hdHRlckxpc3REaXNwbGF5LnNldFZhbHVlKFwiYXNMaXN0XCIpOyBicmVha1xuICAgICAgICAgICAgY2FzZSB1bmRlZmluZWQ6IGZyb250bWF0dGVyTGlzdERpc3BsYXkuc2V0VmFsdWUoXCJ1bmRlZmluZWRcIik7IGJyZWFrXG4gICAgICAgIH1cblxuICAgICAgICBmcm9udG1hdHRlckxpc3REaXNwbGF5Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiYXNBcnJheVwiOiB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXkgPSBNdWx0aURpc3BsYXlUeXBlLmFzQXJyYXk7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJhc0xpc3RcIjogdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5ID0gTXVsdGlEaXNwbGF5VHlwZS5hc0xpc3Q7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ1bmRlZmluZWRcIjogdGhpcy5mcm9udG1hdHRlckxpc3REaXNwbGF5ID0gdW5kZWZpbmVkOyBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiB0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlQ29tbWFuZENvbnRhaW5lcigpOiB2b2lkIHtcblxuICAgICAgICBjb25zdCBjb21tYW5kQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIC8vbGFiZWxcbiAgICAgICAgY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcInNldCBhIGNvbW1hbmQgZm9yIHRoaXMgZmllbGQ/XCIsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgLy9hZGQgY29tbWFuZFxuICAgICAgICBjb25zdCBhZGRDb21tYW5kVG9nZ2xlciA9IG5ldyBUb2dnbGVDb21wb25lbnQoY29tbWFuZENvbnRhaW5lcik7XG4gICAgICAgIGFkZENvbW1hbmRUb2dnbGVyLnNldFZhbHVlKHRoaXMuYWRkQ29tbWFuZCk7XG5cbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCA/IGljb25Db250YWluZXIuc2hvdygpIDogaWNvbkNvbnRhaW5lci5oaWRlKCk7XG5cbiAgICAgICAgLy8gaWNvblxuICAgICAgICBpY29uQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiSWNvbiBuYW1lXCIsIGNsczogXCJsYWJlbFwiIH0pXG4gICAgICAgIHRoaXMuaWNvbk5hbWUgPSBuZXcgVGV4dENvbXBvbmVudChpY29uQ29udGFpbmVyKVxuICAgICAgICB0aGlzLmljb25OYW1lLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLmljb25OYW1lLmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICBjb25zdCBpY29uUHJldmlldyA9IGljb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tcHJldmlld1wiIH0pXG4gICAgICAgIHRoaXMuaWNvbk5hbWUuc2V0VmFsdWUodGhpcy5jb21tYW5kLmljb24pXG4gICAgICAgIHNldEljb24oaWNvblByZXZpZXcsIHRoaXMuY29tbWFuZC5pY29uKVxuICAgICAgICB0aGlzLmljb25OYW1lLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5pY29uID0gdmFsdWU7XG4gICAgICAgICAgICBzZXRJY29uKGljb25QcmV2aWV3LCB2YWx1ZSlcbiAgICAgICAgfSlcblxuICAgICAgICBhZGRDb21tYW5kVG9nZ2xlci5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZENvbW1hbmQgPSB2YWx1ZVxuICAgICAgICAgICAgdGhpcy5hZGRDb21tYW5kID8gaWNvbkNvbnRhaW5lci5zaG93KCkgOiBpY29uQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUZpZWxkcygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlTmFtZShcbiAgICAgICAgICAgIHRoaXMubmFtZVByb21wdENvbXBvbmVudCxcbiAgICAgICAgICAgIHRoaXMuY29udGVudEVsXG4gICAgICAgICkgJiZcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlT3B0aW9ucygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU2F2ZUJ1dHRvbihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGIgPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcilcbiAgICAgICAgYi5zZXRUb29sdGlwKFwiU2F2ZVwiKTtcbiAgICAgICAgYi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBiLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGVycm9yID0gIXRoaXMudmFsaWRhdGVGaWVsZHMoKTtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGaXggZXJyb3JzIGJlZm9yZSBzYXZpbmcuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGhpcy5hZGRDb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5jb21tYW5kID0gdGhpcy5jb21tYW5kXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZpZWxkLmNvbW1hbmRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmZyb250bWF0dGVyTGlzdERpc3BsYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQuZGlzcGxheSA9IHRoaXMuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWVsZC5kaXNwbGF5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNhdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpZWxkID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmlsdGVyKHAgPT4gcC5pZCA9PSB0aGlzLmZpZWxkLmlkKVswXTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eShjdXJyZW50RXhpc3RpbmdGaWVsZCwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2godGhpcy5maWVsZCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpZWxkLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50U2V0dGluZykgRmllbGQuY29weVByb3BlcnR5KHRoaXMucGFyZW50U2V0dGluZy5maWVsZCwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmc/LnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ1dHRvbihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGIgPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGIuc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgICAgICAuc2V0VG9vbHRpcChcIkNhbmNlbFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvKiByZXNldCBvcHRpb25zIGZyb20gc2V0dGluZ3MgKi9cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsRmllbGQubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qIHV0aWxzIGZ1bmN0aW9ucyAqL1xuXG4gICAgcHVibGljIHN0YXRpYyBzZXRWYWxpZGF0aW9uRXJyb3IodGV4dElucHV0OiBUZXh0Q29tcG9uZW50LCBtZXNzYWdlPzogc3RyaW5nKSB7XG4gICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiaXMtaW52YWxpZFwiKTtcbiAgICAgICAgY29uc3QgZmllbGRDb250YWluZXIgPSB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50O1xuICAgICAgICBjb25zdCBmaWVsZHNDb250YWluZXIgPSBmaWVsZENvbnRhaW5lcj8ucGFyZW50RWxlbWVudDtcbiAgICAgICAgaWYgKG1lc3NhZ2UgJiYgZmllbGRzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICBsZXQgbURpdiA9IGZpZWxkc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmZpZWxkLWVycm9yXCIpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgaWYgKCFtRGl2KSBtRGl2ID0gY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWVycm9yXCIgfSk7XG4gICAgICAgICAgICBtRGl2LmlubmVyVGV4dCA9IG1lc3NhZ2U7XG4gICAgICAgICAgICBmaWVsZHNDb250YWluZXIuaW5zZXJ0QmVmb3JlKG1EaXYsIGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIHJlbW92ZVZhbGlkYXRpb25FcnJvcih0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQgfCBUZXh0QXJlYUNvbXBvbmVudCkge1xuICAgICAgICBpZiAodGV4dElucHV0LmlucHV0RWwuaGFzQ2xhc3MoXCJpcy1pbnZhbGlkXCIpKSB0ZXh0SW5wdXQuaW5wdXRFbC5yZW1vdmVDbGFzcyhcImlzLWludmFsaWRcIik7XG4gICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudDtcbiAgICAgICAgY29uc3QgZmllbGRzQ29udGFpbmVyID0gZmllbGRDb250YWluZXI/LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGZpZWxkRXJyb3IgPSBmaWVsZHNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoXCIuZmllbGQtZXJyb3JcIilcbiAgICAgICAgaWYgKGZpZWxkRXJyb3IpIGZpZWxkc0NvbnRhaW5lciEucmVtb3ZlQ2hpbGQoZmllbGRFcnJvcilcbiAgICB9O1xufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmllbGRUeXBlLCBNdWx0aURpc3BsYXlUeXBlIH0gZnJvbSBcIi4uL3R5cGVzL2ZpZWxkVHlwZXNcIlxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkQ29tbWFuZCB7XG4gICAgaWQ6IHN0cmluZyxcbiAgICBsYWJlbDogc3RyaW5nLFxuICAgIGljb246IHN0cmluZyxcbiAgICBob3RrZXk/OiBzdHJpbmdcbn1cblxuY2xhc3MgRmllbGQge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgb3B0aW9uczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9LFxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIHB1YmxpYyB0eXBlOiBGaWVsZFR5cGUgPSBGaWVsZFR5cGUuSW5wdXQsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3NOYW1lPzogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgY29tbWFuZD86IEZpZWxkQ29tbWFuZCxcbiAgICAgICAgcHVibGljIGRpc3BsYXk/OiBNdWx0aURpc3BsYXlUeXBlXG4gICAgKSB7IH07XG5cbiAgICBwdWJsaWMgZ2V0RGlzcGxheShwbHVnaW46IE1ldGFkYXRhTWVudSk6IE11bHRpRGlzcGxheVR5cGUge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNwbGF5IHx8IHBsdWdpbi5zZXR0aW5ncy5mcm9udG1hdHRlckxpc3REaXNwbGF5XG4gICAgfVxuXG4gICAgc3RhdGljIGNvcHlQcm9wZXJ0eSh0YXJnZXQ6IEZpZWxkLCBzb3VyY2U6IEZpZWxkKSB7XG4gICAgICAgIHRhcmdldC5pZCA9IHNvdXJjZS5pZDtcbiAgICAgICAgdGFyZ2V0Lm5hbWUgPSBzb3VyY2UubmFtZTtcbiAgICAgICAgdGFyZ2V0LnR5cGUgPSBzb3VyY2UudHlwZVxuICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2Uub3B0aW9ucykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIHRhcmdldC5vcHRpb25zW2tdID0gc291cmNlLm9wdGlvbnNba107XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3Qua2V5cyh0YXJnZXQub3B0aW9ucykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LmtleXMoc291cmNlLm9wdGlvbnMpLmluY2x1ZGVzKGspKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldC5vcHRpb25zW2tdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRhcmdldC5jb21tYW5kID0gc291cmNlLmNvbW1hbmRcbiAgICAgICAgdGFyZ2V0LmRpc3BsYXkgPSBzb3VyY2UuZGlzcGxheVxuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZURlZmF1bHQobmFtZTogc3RyaW5nKTogRmllbGQge1xuICAgICAgICBjb25zdCBmaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICBmaWVsZC50eXBlID0gRmllbGRUeXBlLklucHV0O1xuICAgICAgICBmaWVsZC5uYW1lID0gbmFtZTtcbiAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZpZWxkOyIsICJpbXBvcnQgeyBTZXR0aW5nLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZVRhZ0NsYXNzIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZFNldHRpbmcgZXh0ZW5kcyBTZXR0aW5nIHtcbiAgICBwcml2YXRlIGZpZWxkTmFtZUNvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50O1xuICAgIHByaXZhdGUgdHlwZUNvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50O1xuICAgIHByaXZhdGUgZmllbGRPcHRpb25zQ29udGFpbmVyOiBIVE1MU3BhbkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXG4gICAgICAgIHB1YmxpYyBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbiAgICApIHtcbiAgICAgICAgc3VwZXIoY29udGFpbmVyRWwpO1xuICAgICAgICB0aGlzLnNldFRleHRDb250ZW50V2l0aG5hbWUoKTtcbiAgICAgICAgdGhpcy5hZGRFZGl0QnV0dG9uKCk7XG4gICAgICAgIHRoaXMuYWRkRGVsZXRlQnV0dG9uKCk7XG4gICAgICAgIHRoaXMuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpXG4gICAgfTtcblxuICAgIHB1YmxpYyBzZXRUZXh0Q29udGVudFdpdGhuYW1lKCk6IHZvaWQge1xuXG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpIGFzIEY7XG4gICAgICAgIHRoaXMuaW5mb0VsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgdGhpcy5pbmZvRWwuYWRkQ2xhc3MoXCJzZXR0aW5nLWl0ZW1cIilcbiAgICAgICAgdGhpcy5maWVsZE5hbWVDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVFbChcImRpdlwiLCBcIm5hbWVcIilcbiAgICAgICAgdGhpcy5maWVsZE5hbWVDb250YWluZXIuc2V0VGV4dCh0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lci5zZXRBdHRyKFwiY2xhc3NcIiwgYGNoaXAgJHtGaWVsZFR5cGVUYWdDbGFzc1t0aGlzLmZpZWxkLnR5cGVdfWApXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lci5zZXRUZXh0KHRoaXMuZmllbGQudHlwZSlcbiAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVFbChcImRpdlwiKVxuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5zZXRUZXh0KGAke21hbmFnZXIuZ2V0T3B0aW9uc1N0cigpfWApXG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRWRpdEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInBlbmNpbFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRWRpdFwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEZpZWxkU2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5jb250YWluZXJFbCwgdGhpcywgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRGVsZXRlQnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkRlbGV0ZVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nUHJvcGVydHkgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maWx0ZXIocCA9PiBwLmlkID09IHRoaXMuZmllbGQuaWQpWzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnJlbW92ZShjdXJyZW50RXhpc3RpbmdQcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ0VsLnBhcmVudEVsZW1lbnQ/LnJlbW92ZUNoaWxkKHRoaXMuc2V0dGluZ0VsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGdldFZhbHVlc0xpc3RGcm9tTm90ZShwbHVnaW46IE1ldGFkYXRhTWVudSwgbm90ZVBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgbGV0IHZhbHVlczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm90ZVBhdGgpO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgICAgICByZXN1bHQuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKC9eKC4qKSQvLnRlc3QobGluZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gobGluZS50cmltKCkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH07XG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1vZGFsLCBURmlsZSwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBwb3N0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9wb3N0VmFsdWVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm9vbGVhbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIHZhbHVlOiBib29sZWFuLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuYWZ0ZXIgPSBhZnRlcjtcbiAgICAgICAgdGhpcy5hc0xpc3QgPSBhc0xpc3Q7XG4gICAgICAgIHRoaXMuYXNDb21tZW50ID0gYXNDb21tZW50O1xuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGRcbiAgICB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibmFycm93XCIpXG4gICAgICAgIHRoaXMuYnVpbGRUb2dnbGVFbCgpO1xuICAgIH07XG5cblxuICAgIHByaXZhdGUgYnVpbGRUb2dnbGVFbCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2hvaWNlc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJ2YWx1ZS1jb250YWluZXJcIiB9KVxuICAgICAgICBjaG9pY2VzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgdHJ1ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY2hvaWNlc0NvbnRhaW5lcik7XG4gICAgICAgIHRydWVCdXR0b24uc2V0QnV0dG9uVGV4dChcIlRydWVcIilcbiAgICAgICAgdHJ1ZUJ1dHRvbi5zZXRDbGFzcyhcImxlZnRcIilcbiAgICAgICAgY2hvaWNlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIGNvbnN0IGZhbHNlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjaG9pY2VzQ29udGFpbmVyKTtcbiAgICAgICAgZmFsc2VCdXR0b24uc2V0QnV0dG9uVGV4dChcIkZhbHNlXCIpXG4gICAgICAgIGNob2ljZXNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgdHJ1ZUJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgICAgIGZhbHNlQnV0dG9uLnJlbW92ZUN0YSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmFsc2VCdXR0b24uc2V0Q3RhKCk7XG4gICAgICAgICAgICB0cnVlQnV0dG9uLnJlbW92ZUN0YSgpO1xuICAgICAgICB9XG4gICAgICAgIGZhbHNlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgZmFsc2VCdXR0b24uc2V0Q3RhKCk7XG4gICAgICAgICAgICB0cnVlQnV0dG9uLnJlbW92ZUN0YSgpO1xuICAgICAgICB9KVxuICAgICAgICB0cnVlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRydWU7XG4gICAgICAgICAgICB0cnVlQnV0dG9uLnNldEN0YSgpO1xuICAgICAgICAgICAgZmFsc2VCdXR0b24ucmVtb3ZlQ3RhKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNob2ljZXNDb250YWluZXIpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldENsYXNzKFwicmlnaHRcIilcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLnZhbHVlLnRvU3RyaW5nKClcbiAgICAgICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogdmFsdWUgfSB9XSwgdGhpcy5maWxlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcG9zdFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcG9zdFZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiXG5pbXBvcnQgQm9vbGVhbk1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2ZpZWxkcy9Cb29sZWFuTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSwgRmllbGRJY29uIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJvb2xlYW5GaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5Cb29sZWFuKTtcbiAgICAgICAgdGhpcy5zaG93TW9kYWxPcHRpb24gPSBmYWxzZVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyB0b2dnbGUobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBiVmFsdWUgPSBCb29sZWFuRmllbGQuc3RyaW5nVG9Cb29sZWFuKHZhbHVlKTtcbiAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogbmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogKCFiVmFsdWUpLnRvU3RyaW5nKCkgfSB9XSwgZmlsZSlcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gQm9vbGVhbkZpZWxkLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSk7XG4gICAgICAgIGNvbnN0IGljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5Cb29sZWFuXVxuICAgICAgICBjb25zdCBhY3Rpb24gPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnRvZ2dsZShuYW1lLCB2YWx1ZSwgZmlsZSlcblxuICAgICAgICBpZiAoQm9vbGVhbkZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gJHtiVmFsdWUgPyBcIlx1MjcwNSBcdTI1QjcgXHUyNzRDXCIgOiBcIlx1Mjc0QyBcdTI1QjcgXHUyNzA1XCJ9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKGljb25OYW1lKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbkZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj48Yj4ke25hbWV9PC9iPiAke2JWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIn08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBpY29uTmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbkZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFxuICAgICAgICAgICAgICAgIGJWYWx1ZSA/IFwieC1zcXVhcmVcIiA6IFwiY2hlY2stc3F1YXJlXCIsXG4gICAgICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgICAgIGJWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIik7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIC8vbm8gbmVlZCBvZiBzZXR0aW5ncyBmb3IgYm9vbGVhbiBmaWVsZFxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGJWYWx1ZSA9IEJvb2xlYW5GaWVsZC5zdHJpbmdUb0Jvb2xlYW4odmFsdWUpXG4gICAgICAgICAgICByZXR1cm4gaXNCb29sZWFuKGJWYWx1ZSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgLy9hbHdheXMgdHJ1ZSBzaW5jZSB0aGVyZSBhcmUgbm8gb3B0aW9uc1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBhZnRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFzTGlzdD86IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudD86IGJvb2xlYW5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gQm9vbGVhbkZpZWxkLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSB8fCBcImZhbHNlXCIpO1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IEJvb2xlYW5Nb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgYlZhbHVlLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZXQgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQgPSBkdi5lbChcImlucHV0XCIsIFwiXCIsIHsgLi4uYXR0cnMsIFwidHlwZVwiOiBcImNoZWNrYm94XCIgfSlcbiAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHBbdGhpcy5maWVsZC5uYW1lXVxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChjaGVja2JveClcbiAgICAgICAgY2hlY2tib3gub25jaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIEJvb2xlYW5GaWVsZC5yZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBwLmZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBjaGVja2JveC5jaGVja2VkLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgTnVtYmVyTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL051bWJlck1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTnVtYmVyRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBudW1iZXJWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBudW1iZXJTdGVwVmFsdWU6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBudW1iZXJNaW5WYWx1ZTogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIG51bWJlck1heFZhbHVlOiBUZXh0Q29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTnVtYmVyKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBvcHRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpLmZvckVhY2goKGspID0+IHsgaWYgKHRoaXMuZmllbGQub3B0aW9uc1trXSkgb3B0aW9ucy5wdXNoKGAke2t9OiAke3RoaXMuZmllbGQub3B0aW9uc1trXX1gKSB9KVxuICAgICAgICByZXR1cm4gb3B0aW9ucy5qb2luKFwiIHwgXCIpXG4gICAgfVxuXG4gICAgcHVibGljIGNhbkRlY3JlbWVudCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWluIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgY29uc3QgZk1pbiA9IHBhcnNlRmxvYXQobWluKTtcbiAgICAgICAgcmV0dXJuICEoXG4gICAgICAgICAgICBpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkgfHxcbiAgICAgICAgICAgICFpc05hTihmTWluKSAmJlxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICFpc05hTihmU3RlcCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSAtIGZTdGVwIDwgZk1pbiB8fFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSAtIDEgPCBmTWluXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHVibGljIGNhbkluY3JlbWVudCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KTtcbiAgICAgICAgcmV0dXJuICEoXG4gICAgICAgICAgICBpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkgfHxcbiAgICAgICAgICAgICFpc05hTihmTWF4KSAmJlxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICFpc05hTihmU3RlcCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIGZTdGVwID4gZk1heCB8fFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIDEgPiBmTWF4XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbik7XG4gICAgICAgIGNvbnN0IGZNYXggPSBwYXJzZUZsb2F0KG1heCk7XG4gICAgICAgIGNvbnN0IGZWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgIWlzTmFOKGZWYWx1ZSkgJiYgKGlzTmFOKGZNaW4pIHx8IGZWYWx1ZSA+PSBmTWluKSAmJiAoaXNOYU4oZk1heCkgfHwgZlZhbHVlIDw9IGZNYXgpXG4gICAgICAgIClcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgTnVtYmVyTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgVmFsdWUgZm9yIDwke25hbWV9PmApO1xuICAgICAgICBjb25zdCB7IG1pbiwgbWF4LCBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbilcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KVxuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgY29uc3QgZlZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSlcbiAgICAgICAgY29uc3QgY2FuRGVjcmVhc2UgPSAhaXNOYU4oZk1pbikgJiYgZlZhbHVlIC0gZlN0ZXAgPj0gZk1pbjtcbiAgICAgICAgY29uc3QgY2FuSW5jcmVhc2UgPSAhaXNOYU4oZk1heCkgJiYgZlZhbHVlICsgZlN0ZXAgPD0gZk1heDtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGNvbnN0IGRlY3JlYXNlID0gYXN5bmMgKCkgPT4gYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogbmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogKGZWYWx1ZSAtIGZTdGVwKS50b1N0cmluZygpIH0gfV0sIGZpbGUpXG4gICAgICAgIGNvbnN0IGluY3JlYXNlID0gYXN5bmMgKCkgPT4gYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogbmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogKGZWYWx1ZSArIGZTdGVwKS50b1N0cmluZygpIH0gfV0sIGZpbGUpXG4gICAgICAgIGlmIChOdW1iZXJGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgaWYgKGZTdGVwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbkRlY3JlYXNlKVxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJtaW51cy1zcXVhcmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gXHUyMTk4XHVGRTBGICR7ZlZhbHVlIC0gZlN0ZXB9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soZGVjcmVhc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgaWYgKGNhbkluY3JlYXNlKVxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJwbHVzLXNxdWFyZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYDwke25hbWV9PiBcdTIxOTdcdUZFMEYgJHtmVmFsdWUgKyBmU3RlcH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhpbmNyZWFzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChOdW1iZXJGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5OdW1iZXJdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChOdW1iZXJGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGlmIChzdGVwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbkRlY3JlYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihcIm1pbnVzLXNxdWFyZVwiLCBkZWNyZWFzZSwgYERlY3JlYXNlICR7bmFtZX0gYnkgJHtzdGVwfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2FuSW5jcmVhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFwicGx1cy1zcXVhcmVcIiwgaW5jcmVhc2UsIGBJbmNyZWFzZSAke25hbWV9IGJ5ICR7c3RlcH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5OdW1iZXJdLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYClcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVOdW1iZXJDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBudW1iZXJTdGVwVmFsdWVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBudW1iZXJTdGVwVmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJTdGVwIChvcHRpb25hbClcIiwgY2xzOiAnbGFiZWwnIH0pXG4gICAgICAgIG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIHRoaXMubnVtYmVyU3RlcFZhbHVlID0gbmV3IFRleHRDb21wb25lbnQobnVtYmVyU3RlcFZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZS5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKVxuICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuc3RlcCB8fCBcIlwiKVxuXG4gICAgICAgIGNvbnN0IG51bWJlck1pblZhbHVlQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgbnVtYmVyTWluVmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJNaW4gdmFsdWUgKG9wdGlvbmFsKVwiLCBjbHM6ICdsYWJlbCcgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlck1pblZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlLmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpXG4gICAgICAgIHRoaXMubnVtYmVyTWluVmFsdWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLm1pbiB8fCBcIlwiKVxuXG4gICAgICAgIGNvbnN0IG51bWJlck1heFZhbHVlQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgbnVtYmVyTWF4VmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJNYXggdmFsdWUgKG9wdGlvbmFsKVwiLCBjbHM6ICdsYWJlbCcgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNYXhWYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlck1heFZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpXG4gICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLm1heCB8fCBcIlwiKVxuICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuc3RlcCA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcih0aGlzLm51bWJlclN0ZXBWYWx1ZSk7XG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMubnVtYmVyTWluVmFsdWUub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLm1pbiA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcih0aGlzLm51bWJlck1pblZhbHVlKTtcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNYXhWYWx1ZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMubWF4ID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRoaXMubnVtYmVyTWF4VmFsdWUpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVOdW1iZXJDb250YWluZXIoY29udGFpbmVyKVxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBlcnJvciA9IGZhbHNlXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMuc3RlcCAmJiBpc05hTihwYXJzZUZsb2F0KHRoaXMuZmllbGQub3B0aW9ucy5zdGVwKSkpIHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5udW1iZXJTdGVwVmFsdWUsXG4gICAgICAgICAgICAgICAgXCJWYWx1ZXMgbXVzdCBiZSBudW1lcmljLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMubWluICYmIGlzTmFOKHBhcnNlRmxvYXQodGhpcy5maWVsZC5vcHRpb25zLm1pbikpKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyTWluVmFsdWUsXG4gICAgICAgICAgICAgICAgXCJWYWx1ZXMgbXVzdCBiZSBudW1lcmljLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMubWF4ICYmIGlzTmFOKHBhcnNlRmxvYXQodGhpcy5maWVsZC5vcHRpb25zLm1heCkpKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUsXG4gICAgICAgICAgICAgICAgXCJWYWx1ZXMgbXVzdCBiZSBudW1lcmljLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhZXJyb3JcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLFxuICAgICAgICB2YWx1ZT86IHN0cmluZyxcbiAgICAgICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICAgICAgYWZ0ZXI/OiBib29sZWFuLFxuICAgICAgICBhc0xpc3Q/OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ/OiBib29sZWFuXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgTnVtYmVyTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlIHx8IFwiXCIsIGxpbmVOdW1iZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciB2YWx1ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB0b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnRuOiBIVE1MQnV0dG9uRWxlbWVudCwgaW5jcmVtZW50QnRuOiBIVE1MQnV0dG9uRWxlbWVudCwgdmFsdWU6IHN0cmluZykge1xuICAgICAgICBpZiAodGhpcy5jYW5EZWNyZW1lbnQodmFsdWUpKSB7XG4gICAgICAgICAgICBkZWNyZW1lbnRCdG4ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWNyZW1lbnRCdG4uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2FuSW5jcmVtZW50KHZhbHVlKSkge1xuICAgICAgICAgICAgaW5jcmVtZW50QnRuLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5jcmVtZW50QnRuLmFkZENsYXNzKCdkaXNhYmxlZCcpOztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM6IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSA9IHt9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGF0dHJzLmNscyA9IFwidmFsdWUtY29udGFpbmVyXCJcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IChkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpIGFzIEhUTUxEaXZFbGVtZW50KTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSlcbiAgICAgICAgY29uc3QgaW5wdXRDb250YWluZXIgPSBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoe30pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IGlucHV0Q29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIik7XG4gICAgICAgIGlucHV0LnZhbHVlID0gcFt0aGlzLmZpZWxkLm5hbWVdO1xuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHRyaXBsZVNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXItM1wiIH0pO1xuXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGVkaXRCdXR0b24gPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKTtcbiAgICAgICAgc2V0SWNvbihlZGl0QnV0dG9uLCBGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl0pO1xuXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGRlY3JlbWVudEJ1dHRvbiA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGRlY3JlbWVudEJ1dHRvbiwgXCJsZWZ0LWFycm93XCIpO1xuXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGluY3JlbWVudEJ1dHRvbiA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGluY3JlbWVudEJ1dHRvbiwgXCJyaWdodC1hcnJvd1wiKTtcblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgZWRpdEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICBkZWNyZW1lbnRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgaW5jcmVtZW50QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIHRyaXBsZVNwYWNlci5zaG93KCk7XG5cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVkaXRCdXR0b24uc2hvdygpO1xuICAgICAgICAgICAgICAgIGRlY3JlbWVudEJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICAgICAgaW5jcmVtZW50QnV0dG9uLnNob3coKTtcbiAgICAgICAgICAgICAgICB0cmlwbGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBlZGl0QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBkZWNyZW1lbnRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIGluY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdHJpcGxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlSWNvbiA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpXG4gICAgICAgIHNldEljb24odmFsaWRhdGVJY29uLCBcImNoZWNrbWFya1wiKVxuICAgICAgICB2YWxpZGF0ZUljb24ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlVmFsdWUoaW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBpbnB1dC52YWx1ZSB9IH1dLCBmaWxlKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdXR0b24sIGluY3JlbWVudEJ1dHRvbiwgaW5wdXQudmFsdWUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlucHV0Q29udGFpbmVyPy5hcHBlbmRDaGlsZCh2YWxpZGF0ZUljb24pXG4gICAgICAgIGNvbnN0IGNhbmNlbEljb24gPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKGNhbmNlbEljb24sIFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGNhbmNlbEljb24pO1xuICAgICAgICBpbnB1dC5mb2N1cygpO1xuXG4gICAgICAgIGlucHV0Lm9ua2V5dXAgPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlVmFsdWUoaW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQuYWRkQ2xhc3MoJ2lzLWludmFsaWQnKTtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUljb24uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlucHV0LnJlbW92ZUNsYXNzKCdpcy1pbnZhbGlkJyk7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVJY29uLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaW5wdXQub25rZXlkb3duID0gYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVWYWx1ZShpbnB1dC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBwb3N0VmFsdWVzKHRoaXMucGx1Z2luLCBbeyBuYW1lOiB0aGlzLmZpZWxkLm5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IGlucHV0LnZhbHVlIH0gfV0sIGZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdXR0b24sIGluY3JlbWVudEJ1dHRvbiwgaW5wdXQudmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkZWNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodHJpcGxlU3BhY2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBlZGl0QnV0dG9uIG9uIGNsaWNrIDogcmVtb3ZlIGJ1dHRvbiBhbmQgZmllbGQgYW5kIGRpc3BsYXkgaW5wdXQgZmllbGQqL1xuICAgICAgICBlZGl0QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZGVjcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5wdXRDb250YWluZXIpO1xuICAgICAgICAgICAgaW5wdXQuZm9jdXMoKVxuICAgICAgICB9XG5cbiAgICAgICAgLyogZGVjcmVtZW50IGJ1dHRvbiBvbiBjbGljazogZGVjcmVtZW50IGJ5IHN0ZXAgb3IgYnkgMSAqL1xuICAgICAgICBkZWNyZW1lbnRCdXR0b24ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbkRlY3JlbWVudChwW3RoaXMuZmllbGQubmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgY29uc3QgZlN0ZXAgPSBwYXJzZUZsb2F0KHN0ZXApXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gKCEhZlN0ZXAgPyBwW3RoaXMuZmllbGQubmFtZV0gLSBmU3RlcCA6IHBbdGhpcy5maWVsZC5uYW1lXSAtIDEpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogbmV3VmFsdWUgfSB9XSwgZmlsZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbmNyZW1lbnQgYnV0dG9uIG9uIGNsaWNrOiBpbmNyZW1lbnQgYnkgc3RlcCBvciBieSAxICovXG4gICAgICAgIGluY3JlbWVudEJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuSW5jcmVtZW50KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAoISFmU3RlcCA/IHBbdGhpcy5maWVsZC5uYW1lXSArIGZTdGVwIDogcFt0aGlzLmZpZWxkLm5hbWVdICsgMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBuZXdWYWx1ZSB9IH1dLCBmaWxlKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdXR0b24sIGluY3JlbWVudEJ1dHRvbiwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWwgc3RhdGUgKi9cbiAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZGVjcmVtZW50QnV0dG9uKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHRyaXBsZVNwYWNlcik7XG4gICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBwW3RoaXMuZmllbGQubmFtZV0pO1xuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTW9kYWwsIFRleHRDb21wb25lbnQsIFRGaWxlLCBCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IE51bWJlckZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTnVtYmVyRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEJhc2VNb2RhbCBmcm9tIFwiLi4vYmFzZU1vZGFsXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE51bWJlck1vZGFsIGV4dGVuZHMgQmFzZU1vZGFsIHtcblxuICAgIHByaXZhdGUgZmllbGRNYW5hZ2VyOiBOdW1iZXJGaWVsZDtcbiAgICBwcml2YXRlIG51bWJlcklucHV0OiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgZXJyb3JGaWVsZDogSFRNTERpdkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luKTtcbiAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgdGhpcy5idWlsZElucHV0RWwoKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBkZWNyZW1lbnQobnVtYmVySW5wdXQ6IFRleHRDb21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgaWYgKCFpc05hTihmU3RlcCkpIHtcbiAgICAgICAgICAgIG51bWJlcklucHV0LnNldFZhbHVlKChwYXJzZUZsb2F0KG51bWJlcklucHV0LmdldFZhbHVlKCkpIC0gZlN0ZXApLnRvU3RyaW5nKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbnVtYmVySW5wdXQuc2V0VmFsdWUoKHBhcnNlRmxvYXQobnVtYmVySW5wdXQuZ2V0VmFsdWUoKSkgLSAxKS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaW5jcmVtZW50KG51bWJlcklucHV0OiBUZXh0Q29tcG9uZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCB9ID0gdGhpcy5maWVsZC5vcHRpb25zXG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKVxuICAgICAgICBpZiAoIWlzTmFOKGZTdGVwKSkge1xuICAgICAgICAgICAgbnVtYmVySW5wdXQuc2V0VmFsdWUoKHBhcnNlRmxvYXQobnVtYmVySW5wdXQuZ2V0VmFsdWUoKSkgKyBmU3RlcCkudG9TdHJpbmcoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBudW1iZXJJbnB1dC5zZXRWYWx1ZSgocGFyc2VGbG9hdChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB0b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG46IEJ1dHRvbkNvbXBvbmVudCwgcGx1c0J0bjogQnV0dG9uQ29tcG9uZW50LCBudW1iZXJJbnB1dDogVGV4dENvbXBvbmVudCk6IHZvaWQge1xuICAgICAgICBtaW51c0J0bi5zZXREaXNhYmxlZCghdGhpcy5maWVsZE1hbmFnZXIuY2FuRGVjcmVtZW50KG51bWJlcklucHV0LmdldFZhbHVlKCkpKTtcbiAgICAgICAgcGx1c0J0bi5zZXREaXNhYmxlZCghdGhpcy5maWVsZE1hbmFnZXIuY2FuSW5jcmVtZW50KG51bWJlcklucHV0LmdldFZhbHVlKCkpKTtcbiAgICAgICAgaWYgKHRoaXMuZmllbGRNYW5hZ2VyLmNhbkRlY3JlbWVudChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSkge1xuICAgICAgICAgICAgbWludXNCdG4uc2V0Q3RhKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtaW51c0J0bi5yZW1vdmVDdGEoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWVsZE1hbmFnZXIuY2FuSW5jcmVtZW50KG51bWJlcklucHV0LmdldFZhbHVlKCkpKSB7XG4gICAgICAgICAgICBwbHVzQnRuLnNldEN0YSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGx1c0J0bi5yZW1vdmVDdGEoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuXG4gICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcblxuICAgICAgICB0aGlzLm51bWJlcklucHV0ID0gbmV3IFRleHRDb21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICBjb25zdCBudW1iZXJJbnB1dCA9IHRoaXMubnVtYmVySW5wdXRcbiAgICAgICAgbnVtYmVySW5wdXQuaW5wdXRFbC5mb2N1cygpO1xuICAgICAgICBudW1iZXJJbnB1dC5zZXRWYWx1ZShgJHt0aGlzLnZhbHVlfWApO1xuXG4gICAgICAgIGNvbnN0IG1pbnVzQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZENvbnRhaW5lcik7XG4gICAgICAgIG1pbnVzQnRuLnNldEJ1dHRvblRleHQoYC0gJHshIXN0ZXAgPyBzdGVwIDogMX1gKTtcbiAgICAgICAgbWludXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkRlY3JlbWVudChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSk7XG5cbiAgICAgICAgY29uc3QgcGx1c0J0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICBwbHVzQnRuLnNldEJ1dHRvblRleHQoYCsgJHshIXN0ZXAgPyBzdGVwIDogMX1gKTtcbiAgICAgICAgcGx1c0J0bi5zZXREaXNhYmxlZCghdGhpcy5maWVsZE1hbmFnZXIuY2FuSW5jcmVtZW50KG51bWJlcklucHV0LmdldFZhbHVlKCkpKTtcblxuICAgICAgICBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcblxuICAgICAgICBjb25zdCB2YWxpZGF0ZUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICB2YWxpZGF0ZUJ0bi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICBjYW5jZWxCdG4uc2V0SWNvbihcImNyb3NzXCIpO1xuXG4gICAgICAgIHRoaXMuZXJyb3JGaWVsZCA9IHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcImZpZWxkLWVycm9yXCIgfSlcbiAgICAgICAgdGhpcy5lcnJvckZpZWxkLmhpZGUoKVxuXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuLCBwbHVzQnRuLCBudW1iZXJJbnB1dCk7XG5cbiAgICAgICAgLy9ldmVudCBoYW5kbGVyc1xuICAgICAgICBudW1iZXJJbnB1dC5vbkNoYW5nZSgoKSA9PiB7XG4gICAgICAgICAgICBudW1iZXJJbnB1dC5pbnB1dEVsLnJlbW92ZUNsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JGaWVsZC5zZXRUZXh0KFwiXCIpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG4sIHBsdXNCdG4sIG51bWJlcklucHV0KVxuICAgICAgICB9KVxuXG4gICAgICAgIHBsdXNCdG4ub25DbGljaygoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5pbmNyZW1lbnQobnVtYmVySW5wdXQpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG4sIHBsdXNCdG4sIG51bWJlcklucHV0KTtcbiAgICAgICAgfSlcblxuICAgICAgICBtaW51c0J0bi5vbkNsaWNrKChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmRlY3JlbWVudChudW1iZXJJbnB1dCk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbnNTdGF0ZShtaW51c0J0biwgcGx1c0J0biwgbnVtYmVySW5wdXQpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNhbmNlbEJ0bi5vbkNsaWNrKChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfSlcblxuICAgICAgICB2YWxpZGF0ZUJ0bi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2F2ZSgpO1xuICAgICAgICB9KVxuICAgIH07XG5cbiAgICBwdWJsaWMgYXN5bmMgc2F2ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgaW5wdXRWYWx1ZSA9IHRoaXMubnVtYmVySW5wdXQuZ2V0VmFsdWUoKTtcblxuICAgICAgICBpZiAoIXRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlVmFsdWUoaW5wdXRWYWx1ZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLnNob3coKTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JGaWVsZC5zZXRUZXh0KGB2YWx1ZSBtdXN0IGJlIG51bWVyaWMke21pbiA/IFwiIGFuZCA+PSBcIiArIG1pbiA6IFwiXCJ9ICR7bWF4ID8gXCIgYW5kIDw9IFwiICsgbWF4IDogXCJcIn1gKVxuICAgICAgICAgICAgdGhpcy5udW1iZXJJbnB1dC5pbnB1dEVsLnNldEF0dHIoXCJjbGFzc1wiLCBcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogaW5wdXRWYWx1ZSB9IH1dLCB0aGlzLmZpbGUsIHRoaXMubGluZU51bWJlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIHNldEljb24sIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwiLi9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWxlY3RGaWVsZCBleHRlbmRzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQge1xuXG4gICAgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD4gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLlNlbGVjdClcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHZhbHVlLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlXCIpO1xuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKClcbiAgICAgICAgaWYgKFNlbGVjdEZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgJHtuYW1lfWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLlNlbGVjdF0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoU2VsZWN0RmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuU2VsZWN0XVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoU2VsZWN0RmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5NdWx0aV0sIGFjdGlvbiwgYFVwZGF0ZSAke25hbWV9J3MgdmFsdWVgKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKFxuICAgICAgICBmaWxlOiBURmlsZSxcbiAgICAgICAgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZyxcbiAgICAgICAgdmFsdWU/OiBzdHJpbmcsXG4gICAgICAgIGxpbmVOdW1iZXI/OiBudW1iZXIsXG4gICAgICAgIGFmdGVyPzogYm9vbGVhbixcbiAgICAgICAgYXNMaXN0PzogYm9vbGVhbixcbiAgICAgICAgYXNDb21tZW50PzogYm9vbGVhblxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IFNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB2YWx1ZSB8fCBcIlwiLCB0aGlzLmZpZWxkLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IG9wdGlvbiBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRyczogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9ID0ge31cbiAgICApOiB2b2lkIHtcbiAgICAgICAgYXR0cnMuY2xzID0gXCJ2YWx1ZS1jb250YWluZXJcIlxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSB8fCBcIlwiLCBhdHRycykpXG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3Qgc3BhY2VyID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic3BhY2VyLTFcIiB9KVxuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBtb2RhbCAqL1xuICAgICAgICBjb25zdCBkcm9wRG93bkJ1dHRvbiA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGRyb3BEb3duQnV0dG9uLCBcImRvd24tY2hldnJvbi1nbHlwaFwiKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogU2VsZWN0TW9kYWw7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IFNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCBwW3RoaXMuZmllbGQubmFtZV0sIHRoaXMuZmllbGQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cblxuICAgICAgICBkcm9wRG93bkJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gZmllbGRNb2RhbC5vcGVuKClcbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIGRyb3BEb3duQnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBkcm9wRG93bkJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZHJvcERvd25CdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCB7IFRGaWxlLCBTdWdnZXN0TW9kYWwsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgKiBhcyBzZWxlY3RWYWx1ZXNTb3VyY2UgZnJvbSBcInNyYy90eXBlcy9zZWxlY3RWYWx1ZXNTb3VyY2VUeXBlc1wiXG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuaW1wb3J0IHsgcG9zdFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcG9zdFZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWYWx1ZVN1Z2dlc3RNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxzdHJpbmc+e1xuXG4gICAgcHJpdmF0ZSBhZGRCdXR0b246IEJ1dHRvbkNvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIHZhbHVlOiBzdHJpbmcsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpO1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic3VnZ2VzdGVyLWlucHV0XCIgfSlcbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dEVsKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmZpbmQoXCIucHJvbXB0XCIpLnByZXBlbmQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcImZvb3Rlci1hY3Rpb25zXCIgfSlcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBpbmZvQ29udGFpbmVyID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJpbmZvXCIgfSlcbiAgICAgICAgaW5mb0NvbnRhaW5lci5zZXRUZXh0KFwiU2hpZnQrRW50ZXIgdG8gc2F2ZVwiKVxuICAgICAgICAvLyBhZGRCdXR0b25cbiAgICAgICAgdGhpcy5hZGRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRJY29uKFwicGx1c1wiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuYWRkTmV3VmFsdWVUb1NldHRpbmdzKCkpXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLnNldEN0YSgpO1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRUb29sdGlwKFwiQWRkIHRoaXMgdmFsdWUgdG8gdGhpcyBmaWVsZCBzZXR0aW5nc1wiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgIC8vY2FuY2VsIGJ1dHRvblxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKVxuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmNsb3NlKCkpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRUb29sdGlwKFwiQ2FuY2VsXCIpXG4gICAgICAgIC8vY2xlYXIgdmFsdWUgYnV0dG9uXG4gICAgICAgIGNvbnN0IGNsZWFyQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNsZWFyQnV0dG9uLnNldEljb24oXCJlcmFzZXJcIilcbiAgICAgICAgY2xlYXJCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNsZWFyVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGNsZWFyQnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKFwiZGFuZ2VyXCIpXG4gICAgICAgIGNsZWFyQnV0dG9uLnNldFRvb2x0aXAoXCJDbGVhciB0aGUgZmllbGQgdmFsdWVcIilcbiAgICAgICAgdGhpcy5tb2RhbEVsLmFwcGVuZENoaWxkKGJ1dHRvbkNvbnRhaW5lcik7XG4gICAgfVxuXG4gICAgYXN5bmMgYWRkTmV3VmFsdWVUb1NldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpPy5maWxlQ2xhc3NOYW1lXG4gICAgICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZSA9IGZpbGVDbGFzcz8uYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIGZpbGVDbGFzc0F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgIGxldCBuZXdPcHRpb25zOiBzdHJpbmdbXSB8IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnMgPSBbLi4uZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMsIG5ld1ZhbHVlXVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlLCBmaWxlQ2xhc3NBdHRyaWJ1dGUubmFtZSwgbmV3T3B0aW9ucywgZmlsZUNsYXNzQXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnZhbHVlc0xpc3QgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9uc1tgJHtPYmplY3Qua2V5cyhmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy52YWx1ZXNMaXN0KS5sZW5ndGggKyAxfWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlc0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB2YWx1ZXNGaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KHZhbHVlc0ZpbGUsIGAke3Jlc3VsdH1cXG4ke25ld1ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zW2Ake09iamVjdC5rZXlzKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zKS5sZW5ndGggKyAxfWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcHJlc2V0RmllbGQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgICAgICBpZiAocHJlc2V0RmllbGQ/Lm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocHJlc2V0RmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgpXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB2YWx1ZXNGaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQodmFsdWVzRmlsZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeSh2YWx1ZXNGaWxlLCBgJHtyZXN1bHR9XFxuJHtuZXdWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByZXNldEZpZWxkPy5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RXhpc3RpbmdGaWVsZCA9IHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLmZpbmQocCA9PiBwLmlkID09IHRoaXMuZmllbGQuaWQpO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNMaXN0ID0gY3VycmVudEV4aXN0aW5nRmllbGQub3B0aW9ucy52YWx1ZXNMaXN0XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlc0xpc3RbYCR7T2JqZWN0LmtleXModmFsdWVzTGlzdCkubGVuZ3RoICsgMX1gXSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUl0ZW0obmV3VmFsdWUpO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2xlYXJWYWx1ZXMoKSB7XG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogXCJcIiB9IH1dLCB0aGlzLmZpbGUsIHRoaXMubGluZU51bWJlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KVxuXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IGR2RmlsZTogYW55O1xuICAgICAgICBpZiAoZHZBcGkpIGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCkgYXMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFxuICAgICAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZE1hbmFnZXIuZ2V0T3B0aW9uc0xpc3QoZHZGaWxlKS5maWx0ZXIobyA9PiBvLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgIGlmICh0aGlzLmFkZEJ1dHRvbikge1xuICAgICAgICAgICAgKHZhbHVlcy5zb21lKHAgPT4gcCA9PT0gcXVlcnkpIHx8IHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlID09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0Zyb21EVlF1ZXJ5IHx8ICFxdWVyeSkgP1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuc2hvdygpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsdWVzXG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZSlcbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJ2YWx1ZS1jb250YWluZXJcIik7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy52YWx1ZSkgZWwuYWRkQ2xhc3MoXCJ2YWx1ZS1jaGVja2VkXCIpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlSXRlbShpdGVtOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBpdGVtLnRvU3RyaW5nKCkgfSB9XSwgdGhpcy5maWxlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudClcbiAgICB9XG5cbiAgICBhc3luYyBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIHRoaXMuc2F2ZUl0ZW0oaXRlbSlcbiAgICB9XG59IiwgImV4cG9ydCBlbnVtIFR5cGUge1xuICAgIFwiVmFsdWVzTGlzdFwiID0gXCJWYWx1ZXNMaXN0XCIsXG4gICAgXCJWYWx1ZXNMaXN0Tm90ZVBhdGhcIiA9IFwiVmFsdWVzTGlzdE5vdGVQYXRoXCIsXG4gICAgXCJWYWx1ZXNGcm9tRFZRdWVyeVwiID0gXCJWYWx1ZXNGcm9tRFZRdWVyeVwiXG59XG5cbmV4cG9ydCBjb25zdCBLZXk6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIlZhbHVlc0xpc3RcIjogXCJ2YWx1ZXNMaXN0XCIsXG4gICAgXCJWYWx1ZXNMaXN0Tm90ZVBhdGhcIjogXCJ2YWx1ZXNMaXN0Tm90ZVBhdGhcIixcbiAgICBcIlZhbHVlc0Zyb21EVlF1ZXJ5XCI6IFwidmFsdWVzRnJvbURWUXVlcnlcIlxufVxuXG5leHBvcnQgY29uc3QgdHlwZURpc3BsYXk6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIlZhbHVlc0xpc3RcIjogXCJWYWx1ZXMgZGVmaW5lZCBpbiB0aGVzZSBzZXR0aW5nc1wiLFxuICAgIFwiVmFsdWVzTGlzdE5vdGVQYXRoXCI6IFwiVmFsdWVzIGZyb20gYSBub3RlXCIsXG4gICAgXCJWYWx1ZXNGcm9tRFZRdWVyeVwiOiBcIlZhbHVlcyByZXR1cm5lZCBmcm9tIGEgZGF0YXZpZXcgcXVlcnlcIlxufSIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgVGV4dENvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBzZXRJY29uLCBEcm9wZG93bkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZpbGVTdWdnZXN0IH0gZnJvbSBcInNyYy9zdWdnZXN0ZXIvRmlsZVN1Z2dlc3RlclwiO1xuaW1wb3J0ICogYXMgc2VsZWN0VmFsdWVzU291cmNlIGZyb20gXCJzcmMvdHlwZXMvc2VsZWN0VmFsdWVzU291cmNlVHlwZXNcIlxuXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIGFic3RyYWN0IHZhbHVlc1Byb21wdENvbXBvbmVudHM6IEFycmF5PFRleHRDb21wb25lbnQ+O1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCwgdHlwZTogRmllbGRUeXBlKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIHR5cGUpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVMaXN0Tm90ZVBhdGhDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBgUGF0aCBvZiB0aGUgbm90ZWAsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lcik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgbmV3IEZpbGVTdWdnZXN0KFxuICAgICAgICAgICAgaW5wdXQuaW5wdXRFbCxcbiAgICAgICAgICAgIHBsdWdpbixcbiAgICAgICAgICAgIFwiL1wiXG4gICAgICAgIClcbiAgICAgICAgY29uc3QgbGlzdE5vdGVQYXRoID0gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aDtcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUobGlzdE5vdGVQYXRoIHx8IFwiXCIpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIlBhdGgvb2YvdGhlL25vdGUubWRcIik7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGggPSB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXI7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW1vdmVQcmVzZXRWYWx1ZShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBsZXQgbmV3VmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICAgIGZvciAobGV0IF9rZXkgaW4gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT09IF9rZXkpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZXNbX2tleV0gPSB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFtfa2V5XTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0ID0gbmV3VmFsdWVzO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVZhbHVlc0xpc3RDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgY29uc3QgcHJlc2V0VmFsdWVzRmllbGRzID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpXG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBwcmVzZXRWYWx1ZXNGaWVsZHMuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3RCb2R5ID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5wdXNoKHRoaXMuY3JlYXRlVmFsdWVDb250YWluZXIodmFsdWVzTGlzdEJvZHksIGtleSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVBZGRCdXR0b24odmFsdWVzTGlzdCwgdmFsdWVzTGlzdEJvZHkpXG4gICAgICAgIHJldHVybiBwcmVzZXRWYWx1ZXNGaWVsZHM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVWYWx1ZUNvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCwga2V5OiBzdHJpbmcpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QgfHwge307XG4gICAgICAgIGNvbnN0IHByZXNldFZhbHVlID0gdmFsdWVzW2tleV07XG4gICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gcGFyZW50Tm9kZS5jcmVhdGVEaXYoeyBjbHM6ICdmaWVsZC1jb250YWluZXInLCB9KTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMucHVzaChpbnB1dClcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUocHJlc2V0VmFsdWUpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGlucHV0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlUmVtb3ZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlUmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVByZXNldFZhbHVlKGtleSk7XG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnJlbW92ZShpbnB1dCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgaWYgKGtleSAhPSBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpWzBdKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZVVwZ3JhZGVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgICAgIHNldEljb24odmFsdWVVcGdyYWRlQnV0dG9uLmJ1dHRvbkVsLCBcInVwLWNoZXZyb24tZ2x5cGhcIik7XG4gICAgICAgICAgICB2YWx1ZVVwZ3JhZGVCdXR0b24ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGhpc1ZhbHVlID0gdmFsdWVzW2tleV07XG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXRJbmRleCA9IHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5pbmRleE9mKGlucHV0KVxuICAgICAgICAgICAgICAgIGNvbnN0IHVwcGVyQ29tcG9uZW50ID0gaW5wdXRJbmRleCAhPT0gLTEgPyB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHNbaW5wdXRJbmRleCAtIDFdIDogdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmxhc3QoKTtcbiAgICAgICAgICAgICAgICBpZiAodXBwZXJDb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBwZXJWYWx1ZSA9IHVwcGVyQ29tcG9uZW50LmlucHV0RWwudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwcGVyS2V5ID0gT2JqZWN0LmtleXModmFsdWVzKS5maWx0ZXIoayA9PiB2YWx1ZXNba10gPT0gdXBwZXJWYWx1ZSlbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cHBlcktleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJDb21wb25lbnQuc2V0VmFsdWUodGhpc1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1t1cHBlcktleV0gPSB0aGlzVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5zZXRWYWx1ZSh1cHBlclZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1trZXldID0gdXBwZXJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICAvL3RvZG8gOiBtYW5hZ2UgYm90aCByYXcgbGlua3MgYW5kIGR2IExpbmsgb2JqZWN0c1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpIHtcbiAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkuam9pbihcIiwgXCIpO1xuICAgICAgICAgICAgY2FzZSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzRnJvbURWUXVlcnk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc0xpc3QoZHZGaWxlOiBhbnkgPSB1bmRlZmluZWQpOiBzdHJpbmdbXSB7XG4gICAgICAgIGxldCB2YWx1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMuZmllbGQub3B0aW9ucykpIHtcbiAgICAgICAgICAgIHZhbHVlcyA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpIHtcbiAgICAgICAgICAgIHZhbHVlcyA9IE9iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3Q6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IE9iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aDpcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC52YWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQodGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCkgfHwgW107XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzRnJvbURWUXVlcnk6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBuZXcgRnVuY3Rpb24oXCJkdlwiLCBcImN1cnJlbnRcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeX1gKShkdkFwaSwgZHZGaWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBlcnJvciA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICAgICAgICBpZiAoL1ssXS9ndS50ZXN0KGlucHV0LmlucHV0RWwudmFsdWUpICYmIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudD8ubGFzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW5ub3QgY29udGFpbiBhIGNvbW1hXCJcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoaW5wdXQuaW5wdXRFbC52YWx1ZSA9PSBcIlwiICYmIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudD8ubGFzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW4ndCBiZSBudWxsLlwiXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICFlcnJvclxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlQWRkQnV0dG9uKHZhbHVlc0xpc3Q6IEhUTUxEaXZFbGVtZW50LCB2YWx1ZXNMaXN0Qm9keTogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEZvb3RlciA9IHZhbHVlc0xpc3QuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGFkZFZhbHVlID0gdmFsdWVzTGlzdEZvb3Rlci5jcmVhdGVFbCgnYnV0dG9uJyk7XG4gICAgICAgIGFkZFZhbHVlLnR5cGUgPSAnYnV0dG9uJztcbiAgICAgICAgYWRkVmFsdWUudGV4dENvbnRlbnQgPSAnQWRkIGEgdmFsdWUnO1xuICAgICAgICBhZGRWYWx1ZS5vbkNsaWNrRXZlbnQoYXN5bmMgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0O1xuXG4gICAgICAgICAgICBsZXQgbmV3S2V5TnVtYmVyID0gMTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KGtleSkgJiYgcGFyc2VJbnQoa2V5KSA+PSBuZXdLZXlOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3S2V5TnVtYmVyID0gcGFyc2VJbnQoa2V5KSArIDE7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgbmV3S2V5ID0gbmV3S2V5TnVtYmVyLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFtuZXdLZXldID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVmFsdWVDb250YWluZXIodmFsdWVzTGlzdEJvZHksIG5ld0tleSlcbiAgICAgICAgfSk7XG4gICAgICAgIHZhbHVlc0xpc3QuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IHZhbHVlc0Zyb21EVlF1ZXJ5VG9wQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2c3RhY2tlZFwiIH0pXG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5VG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGF0YXZpZXcgZnVuY3Rpb25cIiB9KTtcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnlUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJEYXRhdmlldyBxdWVyeSByZXR1cm5pbmcgYSBsaXN0IG9mIHN0cmluZyAoPGR2PiBvYmplY3QgaXMgYXZhaWxhYmxlKVwiLCBjbHM6IFwic3ViLXRleHRcIiB9KTtcbiAgICAgICAgY29uc3QgdmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIgPSB2YWx1ZXNGcm9tRFZRdWVyeVRvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgdmFsdWVzRnJvbURWUXVlcnkgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQodmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIpO1xuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeS5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuaW5wdXRFbC5jb2xzID0gNjU7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5LmlucHV0RWwucm93cyA9IDg7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5LnNldFBsYWNlaG9sZGVyKFwiZXg6IGR2LnBhZ2VzKCcjc3R1ZGVudCcpLm1hcChwID0+IHAubmFtZSlcIilcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5IHx8IFwiXCIpO1xuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeS5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeSA9IHZhbHVlXG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiB2YWx1ZXNGcm9tRFZRdWVyeVRvcENvbnRhaW5lcjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRpc3BsYXlTZWxlY3RlZFR5cGVDb250YWluZXIob3B0aW9uQ29udGFpbmVyczogUmVjb3JkPGtleW9mIHR5cGVvZiBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSwgSFRNTERpdkVsZW1lbnQ+LCB2YWx1ZToga2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKG9wdGlvbkNvbnRhaW5lcnMpLmZvckVhY2goKGtleToga2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKSA9PiB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbkNvbnRhaW5lcnNba2V5XS5zaG93KClcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uQ29udGFpbmVyc1trZXldLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCBzb3VyY2VUeXBlQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgc291cmNlVHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcIlZhbHVlcyBzb3VyY2UgdHlwZVwiLCBjbHM6IFwibGFiZWxcIiB9KVxuICAgICAgICBzb3VyY2VUeXBlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3Qgc291cmNlVHlwZSA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChzb3VyY2VUeXBlQ29udGFpbmVyKTtcblxuICAgICAgICAvL21hbmFnZSBuZXcgZmllbGQgYW5kIGZpbGVDbGFzcyBsZWdhY3kgZmllbGRcbiAgICAgICAgaWYgKCF0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSkge1xuICAgICAgICAgICAgLy90aGlzIGlzIGEgbmV3IGZpZWxkIG9yIGZpbGVDbGFzcyBsZWdhY3kgZmllbGRcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5maWVsZC5vcHRpb25zID09PSBcIm9iamVjdFwiICYmIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucykuZXZlcnkoa2V5ID0+ICFpc05hTihwYXJzZUludChrZXkpKSkpIHtcbiAgICAgICAgICAgICAgICAvL3RoaXMgaXMgYSBmaWxlQ2xhc3MgbGVnYWN5IGZpZWxkXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzTGlzdDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKS5mb3JFYWNoKChrZXk6IHN0cmluZykgPT4gdmFsdWVzTGlzdFtrZXldID0gdGhpcy5maWVsZC5vcHRpb25zW2tleV0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucyA9IHt9XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QgPSB2YWx1ZXNMaXN0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMgPSB7fVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgPSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0O1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzRnJvbURWUXVlcnkgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5rZXlzKHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKS5mb3JFYWNoKChvcHRpb246IGtleW9mIHR5cGVvZiBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSkgPT4gc291cmNlVHlwZS5hZGRPcHRpb24ob3B0aW9uLCBzZWxlY3RWYWx1ZXNTb3VyY2UudHlwZURpc3BsYXlbb3B0aW9uXSkpXG4gICAgICAgIHNvdXJjZVR5cGUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgfHwgc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdClcblxuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXIgPSB0aGlzLmNyZWF0ZUxpc3ROb3RlUGF0aENvbnRhaW5lcihjb250YWluZXIsIHBsdWdpbik7XG4gICAgICAgIGNvbnN0IHByZXNldFZhbHVlc0ZpZWxkc0NvbnRhaW5lciA9IHRoaXMuY3JlYXRlVmFsdWVzTGlzdENvbnRhaW5lcihjb250YWluZXIpO1xuICAgICAgICBjb25zdCB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lciA9IHRoaXMuY3JlYXRlVmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIoY29udGFpbmVyKTtcblxuICAgICAgICBjb25zdCB2YWx1ZXNDb250YWluZXJzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLCBIVE1MRGl2RWxlbWVudD4gPSB7XG4gICAgICAgICAgICBcIlZhbHVlc0xpc3RcIjogcHJlc2V0VmFsdWVzRmllbGRzQ29udGFpbmVyLFxuICAgICAgICAgICAgXCJWYWx1ZXNMaXN0Tm90ZVBhdGhcIjogdmFsdWVzTGlzdE5vdGVQYXRoQ29udGFpbmVyLFxuICAgICAgICAgICAgXCJWYWx1ZXNGcm9tRFZRdWVyeVwiOiB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lclxuICAgICAgICB9XG5cbiAgICAgICAgc291cmNlVHlwZS5vbkNoYW5nZSgodmFsdWU6IGtleW9mIHR5cGVvZiBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVNlbGVjdGVkVHlwZUNvbnRhaW5lcih2YWx1ZXNDb250YWluZXJzLCB2YWx1ZSlcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZFR5cGVDb250YWluZXIodmFsdWVzQ29udGFpbmVycywgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRyczogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9ID0ge31cbiAgICApOiB2b2lkIHtcbiAgICAgICAgYXR0cnMuY2xzID0gXCJ2YWx1ZS1jb250YWluZXJcIlxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpKVxuICAgIH1cbn0iLCAiLy8gQ3JlZGl0cyBnbyB0byBMaWFtJ3MgUGVyaW9kaWMgTm90ZXMgUGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vbGlhbWNhaW4vb2JzaWRpYW4tcGVyaW9kaWMtbm90ZXNcblxuaW1wb3J0IHsgVEFic3RyYWN0RmlsZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRleHRJbnB1dFN1Z2dlc3QgfSBmcm9tIFwiLi9zdWdnZXN0XCI7XG5pbXBvcnQgeyBnZXRfdGZpbGVzX2Zyb21fZm9sZGVyIH0gZnJvbSBcIi4uL3V0aWxzL2ZpbGVVdGlsc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuXG5leHBvcnQgY2xhc3MgRmlsZVN1Z2dlc3QgZXh0ZW5kcyBUZXh0SW5wdXRTdWdnZXN0PFRGaWxlPiB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwdWJsaWMgZm9sZGVyOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBleHRlbnN0aW9uOiBzdHJpbmcgPSBcIm1kXCJcbiAgICApIHtcbiAgICAgICAgc3VwZXIoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRfc3RyOiBzdHJpbmcpOiBURmlsZVtdIHtcbiAgICAgICAgY29uc3QgYWxsX2ZpbGVzID0gW11cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGFsbF9maWxlcy5wdXNoKC4uLmdldF90ZmlsZXNfZnJvbV9mb2xkZXIodGhpcy5wbHVnaW4sIHRoaXMuZm9sZGVyKSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpbGVzOiBURmlsZVtdID0gW107XG4gICAgICAgIGNvbnN0IGxvd2VyX2lucHV0X3N0ciA9IGlucHV0X3N0ci50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGFsbF9maWxlcy5mb3JFYWNoKChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmXG4gICAgICAgICAgICAgICAgZmlsZS5leHRlbnNpb24gPT09IHRoaXMuZXh0ZW5zdGlvbiAmJlxuICAgICAgICAgICAgICAgIGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKGxvd2VyX2lucHV0X3N0cilcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGZpbGVzLnB1c2goZmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmaWxlcztcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuc2V0VGV4dChmaWxlLnBhdGgpO1xuICAgIH1cblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24oZmlsZTogVEZpbGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gZmlsZS5wYXRoO1xuICAgICAgICB0aGlzLmlucHV0RWwudHJpZ2dlcihcImlucHV0XCIpO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxufVxuIiwgIi8vIENyZWRpdHMgZ28gdG8gTGlhbSdzIFBlcmlvZGljIE5vdGVzIFBsdWdpbjogaHR0cHM6Ly9naXRodWIuY29tL2xpYW1jYWluL29ic2lkaWFuLXBlcmlvZGljLW5vdGVzXG5cbmltcG9ydCB7IElTdWdnZXN0T3duZXIsIFNjb3BlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBjcmVhdGVQb3BwZXIsIEluc3RhbmNlIGFzIFBvcHBlckluc3RhbmNlIH0gZnJvbSBcIkBwb3BwZXJqcy9jb3JlXCI7XG5cbmNvbnN0IHdyYXBBcm91bmQgPSAodmFsdWU6IG51bWJlciwgc2l6ZTogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgICByZXR1cm4gKCh2YWx1ZSAlIHNpemUpICsgc2l6ZSkgJSBzaXplO1xufTtcblxuY2xhc3MgU3VnZ2VzdDxUPiB7XG4gICAgcHJpdmF0ZSB2YWx1ZXM6IFRbXTtcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25zOiBIVE1MRGl2RWxlbWVudFtdO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRJdGVtOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBvd25lcjogSVN1Z2dlc3RPd25lcjxUPixcbiAgICAgICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXG4gICAgICAgIHNjb3BlOiBTY29wZVxuICAgICkge1xuXG4gICAgICAgIGNvbnRhaW5lckVsLm9uKFxuICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbkNsaWNrLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgY29udGFpbmVyRWwub24oXG4gICAgICAgICAgICBcIm1vdXNlbW92ZVwiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbk1vdXNlb3Zlci5iaW5kKHRoaXMpXG4gICAgICAgICk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dVcFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSh0aGlzLnNlbGVjdGVkSXRlbSAtIDEsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dEb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKHRoaXMuc2VsZWN0ZWRJdGVtICsgMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJFbnRlclwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZVNlbGVjdGVkSXRlbShldmVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvblN1Z2dlc3Rpb25DbGljayhldmVudDogTW91c2VFdmVudCwgZWw6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuc3VnZ2VzdGlvbnMuaW5kZXhPZihlbCk7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKGl0ZW0sIGZhbHNlKTtcbiAgICAgICAgdGhpcy51c2VTZWxlY3RlZEl0ZW0oZXZlbnQpO1xuICAgIH1cblxuICAgIG9uU3VnZ2VzdGlvbk1vdXNlb3ZlcihfZXZlbnQ6IE1vdXNlRXZlbnQsIGVsOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5zdWdnZXN0aW9ucy5pbmRleE9mKGVsKTtcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0oaXRlbSwgZmFsc2UpO1xuICAgIH1cblxuICAgIHNldFN1Z2dlc3Rpb25zKHZhbHVlczogVFtdKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsczogSFRNTERpdkVsZW1lbnRbXSA9IFtdO1xuXG4gICAgICAgIHZhbHVlcy5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoXCJzdWdnZXN0aW9uLWl0ZW1cIik7XG4gICAgICAgICAgICB0aGlzLm93bmVyLnJlbmRlclN1Z2dlc3Rpb24odmFsdWUsIHN1Z2dlc3Rpb25FbCk7XG4gICAgICAgICAgICBzdWdnZXN0aW9uRWxzLnB1c2goc3VnZ2VzdGlvbkVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9uRWxzO1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSgwLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgdXNlU2VsZWN0ZWRJdGVtKGV2ZW50OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnZhbHVlc1t0aGlzLnNlbGVjdGVkSXRlbV07XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMub3duZXIuc2VsZWN0U3VnZ2VzdGlvbihjdXJyZW50VmFsdWUsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFNlbGVjdGVkSXRlbShzZWxlY3RlZEluZGV4OiBudW1iZXIsIHNjcm9sbEludG9WaWV3OiBib29sZWFuKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJbmRleCA9IHdyYXBBcm91bmQoXG4gICAgICAgICAgICBzZWxlY3RlZEluZGV4LFxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGhcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdGlvbnNbdGhpcy5zZWxlY3RlZEl0ZW1dO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFN1Z2dlc3Rpb24gPSB0aGlzLnN1Z2dlc3Rpb25zW25vcm1hbGl6ZWRJbmRleF07XG5cbiAgICAgICAgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbj8ucmVtb3ZlQ2xhc3MoXCJpcy1zZWxlY3RlZFwiKTtcbiAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uPy5hZGRDbGFzcyhcImlzLXNlbGVjdGVkXCIpO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gbm9ybWFsaXplZEluZGV4O1xuXG4gICAgICAgIGlmIChzY3JvbGxJbnRvVmlldykge1xuICAgICAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uLnNjcm9sbEludG9WaWV3KGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRleHRJbnB1dFN1Z2dlc3Q8VD4gaW1wbGVtZW50cyBJU3VnZ2VzdE93bmVyPFQ+IHtcbiAgICBwcm90ZWN0ZWQgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG5cbiAgICBwcml2YXRlIHBvcHBlcjogUG9wcGVySW5zdGFuY2U7XG4gICAgcHJpdmF0ZSBzY29wZTogU2NvcGU7XG4gICAgcHJpdmF0ZSBzdWdnZXN0RWw6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgc3VnZ2VzdDogU3VnZ2VzdDxUPjtcblxuICAgIGNvbnN0cnVjdG9yKGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuaW5wdXRFbCA9IGlucHV0RWw7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBuZXcgU2NvcGUoKTtcblxuICAgICAgICB0aGlzLnN1Z2dlc3RFbCA9IGNyZWF0ZURpdihcInN1Z2dlc3Rpb24tY29udGFpbmVyXCIpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uID0gdGhpcy5zdWdnZXN0RWwuY3JlYXRlRGl2KFwic3VnZ2VzdGlvblwiKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0ID0gbmV3IFN1Z2dlc3QodGhpcywgc3VnZ2VzdGlvbiwgdGhpcy5zY29wZSk7XG5cbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJFc2NhcGVcIiwgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIHRoaXMub25JbnB1dENoYW5nZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgdGhpcy5vbklucHV0Q2hhbmdlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuc3VnZ2VzdEVsLm9uKFxuICAgICAgICAgICAgXCJtb3VzZWRvd25cIixcbiAgICAgICAgICAgIFwiLnN1Z2dlc3Rpb24tY29udGFpbmVyXCIsXG4gICAgICAgICAgICAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIG9uSW5wdXRDaGFuZ2VkKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpbnB1dFN0ciA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKGlucHV0U3RyKTtcblxuICAgICAgICBpZiAoIXN1Z2dlc3Rpb25zKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0LnNldFN1Z2dlc3Rpb25zKHN1Z2dlc3Rpb25zKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB0aGlzLm9wZW4oKDxhbnk+YXBwKS5kb20uYXBwQ29udGFpbmVyRWwsIHRoaXMuaW5wdXRFbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvcGVuKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGlucHV0RWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICg8YW55PmFwcCkua2V5bWFwLnB1c2hTY29wZSh0aGlzLnNjb3BlKTtcblxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5zdWdnZXN0RWwpO1xuICAgICAgICB0aGlzLnBvcHBlciA9IGNyZWF0ZVBvcHBlcihpbnB1dEVsLCB0aGlzLnN1Z2dlc3RFbCwge1xuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbS1zdGFydFwiLFxuICAgICAgICAgICAgbW9kaWZpZXJzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInNhbWVXaWR0aFwiLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBmbjogKHsgc3RhdGUsIGluc3RhbmNlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGU6IHBvc2l0aW9uaW5nIG5lZWRzIHRvIGJlIGNhbGN1bGF0ZWQgdHdpY2UgLVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmlyc3QgcGFzcyAtIHBvc2l0aW9uaW5nIGl0IGFjY29yZGluZyB0byB0aGUgd2lkdGggb2YgdGhlIHBvcHBlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2Vjb25kIHBhc3MgLSBwb3NpdGlvbiBpdCB3aXRoIHRoZSB3aWR0aCBib3VuZCB0byB0aGUgcmVmZXJlbmNlIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gZWFybHkgZXhpdCB0byBhdm9pZCBhbiBpbmZpbml0ZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRXaWR0aCA9IGAke3N0YXRlLnJlY3RzLnJlZmVyZW5jZS53aWR0aH1weGA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc3R5bGVzLnBvcHBlci53aWR0aCA9PT0gdGFyZ2V0V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5zdHlsZXMucG9wcGVyLndpZHRoID0gdGFyZ2V0V2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcGhhc2U6IFwiYmVmb3JlV3JpdGVcIixcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZXM6IFtcImNvbXB1dGVTdHlsZXNcIl0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNsb3NlKCk6IHZvaWQge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAoPGFueT5hcHApLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcblxuICAgICAgICB0aGlzLnN1Z2dlc3Quc2V0U3VnZ2VzdGlvbnMoW10pO1xuICAgICAgICBpZiAodGhpcy5wb3BwZXIpIHRoaXMucG9wcGVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0RWwuZGV0YWNoKCk7XG4gICAgfVxuXG4gICAgYWJzdHJhY3QgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHI6IHN0cmluZyk6IFRbXTtcbiAgICBhYnN0cmFjdCByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IFQsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQ7XG4gICAgYWJzdHJhY3Qgc2VsZWN0U3VnZ2VzdGlvbihpdGVtOiBUKTogdm9pZDtcbn1cbiIsICJleHBvcnQgdmFyIHRvcCA9ICd0b3AnO1xuZXhwb3J0IHZhciBib3R0b20gPSAnYm90dG9tJztcbmV4cG9ydCB2YXIgcmlnaHQgPSAncmlnaHQnO1xuZXhwb3J0IHZhciBsZWZ0ID0gJ2xlZnQnO1xuZXhwb3J0IHZhciBhdXRvID0gJ2F1dG8nO1xuZXhwb3J0IHZhciBiYXNlUGxhY2VtZW50cyA9IFt0b3AsIGJvdHRvbSwgcmlnaHQsIGxlZnRdO1xuZXhwb3J0IHZhciBzdGFydCA9ICdzdGFydCc7XG5leHBvcnQgdmFyIGVuZCA9ICdlbmQnO1xuZXhwb3J0IHZhciBjbGlwcGluZ1BhcmVudHMgPSAnY2xpcHBpbmdQYXJlbnRzJztcbmV4cG9ydCB2YXIgdmlld3BvcnQgPSAndmlld3BvcnQnO1xuZXhwb3J0IHZhciBwb3BwZXIgPSAncG9wcGVyJztcbmV4cG9ydCB2YXIgcmVmZXJlbmNlID0gJ3JlZmVyZW5jZSc7XG5leHBvcnQgdmFyIHZhcmlhdGlvblBsYWNlbWVudHMgPSAvKiNfX1BVUkVfXyovYmFzZVBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50ICsgXCItXCIgKyBzdGFydCwgcGxhY2VtZW50ICsgXCItXCIgKyBlbmRdKTtcbn0sIFtdKTtcbmV4cG9ydCB2YXIgcGxhY2VtZW50cyA9IC8qI19fUFVSRV9fKi9bXS5jb25jYXQoYmFzZVBsYWNlbWVudHMsIFthdXRvXSkucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50LCBwbGFjZW1lbnQgKyBcIi1cIiArIHN0YXJ0LCBwbGFjZW1lbnQgKyBcIi1cIiArIGVuZF0pO1xufSwgW10pOyAvLyBtb2RpZmllcnMgdGhhdCBuZWVkIHRvIHJlYWQgdGhlIERPTVxuXG5leHBvcnQgdmFyIGJlZm9yZVJlYWQgPSAnYmVmb3JlUmVhZCc7XG5leHBvcnQgdmFyIHJlYWQgPSAncmVhZCc7XG5leHBvcnQgdmFyIGFmdGVyUmVhZCA9ICdhZnRlclJlYWQnOyAvLyBwdXJlLWxvZ2ljIG1vZGlmaWVyc1xuXG5leHBvcnQgdmFyIGJlZm9yZU1haW4gPSAnYmVmb3JlTWFpbic7XG5leHBvcnQgdmFyIG1haW4gPSAnbWFpbic7XG5leHBvcnQgdmFyIGFmdGVyTWFpbiA9ICdhZnRlck1haW4nOyAvLyBtb2RpZmllciB3aXRoIHRoZSBwdXJwb3NlIHRvIHdyaXRlIHRvIHRoZSBET00gKG9yIHdyaXRlIGludG8gYSBmcmFtZXdvcmsgc3RhdGUpXG5cbmV4cG9ydCB2YXIgYmVmb3JlV3JpdGUgPSAnYmVmb3JlV3JpdGUnO1xuZXhwb3J0IHZhciB3cml0ZSA9ICd3cml0ZSc7XG5leHBvcnQgdmFyIGFmdGVyV3JpdGUgPSAnYWZ0ZXJXcml0ZSc7XG5leHBvcnQgdmFyIG1vZGlmaWVyUGhhc2VzID0gW2JlZm9yZVJlYWQsIHJlYWQsIGFmdGVyUmVhZCwgYmVmb3JlTWFpbiwgbWFpbiwgYWZ0ZXJNYWluLCBiZWZvcmVXcml0ZSwgd3JpdGUsIGFmdGVyV3JpdGVdOyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlTmFtZShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50ID8gKGVsZW1lbnQubm9kZU5hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCkgOiBudWxsO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3cobm9kZSkge1xuICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbiAgfVxuXG4gIGlmIChub2RlLnRvU3RyaW5nKCkgIT09ICdbb2JqZWN0IFdpbmRvd10nKSB7XG4gICAgdmFyIG93bmVyRG9jdW1lbnQgPSBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgcmV0dXJuIG93bmVyRG9jdW1lbnQgPyBvd25lckRvY3VtZW50LmRlZmF1bHRWaWV3IHx8IHdpbmRvdyA6IHdpbmRvdztcbiAgfVxuXG4gIHJldHVybiBub2RlO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuXG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5FbGVtZW50O1xuICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIE93bkVsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGlzSFRNTEVsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5IVE1MRWxlbWVudDtcbiAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBPd25FbGVtZW50IHx8IG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gaXNTaGFkb3dSb290KG5vZGUpIHtcbiAgLy8gSUUgMTEgaGFzIG5vIFNoYWRvd1Jvb3RcbiAgaWYgKHR5cGVvZiBTaGFkb3dSb290ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLlNoYWRvd1Jvb3Q7XG4gIHJldHVybiBub2RlIGluc3RhbmNlb2YgT3duRWxlbWVudCB8fCBub2RlIGluc3RhbmNlb2YgU2hhZG93Um9vdDtcbn1cblxuZXhwb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50LCBpc1NoYWRvd1Jvb3QgfTsiLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjsgLy8gVGhpcyBtb2RpZmllciB0YWtlcyB0aGUgc3R5bGVzIHByZXBhcmVkIGJ5IHRoZSBgY29tcHV0ZVN0eWxlc2AgbW9kaWZpZXJcbi8vIGFuZCBhcHBsaWVzIHRoZW0gdG8gdGhlIEhUTUxFbGVtZW50cyBzdWNoIGFzIHBvcHBlciBhbmQgYXJyb3dcblxuZnVuY3Rpb24gYXBwbHlTdHlsZXMoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlO1xuICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgIHZhciBzdHlsZSA9IHN0YXRlLnN0eWxlc1tuYW1lXSB8fCB7fTtcbiAgICB2YXIgYXR0cmlidXRlcyA9IHN0YXRlLmF0dHJpYnV0ZXNbbmFtZV0gfHwge307XG4gICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTsgLy8gYXJyb3cgaXMgb3B0aW9uYWwgKyB2aXJ0dWFsIGVsZW1lbnRzXG5cbiAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBGbG93IGRvZXNuJ3Qgc3VwcG9ydCB0byBleHRlbmQgdGhpcyBwcm9wZXJ0eSwgYnV0IGl0J3MgdGhlIG1vc3RcbiAgICAvLyBlZmZlY3RpdmUgd2F5IHRvIGFwcGx5IHN0eWxlcyB0byBhbiBIVE1MRWxlbWVudFxuICAgIC8vICRGbG93Rml4TWVbY2Fubm90LXdyaXRlXVxuXG5cbiAgICBPYmplY3QuYXNzaWduKGVsZW1lbnQuc3R5bGUsIHN0eWxlKTtcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuXG4gICAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUgPT09IHRydWUgPyAnJyA6IHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZTtcbiAgdmFyIGluaXRpYWxTdHlsZXMgPSB7XG4gICAgcG9wcGVyOiB7XG4gICAgICBwb3NpdGlvbjogc3RhdGUub3B0aW9ucy5zdHJhdGVneSxcbiAgICAgIGxlZnQ6ICcwJyxcbiAgICAgIHRvcDogJzAnLFxuICAgICAgbWFyZ2luOiAnMCdcbiAgICB9LFxuICAgIGFycm93OiB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJ1xuICAgIH0sXG4gICAgcmVmZXJlbmNlOiB7fVxuICB9O1xuICBPYmplY3QuYXNzaWduKHN0YXRlLmVsZW1lbnRzLnBvcHBlci5zdHlsZSwgaW5pdGlhbFN0eWxlcy5wb3BwZXIpO1xuICBzdGF0ZS5zdHlsZXMgPSBpbml0aWFsU3R5bGVzO1xuXG4gIGlmIChzdGF0ZS5lbGVtZW50cy5hcnJvdykge1xuICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuZWxlbWVudHMuYXJyb3cuc3R5bGUsIGluaXRpYWxTdHlsZXMuYXJyb3cpO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTtcbiAgICAgIHZhciBhdHRyaWJ1dGVzID0gc3RhdGUuYXR0cmlidXRlc1tuYW1lXSB8fCB7fTtcbiAgICAgIHZhciBzdHlsZVByb3BlcnRpZXMgPSBPYmplY3Qua2V5cyhzdGF0ZS5zdHlsZXMuaGFzT3duUHJvcGVydHkobmFtZSkgPyBzdGF0ZS5zdHlsZXNbbmFtZV0gOiBpbml0aWFsU3R5bGVzW25hbWVdKTsgLy8gU2V0IGFsbCB2YWx1ZXMgdG8gYW4gZW1wdHkgc3RyaW5nIHRvIHVuc2V0IHRoZW1cblxuICAgICAgdmFyIHN0eWxlID0gc3R5bGVQcm9wZXJ0aWVzLnJlZHVjZShmdW5jdGlvbiAoc3R5bGUsIHByb3BlcnR5KSB7XG4gICAgICAgIHN0eWxlW3Byb3BlcnR5XSA9ICcnO1xuICAgICAgICByZXR1cm4gc3R5bGU7XG4gICAgICB9LCB7fSk7IC8vIGFycm93IGlzIG9wdGlvbmFsICsgdmlydHVhbCBlbGVtZW50c1xuXG4gICAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgT2JqZWN0LmFzc2lnbihlbGVtZW50LnN0eWxlLCBzdHlsZSk7XG4gICAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnYXBwbHlTdHlsZXMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ3dyaXRlJyxcbiAgZm46IGFwcGx5U3R5bGVzLFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgcmVxdWlyZXM6IFsnY29tcHV0ZVN0eWxlcyddXG59OyIsICJpbXBvcnQgeyBhdXRvIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnNwbGl0KCctJylbMF07XG59IiwgImV4cG9ydCB2YXIgbWF4ID0gTWF0aC5tYXg7XG5leHBvcnQgdmFyIG1pbiA9IE1hdGgubWluO1xuZXhwb3J0IHZhciByb3VuZCA9IE1hdGgucm91bmQ7IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFVBU3RyaW5nKCkge1xuICB2YXIgdWFEYXRhID0gbmF2aWdhdG9yLnVzZXJBZ2VudERhdGE7XG5cbiAgaWYgKHVhRGF0YSAhPSBudWxsICYmIHVhRGF0YS5icmFuZHMpIHtcbiAgICByZXR1cm4gdWFEYXRhLmJyYW5kcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtLmJyYW5kICsgXCIvXCIgKyBpdGVtLnZlcnNpb247XG4gICAgfSkuam9pbignICcpO1xuICB9XG5cbiAgcmV0dXJuIG5hdmlnYXRvci51c2VyQWdlbnQ7XG59IiwgImltcG9ydCBnZXRVQVN0cmluZyBmcm9tIFwiLi4vdXRpbHMvdXNlckFnZW50LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc0xheW91dFZpZXdwb3J0KCkge1xuICByZXR1cm4gIS9eKCg/IWNocm9tZXxhbmRyb2lkKS4pKnNhZmFyaS9pLnRlc3QoZ2V0VUFTdHJpbmcoKSk7XG59IiwgImltcG9ydCB7IGlzRWxlbWVudCwgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCB7IHJvdW5kIH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgaXNMYXlvdXRWaWV3cG9ydCBmcm9tIFwiLi9pc0xheW91dFZpZXdwb3J0LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCwgaW5jbHVkZVNjYWxlLCBpc0ZpeGVkU3RyYXRlZ3kpIHtcbiAgaWYgKGluY2x1ZGVTY2FsZSA9PT0gdm9pZCAwKSB7XG4gICAgaW5jbHVkZVNjYWxlID0gZmFsc2U7XG4gIH1cblxuICBpZiAoaXNGaXhlZFN0cmF0ZWd5ID09PSB2b2lkIDApIHtcbiAgICBpc0ZpeGVkU3RyYXRlZ3kgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBjbGllbnRSZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgdmFyIHNjYWxlWCA9IDE7XG4gIHZhciBzY2FsZVkgPSAxO1xuXG4gIGlmIChpbmNsdWRlU2NhbGUgJiYgaXNIVE1MRWxlbWVudChlbGVtZW50KSkge1xuICAgIHNjYWxlWCA9IGVsZW1lbnQub2Zmc2V0V2lkdGggPiAwID8gcm91bmQoY2xpZW50UmVjdC53aWR0aCkgLyBlbGVtZW50Lm9mZnNldFdpZHRoIHx8IDEgOiAxO1xuICAgIHNjYWxlWSA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0ID4gMCA/IHJvdW5kKGNsaWVudFJlY3QuaGVpZ2h0KSAvIGVsZW1lbnQub2Zmc2V0SGVpZ2h0IHx8IDEgOiAxO1xuICB9XG5cbiAgdmFyIF9yZWYgPSBpc0VsZW1lbnQoZWxlbWVudCkgPyBnZXRXaW5kb3coZWxlbWVudCkgOiB3aW5kb3csXG4gICAgICB2aXN1YWxWaWV3cG9ydCA9IF9yZWYudmlzdWFsVmlld3BvcnQ7XG5cbiAgdmFyIGFkZFZpc3VhbE9mZnNldHMgPSAhaXNMYXlvdXRWaWV3cG9ydCgpICYmIGlzRml4ZWRTdHJhdGVneTtcbiAgdmFyIHggPSAoY2xpZW50UmVjdC5sZWZ0ICsgKGFkZFZpc3VhbE9mZnNldHMgJiYgdmlzdWFsVmlld3BvcnQgPyB2aXN1YWxWaWV3cG9ydC5vZmZzZXRMZWZ0IDogMCkpIC8gc2NhbGVYO1xuICB2YXIgeSA9IChjbGllbnRSZWN0LnRvcCArIChhZGRWaXN1YWxPZmZzZXRzICYmIHZpc3VhbFZpZXdwb3J0ID8gdmlzdWFsVmlld3BvcnQub2Zmc2V0VG9wIDogMCkpIC8gc2NhbGVZO1xuICB2YXIgd2lkdGggPSBjbGllbnRSZWN0LndpZHRoIC8gc2NhbGVYO1xuICB2YXIgaGVpZ2h0ID0gY2xpZW50UmVjdC5oZWlnaHQgLyBzY2FsZVk7XG4gIHJldHVybiB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHRvcDogeSxcbiAgICByaWdodDogeCArIHdpZHRoLFxuICAgIGJvdHRvbTogeSArIGhlaWdodCxcbiAgICBsZWZ0OiB4LFxuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xufSIsICJpbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiOyAvLyBSZXR1cm5zIHRoZSBsYXlvdXQgcmVjdCBvZiBhbiBlbGVtZW50IHJlbGF0aXZlIHRvIGl0cyBvZmZzZXRQYXJlbnQuIExheW91dFxuLy8gbWVhbnMgaXQgZG9lc24ndCB0YWtlIGludG8gYWNjb3VudCB0cmFuc2Zvcm1zLlxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRMYXlvdXRSZWN0KGVsZW1lbnQpIHtcbiAgdmFyIGNsaWVudFJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCk7IC8vIFVzZSB0aGUgY2xpZW50UmVjdCBzaXplcyBpZiBpdCdzIG5vdCBiZWVuIHRyYW5zZm9ybWVkLlxuICAvLyBGaXhlcyBodHRwczovL2dpdGh1Yi5jb20vcG9wcGVyanMvcG9wcGVyLWNvcmUvaXNzdWVzLzEyMjNcblxuICB2YXIgd2lkdGggPSBlbGVtZW50Lm9mZnNldFdpZHRoO1xuICB2YXIgaGVpZ2h0ID0gZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cbiAgaWYgKE1hdGguYWJzKGNsaWVudFJlY3Qud2lkdGggLSB3aWR0aCkgPD0gMSkge1xuICAgIHdpZHRoID0gY2xpZW50UmVjdC53aWR0aDtcbiAgfVxuXG4gIGlmIChNYXRoLmFicyhjbGllbnRSZWN0LmhlaWdodCAtIGhlaWdodCkgPD0gMSkge1xuICAgIGhlaWdodCA9IGNsaWVudFJlY3QuaGVpZ2h0O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB4OiBlbGVtZW50Lm9mZnNldExlZnQsXG4gICAgeTogZWxlbWVudC5vZmZzZXRUb3AsXG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0XG4gIH07XG59IiwgImltcG9ydCB7IGlzU2hhZG93Um9vdCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbnRhaW5zKHBhcmVudCwgY2hpbGQpIHtcbiAgdmFyIHJvb3ROb2RlID0gY2hpbGQuZ2V0Um9vdE5vZGUgJiYgY2hpbGQuZ2V0Um9vdE5vZGUoKTsgLy8gRmlyc3QsIGF0dGVtcHQgd2l0aCBmYXN0ZXIgbmF0aXZlIG1ldGhvZFxuXG4gIGlmIChwYXJlbnQuY29udGFpbnMoY2hpbGQpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gLy8gdGhlbiBmYWxsYmFjayB0byBjdXN0b20gaW1wbGVtZW50YXRpb24gd2l0aCBTaGFkb3cgRE9NIHN1cHBvcnRcbiAgZWxzZSBpZiAocm9vdE5vZGUgJiYgaXNTaGFkb3dSb290KHJvb3ROb2RlKSkge1xuICAgICAgdmFyIG5leHQgPSBjaGlsZDtcblxuICAgICAgZG8ge1xuICAgICAgICBpZiAobmV4dCAmJiBwYXJlbnQuaXNTYW1lTm9kZShuZXh0KSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXTogbmVlZCBhIGJldHRlciB3YXkgdG8gaGFuZGxlIHRoaXMuLi5cblxuXG4gICAgICAgIG5leHQgPSBuZXh0LnBhcmVudE5vZGUgfHwgbmV4dC5ob3N0O1xuICAgICAgfSB3aGlsZSAobmV4dCk7XG4gICAgfSAvLyBHaXZlIHVwLCB0aGUgcmVzdWx0IGlzIGZhbHNlXG5cblxuICByZXR1cm4gZmFsc2U7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGdldFdpbmRvdyhlbGVtZW50KS5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xufSIsICJpbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzVGFibGVFbGVtZW50KGVsZW1lbnQpIHtcbiAgcmV0dXJuIFsndGFibGUnLCAndGQnLCAndGgnXS5pbmRleE9mKGdldE5vZGVOYW1lKGVsZW1lbnQpKSA+PSAwO1xufSIsICJpbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkge1xuICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dOiBhc3N1bWUgYm9keSBpcyBhbHdheXMgYXZhaWxhYmxlXG4gIHJldHVybiAoKGlzRWxlbWVudChlbGVtZW50KSA/IGVsZW1lbnQub3duZXJEb2N1bWVudCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICBlbGVtZW50LmRvY3VtZW50KSB8fCB3aW5kb3cuZG9jdW1lbnQpLmRvY3VtZW50RWxlbWVudDtcbn0iLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IHsgaXNTaGFkb3dSb290IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0UGFyZW50Tm9kZShlbGVtZW50KSB7XG4gIGlmIChnZXROb2RlTmFtZShlbGVtZW50KSA9PT0gJ2h0bWwnKSB7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH1cblxuICByZXR1cm4gKC8vIHRoaXMgaXMgYSBxdWlja2VyIChidXQgbGVzcyB0eXBlIHNhZmUpIHdheSB0byBzYXZlIHF1aXRlIHNvbWUgYnl0ZXMgZnJvbSB0aGUgYnVuZGxlXG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXVxuICAgIC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgIGVsZW1lbnQuYXNzaWduZWRTbG90IHx8IC8vIHN0ZXAgaW50byB0aGUgc2hhZG93IERPTSBvZiB0aGUgcGFyZW50IG9mIGEgc2xvdHRlZCBub2RlXG4gICAgZWxlbWVudC5wYXJlbnROb2RlIHx8ICggLy8gRE9NIEVsZW1lbnQgZGV0ZWN0ZWRcbiAgICBpc1NoYWRvd1Jvb3QoZWxlbWVudCkgPyBlbGVtZW50Lmhvc3QgOiBudWxsKSB8fCAvLyBTaGFkb3dSb290IGRldGVjdGVkXG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF06IEhUTUxFbGVtZW50IGlzIGEgTm9kZVxuICAgIGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSAvLyBmYWxsYmFja1xuXG4gICk7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQsIGlzU2hhZG93Um9vdCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBpc1RhYmxlRWxlbWVudCBmcm9tIFwiLi9pc1RhYmxlRWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGdldFVBU3RyaW5nIGZyb20gXCIuLi91dGlscy91c2VyQWdlbnQuanNcIjtcblxuZnVuY3Rpb24gZ2V0VHJ1ZU9mZnNldFBhcmVudChlbGVtZW50KSB7XG4gIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSB8fCAvLyBodHRwczovL2dpdGh1Yi5jb20vcG9wcGVyanMvcG9wcGVyLWNvcmUvaXNzdWVzLzgzN1xuICBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLnBvc2l0aW9uID09PSAnZml4ZWQnKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudC5vZmZzZXRQYXJlbnQ7XG59IC8vIGAub2Zmc2V0UGFyZW50YCByZXBvcnRzIGBudWxsYCBmb3IgZml4ZWQgZWxlbWVudHMsIHdoaWxlIGFic29sdXRlIGVsZW1lbnRzXG4vLyByZXR1cm4gdGhlIGNvbnRhaW5pbmcgYmxvY2tcblxuXG5mdW5jdGlvbiBnZXRDb250YWluaW5nQmxvY2soZWxlbWVudCkge1xuICB2YXIgaXNGaXJlZm94ID0gL2ZpcmVmb3gvaS50ZXN0KGdldFVBU3RyaW5nKCkpO1xuICB2YXIgaXNJRSA9IC9UcmlkZW50L2kudGVzdChnZXRVQVN0cmluZygpKTtcblxuICBpZiAoaXNJRSAmJiBpc0hUTUxFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgLy8gSW4gSUUgOSwgMTAgYW5kIDExIGZpeGVkIGVsZW1lbnRzIGNvbnRhaW5pbmcgYmxvY2sgaXMgYWx3YXlzIGVzdGFibGlzaGVkIGJ5IHRoZSB2aWV3cG9ydFxuICAgIHZhciBlbGVtZW50Q3NzID0gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcblxuICAgIGlmIChlbGVtZW50Q3NzLnBvc2l0aW9uID09PSAnZml4ZWQnKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICB2YXIgY3VycmVudE5vZGUgPSBnZXRQYXJlbnROb2RlKGVsZW1lbnQpO1xuXG4gIGlmIChpc1NoYWRvd1Jvb3QoY3VycmVudE5vZGUpKSB7XG4gICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5ob3N0O1xuICB9XG5cbiAgd2hpbGUgKGlzSFRNTEVsZW1lbnQoY3VycmVudE5vZGUpICYmIFsnaHRtbCcsICdib2R5J10uaW5kZXhPZihnZXROb2RlTmFtZShjdXJyZW50Tm9kZSkpIDwgMCkge1xuICAgIHZhciBjc3MgPSBnZXRDb21wdXRlZFN0eWxlKGN1cnJlbnROb2RlKTsgLy8gVGhpcyBpcyBub24tZXhoYXVzdGl2ZSBidXQgY292ZXJzIHRoZSBtb3N0IGNvbW1vbiBDU1MgcHJvcGVydGllcyB0aGF0XG4gICAgLy8gY3JlYXRlIGEgY29udGFpbmluZyBibG9jay5cbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvQ29udGFpbmluZ19ibG9jayNpZGVudGlmeWluZ190aGVfY29udGFpbmluZ19ibG9ja1xuXG4gICAgaWYgKGNzcy50cmFuc2Zvcm0gIT09ICdub25lJyB8fCBjc3MucGVyc3BlY3RpdmUgIT09ICdub25lJyB8fCBjc3MuY29udGFpbiA9PT0gJ3BhaW50JyB8fCBbJ3RyYW5zZm9ybScsICdwZXJzcGVjdGl2ZSddLmluZGV4T2YoY3NzLndpbGxDaGFuZ2UpICE9PSAtMSB8fCBpc0ZpcmVmb3ggJiYgY3NzLndpbGxDaGFuZ2UgPT09ICdmaWx0ZXInIHx8IGlzRmlyZWZveCAmJiBjc3MuZmlsdGVyICYmIGNzcy5maWx0ZXIgIT09ICdub25lJykge1xuICAgICAgcmV0dXJuIGN1cnJlbnROb2RlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLnBhcmVudE5vZGU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59IC8vIEdldHMgdGhlIGNsb3Nlc3QgYW5jZXN0b3IgcG9zaXRpb25lZCBlbGVtZW50LiBIYW5kbGVzIHNvbWUgZWRnZSBjYXNlcyxcbi8vIHN1Y2ggYXMgdGFibGUgYW5jZXN0b3JzIGFuZCBjcm9zcyBicm93c2VyIGJ1Z3MuXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0T2Zmc2V0UGFyZW50KGVsZW1lbnQpIHtcbiAgdmFyIHdpbmRvdyA9IGdldFdpbmRvdyhlbGVtZW50KTtcbiAgdmFyIG9mZnNldFBhcmVudCA9IGdldFRydWVPZmZzZXRQYXJlbnQoZWxlbWVudCk7XG5cbiAgd2hpbGUgKG9mZnNldFBhcmVudCAmJiBpc1RhYmxlRWxlbWVudChvZmZzZXRQYXJlbnQpICYmIGdldENvbXB1dGVkU3R5bGUob2Zmc2V0UGFyZW50KS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpIHtcbiAgICBvZmZzZXRQYXJlbnQgPSBnZXRUcnVlT2Zmc2V0UGFyZW50KG9mZnNldFBhcmVudCk7XG4gIH1cblxuICBpZiAob2Zmc2V0UGFyZW50ICYmIChnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpID09PSAnaHRtbCcgfHwgZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSA9PT0gJ2JvZHknICYmIGdldENvbXB1dGVkU3R5bGUob2Zmc2V0UGFyZW50KS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbiAgfVxuXG4gIHJldHVybiBvZmZzZXRQYXJlbnQgfHwgZ2V0Q29udGFpbmluZ0Jsb2NrKGVsZW1lbnQpIHx8IHdpbmRvdztcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gWyd0b3AnLCAnYm90dG9tJ10uaW5kZXhPZihwbGFjZW1lbnQpID49IDAgPyAneCcgOiAneSc7XG59IiwgImltcG9ydCB7IG1heCBhcyBtYXRoTWF4LCBtaW4gYXMgbWF0aE1pbiB9IGZyb20gXCIuL21hdGguanNcIjtcbmV4cG9ydCBmdW5jdGlvbiB3aXRoaW4obWluLCB2YWx1ZSwgbWF4KSB7XG4gIHJldHVybiBtYXRoTWF4KG1pbiwgbWF0aE1pbih2YWx1ZSwgbWF4KSk7XG59XG5leHBvcnQgZnVuY3Rpb24gd2l0aGluTWF4Q2xhbXAobWluLCB2YWx1ZSwgbWF4KSB7XG4gIHZhciB2ID0gd2l0aGluKG1pbiwgdmFsdWUsIG1heCk7XG4gIHJldHVybiB2ID4gbWF4ID8gbWF4IDogdjtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0RnJlc2hTaWRlT2JqZWN0KCkge1xuICByZXR1cm4ge1xuICAgIHRvcDogMCxcbiAgICByaWdodDogMCxcbiAgICBib3R0b206IDAsXG4gICAgbGVmdDogMFxuICB9O1xufSIsICJpbXBvcnQgZ2V0RnJlc2hTaWRlT2JqZWN0IGZyb20gXCIuL2dldEZyZXNoU2lkZU9iamVjdC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWVyZ2VQYWRkaW5nT2JqZWN0KHBhZGRpbmdPYmplY3QpIHtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGdldEZyZXNoU2lkZU9iamVjdCgpLCBwYWRkaW5nT2JqZWN0KTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZXhwYW5kVG9IYXNoTWFwKHZhbHVlLCBrZXlzKSB7XG4gIHJldHVybiBrZXlzLnJlZHVjZShmdW5jdGlvbiAoaGFzaE1hcCwga2V5KSB7XG4gICAgaGFzaE1hcFtrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIGhhc2hNYXA7XG4gIH0sIHt9KTtcbn0iLCAiaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRMYXlvdXRSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qc1wiO1xuaW1wb3J0IGNvbnRhaW5zIGZyb20gXCIuLi9kb20tdXRpbHMvY29udGFpbnMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgd2l0aGluIH0gZnJvbSBcIi4uL3V0aWxzL3dpdGhpbi5qc1wiO1xuaW1wb3J0IG1lcmdlUGFkZGluZ09iamVjdCBmcm9tIFwiLi4vdXRpbHMvbWVyZ2VQYWRkaW5nT2JqZWN0LmpzXCI7XG5pbXBvcnQgZXhwYW5kVG9IYXNoTWFwIGZyb20gXCIuLi91dGlscy9leHBhbmRUb0hhc2hNYXAuanNcIjtcbmltcG9ydCB7IGxlZnQsIHJpZ2h0LCBiYXNlUGxhY2VtZW50cywgdG9wLCBib3R0b20gfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG52YXIgdG9QYWRkaW5nT2JqZWN0ID0gZnVuY3Rpb24gdG9QYWRkaW5nT2JqZWN0KHBhZGRpbmcsIHN0YXRlKSB7XG4gIHBhZGRpbmcgPSB0eXBlb2YgcGFkZGluZyA9PT0gJ2Z1bmN0aW9uJyA/IHBhZGRpbmcoT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUucmVjdHMsIHtcbiAgICBwbGFjZW1lbnQ6IHN0YXRlLnBsYWNlbWVudFxuICB9KSkgOiBwYWRkaW5nO1xuICByZXR1cm4gbWVyZ2VQYWRkaW5nT2JqZWN0KHR5cGVvZiBwYWRkaW5nICE9PSAnbnVtYmVyJyA/IHBhZGRpbmcgOiBleHBhbmRUb0hhc2hNYXAocGFkZGluZywgYmFzZVBsYWNlbWVudHMpKTtcbn07XG5cbmZ1bmN0aW9uIGFycm93KF9yZWYpIHtcbiAgdmFyIF9zdGF0ZSRtb2RpZmllcnNEYXRhJDtcblxuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnM7XG4gIHZhciBhcnJvd0VsZW1lbnQgPSBzdGF0ZS5lbGVtZW50cy5hcnJvdztcbiAgdmFyIHBvcHBlck9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHM7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gZ2V0QmFzZVBsYWNlbWVudChzdGF0ZS5wbGFjZW1lbnQpO1xuICB2YXIgYXhpcyA9IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KTtcbiAgdmFyIGlzVmVydGljYWwgPSBbbGVmdCwgcmlnaHRdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMDtcbiAgdmFyIGxlbiA9IGlzVmVydGljYWwgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG5cbiAgaWYgKCFhcnJvd0VsZW1lbnQgfHwgIXBvcHBlck9mZnNldHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgcGFkZGluZ09iamVjdCA9IHRvUGFkZGluZ09iamVjdChvcHRpb25zLnBhZGRpbmcsIHN0YXRlKTtcbiAgdmFyIGFycm93UmVjdCA9IGdldExheW91dFJlY3QoYXJyb3dFbGVtZW50KTtcbiAgdmFyIG1pblByb3AgPSBheGlzID09PSAneScgPyB0b3AgOiBsZWZ0O1xuICB2YXIgbWF4UHJvcCA9IGF4aXMgPT09ICd5JyA/IGJvdHRvbSA6IHJpZ2h0O1xuICB2YXIgZW5kRGlmZiA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZVtsZW5dICsgc3RhdGUucmVjdHMucmVmZXJlbmNlW2F4aXNdIC0gcG9wcGVyT2Zmc2V0c1theGlzXSAtIHN0YXRlLnJlY3RzLnBvcHBlcltsZW5dO1xuICB2YXIgc3RhcnREaWZmID0gcG9wcGVyT2Zmc2V0c1theGlzXSAtIHN0YXRlLnJlY3RzLnJlZmVyZW5jZVtheGlzXTtcbiAgdmFyIGFycm93T2Zmc2V0UGFyZW50ID0gZ2V0T2Zmc2V0UGFyZW50KGFycm93RWxlbWVudCk7XG4gIHZhciBjbGllbnRTaXplID0gYXJyb3dPZmZzZXRQYXJlbnQgPyBheGlzID09PSAneScgPyBhcnJvd09mZnNldFBhcmVudC5jbGllbnRIZWlnaHQgfHwgMCA6IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudFdpZHRoIHx8IDAgOiAwO1xuICB2YXIgY2VudGVyVG9SZWZlcmVuY2UgPSBlbmREaWZmIC8gMiAtIHN0YXJ0RGlmZiAvIDI7IC8vIE1ha2Ugc3VyZSB0aGUgYXJyb3cgZG9lc24ndCBvdmVyZmxvdyB0aGUgcG9wcGVyIGlmIHRoZSBjZW50ZXIgcG9pbnQgaXNcbiAgLy8gb3V0c2lkZSBvZiB0aGUgcG9wcGVyIGJvdW5kc1xuXG4gIHZhciBtaW4gPSBwYWRkaW5nT2JqZWN0W21pblByb3BdO1xuICB2YXIgbWF4ID0gY2xpZW50U2l6ZSAtIGFycm93UmVjdFtsZW5dIC0gcGFkZGluZ09iamVjdFttYXhQcm9wXTtcbiAgdmFyIGNlbnRlciA9IGNsaWVudFNpemUgLyAyIC0gYXJyb3dSZWN0W2xlbl0gLyAyICsgY2VudGVyVG9SZWZlcmVuY2U7XG4gIHZhciBvZmZzZXQgPSB3aXRoaW4obWluLCBjZW50ZXIsIG1heCk7IC8vIFByZXZlbnRzIGJyZWFraW5nIHN5bnRheCBoaWdobGlnaHRpbmcuLi5cblxuICB2YXIgYXhpc1Byb3AgPSBheGlzO1xuICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdID0gKF9zdGF0ZSRtb2RpZmllcnNEYXRhJCA9IHt9LCBfc3RhdGUkbW9kaWZpZXJzRGF0YSRbYXhpc1Byb3BdID0gb2Zmc2V0LCBfc3RhdGUkbW9kaWZpZXJzRGF0YSQuY2VudGVyT2Zmc2V0ID0gb2Zmc2V0IC0gY2VudGVyLCBfc3RhdGUkbW9kaWZpZXJzRGF0YSQpO1xufVxuXG5mdW5jdGlvbiBlZmZlY3QoX3JlZjIpIHtcbiAgdmFyIHN0YXRlID0gX3JlZjIuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZjIub3B0aW9ucztcbiAgdmFyIF9vcHRpb25zJGVsZW1lbnQgPSBvcHRpb25zLmVsZW1lbnQsXG4gICAgICBhcnJvd0VsZW1lbnQgPSBfb3B0aW9ucyRlbGVtZW50ID09PSB2b2lkIDAgPyAnW2RhdGEtcG9wcGVyLWFycm93XScgOiBfb3B0aW9ucyRlbGVtZW50O1xuXG4gIGlmIChhcnJvd0VsZW1lbnQgPT0gbnVsbCkge1xuICAgIHJldHVybjtcbiAgfSAvLyBDU1Mgc2VsZWN0b3JcblxuXG4gIGlmICh0eXBlb2YgYXJyb3dFbGVtZW50ID09PSAnc3RyaW5nJykge1xuICAgIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLnBvcHBlci5xdWVyeVNlbGVjdG9yKGFycm93RWxlbWVudCk7XG5cbiAgICBpZiAoIWFycm93RWxlbWVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICBpZiAoIWlzSFRNTEVsZW1lbnQoYXJyb3dFbGVtZW50KSkge1xuICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogXCJhcnJvd1wiIGVsZW1lbnQgbXVzdCBiZSBhbiBIVE1MRWxlbWVudCAobm90IGFuIFNWR0VsZW1lbnQpLicsICdUbyB1c2UgYW4gU1ZHIGFycm93LCB3cmFwIGl0IGluIGFuIEhUTUxFbGVtZW50IHRoYXQgd2lsbCBiZSB1c2VkIGFzJywgJ3RoZSBhcnJvdy4nXS5qb2luKCcgJykpO1xuICAgIH1cbiAgfVxuXG4gIGlmICghY29udGFpbnMoc3RhdGUuZWxlbWVudHMucG9wcGVyLCBhcnJvd0VsZW1lbnQpKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogXCJhcnJvd1wiIG1vZGlmaWVyXFwncyBgZWxlbWVudGAgbXVzdCBiZSBhIGNoaWxkIG9mIHRoZSBwb3BwZXInLCAnZWxlbWVudC4nXS5qb2luKCcgJykpO1xuICAgIH1cblxuICAgIHJldHVybjtcbiAgfVxuXG4gIHN0YXRlLmVsZW1lbnRzLmFycm93ID0gYXJyb3dFbGVtZW50O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnYXJyb3cnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogYXJyb3csXG4gIGVmZmVjdDogZWZmZWN0LFxuICByZXF1aXJlczogWydwb3BwZXJPZmZzZXRzJ10sXG4gIHJlcXVpcmVzSWZFeGlzdHM6IFsncHJldmVudE92ZXJmbG93J11cbn07IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFZhcmlhdGlvbihwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5zcGxpdCgnLScpWzFdO1xufSIsICJpbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBib3R0b20sIGVuZCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxudmFyIHVuc2V0U2lkZXMgPSB7XG4gIHRvcDogJ2F1dG8nLFxuICByaWdodDogJ2F1dG8nLFxuICBib3R0b206ICdhdXRvJyxcbiAgbGVmdDogJ2F1dG8nXG59OyAvLyBSb3VuZCB0aGUgb2Zmc2V0cyB0byB0aGUgbmVhcmVzdCBzdWl0YWJsZSBzdWJwaXhlbCBiYXNlZCBvbiB0aGUgRFBSLlxuLy8gWm9vbWluZyBjYW4gY2hhbmdlIHRoZSBEUFIsIGJ1dCBpdCBzZWVtcyB0byByZXBvcnQgYSB2YWx1ZSB0aGF0IHdpbGxcbi8vIGNsZWFubHkgZGl2aWRlIHRoZSB2YWx1ZXMgaW50byB0aGUgYXBwcm9wcmlhdGUgc3VicGl4ZWxzLlxuXG5mdW5jdGlvbiByb3VuZE9mZnNldHNCeURQUihfcmVmKSB7XG4gIHZhciB4ID0gX3JlZi54LFxuICAgICAgeSA9IF9yZWYueTtcbiAgdmFyIHdpbiA9IHdpbmRvdztcbiAgdmFyIGRwciA9IHdpbi5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gIHJldHVybiB7XG4gICAgeDogcm91bmQoeCAqIGRwcikgLyBkcHIgfHwgMCxcbiAgICB5OiByb3VuZCh5ICogZHByKSAvIGRwciB8fCAwXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXBUb1N0eWxlcyhfcmVmMikge1xuICB2YXIgX09iamVjdCRhc3NpZ24yO1xuXG4gIHZhciBwb3BwZXIgPSBfcmVmMi5wb3BwZXIsXG4gICAgICBwb3BwZXJSZWN0ID0gX3JlZjIucG9wcGVyUmVjdCxcbiAgICAgIHBsYWNlbWVudCA9IF9yZWYyLnBsYWNlbWVudCxcbiAgICAgIHZhcmlhdGlvbiA9IF9yZWYyLnZhcmlhdGlvbixcbiAgICAgIG9mZnNldHMgPSBfcmVmMi5vZmZzZXRzLFxuICAgICAgcG9zaXRpb24gPSBfcmVmMi5wb3NpdGlvbixcbiAgICAgIGdwdUFjY2VsZXJhdGlvbiA9IF9yZWYyLmdwdUFjY2VsZXJhdGlvbixcbiAgICAgIGFkYXB0aXZlID0gX3JlZjIuYWRhcHRpdmUsXG4gICAgICByb3VuZE9mZnNldHMgPSBfcmVmMi5yb3VuZE9mZnNldHMsXG4gICAgICBpc0ZpeGVkID0gX3JlZjIuaXNGaXhlZDtcbiAgdmFyIF9vZmZzZXRzJHggPSBvZmZzZXRzLngsXG4gICAgICB4ID0gX29mZnNldHMkeCA9PT0gdm9pZCAwID8gMCA6IF9vZmZzZXRzJHgsXG4gICAgICBfb2Zmc2V0cyR5ID0gb2Zmc2V0cy55LFxuICAgICAgeSA9IF9vZmZzZXRzJHkgPT09IHZvaWQgMCA/IDAgOiBfb2Zmc2V0cyR5O1xuXG4gIHZhciBfcmVmMyA9IHR5cGVvZiByb3VuZE9mZnNldHMgPT09ICdmdW5jdGlvbicgPyByb3VuZE9mZnNldHMoe1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9KSA6IHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcblxuICB4ID0gX3JlZjMueDtcbiAgeSA9IF9yZWYzLnk7XG4gIHZhciBoYXNYID0gb2Zmc2V0cy5oYXNPd25Qcm9wZXJ0eSgneCcpO1xuICB2YXIgaGFzWSA9IG9mZnNldHMuaGFzT3duUHJvcGVydHkoJ3knKTtcbiAgdmFyIHNpZGVYID0gbGVmdDtcbiAgdmFyIHNpZGVZID0gdG9wO1xuICB2YXIgd2luID0gd2luZG93O1xuXG4gIGlmIChhZGFwdGl2ZSkge1xuICAgIHZhciBvZmZzZXRQYXJlbnQgPSBnZXRPZmZzZXRQYXJlbnQocG9wcGVyKTtcbiAgICB2YXIgaGVpZ2h0UHJvcCA9ICdjbGllbnRIZWlnaHQnO1xuICAgIHZhciB3aWR0aFByb3AgPSAnY2xpZW50V2lkdGgnO1xuXG4gICAgaWYgKG9mZnNldFBhcmVudCA9PT0gZ2V0V2luZG93KHBvcHBlcikpIHtcbiAgICAgIG9mZnNldFBhcmVudCA9IGdldERvY3VtZW50RWxlbWVudChwb3BwZXIpO1xuXG4gICAgICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uICE9PSAnc3RhdGljJyAmJiBwb3NpdGlvbiA9PT0gJ2Fic29sdXRlJykge1xuICAgICAgICBoZWlnaHRQcm9wID0gJ3Njcm9sbEhlaWdodCc7XG4gICAgICAgIHdpZHRoUHJvcCA9ICdzY3JvbGxXaWR0aCc7XG4gICAgICB9XG4gICAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYXN0XTogZm9yY2UgdHlwZSByZWZpbmVtZW50LCB3ZSBjb21wYXJlIG9mZnNldFBhcmVudCB3aXRoIHdpbmRvdyBhYm92ZSwgYnV0IEZsb3cgZG9lc24ndCBkZXRlY3QgaXRcblxuXG4gICAgb2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50O1xuXG4gICAgaWYgKHBsYWNlbWVudCA9PT0gdG9wIHx8IChwbGFjZW1lbnQgPT09IGxlZnQgfHwgcGxhY2VtZW50ID09PSByaWdodCkgJiYgdmFyaWF0aW9uID09PSBlbmQpIHtcbiAgICAgIHNpZGVZID0gYm90dG9tO1xuICAgICAgdmFyIG9mZnNldFkgPSBpc0ZpeGVkICYmIG9mZnNldFBhcmVudCA9PT0gd2luICYmIHdpbi52aXN1YWxWaWV3cG9ydCA/IHdpbi52aXN1YWxWaWV3cG9ydC5oZWlnaHQgOiAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgICAgIG9mZnNldFBhcmVudFtoZWlnaHRQcm9wXTtcbiAgICAgIHkgLT0gb2Zmc2V0WSAtIHBvcHBlclJlY3QuaGVpZ2h0O1xuICAgICAgeSAqPSBncHVBY2NlbGVyYXRpb24gPyAxIDogLTE7XG4gICAgfVxuXG4gICAgaWYgKHBsYWNlbWVudCA9PT0gbGVmdCB8fCAocGxhY2VtZW50ID09PSB0b3AgfHwgcGxhY2VtZW50ID09PSBib3R0b20pICYmIHZhcmlhdGlvbiA9PT0gZW5kKSB7XG4gICAgICBzaWRlWCA9IHJpZ2h0O1xuICAgICAgdmFyIG9mZnNldFggPSBpc0ZpeGVkICYmIG9mZnNldFBhcmVudCA9PT0gd2luICYmIHdpbi52aXN1YWxWaWV3cG9ydCA/IHdpbi52aXN1YWxWaWV3cG9ydC53aWR0aCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgICAgb2Zmc2V0UGFyZW50W3dpZHRoUHJvcF07XG4gICAgICB4IC09IG9mZnNldFggLSBwb3BwZXJSZWN0LndpZHRoO1xuICAgICAgeCAqPSBncHVBY2NlbGVyYXRpb24gPyAxIDogLTE7XG4gICAgfVxuICB9XG5cbiAgdmFyIGNvbW1vblN0eWxlcyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIHBvc2l0aW9uOiBwb3NpdGlvblxuICB9LCBhZGFwdGl2ZSAmJiB1bnNldFNpZGVzKTtcblxuICB2YXIgX3JlZjQgPSByb3VuZE9mZnNldHMgPT09IHRydWUgPyByb3VuZE9mZnNldHNCeURQUih7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH0pIDoge1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xuXG4gIHggPSBfcmVmNC54O1xuICB5ID0gX3JlZjQueTtcblxuICBpZiAoZ3B1QWNjZWxlcmF0aW9uKSB7XG4gICAgdmFyIF9PYmplY3QkYXNzaWduO1xuXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywgKF9PYmplY3QkYXNzaWduID0ge30sIF9PYmplY3QkYXNzaWduW3NpZGVZXSA9IGhhc1kgPyAnMCcgOiAnJywgX09iamVjdCRhc3NpZ25bc2lkZVhdID0gaGFzWCA/ICcwJyA6ICcnLCBfT2JqZWN0JGFzc2lnbi50cmFuc2Zvcm0gPSAod2luLmRldmljZVBpeGVsUmF0aW8gfHwgMSkgPD0gMSA/IFwidHJhbnNsYXRlKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHgpXCIgOiBcInRyYW5zbGF0ZTNkKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHgsIDApXCIsIF9PYmplY3QkYXNzaWduKSk7XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCAoX09iamVjdCRhc3NpZ24yID0ge30sIF9PYmplY3QkYXNzaWduMltzaWRlWV0gPSBoYXNZID8geSArIFwicHhcIiA6ICcnLCBfT2JqZWN0JGFzc2lnbjJbc2lkZVhdID0gaGFzWCA/IHggKyBcInB4XCIgOiAnJywgX09iamVjdCRhc3NpZ24yLnRyYW5zZm9ybSA9ICcnLCBfT2JqZWN0JGFzc2lnbjIpKTtcbn1cblxuZnVuY3Rpb24gY29tcHV0ZVN0eWxlcyhfcmVmNSkge1xuICB2YXIgc3RhdGUgPSBfcmVmNS5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmNS5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkZ3B1QWNjZWxlcmF0ID0gb3B0aW9ucy5ncHVBY2NlbGVyYXRpb24sXG4gICAgICBncHVBY2NlbGVyYXRpb24gPSBfb3B0aW9ucyRncHVBY2NlbGVyYXQgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRncHVBY2NlbGVyYXQsXG4gICAgICBfb3B0aW9ucyRhZGFwdGl2ZSA9IG9wdGlvbnMuYWRhcHRpdmUsXG4gICAgICBhZGFwdGl2ZSA9IF9vcHRpb25zJGFkYXB0aXZlID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkYWRhcHRpdmUsXG4gICAgICBfb3B0aW9ucyRyb3VuZE9mZnNldHMgPSBvcHRpb25zLnJvdW5kT2Zmc2V0cyxcbiAgICAgIHJvdW5kT2Zmc2V0cyA9IF9vcHRpb25zJHJvdW5kT2Zmc2V0cyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHJvdW5kT2Zmc2V0cztcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgdmFyIHRyYW5zaXRpb25Qcm9wZXJ0eSA9IGdldENvbXB1dGVkU3R5bGUoc3RhdGUuZWxlbWVudHMucG9wcGVyKS50cmFuc2l0aW9uUHJvcGVydHkgfHwgJyc7XG5cbiAgICBpZiAoYWRhcHRpdmUgJiYgWyd0cmFuc2Zvcm0nLCAndG9wJywgJ3JpZ2h0JywgJ2JvdHRvbScsICdsZWZ0J10uc29tZShmdW5jdGlvbiAocHJvcGVydHkpIHtcbiAgICAgIHJldHVybiB0cmFuc2l0aW9uUHJvcGVydHkuaW5kZXhPZihwcm9wZXJ0eSkgPj0gMDtcbiAgICB9KSkge1xuICAgICAgY29uc29sZS53YXJuKFsnUG9wcGVyOiBEZXRlY3RlZCBDU1MgdHJhbnNpdGlvbnMgb24gYXQgbGVhc3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcnLCAnQ1NTIHByb3BlcnRpZXM6IFwidHJhbnNmb3JtXCIsIFwidG9wXCIsIFwicmlnaHRcIiwgXCJib3R0b21cIiwgXCJsZWZ0XCIuJywgJ1xcblxcbicsICdEaXNhYmxlIHRoZSBcImNvbXB1dGVTdHlsZXNcIiBtb2RpZmllclxcJ3MgYGFkYXB0aXZlYCBvcHRpb24gdG8gYWxsb3cnLCAnZm9yIHNtb290aCB0cmFuc2l0aW9ucywgb3IgcmVtb3ZlIHRoZXNlIHByb3BlcnRpZXMgZnJvbSB0aGUgQ1NTJywgJ3RyYW5zaXRpb24gZGVjbGFyYXRpb24gb24gdGhlIHBvcHBlciBlbGVtZW50IGlmIG9ubHkgdHJhbnNpdGlvbmluZycsICdvcGFjaXR5IG9yIGJhY2tncm91bmQtY29sb3IgZm9yIGV4YW1wbGUuJywgJ1xcblxcbicsICdXZSByZWNvbW1lbmQgdXNpbmcgdGhlIHBvcHBlciBlbGVtZW50IGFzIGEgd3JhcHBlciBhcm91bmQgYW4gaW5uZXInLCAnZWxlbWVudCB0aGF0IGNhbiBoYXZlIGFueSBDU1MgcHJvcGVydHkgdHJhbnNpdGlvbmVkIGZvciBhbmltYXRpb25zLiddLmpvaW4oJyAnKSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGNvbW1vblN0eWxlcyA9IHtcbiAgICBwbGFjZW1lbnQ6IGdldEJhc2VQbGFjZW1lbnQoc3RhdGUucGxhY2VtZW50KSxcbiAgICB2YXJpYXRpb246IGdldFZhcmlhdGlvbihzdGF0ZS5wbGFjZW1lbnQpLFxuICAgIHBvcHBlcjogc3RhdGUuZWxlbWVudHMucG9wcGVyLFxuICAgIHBvcHBlclJlY3Q6IHN0YXRlLnJlY3RzLnBvcHBlcixcbiAgICBncHVBY2NlbGVyYXRpb246IGdwdUFjY2VsZXJhdGlvbixcbiAgICBpc0ZpeGVkOiBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5ID09PSAnZml4ZWQnXG4gIH07XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyAhPSBudWxsKSB7XG4gICAgc3RhdGUuc3R5bGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnN0eWxlcy5wb3BwZXIsIG1hcFRvU3R5bGVzKE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywge1xuICAgICAgb2Zmc2V0czogc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLFxuICAgICAgcG9zaXRpb246IHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3ksXG4gICAgICBhZGFwdGl2ZTogYWRhcHRpdmUsXG4gICAgICByb3VuZE9mZnNldHM6IHJvdW5kT2Zmc2V0c1xuICAgIH0pKSk7XG4gIH1cblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YS5hcnJvdyAhPSBudWxsKSB7XG4gICAgc3RhdGUuc3R5bGVzLmFycm93ID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuc3R5bGVzLmFycm93LCBtYXBUb1N0eWxlcyhPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIHtcbiAgICAgIG9mZnNldHM6IHN0YXRlLm1vZGlmaWVyc0RhdGEuYXJyb3csXG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIGFkYXB0aXZlOiBmYWxzZSxcbiAgICAgIHJvdW5kT2Zmc2V0czogcm91bmRPZmZzZXRzXG4gICAgfSkpKTtcbiAgfVxuXG4gIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIsIHtcbiAgICAnZGF0YS1wb3BwZXItcGxhY2VtZW50Jzogc3RhdGUucGxhY2VtZW50XG4gIH0pO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnY29tcHV0ZVN0eWxlcycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnYmVmb3JlV3JpdGUnLFxuICBmbjogY29tcHV0ZVN0eWxlcyxcbiAgZGF0YToge31cbn07IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRXaW5kb3cuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG52YXIgcGFzc2l2ZSA9IHtcbiAgcGFzc2l2ZTogdHJ1ZVxufTtcblxuZnVuY3Rpb24gZWZmZWN0KF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIGluc3RhbmNlID0gX3JlZi5pbnN0YW5jZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnM7XG4gIHZhciBfb3B0aW9ucyRzY3JvbGwgPSBvcHRpb25zLnNjcm9sbCxcbiAgICAgIHNjcm9sbCA9IF9vcHRpb25zJHNjcm9sbCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHNjcm9sbCxcbiAgICAgIF9vcHRpb25zJHJlc2l6ZSA9IG9wdGlvbnMucmVzaXplLFxuICAgICAgcmVzaXplID0gX29wdGlvbnMkcmVzaXplID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkcmVzaXplO1xuICB2YXIgd2luZG93ID0gZ2V0V2luZG93KHN0YXRlLmVsZW1lbnRzLnBvcHBlcik7XG4gIHZhciBzY3JvbGxQYXJlbnRzID0gW10uY29uY2F0KHN0YXRlLnNjcm9sbFBhcmVudHMucmVmZXJlbmNlLCBzdGF0ZS5zY3JvbGxQYXJlbnRzLnBvcHBlcik7XG5cbiAgaWYgKHNjcm9sbCkge1xuICAgIHNjcm9sbFBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAoc2Nyb2xsUGFyZW50KSB7XG4gICAgICBzY3JvbGxQYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChyZXNpemUpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHNjcm9sbCkge1xuICAgICAgc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzY3JvbGxQYXJlbnQpIHtcbiAgICAgICAgc2Nyb2xsUGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAocmVzaXplKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICB9XG4gIH07XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdldmVudExpc3RlbmVycycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnd3JpdGUnLFxuICBmbjogZnVuY3Rpb24gZm4oKSB7fSxcbiAgZWZmZWN0OiBlZmZlY3QsXG4gIGRhdGE6IHt9XG59OyIsICJ2YXIgaGFzaCA9IHtcbiAgbGVmdDogJ3JpZ2h0JyxcbiAgcmlnaHQ6ICdsZWZ0JyxcbiAgYm90dG9tOiAndG9wJyxcbiAgdG9wOiAnYm90dG9tJ1xufTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE9wcG9zaXRlUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnJlcGxhY2UoL2xlZnR8cmlnaHR8Ym90dG9tfHRvcC9nLCBmdW5jdGlvbiAobWF0Y2hlZCkge1xuICAgIHJldHVybiBoYXNoW21hdGNoZWRdO1xuICB9KTtcbn0iLCAidmFyIGhhc2ggPSB7XG4gIHN0YXJ0OiAnZW5kJyxcbiAgZW5kOiAnc3RhcnQnXG59O1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQucmVwbGFjZSgvc3RhcnR8ZW5kL2csIGZ1bmN0aW9uIChtYXRjaGVkKSB7XG4gICAgcmV0dXJuIGhhc2hbbWF0Y2hlZF07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0V2luZG93U2Nyb2xsKG5vZGUpIHtcbiAgdmFyIHdpbiA9IGdldFdpbmRvdyhub2RlKTtcbiAgdmFyIHNjcm9sbExlZnQgPSB3aW4ucGFnZVhPZmZzZXQ7XG4gIHZhciBzY3JvbGxUb3AgPSB3aW4ucGFnZVlPZmZzZXQ7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogc2Nyb2xsTGVmdCxcbiAgICBzY3JvbGxUb3A6IHNjcm9sbFRvcFxuICB9O1xufSIsICJpbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpIHtcbiAgLy8gSWYgPGh0bWw+IGhhcyBhIENTUyB3aWR0aCBncmVhdGVyIHRoYW4gdGhlIHZpZXdwb3J0LCB0aGVuIHRoaXMgd2lsbCBiZVxuICAvLyBpbmNvcnJlY3QgZm9yIFJUTC5cbiAgLy8gUG9wcGVyIDEgaXMgYnJva2VuIGluIHRoaXMgY2FzZSBhbmQgbmV2ZXIgaGFkIGEgYnVnIHJlcG9ydCBzbyBsZXQncyBhc3N1bWVcbiAgLy8gaXQncyBub3QgYW4gaXNzdWUuIEkgZG9uJ3QgdGhpbmsgYW55b25lIGV2ZXIgc3BlY2lmaWVzIHdpZHRoIG9uIDxodG1sPlxuICAvLyBhbnl3YXkuXG4gIC8vIEJyb3dzZXJzIHdoZXJlIHRoZSBsZWZ0IHNjcm9sbGJhciBkb2Vzbid0IGNhdXNlIGFuIGlzc3VlIHJlcG9ydCBgMGAgZm9yXG4gIC8vIHRoaXMgKGUuZy4gRWRnZSAyMDE5LCBJRTExLCBTYWZhcmkpXG4gIHJldHVybiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpKS5sZWZ0ICsgZ2V0V2luZG93U2Nyb2xsKGVsZW1lbnQpLnNjcm9sbExlZnQ7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbEJhclggZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsQmFyWC5qc1wiO1xuaW1wb3J0IGlzTGF5b3V0Vmlld3BvcnQgZnJvbSBcIi4vaXNMYXlvdXRWaWV3cG9ydC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQsIHN0cmF0ZWd5KSB7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3coZWxlbWVudCk7XG4gIHZhciBodG1sID0gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpO1xuICB2YXIgdmlzdWFsVmlld3BvcnQgPSB3aW4udmlzdWFsVmlld3BvcnQ7XG4gIHZhciB3aWR0aCA9IGh0bWwuY2xpZW50V2lkdGg7XG4gIHZhciBoZWlnaHQgPSBodG1sLmNsaWVudEhlaWdodDtcbiAgdmFyIHggPSAwO1xuICB2YXIgeSA9IDA7XG5cbiAgaWYgKHZpc3VhbFZpZXdwb3J0KSB7XG4gICAgd2lkdGggPSB2aXN1YWxWaWV3cG9ydC53aWR0aDtcbiAgICBoZWlnaHQgPSB2aXN1YWxWaWV3cG9ydC5oZWlnaHQ7XG4gICAgdmFyIGxheW91dFZpZXdwb3J0ID0gaXNMYXlvdXRWaWV3cG9ydCgpO1xuXG4gICAgaWYgKGxheW91dFZpZXdwb3J0IHx8ICFsYXlvdXRWaWV3cG9ydCAmJiBzdHJhdGVneSA9PT0gJ2ZpeGVkJykge1xuICAgICAgeCA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldExlZnQ7XG4gICAgICB5ID0gdmlzdWFsVmlld3BvcnQub2Zmc2V0VG9wO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHg6IHggKyBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpLFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGxCYXJYIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbEJhclguanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5pbXBvcnQgeyBtYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiOyAvLyBHZXRzIHRoZSBlbnRpcmUgc2l6ZSBvZiB0aGUgc2Nyb2xsYWJsZSBkb2N1bWVudCBhcmVhLCBldmVuIGV4dGVuZGluZyBvdXRzaWRlXG4vLyBvZiB0aGUgYDxodG1sPmAgYW5kIGA8Ym9keT5gIHJlY3QgYm91bmRzIGlmIGhvcml6b250YWxseSBzY3JvbGxhYmxlXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldERvY3VtZW50UmVjdChlbGVtZW50KSB7XG4gIHZhciBfZWxlbWVudCRvd25lckRvY3VtZW47XG5cbiAgdmFyIGh0bWwgPSBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCk7XG4gIHZhciB3aW5TY3JvbGwgPSBnZXRXaW5kb3dTY3JvbGwoZWxlbWVudCk7XG4gIHZhciBib2R5ID0gKF9lbGVtZW50JG93bmVyRG9jdW1lbiA9IGVsZW1lbnQub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9lbGVtZW50JG93bmVyRG9jdW1lbi5ib2R5O1xuICB2YXIgd2lkdGggPSBtYXgoaHRtbC5zY3JvbGxXaWR0aCwgaHRtbC5jbGllbnRXaWR0aCwgYm9keSA/IGJvZHkuc2Nyb2xsV2lkdGggOiAwLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApO1xuICB2YXIgaGVpZ2h0ID0gbWF4KGh0bWwuc2Nyb2xsSGVpZ2h0LCBodG1sLmNsaWVudEhlaWdodCwgYm9keSA/IGJvZHkuc2Nyb2xsSGVpZ2h0IDogMCwgYm9keSA/IGJvZHkuY2xpZW50SGVpZ2h0IDogMCk7XG4gIHZhciB4ID0gLXdpblNjcm9sbC5zY3JvbGxMZWZ0ICsgZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KTtcbiAgdmFyIHkgPSAtd2luU2Nyb2xsLnNjcm9sbFRvcDtcblxuICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShib2R5IHx8IGh0bWwpLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICB4ICs9IG1heChodG1sLmNsaWVudFdpZHRoLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApIC0gd2lkdGg7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNTY3JvbGxQYXJlbnQoZWxlbWVudCkge1xuICAvLyBGaXJlZm94IHdhbnRzIHVzIHRvIGNoZWNrIGAteGAgYW5kIGAteWAgdmFyaWF0aW9ucyBhcyB3ZWxsXG4gIHZhciBfZ2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCksXG4gICAgICBvdmVyZmxvdyA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93LFxuICAgICAgb3ZlcmZsb3dYID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dYLFxuICAgICAgb3ZlcmZsb3dZID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dZO1xuXG4gIHJldHVybiAvYXV0b3xzY3JvbGx8b3ZlcmxheXxoaWRkZW4vLnRlc3Qob3ZlcmZsb3cgKyBvdmVyZmxvd1kgKyBvdmVyZmxvd1gpO1xufSIsICJpbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgaXNTY3JvbGxQYXJlbnQgZnJvbSBcIi4vaXNTY3JvbGxQYXJlbnQuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFNjcm9sbFBhcmVudChub2RlKSB7XG4gIGlmIChbJ2h0bWwnLCAnYm9keScsICcjZG9jdW1lbnQnXS5pbmRleE9mKGdldE5vZGVOYW1lKG5vZGUpKSA+PSAwKSB7XG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogYXNzdW1lIGJvZHkgaXMgYWx3YXlzIGF2YWlsYWJsZVxuICAgIHJldHVybiBub2RlLm93bmVyRG9jdW1lbnQuYm9keTtcbiAgfVxuXG4gIGlmIChpc0hUTUxFbGVtZW50KG5vZGUpICYmIGlzU2Nyb2xsUGFyZW50KG5vZGUpKSB7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICByZXR1cm4gZ2V0U2Nyb2xsUGFyZW50KGdldFBhcmVudE5vZGUobm9kZSkpO1xufSIsICJpbXBvcnQgZ2V0U2Nyb2xsUGFyZW50IGZyb20gXCIuL2dldFNjcm9sbFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBpc1Njcm9sbFBhcmVudCBmcm9tIFwiLi9pc1Njcm9sbFBhcmVudC5qc1wiO1xuLypcbmdpdmVuIGEgRE9NIGVsZW1lbnQsIHJldHVybiB0aGUgbGlzdCBvZiBhbGwgc2Nyb2xsIHBhcmVudHMsIHVwIHRoZSBsaXN0IG9mIGFuY2Vzb3JzXG51bnRpbCB3ZSBnZXQgdG8gdGhlIHRvcCB3aW5kb3cgb2JqZWN0LiBUaGlzIGxpc3QgaXMgd2hhdCB3ZSBhdHRhY2ggc2Nyb2xsIGxpc3RlbmVyc1xudG8sIGJlY2F1c2UgaWYgYW55IG9mIHRoZXNlIHBhcmVudCBlbGVtZW50cyBzY3JvbGwsIHdlJ2xsIG5lZWQgdG8gcmUtY2FsY3VsYXRlIHRoZVxucmVmZXJlbmNlIGVsZW1lbnQncyBwb3NpdGlvbi5cbiovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxpc3RTY3JvbGxQYXJlbnRzKGVsZW1lbnQsIGxpc3QpIHtcbiAgdmFyIF9lbGVtZW50JG93bmVyRG9jdW1lbjtcblxuICBpZiAobGlzdCA9PT0gdm9pZCAwKSB7XG4gICAgbGlzdCA9IFtdO1xuICB9XG5cbiAgdmFyIHNjcm9sbFBhcmVudCA9IGdldFNjcm9sbFBhcmVudChlbGVtZW50KTtcbiAgdmFyIGlzQm9keSA9IHNjcm9sbFBhcmVudCA9PT0gKChfZWxlbWVudCRvd25lckRvY3VtZW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfZWxlbWVudCRvd25lckRvY3VtZW4uYm9keSk7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3coc2Nyb2xsUGFyZW50KTtcbiAgdmFyIHRhcmdldCA9IGlzQm9keSA/IFt3aW5dLmNvbmNhdCh3aW4udmlzdWFsVmlld3BvcnQgfHwgW10sIGlzU2Nyb2xsUGFyZW50KHNjcm9sbFBhcmVudCkgPyBzY3JvbGxQYXJlbnQgOiBbXSkgOiBzY3JvbGxQYXJlbnQ7XG4gIHZhciB1cGRhdGVkTGlzdCA9IGxpc3QuY29uY2F0KHRhcmdldCk7XG4gIHJldHVybiBpc0JvZHkgPyB1cGRhdGVkTGlzdCA6IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdOiBpc0JvZHkgdGVsbHMgdXMgdGFyZ2V0IHdpbGwgYmUgYW4gSFRNTEVsZW1lbnQgaGVyZVxuICB1cGRhdGVkTGlzdC5jb25jYXQobGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZSh0YXJnZXQpKSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlY3RUb0NsaWVudFJlY3QocmVjdCkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgcmVjdCwge1xuICAgIGxlZnQ6IHJlY3QueCxcbiAgICB0b3A6IHJlY3QueSxcbiAgICByaWdodDogcmVjdC54ICsgcmVjdC53aWR0aCxcbiAgICBib3R0b206IHJlY3QueSArIHJlY3QuaGVpZ2h0XG4gIH0pO1xufSIsICJpbXBvcnQgeyB2aWV3cG9ydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZpZXdwb3J0UmVjdCBmcm9tIFwiLi9nZXRWaWV3cG9ydFJlY3QuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudFJlY3QgZnJvbSBcIi4vZ2V0RG9jdW1lbnRSZWN0LmpzXCI7XG5pbXBvcnQgbGlzdFNjcm9sbFBhcmVudHMgZnJvbSBcIi4vbGlzdFNjcm9sbFBhcmVudHMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4vZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBjb250YWlucyBmcm9tIFwiLi9jb250YWlucy5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgcmVjdFRvQ2xpZW50UmVjdCBmcm9tIFwiLi4vdXRpbHMvcmVjdFRvQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IHsgbWF4LCBtaW4gfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBnZXRJbm5lckJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50LCBzdHJhdGVneSkge1xuICB2YXIgcmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50LCBmYWxzZSwgc3RyYXRlZ3kgPT09ICdmaXhlZCcpO1xuICByZWN0LnRvcCA9IHJlY3QudG9wICsgZWxlbWVudC5jbGllbnRUb3A7XG4gIHJlY3QubGVmdCA9IHJlY3QubGVmdCArIGVsZW1lbnQuY2xpZW50TGVmdDtcbiAgcmVjdC5ib3R0b20gPSByZWN0LnRvcCArIGVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICByZWN0LnJpZ2h0ID0gcmVjdC5sZWZ0ICsgZWxlbWVudC5jbGllbnRXaWR0aDtcbiAgcmVjdC53aWR0aCA9IGVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIHJlY3QuaGVpZ2h0ID0gZWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gIHJlY3QueCA9IHJlY3QubGVmdDtcbiAgcmVjdC55ID0gcmVjdC50b3A7XG4gIHJldHVybiByZWN0O1xufVxuXG5mdW5jdGlvbiBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBjbGlwcGluZ1BhcmVudCwgc3RyYXRlZ3kpIHtcbiAgcmV0dXJuIGNsaXBwaW5nUGFyZW50ID09PSB2aWV3cG9ydCA/IHJlY3RUb0NsaWVudFJlY3QoZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQsIHN0cmF0ZWd5KSkgOiBpc0VsZW1lbnQoY2xpcHBpbmdQYXJlbnQpID8gZ2V0SW5uZXJCb3VuZGluZ0NsaWVudFJlY3QoY2xpcHBpbmdQYXJlbnQsIHN0cmF0ZWd5KSA6IHJlY3RUb0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRSZWN0KGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSkpO1xufSAvLyBBIFwiY2xpcHBpbmcgcGFyZW50XCIgaXMgYW4gb3ZlcmZsb3dhYmxlIGNvbnRhaW5lciB3aXRoIHRoZSBjaGFyYWN0ZXJpc3RpYyBvZlxuLy8gY2xpcHBpbmcgKG9yIGhpZGluZykgb3ZlcmZsb3dpbmcgZWxlbWVudHMgd2l0aCBhIHBvc2l0aW9uIGRpZmZlcmVudCBmcm9tXG4vLyBgaW5pdGlhbGBcblxuXG5mdW5jdGlvbiBnZXRDbGlwcGluZ1BhcmVudHMoZWxlbWVudCkge1xuICB2YXIgY2xpcHBpbmdQYXJlbnRzID0gbGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZShlbGVtZW50KSk7XG4gIHZhciBjYW5Fc2NhcGVDbGlwcGluZyA9IFsnYWJzb2x1dGUnLCAnZml4ZWQnXS5pbmRleE9mKGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkucG9zaXRpb24pID49IDA7XG4gIHZhciBjbGlwcGVyRWxlbWVudCA9IGNhbkVzY2FwZUNsaXBwaW5nICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkgPyBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCkgOiBlbGVtZW50O1xuXG4gIGlmICghaXNFbGVtZW50KGNsaXBwZXJFbGVtZW50KSkge1xuICAgIHJldHVybiBbXTtcbiAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svZmxvdy9pc3N1ZXMvMTQxNFxuXG5cbiAgcmV0dXJuIGNsaXBwaW5nUGFyZW50cy5maWx0ZXIoZnVuY3Rpb24gKGNsaXBwaW5nUGFyZW50KSB7XG4gICAgcmV0dXJuIGlzRWxlbWVudChjbGlwcGluZ1BhcmVudCkgJiYgY29udGFpbnMoY2xpcHBpbmdQYXJlbnQsIGNsaXBwZXJFbGVtZW50KSAmJiBnZXROb2RlTmFtZShjbGlwcGluZ1BhcmVudCkgIT09ICdib2R5JztcbiAgfSk7XG59IC8vIEdldHMgdGhlIG1heGltdW0gYXJlYSB0aGF0IHRoZSBlbGVtZW50IGlzIHZpc2libGUgaW4gZHVlIHRvIGFueSBudW1iZXIgb2Zcbi8vIGNsaXBwaW5nIHBhcmVudHNcblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDbGlwcGluZ1JlY3QoZWxlbWVudCwgYm91bmRhcnksIHJvb3RCb3VuZGFyeSwgc3RyYXRlZ3kpIHtcbiAgdmFyIG1haW5DbGlwcGluZ1BhcmVudHMgPSBib3VuZGFyeSA9PT0gJ2NsaXBwaW5nUGFyZW50cycgPyBnZXRDbGlwcGluZ1BhcmVudHMoZWxlbWVudCkgOiBbXS5jb25jYXQoYm91bmRhcnkpO1xuICB2YXIgY2xpcHBpbmdQYXJlbnRzID0gW10uY29uY2F0KG1haW5DbGlwcGluZ1BhcmVudHMsIFtyb290Qm91bmRhcnldKTtcbiAgdmFyIGZpcnN0Q2xpcHBpbmdQYXJlbnQgPSBjbGlwcGluZ1BhcmVudHNbMF07XG4gIHZhciBjbGlwcGluZ1JlY3QgPSBjbGlwcGluZ1BhcmVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2NSZWN0LCBjbGlwcGluZ1BhcmVudCkge1xuICAgIHZhciByZWN0ID0gZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgY2xpcHBpbmdQYXJlbnQsIHN0cmF0ZWd5KTtcbiAgICBhY2NSZWN0LnRvcCA9IG1heChyZWN0LnRvcCwgYWNjUmVjdC50b3ApO1xuICAgIGFjY1JlY3QucmlnaHQgPSBtaW4ocmVjdC5yaWdodCwgYWNjUmVjdC5yaWdodCk7XG4gICAgYWNjUmVjdC5ib3R0b20gPSBtaW4ocmVjdC5ib3R0b20sIGFjY1JlY3QuYm90dG9tKTtcbiAgICBhY2NSZWN0LmxlZnQgPSBtYXgocmVjdC5sZWZ0LCBhY2NSZWN0LmxlZnQpO1xuICAgIHJldHVybiBhY2NSZWN0O1xuICB9LCBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBmaXJzdENsaXBwaW5nUGFyZW50LCBzdHJhdGVneSkpO1xuICBjbGlwcGluZ1JlY3Qud2lkdGggPSBjbGlwcGluZ1JlY3QucmlnaHQgLSBjbGlwcGluZ1JlY3QubGVmdDtcbiAgY2xpcHBpbmdSZWN0LmhlaWdodCA9IGNsaXBwaW5nUmVjdC5ib3R0b20gLSBjbGlwcGluZ1JlY3QudG9wO1xuICBjbGlwcGluZ1JlY3QueCA9IGNsaXBwaW5nUmVjdC5sZWZ0O1xuICBjbGlwcGluZ1JlY3QueSA9IGNsaXBwaW5nUmVjdC50b3A7XG4gIHJldHVybiBjbGlwcGluZ1JlY3Q7XG59IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0LCBzdGFydCwgZW5kIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb21wdXRlT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciByZWZlcmVuY2UgPSBfcmVmLnJlZmVyZW5jZSxcbiAgICAgIGVsZW1lbnQgPSBfcmVmLmVsZW1lbnQsXG4gICAgICBwbGFjZW1lbnQgPSBfcmVmLnBsYWNlbWVudDtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBwbGFjZW1lbnQgPyBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgdmFyaWF0aW9uID0gcGxhY2VtZW50ID8gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgY29tbW9uWCA9IHJlZmVyZW5jZS54ICsgcmVmZXJlbmNlLndpZHRoIC8gMiAtIGVsZW1lbnQud2lkdGggLyAyO1xuICB2YXIgY29tbW9uWSA9IHJlZmVyZW5jZS55ICsgcmVmZXJlbmNlLmhlaWdodCAvIDIgLSBlbGVtZW50LmhlaWdodCAvIDI7XG4gIHZhciBvZmZzZXRzO1xuXG4gIHN3aXRjaCAoYmFzZVBsYWNlbWVudCkge1xuICAgIGNhc2UgdG9wOlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogY29tbW9uWCxcbiAgICAgICAgeTogcmVmZXJlbmNlLnkgLSBlbGVtZW50LmhlaWdodFxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBib3R0b206XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiBjb21tb25YLFxuICAgICAgICB5OiByZWZlcmVuY2UueSArIHJlZmVyZW5jZS5oZWlnaHRcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgcmlnaHQ6XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiByZWZlcmVuY2UueCArIHJlZmVyZW5jZS53aWR0aCxcbiAgICAgICAgeTogY29tbW9uWVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBsZWZ0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLnggLSBlbGVtZW50LndpZHRoLFxuICAgICAgICB5OiBjb21tb25ZXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLngsXG4gICAgICAgIHk6IHJlZmVyZW5jZS55XG4gICAgICB9O1xuICB9XG5cbiAgdmFyIG1haW5BeGlzID0gYmFzZVBsYWNlbWVudCA/IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KSA6IG51bGw7XG5cbiAgaWYgKG1haW5BeGlzICE9IG51bGwpIHtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgIHN3aXRjaCAodmFyaWF0aW9uKSB7XG4gICAgICBjYXNlIHN0YXJ0OlxuICAgICAgICBvZmZzZXRzW21haW5BeGlzXSA9IG9mZnNldHNbbWFpbkF4aXNdIC0gKHJlZmVyZW5jZVtsZW5dIC8gMiAtIGVsZW1lbnRbbGVuXSAvIDIpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBlbmQ6XG4gICAgICAgIG9mZnNldHNbbWFpbkF4aXNdID0gb2Zmc2V0c1ttYWluQXhpc10gKyAocmVmZXJlbmNlW2xlbl0gLyAyIC0gZWxlbWVudFtsZW5dIC8gMik7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvZmZzZXRzO1xufSIsICJpbXBvcnQgZ2V0Q2xpcHBpbmdSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgY29tcHV0ZU9mZnNldHMgZnJvbSBcIi4vY29tcHV0ZU9mZnNldHMuanNcIjtcbmltcG9ydCByZWN0VG9DbGllbnRSZWN0IGZyb20gXCIuL3JlY3RUb0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCB7IGNsaXBwaW5nUGFyZW50cywgcmVmZXJlbmNlLCBwb3BwZXIsIGJvdHRvbSwgdG9wLCByaWdodCwgYmFzZVBsYWNlbWVudHMsIHZpZXdwb3J0IH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBtZXJnZVBhZGRpbmdPYmplY3QgZnJvbSBcIi4vbWVyZ2VQYWRkaW5nT2JqZWN0LmpzXCI7XG5pbXBvcnQgZXhwYW5kVG9IYXNoTWFwIGZyb20gXCIuL2V4cGFuZFRvSGFzaE1hcC5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRldGVjdE92ZXJmbG93KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgX29wdGlvbnMkcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMkcGxhY2VtZW50ID09PSB2b2lkIDAgPyBzdGF0ZS5wbGFjZW1lbnQgOiBfb3B0aW9ucyRwbGFjZW1lbnQsXG4gICAgICBfb3B0aW9ucyRzdHJhdGVneSA9IF9vcHRpb25zLnN0cmF0ZWd5LFxuICAgICAgc3RyYXRlZ3kgPSBfb3B0aW9ucyRzdHJhdGVneSA9PT0gdm9pZCAwID8gc3RhdGUuc3RyYXRlZ3kgOiBfb3B0aW9ucyRzdHJhdGVneSxcbiAgICAgIF9vcHRpb25zJGJvdW5kYXJ5ID0gX29wdGlvbnMuYm91bmRhcnksXG4gICAgICBib3VuZGFyeSA9IF9vcHRpb25zJGJvdW5kYXJ5ID09PSB2b2lkIDAgPyBjbGlwcGluZ1BhcmVudHMgOiBfb3B0aW9ucyRib3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zJHJvb3RCb3VuZGFyeSA9PT0gdm9pZCAwID8gdmlld3BvcnQgOiBfb3B0aW9ucyRyb290Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRlbGVtZW50Q29udGUgPSBfb3B0aW9ucy5lbGVtZW50Q29udGV4dCxcbiAgICAgIGVsZW1lbnRDb250ZXh0ID0gX29wdGlvbnMkZWxlbWVudENvbnRlID09PSB2b2lkIDAgPyBwb3BwZXIgOiBfb3B0aW9ucyRlbGVtZW50Q29udGUsXG4gICAgICBfb3B0aW9ucyRhbHRCb3VuZGFyeSA9IF9vcHRpb25zLmFsdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnkgPSBfb3B0aW9ucyRhbHRCb3VuZGFyeSA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRhbHRCb3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJHBhZGRpbmcgPSBfb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgcGFkZGluZyA9IF9vcHRpb25zJHBhZGRpbmcgPT09IHZvaWQgMCA/IDAgOiBfb3B0aW9ucyRwYWRkaW5nO1xuICB2YXIgcGFkZGluZ09iamVjdCA9IG1lcmdlUGFkZGluZ09iamVjdCh0eXBlb2YgcGFkZGluZyAhPT0gJ251bWJlcicgPyBwYWRkaW5nIDogZXhwYW5kVG9IYXNoTWFwKHBhZGRpbmcsIGJhc2VQbGFjZW1lbnRzKSk7XG4gIHZhciBhbHRDb250ZXh0ID0gZWxlbWVudENvbnRleHQgPT09IHBvcHBlciA/IHJlZmVyZW5jZSA6IHBvcHBlcjtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBlbGVtZW50ID0gc3RhdGUuZWxlbWVudHNbYWx0Qm91bmRhcnkgPyBhbHRDb250ZXh0IDogZWxlbWVudENvbnRleHRdO1xuICB2YXIgY2xpcHBpbmdDbGllbnRSZWN0ID0gZ2V0Q2xpcHBpbmdSZWN0KGlzRWxlbWVudChlbGVtZW50KSA/IGVsZW1lbnQgOiBlbGVtZW50LmNvbnRleHRFbGVtZW50IHx8IGdldERvY3VtZW50RWxlbWVudChzdGF0ZS5lbGVtZW50cy5wb3BwZXIpLCBib3VuZGFyeSwgcm9vdEJvdW5kYXJ5LCBzdHJhdGVneSk7XG4gIHZhciByZWZlcmVuY2VDbGllbnRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KHN0YXRlLmVsZW1lbnRzLnJlZmVyZW5jZSk7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gY29tcHV0ZU9mZnNldHMoe1xuICAgIHJlZmVyZW5jZTogcmVmZXJlbmNlQ2xpZW50UmVjdCxcbiAgICBlbGVtZW50OiBwb3BwZXJSZWN0LFxuICAgIHN0cmF0ZWd5OiAnYWJzb2x1dGUnLFxuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pO1xuICB2YXIgcG9wcGVyQ2xpZW50UmVjdCA9IHJlY3RUb0NsaWVudFJlY3QoT2JqZWN0LmFzc2lnbih7fSwgcG9wcGVyUmVjdCwgcG9wcGVyT2Zmc2V0cykpO1xuICB2YXIgZWxlbWVudENsaWVudFJlY3QgPSBlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyID8gcG9wcGVyQ2xpZW50UmVjdCA6IHJlZmVyZW5jZUNsaWVudFJlY3Q7IC8vIHBvc2l0aXZlID0gb3ZlcmZsb3dpbmcgdGhlIGNsaXBwaW5nIHJlY3RcbiAgLy8gMCBvciBuZWdhdGl2ZSA9IHdpdGhpbiB0aGUgY2xpcHBpbmcgcmVjdFxuXG4gIHZhciBvdmVyZmxvd09mZnNldHMgPSB7XG4gICAgdG9wOiBjbGlwcGluZ0NsaWVudFJlY3QudG9wIC0gZWxlbWVudENsaWVudFJlY3QudG9wICsgcGFkZGluZ09iamVjdC50b3AsXG4gICAgYm90dG9tOiBlbGVtZW50Q2xpZW50UmVjdC5ib3R0b20gLSBjbGlwcGluZ0NsaWVudFJlY3QuYm90dG9tICsgcGFkZGluZ09iamVjdC5ib3R0b20sXG4gICAgbGVmdDogY2xpcHBpbmdDbGllbnRSZWN0LmxlZnQgLSBlbGVtZW50Q2xpZW50UmVjdC5sZWZ0ICsgcGFkZGluZ09iamVjdC5sZWZ0LFxuICAgIHJpZ2h0OiBlbGVtZW50Q2xpZW50UmVjdC5yaWdodCAtIGNsaXBwaW5nQ2xpZW50UmVjdC5yaWdodCArIHBhZGRpbmdPYmplY3QucmlnaHRcbiAgfTtcbiAgdmFyIG9mZnNldERhdGEgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldDsgLy8gT2Zmc2V0cyBjYW4gYmUgYXBwbGllZCBvbmx5IHRvIHRoZSBwb3BwZXIgZWxlbWVudFxuXG4gIGlmIChlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyICYmIG9mZnNldERhdGEpIHtcbiAgICB2YXIgb2Zmc2V0ID0gb2Zmc2V0RGF0YVtwbGFjZW1lbnRdO1xuICAgIE9iamVjdC5rZXlzKG92ZXJmbG93T2Zmc2V0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICB2YXIgbXVsdGlwbHkgPSBbcmlnaHQsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAxIDogLTE7XG4gICAgICB2YXIgYXhpcyA9IFt0b3AsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAneScgOiAneCc7XG4gICAgICBvdmVyZmxvd09mZnNldHNba2V5XSArPSBvZmZzZXRbYXhpc10gKiBtdWx0aXBseTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBvdmVyZmxvd09mZnNldHM7XG59IiwgImltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgeyB2YXJpYXRpb25QbGFjZW1lbnRzLCBiYXNlUGxhY2VtZW50cywgcGxhY2VtZW50cyBhcyBhbGxQbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4vZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbXB1dGVBdXRvUGxhY2VtZW50KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgYm91bmRhcnkgPSBfb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBfb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucy5mbGlwVmFyaWF0aW9ucyxcbiAgICAgIF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9IF9vcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cyxcbiAgICAgIGFsbG93ZWRBdXRvUGxhY2VtZW50cyA9IF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9PT0gdm9pZCAwID8gYWxsUGxhY2VtZW50cyA6IF9vcHRpb25zJGFsbG93ZWRBdXRvUDtcbiAgdmFyIHZhcmlhdGlvbiA9IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpO1xuICB2YXIgcGxhY2VtZW50cyA9IHZhcmlhdGlvbiA/IGZsaXBWYXJpYXRpb25zID8gdmFyaWF0aW9uUGxhY2VtZW50cyA6IHZhcmlhdGlvblBsYWNlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHZhcmlhdGlvbjtcbiAgfSkgOiBiYXNlUGxhY2VtZW50cztcbiAgdmFyIGFsbG93ZWRQbGFjZW1lbnRzID0gcGxhY2VtZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYWNlbWVudCkge1xuICAgIHJldHVybiBhbGxvd2VkQXV0b1BsYWNlbWVudHMuaW5kZXhPZihwbGFjZW1lbnQpID49IDA7XG4gIH0pO1xuXG4gIGlmIChhbGxvd2VkUGxhY2VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICBhbGxvd2VkUGxhY2VtZW50cyA9IHBsYWNlbWVudHM7XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBUaGUgYGFsbG93ZWRBdXRvUGxhY2VtZW50c2Agb3B0aW9uIGRpZCBub3QgYWxsb3cgYW55JywgJ3BsYWNlbWVudHMuIEVuc3VyZSB0aGUgYHBsYWNlbWVudGAgb3B0aW9uIG1hdGNoZXMgdGhlIHZhcmlhdGlvbicsICdvZiB0aGUgYWxsb3dlZCBwbGFjZW1lbnRzLicsICdGb3IgZXhhbXBsZSwgXCJhdXRvXCIgY2Fubm90IGJlIHVzZWQgdG8gYWxsb3cgXCJib3R0b20tc3RhcnRcIi4nLCAnVXNlIFwiYXV0by1zdGFydFwiIGluc3RlYWQuJ10uam9pbignICcpKTtcbiAgICB9XG4gIH0gLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtdHlwZV06IEZsb3cgc2VlbXMgdG8gaGF2ZSBwcm9ibGVtcyB3aXRoIHR3byBhcnJheSB1bmlvbnMuLi5cblxuXG4gIHZhciBvdmVyZmxvd3MgPSBhbGxvd2VkUGxhY2VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gICAgYWNjW3BsYWNlbWVudF0gPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICB9KVtnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCldO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG92ZXJmbG93cykuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBvdmVyZmxvd3NbYV0gLSBvdmVyZmxvd3NbYl07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0T3Bwb3NpdGVQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE9wcG9zaXRlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGNvbXB1dGVBdXRvUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9jb21wdXRlQXV0b1BsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgYm90dG9tLCB0b3AsIHN0YXJ0LCByaWdodCwgbGVmdCwgYXV0byB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZnVuY3Rpb24gZ2V0RXhwYW5kZWRGYWxsYmFja1BsYWNlbWVudHMocGxhY2VtZW50KSB7XG4gIGlmIChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICB2YXIgb3Bwb3NpdGVQbGFjZW1lbnQgPSBnZXRPcHBvc2l0ZVBsYWNlbWVudChwbGFjZW1lbnQpO1xuICByZXR1cm4gW2dldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50KHBsYWNlbWVudCksIG9wcG9zaXRlUGxhY2VtZW50LCBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChvcHBvc2l0ZVBsYWNlbWVudCldO1xufVxuXG5mdW5jdGlvbiBmbGlwKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnMsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdLl9za2lwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIF9vcHRpb25zJG1haW5BeGlzID0gb3B0aW9ucy5tYWluQXhpcyxcbiAgICAgIGNoZWNrTWFpbkF4aXMgPSBfb3B0aW9ucyRtYWluQXhpcyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJG1haW5BeGlzLFxuICAgICAgX29wdGlvbnMkYWx0QXhpcyA9IG9wdGlvbnMuYWx0QXhpcyxcbiAgICAgIGNoZWNrQWx0QXhpcyA9IF9vcHRpb25zJGFsdEF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRhbHRBeGlzLFxuICAgICAgc3BlY2lmaWVkRmFsbGJhY2tQbGFjZW1lbnRzID0gb3B0aW9ucy5mYWxsYmFja1BsYWNlbWVudHMsXG4gICAgICBwYWRkaW5nID0gb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgYm91bmRhcnkgPSBvcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeSA9IG9wdGlvbnMuYWx0Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPSBvcHRpb25zLmZsaXBWYXJpYXRpb25zLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRmbGlwVmFyaWF0aW8sXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHMgPSBvcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cztcbiAgdmFyIHByZWZlcnJlZFBsYWNlbWVudCA9IHN0YXRlLm9wdGlvbnMucGxhY2VtZW50O1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocHJlZmVycmVkUGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9IGJhc2VQbGFjZW1lbnQgPT09IHByZWZlcnJlZFBsYWNlbWVudDtcbiAgdmFyIGZhbGxiYWNrUGxhY2VtZW50cyA9IHNwZWNpZmllZEZhbGxiYWNrUGxhY2VtZW50cyB8fCAoaXNCYXNlUGxhY2VtZW50IHx8ICFmbGlwVmFyaWF0aW9ucyA/IFtnZXRPcHBvc2l0ZVBsYWNlbWVudChwcmVmZXJyZWRQbGFjZW1lbnQpXSA6IGdldEV4cGFuZGVkRmFsbGJhY2tQbGFjZW1lbnRzKHByZWZlcnJlZFBsYWNlbWVudCkpO1xuICB2YXIgcGxhY2VtZW50cyA9IFtwcmVmZXJyZWRQbGFjZW1lbnRdLmNvbmNhdChmYWxsYmFja1BsYWNlbWVudHMpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8gPyBjb21wdXRlQXV0b1BsYWNlbWVudChzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmcsXG4gICAgICBmbGlwVmFyaWF0aW9uczogZmxpcFZhcmlhdGlvbnMsXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHM6IGFsbG93ZWRBdXRvUGxhY2VtZW50c1xuICAgIH0pIDogcGxhY2VtZW50KTtcbiAgfSwgW10pO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBjaGVja3NNYXAgPSBuZXcgTWFwKCk7XG4gIHZhciBtYWtlRmFsbGJhY2tDaGVja3MgPSB0cnVlO1xuICB2YXIgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gcGxhY2VtZW50c1swXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBsYWNlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcGxhY2VtZW50ID0gcGxhY2VtZW50c1tpXTtcblxuICAgIHZhciBfYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcblxuICAgIHZhciBpc1N0YXJ0VmFyaWF0aW9uID0gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHN0YXJ0O1xuICAgIHZhciBpc1ZlcnRpY2FsID0gW3RvcCwgYm90dG9tXS5pbmRleE9mKF9iYXNlUGxhY2VtZW50KSA+PSAwO1xuICAgIHZhciBsZW4gPSBpc1ZlcnRpY2FsID8gJ3dpZHRoJyA6ICdoZWlnaHQnO1xuICAgIHZhciBvdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeTogcm9vdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnk6IGFsdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZzogcGFkZGluZ1xuICAgIH0pO1xuICAgIHZhciBtYWluVmFyaWF0aW9uU2lkZSA9IGlzVmVydGljYWwgPyBpc1N0YXJ0VmFyaWF0aW9uID8gcmlnaHQgOiBsZWZ0IDogaXNTdGFydFZhcmlhdGlvbiA/IGJvdHRvbSA6IHRvcDtcblxuICAgIGlmIChyZWZlcmVuY2VSZWN0W2xlbl0gPiBwb3BwZXJSZWN0W2xlbl0pIHtcbiAgICAgIG1haW5WYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIH1cblxuICAgIHZhciBhbHRWYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIHZhciBjaGVja3MgPSBbXTtcblxuICAgIGlmIChjaGVja01haW5BeGlzKSB7XG4gICAgICBjaGVja3MucHVzaChvdmVyZmxvd1tfYmFzZVBsYWNlbWVudF0gPD0gMCk7XG4gICAgfVxuXG4gICAgaWYgKGNoZWNrQWx0QXhpcykge1xuICAgICAgY2hlY2tzLnB1c2gob3ZlcmZsb3dbbWFpblZhcmlhdGlvblNpZGVdIDw9IDAsIG92ZXJmbG93W2FsdFZhcmlhdGlvblNpZGVdIDw9IDApO1xuICAgIH1cblxuICAgIGlmIChjaGVja3MuZXZlcnkoZnVuY3Rpb24gKGNoZWNrKSB7XG4gICAgICByZXR1cm4gY2hlY2s7XG4gICAgfSkpIHtcbiAgICAgIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudDtcbiAgICAgIG1ha2VGYWxsYmFja0NoZWNrcyA9IGZhbHNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY2hlY2tzTWFwLnNldChwbGFjZW1lbnQsIGNoZWNrcyk7XG4gIH1cblxuICBpZiAobWFrZUZhbGxiYWNrQ2hlY2tzKSB7XG4gICAgLy8gYDJgIG1heSBiZSBkZXNpcmVkIGluIHNvbWUgY2FzZXMgXHUyMDEzIHJlc2VhcmNoIGxhdGVyXG4gICAgdmFyIG51bWJlck9mQ2hlY2tzID0gZmxpcFZhcmlhdGlvbnMgPyAzIDogMTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKF9pKSB7XG4gICAgICB2YXIgZml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudHMuZmluZChmdW5jdGlvbiAocGxhY2VtZW50KSB7XG4gICAgICAgIHZhciBjaGVja3MgPSBjaGVja3NNYXAuZ2V0KHBsYWNlbWVudCk7XG5cbiAgICAgICAgaWYgKGNoZWNrcykge1xuICAgICAgICAgIHJldHVybiBjaGVja3Muc2xpY2UoMCwgX2kpLmV2ZXJ5KGZ1bmN0aW9uIChjaGVjaykge1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKGZpdHRpbmdQbGFjZW1lbnQpIHtcbiAgICAgICAgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gZml0dGluZ1BsYWNlbWVudDtcbiAgICAgICAgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZm9yICh2YXIgX2kgPSBudW1iZXJPZkNoZWNrczsgX2kgPiAwOyBfaS0tKSB7XG4gICAgICB2YXIgX3JldCA9IF9sb29wKF9pKTtcblxuICAgICAgaWYgKF9yZXQgPT09IFwiYnJlYWtcIikgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKHN0YXRlLnBsYWNlbWVudCAhPT0gZmlyc3RGaXR0aW5nUGxhY2VtZW50KSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXS5fc2tpcCA9IHRydWU7XG4gICAgc3RhdGUucGxhY2VtZW50ID0gZmlyc3RGaXR0aW5nUGxhY2VtZW50O1xuICAgIHN0YXRlLnJlc2V0ID0gdHJ1ZTtcbiAgfVxufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnZmxpcCcsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIGZuOiBmbGlwLFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddLFxuICBkYXRhOiB7XG4gICAgX3NraXA6IGZhbHNlXG4gIH1cbn07IiwgImltcG9ydCB7IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuXG5mdW5jdGlvbiBnZXRTaWRlT2Zmc2V0cyhvdmVyZmxvdywgcmVjdCwgcHJldmVudGVkT2Zmc2V0cykge1xuICBpZiAocHJldmVudGVkT2Zmc2V0cyA9PT0gdm9pZCAwKSB7XG4gICAgcHJldmVudGVkT2Zmc2V0cyA9IHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdG9wOiBvdmVyZmxvdy50b3AgLSByZWN0LmhlaWdodCAtIHByZXZlbnRlZE9mZnNldHMueSxcbiAgICByaWdodDogb3ZlcmZsb3cucmlnaHQgLSByZWN0LndpZHRoICsgcHJldmVudGVkT2Zmc2V0cy54LFxuICAgIGJvdHRvbTogb3ZlcmZsb3cuYm90dG9tIC0gcmVjdC5oZWlnaHQgKyBwcmV2ZW50ZWRPZmZzZXRzLnksXG4gICAgbGVmdDogb3ZlcmZsb3cubGVmdCAtIHJlY3Qud2lkdGggLSBwcmV2ZW50ZWRPZmZzZXRzLnhcbiAgfTtcbn1cblxuZnVuY3Rpb24gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKG92ZXJmbG93KSB7XG4gIHJldHVybiBbdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0XS5zb21lKGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgcmV0dXJuIG92ZXJmbG93W3NpZGVdID49IDA7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoaWRlKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHByZXZlbnRlZE9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnByZXZlbnRPdmVyZmxvdztcbiAgdmFyIHJlZmVyZW5jZU92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICBlbGVtZW50Q29udGV4dDogJ3JlZmVyZW5jZSdcbiAgfSk7XG4gIHZhciBwb3BwZXJBbHRPdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgYWx0Qm91bmRhcnk6IHRydWVcbiAgfSk7XG4gIHZhciByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMgPSBnZXRTaWRlT2Zmc2V0cyhyZWZlcmVuY2VPdmVyZmxvdywgcmVmZXJlbmNlUmVjdCk7XG4gIHZhciBwb3BwZXJFc2NhcGVPZmZzZXRzID0gZ2V0U2lkZU9mZnNldHMocG9wcGVyQWx0T3ZlcmZsb3csIHBvcHBlclJlY3QsIHByZXZlbnRlZE9mZnNldHMpO1xuICB2YXIgaXNSZWZlcmVuY2VIaWRkZW4gPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzKTtcbiAgdmFyIGhhc1BvcHBlckVzY2FwZWQgPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocG9wcGVyRXNjYXBlT2Zmc2V0cyk7XG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSB7XG4gICAgcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzOiByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMsXG4gICAgcG9wcGVyRXNjYXBlT2Zmc2V0czogcG9wcGVyRXNjYXBlT2Zmc2V0cyxcbiAgICBpc1JlZmVyZW5jZUhpZGRlbjogaXNSZWZlcmVuY2VIaWRkZW4sXG4gICAgaGFzUG9wcGVyRXNjYXBlZDogaGFzUG9wcGVyRXNjYXBlZFxuICB9O1xuICBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyLCB7XG4gICAgJ2RhdGEtcG9wcGVyLXJlZmVyZW5jZS1oaWRkZW4nOiBpc1JlZmVyZW5jZUhpZGRlbixcbiAgICAnZGF0YS1wb3BwZXItZXNjYXBlZCc6IGhhc1BvcHBlckVzY2FwZWRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdoaWRlJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydwcmV2ZW50T3ZlcmZsb3cnXSxcbiAgZm46IGhpZGVcbn07IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBwbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RhbmNlQW5kU2tpZGRpbmdUb1hZKHBsYWNlbWVudCwgcmVjdHMsIG9mZnNldCkge1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcbiAgdmFyIGludmVydERpc3RhbmNlID0gW2xlZnQsIHRvcF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwID8gLTEgOiAxO1xuXG4gIHZhciBfcmVmID0gdHlwZW9mIG9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IG9mZnNldChPYmplY3QuYXNzaWduKHt9LCByZWN0cywge1xuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pKSA6IG9mZnNldCxcbiAgICAgIHNraWRkaW5nID0gX3JlZlswXSxcbiAgICAgIGRpc3RhbmNlID0gX3JlZlsxXTtcblxuICBza2lkZGluZyA9IHNraWRkaW5nIHx8IDA7XG4gIGRpc3RhbmNlID0gKGRpc3RhbmNlIHx8IDApICogaW52ZXJ0RGlzdGFuY2U7XG4gIHJldHVybiBbbGVmdCwgcmlnaHRdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMCA/IHtcbiAgICB4OiBkaXN0YW5jZSxcbiAgICB5OiBza2lkZGluZ1xuICB9IDoge1xuICAgIHg6IHNraWRkaW5nLFxuICAgIHk6IGRpc3RhbmNlXG4gIH07XG59XG5cbmZ1bmN0aW9uIG9mZnNldChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmMi5vcHRpb25zLFxuICAgICAgbmFtZSA9IF9yZWYyLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRvZmZzZXQgPSBvcHRpb25zLm9mZnNldCxcbiAgICAgIG9mZnNldCA9IF9vcHRpb25zJG9mZnNldCA9PT0gdm9pZCAwID8gWzAsIDBdIDogX29wdGlvbnMkb2Zmc2V0O1xuICB2YXIgZGF0YSA9IHBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICAgIGFjY1twbGFjZW1lbnRdID0gZGlzdGFuY2VBbmRTa2lkZGluZ1RvWFkocGxhY2VtZW50LCBzdGF0ZS5yZWN0cywgb2Zmc2V0KTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHZhciBfZGF0YSRzdGF0ZSRwbGFjZW1lbnQgPSBkYXRhW3N0YXRlLnBsYWNlbWVudF0sXG4gICAgICB4ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50LngsXG4gICAgICB5ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50Lnk7XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyAhPSBudWxsKSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLnggKz0geDtcbiAgICBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMueSArPSB5O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdvZmZzZXQnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICByZXF1aXJlczogWydwb3BwZXJPZmZzZXRzJ10sXG4gIGZuOiBvZmZzZXRcbn07IiwgImltcG9ydCBjb21wdXRlT2Zmc2V0cyBmcm9tIFwiLi4vdXRpbHMvY29tcHV0ZU9mZnNldHMuanNcIjtcblxuZnVuY3Rpb24gcG9wcGVyT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICAvLyBPZmZzZXRzIGFyZSB0aGUgYWN0dWFsIHBvc2l0aW9uIHRoZSBwb3BwZXIgbmVlZHMgdG8gaGF2ZSB0byBiZVxuICAvLyBwcm9wZXJseSBwb3NpdGlvbmVkIG5lYXIgaXRzIHJlZmVyZW5jZSBlbGVtZW50XG4gIC8vIFRoaXMgaXMgdGhlIG1vc3QgYmFzaWMgcGxhY2VtZW50LCBhbmQgd2lsbCBiZSBhZGp1c3RlZCBieVxuICAvLyB0aGUgbW9kaWZpZXJzIGluIHRoZSBuZXh0IHN0ZXBcbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGNvbXB1dGVPZmZzZXRzKHtcbiAgICByZWZlcmVuY2U6IHN0YXRlLnJlY3RzLnJlZmVyZW5jZSxcbiAgICBlbGVtZW50OiBzdGF0ZS5yZWN0cy5wb3BwZXIsXG4gICAgc3RyYXRlZ3k6ICdhYnNvbHV0ZScsXG4gICAgcGxhY2VtZW50OiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwb3BwZXJPZmZzZXRzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdyZWFkJyxcbiAgZm46IHBvcHBlck9mZnNldHMsXG4gIGRhdGE6IHt9XG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRBbHRBeGlzKGF4aXMpIHtcbiAgcmV0dXJuIGF4aXMgPT09ICd4JyA/ICd5JyA6ICd4Jztcbn0iLCAiaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgYm90dG9tLCBzdGFydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldEFsdEF4aXMgZnJvbSBcIi4uL3V0aWxzL2dldEFsdEF4aXMuanNcIjtcbmltcG9ydCB7IHdpdGhpbiwgd2l0aGluTWF4Q2xhbXAgfSBmcm9tIFwiLi4vdXRpbHMvd2l0aGluLmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IGdldEZyZXNoU2lkZU9iamVjdCBmcm9tIFwiLi4vdXRpbHMvZ2V0RnJlc2hTaWRlT2JqZWN0LmpzXCI7XG5pbXBvcnQgeyBtaW4gYXMgbWF0aE1pbiwgbWF4IGFzIG1hdGhNYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBwcmV2ZW50T3ZlcmZsb3coX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucyxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRtYWluQXhpcyA9IG9wdGlvbnMubWFpbkF4aXMsXG4gICAgICBjaGVja01haW5BeGlzID0gX29wdGlvbnMkbWFpbkF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRtYWluQXhpcyxcbiAgICAgIF9vcHRpb25zJGFsdEF4aXMgPSBvcHRpb25zLmFsdEF4aXMsXG4gICAgICBjaGVja0FsdEF4aXMgPSBfb3B0aW9ucyRhbHRBeGlzID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJGFsdEF4aXMsXG4gICAgICBib3VuZGFyeSA9IG9wdGlvbnMuYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBvcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBvcHRpb25zLnBhZGRpbmcsXG4gICAgICBfb3B0aW9ucyR0ZXRoZXIgPSBvcHRpb25zLnRldGhlcixcbiAgICAgIHRldGhlciA9IF9vcHRpb25zJHRldGhlciA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHRldGhlcixcbiAgICAgIF9vcHRpb25zJHRldGhlck9mZnNldCA9IG9wdGlvbnMudGV0aGVyT2Zmc2V0LFxuICAgICAgdGV0aGVyT2Zmc2V0ID0gX29wdGlvbnMkdGV0aGVyT2Zmc2V0ID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkdGV0aGVyT2Zmc2V0O1xuICB2YXIgb3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgIGFsdEJvdW5kYXJ5OiBhbHRCb3VuZGFyeVxuICB9KTtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciB2YXJpYXRpb24gPSBnZXRWYXJpYXRpb24oc3RhdGUucGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9ICF2YXJpYXRpb247XG4gIHZhciBtYWluQXhpcyA9IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KTtcbiAgdmFyIGFsdEF4aXMgPSBnZXRBbHRBeGlzKG1haW5BeGlzKTtcbiAgdmFyIHBvcHBlck9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHM7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHRldGhlck9mZnNldFZhbHVlID0gdHlwZW9mIHRldGhlck9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IHRldGhlck9mZnNldChPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZWN0cywge1xuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pKSA6IHRldGhlck9mZnNldDtcbiAgdmFyIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZSA9IHR5cGVvZiB0ZXRoZXJPZmZzZXRWYWx1ZSA9PT0gJ251bWJlcicgPyB7XG4gICAgbWFpbkF4aXM6IHRldGhlck9mZnNldFZhbHVlLFxuICAgIGFsdEF4aXM6IHRldGhlck9mZnNldFZhbHVlXG4gIH0gOiBPYmplY3QuYXNzaWduKHtcbiAgICBtYWluQXhpczogMCxcbiAgICBhbHRBeGlzOiAwXG4gIH0sIHRldGhlck9mZnNldFZhbHVlKTtcbiAgdmFyIG9mZnNldE1vZGlmaWVyU3RhdGUgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldCA/IHN0YXRlLm1vZGlmaWVyc0RhdGEub2Zmc2V0W3N0YXRlLnBsYWNlbWVudF0gOiBudWxsO1xuICB2YXIgZGF0YSA9IHtcbiAgICB4OiAwLFxuICAgIHk6IDBcbiAgfTtcblxuICBpZiAoIXBvcHBlck9mZnNldHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoY2hlY2tNYWluQXhpcykge1xuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQ7XG5cbiAgICB2YXIgbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3knID8gdG9wIDogbGVmdDtcbiAgICB2YXIgYWx0U2lkZSA9IG1haW5BeGlzID09PSAneScgPyBib3R0b20gOiByaWdodDtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcbiAgICB2YXIgb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1ttYWluQXhpc107XG4gICAgdmFyIG1pbiA9IG9mZnNldCArIG92ZXJmbG93W21haW5TaWRlXTtcbiAgICB2YXIgbWF4ID0gb2Zmc2V0IC0gb3ZlcmZsb3dbYWx0U2lkZV07XG4gICAgdmFyIGFkZGl0aXZlID0gdGV0aGVyID8gLXBvcHBlclJlY3RbbGVuXSAvIDIgOiAwO1xuICAgIHZhciBtaW5MZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gcmVmZXJlbmNlUmVjdFtsZW5dIDogcG9wcGVyUmVjdFtsZW5dO1xuICAgIHZhciBtYXhMZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gLXBvcHBlclJlY3RbbGVuXSA6IC1yZWZlcmVuY2VSZWN0W2xlbl07IC8vIFdlIG5lZWQgdG8gaW5jbHVkZSB0aGUgYXJyb3cgaW4gdGhlIGNhbGN1bGF0aW9uIHNvIHRoZSBhcnJvdyBkb2Vzbid0IGdvXG4gICAgLy8gb3V0c2lkZSB0aGUgcmVmZXJlbmNlIGJvdW5kc1xuXG4gICAgdmFyIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93O1xuICAgIHZhciBhcnJvd1JlY3QgPSB0ZXRoZXIgJiYgYXJyb3dFbGVtZW50ID8gZ2V0TGF5b3V0UmVjdChhcnJvd0VsZW1lbnQpIDoge1xuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9O1xuICAgIHZhciBhcnJvd1BhZGRpbmdPYmplY3QgPSBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10gPyBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10ucGFkZGluZyA6IGdldEZyZXNoU2lkZU9iamVjdCgpO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNaW4gPSBhcnJvd1BhZGRpbmdPYmplY3RbbWFpblNpZGVdO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNYXggPSBhcnJvd1BhZGRpbmdPYmplY3RbYWx0U2lkZV07IC8vIElmIHRoZSByZWZlcmVuY2UgbGVuZ3RoIGlzIHNtYWxsZXIgdGhhbiB0aGUgYXJyb3cgbGVuZ3RoLCB3ZSBkb24ndCB3YW50XG4gICAgLy8gdG8gaW5jbHVkZSBpdHMgZnVsbCBzaXplIGluIHRoZSBjYWxjdWxhdGlvbi4gSWYgdGhlIHJlZmVyZW5jZSBpcyBzbWFsbFxuICAgIC8vIGFuZCBuZWFyIHRoZSBlZGdlIG9mIGEgYm91bmRhcnksIHRoZSBwb3BwZXIgY2FuIG92ZXJmbG93IGV2ZW4gaWYgdGhlXG4gICAgLy8gcmVmZXJlbmNlIGlzIG5vdCBvdmVyZmxvd2luZyBhcyB3ZWxsIChlLmcuIHZpcnR1YWwgZWxlbWVudHMgd2l0aCBub1xuICAgIC8vIHdpZHRoIG9yIGhlaWdodClcblxuICAgIHZhciBhcnJvd0xlbiA9IHdpdGhpbigwLCByZWZlcmVuY2VSZWN0W2xlbl0sIGFycm93UmVjdFtsZW5dKTtcbiAgICB2YXIgbWluT2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gcmVmZXJlbmNlUmVjdFtsZW5dIC8gMiAtIGFkZGl0aXZlIC0gYXJyb3dMZW4gLSBhcnJvd1BhZGRpbmdNaW4gLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXMgOiBtaW5MZW4gLSBhcnJvd0xlbiAtIGFycm93UGFkZGluZ01pbiAtIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcztcbiAgICB2YXIgbWF4T2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gLXJlZmVyZW5jZVJlY3RbbGVuXSAvIDIgKyBhZGRpdGl2ZSArIGFycm93TGVuICsgYXJyb3dQYWRkaW5nTWF4ICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzIDogbWF4TGVuICsgYXJyb3dMZW4gKyBhcnJvd1BhZGRpbmdNYXggKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXM7XG4gICAgdmFyIGFycm93T2Zmc2V0UGFyZW50ID0gc3RhdGUuZWxlbWVudHMuYXJyb3cgJiYgZ2V0T2Zmc2V0UGFyZW50KHN0YXRlLmVsZW1lbnRzLmFycm93KTtcbiAgICB2YXIgY2xpZW50T2Zmc2V0ID0gYXJyb3dPZmZzZXRQYXJlbnQgPyBtYWluQXhpcyA9PT0gJ3knID8gYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50VG9wIHx8IDAgOiBhcnJvd09mZnNldFBhcmVudC5jbGllbnRMZWZ0IHx8IDAgOiAwO1xuICAgIHZhciBvZmZzZXRNb2RpZmllclZhbHVlID0gKF9vZmZzZXRNb2RpZmllclN0YXRlJCA9IG9mZnNldE1vZGlmaWVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IG9mZnNldE1vZGlmaWVyU3RhdGVbbWFpbkF4aXNdKSAhPSBudWxsID8gX29mZnNldE1vZGlmaWVyU3RhdGUkIDogMDtcbiAgICB2YXIgdGV0aGVyTWluID0gb2Zmc2V0ICsgbWluT2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZSAtIGNsaWVudE9mZnNldDtcbiAgICB2YXIgdGV0aGVyTWF4ID0gb2Zmc2V0ICsgbWF4T2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZTtcbiAgICB2YXIgcHJldmVudGVkT2Zmc2V0ID0gd2l0aGluKHRldGhlciA/IG1hdGhNaW4obWluLCB0ZXRoZXJNaW4pIDogbWluLCBvZmZzZXQsIHRldGhlciA/IG1hdGhNYXgobWF4LCB0ZXRoZXJNYXgpIDogbWF4KTtcbiAgICBwb3BwZXJPZmZzZXRzW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldDtcbiAgICBkYXRhW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldCAtIG9mZnNldDtcbiAgfVxuXG4gIGlmIChjaGVja0FsdEF4aXMpIHtcbiAgICB2YXIgX29mZnNldE1vZGlmaWVyU3RhdGUkMjtcblxuICAgIHZhciBfbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3gnID8gdG9wIDogbGVmdDtcblxuICAgIHZhciBfYWx0U2lkZSA9IG1haW5BeGlzID09PSAneCcgPyBib3R0b20gOiByaWdodDtcblxuICAgIHZhciBfb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1thbHRBeGlzXTtcblxuICAgIHZhciBfbGVuID0gYWx0QXhpcyA9PT0gJ3knID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gICAgdmFyIF9taW4gPSBfb2Zmc2V0ICsgb3ZlcmZsb3dbX21haW5TaWRlXTtcblxuICAgIHZhciBfbWF4ID0gX29mZnNldCAtIG92ZXJmbG93W19hbHRTaWRlXTtcblxuICAgIHZhciBpc09yaWdpblNpZGUgPSBbdG9wLCBsZWZ0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpICE9PSAtMTtcblxuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJWYWx1ZSA9IChfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQyID0gb2Zmc2V0TW9kaWZpZXJTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogb2Zmc2V0TW9kaWZpZXJTdGF0ZVthbHRBeGlzXSkgIT0gbnVsbCA/IF9vZmZzZXRNb2RpZmllclN0YXRlJDIgOiAwO1xuXG4gICAgdmFyIF90ZXRoZXJNaW4gPSBpc09yaWdpblNpZGUgPyBfbWluIDogX29mZnNldCAtIHJlZmVyZW5jZVJlY3RbX2xlbl0gLSBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcztcblxuICAgIHZhciBfdGV0aGVyTWF4ID0gaXNPcmlnaW5TaWRlID8gX29mZnNldCArIHJlZmVyZW5jZVJlY3RbX2xlbl0gKyBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcyA6IF9tYXg7XG5cbiAgICB2YXIgX3ByZXZlbnRlZE9mZnNldCA9IHRldGhlciAmJiBpc09yaWdpblNpZGUgPyB3aXRoaW5NYXhDbGFtcChfdGV0aGVyTWluLCBfb2Zmc2V0LCBfdGV0aGVyTWF4KSA6IHdpdGhpbih0ZXRoZXIgPyBfdGV0aGVyTWluIDogX21pbiwgX29mZnNldCwgdGV0aGVyID8gX3RldGhlck1heCA6IF9tYXgpO1xuXG4gICAgcG9wcGVyT2Zmc2V0c1thbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQ7XG4gICAgZGF0YVthbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQgLSBfb2Zmc2V0O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwcmV2ZW50T3ZlcmZsb3cnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogcHJldmVudE92ZXJmbG93LFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddXG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRIVE1MRWxlbWVudFNjcm9sbChlbGVtZW50KSB7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogZWxlbWVudC5zY3JvbGxMZWZ0LFxuICAgIHNjcm9sbFRvcDogZWxlbWVudC5zY3JvbGxUb3BcbiAgfTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvd1Njcm9sbCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGwuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEhUTUxFbGVtZW50U2Nyb2xsIGZyb20gXCIuL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlU2Nyb2xsKG5vZGUpIHtcbiAgaWYgKG5vZGUgPT09IGdldFdpbmRvdyhub2RlKSB8fCAhaXNIVE1MRWxlbWVudChub2RlKSkge1xuICAgIHJldHVybiBnZXRXaW5kb3dTY3JvbGwobm9kZSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGdldEhUTUxFbGVtZW50U2Nyb2xsKG5vZGUpO1xuICB9XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZVNjcm9sbCBmcm9tIFwiLi9nZXROb2RlU2Nyb2xsLmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGlzU2Nyb2xsUGFyZW50IGZyb20gXCIuL2lzU2Nyb2xsUGFyZW50LmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5cbmZ1bmN0aW9uIGlzRWxlbWVudFNjYWxlZChlbGVtZW50KSB7XG4gIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgdmFyIHNjYWxlWCA9IHJvdW5kKHJlY3Qud2lkdGgpIC8gZWxlbWVudC5vZmZzZXRXaWR0aCB8fCAxO1xuICB2YXIgc2NhbGVZID0gcm91bmQocmVjdC5oZWlnaHQpIC8gZWxlbWVudC5vZmZzZXRIZWlnaHQgfHwgMTtcbiAgcmV0dXJuIHNjYWxlWCAhPT0gMSB8fCBzY2FsZVkgIT09IDE7XG59IC8vIFJldHVybnMgdGhlIGNvbXBvc2l0ZSByZWN0IG9mIGFuIGVsZW1lbnQgcmVsYXRpdmUgdG8gaXRzIG9mZnNldFBhcmVudC5cbi8vIENvbXBvc2l0ZSBtZWFucyBpdCB0YWtlcyBpbnRvIGFjY291bnQgdHJhbnNmb3JtcyBhcyB3ZWxsIGFzIGxheW91dC5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDb21wb3NpdGVSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnQsIGlzRml4ZWQpIHtcbiAgaWYgKGlzRml4ZWQgPT09IHZvaWQgMCkge1xuICAgIGlzRml4ZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBpc09mZnNldFBhcmVudEFuRWxlbWVudCA9IGlzSFRNTEVsZW1lbnQob2Zmc2V0UGFyZW50KTtcbiAgdmFyIG9mZnNldFBhcmVudElzU2NhbGVkID0gaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpICYmIGlzRWxlbWVudFNjYWxlZChvZmZzZXRQYXJlbnQpO1xuICB2YXIgZG9jdW1lbnRFbGVtZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KG9mZnNldFBhcmVudCk7XG4gIHZhciByZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnRJc1NjYWxlZCwgaXNGaXhlZCk7XG4gIHZhciBzY3JvbGwgPSB7XG4gICAgc2Nyb2xsTGVmdDogMCxcbiAgICBzY3JvbGxUb3A6IDBcbiAgfTtcbiAgdmFyIG9mZnNldHMgPSB7XG4gICAgeDogMCxcbiAgICB5OiAwXG4gIH07XG5cbiAgaWYgKGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50IHx8ICFpc09mZnNldFBhcmVudEFuRWxlbWVudCAmJiAhaXNGaXhlZCkge1xuICAgIGlmIChnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpICE9PSAnYm9keScgfHwgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy8xMDc4XG4gICAgaXNTY3JvbGxQYXJlbnQoZG9jdW1lbnRFbGVtZW50KSkge1xuICAgICAgc2Nyb2xsID0gZ2V0Tm9kZVNjcm9sbChvZmZzZXRQYXJlbnQpO1xuICAgIH1cblxuICAgIGlmIChpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCkpIHtcbiAgICAgIG9mZnNldHMgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3Qob2Zmc2V0UGFyZW50LCB0cnVlKTtcbiAgICAgIG9mZnNldHMueCArPSBvZmZzZXRQYXJlbnQuY2xpZW50TGVmdDtcbiAgICAgIG9mZnNldHMueSArPSBvZmZzZXRQYXJlbnQuY2xpZW50VG9wO1xuICAgIH0gZWxzZSBpZiAoZG9jdW1lbnRFbGVtZW50KSB7XG4gICAgICBvZmZzZXRzLnggPSBnZXRXaW5kb3dTY3JvbGxCYXJYKGRvY3VtZW50RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB4OiByZWN0LmxlZnQgKyBzY3JvbGwuc2Nyb2xsTGVmdCAtIG9mZnNldHMueCxcbiAgICB5OiByZWN0LnRvcCArIHNjcm9sbC5zY3JvbGxUb3AgLSBvZmZzZXRzLnksXG4gICAgd2lkdGg6IHJlY3Qud2lkdGgsXG4gICAgaGVpZ2h0OiByZWN0LmhlaWdodFxuICB9O1xufSIsICJpbXBvcnQgeyBtb2RpZmllclBoYXNlcyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiOyAvLyBzb3VyY2U6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzQ5ODc1MjU1XG5cbmZ1bmN0aW9uIG9yZGVyKG1vZGlmaWVycykge1xuICB2YXIgbWFwID0gbmV3IE1hcCgpO1xuICB2YXIgdmlzaXRlZCA9IG5ldyBTZXQoKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBtYXAuc2V0KG1vZGlmaWVyLm5hbWUsIG1vZGlmaWVyKTtcbiAgfSk7IC8vIE9uIHZpc2l0aW5nIG9iamVjdCwgY2hlY2sgZm9yIGl0cyBkZXBlbmRlbmNpZXMgYW5kIHZpc2l0IHRoZW0gcmVjdXJzaXZlbHlcblxuICBmdW5jdGlvbiBzb3J0KG1vZGlmaWVyKSB7XG4gICAgdmlzaXRlZC5hZGQobW9kaWZpZXIubmFtZSk7XG4gICAgdmFyIHJlcXVpcmVzID0gW10uY29uY2F0KG1vZGlmaWVyLnJlcXVpcmVzIHx8IFtdLCBtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzIHx8IFtdKTtcbiAgICByZXF1aXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChkZXApIHtcbiAgICAgIGlmICghdmlzaXRlZC5oYXMoZGVwKSkge1xuICAgICAgICB2YXIgZGVwTW9kaWZpZXIgPSBtYXAuZ2V0KGRlcCk7XG5cbiAgICAgICAgaWYgKGRlcE1vZGlmaWVyKSB7XG4gICAgICAgICAgc29ydChkZXBNb2RpZmllcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXN1bHQucHVzaChtb2RpZmllcik7XG4gIH1cblxuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBpZiAoIXZpc2l0ZWQuaGFzKG1vZGlmaWVyLm5hbWUpKSB7XG4gICAgICAvLyBjaGVjayBmb3IgdmlzaXRlZCBvYmplY3RcbiAgICAgIHNvcnQobW9kaWZpZXIpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG9yZGVyTW9kaWZpZXJzKG1vZGlmaWVycykge1xuICAvLyBvcmRlciBiYXNlZCBvbiBkZXBlbmRlbmNpZXNcbiAgdmFyIG9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcihtb2RpZmllcnMpOyAvLyBvcmRlciBiYXNlZCBvbiBwaGFzZVxuXG4gIHJldHVybiBtb2RpZmllclBoYXNlcy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGhhc2UpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgIHJldHVybiBtb2RpZmllci5waGFzZSA9PT0gcGhhc2U7XG4gICAgfSkpO1xuICB9LCBbXSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRlYm91bmNlKGZuKSB7XG4gIHZhciBwZW5kaW5nO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmICghcGVuZGluZykge1xuICAgICAgcGVuZGluZyA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHBlbmRpbmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgcmVzb2x2ZShmbigpKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGVuZGluZztcbiAgfTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZm9ybWF0KHN0cikge1xuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gW10uY29uY2F0KGFyZ3MpLnJlZHVjZShmdW5jdGlvbiAocCwgYykge1xuICAgIHJldHVybiBwLnJlcGxhY2UoLyVzLywgYyk7XG4gIH0sIHN0cik7XG59IiwgImltcG9ydCBmb3JtYXQgZnJvbSBcIi4vZm9ybWF0LmpzXCI7XG5pbXBvcnQgeyBtb2RpZmllclBoYXNlcyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xudmFyIElOVkFMSURfTU9ESUZJRVJfRVJST1IgPSAnUG9wcGVyOiBtb2RpZmllciBcIiVzXCIgcHJvdmlkZWQgYW4gaW52YWxpZCAlcyBwcm9wZXJ0eSwgZXhwZWN0ZWQgJXMgYnV0IGdvdCAlcyc7XG52YXIgTUlTU0lOR19ERVBFTkRFTkNZX0VSUk9SID0gJ1BvcHBlcjogbW9kaWZpZXIgXCIlc1wiIHJlcXVpcmVzIFwiJXNcIiwgYnV0IFwiJXNcIiBtb2RpZmllciBpcyBub3QgYXZhaWxhYmxlJztcbnZhciBWQUxJRF9QUk9QRVJUSUVTID0gWyduYW1lJywgJ2VuYWJsZWQnLCAncGhhc2UnLCAnZm4nLCAnZWZmZWN0JywgJ3JlcXVpcmVzJywgJ29wdGlvbnMnXTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHZhbGlkYXRlTW9kaWZpZXJzKG1vZGlmaWVycykge1xuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBbXS5jb25jYXQoT2JqZWN0LmtleXMobW9kaWZpZXIpLCBWQUxJRF9QUk9QRVJUSUVTKSAvLyBJRTExLWNvbXBhdGlibGUgcmVwbGFjZW1lbnQgZm9yIGBuZXcgU2V0KGl0ZXJhYmxlKWBcbiAgICAuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgsIHNlbGYpIHtcbiAgICAgIHJldHVybiBzZWxmLmluZGV4T2YodmFsdWUpID09PSBpbmRleDtcbiAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgJ25hbWUnOlxuICAgICAgICAgIGlmICh0eXBlb2YgbW9kaWZpZXIubmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIFN0cmluZyhtb2RpZmllci5uYW1lKSwgJ1wibmFtZVwiJywgJ1wic3RyaW5nXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5uYW1lKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZW5hYmxlZCc6XG4gICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmllci5lbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcImVuYWJsZWRcIicsICdcImJvb2xlYW5cIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLmVuYWJsZWQpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdwaGFzZSc6XG4gICAgICAgICAgaWYgKG1vZGlmaWVyUGhhc2VzLmluZGV4T2YobW9kaWZpZXIucGhhc2UpIDwgMCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicGhhc2VcIicsIFwiZWl0aGVyIFwiICsgbW9kaWZpZXJQaGFzZXMuam9pbignLCAnKSwgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIucGhhc2UpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdmbic6XG4gICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmllci5mbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wiZm5cIicsICdcImZ1bmN0aW9uXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5mbikgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2VmZmVjdCc6XG4gICAgICAgICAgaWYgKG1vZGlmaWVyLmVmZmVjdCAhPSBudWxsICYmIHR5cGVvZiBtb2RpZmllci5lZmZlY3QgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcImVmZmVjdFwiJywgJ1wiZnVuY3Rpb25cIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLmZuKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAncmVxdWlyZXMnOlxuICAgICAgICAgIGlmIChtb2RpZmllci5yZXF1aXJlcyAhPSBudWxsICYmICFBcnJheS5pc0FycmF5KG1vZGlmaWVyLnJlcXVpcmVzKSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicmVxdWlyZXNcIicsICdcImFycmF5XCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5yZXF1aXJlcykgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3JlcXVpcmVzSWZFeGlzdHMnOlxuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzKSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicmVxdWlyZXNJZkV4aXN0c1wiJywgJ1wiYXJyYXlcIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLnJlcXVpcmVzSWZFeGlzdHMpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdvcHRpb25zJzpcbiAgICAgICAgY2FzZSAnZGF0YSc6XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUG9wcGVySlM6IGFuIGludmFsaWQgcHJvcGVydHkgaGFzIGJlZW4gcHJvdmlkZWQgdG8gdGhlIFxcXCJcIiArIG1vZGlmaWVyLm5hbWUgKyBcIlxcXCIgbW9kaWZpZXIsIHZhbGlkIHByb3BlcnRpZXMgYXJlIFwiICsgVkFMSURfUFJPUEVSVElFUy5tYXAoZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlxcXCJcIiArIHMgKyBcIlxcXCJcIjtcbiAgICAgICAgICB9KS5qb2luKCcsICcpICsgXCI7IGJ1dCBcXFwiXCIgKyBrZXkgKyBcIlxcXCIgd2FzIHByb3ZpZGVkLlwiKTtcbiAgICAgIH1cblxuICAgICAgbW9kaWZpZXIucmVxdWlyZXMgJiYgbW9kaWZpZXIucmVxdWlyZXMuZm9yRWFjaChmdW5jdGlvbiAocmVxdWlyZW1lbnQpIHtcbiAgICAgICAgaWYgKG1vZGlmaWVycy5maW5kKGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICByZXR1cm4gbW9kLm5hbWUgPT09IHJlcXVpcmVtZW50O1xuICAgICAgICB9KSA9PSBudWxsKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoTUlTU0lOR19ERVBFTkRFTkNZX0VSUk9SLCBTdHJpbmcobW9kaWZpZXIubmFtZSksIHJlcXVpcmVtZW50LCByZXF1aXJlbWVudCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVuaXF1ZUJ5KGFyciwgZm4pIHtcbiAgdmFyIGlkZW50aWZpZXJzID0gbmV3IFNldCgpO1xuICByZXR1cm4gYXJyLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBpZGVudGlmaWVyID0gZm4oaXRlbSk7XG5cbiAgICBpZiAoIWlkZW50aWZpZXJzLmhhcyhpZGVudGlmaWVyKSkge1xuICAgICAgaWRlbnRpZmllcnMuYWRkKGlkZW50aWZpZXIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWVyZ2VCeU5hbWUobW9kaWZpZXJzKSB7XG4gIHZhciBtZXJnZWQgPSBtb2RpZmllcnMucmVkdWNlKGZ1bmN0aW9uIChtZXJnZWQsIGN1cnJlbnQpIHtcbiAgICB2YXIgZXhpc3RpbmcgPSBtZXJnZWRbY3VycmVudC5uYW1lXTtcbiAgICBtZXJnZWRbY3VycmVudC5uYW1lXSA9IGV4aXN0aW5nID8gT2JqZWN0LmFzc2lnbih7fSwgZXhpc3RpbmcsIGN1cnJlbnQsIHtcbiAgICAgIG9wdGlvbnM6IE9iamVjdC5hc3NpZ24oe30sIGV4aXN0aW5nLm9wdGlvbnMsIGN1cnJlbnQub3B0aW9ucyksXG4gICAgICBkYXRhOiBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZy5kYXRhLCBjdXJyZW50LmRhdGEpXG4gICAgfSkgOiBjdXJyZW50O1xuICAgIHJldHVybiBtZXJnZWQ7XG4gIH0sIHt9KTsgLy8gSUUxMSBkb2VzIG5vdCBzdXBwb3J0IE9iamVjdC52YWx1ZXNcblxuICByZXR1cm4gT2JqZWN0LmtleXMobWVyZ2VkKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiBtZXJnZWRba2V5XTtcbiAgfSk7XG59IiwgImltcG9ydCBnZXRDb21wb3NpdGVSZWN0IGZyb20gXCIuL2RvbS11dGlscy9nZXRDb21wb3NpdGVSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qc1wiO1xuaW1wb3J0IGxpc3RTY3JvbGxQYXJlbnRzIGZyb20gXCIuL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IG9yZGVyTW9kaWZpZXJzIGZyb20gXCIuL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzXCI7XG5pbXBvcnQgZGVib3VuY2UgZnJvbSBcIi4vdXRpbHMvZGVib3VuY2UuanNcIjtcbmltcG9ydCB2YWxpZGF0ZU1vZGlmaWVycyBmcm9tIFwiLi91dGlscy92YWxpZGF0ZU1vZGlmaWVycy5qc1wiO1xuaW1wb3J0IHVuaXF1ZUJ5IGZyb20gXCIuL3V0aWxzL3VuaXF1ZUJ5LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgbWVyZ2VCeU5hbWUgZnJvbSBcIi4vdXRpbHMvbWVyZ2VCeU5hbWUuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCB7IGF1dG8gfSBmcm9tIFwiLi9lbnVtcy5qc1wiO1xudmFyIElOVkFMSURfRUxFTUVOVF9FUlJPUiA9ICdQb3BwZXI6IEludmFsaWQgcmVmZXJlbmNlIG9yIHBvcHBlciBhcmd1bWVudCBwcm92aWRlZC4gVGhleSBtdXN0IGJlIGVpdGhlciBhIERPTSBlbGVtZW50IG9yIHZpcnR1YWwgZWxlbWVudC4nO1xudmFyIElORklOSVRFX0xPT1BfRVJST1IgPSAnUG9wcGVyOiBBbiBpbmZpbml0ZSBsb29wIGluIHRoZSBtb2RpZmllcnMgY3ljbGUgaGFzIGJlZW4gZGV0ZWN0ZWQhIFRoZSBjeWNsZSBoYXMgYmVlbiBpbnRlcnJ1cHRlZCB0byBwcmV2ZW50IGEgYnJvd3NlciBjcmFzaC4nO1xudmFyIERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgcGxhY2VtZW50OiAnYm90dG9tJyxcbiAgbW9kaWZpZXJzOiBbXSxcbiAgc3RyYXRlZ3k6ICdhYnNvbHV0ZSdcbn07XG5cbmZ1bmN0aW9uIGFyZVZhbGlkRWxlbWVudHMoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gIWFyZ3Muc29tZShmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIHJldHVybiAhKGVsZW1lbnQgJiYgdHlwZW9mIGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ID09PSAnZnVuY3Rpb24nKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3BwZXJHZW5lcmF0b3IoZ2VuZXJhdG9yT3B0aW9ucykge1xuICBpZiAoZ2VuZXJhdG9yT3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgZ2VuZXJhdG9yT3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9nZW5lcmF0b3JPcHRpb25zID0gZ2VuZXJhdG9yT3B0aW9ucyxcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZiA9IF9nZW5lcmF0b3JPcHRpb25zLmRlZmF1bHRNb2RpZmllcnMsXG4gICAgICBkZWZhdWx0TW9kaWZpZXJzID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmID09PSB2b2lkIDAgPyBbXSA6IF9nZW5lcmF0b3JPcHRpb25zJGRlZixcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZjIgPSBfZ2VuZXJhdG9yT3B0aW9ucy5kZWZhdWx0T3B0aW9ucyxcbiAgICAgIGRlZmF1bHRPcHRpb25zID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmMiA9PT0gdm9pZCAwID8gREVGQVVMVF9PUFRJT05TIDogX2dlbmVyYXRvck9wdGlvbnMkZGVmMjtcbiAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZVBvcHBlcihyZWZlcmVuY2UsIHBvcHBlciwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICB9XG5cbiAgICB2YXIgc3RhdGUgPSB7XG4gICAgICBwbGFjZW1lbnQ6ICdib3R0b20nLFxuICAgICAgb3JkZXJlZE1vZGlmaWVyczogW10sXG4gICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX09QVElPTlMsIGRlZmF1bHRPcHRpb25zKSxcbiAgICAgIG1vZGlmaWVyc0RhdGE6IHt9LFxuICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgcmVmZXJlbmNlOiByZWZlcmVuY2UsXG4gICAgICAgIHBvcHBlcjogcG9wcGVyXG4gICAgICB9LFxuICAgICAgYXR0cmlidXRlczoge30sXG4gICAgICBzdHlsZXM6IHt9XG4gICAgfTtcbiAgICB2YXIgZWZmZWN0Q2xlYW51cEZucyA9IFtdO1xuICAgIHZhciBpc0Rlc3Ryb3llZCA9IGZhbHNlO1xuICAgIHZhciBpbnN0YW5jZSA9IHtcbiAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgIHNldE9wdGlvbnM6IGZ1bmN0aW9uIHNldE9wdGlvbnMoc2V0T3B0aW9uc0FjdGlvbikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBzZXRPcHRpb25zQWN0aW9uID09PSAnZnVuY3Rpb24nID8gc2V0T3B0aW9uc0FjdGlvbihzdGF0ZS5vcHRpb25zKSA6IHNldE9wdGlvbnNBY3Rpb247XG4gICAgICAgIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgc3RhdGUub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBzdGF0ZS5vcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgc3RhdGUuc2Nyb2xsUGFyZW50cyA9IHtcbiAgICAgICAgICByZWZlcmVuY2U6IGlzRWxlbWVudChyZWZlcmVuY2UpID8gbGlzdFNjcm9sbFBhcmVudHMocmVmZXJlbmNlKSA6IHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCA/IGxpc3RTY3JvbGxQYXJlbnRzKHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCkgOiBbXSxcbiAgICAgICAgICBwb3BwZXI6IGxpc3RTY3JvbGxQYXJlbnRzKHBvcHBlcilcbiAgICAgICAgfTsgLy8gT3JkZXJzIHRoZSBtb2RpZmllcnMgYmFzZWQgb24gdGhlaXIgZGVwZW5kZW5jaWVzIGFuZCBgcGhhc2VgXG4gICAgICAgIC8vIHByb3BlcnRpZXNcblxuICAgICAgICB2YXIgb3JkZXJlZE1vZGlmaWVycyA9IG9yZGVyTW9kaWZpZXJzKG1lcmdlQnlOYW1lKFtdLmNvbmNhdChkZWZhdWx0TW9kaWZpZXJzLCBzdGF0ZS5vcHRpb25zLm1vZGlmaWVycykpKTsgLy8gU3RyaXAgb3V0IGRpc2FibGVkIG1vZGlmaWVyc1xuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobSkge1xuICAgICAgICAgIHJldHVybiBtLmVuYWJsZWQ7XG4gICAgICAgIH0pOyAvLyBWYWxpZGF0ZSB0aGUgcHJvdmlkZWQgbW9kaWZpZXJzIHNvIHRoYXQgdGhlIGNvbnN1bWVyIHdpbGwgZ2V0IHdhcm5lZFxuICAgICAgICAvLyBpZiBvbmUgb2YgdGhlIG1vZGlmaWVycyBpcyBpbnZhbGlkIGZvciBhbnkgcmVhc29uXG5cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgIHZhciBtb2RpZmllcnMgPSB1bmlxdWVCeShbXS5jb25jYXQob3JkZXJlZE1vZGlmaWVycywgc3RhdGUub3B0aW9ucy5tb2RpZmllcnMpLCBmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBfcmVmLm5hbWU7XG4gICAgICAgICAgICByZXR1cm4gbmFtZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YWxpZGF0ZU1vZGlmaWVycyhtb2RpZmllcnMpO1xuXG4gICAgICAgICAgaWYgKGdldEJhc2VQbGFjZW1lbnQoc3RhdGUub3B0aW9ucy5wbGFjZW1lbnQpID09PSBhdXRvKSB7XG4gICAgICAgICAgICB2YXIgZmxpcE1vZGlmaWVyID0gc3RhdGUub3JkZXJlZE1vZGlmaWVycy5maW5kKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgICAgICAgICB2YXIgbmFtZSA9IF9yZWYyLm5hbWU7XG4gICAgICAgICAgICAgIHJldHVybiBuYW1lID09PSAnZmxpcCc7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFmbGlwTW9kaWZpZXIpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogXCJhdXRvXCIgcGxhY2VtZW50cyByZXF1aXJlIHRoZSBcImZsaXBcIiBtb2RpZmllciBiZScsICdwcmVzZW50IGFuZCBlbmFibGVkIHRvIHdvcmsuJ10uam9pbignICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgX2dldENvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHBvcHBlciksXG4gICAgICAgICAgICAgIG1hcmdpblRvcCA9IF9nZXRDb21wdXRlZFN0eWxlLm1hcmdpblRvcCxcbiAgICAgICAgICAgICAgbWFyZ2luUmlnaHQgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5tYXJnaW5SaWdodCxcbiAgICAgICAgICAgICAgbWFyZ2luQm90dG9tID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luQm90dG9tLFxuICAgICAgICAgICAgICBtYXJnaW5MZWZ0ID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luTGVmdDsgLy8gV2Ugbm8gbG9uZ2VyIHRha2UgaW50byBhY2NvdW50IGBtYXJnaW5zYCBvbiB0aGUgcG9wcGVyLCBhbmQgaXQgY2FuXG4gICAgICAgICAgLy8gY2F1c2UgYnVncyB3aXRoIHBvc2l0aW9uaW5nLCBzbyB3ZSdsbCB3YXJuIHRoZSBjb25zdW1lclxuXG5cbiAgICAgICAgICBpZiAoW21hcmdpblRvcCwgbWFyZ2luUmlnaHQsIG1hcmdpbkJvdHRvbSwgbWFyZ2luTGVmdF0uc29tZShmdW5jdGlvbiAobWFyZ2luKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChtYXJnaW4pO1xuICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oWydQb3BwZXI6IENTUyBcIm1hcmdpblwiIHN0eWxlcyBjYW5ub3QgYmUgdXNlZCB0byBhcHBseSBwYWRkaW5nJywgJ2JldHdlZW4gdGhlIHBvcHBlciBhbmQgaXRzIHJlZmVyZW5jZSBlbGVtZW50IG9yIGJvdW5kYXJ5LicsICdUbyByZXBsaWNhdGUgbWFyZ2luLCB1c2UgdGhlIGBvZmZzZXRgIG1vZGlmaWVyLCBhcyB3ZWxsIGFzJywgJ3RoZSBgcGFkZGluZ2Agb3B0aW9uIGluIHRoZSBgcHJldmVudE92ZXJmbG93YCBhbmQgYGZsaXBgJywgJ21vZGlmaWVycy4nXS5qb2luKCcgJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bk1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICByZXR1cm4gaW5zdGFuY2UudXBkYXRlKCk7XG4gICAgICB9LFxuICAgICAgLy8gU3luYyB1cGRhdGUgXHUyMDEzIGl0IHdpbGwgYWx3YXlzIGJlIGV4ZWN1dGVkLCBldmVuIGlmIG5vdCBuZWNlc3NhcnkuIFRoaXNcbiAgICAgIC8vIGlzIHVzZWZ1bCBmb3IgbG93IGZyZXF1ZW5jeSB1cGRhdGVzIHdoZXJlIHN5bmMgYmVoYXZpb3Igc2ltcGxpZmllcyB0aGVcbiAgICAgIC8vIGxvZ2ljLlxuICAgICAgLy8gRm9yIGhpZ2ggZnJlcXVlbmN5IHVwZGF0ZXMgKGUuZy4gYHJlc2l6ZWAgYW5kIGBzY3JvbGxgIGV2ZW50cyksIGFsd2F5c1xuICAgICAgLy8gcHJlZmVyIHRoZSBhc3luYyBQb3BwZXIjdXBkYXRlIG1ldGhvZFxuICAgICAgZm9yY2VVcGRhdGU6IGZ1bmN0aW9uIGZvcmNlVXBkYXRlKCkge1xuICAgICAgICBpZiAoaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3N0YXRlJGVsZW1lbnRzID0gc3RhdGUuZWxlbWVudHMsXG4gICAgICAgICAgICByZWZlcmVuY2UgPSBfc3RhdGUkZWxlbWVudHMucmVmZXJlbmNlLFxuICAgICAgICAgICAgcG9wcGVyID0gX3N0YXRlJGVsZW1lbnRzLnBvcHBlcjsgLy8gRG9uJ3QgcHJvY2VlZCBpZiBgcmVmZXJlbmNlYCBvciBgcG9wcGVyYCBhcmUgbm90IHZhbGlkIGVsZW1lbnRzXG4gICAgICAgIC8vIGFueW1vcmVcblxuICAgICAgICBpZiAoIWFyZVZhbGlkRWxlbWVudHMocmVmZXJlbmNlLCBwb3BwZXIpKSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihJTlZBTElEX0VMRU1FTlRfRVJST1IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBTdG9yZSB0aGUgcmVmZXJlbmNlIGFuZCBwb3BwZXIgcmVjdHMgdG8gYmUgcmVhZCBieSBtb2RpZmllcnNcblxuXG4gICAgICAgIHN0YXRlLnJlY3RzID0ge1xuICAgICAgICAgIHJlZmVyZW5jZTogZ2V0Q29tcG9zaXRlUmVjdChyZWZlcmVuY2UsIGdldE9mZnNldFBhcmVudChwb3BwZXIpLCBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5ID09PSAnZml4ZWQnKSxcbiAgICAgICAgICBwb3BwZXI6IGdldExheW91dFJlY3QocG9wcGVyKVxuICAgICAgICB9OyAvLyBNb2RpZmllcnMgaGF2ZSB0aGUgYWJpbGl0eSB0byByZXNldCB0aGUgY3VycmVudCB1cGRhdGUgY3ljbGUuIFRoZVxuICAgICAgICAvLyBtb3N0IGNvbW1vbiB1c2UgY2FzZSBmb3IgdGhpcyBpcyB0aGUgYGZsaXBgIG1vZGlmaWVyIGNoYW5naW5nIHRoZVxuICAgICAgICAvLyBwbGFjZW1lbnQsIHdoaWNoIHRoZW4gbmVlZHMgdG8gcmUtcnVuIGFsbCB0aGUgbW9kaWZpZXJzLCBiZWNhdXNlIHRoZVxuICAgICAgICAvLyBsb2dpYyB3YXMgcHJldmlvdXNseSByYW4gZm9yIHRoZSBwcmV2aW91cyBwbGFjZW1lbnQgYW5kIGlzIHRoZXJlZm9yZVxuICAgICAgICAvLyBzdGFsZS9pbmNvcnJlY3RcblxuICAgICAgICBzdGF0ZS5yZXNldCA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5wbGFjZW1lbnQgPSBzdGF0ZS5vcHRpb25zLnBsYWNlbWVudDsgLy8gT24gZWFjaCB1cGRhdGUgY3ljbGUsIHRoZSBgbW9kaWZpZXJzRGF0YWAgcHJvcGVydHkgZm9yIGVhY2ggbW9kaWZpZXJcbiAgICAgICAgLy8gaXMgZmlsbGVkIHdpdGggdGhlIGluaXRpYWwgZGF0YSBzcGVjaWZpZWQgYnkgdGhlIG1vZGlmaWVyLiBUaGlzIG1lYW5zXG4gICAgICAgIC8vIGl0IGRvZXNuJ3QgcGVyc2lzdCBhbmQgaXMgZnJlc2ggb24gZWFjaCB1cGRhdGUuXG4gICAgICAgIC8vIFRvIGVuc3VyZSBwZXJzaXN0ZW50IGRhdGEsIHVzZSBgJHtuYW1lfSNwZXJzaXN0ZW50YFxuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgICAgICByZXR1cm4gc3RhdGUubW9kaWZpZXJzRGF0YVttb2RpZmllci5uYW1lXSA9IE9iamVjdC5hc3NpZ24oe30sIG1vZGlmaWVyLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIF9fZGVidWdfbG9vcHNfXyA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHN0YXRlLm9yZGVyZWRNb2RpZmllcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgICAgX19kZWJ1Z19sb29wc19fICs9IDE7XG5cbiAgICAgICAgICAgIGlmIChfX2RlYnVnX2xvb3BzX18gPiAxMDApIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihJTkZJTklURV9MT09QX0VSUk9SKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHN0YXRlLnJlc2V0ID09PSB0cnVlKSB7XG4gICAgICAgICAgICBzdGF0ZS5yZXNldCA9IGZhbHNlO1xuICAgICAgICAgICAgaW5kZXggPSAtMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBfc3RhdGUkb3JkZXJlZE1vZGlmaWUgPSBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzW2luZGV4XSxcbiAgICAgICAgICAgICAgZm4gPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUuZm4sXG4gICAgICAgICAgICAgIF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUub3B0aW9ucyxcbiAgICAgICAgICAgICAgX29wdGlvbnMgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUyID09PSB2b2lkIDAgPyB7fSA6IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIsXG4gICAgICAgICAgICAgIG5hbWUgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUubmFtZTtcblxuICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHN0YXRlID0gZm4oe1xuICAgICAgICAgICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICAgIG9wdGlvbnM6IF9vcHRpb25zLFxuICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2VcbiAgICAgICAgICAgIH0pIHx8IHN0YXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIEFzeW5jIGFuZCBvcHRpbWlzdGljYWxseSBvcHRpbWl6ZWQgdXBkYXRlIFx1MjAxMyBpdCB3aWxsIG5vdCBiZSBleGVjdXRlZCBpZlxuICAgICAgLy8gbm90IG5lY2Vzc2FyeSAoZGVib3VuY2VkIHRvIHJ1biBhdCBtb3N0IG9uY2UtcGVyLXRpY2spXG4gICAgICB1cGRhdGU6IGRlYm91bmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgaW5zdGFuY2UuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgICByZXNvbHZlKHN0YXRlKTtcbiAgICAgICAgfSk7XG4gICAgICB9KSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgaXNEZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoIWFyZVZhbGlkRWxlbWVudHMocmVmZXJlbmNlLCBwb3BwZXIpKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoSU5WQUxJRF9FTEVNRU5UX0VSUk9SKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH1cblxuICAgIGluc3RhbmNlLnNldE9wdGlvbnMob3B0aW9ucykudGhlbihmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIGlmICghaXNEZXN0cm95ZWQgJiYgb3B0aW9ucy5vbkZpcnN0VXBkYXRlKSB7XG4gICAgICAgIG9wdGlvbnMub25GaXJzdFVwZGF0ZShzdGF0ZSk7XG4gICAgICB9XG4gICAgfSk7IC8vIE1vZGlmaWVycyBoYXZlIHRoZSBhYmlsaXR5IHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgYmVmb3JlIHRoZSBmaXJzdFxuICAgIC8vIHVwZGF0ZSBjeWNsZSBydW5zLiBUaGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlIHVwZGF0ZVxuICAgIC8vIGN5Y2xlLiBUaGlzIGlzIHVzZWZ1bCB3aGVuIGEgbW9kaWZpZXIgYWRkcyBzb21lIHBlcnNpc3RlbnQgZGF0YSB0aGF0XG4gICAgLy8gb3RoZXIgbW9kaWZpZXJzIG5lZWQgdG8gdXNlLCBidXQgdGhlIG1vZGlmaWVyIGlzIHJ1biBhZnRlciB0aGUgZGVwZW5kZW50XG4gICAgLy8gb25lLlxuXG4gICAgZnVuY3Rpb24gcnVuTW9kaWZpZXJFZmZlY3RzKCkge1xuICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgICB2YXIgbmFtZSA9IF9yZWYzLm5hbWUsXG4gICAgICAgICAgICBfcmVmMyRvcHRpb25zID0gX3JlZjMub3B0aW9ucyxcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfcmVmMyRvcHRpb25zID09PSB2b2lkIDAgPyB7fSA6IF9yZWYzJG9wdGlvbnMsXG4gICAgICAgICAgICBlZmZlY3QgPSBfcmVmMy5lZmZlY3Q7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBlZmZlY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICB2YXIgY2xlYW51cEZuID0gZWZmZWN0KHtcbiAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2UsXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgbm9vcEZuID0gZnVuY3Rpb24gbm9vcEZuKCkge307XG5cbiAgICAgICAgICBlZmZlY3RDbGVhbnVwRm5zLnB1c2goY2xlYW51cEZuIHx8IG5vb3BGbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKSB7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zLmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHJldHVybiBmbigpO1xuICAgICAgfSk7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zID0gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9O1xufVxuZXhwb3J0IHZhciBjcmVhdGVQb3BwZXIgPSAvKiNfX1BVUkVfXyovcG9wcGVyR2VuZXJhdG9yKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgZGV0ZWN0T3ZlcmZsb3cgfTsiLCAiaW1wb3J0IHsgcG9wcGVyR2VuZXJhdG9yLCBkZXRlY3RPdmVyZmxvdyB9IGZyb20gXCIuL2NyZWF0ZVBvcHBlci5qc1wiO1xuaW1wb3J0IGV2ZW50TGlzdGVuZXJzIGZyb20gXCIuL21vZGlmaWVycy9ldmVudExpc3RlbmVycy5qc1wiO1xuaW1wb3J0IHBvcHBlck9mZnNldHMgZnJvbSBcIi4vbW9kaWZpZXJzL3BvcHBlck9mZnNldHMuanNcIjtcbmltcG9ydCBjb21wdXRlU3R5bGVzIGZyb20gXCIuL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzXCI7XG5pbXBvcnQgYXBwbHlTdHlsZXMgZnJvbSBcIi4vbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzXCI7XG5pbXBvcnQgb2Zmc2V0IGZyb20gXCIuL21vZGlmaWVycy9vZmZzZXQuanNcIjtcbmltcG9ydCBmbGlwIGZyb20gXCIuL21vZGlmaWVycy9mbGlwLmpzXCI7XG5pbXBvcnQgcHJldmVudE92ZXJmbG93IGZyb20gXCIuL21vZGlmaWVycy9wcmV2ZW50T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBhcnJvdyBmcm9tIFwiLi9tb2RpZmllcnMvYXJyb3cuanNcIjtcbmltcG9ydCBoaWRlIGZyb20gXCIuL21vZGlmaWVycy9oaWRlLmpzXCI7XG52YXIgZGVmYXVsdE1vZGlmaWVycyA9IFtldmVudExpc3RlbmVycywgcG9wcGVyT2Zmc2V0cywgY29tcHV0ZVN0eWxlcywgYXBwbHlTdHlsZXMsIG9mZnNldCwgZmxpcCwgcHJldmVudE92ZXJmbG93LCBhcnJvdywgaGlkZV07XG52YXIgY3JlYXRlUG9wcGVyID0gLyojX19QVVJFX18qL3BvcHBlckdlbmVyYXRvcih7XG4gIGRlZmF1bHRNb2RpZmllcnM6IGRlZmF1bHRNb2RpZmllcnNcbn0pOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciwgcG9wcGVyR2VuZXJhdG9yLCBkZWZhdWx0TW9kaWZpZXJzLCBkZXRlY3RPdmVyZmxvdyB9OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciBhcyBjcmVhdGVQb3BwZXJMaXRlIH0gZnJvbSBcIi4vcG9wcGVyLWxpdGUuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgKiBmcm9tIFwiLi9tb2RpZmllcnMvaW5kZXguanNcIjsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgc2V0SWNvbiwgVGV4dENvbXBvbmVudCwgVEZpbGUsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL1NlbGVjdE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcIi4vQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIjtcbmltcG9ydCB7IFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ3ljbGVGaWVsZCBleHRlbmRzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQge1xuXG4gICAgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD4gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLkN5Y2xlKVxuICAgICAgICB0aGlzLnNob3dNb2RhbE9wdGlvbiA9IGZhbHNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCBhbGxvd051bGxWYWx1ZUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGFsbG93TnVsbFZhbHVlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiBcIkN5Y2xlIGJlZ2lucyBieSBhIG51bGwgdmFsdWVcIiB9KTtcbiAgICAgICAgYWxsb3dOdWxsVmFsdWVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICBjb25zdCBhbGxvd051bGxUb2dnbGVyID0gbmV3IFRvZ2dsZUNvbXBvbmVudChhbGxvd051bGxWYWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIGFsbG93TnVsbFRvZ2dsZXIuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmFsbG93TnVsbCB8fCBmYWxzZSk7XG4gICAgICAgIGFsbG93TnVsbFRvZ2dsZXIub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5maWVsZC5vcHRpb25zLmFsbG93TnVsbCA9IHZhbHVlKTtcbiAgICAgICAgc3VwZXIuY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihjb250YWluZXIsIHBsdWdpbiwgbG9jYXRpb24pO1xuICAgIH1cblxuICAgIHB1YmxpYyBuZXh0T3B0aW9uKHJhd1ZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgbmV4dE9wdGlvbjogc3RyaW5nO1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLmdldE9wdGlvbnNMaXN0KCk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gIXJhd1ZhbHVlID8gXCJcIiA6IHJhd1ZhbHVlXG4gICAgICAgIGlmICh2YWx1ZXMuaW5kZXhPZih2YWx1ZSkgPT09IC0xKSB7XG4gICAgICAgICAgICBuZXh0T3B0aW9uID0gdmFsdWVzWzBdIHx8IFwiXCJcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5leHRPcHRpb24gPSB2YWx1ZXNbKHZhbHVlcy5pbmRleE9mKHZhbHVlKSArIDEpICUgdmFsdWVzLmxlbmd0aF1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV4dE9wdGlvblxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zTGlzdCgpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuYWxsb3dOdWxsID8gW1wiXCIsIC4uLnN1cGVyLmdldE9wdGlvbnNMaXN0KCldIDogc3VwZXIuZ2V0T3B0aW9uc0xpc3QoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFJhd09wdGlvbkZyb21EdXJhdGlvbihkdXJhdGlvbjogYW55KTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IG1hdGNoZWRWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZHZBcGkgJiYgZHZBcGkudmFsdWUuaXNEdXJhdGlvbihkdXJhdGlvbikpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0T3B0aW9uc0xpc3QoKS5mb3JFYWNoKG9wdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZHZPcHRpb24gPSBkdkFwaS5kdXJhdGlvbihvcHRpb24pO1xuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhkdXJhdGlvbi52YWx1ZXMpLmV2ZXJ5KGogPT5cbiAgICAgICAgICAgICAgICAgICAgKCFkdXJhdGlvbi52YWx1ZXNbal0gJiYgIWR2T3B0aW9uLnZhbHVlc1tqXSkgfHwgKGR1cmF0aW9uLnZhbHVlc1tqXSA9PT0gZHZPcHRpb24udmFsdWVzW2pdKVxuICAgICAgICAgICAgICAgICkpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFZhbHVlID0gb3B0aW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0Y2hlZFZhbHVlXG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2tlZD86ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IHZhbHVlVGV4dDogc3RyaW5nO1xuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZHZBcGkucGFnZShmaWxlLnBhdGgpW2ZpZWxkTmFtZV0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogdmFsdWVUZXh0ID0gXCJcIjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBudWxsOiB2YWx1ZVRleHQgPSBcIlwiOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGZhbHNlOiB2YWx1ZVRleHQgPSBcImZhbHNlXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMDogdmFsdWVUZXh0ID0gXCIwXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHZhbHVlVGV4dCA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWVUZXh0ID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdGhpcy5nZXRSYXdPcHRpb25Gcm9tRHVyYXRpb24odmFsdWVUZXh0KSB8fCB2YWx1ZVRleHQgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgbmV4dChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGxldCBtYXRjaGVkVmFsdWUgPSB0aGlzLmdldFJhd09wdGlvbkZyb21EdXJhdGlvbih2YWx1ZSkgfHwgdmFsdWU7XG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IG5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IHRoaXMubmV4dE9wdGlvbihtYXRjaGVkVmFsdWUpLnRvU3RyaW5nKCkgfSB9XSwgZmlsZSlcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgLy8gZGF0YXZpZXcgaXMgY29udmVydGluZyBzdHJpbmdzIHRvIGR1cmF0aW9uLCBsZXQncyBmaW5kIGJhY2sgdGhlIHJhdyBzdHJpbmcgb3B0aW9uIGZyb20gZHVyYXRpb24gaWYgbmVlZGVkXG4gICAgICAgIGxldCBtYXRjaGVkVmFsdWUgPSB0aGlzLmdldFJhd09wdGlvbkZyb21EdXJhdGlvbih2YWx1ZSkgfHwgdmFsdWU7XG4gICAgICAgIGNvbnN0IGljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5DeWNsZV07XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IGFzeW5jICgpID0+IHRoaXMubmV4dChuYW1lLCB2YWx1ZSwgZmlsZSk7XG4gICAgICAgIGlmIChDeWNsZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGAke25hbWV9IDogJHttYXRjaGVkVmFsdWV9IFx1MjVCNyAke3RoaXMubmV4dE9wdGlvbihtYXRjaGVkVmFsdWUpfWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihpY29uTmFtZSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChDeWNsZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGAke25hbWV9XyR7bWF0Y2hlZFZhbHVlfV8ke3RoaXMubmV4dE9wdGlvbihtYXRjaGVkVmFsdWUpfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj48Yj4ke25hbWV9PC9iPiA6ICR7bWF0Y2hlZFZhbHVlfSBcdTI1QjcgJHt0aGlzLm5leHRPcHRpb24obWF0Y2hlZFZhbHVlKX08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBpY29uTmFtZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmIChDeWNsZUZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKGljb25OYW1lLCBhY3Rpb24sIGAke21hdGNoZWRWYWx1ZX0gXHUyNUI3ICR7dGhpcy5uZXh0T3B0aW9uKG1hdGNoZWRWYWx1ZSl9YCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBhZnRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFzTGlzdD86IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudD86IGJvb2xlYW5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdmFsdWUgfHwgXCJcIiwgdGhpcy5maWVsZCwgbGluZU51bWJlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNlbGVjdCBvcHRpb24gZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM6IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT4gfSA9IHt9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGF0dHJzLmNscyA9IFwidmFsdWUtY29udGFpbmVyXCJcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKSlcbiAgICAgICAgY29uc3QgbmV4dE9wdGlvbiA9IHRoaXMubmV4dE9wdGlvbihwW3RoaXMuZmllbGQubmFtZV0pXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGN5Y2xlQnRuID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihjeWNsZUJ0biwgRmllbGRJY29uW0ZpZWxkVHlwZS5DeWNsZV0pXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBjeWNsZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY3ljbGVCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGN5Y2xlQnRuLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogYnV0dG9uIG9uIGNsaWNrIDogZ28gdG8gbmV4dCB2ZXJzaW9uKi9cbiAgICAgICAgY3ljbGVCdG4ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBDeWNsZUZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIG5leHRPcHRpb24pO1xuICAgICAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgICAgICBjeWNsZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgc2V0SWNvbiwgVGV4dENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IE11bHRpU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL011bHRpU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwiLi9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUZpZWxkIGV4dGVuZHMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCB7XG5cbiAgICB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTXVsdGkpXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE11bHRpU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlc1wiKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChNdWx0aUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE11bHRpRmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChNdWx0aUZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBhZnRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFzTGlzdD86IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudD86IGJvb2xlYW5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBNdWx0aVNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IG9wdGlvbnMgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM6IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSA9IHt9XG4gICAgKTogdm9pZCB7XG5cbiAgICAgICAgbGV0IHZhbHVlSG92ZXJlZCA9IGZhbHNlO1xuICAgICAgICBsZXQgY3VycmVudFZhbHVlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgaWYgKHBbdGhpcy5maWVsZC5uYW1lXSkge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHBbdGhpcy5maWVsZC5uYW1lXSkuaW5jbHVkZXMoXCJwYXRoXCIpKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlcyA9IFtgW1ske3BbdGhpcy5maWVsZC5uYW1lXS5wYXRoLnJlcGxhY2UoXCIubWRcIiwgXCJcIil9XV1gXVxuICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBwW3RoaXMuZmllbGQubmFtZV0uZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhpdGVtKS5pbmNsdWRlcyhcInBhdGhcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZXMucHVzaChgW1ske2l0ZW0ucGF0aC5yZXBsYWNlKFwiLm1kXCIsIFwiXCIpfV1dYClcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZXMucHVzaChpdGVtLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZXMgPSBwW3RoaXMuZmllbGQubmFtZV0/LnNwbGl0KFwiLFwiKS5tYXAoKHY6IHN0cmluZykgPT4gdi50cmltKCkpIHx8IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogTXVsdGlTZWxlY3RNb2RhbDtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgTXVsdGlTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogY3VycmVudCB2YWx1ZXMgY29udGFpbmVyICovXG4gICAgICAgIGNvbnN0IHZhbHVlc0NvbnRhaW5lciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2YWx1ZXMtY29udGFpbmVyXCIgfSlcblxuICAgICAgICAvKiBjdXJyZW50IHZhbHVlcyAqL1xuICAgICAgICBjdXJyZW50VmFsdWVzLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZUNvbnRhaW5lciA9IHZhbHVlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbS1jb250YWluZXJcIiB9KTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlUmVtb3ZlQnRuID0gdmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZUxhYmVsID0gdmFsdWVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImxhYmVsXCIsIHRleHQ6IHYgfSlcbiAgICAgICAgICAgIHNldEljb24odmFsdWVSZW1vdmVCdG4sIFwiY3Jvc3NcIilcbiAgICAgICAgICAgIHZhbHVlUmVtb3ZlQnRuLmhpZGUoKTtcbiAgICAgICAgICAgIHZhbHVlUmVtb3ZlQnRuLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVtYWluaW5nVmFsdWVzID0gY3VycmVudFZhbHVlcy5maWx0ZXIoY1YgPT4gY1YgIT09IHYpLmpvaW4oXCIsIFwiKVxuICAgICAgICAgICAgICAgIE11bHRpRmllbGQucmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgcC5maWxlLnBhdGgsIHRoaXMuZmllbGQubmFtZSwgcmVtYWluaW5nVmFsdWVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFsdWVIb3ZlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwuYWRkQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2YWx1ZUhvdmVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2luZ2xlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwucmVtb3ZlQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pXG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgYWRkQnRuID0gdmFsdWVzQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGFkZEJ0biwgXCJsaXN0LXBsdXNcIik7XG5cbiAgICAgICAgYWRkQnRuLm9uY2xpY2sgPSAoKSA9PiBmaWVsZE1vZGFsLm9wZW4oKTtcblxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNpbmdsZVNwYWNlciA9IHZhbHVlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyLTFcIiB9KTtcbiAgICAgICAgY29uc3QgZG91YmxlU3BhY2VyID0gdmFsdWVzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXItMlwiIH0pO1xuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYWRkQnRuLnNob3coKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGlmICghdmFsdWVIb3ZlcmVkKSBzaW5nbGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgZG91YmxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWwgc3RhdGUgKi9cbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICBkb3VibGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgYWRkQnRuLmhpZGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNpbmdsZVNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgYWRkQnRuLnNob3coKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBURmlsZSwgQnV0dG9uQ29tcG9uZW50LCBTdWdnZXN0TW9kYWwsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Fic3RyYWN0TGlzdEJhc2VkRmllbGRcIjtcbmltcG9ydCAqIGFzIHNlbGVjdFZhbHVlc1NvdXJjZSBmcm9tIFwic3JjL3R5cGVzL3NlbGVjdFZhbHVlc1NvdXJjZVR5cGVzXCJcbmltcG9ydCBGaWxlRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9GaWxlRmllbGRcIjtcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXVsdGlTdWdnZXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XG5cbiAgICBwcml2YXRlIHNlbGVjdGVkT3B0aW9uczogQXJyYXk8c3RyaW5nPjtcbiAgICBwcml2YXRlIGFkZEJ1dHRvbjogQnV0dG9uQ29tcG9uZW50O1xuICAgIHByaXZhdGUgcmVsb2FkQnV0dG9uOiBCdXR0b25Db21wb25lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIGluaXRpYWxPcHRpb25zOiBhbnksXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgaWYgKGluaXRpYWxPcHRpb25zKSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpbml0aWFsT3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICAgICAgICAgIGlmIChkdkFwaSAmJiBpbml0aWFsT3B0aW9ucy5zb21lKG8gPT4gZHZBcGkudmFsdWUuaXNMaW5rKG8pKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IGluaXRpYWxPcHRpb25zLm1hcChpdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdkFwaS52YWx1ZS5pc0xpbmsoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGl0ZW0ucGF0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IGluaXRpYWxPcHRpb25zLm1hcChpdGVtID0+IGl0ZW0udG9TdHJpbmcoKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiAoaW5pdGlhbE9wdGlvbnMpID09PSBcInN0cmluZ1wiICYmIGluaXRpYWxPcHRpb25zLnRvU3RyaW5nKCkuc3RhcnRzV2l0aChcIltbXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE9wdGlvbnMgPSBpbml0aWFsT3B0aW9ucy5zcGxpdChcIixcIikubWFwKGl0ZW0gPT4gaXRlbS50cmltKCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoaW5pdGlhbE9wdGlvbnMpLmluY2x1ZGVzKFwicGF0aFwiKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IFtgW1ske2luaXRpYWxPcHRpb25zLnBhdGgucmVwbGFjZShcIi5tZFwiLCBcIlwiKX1dXWBdXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgKGluaXRpYWxPcHRpb25zKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IGluaXRpYWxPcHRpb25zLnRvU3RyaW5nKCkucmVwbGFjZSgvXlxcWyguKilcXF0kLywgXCIkMVwiKS5zcGxpdChcIixcIikubWFwKGl0ZW0gPT4gaXRlbS50cmltKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5vbmtleWRvd24gPSBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09IFwiRW50ZXJcIiAmJiBlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICBjb25zdCB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJ2YWx1ZS1hZGQtbm90aWNlXCIgfSlcbiAgICAgICAgY29uc3Qgbm90aWNlID0gdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIuaGlkZSgpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmZpbmQoXCIucHJvbXB0XCIpLnByZXBlbmQodXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyKTtcblxuICAgICAgICBjb25zdCBpbnB1dENvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInN1Z2dlc3Rlci1pbnB1dFwiIH0pXG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuaW5wdXRFbClcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5maW5kKFwiLnByb21wdFwiKS5wcmVwZW5kKGlucHV0Q29udGFpbmVyKVxuXG5cbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KVxuICAgICAgICBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGluZm9Db250YWluZXIgPSBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImluZm9cIiB9KVxuICAgICAgICBpbmZvQ29udGFpbmVyLnNldFRleHQoXCJBbHQrRW50ZXIgdG8gc2F2ZVwiKVxuICAgICAgICAvLyBhZGRCdXR0b25cbiAgICAgICAgdGhpcy5hZGRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRJY29uKFwicGx1c1wiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkTmV3VmFsdWVUb1NldHRpbmdzKCk7XG4gICAgICAgICAgICBub3RpY2Uuc2V0VGV4dChgJHt0aGlzLmlucHV0RWwudmFsdWV9IGFkZGVkIHRvIHRoZSBmaWVsZCBzZXR0aW5nc1xcbmNsaWNrIG9uIHJlbG9hZGApXG4gICAgICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgICAgICB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIuc2hvdygpO1xuICAgICAgICB9KVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0VG9vbHRpcChcIkFkZCB0aGlzIHZhbHVlIHRvIHRoaXMgZmllbGQgc2V0dGluZ3NcIilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuaGlkZSgpO1xuICAgICAgICAvL3JlbG9hZCBidXR0b25cbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lcilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uc2V0SWNvbihcInJlZnJlc2gtY3dcIilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uc2V0Q3RhKClcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSAnJztcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy51cGRhdGVTdWdnZXN0aW9ucygpO1xuICAgICAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLy9jb25maXJtIGJ1dHRvblxuICAgICAgICBjb25zdCBjb25maXJtQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNvbmZpcm1CdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKVxuICAgICAgICBjb25maXJtQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXBsYWNlVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfSlcbiAgICAgICAgLy9jYW5jZWwgYnV0dG9uXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHsgdGhpcy5jbG9zZSgpOyB9KVxuICAgICAgICAvL2NsZWFyIHZhbHVlIGJ1dHRvblxuICAgICAgICBjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjbGVhckJ1dHRvbi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgY2xlYXJCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNsZWFyVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGNsZWFyQnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKFwiZGFuZ2VyXCIpXG4gICAgICAgIHRoaXMubW9kYWxFbC5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXIpXG4gICAgfVxuXG4gICAgYXN5bmMgYWRkTmV3VmFsdWVUb1NldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpPy5maWxlQ2xhc3NOYW1lXG4gICAgICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZSA9IGZpbGVDbGFzcz8uYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIGZpbGVDbGFzc0F0dHJpYnV0ZSkge1xuXG4gICAgICAgICAgICAgICAgbGV0IG5ld09wdGlvbnM6IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IFsuLi5maWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucywgbmV3VmFsdWVdXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdCBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zW2Ake09iamVjdC5rZXlzKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnZhbHVlc0xpc3QpLmxlbmd0aH1gXSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgdmFsdWVzRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZCh2YWx1ZXNGaWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeSh2YWx1ZXNGaWxlLCBgJHtyZXN1bHR9XFxuJHtuZXdWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnMgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9uc1tgJHtPYmplY3Qua2V5cyhmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucykubGVuZ3RoICsgMX1gXSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByZXNldEZpZWxkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKVxuICAgICAgICAgICAgaWYgKHByZXNldEZpZWxkPy5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHByZXNldEZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgdmFsdWVzRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkodmFsdWVzRmlsZSwgYCR7cmVzdWx0fVxcbiR7bmV3VmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChwcmVzZXRGaWVsZD8ub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nRmllbGQgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maW5kKHAgPT4gcC5pZCA9PSB0aGlzLmZpZWxkLmlkKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzTGlzdCA9IGN1cnJlbnRFeGlzdGluZ0ZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXNMaXN0W2Ake09iamVjdC5rZXlzKHZhbHVlc0xpc3QpLmxlbmd0aCArIDF9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZ1bGxJbmRleChcInZhbHVlQWRkXCIpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5wdXNoKG5ld1ZhbHVlKVxuICAgIH1cblxuICAgIGFzeW5jIHJlcGxhY2VWYWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLnNlbGVjdGVkT3B0aW9ucztcbiAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBvcHRpb25zLmpvaW4oXCIsIFwiKSB9IH1dLCB0aGlzLmZpbGUsIHRoaXMubGluZU51bWJlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KVxuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2xlYXJWYWx1ZXMoKSB7XG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogXCJcIiB9IH1dLCB0aGlzLmZpbGUsIHRoaXMubGluZU51bWJlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KVxuICAgIH1cblxuICAgIHJlbmRlclNlbGVjdGVkKCkge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlclxuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogSFRNTERpdkVsZW1lbnRbXSA9IGNob29zZXIuc3VnZ2VzdGlvbnNcbiAgICAgICAgY29uc3QgdmFsdWVzOiBzdHJpbmdbXSA9IGNob29zZXIudmFsdWVzXG4gICAgICAgIHN1Z2dlc3Rpb25zLmZvckVhY2goKHMsIGkpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkT3B0aW9ucy5pbmNsdWRlcyh2YWx1ZXNbaV0udG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgICAgICBzLmFkZENsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgICAgIGlmIChzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaWNvbi1jb250YWluZXJcIikubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHMuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihpY29uQ29udGFpbmVyLCBcImNoZWNrLWNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcy5yZW1vdmVDbGFzcyhcInZhbHVlLWNoZWNrZWRcIilcbiAgICAgICAgICAgICAgICBzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaWNvbi1jb250YWluZXJcIikuZm9yRWFjaChpY29uID0+IGljb24ucmVtb3ZlKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IGR2RmlsZTogYW55O1xuICAgICAgICBpZiAoZHZBcGkpIGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCkgYXMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFxuICAgICAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZE1hbmFnZXIuZ2V0T3B0aW9uc0xpc3QoZHZGaWxlKS5maWx0ZXIobyA9PiBvLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgIGlmICh0aGlzLmFkZEJ1dHRvbikge1xuICAgICAgICAgICAgKHZhbHVlcy5zb21lKHAgPT4gcCA9PT0gcXVlcnkpIHx8IHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlID09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0Zyb21EVlF1ZXJ5IHx8ICFxdWVyeSkgP1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuc2hvdygpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsdWVzXG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZSlcbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJ2YWx1ZS1jb250YWluZXJcIilcbiAgICAgICAgY29uc3Qgc3BhY2VyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE9wdGlvbnMuaW5jbHVkZXModmFsdWUudG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJpY29uLWNvbnRhaW5lclwiIH0pXG4gICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKClcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRPcHRpb25zLmluY2x1ZGVzKHZhbHVlLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5yZW1vdmUodmFsdWUudG9TdHJpbmcoKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zLnB1c2godmFsdWUudG9TdHJpbmcoKSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlclNlbGVjdGVkKClcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG5cbiAgICB9XG5cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgTm90aWNlLCBzZXRJY29uLCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IFNpbmdsZUZpbGVNb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvU2luZ2xlRmlsZU1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBkdlF1ZXJ5U3RyaW5nOiBUZXh0QXJlYUNvbXBvbmVudFxuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuRmlsZSlcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0RmlsZXMgPSAoY3VycmVudEZpbGU/OiBURmlsZSk6IFRGaWxlW10gPT4ge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgZ2V0UmVzdWx0cyA9IChhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgXCJjdXJyZW50XCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZ31gKSkoYXBpLCBhcGkucGFnZShjdXJyZW50RmlsZT8ucGF0aCkpXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFdyb25nIHF1ZXJ5IGZvciBmaWVsZCA8JHt0aGlzLmZpZWxkLm5hbWV9PlxcbmNoZWNrIHlvdXIgc2V0dGluZ3NgLCAzMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYXRhdmlldyA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVEYXRhdmlld0pzICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVJbmxpbmVEYXRhdmlld0pzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzUGF0aCA9IGdldFJlc3VsdHMoZGF0YXZpZXcuYXBpKS52YWx1ZXMubWFwKCh2OiBhbnkpID0+IHYuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZpbHRlcihmID0+IGZpbGVzUGF0aC5pbmNsdWRlcyhmLnBhdGgpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFNpbmdsZUZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUpXG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlNlbGVjdCB2YWx1ZVwiKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChGaWxlRmllbGQuaXNNZW51KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSAke25hbWV9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuRmlsZV0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoRmlsZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChGaWxlRmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSwgYWN0aW9uLCBgVXBkYXRlICR7bmFtZX0ncyB2YWx1ZWApO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBhZnRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFzTGlzdD86IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudD86IGJvb2xlYW5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBTaW5nbGVGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQ6ICgpID0+IHt9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClbZmllbGROYW1lXVxuICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLmNyZWF0ZUVsKCdhJywgeyB0ZXh0OiB2YWx1ZS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIikgfSk7XG4gICAgICAgICAgICAgICAgbGluay5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh2YWx1ZS5wYXRoLCBmaWxlLnBhdGgsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzOiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0gPSB7fVxuICAgICk6IHZvaWQge1xuICAgICAgICBhdHRycy5jbHMgPSBcInZhbHVlLWNvbnRhaW5lclwiXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycykpXG5cbiAgICAgICAgY29uc3Qgc2VhcmNoQnRuID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihzZWFyY2hCdG4sIEZpZWxkSWNvbltGaWVsZFR5cGUuRmlsZV0pXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInNwYWNlclwiIH0pXG5cbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogU2luZ2xlRmlsZU1vZGFsO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBTaW5nbGVGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbiB8fCB0cnVlKSB7XG4gICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uc2hvdygpXG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWxlQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IFF1ZXJ5IChvcHRpb25hbClcIiB9KTtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IGR2UXVlcnlTdHJpbmdUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5kdlF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgfSlcblxuXG4gICAgICAgIGNvbnN0IGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSlcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkFsaWFzXCIgfSk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJQZXJzb25hbGlzZSB0aGUgcmVuZGVyaW5nIG9mIHlvdXIgbGlua3MnIGFsaWFzZXMgd2l0aCBhIGZ1bmN0aW9uIHJldHVybmluZyBhIHN0cmluZyAoPHBhZ2U+IG9iamVjdCBpcyBhdmFpbGFibGUpXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcImNvZGVcIiwge1xuICAgICAgICAgICAgdGV4dDogYGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIDxmdW5jdGlvbiB1c2luZyBcInBhZ2VcIj47IH1gXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIgPSBjdXN0b21lUmVuZGVyaW5nVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgY29uc3QgY3VzdG9tUmVuZGVyaW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuc2V0UGxhY2Vob2xkZXIoXCJKYXZhc2NyaXB0IHN0cmluZywgXCIgK1xuICAgICAgICAgICAgXCJ0aGUgXFxcInBhZ2VcXFwiIChkYXRhdmlldyBwYWdlIHR5cGUpIHZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIilcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tUmVuZGVyaW5nKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2c3RhY2tlZFwiIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiU29ydGluZyBvcmRlclwiIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiUGVyc29uYWxpc2UgdGhlIHNvcnRpbmcgb3JkZXIgb2YgeW91ciBsaW5rcyB3aXRoIGEgaW5zdHJ1Y3Rpb24gdGFraW5nIDIgZmlsZXMgKGEsIGIpIGFuZCByZXR1cm5pbmcgLTEsIDAgb3IgMVwiLCBjbHM6ICdzdWItdGV4dCcgfSk7XG4gICAgICAgIGN1c3RvbVNvcnRpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IGAoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyYFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nQ29udGFpbmVyID0gY3VzdG9tU29ydGluZ1RvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgY3VzdG9tU29ydGluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChjdXN0b21Tb3J0aW5nQ29udGFpbmVyKTtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21Tb3J0aW5nLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21Tb3J0aW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFBsYWNlaG9sZGVyKFwiSmF2YXNjcmlwdCBpbnN0cnVjdGlvbiwgXCIgK1xuICAgICAgICAgICAgXCIoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyXFxuXCIgK1xuICAgICAgICAgICAgXCJleGFtcGxlIDEgKGFscGhhYmV0aWNhbCBvcmRlcik6IGEuYmFzZW5hbWUgPCBiLmJhc2VuYW1lID8gMSA6IC0xIFxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAyIChjcmVhdGlvbiB0aW1lIG5ld2VyIHRvIG9sZGVyKTogYi5zdGF0LmN0aW1lIC0gYi5zdGF0LmN0aW1lXCIpXG4gICAgICAgIGN1c3RvbVNvcnRpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tU29ydGluZyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlRmlsZUNvbnRhaW5lcihwYXJlbnRDb250YWluZXIpXG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nIHx8IFwiXCI7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICAgICAgICAvL3RvZG8gOiBtYW5hZ2UgYm90aCByYXcgbGlua3MgYW5kIGR2IExpbmsgb2JqZWN0c1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUsIEZ1enp5U3VnZ2VzdE1vZGFsLCBGdXp6eU1hdGNoLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpbGVGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0ZpbGVGaWVsZFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgcG9zdFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcG9zdFZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlRnV6enlTdWdnZXN0ZXIgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZEZpbGU/OiBURmlsZVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsVmFsdWVPYmplY3Q6IGFueSxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXT8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayhpbml0aWFsVmFsdWVPYmplY3QpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoaW5pdGlhbFZhbHVlT2JqZWN0LnBhdGgpXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkgdGhpcy5zZWxlY3RlZEZpbGUgPSBmaWxlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVEZpbGVbXSB7XG4gICAgICAgIGNvbnN0IHNvcnRpbmdNZXRob2QgPSBuZXcgRnVuY3Rpb24oXCJhXCIsIFwiYlwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmd9YCkgfHwgZnVuY3Rpb24gKGE6IFRGaWxlLCBiOiBURmlsZSkgeyByZXR1cm4gYS5iYXNlbmFtZSA8IGIuYmFzZW5hbWUgPyAtMSA6IDEgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZmlsZU1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVNYW5hZ2VyLmdldEZpbGVzKHRoaXMuZmlsZSkuc29ydChzb3J0aW5nTWV0aG9kKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBpdGVtLmJhc2VuYW1lO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IEZ1enp5TWF0Y2g8VEZpbGU+LCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbS13aXRoLWFkZC1vblwiIH0pO1xuICAgICAgICAgICAgc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgICAgIHRleHQ6IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh2YWx1ZS5pdGVtLnBhdGgpKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiYWRkLW9uXCIgfSlcbiAgICAgICAgICAgIGZpbGVQYXRoLnNldFRleHQodmFsdWUuaXRlbS5wYXRoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZS5pdGVtLmJhc2VuYW1lKVxuICAgICAgICB9XG4gICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY29udGFpbmVyXCIpXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGVsLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGaWxlPy5wYXRoID09PSB2YWx1ZS5pdGVtLnBhdGgpIHtcbiAgICAgICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJpY29uLWNvbnRhaW5lclwiIH0pXG4gICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKClcbiAgICB9XG5cbiAgICBhc3luYyBvbkNob29zZUl0ZW0oaXRlbTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IGFsaWFzOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChkdkFwaSAmJiB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nKSB7XG4gICAgICAgICAgICBhbGlhcyA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZShpdGVtLnBhdGgpKVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZhbHVlID0gRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGl0ZW0uYmFzZW5hbWUsIHVuZGVmaW5lZCwgYWxpYXMpXG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogdmFsdWUgfSB9XSwgdGhpcy5maWxlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudClcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIHNldEljb24sIFRleHRDb21wb25lbnQsIG1vbWVudCwgVEZpbGUsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRGF0ZU1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2ZpZWxkcy9EYXRlTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCBDeWNsZUZpZWxkIGZyb20gXCIuL0N5Y2xlRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGTSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgY29tcGFyZUR1cmF0aW9uIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IHsgcG9zdFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcG9zdFZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEYXRlRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHVibGljIGRlZmF1bHREYXRlRm9ybWF0OiBzdHJpbmcgPSBcIllZWVktTU0tRERcIlxuICAgIHByaXZhdGUgc2hpZnRCdG46IEhUTUxCdXR0b25FbGVtZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5EYXRlKTtcbiAgICAgICAgdGhpcy5zaG93TW9kYWxPcHRpb24gPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSk7XG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChgQ2hhbmdlIGRhdGUgZm9yIDwke25hbWV9PmApO1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaTtcbiAgICAgICAgY29uc3QgZGF0ZUljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5EYXRlXTtcbiAgICAgICAgY29uc3QgZGF0ZU1vZGFsQWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpO1xuICAgICAgICBjb25zdCBwID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IHNoaWZ0RGF0ZUFjdGlvbiA9ICgpID0+IHRoaXMuc2hpZnREYXRlKGR2QXBpLCBwLCBmaWxlKTtcbiAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyOiBEYXRlRmllbGQgPSBuZXcgRk1bdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgIGNvbnN0IFtjdXJyZW50U2hpZnRdOiBbc3RyaW5nIHwgdW5kZWZpbmVkLCBGaWVsZCB8IHVuZGVmaW5lZCwgc3RyaW5nIHwgdW5kZWZpbmVkXSA9IGZpZWxkTWFuYWdlci5zaGlmdER1cmF0aW9uKGZpbGUpO1xuICAgICAgICBpZiAoRGF0ZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKGRhdGVJY29uTmFtZSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGRhdGVNb2RhbEFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbCB8fCB0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZCAmJiBkdkFwaSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgU2hpZnQgPCR7bmFtZX0+ICR7Y3VycmVudFNoaWZ0fSBhaGVhZGApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJza2lwLWZvcndhcmRcIik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhzaGlmdERhdGVBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKERhdGVGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBkYXRlTW9kYWxBY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogZGF0ZUljb25OYW1lXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbCB8fCB0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZCAmJiBkdkFwaSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlNoaWZ0IDxiPiR7bmFtZX08L2I+ICR7Y3VycmVudFNoaWZ0fSBhaGVhZDwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IHNoaWZ0RGF0ZUFjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJza2lwLWZvcndhcmRcIlxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoRGF0ZUZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFwic2tpcC1mb3J3YXJkXCIsIHNoaWZ0RGF0ZUFjdGlvbiwgYFNoaWZ0ICR7bmFtZX0gYWhlYWQgYnkgJHtjdXJyZW50U2hpZnR9YCk7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oZGF0ZUljb25OYW1lLCBkYXRlTW9kYWxBY3Rpb24sIGBTZXQgJHtuYW1lfSdzIGRhdGVgKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLFxuICAgICAgICB2YWx1ZT86IHN0cmluZyxcbiAgICAgICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICAgICAgYWZ0ZXI/OiBib29sZWFuLFxuICAgICAgICBhc0xpc3Q/OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ/OiBib29sZWFuXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgZGF0ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVEYXRlQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdCkgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQgPSB0aGlzLmRlZmF1bHREYXRlRm9ybWF0XG4gICAgICAgIGlmICghdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmspIHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0SW5zZXJ0QXNMaW5rID0gXCJmYWxzZVwiXG4gICAgICAgIGNvbnN0IGRhdGVGb3JtYXRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBkYXRlRm9ybWF0Q29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGF0ZSBmb3JtYXRcIiwgY2xzOiAnbGFiZWwnIH0pXG4gICAgICAgIGNvbnN0IGRhdGVFeGFtcGxlID0gZGF0ZUZvcm1hdENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyBjbHM6ICdtb3JlLWluZm8nIH0pXG4gICAgICAgIGRhdGVGb3JtYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnc3BhY2VyJyB9KVxuICAgICAgICBjb25zdCBkYXRlRm9ybWF0SW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChkYXRlRm9ybWF0Q29udGFpbmVyKVxuICAgICAgICBkYXRlRm9ybWF0SW5wdXQuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQpXG4gICAgICAgIGRhdGVFeGFtcGxlLnNldFRleHQoYCR7bW9tZW50KCkuZm9ybWF0KGRhdGVGb3JtYXRJbnB1dC5nZXRWYWx1ZSgpKX1gKVxuICAgICAgICBkYXRlRm9ybWF0SW5wdXQub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0ID0gdmFsdWVcbiAgICAgICAgICAgIGRhdGVFeGFtcGxlLnNldFRleHQoYCR7bW9tZW50KCkuZm9ybWF0KHZhbHVlKX1gKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gaW5zZXJ0IGFzIGxpbmsgdG9nZ2xlclxuICAgICAgICBjb25zdCBkZWZhdWx0SW5zZXJ0QXNMaW5rQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgZGVmYXVsdEluc2VydEFzTGlua0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkluc2VydCBhcyBsaW5rIGJ5IGRlZmF1bHRcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBkZWZhdWx0SW5zZXJ0QXNMaW5rQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBkZWZhdWx0SW5zZXJ0QXNMaW5rID0gbmV3IFRvZ2dsZUNvbXBvbmVudChkZWZhdWx0SW5zZXJ0QXNMaW5rQ29udGFpbmVyKTtcbiAgICAgICAgZGVmYXVsdEluc2VydEFzTGluay5zZXRWYWx1ZShEYXRlRmllbGQuc3RyaW5nVG9Cb29sZWFuKHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0SW5zZXJ0QXNMaW5rKSlcbiAgICAgICAgZGVmYXVsdEluc2VydEFzTGluay5vbkNoYW5nZSgodmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0SW5zZXJ0QXNMaW5rID0gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9mb2xkZXIgcGF0aCBmb3IgbGlua1xuICAgICAgICBjb25zdCBkYXRlTGlua1BhdGhDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBkYXRlTGlua1BhdGhDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJMaW5rIHBhdGggKG9wdGlvbmFsKVwiLCBjbHM6ICdsYWJlbCcgfSlcbiAgICAgICAgZGF0ZUxpbmtQYXRoQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBkYXRlTGlua1BhdGhJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KGRhdGVMaW5rUGF0aENvbnRhaW5lcilcbiAgICAgICAgZGF0ZUxpbmtQYXRoSW5wdXQuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmxpbmtQYXRoKVxuICAgICAgICBkYXRlTGlua1BhdGhJbnB1dC5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmxpbmtQYXRoID0gdmFsdWUgKyAoKCF2YWx1ZS5lbmRzV2l0aChcIi9cIikgJiYgISF2YWx1ZS5sZW5ndGgpID8gXCIvXCIgOiBcIlwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc2hpZnQgaW50ZXJ2YWwgKHNob3VsZCBiZSBhIG51bWJlciBvciBhIGx1eG9uIGh1bWFuaXplZCBkdXJhdGlvbiAocmVxdWlyZXMgZGF0YXZpZXcpIC0+IHRvIGluY2x1ZGUgaW4gdmFsaWRhdGlvbilcbiAgICAgICAgY29uc3QgZGF0ZVNoaWZ0SW50ZXJ2YWxDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBkYXRlU2hpZnRJbnRlcnZhbENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRlZmluZSBhIHNoaWZ0IGludGVydmFsXCIsIGNsczogJ2xhYmVsJyB9KTtcbiAgICAgICAgZGF0ZVNoaWZ0SW50ZXJ2YWxDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGRhdGVTaGlmdEludGVydmFsID0gbmV3IFRleHRDb21wb25lbnQoZGF0ZVNoaWZ0SW50ZXJ2YWxDb250YWluZXIpO1xuICAgICAgICBkYXRlU2hpZnRJbnRlcnZhbC5zZXRQbGFjZWhvbGRlcihcImV4OiAxIG1vbnRoIDIgZGF5c1wiKVxuICAgICAgICBkYXRlU2hpZnRJbnRlcnZhbC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWwpXG4gICAgICAgIGRhdGVTaGlmdEludGVydmFsLm9uQ2hhbmdlKCh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsID0gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gaW50ZXJ2YWxzIGN5Y2xlIGZpZWxkIG5hbWVcbiAgICAgICAgY29uc3QgbmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIG5leHRTaGlmdEludGVydmFsRmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IFwiRmllbGQgY29udGFpbmluZyBzaGlmdCBpbnRlcnZhbHNcIixcbiAgICAgICAgICAgIGNsczogJ2xhYmVsJ1xuICAgICAgICB9KTtcbiAgICAgICAgbmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgbmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZCA9IG5ldyBUZXh0Q29tcG9uZW50KG5leHRTaGlmdEludGVydmFsRmllbGRDb250YWluZXIpO1xuICAgICAgICBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkKVxuICAgICAgICBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkLm9uQ2hhbmdlKCh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZCA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlRGF0ZUNvbnRhaW5lcihjb250YWluZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzaGlmdERhdGUoZHY6IGFueSwgcDogYW55LCBmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB7IGRhdGVGb3JtYXQsIGRlZmF1bHRJbnNlcnRBc0xpbmssIGxpbmtQYXRoIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnNcbiAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyOiBEYXRlRmllbGQgPSBuZXcgRk1bdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgIGNvbnN0IFtjdXJyZW50U2hpZnQsIG5leHRJbnRlcnZhbEZpZWxkLCBuZXh0U2hpZnRdOiBbc3RyaW5nIHwgdW5kZWZpbmVkLCBGaWVsZCB8IHVuZGVmaW5lZCwgc3RyaW5nIHwgdW5kZWZpbmVkXSA9IGZpZWxkTWFuYWdlci5zaGlmdER1cmF0aW9uKGZpbGUpO1xuICAgICAgICBjb25zdCBkdkRhdGUgPSBwW3RoaXMuZmllbGQubmFtZV1cbiAgICAgICAgLy9kYXRhdmlldyBpcyBjb252ZXJ0aW5nIGRhdGVzIHRvIGxpbmtzIG9yIGRhdGV0aW1lcywgbGV0J3Mgbm9ybWFsaXplXG4gICAgICAgIGNvbnN0IGN1cnJlbnREYXRlVmFsdWUgPSBkdi52YWx1ZS5pc0xpbmsoZHZEYXRlKSA/XG4gICAgICAgICAgICBkdkRhdGUucGF0aC5zcGxpdChcIi9cIikubGFzdCgpIDpcbiAgICAgICAgICAgIGR2LnZhbHVlLmlzRGF0ZShkdkRhdGUpID9cbiAgICAgICAgICAgICAgICBtb21lbnQoZHZEYXRlLnRvSlNEYXRlKCkpLmZvcm1hdChkYXRlRm9ybWF0KSA6XG4gICAgICAgICAgICAgICAgZHZEYXRlXG4gICAgICAgIGNvbnN0IGN1cnJlbnREdkRhdGUgPSBkdi5kYXRlKG1vbWVudChjdXJyZW50RGF0ZVZhbHVlLCBkYXRlRm9ybWF0KS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgbmV3RGF0ZSA9IGN1cnJlbnREdkRhdGUucGx1cyhkdi5kdXJhdGlvbihjdXJyZW50U2hpZnQgfHwgXCIxIGRheVwiKSk7XG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gbW9tZW50KG5ld0RhdGUudG9TdHJpbmcoKSkuZm9ybWF0KGRhdGVGb3JtYXQpXG4gICAgICAgIGlmIChuZXh0SW50ZXJ2YWxGaWVsZCAmJiBuZXh0U2hpZnQpIHtcbiAgICAgICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IG5leHRJbnRlcnZhbEZpZWxkLm5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IG5leHRTaGlmdCB9IH1dLCBmaWxlLnBhdGgpXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGlua0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rUGF0aCB8fCBcIlwiICsgbmV3VmFsdWUuZm9ybWF0KGRhdGVGb3JtYXQpLCBmaWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gRGF0ZUZpZWxkLnN0cmluZ1RvQm9vbGVhbihkZWZhdWx0SW5zZXJ0QXNMaW5rKSA/XG4gICAgICAgICAgICBgW1ske2xpbmtQYXRoIHx8IFwiXCJ9JHtuZXdWYWx1ZX0ke2xpbmtGaWxlID8gXCJ8XCIgKyBsaW5rRmlsZS5iYXNlbmFtZSA6IFwiXCJ9XV1gIDpcbiAgICAgICAgICAgIG5ld1ZhbHVlXG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogZm9ybWF0dGVkVmFsdWUgfSB9XSwgZmlsZSlcblxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyB9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpO1xuICAgICAgICBjb25zdCBkYXRlQnRuID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihkYXRlQnRuLCBGaWVsZEljb25bRmllbGRUeXBlLkRhdGVdKVxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXItMVwiIH0pXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWwgfHwgdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMuc2hpZnRCdG4gPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKVxuICAgICAgICAgICAgc2V0SWNvbih0aGlzLnNoaWZ0QnRuLCBcInNraXAtZm9yd2FyZFwiKVxuICAgICAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcInNwYWNlci0yXCIpXG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNwYWNlci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJzcGFjZXItMVwiKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgIGxldCBmaWVsZE1vZGFsOiBEYXRlTW9kYWw7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBpZiAocFt0aGlzLmZpZWxkLm5hbWVdICYmIHBbdGhpcy5maWVsZC5uYW1lXS5oYXNPd25Qcm9wZXJ0eShcInBhdGhcIikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRlRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICAgICAgICAgIGlmIChkYXRlRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGRhdGVGaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBEYXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIGRhdGVGaWxlLm5hbWUpXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBEYXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkucmVwbGFjZShcIi5tZFwiLCBcIlwiKSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBbdGhpcy5maWVsZC5uYW1lXSkge1xuICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBwW3RoaXMuZmllbGQubmFtZV0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBcIlwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc2hpZnRCdG4pIHRoaXMuc2hpZnRCdG4ub25jbGljayA9ICgpID0+IHsgdGhpcy5zaGlmdERhdGUoZHYsIHAsIGZpbGUpIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBmaWVsZE1vZGFsLm9uQ2xvc2UgPSAoKSA9PiB7IGZpZWxkTW9kYWwuY29udGVudEVsLmlubmVySFRNTCA9IFwiXCI7IH1cbiAgICAgICAgZGF0ZUJ0bi5vbmNsaWNrID0gKCkgPT4geyBmaWVsZE1vZGFsLm9wZW4oKSB9XG5cbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIGRhdGVCdG4uaGlkZSgpXG4gICAgICAgICAgICBpZiAodGhpcy5zaGlmdEJ0bikgdGhpcy5zaGlmdEJ0bi5oaWRlKClcbiAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRhdGVCdG4uc2hvdygpXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hpZnRCdG4pIHRoaXMuc2hpZnRCdG4uc2hvdygpXG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBkYXRlQnRuLmhpZGUoKVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNoaWZ0QnRuKSB0aGlzLnNoaWZ0QnRuLmhpZGUoKVxuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWwgc3RhdGUgKi9cbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRhdGVCdG4pO1xuICAgICAgICBpZiAodGhpcy5zaGlmdEJ0bikgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5zaGlmdEJ0bik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcik7XG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0O1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQ6ICgpID0+IHt9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClbZmllbGROYW1lXVxuICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzRGF0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogbW9tZW50KHZhbHVlLnRvSlNEYXRlKCkpLmZvcm1hdCh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdCkgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGR2QXBpLnZhbHVlLmlzTGluayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLmNyZWF0ZUVsKCdhJywgeyB0ZXh0OiB2YWx1ZS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIikgfSlcbiAgICAgICAgICAgICAgICBsaW5rLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHZhbHVlLnBhdGgsIGZpbGUucGF0aCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2tlZCgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdmFsdWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7fSk7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAodmFsdWUpID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpLnNwbGl0KFwifFwiKS5maXJzdCgpPy5zcGxpdChcIi9cIikubGFzdCgpLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdFxuICAgICAgICAgICAgICAgICkuaXNWYWxpZCgpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQoXG4gICAgICAgICAgICAgICAgICAgICh2YWx1ZSBhcyB7IHBhdGg6IHN0cmluZyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBhdGgucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpLnNwbGl0KFwifFwiKS5maXJzdCgpPy5zcGxpdChcIi9cIikubGFzdCgpLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdFxuICAgICAgICAgICAgICAgICkuaXNWYWxpZCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc2hpZnREdXJhdGlvbihmaWxlOiBURmlsZSk6IFtzdHJpbmcgfCB1bmRlZmluZWQsIEZpZWxkIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbFxuICAgICAgICAgICAgY29uc3QgY3ljbGVJbnRlcnZhbEZpZWxkID0gdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGRcbiAgICAgICAgICAgIGNvbnN0IGN5Y2xlID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSBjeWNsZUludGVydmFsRmllbGQpXG4gICAgICAgICAgICBpZiAoY3ljbGUpIHtcbiAgICAgICAgICAgICAgICAvL2N5Y2xlIGZpZWxkIGV4aXN0c1xuICAgICAgICAgICAgICAgIGNvbnN0IGN5Y2xlTWFuYWdlcjogQ3ljbGVGaWVsZCA9IG5ldyBGTVtjeWNsZS50eXBlXSh0aGlzLnBsdWdpbiwgY3ljbGUpXG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IGN5Y2xlTWFuYWdlci5nZXRPcHRpb25zTGlzdCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtjeWNsZS5uYW1lXVxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jdXJyZW50IHZhbHVlIGlzIG5vdCBudWxsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZVN0cmluZyA9IG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIobyA9PiBkdkFwaS5kdXJhdGlvbihvKSAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKG8gPT4gY29tcGFyZUR1cmF0aW9uKGR2QXBpLmR1cmF0aW9uKG8pLCBjdXJyZW50VmFsdWUpKVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2N1cnJlbnQgdmFsdWUgaGFzIGEgbWF0Y2ggaW4gY3ljbGUgb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFZhbHVlID0gY3ljbGVNYW5hZ2VyLm5leHRPcHRpb24oY3VycmVudFZhbHVlU3RyaW5nKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtjdXJyZW50VmFsdWVTdHJpbmcsIGN5Y2xlLCBuZXh0VmFsdWVdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9jdXJyZW50IHZhbHVlIGlzIG5vdCBmb3VuZCBvciA6IGZhbGwgYmFjayBvbiBmaXJzdCB2YWx1ZVxuICAgICAgICAgICAgICAgIHJldHVybiBbb3B0aW9uc1swXSwgY3ljbGUsIG9wdGlvbnNbMV0gfHwgb3B0aW9uc1swXV1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW50ZXJ2YWwgJiYgZHZBcGkuZHVyYXRpb24oaW50ZXJ2YWwpKSB7XG4gICAgICAgICAgICAgICAgLy9ubyBjeWNsZSBmaWVsZDogZmFsbCBiYWNrIG9uIGludGVydmFsIGlmIGV4aXN0c1xuICAgICAgICAgICAgICAgIHJldHVybiBbaW50ZXJ2YWwsIHVuZGVmaW5lZCwgdW5kZWZpbmVkXVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGR2IG5vdCBhdmFpbGFibGUgPT4gcmV0dXJuIHVuZGVmaW5lZCBjeWNsZSB2YWx1ZXNcbiAgICAgICAgcmV0dXJuIFt1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkXVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBUZXh0Q29tcG9uZW50LCBURmlsZSwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGTSB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgbW9tZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgZmxhdHBpY2tyIGZyb20gXCJmbGF0cGlja3JcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlLCBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBEYXRlRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9EYXRlRmllbGRcIjtcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIjtcbmltcG9ydCBCYXNlTW9kYWwgZnJvbSBcIi4uL2Jhc2VNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEYXRlTW9kYWwgZXh0ZW5kcyBCYXNlTW9kYWwge1xuXG4gICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nO1xuICAgIHByaXZhdGUgaW5zZXJ0QXNMaW5rOiBib29sZWFuO1xuICAgIHByaXZhdGUgaW5wdXRFbDogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIGVycm9yRmllbGQ6IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgZm9ybWF0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBuZXh0SW50ZXJ2YWxGaWVsZD86IEZpZWxkO1xuICAgIHByaXZhdGUgcHVzaE5leHRJbnRlcnZhbDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgY3VycmVudFNoaWZ0Pzogc3RyaW5nXG4gICAgcHJpdmF0ZSBuZXh0U2hpZnQ/OiBzdHJpbmdcbiAgICBwcml2YXRlIGRhdGVNYW5hZ2VyPzogRGF0ZUZpZWxkXG4gICAgcHJpdmF0ZSBkdkFwaT86IGFueVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgaW5pdGlhbFZhbHVlOiBzdHJpbmcsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4pO1xuICAgICAgICB0aGlzLmluaXRpYWxWYWx1ZSA9IGluaXRpYWxWYWx1ZSA/IGluaXRpYWxWYWx1ZS50b1N0cmluZygpLnJlcGxhY2UoL15cXFtcXFsvZywgXCJcIikucmVwbGFjZSgvXFxdXFxdJC9nLCBcIlwiKS5zcGxpdChcInxcIikuZmlyc3QoKT8uc3BsaXQoXCIvXCIpLmxhc3QoKSB8fCBcIlwiIDogXCJcIjtcbiAgICAgICAgdGhpcy5pbnNlcnRBc0xpbmsgPSBGTS5zdHJpbmdUb0Jvb2xlYW4odGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmsgfHwgXCJmYWxzZVwiKSB8fCBmYWxzZTtcbiAgICAgICAgdGhpcy5mb3JtYXQgPSB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdCB8fCB0aGlzLmZpZWxkLm9wdGlvbnMuZGVmYXVsdERhdGVGb3JtYXQ7XG4gICAgICAgIHRoaXMuZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0/LmFwaVxuICAgICAgICBpZiAodGhpcy5kdkFwaSkgdGhpcy5kYXRlTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLmluaXRpYWxWYWx1ZTtcblxuICAgIH07XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkRmllbGRzKGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5lcnJvckZpZWxkID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiZmllbGQtZXJyb3JcIiB9KTtcbiAgICAgICAgdGhpcy5lcnJvckZpZWxkLmhpZGUoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGFzeW5jIHNhdmUoZTogRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy9lLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGxldCBuZXdWYWx1ZTogbW9tZW50Lk1vbWVudDtcbiAgICAgICAgLy90cnkgbmF0dXJhbCBsYW5ndWFnZSBkYXRlXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5lbmFibGVkUGx1Z2lucy5oYXMoJ25sZGF0ZXMtb2JzaWRpYW4nKSkge1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5sZGF0ZXMgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zWydubGRhdGVzLW9ic2lkaWFuJ107XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBubGRhdGVzLnBhcnNlRGF0ZSh0aGlzLnZhbHVlKS5tb21lbnQ7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbW9tZW50KHRoaXMudmFsdWUsIHRoaXMuZm9ybWF0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gbW9tZW50KHRoaXMudmFsdWUsIHRoaXMuZm9ybWF0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3VmFsdWUuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5rUGF0aCA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHRoaXMuZmllbGQub3B0aW9ucy5saW5rUGF0aCB8fCBcIlwiICsgbmV3VmFsdWUuZm9ybWF0KHRoaXMuZm9ybWF0KSwgdGhpcy5maWxlLnBhdGgpXG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IHRoaXMuaW5zZXJ0QXNMaW5rID8gYFtbJHt0aGlzLmZpZWxkLm9wdGlvbnMubGlua1BhdGggfHwgXCJcIn0ke25ld1ZhbHVlLmZvcm1hdCh0aGlzLmZvcm1hdCl9JHtsaW5rUGF0aCA/IFwifFwiICsgbGlua1BhdGguYmFzZW5hbWUgOiBcIlwifV1dYCA6IG5ld1ZhbHVlLmZvcm1hdCh0aGlzLmZvcm1hdClcbiAgICAgICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogZm9ybWF0dGVkVmFsdWUgfSB9XSwgdGhpcy5maWxlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudClcbiAgICAgICAgICAgIGlmICh0aGlzLm5leHRJbnRlcnZhbEZpZWxkICYmIHRoaXMucHVzaE5leHRJbnRlcnZhbCAmJiB0aGlzLm5leHRTaGlmdCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMubmV4dEludGVydmFsRmllbGQhLm5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IHRoaXMubmV4dFNoaWZ0ISB9IH1dLCB0aGlzLmZpbGUucGF0aClcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBcIlwiIH0gfV0sIHRoaXMuZmlsZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmFmdGVyLCB0aGlzLmFzTGlzdCwgdGhpcy5hc0NvbW1lbnQpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yRmllbGQuc2hvdygpO1xuICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLnNldFRleHQoYHZhbHVlIG11c3QgYmUgYSB2YWxpZCBkYXRlYClcbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbC5pbnB1dEVsLmFkZENsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkRmllbGRzKGRhdGVGaWVsZHNDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XG5cbiAgICAgICAgdGhpcy5idWlsZElucHV0RWwoZGF0ZUZpZWxkc0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuYnVpbGRJbnNlcnRBc0xpbmtCdXR0b24oZGF0ZUZpZWxkc0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuYnVpbGRTYXZlQnRuKGRhdGVGaWVsZHNDb250YWluZXIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnNlcnRBc0xpbmtCdXR0b24oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCkge1xuICAgICAgICBjb25zdCBpbnNlcnRBc0xpbmtCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGNvbnN0IHNldExpbmtCdG5JY29uID0gKCkgPT4ge1xuICAgICAgICAgICAgaW5zZXJ0QXNMaW5rQnRuLnNldEljb24odGhpcy5pbnNlcnRBc0xpbmsgPyBcImxpbmtcIiA6IFwidW5saW5rXCIpO1xuICAgICAgICAgICAgaW5zZXJ0QXNMaW5rQnRuLnNldFRvb2x0aXAodGhpcy5pbnNlcnRBc0xpbmsgP1xuICAgICAgICAgICAgICAgIFwiQ2xpY2sgdG8gaW5zZXJ0IGRhdGUgYXMgdGV4dFwiIDpcbiAgICAgICAgICAgICAgICBcIkNsaWNrIHRvIGluc2VydCBkYXRlIGFzIGxpbmtcIlxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIHNldExpbmtCdG5JY29uKCk7XG4gICAgICAgIGluc2VydEFzTGlua0J0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaW5zZXJ0QXNMaW5rID0gIXRoaXMuaW5zZXJ0QXNMaW5rO1xuICAgICAgICAgICAgc2V0TGlua0J0bkljb24oKTtcbiAgICAgICAgfSlcblxuICAgIH1cblxuICAgIHByaXZhdGUgdG9nZ2xlQnV0dG9uKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50LCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGJ1dHRvbi5zZXREaXNhYmxlZCghIXZhbHVlKVxuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcImRpc2FibGVkXCIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidXR0b24uYnV0dG9uRWwucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZElucHV0RWwoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuXG4gICAgICAgIGlmICh0aGlzLmRhdGVNYW5hZ2VyKSBbdGhpcy5jdXJyZW50U2hpZnQsIHRoaXMubmV4dEludGVydmFsRmllbGQsIHRoaXMubmV4dFNoaWZ0XSA9IHRoaXMuZGF0ZU1hbmFnZXIuc2hpZnREdXJhdGlvbih0aGlzLmZpbGUpO1xuXG4gICAgICAgIHRoaXMuaW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5pbnB1dEVsLmZvY3VzKCk7XG5cbiAgICAgICAgdGhpcy5pbnB1dEVsLnNldFBsYWNlaG9sZGVyKFxuICAgICAgICAgICAgdGhpcy5pbml0aWFsVmFsdWUgP1xuICAgICAgICAgICAgICAgIG1vbWVudCh0aGlzLmluaXRpYWxWYWx1ZSwgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQpLmZvcm1hdCh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdClcbiAgICAgICAgICAgICAgICA6IFwiXCIpO1xuICAgICAgICB0aGlzLmlucHV0RWwub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLmlucHV0RWwucmVtb3ZlQ2xhc3MoXCJpcy1pbnZhbGlkXCIpXG4gICAgICAgICAgICB0aGlzLmVycm9yRmllbGQuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWVcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKHNoaWZ0RnJvbVRvZGF5QnRuLCB2YWx1ZSlcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNhbGVuZGFyRGlzcGxheUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKVxuICAgICAgICBjYWxlbmRhckRpc3BsYXlCdG4uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLkRhdGVdKVxuICAgICAgICBjYWxlbmRhckRpc3BsYXlCdG4uc2V0VG9vbHRpcChcIm9wZW4gZGF0ZSBwaWNrZXJcIilcbiAgICAgICAgY29uc3Qgc2hpZnRGcm9tVG9kYXlCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcilcbiAgICAgICAgc2hpZnRGcm9tVG9kYXlCdG4uc2V0SWNvbihcInNraXAtZm9yd2FyZFwiKVxuICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5zZXRUb29sdGlwKGBTaGlmdCAke3RoaXMuZmllbGQubmFtZX0gJHt0aGlzLmN1cnJlbnRTaGlmdCB8fCBcIjEgZGF5XCJ9IGFoZWFkYClcblxuICAgICAgICBjb25zdCBkYXRlUGlja2VyQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuXG4gICAgICAgIGNvbnN0IGRhdGVQaWNrZXIgPSBmbGF0cGlja3IoZGF0ZVBpY2tlckNvbnRhaW5lciwge1xuICAgICAgICAgICAgbG9jYWxlOiB7XG4gICAgICAgICAgICAgICAgZmlyc3REYXlPZldlZWs6IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0RGF5T2ZXZWVrXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVmYXVsdERhdGU6IG1vbWVudChEYXRlLm5vdygpKS5mb3JtYXQoXCJZWVlZLU1NLUREXCIpXG4gICAgICAgIH0pO1xuICAgICAgICBkYXRlUGlja2VyLmNvbmZpZy5vbkNoYW5nZS5wdXNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3RGF0ZSA9IG1vbWVudCh2YWx1ZS50b1N0cmluZygpKS5mb3JtYXQodGhpcy5mb3JtYXQpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLnNldFZhbHVlKG5ld0RhdGUpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ld0RhdGU7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbihzaGlmdEZyb21Ub2RheUJ0biwgdGhpcy52YWx1ZSlcbiAgICAgICAgfSlcblxuICAgICAgICBjYWxlbmRhckRpc3BsYXlCdG4ub25DbGljaygoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZGF0ZVBpY2tlci5zZXREYXRlKGRhdGVQaWNrZXIucGFyc2VEYXRlKHRoaXMuaW5wdXRFbC5nZXRWYWx1ZSgpKSB8fCBuZXcgRGF0ZSgpKVxuICAgICAgICAgICAgZGF0ZVBpY2tlci5vcGVuKCk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgc2hpZnRGcm9tVG9kYXlCdG4ub25DbGljayhhc3luYyAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudER2RGF0ZSA9IHRoaXMuZHZBcGkuZGF0ZShtb21lbnQodGhpcy5pbml0aWFsVmFsdWUsIHRoaXMuZm9ybWF0KS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0RhdGUgPSBjdXJyZW50RHZEYXRlLnBsdXModGhpcy5kdkFwaS5kdXJhdGlvbih0aGlzLmN1cnJlbnRTaGlmdCB8fCBcIjEgZGF5XCIpKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gbW9tZW50KG5ld0RhdGUudG9TdHJpbmcoKSkuZm9ybWF0KHRoaXMuZm9ybWF0KVxuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLnNldFZhbHVlKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMucHVzaE5leHRJbnRlcnZhbCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbihzaGlmdEZyb21Ub2RheUJ0biwgdGhpcy5pbnB1dEVsLmdldFZhbHVlKCkpXG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYgKCF0aGlzLmR2QXBpKSB7XG4gICAgICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5zZXREaXNhYmxlZCh0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuIiwgImV4cG9ydCB2YXIgSE9PS1MgPSBbXG4gICAgXCJvbkNoYW5nZVwiLFxuICAgIFwib25DbG9zZVwiLFxuICAgIFwib25EYXlDcmVhdGVcIixcbiAgICBcIm9uRGVzdHJveVwiLFxuICAgIFwib25LZXlEb3duXCIsXG4gICAgXCJvbk1vbnRoQ2hhbmdlXCIsXG4gICAgXCJvbk9wZW5cIixcbiAgICBcIm9uUGFyc2VDb25maWdcIixcbiAgICBcIm9uUmVhZHlcIixcbiAgICBcIm9uVmFsdWVVcGRhdGVcIixcbiAgICBcIm9uWWVhckNoYW5nZVwiLFxuICAgIFwib25QcmVDYWxlbmRhclBvc2l0aW9uXCIsXG5dO1xuZXhwb3J0IHZhciBkZWZhdWx0cyA9IHtcbiAgICBfZGlzYWJsZTogW10sXG4gICAgYWxsb3dJbnB1dDogZmFsc2UsXG4gICAgYWxsb3dJbnZhbGlkUHJlbG9hZDogZmFsc2UsXG4gICAgYWx0Rm9ybWF0OiBcIkYgaiwgWVwiLFxuICAgIGFsdElucHV0OiBmYWxzZSxcbiAgICBhbHRJbnB1dENsYXNzOiBcImZvcm0tY29udHJvbCBpbnB1dFwiLFxuICAgIGFuaW1hdGU6IHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUVcIikgPT09IC0xLFxuICAgIGFyaWFEYXRlRm9ybWF0OiBcIkYgaiwgWVwiLFxuICAgIGF1dG9GaWxsRGVmYXVsdFRpbWU6IHRydWUsXG4gICAgY2xpY2tPcGVuczogdHJ1ZSxcbiAgICBjbG9zZU9uU2VsZWN0OiB0cnVlLFxuICAgIGNvbmp1bmN0aW9uOiBcIiwgXCIsXG4gICAgZGF0ZUZvcm1hdDogXCJZLW0tZFwiLFxuICAgIGRlZmF1bHRIb3VyOiAxMixcbiAgICBkZWZhdWx0TWludXRlOiAwLFxuICAgIGRlZmF1bHRTZWNvbmRzOiAwLFxuICAgIGRpc2FibGU6IFtdLFxuICAgIGRpc2FibGVNb2JpbGU6IGZhbHNlLFxuICAgIGVuYWJsZVNlY29uZHM6IGZhbHNlLFxuICAgIGVuYWJsZVRpbWU6IGZhbHNlLFxuICAgIGVycm9ySGFuZGxlcjogZnVuY3Rpb24gKGVycikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGNvbnNvbGUgIT09IFwidW5kZWZpbmVkXCIgJiYgY29uc29sZS53YXJuKGVycik7XG4gICAgfSxcbiAgICBnZXRXZWVrOiBmdW5jdGlvbiAoZ2l2ZW5EYXRlKSB7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZ2l2ZW5EYXRlLmdldFRpbWUoKSk7XG4gICAgICAgIGRhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDMgLSAoKGRhdGUuZ2V0RGF5KCkgKyA2KSAlIDcpKTtcbiAgICAgICAgdmFyIHdlZWsxID0gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCAwLCA0KTtcbiAgICAgICAgcmV0dXJuICgxICtcbiAgICAgICAgICAgIE1hdGgucm91bmQoKChkYXRlLmdldFRpbWUoKSAtIHdlZWsxLmdldFRpbWUoKSkgLyA4NjQwMDAwMCAtXG4gICAgICAgICAgICAgICAgMyArXG4gICAgICAgICAgICAgICAgKCh3ZWVrMS5nZXREYXkoKSArIDYpICUgNykpIC9cbiAgICAgICAgICAgICAgICA3KSk7XG4gICAgfSxcbiAgICBob3VySW5jcmVtZW50OiAxLFxuICAgIGlnbm9yZWRGb2N1c0VsZW1lbnRzOiBbXSxcbiAgICBpbmxpbmU6IGZhbHNlLFxuICAgIGxvY2FsZTogXCJkZWZhdWx0XCIsXG4gICAgbWludXRlSW5jcmVtZW50OiA1LFxuICAgIG1vZGU6IFwic2luZ2xlXCIsXG4gICAgbW9udGhTZWxlY3RvclR5cGU6IFwiZHJvcGRvd25cIixcbiAgICBuZXh0QXJyb3c6IFwiPHN2ZyB2ZXJzaW9uPScxLjEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgeG1sbnM6eGxpbms9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnIHZpZXdCb3g9JzAgMCAxNyAxNyc+PGc+PC9nPjxwYXRoIGQ9J00xMy4yMDcgOC40NzJsLTcuODU0IDcuODU0LTAuNzA3LTAuNzA3IDcuMTQ2LTcuMTQ2LTcuMTQ2LTcuMTQ4IDAuNzA3LTAuNzA3IDcuODU0IDcuODU0eicgLz48L3N2Zz5cIixcbiAgICBub0NhbGVuZGFyOiBmYWxzZSxcbiAgICBub3c6IG5ldyBEYXRlKCksXG4gICAgb25DaGFuZ2U6IFtdLFxuICAgIG9uQ2xvc2U6IFtdLFxuICAgIG9uRGF5Q3JlYXRlOiBbXSxcbiAgICBvbkRlc3Ryb3k6IFtdLFxuICAgIG9uS2V5RG93bjogW10sXG4gICAgb25Nb250aENoYW5nZTogW10sXG4gICAgb25PcGVuOiBbXSxcbiAgICBvblBhcnNlQ29uZmlnOiBbXSxcbiAgICBvblJlYWR5OiBbXSxcbiAgICBvblZhbHVlVXBkYXRlOiBbXSxcbiAgICBvblllYXJDaGFuZ2U6IFtdLFxuICAgIG9uUHJlQ2FsZW5kYXJQb3NpdGlvbjogW10sXG4gICAgcGx1Z2luczogW10sXG4gICAgcG9zaXRpb246IFwiYXV0b1wiLFxuICAgIHBvc2l0aW9uRWxlbWVudDogdW5kZWZpbmVkLFxuICAgIHByZXZBcnJvdzogXCI8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgdmlld0JveD0nMCAwIDE3IDE3Jz48Zz48L2c+PHBhdGggZD0nTTUuMjA3IDguNDcxbDcuMTQ2IDcuMTQ3LTAuNzA3IDAuNzA3LTcuODUzLTcuODU0IDcuODU0LTcuODUzIDAuNzA3IDAuNzA3LTcuMTQ3IDcuMTQ2eicgLz48L3N2Zz5cIixcbiAgICBzaG9ydGhhbmRDdXJyZW50TW9udGg6IGZhbHNlLFxuICAgIHNob3dNb250aHM6IDEsXG4gICAgc3RhdGljOiBmYWxzZSxcbiAgICB0aW1lXzI0aHI6IGZhbHNlLFxuICAgIHdlZWtOdW1iZXJzOiBmYWxzZSxcbiAgICB3cmFwOiBmYWxzZSxcbn07XG4iLCAiZXhwb3J0IHZhciBlbmdsaXNoID0ge1xuICAgIHdlZWtkYXlzOiB7XG4gICAgICAgIHNob3J0aGFuZDogW1wiU3VuXCIsIFwiTW9uXCIsIFwiVHVlXCIsIFwiV2VkXCIsIFwiVGh1XCIsIFwiRnJpXCIsIFwiU2F0XCJdLFxuICAgICAgICBsb25naGFuZDogW1xuICAgICAgICAgICAgXCJTdW5kYXlcIixcbiAgICAgICAgICAgIFwiTW9uZGF5XCIsXG4gICAgICAgICAgICBcIlR1ZXNkYXlcIixcbiAgICAgICAgICAgIFwiV2VkbmVzZGF5XCIsXG4gICAgICAgICAgICBcIlRodXJzZGF5XCIsXG4gICAgICAgICAgICBcIkZyaWRheVwiLFxuICAgICAgICAgICAgXCJTYXR1cmRheVwiLFxuICAgICAgICBdLFxuICAgIH0sXG4gICAgbW9udGhzOiB7XG4gICAgICAgIHNob3J0aGFuZDogW1xuICAgICAgICAgICAgXCJKYW5cIixcbiAgICAgICAgICAgIFwiRmViXCIsXG4gICAgICAgICAgICBcIk1hclwiLFxuICAgICAgICAgICAgXCJBcHJcIixcbiAgICAgICAgICAgIFwiTWF5XCIsXG4gICAgICAgICAgICBcIkp1blwiLFxuICAgICAgICAgICAgXCJKdWxcIixcbiAgICAgICAgICAgIFwiQXVnXCIsXG4gICAgICAgICAgICBcIlNlcFwiLFxuICAgICAgICAgICAgXCJPY3RcIixcbiAgICAgICAgICAgIFwiTm92XCIsXG4gICAgICAgICAgICBcIkRlY1wiLFxuICAgICAgICBdLFxuICAgICAgICBsb25naGFuZDogW1xuICAgICAgICAgICAgXCJKYW51YXJ5XCIsXG4gICAgICAgICAgICBcIkZlYnJ1YXJ5XCIsXG4gICAgICAgICAgICBcIk1hcmNoXCIsXG4gICAgICAgICAgICBcIkFwcmlsXCIsXG4gICAgICAgICAgICBcIk1heVwiLFxuICAgICAgICAgICAgXCJKdW5lXCIsXG4gICAgICAgICAgICBcIkp1bHlcIixcbiAgICAgICAgICAgIFwiQXVndXN0XCIsXG4gICAgICAgICAgICBcIlNlcHRlbWJlclwiLFxuICAgICAgICAgICAgXCJPY3RvYmVyXCIsXG4gICAgICAgICAgICBcIk5vdmVtYmVyXCIsXG4gICAgICAgICAgICBcIkRlY2VtYmVyXCIsXG4gICAgICAgIF0sXG4gICAgfSxcbiAgICBkYXlzSW5Nb250aDogWzMxLCAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdLFxuICAgIGZpcnN0RGF5T2ZXZWVrOiAwLFxuICAgIG9yZGluYWw6IGZ1bmN0aW9uIChudGgpIHtcbiAgICAgICAgdmFyIHMgPSBudGggJSAxMDA7XG4gICAgICAgIGlmIChzID4gMyAmJiBzIDwgMjEpXG4gICAgICAgICAgICByZXR1cm4gXCJ0aFwiO1xuICAgICAgICBzd2l0Y2ggKHMgJSAxMCkge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInN0XCI7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibmRcIjtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJyZFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ0aFwiO1xuICAgICAgICB9XG4gICAgfSxcbiAgICByYW5nZVNlcGFyYXRvcjogXCIgdG8gXCIsXG4gICAgd2Vla0FiYnJldmlhdGlvbjogXCJXa1wiLFxuICAgIHNjcm9sbFRpdGxlOiBcIlNjcm9sbCB0byBpbmNyZW1lbnRcIixcbiAgICB0b2dnbGVUaXRsZTogXCJDbGljayB0byB0b2dnbGVcIixcbiAgICBhbVBNOiBbXCJBTVwiLCBcIlBNXCJdLFxuICAgIHllYXJBcmlhTGFiZWw6IFwiWWVhclwiLFxuICAgIG1vbnRoQXJpYUxhYmVsOiBcIk1vbnRoXCIsXG4gICAgaG91ckFyaWFMYWJlbDogXCJIb3VyXCIsXG4gICAgbWludXRlQXJpYUxhYmVsOiBcIk1pbnV0ZVwiLFxuICAgIHRpbWVfMjRocjogZmFsc2UsXG59O1xuZXhwb3J0IGRlZmF1bHQgZW5nbGlzaDtcbiIsICJleHBvcnQgdmFyIHBhZCA9IGZ1bmN0aW9uIChudW1iZXIsIGxlbmd0aCkge1xuICAgIGlmIChsZW5ndGggPT09IHZvaWQgMCkgeyBsZW5ndGggPSAyOyB9XG4gICAgcmV0dXJuIChcIjAwMFwiICsgbnVtYmVyKS5zbGljZShsZW5ndGggKiAtMSk7XG59O1xuZXhwb3J0IHZhciBpbnQgPSBmdW5jdGlvbiAoYm9vbCkgeyByZXR1cm4gKGJvb2wgPT09IHRydWUgPyAxIDogMCk7IH07XG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2UoZm4sIHdhaXQpIHtcbiAgICB2YXIgdDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgY2xlYXJUaW1lb3V0KHQpO1xuICAgICAgICB0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBmbi5hcHBseShfdGhpcywgYXJncyk7IH0sIHdhaXQpO1xuICAgIH07XG59XG5leHBvcnQgdmFyIGFycmF5aWZ5ID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBBcnJheSA/IG9iaiA6IFtvYmpdO1xufTtcbiIsICJleHBvcnQgZnVuY3Rpb24gdG9nZ2xlQ2xhc3MoZWxlbSwgY2xhc3NOYW1lLCBib29sKSB7XG4gICAgaWYgKGJvb2wgPT09IHRydWUpXG4gICAgICAgIHJldHVybiBlbGVtLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KHRhZywgY2xhc3NOYW1lLCBjb250ZW50KSB7XG4gICAgdmFyIGUgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZSB8fCBcIlwiO1xuICAgIGNvbnRlbnQgPSBjb250ZW50IHx8IFwiXCI7XG4gICAgZS5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgZS50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgcmV0dXJuIGU7XG59XG5leHBvcnQgZnVuY3Rpb24gY2xlYXJOb2RlKG5vZGUpIHtcbiAgICB3aGlsZSAobm9kZS5maXJzdENoaWxkKVxuICAgICAgICBub2RlLnJlbW92ZUNoaWxkKG5vZGUuZmlyc3RDaGlsZCk7XG59XG5leHBvcnQgZnVuY3Rpb24gZmluZFBhcmVudChub2RlLCBjb25kaXRpb24pIHtcbiAgICBpZiAoY29uZGl0aW9uKG5vZGUpKVxuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICBlbHNlIGlmIChub2RlLnBhcmVudE5vZGUpXG4gICAgICAgIHJldHVybiBmaW5kUGFyZW50KG5vZGUucGFyZW50Tm9kZSwgY29uZGl0aW9uKTtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU51bWJlcklucHV0KGlucHV0Q2xhc3NOYW1lLCBvcHRzKSB7XG4gICAgdmFyIHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwibnVtSW5wdXRXcmFwcGVyXCIpLCBudW1JbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCBcIm51bUlucHV0IFwiICsgaW5wdXRDbGFzc05hbWUpLCBhcnJvd1VwID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJhcnJvd1VwXCIpLCBhcnJvd0Rvd24gPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImFycm93RG93blwiKTtcbiAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRSA5LjBcIikgPT09IC0xKSB7XG4gICAgICAgIG51bUlucHV0LnR5cGUgPSBcIm51bWJlclwiO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbnVtSW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICBudW1JbnB1dC5wYXR0ZXJuID0gXCJcXFxcZCpcIjtcbiAgICB9XG4gICAgaWYgKG9wdHMgIT09IHVuZGVmaW5lZClcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9wdHMpXG4gICAgICAgICAgICBudW1JbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBvcHRzW2tleV0pO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQobnVtSW5wdXQpO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoYXJyb3dVcCk7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChhcnJvd0Rvd24pO1xuICAgIHJldHVybiB3cmFwcGVyO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEV2ZW50VGFyZ2V0KGV2ZW50KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBldmVudC5jb21wb3NlZFBhdGggPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIHBhdGggPSBldmVudC5jb21wb3NlZFBhdGgoKTtcbiAgICAgICAgICAgIHJldHVybiBwYXRoWzBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudC50YXJnZXQ7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gZXZlbnQudGFyZ2V0O1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBpbnQsIHBhZCB9IGZyb20gXCIuLi91dGlsc1wiO1xudmFyIGRvTm90aGluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfTtcbmV4cG9ydCB2YXIgbW9udGhUb1N0ciA9IGZ1bmN0aW9uIChtb250aE51bWJlciwgc2hvcnRoYW5kLCBsb2NhbGUpIHsgcmV0dXJuIGxvY2FsZS5tb250aHNbc2hvcnRoYW5kID8gXCJzaG9ydGhhbmRcIiA6IFwibG9uZ2hhbmRcIl1bbW9udGhOdW1iZXJdOyB9O1xuZXhwb3J0IHZhciByZXZGb3JtYXQgPSB7XG4gICAgRDogZG9Ob3RoaW5nLFxuICAgIEY6IGZ1bmN0aW9uIChkYXRlT2JqLCBtb250aE5hbWUsIGxvY2FsZSkge1xuICAgICAgICBkYXRlT2JqLnNldE1vbnRoKGxvY2FsZS5tb250aHMubG9uZ2hhbmQuaW5kZXhPZihtb250aE5hbWUpKTtcbiAgICB9LFxuICAgIEc6IGZ1bmN0aW9uIChkYXRlT2JqLCBob3VyKSB7XG4gICAgICAgIGRhdGVPYmouc2V0SG91cnMoKGRhdGVPYmouZ2V0SG91cnMoKSA+PSAxMiA/IDEyIDogMCkgKyBwYXJzZUZsb2F0KGhvdXIpKTtcbiAgICB9LFxuICAgIEg6IGZ1bmN0aW9uIChkYXRlT2JqLCBob3VyKSB7XG4gICAgICAgIGRhdGVPYmouc2V0SG91cnMocGFyc2VGbG9hdChob3VyKSk7XG4gICAgfSxcbiAgICBKOiBmdW5jdGlvbiAoZGF0ZU9iaiwgZGF5KSB7XG4gICAgICAgIGRhdGVPYmouc2V0RGF0ZShwYXJzZUZsb2F0KGRheSkpO1xuICAgIH0sXG4gICAgSzogZnVuY3Rpb24gKGRhdGVPYmosIGFtUE0sIGxvY2FsZSkge1xuICAgICAgICBkYXRlT2JqLnNldEhvdXJzKChkYXRlT2JqLmdldEhvdXJzKCkgJSAxMikgK1xuICAgICAgICAgICAgMTIgKiBpbnQobmV3IFJlZ0V4cChsb2NhbGUuYW1QTVsxXSwgXCJpXCIpLnRlc3QoYW1QTSkpKTtcbiAgICB9LFxuICAgIE06IGZ1bmN0aW9uIChkYXRlT2JqLCBzaG9ydE1vbnRoLCBsb2NhbGUpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRNb250aChsb2NhbGUubW9udGhzLnNob3J0aGFuZC5pbmRleE9mKHNob3J0TW9udGgpKTtcbiAgICB9LFxuICAgIFM6IGZ1bmN0aW9uIChkYXRlT2JqLCBzZWNvbmRzKSB7XG4gICAgICAgIGRhdGVPYmouc2V0U2Vjb25kcyhwYXJzZUZsb2F0KHNlY29uZHMpKTtcbiAgICB9LFxuICAgIFU6IGZ1bmN0aW9uIChfLCB1bml4U2Vjb25kcykgeyByZXR1cm4gbmV3IERhdGUocGFyc2VGbG9hdCh1bml4U2Vjb25kcykgKiAxMDAwKTsgfSxcbiAgICBXOiBmdW5jdGlvbiAoZGF0ZU9iaiwgd2Vla051bSwgbG9jYWxlKSB7XG4gICAgICAgIHZhciB3ZWVrTnVtYmVyID0gcGFyc2VJbnQod2Vla051bSk7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZU9iai5nZXRGdWxsWWVhcigpLCAwLCAyICsgKHdlZWtOdW1iZXIgLSAxKSAqIDcsIDAsIDAsIDAsIDApO1xuICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSBkYXRlLmdldERheSgpICsgbG9jYWxlLmZpcnN0RGF5T2ZXZWVrKTtcbiAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgfSxcbiAgICBZOiBmdW5jdGlvbiAoZGF0ZU9iaiwgeWVhcikge1xuICAgICAgICBkYXRlT2JqLnNldEZ1bGxZZWFyKHBhcnNlRmxvYXQoeWVhcikpO1xuICAgIH0sXG4gICAgWjogZnVuY3Rpb24gKF8sIElTT0RhdGUpIHsgcmV0dXJuIG5ldyBEYXRlKElTT0RhdGUpOyB9LFxuICAgIGQ6IGZ1bmN0aW9uIChkYXRlT2JqLCBkYXkpIHtcbiAgICAgICAgZGF0ZU9iai5zZXREYXRlKHBhcnNlRmxvYXQoZGF5KSk7XG4gICAgfSxcbiAgICBoOiBmdW5jdGlvbiAoZGF0ZU9iaiwgaG91cikge1xuICAgICAgICBkYXRlT2JqLnNldEhvdXJzKChkYXRlT2JqLmdldEhvdXJzKCkgPj0gMTIgPyAxMiA6IDApICsgcGFyc2VGbG9hdChob3VyKSk7XG4gICAgfSxcbiAgICBpOiBmdW5jdGlvbiAoZGF0ZU9iaiwgbWludXRlcykge1xuICAgICAgICBkYXRlT2JqLnNldE1pbnV0ZXMocGFyc2VGbG9hdChtaW51dGVzKSk7XG4gICAgfSxcbiAgICBqOiBmdW5jdGlvbiAoZGF0ZU9iaiwgZGF5KSB7XG4gICAgICAgIGRhdGVPYmouc2V0RGF0ZShwYXJzZUZsb2F0KGRheSkpO1xuICAgIH0sXG4gICAgbDogZG9Ob3RoaW5nLFxuICAgIG06IGZ1bmN0aW9uIChkYXRlT2JqLCBtb250aCkge1xuICAgICAgICBkYXRlT2JqLnNldE1vbnRoKHBhcnNlRmxvYXQobW9udGgpIC0gMSk7XG4gICAgfSxcbiAgICBuOiBmdW5jdGlvbiAoZGF0ZU9iaiwgbW9udGgpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRNb250aChwYXJzZUZsb2F0KG1vbnRoKSAtIDEpO1xuICAgIH0sXG4gICAgczogZnVuY3Rpb24gKGRhdGVPYmosIHNlY29uZHMpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRTZWNvbmRzKHBhcnNlRmxvYXQoc2Vjb25kcykpO1xuICAgIH0sXG4gICAgdTogZnVuY3Rpb24gKF8sIHVuaXhNaWxsU2Vjb25kcykge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUocGFyc2VGbG9hdCh1bml4TWlsbFNlY29uZHMpKTtcbiAgICB9LFxuICAgIHc6IGRvTm90aGluZyxcbiAgICB5OiBmdW5jdGlvbiAoZGF0ZU9iaiwgeWVhcikge1xuICAgICAgICBkYXRlT2JqLnNldEZ1bGxZZWFyKDIwMDAgKyBwYXJzZUZsb2F0KHllYXIpKTtcbiAgICB9LFxufTtcbmV4cG9ydCB2YXIgdG9rZW5SZWdleCA9IHtcbiAgICBEOiBcIlwiLFxuICAgIEY6IFwiXCIsXG4gICAgRzogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBIOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIEo6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXFxcXHcrXCIsXG4gICAgSzogXCJcIixcbiAgICBNOiBcIlwiLFxuICAgIFM6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgVTogXCIoLispXCIsXG4gICAgVzogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBZOiBcIihcXFxcZHs0fSlcIixcbiAgICBaOiBcIiguKylcIixcbiAgICBkOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIGg6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgaTogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBqOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIGw6IFwiXCIsXG4gICAgbTogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBuOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIHM6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgdTogXCIoLispXCIsXG4gICAgdzogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICB5OiBcIihcXFxcZHsyfSlcIixcbn07XG5leHBvcnQgdmFyIGZvcm1hdHMgPSB7XG4gICAgWjogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKTsgfSxcbiAgICBEOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBsb2NhbGUud2Vla2RheXMuc2hvcnRoYW5kW2Zvcm1hdHMudyhkYXRlLCBsb2NhbGUsIG9wdGlvbnMpXTtcbiAgICB9LFxuICAgIEY6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG1vbnRoVG9TdHIoZm9ybWF0cy5uKGRhdGUsIGxvY2FsZSwgb3B0aW9ucykgLSAxLCBmYWxzZSwgbG9jYWxlKTtcbiAgICB9LFxuICAgIEc6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHBhZChmb3JtYXRzLmgoZGF0ZSwgbG9jYWxlLCBvcHRpb25zKSk7XG4gICAgfSxcbiAgICBIOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0SG91cnMoKSk7IH0sXG4gICAgSjogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gbG9jYWxlLm9yZGluYWwgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyBkYXRlLmdldERhdGUoKSArIGxvY2FsZS5vcmRpbmFsKGRhdGUuZ2V0RGF0ZSgpKVxuICAgICAgICAgICAgOiBkYXRlLmdldERhdGUoKTtcbiAgICB9LFxuICAgIEs6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUpIHsgcmV0dXJuIGxvY2FsZS5hbVBNW2ludChkYXRlLmdldEhvdXJzKCkgPiAxMSldOyB9LFxuICAgIE06IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIG1vbnRoVG9TdHIoZGF0ZS5nZXRNb250aCgpLCB0cnVlLCBsb2NhbGUpO1xuICAgIH0sXG4gICAgUzogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldFNlY29uZHMoKSk7IH0sXG4gICAgVTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0VGltZSgpIC8gMTAwMDsgfSxcbiAgICBXOiBmdW5jdGlvbiAoZGF0ZSwgXywgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRXZWVrKGRhdGUpO1xuICAgIH0sXG4gICAgWTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldEZ1bGxZZWFyKCksIDQpOyB9LFxuICAgIGQ6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBwYWQoZGF0ZS5nZXREYXRlKCkpOyB9LFxuICAgIGg6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiAoZGF0ZS5nZXRIb3VycygpICUgMTIgPyBkYXRlLmdldEhvdXJzKCkgJSAxMiA6IDEyKTsgfSxcbiAgICBpOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0TWludXRlcygpKTsgfSxcbiAgICBqOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXREYXRlKCk7IH0sXG4gICAgbDogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gbG9jYWxlLndlZWtkYXlzLmxvbmdoYW5kW2RhdGUuZ2V0RGF5KCldO1xuICAgIH0sXG4gICAgbTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldE1vbnRoKCkgKyAxKTsgfSxcbiAgICBuOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXRNb250aCgpICsgMTsgfSxcbiAgICBzOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXRTZWNvbmRzKCk7IH0sXG4gICAgdTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0VGltZSgpOyB9LFxuICAgIHc6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLmdldERheSgpOyB9LFxuICAgIHk6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBTdHJpbmcoZGF0ZS5nZXRGdWxsWWVhcigpKS5zdWJzdHJpbmcoMik7IH0sXG59O1xuIiwgImltcG9ydCB7IHRva2VuUmVnZXgsIHJldkZvcm1hdCwgZm9ybWF0cywgfSBmcm9tIFwiLi9mb3JtYXR0aW5nXCI7XG5pbXBvcnQgeyBkZWZhdWx0cyB9IGZyb20gXCIuLi90eXBlcy9vcHRpb25zXCI7XG5pbXBvcnQgeyBlbmdsaXNoIH0gZnJvbSBcIi4uL2wxMG4vZGVmYXVsdFwiO1xuZXhwb3J0IHZhciBjcmVhdGVEYXRlRm9ybWF0dGVyID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgdmFyIF9iID0gX2EuY29uZmlnLCBjb25maWcgPSBfYiA9PT0gdm9pZCAwID8gZGVmYXVsdHMgOiBfYiwgX2MgPSBfYS5sMTBuLCBsMTBuID0gX2MgPT09IHZvaWQgMCA/IGVuZ2xpc2ggOiBfYywgX2QgPSBfYS5pc01vYmlsZSwgaXNNb2JpbGUgPSBfZCA9PT0gdm9pZCAwID8gZmFsc2UgOiBfZDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGVPYmosIGZybXQsIG92ZXJyaWRlTG9jYWxlKSB7XG4gICAgICAgIHZhciBsb2NhbGUgPSBvdmVycmlkZUxvY2FsZSB8fCBsMTBuO1xuICAgICAgICBpZiAoY29uZmlnLmZvcm1hdERhdGUgIT09IHVuZGVmaW5lZCAmJiAhaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25maWcuZm9ybWF0RGF0ZShkYXRlT2JqLCBmcm10LCBsb2NhbGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm10XG4gICAgICAgICAgICAuc3BsaXQoXCJcIilcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGMsIGksIGFycikge1xuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdHNbY10gJiYgYXJyW2kgLSAxXSAhPT0gXCJcXFxcXCJcbiAgICAgICAgICAgICAgICA/IGZvcm1hdHNbY10oZGF0ZU9iaiwgbG9jYWxlLCBjb25maWcpXG4gICAgICAgICAgICAgICAgOiBjICE9PSBcIlxcXFxcIlxuICAgICAgICAgICAgICAgICAgICA/IGNcbiAgICAgICAgICAgICAgICAgICAgOiBcIlwiO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oXCJcIik7XG4gICAgfTtcbn07XG5leHBvcnQgdmFyIGNyZWF0ZURhdGVQYXJzZXIgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgX2IgPSBfYS5jb25maWcsIGNvbmZpZyA9IF9iID09PSB2b2lkIDAgPyBkZWZhdWx0cyA6IF9iLCBfYyA9IF9hLmwxMG4sIGwxMG4gPSBfYyA9PT0gdm9pZCAwID8gZW5nbGlzaCA6IF9jO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZGF0ZSwgZ2l2ZW5Gb3JtYXQsIHRpbWVsZXNzLCBjdXN0b21Mb2NhbGUpIHtcbiAgICAgICAgaWYgKGRhdGUgIT09IDAgJiYgIWRhdGUpXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgbG9jYWxlID0gY3VzdG9tTG9jYWxlIHx8IGwxMG47XG4gICAgICAgIHZhciBwYXJzZWREYXRlO1xuICAgICAgICB2YXIgZGF0ZU9yaWcgPSBkYXRlO1xuICAgICAgICBpZiAoZGF0ZSBpbnN0YW5jZW9mIERhdGUpXG4gICAgICAgICAgICBwYXJzZWREYXRlID0gbmV3IERhdGUoZGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgICBlbHNlIGlmICh0eXBlb2YgZGF0ZSAhPT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICAgICAgZGF0ZS50b0ZpeGVkICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBwYXJzZWREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkYXRlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgZm9ybWF0ID0gZ2l2ZW5Gb3JtYXQgfHwgKGNvbmZpZyB8fCBkZWZhdWx0cykuZGF0ZUZvcm1hdDtcbiAgICAgICAgICAgIHZhciBkYXRlc3RyID0gU3RyaW5nKGRhdGUpLnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChkYXRlc3RyID09PSBcInRvZGF5XCIpIHtcbiAgICAgICAgICAgICAgICBwYXJzZWREYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICB0aW1lbGVzcyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb25maWcgJiYgY29uZmlnLnBhcnNlRGF0ZSkge1xuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPSBjb25maWcucGFyc2VEYXRlKGRhdGUsIGZvcm1hdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgvWiQvLnRlc3QoZGF0ZXN0cikgfHxcbiAgICAgICAgICAgICAgICAvR01UJC8udGVzdChkYXRlc3RyKSkge1xuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBtYXRjaGVkID0gdm9pZCAwLCBvcHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWF0Y2hJbmRleCA9IDAsIHJlZ2V4U3RyID0gXCJcIjsgaSA8IGZvcm1hdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW4gPSBmb3JtYXRbaV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc0JhY2tTbGFzaCA9IHRva2VuID09PSBcIlxcXFxcIjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVzY2FwZWQgPSBmb3JtYXRbaSAtIDFdID09PSBcIlxcXFxcIiB8fCBpc0JhY2tTbGFzaDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuUmVnZXhbdG9rZW5dICYmICFlc2NhcGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdleFN0ciArPSB0b2tlblJlZ2V4W3Rva2VuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IG5ldyBSZWdFeHAocmVnZXhTdHIpLmV4ZWMoZGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2ggJiYgKG1hdGNoZWQgPSB0cnVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wc1t0b2tlbiAhPT0gXCJZXCIgPyBcInB1c2hcIiA6IFwidW5zaGlmdFwiXSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZuOiByZXZGb3JtYXRbdG9rZW5dLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWw6IG1hdGNoWysrbWF0Y2hJbmRleF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWlzQmFja1NsYXNoKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXhTdHIgKz0gXCIuXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPVxuICAgICAgICAgICAgICAgICAgICAhY29uZmlnIHx8ICFjb25maWcubm9DYWxlbmRhclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBuZXcgRGF0ZShuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCksIDAsIDEsIDAsIDAsIDAsIDApXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0SG91cnMoMCwgMCwgMCwgMCkpO1xuICAgICAgICAgICAgICAgIG9wcy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm4gPSBfYS5mbiwgdmFsID0gX2EudmFsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHBhcnNlZERhdGUgPSBmbihwYXJzZWREYXRlLCB2YWwsIGxvY2FsZSkgfHwgcGFyc2VkRGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcGFyc2VkRGF0ZSA9IG1hdGNoZWQgPyBwYXJzZWREYXRlIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghKHBhcnNlZERhdGUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTihwYXJzZWREYXRlLmdldFRpbWUoKSkpKSB7XG4gICAgICAgICAgICBjb25maWcuZXJyb3JIYW5kbGVyKG5ldyBFcnJvcihcIkludmFsaWQgZGF0ZSBwcm92aWRlZDogXCIgKyBkYXRlT3JpZykpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGltZWxlc3MgPT09IHRydWUpXG4gICAgICAgICAgICBwYXJzZWREYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICAgICAgICByZXR1cm4gcGFyc2VkRGF0ZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlRGF0ZXMoZGF0ZTEsIGRhdGUyLCB0aW1lbGVzcykge1xuICAgIGlmICh0aW1lbGVzcyA9PT0gdm9pZCAwKSB7IHRpbWVsZXNzID0gdHJ1ZTsgfVxuICAgIGlmICh0aW1lbGVzcyAhPT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgRGF0ZShkYXRlMS5nZXRUaW1lKCkpLnNldEhvdXJzKDAsIDAsIDAsIDApIC1cbiAgICAgICAgICAgIG5ldyBEYXRlKGRhdGUyLmdldFRpbWUoKSkuc2V0SG91cnMoMCwgMCwgMCwgMCkpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0ZTEuZ2V0VGltZSgpIC0gZGF0ZTIuZ2V0VGltZSgpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVUaW1lcyhkYXRlMSwgZGF0ZTIpIHtcbiAgICByZXR1cm4gKDM2MDAgKiAoZGF0ZTEuZ2V0SG91cnMoKSAtIGRhdGUyLmdldEhvdXJzKCkpICtcbiAgICAgICAgNjAgKiAoZGF0ZTEuZ2V0TWludXRlcygpIC0gZGF0ZTIuZ2V0TWludXRlcygpKSArXG4gICAgICAgIGRhdGUxLmdldFNlY29uZHMoKSAtXG4gICAgICAgIGRhdGUyLmdldFNlY29uZHMoKSk7XG59XG5leHBvcnQgdmFyIGlzQmV0d2VlbiA9IGZ1bmN0aW9uICh0cywgdHMxLCB0czIpIHtcbiAgICByZXR1cm4gdHMgPiBNYXRoLm1pbih0czEsIHRzMikgJiYgdHMgPCBNYXRoLm1heCh0czEsIHRzMik7XG59O1xuZXhwb3J0IHZhciBjYWxjdWxhdGVTZWNvbmRzU2luY2VNaWRuaWdodCA9IGZ1bmN0aW9uIChob3VycywgbWludXRlcywgc2Vjb25kcykge1xuICAgIHJldHVybiBob3VycyAqIDM2MDAgKyBtaW51dGVzICogNjAgKyBzZWNvbmRzO1xufTtcbmV4cG9ydCB2YXIgcGFyc2VTZWNvbmRzID0gZnVuY3Rpb24gKHNlY29uZHNTaW5jZU1pZG5pZ2h0KSB7XG4gICAgdmFyIGhvdXJzID0gTWF0aC5mbG9vcihzZWNvbmRzU2luY2VNaWRuaWdodCAvIDM2MDApLCBtaW51dGVzID0gKHNlY29uZHNTaW5jZU1pZG5pZ2h0IC0gaG91cnMgKiAzNjAwKSAvIDYwO1xuICAgIHJldHVybiBbaG91cnMsIG1pbnV0ZXMsIHNlY29uZHNTaW5jZU1pZG5pZ2h0IC0gaG91cnMgKiAzNjAwIC0gbWludXRlcyAqIDYwXTtcbn07XG5leHBvcnQgdmFyIGR1cmF0aW9uID0ge1xuICAgIERBWTogODY0MDAwMDAsXG59O1xuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRIb3Vycyhjb25maWcpIHtcbiAgICB2YXIgaG91cnMgPSBjb25maWcuZGVmYXVsdEhvdXI7XG4gICAgdmFyIG1pbnV0ZXMgPSBjb25maWcuZGVmYXVsdE1pbnV0ZTtcbiAgICB2YXIgc2Vjb25kcyA9IGNvbmZpZy5kZWZhdWx0U2Vjb25kcztcbiAgICBpZiAoY29uZmlnLm1pbkRhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgbWluSG91ciA9IGNvbmZpZy5taW5EYXRlLmdldEhvdXJzKCk7XG4gICAgICAgIHZhciBtaW5NaW51dGVzID0gY29uZmlnLm1pbkRhdGUuZ2V0TWludXRlcygpO1xuICAgICAgICB2YXIgbWluU2Vjb25kcyA9IGNvbmZpZy5taW5EYXRlLmdldFNlY29uZHMoKTtcbiAgICAgICAgaWYgKGhvdXJzIDwgbWluSG91cikge1xuICAgICAgICAgICAgaG91cnMgPSBtaW5Ib3VyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChob3VycyA9PT0gbWluSG91ciAmJiBtaW51dGVzIDwgbWluTWludXRlcykge1xuICAgICAgICAgICAgbWludXRlcyA9IG1pbk1pbnV0ZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhvdXJzID09PSBtaW5Ib3VyICYmIG1pbnV0ZXMgPT09IG1pbk1pbnV0ZXMgJiYgc2Vjb25kcyA8IG1pblNlY29uZHMpXG4gICAgICAgICAgICBzZWNvbmRzID0gY29uZmlnLm1pbkRhdGUuZ2V0U2Vjb25kcygpO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLm1heERhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgbWF4SHIgPSBjb25maWcubWF4RGF0ZS5nZXRIb3VycygpO1xuICAgICAgICB2YXIgbWF4TWludXRlcyA9IGNvbmZpZy5tYXhEYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgaG91cnMgPSBNYXRoLm1pbihob3VycywgbWF4SHIpO1xuICAgICAgICBpZiAoaG91cnMgPT09IG1heEhyKVxuICAgICAgICAgICAgbWludXRlcyA9IE1hdGgubWluKG1heE1pbnV0ZXMsIG1pbnV0ZXMpO1xuICAgICAgICBpZiAoaG91cnMgPT09IG1heEhyICYmIG1pbnV0ZXMgPT09IG1heE1pbnV0ZXMpXG4gICAgICAgICAgICBzZWNvbmRzID0gY29uZmlnLm1heERhdGUuZ2V0U2Vjb25kcygpO1xuICAgIH1cbiAgICByZXR1cm4geyBob3VyczogaG91cnMsIG1pbnV0ZXM6IG1pbnV0ZXMsIHNlY29uZHM6IHNlY29uZHMgfTtcbn1cbiIsICJcInVzZSBzdHJpY3RcIjtcbmlmICh0eXBlb2YgT2JqZWN0LmFzc2lnbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgT2JqZWN0LmFzc2lnbiA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcihcIkNhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdFwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gKHRhcmdldFtrZXldID0gc291cmNlW2tleV0pOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBhcmdzXzEgPSBhcmdzOyBfYSA8IGFyZ3NfMS5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmdzXzFbX2FdO1xuICAgICAgICAgICAgX2xvb3BfMShzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbn1cbiIsICJ2YXIgX19hc3NpZ24gPSAodGhpcyAmJiB0aGlzLl9fYXNzaWduKSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxuICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH07XG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xudmFyIF9fc3ByZWFkQXJyYXlzID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5cykgfHwgZnVuY3Rpb24gKCkge1xuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcbiAgICByZXR1cm4gcjtcbn07XG5pbXBvcnQgeyBkZWZhdWx0cyBhcyBkZWZhdWx0T3B0aW9ucywgSE9PS1MsIH0gZnJvbSBcIi4vdHlwZXMvb3B0aW9uc1wiO1xuaW1wb3J0IEVuZ2xpc2ggZnJvbSBcIi4vbDEwbi9kZWZhdWx0XCI7XG5pbXBvcnQgeyBhcnJheWlmeSwgZGVib3VuY2UsIGludCwgcGFkIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IGNsZWFyTm9kZSwgY3JlYXRlRWxlbWVudCwgY3JlYXRlTnVtYmVySW5wdXQsIGZpbmRQYXJlbnQsIHRvZ2dsZUNsYXNzLCBnZXRFdmVudFRhcmdldCwgfSBmcm9tIFwiLi91dGlscy9kb21cIjtcbmltcG9ydCB7IGNvbXBhcmVEYXRlcywgY3JlYXRlRGF0ZVBhcnNlciwgY3JlYXRlRGF0ZUZvcm1hdHRlciwgZHVyYXRpb24sIGlzQmV0d2VlbiwgZ2V0RGVmYXVsdEhvdXJzLCBjYWxjdWxhdGVTZWNvbmRzU2luY2VNaWRuaWdodCwgcGFyc2VTZWNvbmRzLCB9IGZyb20gXCIuL3V0aWxzL2RhdGVzXCI7XG5pbXBvcnQgeyB0b2tlblJlZ2V4LCBtb250aFRvU3RyIH0gZnJvbSBcIi4vdXRpbHMvZm9ybWF0dGluZ1wiO1xuaW1wb3J0IFwiLi91dGlscy9wb2x5ZmlsbHNcIjtcbnZhciBERUJPVU5DRURfQ0hBTkdFX01TID0gMzAwO1xuZnVuY3Rpb24gRmxhdHBpY2tySW5zdGFuY2UoZWxlbWVudCwgaW5zdGFuY2VDb25maWcpIHtcbiAgICB2YXIgc2VsZiA9IHtcbiAgICAgICAgY29uZmlnOiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMpLCBmbGF0cGlja3IuZGVmYXVsdENvbmZpZyksXG4gICAgICAgIGwxMG46IEVuZ2xpc2gsXG4gICAgfTtcbiAgICBzZWxmLnBhcnNlRGF0ZSA9IGNyZWF0ZURhdGVQYXJzZXIoeyBjb25maWc6IHNlbGYuY29uZmlnLCBsMTBuOiBzZWxmLmwxMG4gfSk7XG4gICAgc2VsZi5faGFuZGxlcnMgPSBbXTtcbiAgICBzZWxmLnBsdWdpbkVsZW1lbnRzID0gW107XG4gICAgc2VsZi5sb2FkZWRQbHVnaW5zID0gW107XG4gICAgc2VsZi5fYmluZCA9IGJpbmQ7XG4gICAgc2VsZi5fc2V0SG91cnNGcm9tRGF0ZSA9IHNldEhvdXJzRnJvbURhdGU7XG4gICAgc2VsZi5fcG9zaXRpb25DYWxlbmRhciA9IHBvc2l0aW9uQ2FsZW5kYXI7XG4gICAgc2VsZi5jaGFuZ2VNb250aCA9IGNoYW5nZU1vbnRoO1xuICAgIHNlbGYuY2hhbmdlWWVhciA9IGNoYW5nZVllYXI7XG4gICAgc2VsZi5jbGVhciA9IGNsZWFyO1xuICAgIHNlbGYuY2xvc2UgPSBjbG9zZTtcbiAgICBzZWxmLm9uTW91c2VPdmVyID0gb25Nb3VzZU92ZXI7XG4gICAgc2VsZi5fY3JlYXRlRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQ7XG4gICAgc2VsZi5jcmVhdGVEYXkgPSBjcmVhdGVEYXk7XG4gICAgc2VsZi5kZXN0cm95ID0gZGVzdHJveTtcbiAgICBzZWxmLmlzRW5hYmxlZCA9IGlzRW5hYmxlZDtcbiAgICBzZWxmLmp1bXBUb0RhdGUgPSBqdW1wVG9EYXRlO1xuICAgIHNlbGYudXBkYXRlVmFsdWUgPSB1cGRhdGVWYWx1ZTtcbiAgICBzZWxmLm9wZW4gPSBvcGVuO1xuICAgIHNlbGYucmVkcmF3ID0gcmVkcmF3O1xuICAgIHNlbGYuc2V0ID0gc2V0O1xuICAgIHNlbGYuc2V0RGF0ZSA9IHNldERhdGU7XG4gICAgc2VsZi50b2dnbGUgPSB0b2dnbGU7XG4gICAgZnVuY3Rpb24gc2V0dXBIZWxwZXJGdW5jdGlvbnMoKSB7XG4gICAgICAgIHNlbGYudXRpbHMgPSB7XG4gICAgICAgICAgICBnZXREYXlzSW5Nb250aDogZnVuY3Rpb24gKG1vbnRoLCB5cikge1xuICAgICAgICAgICAgICAgIGlmIChtb250aCA9PT0gdm9pZCAwKSB7IG1vbnRoID0gc2VsZi5jdXJyZW50TW9udGg7IH1cbiAgICAgICAgICAgICAgICBpZiAoeXIgPT09IHZvaWQgMCkgeyB5ciA9IHNlbGYuY3VycmVudFllYXI7IH1cbiAgICAgICAgICAgICAgICBpZiAobW9udGggPT09IDEgJiYgKCh5ciAlIDQgPT09IDAgJiYgeXIgJSAxMDAgIT09IDApIHx8IHlyICUgNDAwID09PSAwKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI5O1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmwxMG4uZGF5c0luTW9udGhbbW9udGhdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgc2VsZi5lbGVtZW50ID0gc2VsZi5pbnB1dCA9IGVsZW1lbnQ7XG4gICAgICAgIHNlbGYuaXNPcGVuID0gZmFsc2U7XG4gICAgICAgIHBhcnNlQ29uZmlnKCk7XG4gICAgICAgIHNldHVwTG9jYWxlKCk7XG4gICAgICAgIHNldHVwSW5wdXRzKCk7XG4gICAgICAgIHNldHVwRGF0ZXMoKTtcbiAgICAgICAgc2V0dXBIZWxwZXJGdW5jdGlvbnMoKTtcbiAgICAgICAgaWYgKCFzZWxmLmlzTW9iaWxlKVxuICAgICAgICAgICAgYnVpbGQoKTtcbiAgICAgICAgYmluZEV2ZW50cygpO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCB8fCBzZWxmLmNvbmZpZy5ub0NhbGVuZGFyKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSkge1xuICAgICAgICAgICAgICAgIHNldEhvdXJzRnJvbURhdGUoc2VsZi5jb25maWcubm9DYWxlbmRhciA/IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqIDogdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHVwZGF0ZVZhbHVlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRDYWxlbmRhcldpZHRoKCk7XG4gICAgICAgIHZhciBpc1NhZmFyaSA9IC9eKCg/IWNocm9tZXxhbmRyb2lkKS4pKnNhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XG4gICAgICAgIGlmICghc2VsZi5pc01vYmlsZSAmJiBpc1NhZmFyaSkge1xuICAgICAgICAgICAgcG9zaXRpb25DYWxlbmRhcigpO1xuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uUmVhZHlcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldENsb3Nlc3RBY3RpdmVFbGVtZW50KCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoKChfYSA9IHNlbGYuY2FsZW5kYXJDb250YWluZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRSb290Tm9kZSgpKVxuICAgICAgICAgICAgLmFjdGl2ZUVsZW1lbnQgfHwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJpbmRUb0luc3RhbmNlKGZuKSB7XG4gICAgICAgIHJldHVybiBmbi5iaW5kKHNlbGYpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRDYWxlbmRhcldpZHRoKCkge1xuICAgICAgICB2YXIgY29uZmlnID0gc2VsZi5jb25maWc7XG4gICAgICAgIGlmIChjb25maWcud2Vla051bWJlcnMgPT09IGZhbHNlICYmIGNvbmZpZy5zaG93TW9udGhzID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29uZmlnLm5vQ2FsZW5kYXIgIT09IHRydWUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNhbGVuZGFyQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRheXNXaWR0aCA9IChzZWxmLmRheXMub2Zmc2V0V2lkdGggKyAxKSAqIGNvbmZpZy5zaG93TW9udGhzO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIuc3R5bGUud2lkdGggPSBkYXlzV2lkdGggKyBcInB4XCI7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUud2lkdGggPVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF5c1dpZHRoICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc2VsZi53ZWVrV3JhcHBlciAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi53ZWVrV3JhcHBlci5vZmZzZXRXaWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInB4XCI7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmVtb3ZlUHJvcGVydHkoXCJ2aXNpYmlsaXR5XCIpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnJlbW92ZVByb3BlcnR5KFwiZGlzcGxheVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVUaW1lKGUpIHtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0RGF0ZSA9IHNlbGYuY29uZmlnLm1pbkRhdGUgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhuZXcgRGF0ZSgpLCBzZWxmLmNvbmZpZy5taW5EYXRlKSA+PSAwXG4gICAgICAgICAgICAgICAgPyBuZXcgRGF0ZSgpXG4gICAgICAgICAgICAgICAgOiBuZXcgRGF0ZShzZWxmLmNvbmZpZy5taW5EYXRlLmdldFRpbWUoKSk7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdHMgPSBnZXREZWZhdWx0SG91cnMoc2VsZi5jb25maWcpO1xuICAgICAgICAgICAgZGVmYXVsdERhdGUuc2V0SG91cnMoZGVmYXVsdHMuaG91cnMsIGRlZmF1bHRzLm1pbnV0ZXMsIGRlZmF1bHRzLnNlY29uZHMsIGRlZmF1bHREYXRlLmdldE1pbGxpc2Vjb25kcygpKTtcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IFtkZWZhdWx0RGF0ZV07XG4gICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA9IGRlZmF1bHREYXRlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlICE9PSB1bmRlZmluZWQgJiYgZS50eXBlICE9PSBcImJsdXJcIikge1xuICAgICAgICAgICAgdGltZVdyYXBwZXIoZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZXZWYWx1ZSA9IHNlbGYuX2lucHV0LnZhbHVlO1xuICAgICAgICBzZXRIb3Vyc0Zyb21JbnB1dHMoKTtcbiAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgaWYgKHNlbGYuX2lucHV0LnZhbHVlICE9PSBwcmV2VmFsdWUpIHtcbiAgICAgICAgICAgIHNlbGYuX2RlYm91bmNlZENoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGFtcG0ybWlsaXRhcnkoaG91ciwgYW1QTSkge1xuICAgICAgICByZXR1cm4gKGhvdXIgJSAxMikgKyAxMiAqIGludChhbVBNID09PSBzZWxmLmwxMG4uYW1QTVsxXSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG1pbGl0YXJ5MmFtcG0oaG91cikge1xuICAgICAgICBzd2l0Y2ggKGhvdXIgJSAyNCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMTI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBob3VyICUgMTI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0SG91cnNGcm9tSW5wdXRzKCkge1xuICAgICAgICBpZiAoc2VsZi5ob3VyRWxlbWVudCA9PT0gdW5kZWZpbmVkIHx8IHNlbGYubWludXRlRWxlbWVudCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgaG91cnMgPSAocGFyc2VJbnQoc2VsZi5ob3VyRWxlbWVudC52YWx1ZS5zbGljZSgtMiksIDEwKSB8fCAwKSAlIDI0LCBtaW51dGVzID0gKHBhcnNlSW50KHNlbGYubWludXRlRWxlbWVudC52YWx1ZSwgMTApIHx8IDApICUgNjAsIHNlY29uZHMgPSBzZWxmLnNlY29uZEVsZW1lbnQgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyAocGFyc2VJbnQoc2VsZi5zZWNvbmRFbGVtZW50LnZhbHVlLCAxMCkgfHwgMCkgJSA2MFxuICAgICAgICAgICAgOiAwO1xuICAgICAgICBpZiAoc2VsZi5hbVBNICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhvdXJzID0gYW1wbTJtaWxpdGFyeShob3Vycywgc2VsZi5hbVBNLnRleHRDb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGltaXRNaW5Ib3VycyA9IHNlbGYuY29uZmlnLm1pblRpbWUgIT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgICAgICBzZWxmLm1pbkRhdGVIYXNUaW1lICYmXG4gICAgICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmosIHNlbGYuY29uZmlnLm1pbkRhdGUsIHRydWUpID09PVxuICAgICAgICAgICAgICAgICAgICAwKTtcbiAgICAgICAgdmFyIGxpbWl0TWF4SG91cnMgPSBzZWxmLmNvbmZpZy5tYXhUaW1lICE9PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICAgICAgc2VsZi5tYXhEYXRlSGFzVGltZSAmJlxuICAgICAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqICYmXG4gICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLCBzZWxmLmNvbmZpZy5tYXhEYXRlLCB0cnVlKSA9PT1cbiAgICAgICAgICAgICAgICAgICAgMCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhUaW1lICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pblRpbWUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcubWluVGltZSA+IHNlbGYuY29uZmlnLm1heFRpbWUpIHtcbiAgICAgICAgICAgIHZhciBtaW5Cb3VuZCA9IGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0KHNlbGYuY29uZmlnLm1pblRpbWUuZ2V0SG91cnMoKSwgc2VsZi5jb25maWcubWluVGltZS5nZXRNaW51dGVzKCksIHNlbGYuY29uZmlnLm1pblRpbWUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgIHZhciBtYXhCb3VuZCA9IGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0KHNlbGYuY29uZmlnLm1heFRpbWUuZ2V0SG91cnMoKSwgc2VsZi5jb25maWcubWF4VGltZS5nZXRNaW51dGVzKCksIHNlbGYuY29uZmlnLm1heFRpbWUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0KGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VGltZSA+IG1heEJvdW5kICYmIGN1cnJlbnRUaW1lIDwgbWluQm91bmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gcGFyc2VTZWNvbmRzKG1pbkJvdW5kKTtcbiAgICAgICAgICAgICAgICBob3VycyA9IHJlc3VsdFswXTtcbiAgICAgICAgICAgICAgICBtaW51dGVzID0gcmVzdWx0WzFdO1xuICAgICAgICAgICAgICAgIHNlY29uZHMgPSByZXN1bHRbMl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAobGltaXRNYXhIb3Vycykge1xuICAgICAgICAgICAgICAgIHZhciBtYXhUaW1lID0gc2VsZi5jb25maWcubWF4VGltZSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWF4VGltZVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1heERhdGU7XG4gICAgICAgICAgICAgICAgaG91cnMgPSBNYXRoLm1pbihob3VycywgbWF4VGltZS5nZXRIb3VycygpKTtcbiAgICAgICAgICAgICAgICBpZiAoaG91cnMgPT09IG1heFRpbWUuZ2V0SG91cnMoKSlcbiAgICAgICAgICAgICAgICAgICAgbWludXRlcyA9IE1hdGgubWluKG1pbnV0ZXMsIG1heFRpbWUuZ2V0TWludXRlcygpKTtcbiAgICAgICAgICAgICAgICBpZiAobWludXRlcyA9PT0gbWF4VGltZS5nZXRNaW51dGVzKCkpXG4gICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBNYXRoLm1pbihzZWNvbmRzLCBtYXhUaW1lLmdldFNlY29uZHMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGltaXRNaW5Ib3Vycykge1xuICAgICAgICAgICAgICAgIHZhciBtaW5UaW1lID0gc2VsZi5jb25maWcubWluVGltZSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWluVGltZVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1pbkRhdGU7XG4gICAgICAgICAgICAgICAgaG91cnMgPSBNYXRoLm1heChob3VycywgbWluVGltZS5nZXRIb3VycygpKTtcbiAgICAgICAgICAgICAgICBpZiAoaG91cnMgPT09IG1pblRpbWUuZ2V0SG91cnMoKSAmJiBtaW51dGVzIDwgbWluVGltZS5nZXRNaW51dGVzKCkpXG4gICAgICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBtaW5UaW1lLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgICAgICAgICBpZiAobWludXRlcyA9PT0gbWluVGltZS5nZXRNaW51dGVzKCkpXG4gICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBNYXRoLm1heChzZWNvbmRzLCBtaW5UaW1lLmdldFNlY29uZHMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0SG91cnMoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRIb3Vyc0Zyb21EYXRlKGRhdGVPYmopIHtcbiAgICAgICAgdmFyIGRhdGUgPSBkYXRlT2JqIHx8IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqO1xuICAgICAgICBpZiAoZGF0ZSAmJiBkYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgc2V0SG91cnMoZGF0ZS5nZXRIb3VycygpLCBkYXRlLmdldE1pbnV0ZXMoKSwgZGF0ZS5nZXRTZWNvbmRzKCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldEhvdXJzKGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKSB7XG4gICAgICAgIGlmIChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iai5zZXRIb3Vycyhob3VycyAlIDI0LCBtaW51dGVzLCBzZWNvbmRzIHx8IDAsIDApO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2VsZi5ob3VyRWxlbWVudCB8fCAhc2VsZi5taW51dGVFbGVtZW50IHx8IHNlbGYuaXNNb2JpbGUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQudmFsdWUgPSBwYWQoIXNlbGYuY29uZmlnLnRpbWVfMjRoclxuICAgICAgICAgICAgPyAoKDEyICsgaG91cnMpICUgMTIpICsgMTIgKiBpbnQoaG91cnMgJSAxMiA9PT0gMClcbiAgICAgICAgICAgIDogaG91cnMpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQudmFsdWUgPSBwYWQobWludXRlcyk7XG4gICAgICAgIGlmIChzZWxmLmFtUE0gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9IHNlbGYubDEwbi5hbVBNW2ludChob3VycyA+PSAxMildO1xuICAgICAgICBpZiAoc2VsZi5zZWNvbmRFbGVtZW50ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQudmFsdWUgPSBwYWQoc2Vjb25kcyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uWWVhcklucHV0KGV2ZW50KSB7XG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGV2ZW50KTtcbiAgICAgICAgdmFyIHllYXIgPSBwYXJzZUludChldmVudFRhcmdldC52YWx1ZSkgKyAoZXZlbnQuZGVsdGEgfHwgMCk7XG4gICAgICAgIGlmICh5ZWFyIC8gMTAwMCA+IDEgfHxcbiAgICAgICAgICAgIChldmVudC5rZXkgPT09IFwiRW50ZXJcIiAmJiAhL1teXFxkXS8udGVzdCh5ZWFyLnRvU3RyaW5nKCkpKSkge1xuICAgICAgICAgICAgY2hhbmdlWWVhcih5ZWFyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBiaW5kKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChldmVudCBpbnN0YW5jZW9mIEFycmF5KVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50LmZvckVhY2goZnVuY3Rpb24gKGV2KSB7IHJldHVybiBiaW5kKGVsZW1lbnQsIGV2LCBoYW5kbGVyLCBvcHRpb25zKTsgfSk7XG4gICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgQXJyYXkpXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudC5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgeyByZXR1cm4gYmluZChlbCwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpOyB9KTtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICAgICAgc2VsZi5faGFuZGxlcnMucHVzaCh7XG4gICAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7IH0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0cmlnZ2VyQ2hhbmdlKCkge1xuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNoYW5nZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYmluZEV2ZW50cygpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLndyYXApIHtcbiAgICAgICAgICAgIFtcIm9wZW5cIiwgXCJjbG9zZVwiLCBcInRvZ2dsZVwiLCBcImNsZWFyXCJdLmZvckVhY2goZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2VsZi5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1cIiArIGV2dCArIFwiXVwiKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiaW5kKGVsLCBcImNsaWNrXCIsIHNlbGZbZXZ0XSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5pc01vYmlsZSkge1xuICAgICAgICAgICAgc2V0dXBNb2JpbGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVib3VuY2VkUmVzaXplID0gZGVib3VuY2Uob25SZXNpemUsIDUwKTtcbiAgICAgICAgc2VsZi5fZGVib3VuY2VkQ2hhbmdlID0gZGVib3VuY2UodHJpZ2dlckNoYW5nZSwgREVCT1VOQ0VEX0NIQU5HRV9NUyk7XG4gICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIgJiYgIS9pUGhvbmV8aVBhZHxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSlcbiAgICAgICAgICAgIGJpbmQoc2VsZi5kYXlzQ29udGFpbmVyLCBcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpXG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VPdmVyKGdldEV2ZW50VGFyZ2V0KGUpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgICAgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgYmluZChzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLmlubGluZSAmJiAhc2VsZi5jb25maWcuc3RhdGljKVxuICAgICAgICAgICAgYmluZCh3aW5kb3csIFwicmVzaXplXCIsIGRlYm91bmNlZFJlc2l6ZSk7XG4gICAgICAgIGlmICh3aW5kb3cub250b3VjaHN0YXJ0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBiaW5kKHdpbmRvdy5kb2N1bWVudCwgXCJ0b3VjaHN0YXJ0XCIsIGRvY3VtZW50Q2xpY2spO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBiaW5kKHdpbmRvdy5kb2N1bWVudCwgXCJtb3VzZWRvd25cIiwgZG9jdW1lbnRDbGljayk7XG4gICAgICAgIGJpbmQod2luZG93LmRvY3VtZW50LCBcImZvY3VzXCIsIGRvY3VtZW50Q2xpY2ssIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmNsaWNrT3BlbnMgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiZm9jdXNcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiY2xpY2tcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5tb250aE5hdiwgXCJjbGlja1wiLCBvbk1vbnRoTmF2Q2xpY2spO1xuICAgICAgICAgICAgYmluZChzZWxmLm1vbnRoTmF2LCBbXCJrZXl1cFwiLCBcImluY3JlbWVudFwiXSwgb25ZZWFySW5wdXQpO1xuICAgICAgICAgICAgYmluZChzZWxmLmRheXNDb250YWluZXIsIFwiY2xpY2tcIiwgc2VsZWN0RGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYudGltZUNvbnRhaW5lciAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgc2VsVGV4dCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEV2ZW50VGFyZ2V0KGUpLnNlbGVjdCgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi50aW1lQ29udGFpbmVyLCBbXCJpbmNyZW1lbnRcIl0sIHVwZGF0ZVRpbWUpO1xuICAgICAgICAgICAgYmluZChzZWxmLnRpbWVDb250YWluZXIsIFwiYmx1clwiLCB1cGRhdGVUaW1lLCB7IGNhcHR1cmU6IHRydWUgfSk7XG4gICAgICAgICAgICBiaW5kKHNlbGYudGltZUNvbnRhaW5lciwgXCJjbGlja1wiLCB0aW1lSW5jcmVtZW50KTtcbiAgICAgICAgICAgIGJpbmQoW3NlbGYuaG91ckVsZW1lbnQsIHNlbGYubWludXRlRWxlbWVudF0sIFtcImZvY3VzXCIsIFwiY2xpY2tcIl0sIHNlbFRleHQpO1xuICAgICAgICAgICAgaWYgKHNlbGYuc2Vjb25kRWxlbWVudCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIGJpbmQoc2VsZi5zZWNvbmRFbGVtZW50LCBcImZvY3VzXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuc2Vjb25kRWxlbWVudCAmJiBzZWxmLnNlY29uZEVsZW1lbnQuc2VsZWN0KCk7IH0pO1xuICAgICAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYmluZChzZWxmLmFtUE0sIFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGltZShlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcuYWxsb3dJbnB1dCkge1xuICAgICAgICAgICAgYmluZChzZWxmLl9pbnB1dCwgXCJibHVyXCIsIG9uQmx1cik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24ganVtcFRvRGF0ZShqdW1wRGF0ZSwgdHJpZ2dlckNoYW5nZSkge1xuICAgICAgICB2YXIganVtcFRvID0ganVtcERhdGUgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyBzZWxmLnBhcnNlRGF0ZShqdW1wRGF0ZSlcbiAgICAgICAgICAgIDogc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogfHxcbiAgICAgICAgICAgICAgICAoc2VsZi5jb25maWcubWluRGF0ZSAmJiBzZWxmLmNvbmZpZy5taW5EYXRlID4gc2VsZi5ub3dcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5taW5EYXRlXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcubWF4RGF0ZSAmJiBzZWxmLmNvbmZpZy5tYXhEYXRlIDwgc2VsZi5ub3dcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWF4RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBzZWxmLm5vdyk7XG4gICAgICAgIHZhciBvbGRZZWFyID0gc2VsZi5jdXJyZW50WWVhcjtcbiAgICAgICAgdmFyIG9sZE1vbnRoID0gc2VsZi5jdXJyZW50TW9udGg7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoanVtcFRvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID0ganVtcFRvLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBqdW1wVG8uZ2V0TW9udGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgZS5tZXNzYWdlID0gXCJJbnZhbGlkIGRhdGUgc3VwcGxpZWQ6IFwiICsganVtcFRvO1xuICAgICAgICAgICAgc2VsZi5jb25maWcuZXJyb3JIYW5kbGVyKGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlICYmIHNlbGYuY3VycmVudFllYXIgIT09IG9sZFllYXIpIHtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uWWVhckNoYW5nZVwiKTtcbiAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSAmJlxuICAgICAgICAgICAgKHNlbGYuY3VycmVudFllYXIgIT09IG9sZFllYXIgfHwgc2VsZi5jdXJyZW50TW9udGggIT09IG9sZE1vbnRoKSkge1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25Nb250aENoYW5nZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnJlZHJhdygpO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0aW1lSW5jcmVtZW50KGUpIHtcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgIGlmICh+ZXZlbnRUYXJnZXQuY2xhc3NOYW1lLmluZGV4T2YoXCJhcnJvd1wiKSlcbiAgICAgICAgICAgIGluY3JlbWVudE51bUlucHV0KGUsIGV2ZW50VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImFycm93VXBcIikgPyAxIDogLTEpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbmNyZW1lbnROdW1JbnB1dChlLCBkZWx0YSwgaW5wdXRFbGVtKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSBlICYmIGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dEVsZW0gfHxcbiAgICAgICAgICAgICh0YXJnZXQgJiYgdGFyZ2V0LnBhcmVudE5vZGUgJiYgdGFyZ2V0LnBhcmVudE5vZGUuZmlyc3RDaGlsZCk7XG4gICAgICAgIHZhciBldmVudCA9IGNyZWF0ZUV2ZW50KFwiaW5jcmVtZW50XCIpO1xuICAgICAgICBldmVudC5kZWx0YSA9IGRlbHRhO1xuICAgICAgICBpbnB1dCAmJiBpbnB1dC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGQoKSB7XG4gICAgICAgIHZhciBmcmFnbWVudCA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLWNhbGVuZGFyXCIpO1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnRhYkluZGV4ID0gLTE7XG4gICAgICAgIGlmICghc2VsZi5jb25maWcubm9DYWxlbmRhcikge1xuICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoYnVpbGRNb250aE5hdigpKTtcbiAgICAgICAgICAgIHNlbGYuaW5uZXJDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLWlubmVyQ29udGFpbmVyXCIpO1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLndlZWtOdW1iZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hID0gYnVpbGRXZWVrcygpLCB3ZWVrV3JhcHBlciA9IF9hLndlZWtXcmFwcGVyLCB3ZWVrTnVtYmVycyA9IF9hLndlZWtOdW1iZXJzO1xuICAgICAgICAgICAgICAgIHNlbGYuaW5uZXJDb250YWluZXIuYXBwZW5kQ2hpbGQod2Vla1dyYXBwZXIpO1xuICAgICAgICAgICAgICAgIHNlbGYud2Vla051bWJlcnMgPSB3ZWVrTnVtYmVycztcbiAgICAgICAgICAgICAgICBzZWxmLndlZWtXcmFwcGVyID0gd2Vla1dyYXBwZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLnJDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXJDb250YWluZXJcIik7XG4gICAgICAgICAgICBzZWxmLnJDb250YWluZXIuYXBwZW5kQ2hpbGQoYnVpbGRXZWVrZGF5cygpKTtcbiAgICAgICAgICAgIGlmICghc2VsZi5kYXlzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1kYXlzXCIpO1xuICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnVpbGREYXlzKCk7XG4gICAgICAgICAgICBzZWxmLnJDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZi5kYXlzQ29udGFpbmVyKTtcbiAgICAgICAgICAgIHNlbGYuaW5uZXJDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZi5yQ29udGFpbmVyKTtcbiAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHNlbGYuaW5uZXJDb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5lbmFibGVUaW1lKSB7XG4gICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChidWlsZFRpbWUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJyYW5nZU1vZGVcIiwgc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhbmltYXRlXCIsIHNlbGYuY29uZmlnLmFuaW1hdGUgPT09IHRydWUpO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcIm11bHRpTW9udGhcIiwgc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEpO1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICAgICAgdmFyIGN1c3RvbUFwcGVuZCA9IHNlbGYuY29uZmlnLmFwcGVuZFRvICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmFwcGVuZFRvLm5vZGVUeXBlICE9PSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5pbmxpbmUgfHwgc2VsZi5jb25maWcuc3RhdGljKSB7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoc2VsZi5jb25maWcuaW5saW5lID8gXCJpbmxpbmVcIiA6IFwic3RhdGljXCIpO1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLmlubGluZSkge1xuICAgICAgICAgICAgICAgIGlmICghY3VzdG9tQXBwZW5kICYmIHNlbGYuZWxlbWVudC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgc2VsZi5faW5wdXQubmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGYuY29uZmlnLmFwcGVuZFRvICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLmFwcGVuZFRvLmFwcGVuZENoaWxkKHNlbGYuY2FsZW5kYXJDb250YWluZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLnN0YXRpYykge1xuICAgICAgICAgICAgICAgIHZhciB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci13cmFwcGVyXCIpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmVsZW1lbnQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5lbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHdyYXBwZXIsIHNlbGYuZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChzZWxmLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmFsdElucHV0KVxuICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHNlbGYuYWx0SW5wdXQpO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoc2VsZi5jYWxlbmRhckNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy5zdGF0aWMgJiYgIXNlbGYuY29uZmlnLmlubGluZSlcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5hcHBlbmRUbyAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5hcHBlbmRUb1xuICAgICAgICAgICAgICAgIDogd2luZG93LmRvY3VtZW50LmJvZHkpLmFwcGVuZENoaWxkKHNlbGYuY2FsZW5kYXJDb250YWluZXIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVEYXkoY2xhc3NOYW1lLCBkYXRlLCBfZGF5TnVtYmVyLCBpKSB7XG4gICAgICAgIHZhciBkYXRlSXNFbmFibGVkID0gaXNFbmFibGVkKGRhdGUsIHRydWUpLCBkYXlFbGVtZW50ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgY2xhc3NOYW1lLCBkYXRlLmdldERhdGUoKS50b1N0cmluZygpKTtcbiAgICAgICAgZGF5RWxlbWVudC5kYXRlT2JqID0gZGF0ZTtcbiAgICAgICAgZGF5RWxlbWVudC4kaSA9IGk7XG4gICAgICAgIGRheUVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBzZWxmLmZvcm1hdERhdGUoZGF0ZSwgc2VsZi5jb25maWcuYXJpYURhdGVGb3JtYXQpKTtcbiAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKFwiaGlkZGVuXCIpID09PSAtMSAmJlxuICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGUsIHNlbGYubm93KSA9PT0gMCkge1xuICAgICAgICAgICAgc2VsZi50b2RheURhdGVFbGVtID0gZGF5RWxlbWVudDtcbiAgICAgICAgICAgIGRheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRvZGF5XCIpO1xuICAgICAgICAgICAgZGF5RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWN1cnJlbnRcIiwgXCJkYXRlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRlSXNFbmFibGVkKSB7XG4gICAgICAgICAgICBkYXlFbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICBpZiAoaXNEYXRlU2VsZWN0ZWQoZGF0ZSkpIHtcbiAgICAgICAgICAgICAgICBkYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZUVsZW0gPSBkYXlFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3MoZGF5RWxlbWVudCwgXCJzdGFydFJhbmdlXCIsIHNlbGYuc2VsZWN0ZWREYXRlc1swXSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXSwgdHJ1ZSkgPT09IDApO1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhkYXlFbGVtZW50LCBcImVuZFJhbmdlXCIsIHNlbGYuc2VsZWN0ZWREYXRlc1sxXSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1sxXSwgdHJ1ZSkgPT09IDApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2xhc3NOYW1lID09PSBcIm5leHRNb250aERheVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaW5SYW5nZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJmbGF0cGlja3ItZGlzYWJsZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIikge1xuICAgICAgICAgICAgaWYgKGlzRGF0ZUluUmFuZ2UoZGF0ZSkgJiYgIWlzRGF0ZVNlbGVjdGVkKGRhdGUpKVxuICAgICAgICAgICAgICAgIGRheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImluUmFuZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYud2Vla051bWJlcnMgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLnNob3dNb250aHMgPT09IDEgJiZcbiAgICAgICAgICAgIGNsYXNzTmFtZSAhPT0gXCJwcmV2TW9udGhEYXlcIiAmJlxuICAgICAgICAgICAgaSAlIDcgPT09IDYpIHtcbiAgICAgICAgICAgIHNlbGYud2Vla051bWJlcnMuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIFwiPHNwYW4gY2xhc3M9J2ZsYXRwaWNrci1kYXknPlwiICsgc2VsZi5jb25maWcuZ2V0V2VlayhkYXRlKSArIFwiPC9zcGFuPlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkRheUNyZWF0ZVwiLCBkYXlFbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIGRheUVsZW1lbnQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGZvY3VzT25EYXlFbGVtKHRhcmdldE5vZGUpIHtcbiAgICAgICAgdGFyZ2V0Tm9kZS5mb2N1cygpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKVxuICAgICAgICAgICAgb25Nb3VzZU92ZXIodGFyZ2V0Tm9kZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldEZpcnN0QXZhaWxhYmxlRGF5KGRlbHRhKSB7XG4gICAgICAgIHZhciBzdGFydE1vbnRoID0gZGVsdGEgPiAwID8gMCA6IHNlbGYuY29uZmlnLnNob3dNb250aHMgLSAxO1xuICAgICAgICB2YXIgZW5kTW9udGggPSBkZWx0YSA+IDAgPyBzZWxmLmNvbmZpZy5zaG93TW9udGhzIDogLTE7XG4gICAgICAgIGZvciAodmFyIG0gPSBzdGFydE1vbnRoOyBtICE9IGVuZE1vbnRoOyBtICs9IGRlbHRhKSB7XG4gICAgICAgICAgICB2YXIgbW9udGggPSBzZWxmLmRheXNDb250YWluZXIuY2hpbGRyZW5bbV07XG4gICAgICAgICAgICB2YXIgc3RhcnRJbmRleCA9IGRlbHRhID4gMCA/IDAgOiBtb250aC5jaGlsZHJlbi5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIGVuZEluZGV4ID0gZGVsdGEgPiAwID8gbW9udGguY2hpbGRyZW4ubGVuZ3RoIDogLTE7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleDsgaSAhPSBlbmRJbmRleDsgaSArPSBkZWx0YSkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gbW9udGguY2hpbGRyZW5baV07XG4gICAgICAgICAgICAgICAgaWYgKGMuY2xhc3NOYW1lLmluZGV4T2YoXCJoaWRkZW5cIikgPT09IC0xICYmIGlzRW5hYmxlZChjLmRhdGVPYmopKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXROZXh0QXZhaWxhYmxlRGF5KGN1cnJlbnQsIGRlbHRhKSB7XG4gICAgICAgIHZhciBnaXZlbk1vbnRoID0gY3VycmVudC5jbGFzc05hbWUuaW5kZXhPZihcIk1vbnRoXCIpID09PSAtMVxuICAgICAgICAgICAgPyBjdXJyZW50LmRhdGVPYmouZ2V0TW9udGgoKVxuICAgICAgICAgICAgOiBzZWxmLmN1cnJlbnRNb250aDtcbiAgICAgICAgdmFyIGVuZE1vbnRoID0gZGVsdGEgPiAwID8gc2VsZi5jb25maWcuc2hvd01vbnRocyA6IC0xO1xuICAgICAgICB2YXIgbG9vcERlbHRhID0gZGVsdGEgPiAwID8gMSA6IC0xO1xuICAgICAgICBmb3IgKHZhciBtID0gZ2l2ZW5Nb250aCAtIHNlbGYuY3VycmVudE1vbnRoOyBtICE9IGVuZE1vbnRoOyBtICs9IGxvb3BEZWx0YSkge1xuICAgICAgICAgICAgdmFyIG1vbnRoID0gc2VsZi5kYXlzQ29udGFpbmVyLmNoaWxkcmVuW21dO1xuICAgICAgICAgICAgdmFyIHN0YXJ0SW5kZXggPSBnaXZlbk1vbnRoIC0gc2VsZi5jdXJyZW50TW9udGggPT09IG1cbiAgICAgICAgICAgICAgICA/IGN1cnJlbnQuJGkgKyBkZWx0YVxuICAgICAgICAgICAgICAgIDogZGVsdGEgPCAwXG4gICAgICAgICAgICAgICAgICAgID8gbW9udGguY2hpbGRyZW4ubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICA6IDA7XG4gICAgICAgICAgICB2YXIgbnVtTW9udGhEYXlzID0gbW9udGguY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0SW5kZXg7IGkgPj0gMCAmJiBpIDwgbnVtTW9udGhEYXlzICYmIGkgIT0gKGRlbHRhID4gMCA/IG51bU1vbnRoRGF5cyA6IC0xKTsgaSArPSBsb29wRGVsdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IG1vbnRoLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjLmNsYXNzTmFtZS5pbmRleE9mKFwiaGlkZGVuXCIpID09PSAtMSAmJlxuICAgICAgICAgICAgICAgICAgICBpc0VuYWJsZWQoYy5kYXRlT2JqKSAmJlxuICAgICAgICAgICAgICAgICAgICBNYXRoLmFicyhjdXJyZW50LiRpIC0gaSkgPj0gTWF0aC5hYnMoZGVsdGEpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9jdXNPbkRheUVsZW0oYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5jaGFuZ2VNb250aChsb29wRGVsdGEpO1xuICAgICAgICBmb2N1c09uRGF5KGdldEZpcnN0QXZhaWxhYmxlRGF5KGxvb3BEZWx0YSksIDApO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmb2N1c09uRGF5KGN1cnJlbnQsIG9mZnNldCkge1xuICAgICAgICB2YXIgYWN0aXZlRWxlbWVudCA9IGdldENsb3Nlc3RBY3RpdmVFbGVtZW50KCk7XG4gICAgICAgIHZhciBkYXlGb2N1c2VkID0gaXNJblZpZXcoYWN0aXZlRWxlbWVudCB8fCBkb2N1bWVudC5ib2R5KTtcbiAgICAgICAgdmFyIHN0YXJ0RWxlbSA9IGN1cnJlbnQgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyBjdXJyZW50XG4gICAgICAgICAgICA6IGRheUZvY3VzZWRcbiAgICAgICAgICAgICAgICA/IGFjdGl2ZUVsZW1lbnRcbiAgICAgICAgICAgICAgICA6IHNlbGYuc2VsZWN0ZWREYXRlRWxlbSAhPT0gdW5kZWZpbmVkICYmIGlzSW5WaWV3KHNlbGYuc2VsZWN0ZWREYXRlRWxlbSlcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLnNlbGVjdGVkRGF0ZUVsZW1cbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLnRvZGF5RGF0ZUVsZW0gIT09IHVuZGVmaW5lZCAmJiBpc0luVmlldyhzZWxmLnRvZGF5RGF0ZUVsZW0pXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNlbGYudG9kYXlEYXRlRWxlbVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBnZXRGaXJzdEF2YWlsYWJsZURheShvZmZzZXQgPiAwID8gMSA6IC0xKTtcbiAgICAgICAgaWYgKHN0YXJ0RWxlbSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZWxmLl9pbnB1dC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFkYXlGb2N1c2VkKSB7XG4gICAgICAgICAgICBmb2N1c09uRGF5RWxlbShzdGFydEVsZW0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZ2V0TmV4dEF2YWlsYWJsZURheShzdGFydEVsZW0sIG9mZnNldCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aERheXMoeWVhciwgbW9udGgpIHtcbiAgICAgICAgdmFyIGZpcnN0T2ZNb250aCA9IChuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMSkuZ2V0RGF5KCkgLSBzZWxmLmwxMG4uZmlyc3REYXlPZldlZWsgKyA3KSAlIDc7XG4gICAgICAgIHZhciBwcmV2TW9udGhEYXlzID0gc2VsZi51dGlscy5nZXREYXlzSW5Nb250aCgobW9udGggLSAxICsgMTIpICUgMTIsIHllYXIpO1xuICAgICAgICB2YXIgZGF5c0luTW9udGggPSBzZWxmLnV0aWxzLmdldERheXNJbk1vbnRoKG1vbnRoLCB5ZWFyKSwgZGF5cyA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksIGlzTXVsdGlNb250aCA9IHNlbGYuY29uZmlnLnNob3dNb250aHMgPiAxLCBwcmV2TW9udGhEYXlDbGFzcyA9IGlzTXVsdGlNb250aCA/IFwicHJldk1vbnRoRGF5IGhpZGRlblwiIDogXCJwcmV2TW9udGhEYXlcIiwgbmV4dE1vbnRoRGF5Q2xhc3MgPSBpc011bHRpTW9udGggPyBcIm5leHRNb250aERheSBoaWRkZW5cIiA6IFwibmV4dE1vbnRoRGF5XCI7XG4gICAgICAgIHZhciBkYXlOdW1iZXIgPSBwcmV2TW9udGhEYXlzICsgMSAtIGZpcnN0T2ZNb250aCwgZGF5SW5kZXggPSAwO1xuICAgICAgICBmb3IgKDsgZGF5TnVtYmVyIDw9IHByZXZNb250aERheXM7IGRheU51bWJlcisrLCBkYXlJbmRleCsrKSB7XG4gICAgICAgICAgICBkYXlzLmFwcGVuZENoaWxkKGNyZWF0ZURheShcImZsYXRwaWNrci1kYXkgXCIgKyBwcmV2TW9udGhEYXlDbGFzcywgbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXlOdW1iZXIpLCBkYXlOdW1iZXIsIGRheUluZGV4KSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChkYXlOdW1iZXIgPSAxOyBkYXlOdW1iZXIgPD0gZGF5c0luTW9udGg7IGRheU51bWJlcisrLCBkYXlJbmRleCsrKSB7XG4gICAgICAgICAgICBkYXlzLmFwcGVuZENoaWxkKGNyZWF0ZURheShcImZsYXRwaWNrci1kYXlcIiwgbmV3IERhdGUoeWVhciwgbW9udGgsIGRheU51bWJlciksIGRheU51bWJlciwgZGF5SW5kZXgpKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBkYXlOdW0gPSBkYXlzSW5Nb250aCArIDE7IGRheU51bSA8PSA0MiAtIGZpcnN0T2ZNb250aCAmJlxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLnNob3dNb250aHMgPT09IDEgfHwgZGF5SW5kZXggJSA3ICE9PSAwKTsgZGF5TnVtKyssIGRheUluZGV4KyspIHtcbiAgICAgICAgICAgIGRheXMuYXBwZW5kQ2hpbGQoY3JlYXRlRGF5KFwiZmxhdHBpY2tyLWRheSBcIiArIG5leHRNb250aERheUNsYXNzLCBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIGRheU51bSAlIGRheXNJbk1vbnRoKSwgZGF5TnVtLCBkYXlJbmRleCkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXlDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZGF5Q29udGFpbmVyXCIpO1xuICAgICAgICBkYXlDb250YWluZXIuYXBwZW5kQ2hpbGQoZGF5cyk7XG4gICAgICAgIHJldHVybiBkYXlDb250YWluZXI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkRGF5cygpIHtcbiAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY2xlYXJOb2RlKHNlbGYuZGF5c0NvbnRhaW5lcik7XG4gICAgICAgIGlmIChzZWxmLndlZWtOdW1iZXJzKVxuICAgICAgICAgICAgY2xlYXJOb2RlKHNlbGYud2Vla051bWJlcnMpO1xuICAgICAgICB2YXIgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmNvbmZpZy5zaG93TW9udGhzOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoc2VsZi5jdXJyZW50WWVhciwgc2VsZi5jdXJyZW50TW9udGgsIDEpO1xuICAgICAgICAgICAgZC5zZXRNb250aChzZWxmLmN1cnJlbnRNb250aCArIGkpO1xuICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZChidWlsZE1vbnRoRGF5cyhkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnKTtcbiAgICAgICAgc2VsZi5kYXlzID0gc2VsZi5kYXlzQ29udGFpbmVyLmZpcnN0Q2hpbGQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIgJiYgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgb25Nb3VzZU92ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZE1vbnRoU3dpdGNoKCkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEgfHxcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vbnRoU2VsZWN0b3JUeXBlICE9PSBcImRyb3Bkb3duXCIpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzaG91bGRCdWlsZE1vbnRoID0gZnVuY3Rpb24gKG1vbnRoKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcubWluRGF0ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9PT0gc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpICYmXG4gICAgICAgICAgICAgICAgbW9udGggPCBzZWxmLmNvbmZpZy5taW5EYXRlLmdldE1vbnRoKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gIShzZWxmLmNvbmZpZy5tYXhEYXRlICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKCkgJiZcbiAgICAgICAgICAgICAgICBtb250aCA+IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0TW9udGgoKSk7XG4gICAgICAgIH07XG4gICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIudGFiSW5kZXggPSAtMTtcbiAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghc2hvdWxkQnVpbGRNb250aChpKSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIHZhciBtb250aCA9IGNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgXCJmbGF0cGlja3ItbW9udGhEcm9wZG93bi1tb250aFwiKTtcbiAgICAgICAgICAgIG1vbnRoLnZhbHVlID0gbmV3IERhdGUoc2VsZi5jdXJyZW50WWVhciwgaSkuZ2V0TW9udGgoKS50b1N0cmluZygpO1xuICAgICAgICAgICAgbW9udGgudGV4dENvbnRlbnQgPSBtb250aFRvU3RyKGksIHNlbGYuY29uZmlnLnNob3J0aGFuZEN1cnJlbnRNb250aCwgc2VsZi5sMTBuKTtcbiAgICAgICAgICAgIG1vbnRoLnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICBpZiAoc2VsZi5jdXJyZW50TW9udGggPT09IGkpIHtcbiAgICAgICAgICAgICAgICBtb250aC5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLmFwcGVuZENoaWxkKG1vbnRoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZE1vbnRoKCkge1xuICAgICAgICB2YXIgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1tb250aFwiKTtcbiAgICAgICAgdmFyIG1vbnRoTmF2RnJhZ21lbnQgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICB2YXIgbW9udGhFbGVtZW50O1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEgfHxcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vbnRoU2VsZWN0b3JUeXBlID09PSBcInN0YXRpY1wiKSB7XG4gICAgICAgICAgICBtb250aEVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImN1ci1tb250aFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwic2VsZWN0XCIsIFwiZmxhdHBpY2tyLW1vbnRoRHJvcGRvd24tbW9udGhzXCIpO1xuICAgICAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHNlbGYubDEwbi5tb250aEFyaWFMYWJlbCk7XG4gICAgICAgICAgICBiaW5kKHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIsIFwiY2hhbmdlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZE1vbnRoID0gcGFyc2VJbnQodGFyZ2V0LnZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgc2VsZi5jaGFuZ2VNb250aChzZWxlY3RlZE1vbnRoIC0gc2VsZi5jdXJyZW50TW9udGgpO1xuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uTW9udGhDaGFuZ2VcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgICAgIG1vbnRoRWxlbWVudCA9IHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHllYXJJbnB1dCA9IGNyZWF0ZU51bWJlcklucHV0KFwiY3VyLXllYXJcIiwgeyB0YWJpbmRleDogXCItMVwiIH0pO1xuICAgICAgICB2YXIgeWVhckVsZW1lbnQgPSB5ZWFySW5wdXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXTtcbiAgICAgICAgeWVhckVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBzZWxmLmwxMG4ueWVhckFyaWFMYWJlbCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5taW5EYXRlKSB7XG4gICAgICAgICAgICB5ZWFyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhEYXRlKSB7XG4gICAgICAgICAgICB5ZWFyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhcIiwgc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgeWVhckVsZW1lbnQuZGlzYWJsZWQgPVxuICAgICAgICAgICAgICAgICEhc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkgPT09IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3VycmVudE1vbnRoID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1jdXJyZW50LW1vbnRoXCIpO1xuICAgICAgICBjdXJyZW50TW9udGguYXBwZW5kQ2hpbGQobW9udGhFbGVtZW50KTtcbiAgICAgICAgY3VycmVudE1vbnRoLmFwcGVuZENoaWxkKHllYXJJbnB1dCk7XG4gICAgICAgIG1vbnRoTmF2RnJhZ21lbnQuYXBwZW5kQ2hpbGQoY3VycmVudE1vbnRoKTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG1vbnRoTmF2RnJhZ21lbnQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udGFpbmVyOiBjb250YWluZXIsXG4gICAgICAgICAgICB5ZWFyRWxlbWVudDogeWVhckVsZW1lbnQsXG4gICAgICAgICAgICBtb250aEVsZW1lbnQ6IG1vbnRoRWxlbWVudCxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aHMoKSB7XG4gICAgICAgIGNsZWFyTm9kZShzZWxmLm1vbnRoTmF2KTtcbiAgICAgICAgc2VsZi5tb250aE5hdi5hcHBlbmRDaGlsZChzZWxmLnByZXZNb250aE5hdik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5zaG93TW9udGhzKSB7XG4gICAgICAgICAgICBzZWxmLnllYXJFbGVtZW50cyA9IFtdO1xuICAgICAgICAgICAgc2VsZi5tb250aEVsZW1lbnRzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgbSA9IHNlbGYuY29uZmlnLnNob3dNb250aHM7IG0tLTspIHtcbiAgICAgICAgICAgIHZhciBtb250aCA9IGJ1aWxkTW9udGgoKTtcbiAgICAgICAgICAgIHNlbGYueWVhckVsZW1lbnRzLnB1c2gobW9udGgueWVhckVsZW1lbnQpO1xuICAgICAgICAgICAgc2VsZi5tb250aEVsZW1lbnRzLnB1c2gobW9udGgubW9udGhFbGVtZW50KTtcbiAgICAgICAgICAgIHNlbGYubW9udGhOYXYuYXBwZW5kQ2hpbGQobW9udGguY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLm1vbnRoTmF2LmFwcGVuZENoaWxkKHNlbGYubmV4dE1vbnRoTmF2KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aE5hdigpIHtcbiAgICAgICAgc2VsZi5tb250aE5hdiA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItbW9udGhzXCIpO1xuICAgICAgICBzZWxmLnllYXJFbGVtZW50cyA9IFtdO1xuICAgICAgICBzZWxmLm1vbnRoRWxlbWVudHMgPSBbXTtcbiAgICAgICAgc2VsZi5wcmV2TW9udGhOYXYgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci1wcmV2LW1vbnRoXCIpO1xuICAgICAgICBzZWxmLnByZXZNb250aE5hdi5pbm5lckhUTUwgPSBzZWxmLmNvbmZpZy5wcmV2QXJyb3c7XG4gICAgICAgIHNlbGYubmV4dE1vbnRoTmF2ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3ItbmV4dC1tb250aFwiKTtcbiAgICAgICAgc2VsZi5uZXh0TW9udGhOYXYuaW5uZXJIVE1MID0gc2VsZi5jb25maWcubmV4dEFycm93O1xuICAgICAgICBidWlsZE1vbnRocygpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZiwgXCJfaGlkZVByZXZNb250aEFycm93XCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5fX2hpZGVQcmV2TW9udGhBcnJvdzsgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGJvb2wpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fX2hpZGVQcmV2TW9udGhBcnJvdyAhPT0gYm9vbCkge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLnByZXZNb250aE5hdiwgXCJmbGF0cGlja3ItZGlzYWJsZWRcIiwgYm9vbCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX19oaWRlUHJldk1vbnRoQXJyb3cgPSBib29sO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZiwgXCJfaGlkZU5leHRNb250aEFycm93XCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5fX2hpZGVOZXh0TW9udGhBcnJvdzsgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGJvb2wpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fX2hpZGVOZXh0TW9udGhBcnJvdyAhPT0gYm9vbCkge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLm5leHRNb250aE5hdiwgXCJmbGF0cGlja3ItZGlzYWJsZWRcIiwgYm9vbCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX19oaWRlTmV4dE1vbnRoQXJyb3cgPSBib29sO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLmN1cnJlbnRZZWFyRWxlbWVudCA9IHNlbGYueWVhckVsZW1lbnRzWzBdO1xuICAgICAgICB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCk7XG4gICAgICAgIHJldHVybiBzZWxmLm1vbnRoTmF2O1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZFRpbWUoKSB7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImhhc1RpbWVcIik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5ub0NhbGVuZGFyKVxuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibm9DYWxlbmRhclwiKTtcbiAgICAgICAgdmFyIGRlZmF1bHRzID0gZ2V0RGVmYXVsdEhvdXJzKHNlbGYuY29uZmlnKTtcbiAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci10aW1lXCIpO1xuICAgICAgICBzZWxmLnRpbWVDb250YWluZXIudGFiSW5kZXggPSAtMTtcbiAgICAgICAgdmFyIHNlcGFyYXRvciA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLXRpbWUtc2VwYXJhdG9yXCIsIFwiOlwiKTtcbiAgICAgICAgdmFyIGhvdXJJbnB1dCA9IGNyZWF0ZU51bWJlcklucHV0KFwiZmxhdHBpY2tyLWhvdXJcIiwge1xuICAgICAgICAgICAgXCJhcmlhLWxhYmVsXCI6IHNlbGYubDEwbi5ob3VyQXJpYUxhYmVsLFxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudCA9IGhvdXJJbnB1dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuICAgICAgICB2YXIgbWludXRlSW5wdXQgPSBjcmVhdGVOdW1iZXJJbnB1dChcImZsYXRwaWNrci1taW51dGVcIiwge1xuICAgICAgICAgICAgXCJhcmlhLWxhYmVsXCI6IHNlbGYubDEwbi5taW51dGVBcmlhTGFiZWwsXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQgPSBtaW51dGVJbnB1dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnRhYkluZGV4ID0gc2VsZi5taW51dGVFbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQudmFsdWUgPSBwYWQoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmpcbiAgICAgICAgICAgID8gc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmouZ2V0SG91cnMoKVxuICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy50aW1lXzI0aHJcbiAgICAgICAgICAgICAgICA/IGRlZmF1bHRzLmhvdXJzXG4gICAgICAgICAgICAgICAgOiBtaWxpdGFyeTJhbXBtKGRlZmF1bHRzLmhvdXJzKSk7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC52YWx1ZSA9IHBhZChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9ialxuICAgICAgICAgICAgPyBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iai5nZXRNaW51dGVzKClcbiAgICAgICAgICAgIDogZGVmYXVsdHMubWludXRlcyk7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBzZWxmLmNvbmZpZy5ob3VySW5jcmVtZW50LnRvU3RyaW5nKCkpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBzZWxmLmNvbmZpZy5taW51dGVJbmNyZW1lbnQudG9TdHJpbmcoKSk7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWluXCIsIHNlbGYuY29uZmlnLnRpbWVfMjRociA/IFwiMFwiIDogXCIxXCIpO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heFwiLCBzZWxmLmNvbmZpZy50aW1lXzI0aHIgPyBcIjIzXCIgOiBcIjEyXCIpO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heGxlbmd0aFwiLCBcIjJcIik7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgXCIwXCIpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4XCIsIFwiNTlcIik7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhsZW5ndGhcIiwgXCIyXCIpO1xuICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoaG91cklucHV0KTtcbiAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlcGFyYXRvcik7XG4gICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChtaW51dGVJbnB1dCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy50aW1lXzI0aHIpXG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuY2xhc3NMaXN0LmFkZChcInRpbWUyNGhyXCIpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlU2Vjb25kcykge1xuICAgICAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoYXNTZWNvbmRzXCIpO1xuICAgICAgICAgICAgdmFyIHNlY29uZElucHV0ID0gY3JlYXRlTnVtYmVySW5wdXQoXCJmbGF0cGlja3Itc2Vjb25kXCIpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50ID0gc2Vjb25kSW5wdXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC52YWx1ZSA9IHBhZChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9ialxuICAgICAgICAgICAgICAgID8gc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmouZ2V0U2Vjb25kcygpXG4gICAgICAgICAgICAgICAgOiBkZWZhdWx0cy5zZWNvbmRzKTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzdGVwXCIsIHNlbGYubWludXRlRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgXCIwXCIpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heFwiLCBcIjU5XCIpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heGxlbmd0aFwiLCBcIjJcIik7XG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3ItdGltZS1zZXBhcmF0b3JcIiwgXCI6XCIpKTtcbiAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzZWNvbmRJbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy50aW1lXzI0aHIpIHtcbiAgICAgICAgICAgIHNlbGYuYW1QTSA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLWFtLXBtXCIsIHNlbGYubDEwbi5hbVBNW2ludCgoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmpcbiAgICAgICAgICAgICAgICA/IHNlbGYuaG91ckVsZW1lbnQudmFsdWVcbiAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLmRlZmF1bHRIb3VyKSA+IDExKV0pO1xuICAgICAgICAgICAgc2VsZi5hbVBNLnRpdGxlID0gc2VsZi5sMTBuLnRvZ2dsZVRpdGxlO1xuICAgICAgICAgICAgc2VsZi5hbVBNLnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZi5hbVBNKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZi50aW1lQ29udGFpbmVyO1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZFdlZWtkYXlzKCkge1xuICAgICAgICBpZiAoIXNlbGYud2Vla2RheUNvbnRhaW5lcilcbiAgICAgICAgICAgIHNlbGYud2Vla2RheUNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd2Vla2RheXNcIik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGNsZWFyTm9kZShzZWxmLndlZWtkYXlDb250YWluZXIpO1xuICAgICAgICBmb3IgKHZhciBpID0gc2VsZi5jb25maWcuc2hvd01vbnRoczsgaS0tOykge1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd2Vla2RheWNvbnRhaW5lclwiKTtcbiAgICAgICAgICAgIHNlbGYud2Vla2RheUNvbnRhaW5lci5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIHVwZGF0ZVdlZWtkYXlzKCk7XG4gICAgICAgIHJldHVybiBzZWxmLndlZWtkYXlDb250YWluZXI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZVdlZWtkYXlzKCkge1xuICAgICAgICBpZiAoIXNlbGYud2Vla2RheUNvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaXJzdERheU9mV2VlayA9IHNlbGYubDEwbi5maXJzdERheU9mV2VlaztcbiAgICAgICAgdmFyIHdlZWtkYXlzID0gX19zcHJlYWRBcnJheXMoc2VsZi5sMTBuLndlZWtkYXlzLnNob3J0aGFuZCk7XG4gICAgICAgIGlmIChmaXJzdERheU9mV2VlayA+IDAgJiYgZmlyc3REYXlPZldlZWsgPCB3ZWVrZGF5cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHdlZWtkYXlzID0gX19zcHJlYWRBcnJheXMod2Vla2RheXMuc3BsaWNlKGZpcnN0RGF5T2ZXZWVrLCB3ZWVrZGF5cy5sZW5ndGgpLCB3ZWVrZGF5cy5zcGxpY2UoMCwgZmlyc3REYXlPZldlZWspKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gc2VsZi5jb25maWcuc2hvd01vbnRoczsgaS0tOykge1xuICAgICAgICAgICAgc2VsZi53ZWVrZGF5Q29udGFpbmVyLmNoaWxkcmVuW2ldLmlubmVySFRNTCA9IFwiXFxuICAgICAgPHNwYW4gY2xhc3M9J2ZsYXRwaWNrci13ZWVrZGF5Jz5cXG4gICAgICAgIFwiICsgd2Vla2RheXMuam9pbihcIjwvc3Bhbj48c3BhbiBjbGFzcz0nZmxhdHBpY2tyLXdlZWtkYXknPlwiKSArIFwiXFxuICAgICAgPC9zcGFuPlxcbiAgICAgIFwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkV2Vla3MoKSB7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImhhc1dlZWtzXCIpO1xuICAgICAgICB2YXIgd2Vla1dyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXdlZWt3cmFwcGVyXCIpO1xuICAgICAgICB3ZWVrV3JhcHBlci5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci13ZWVrZGF5XCIsIHNlbGYubDEwbi53ZWVrQWJicmV2aWF0aW9uKSk7XG4gICAgICAgIHZhciB3ZWVrTnVtYmVycyA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd2Vla3NcIik7XG4gICAgICAgIHdlZWtXcmFwcGVyLmFwcGVuZENoaWxkKHdlZWtOdW1iZXJzKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHdlZWtXcmFwcGVyOiB3ZWVrV3JhcHBlcixcbiAgICAgICAgICAgIHdlZWtOdW1iZXJzOiB3ZWVrTnVtYmVycyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2hhbmdlTW9udGgodmFsdWUsIGlzT2Zmc2V0KSB7XG4gICAgICAgIGlmIChpc09mZnNldCA9PT0gdm9pZCAwKSB7IGlzT2Zmc2V0ID0gdHJ1ZTsgfVxuICAgICAgICB2YXIgZGVsdGEgPSBpc09mZnNldCA/IHZhbHVlIDogdmFsdWUgLSBzZWxmLmN1cnJlbnRNb250aDtcbiAgICAgICAgaWYgKChkZWx0YSA8IDAgJiYgc2VsZi5faGlkZVByZXZNb250aEFycm93ID09PSB0cnVlKSB8fFxuICAgICAgICAgICAgKGRlbHRhID4gMCAmJiBzZWxmLl9oaWRlTmV4dE1vbnRoQXJyb3cgPT09IHRydWUpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBzZWxmLmN1cnJlbnRNb250aCArPSBkZWx0YTtcbiAgICAgICAgaWYgKHNlbGYuY3VycmVudE1vbnRoIDwgMCB8fCBzZWxmLmN1cnJlbnRNb250aCA+IDExKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyICs9IHNlbGYuY3VycmVudE1vbnRoID4gMTEgPyAxIDogLTE7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IChzZWxmLmN1cnJlbnRNb250aCArIDEyKSAlIDEyO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25ZZWFyQ2hhbmdlXCIpO1xuICAgICAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkRGF5cygpO1xuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk1vbnRoQ2hhbmdlXCIpO1xuICAgICAgICB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNsZWFyKHRyaWdnZXJDaGFuZ2VFdmVudCwgdG9Jbml0aWFsKSB7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlRXZlbnQgPT09IHZvaWQgMCkgeyB0cmlnZ2VyQ2hhbmdlRXZlbnQgPSB0cnVlOyB9XG4gICAgICAgIGlmICh0b0luaXRpYWwgPT09IHZvaWQgMCkgeyB0b0luaXRpYWwgPSB0cnVlOyB9XG4gICAgICAgIHNlbGYuaW5wdXQudmFsdWUgPSBcIlwiO1xuICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIGlmIChzZWxmLm1vYmlsZUlucHV0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gW107XG4gICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAodG9Jbml0aWFsID09PSB0cnVlKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID0gc2VsZi5faW5pdGlhbERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gc2VsZi5faW5pdGlhbERhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdmFyIF9hID0gZ2V0RGVmYXVsdEhvdXJzKHNlbGYuY29uZmlnKSwgaG91cnMgPSBfYS5ob3VycywgbWludXRlcyA9IF9hLm1pbnV0ZXMsIHNlY29uZHMgPSBfYS5zZWNvbmRzO1xuICAgICAgICAgICAgc2V0SG91cnMoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYucmVkcmF3KCk7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlRXZlbnQpXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNoYW5nZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgIHNlbGYuaXNPcGVuID0gZmFsc2U7XG4gICAgICAgIGlmICghc2VsZi5pc01vYmlsZSkge1xuICAgICAgICAgICAgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5faW5wdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DbG9zZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkRlc3Ryb3lcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSBzZWxmLl9oYW5kbGVycy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgIHNlbGYuX2hhbmRsZXJzW2ldLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuX2hhbmRsZXJzID0gW107XG4gICAgICAgIGlmIChzZWxmLm1vYmlsZUlucHV0KSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5tb2JpbGVJbnB1dC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzZWxmLm1vYmlsZUlucHV0KTtcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5jYWxlbmRhckNvbnRhaW5lciAmJiBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5zdGF0aWMgJiYgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5sYXN0Q2hpbGQgJiYgd3JhcHBlci5yZW1vdmVDaGlsZCh3cmFwcGVyLmxhc3RDaGlsZCk7XG4gICAgICAgICAgICAgICAgaWYgKHdyYXBwZXIucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAod3JhcHBlci5maXJzdENoaWxkKVxuICAgICAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh3cmFwcGVyLmZpcnN0Q2hpbGQsIHdyYXBwZXIpO1xuICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQod3JhcHBlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzZWxmLmNhbGVuZGFyQ29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dCkge1xuICAgICAgICAgICAgc2VsZi5pbnB1dC50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzZWxmLmFsdElucHV0KTtcbiAgICAgICAgICAgIGRlbGV0ZSBzZWxmLmFsdElucHV0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmlucHV0KSB7XG4gICAgICAgICAgICBzZWxmLmlucHV0LnR5cGUgPSBzZWxmLmlucHV0Ll90eXBlO1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5jbGFzc0xpc3QucmVtb3ZlKFwiZmxhdHBpY2tyLWlucHV0XCIpO1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKTtcbiAgICAgICAgfVxuICAgICAgICBbXG4gICAgICAgICAgICBcIl9zaG93VGltZUlucHV0XCIsXG4gICAgICAgICAgICBcImxhdGVzdFNlbGVjdGVkRGF0ZU9ialwiLFxuICAgICAgICAgICAgXCJfaGlkZU5leHRNb250aEFycm93XCIsXG4gICAgICAgICAgICBcIl9oaWRlUHJldk1vbnRoQXJyb3dcIixcbiAgICAgICAgICAgIFwiX19oaWRlTmV4dE1vbnRoQXJyb3dcIixcbiAgICAgICAgICAgIFwiX19oaWRlUHJldk1vbnRoQXJyb3dcIixcbiAgICAgICAgICAgIFwiaXNNb2JpbGVcIixcbiAgICAgICAgICAgIFwiaXNPcGVuXCIsXG4gICAgICAgICAgICBcInNlbGVjdGVkRGF0ZUVsZW1cIixcbiAgICAgICAgICAgIFwibWluRGF0ZUhhc1RpbWVcIixcbiAgICAgICAgICAgIFwibWF4RGF0ZUhhc1RpbWVcIixcbiAgICAgICAgICAgIFwiZGF5c1wiLFxuICAgICAgICAgICAgXCJkYXlzQ29udGFpbmVyXCIsXG4gICAgICAgICAgICBcIl9pbnB1dFwiLFxuICAgICAgICAgICAgXCJfcG9zaXRpb25FbGVtZW50XCIsXG4gICAgICAgICAgICBcImlubmVyQ29udGFpbmVyXCIsXG4gICAgICAgICAgICBcInJDb250YWluZXJcIixcbiAgICAgICAgICAgIFwibW9udGhOYXZcIixcbiAgICAgICAgICAgIFwidG9kYXlEYXRlRWxlbVwiLFxuICAgICAgICAgICAgXCJjYWxlbmRhckNvbnRhaW5lclwiLFxuICAgICAgICAgICAgXCJ3ZWVrZGF5Q29udGFpbmVyXCIsXG4gICAgICAgICAgICBcInByZXZNb250aE5hdlwiLFxuICAgICAgICAgICAgXCJuZXh0TW9udGhOYXZcIixcbiAgICAgICAgICAgIFwibW9udGhzRHJvcGRvd25Db250YWluZXJcIixcbiAgICAgICAgICAgIFwiY3VycmVudE1vbnRoRWxlbWVudFwiLFxuICAgICAgICAgICAgXCJjdXJyZW50WWVhckVsZW1lbnRcIixcbiAgICAgICAgICAgIFwibmF2aWdhdGlvbkN1cnJlbnRNb250aFwiLFxuICAgICAgICAgICAgXCJzZWxlY3RlZERhdGVFbGVtXCIsXG4gICAgICAgICAgICBcImNvbmZpZ1wiLFxuICAgICAgICBdLmZvckVhY2goZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNlbGZba107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoXykgeyB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc0NhbGVuZGFyRWxlbShlbGVtKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNvbnRhaW5zKGVsZW0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBkb2N1bWVudENsaWNrKGUpIHtcbiAgICAgICAgaWYgKHNlbGYuaXNPcGVuICYmICFzZWxmLmNvbmZpZy5pbmxpbmUpIHtcbiAgICAgICAgICAgIHZhciBldmVudFRhcmdldF8xID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgICAgICB2YXIgaXNDYWxlbmRhckVsZW1lbnQgPSBpc0NhbGVuZGFyRWxlbShldmVudFRhcmdldF8xKTtcbiAgICAgICAgICAgIHZhciBpc0lucHV0ID0gZXZlbnRUYXJnZXRfMSA9PT0gc2VsZi5pbnB1dCB8fFxuICAgICAgICAgICAgICAgIGV2ZW50VGFyZ2V0XzEgPT09IHNlbGYuYWx0SW5wdXQgfHxcbiAgICAgICAgICAgICAgICBzZWxmLmVsZW1lbnQuY29udGFpbnMoZXZlbnRUYXJnZXRfMSkgfHxcbiAgICAgICAgICAgICAgICAoZS5wYXRoICYmXG4gICAgICAgICAgICAgICAgICAgIGUucGF0aC5pbmRleE9mICYmXG4gICAgICAgICAgICAgICAgICAgICh+ZS5wYXRoLmluZGV4T2Yoc2VsZi5pbnB1dCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIH5lLnBhdGguaW5kZXhPZihzZWxmLmFsdElucHV0KSkpO1xuICAgICAgICAgICAgdmFyIGxvc3RGb2N1cyA9ICFpc0lucHV0ICYmXG4gICAgICAgICAgICAgICAgIWlzQ2FsZW5kYXJFbGVtZW50ICYmXG4gICAgICAgICAgICAgICAgIWlzQ2FsZW5kYXJFbGVtKGUucmVsYXRlZFRhcmdldCk7XG4gICAgICAgICAgICB2YXIgaXNJZ25vcmVkID0gIXNlbGYuY29uZmlnLmlnbm9yZWRGb2N1c0VsZW1lbnRzLnNvbWUoZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbS5jb250YWlucyhldmVudFRhcmdldF8xKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGxvc3RGb2N1cyAmJiBpc0lnbm9yZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuYWxsb3dJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNldERhdGUoc2VsZi5faW5wdXQudmFsdWUsIGZhbHNlLCBzZWxmLmNvbmZpZy5hbHRJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5hbHRGb3JtYXRcbiAgICAgICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnRpbWVDb250YWluZXIgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50ICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbnB1dC52YWx1ZSAhPT0gXCJcIiAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGltZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIiAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAxKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBjaGFuZ2VZZWFyKG5ld1llYXIpIHtcbiAgICAgICAgaWYgKCFuZXdZZWFyIHx8XG4gICAgICAgICAgICAoc2VsZi5jb25maWcubWluRGF0ZSAmJiBuZXdZZWFyIDwgc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpKSB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1heERhdGUgJiYgbmV3WWVhciA+IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBuZXdZZWFyTnVtID0gbmV3WWVhciwgaXNOZXdZZWFyID0gc2VsZi5jdXJyZW50WWVhciAhPT0gbmV3WWVhck51bTtcbiAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9IG5ld1llYXJOdW0gfHwgc2VsZi5jdXJyZW50WWVhcjtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1heERhdGUgJiZcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPT09IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKSkge1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBNYXRoLm1pbihzZWxmLmNvbmZpZy5tYXhEYXRlLmdldE1vbnRoKCksIHNlbGYuY3VycmVudE1vbnRoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gTWF0aC5tYXgoc2VsZi5jb25maWcubWluRGF0ZS5nZXRNb250aCgpLCBzZWxmLmN1cnJlbnRNb250aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTmV3WWVhcikge1xuICAgICAgICAgICAgc2VsZi5yZWRyYXcoKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uWWVhckNoYW5nZVwiKTtcbiAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBpc0VuYWJsZWQoZGF0ZSwgdGltZWxlc3MpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAodGltZWxlc3MgPT09IHZvaWQgMCkgeyB0aW1lbGVzcyA9IHRydWU7IH1cbiAgICAgICAgdmFyIGRhdGVUb0NoZWNrID0gc2VsZi5wYXJzZURhdGUoZGF0ZSwgdW5kZWZpbmVkLCB0aW1lbGVzcyk7XG4gICAgICAgIGlmICgoc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgZGF0ZVRvQ2hlY2sgJiZcbiAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhkYXRlVG9DaGVjaywgc2VsZi5jb25maWcubWluRGF0ZSwgdGltZWxlc3MgIT09IHVuZGVmaW5lZCA/IHRpbWVsZXNzIDogIXNlbGYubWluRGF0ZUhhc1RpbWUpIDwgMCkgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICAgICAgZGF0ZVRvQ2hlY2sgJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZVRvQ2hlY2ssIHNlbGYuY29uZmlnLm1heERhdGUsIHRpbWVsZXNzICE9PSB1bmRlZmluZWQgPyB0aW1lbGVzcyA6ICFzZWxmLm1heERhdGVIYXNUaW1lKSA+IDApKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLmVuYWJsZSAmJiBzZWxmLmNvbmZpZy5kaXNhYmxlLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAoZGF0ZVRvQ2hlY2sgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgdmFyIGJvb2wgPSAhIXNlbGYuY29uZmlnLmVuYWJsZSwgYXJyYXkgPSAoX2EgPSBzZWxmLmNvbmZpZy5lbmFibGUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHNlbGYuY29uZmlnLmRpc2FibGU7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBkID0gdm9pZCAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGQgPSBhcnJheVtpXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZCA9PT0gXCJmdW5jdGlvblwiICYmXG4gICAgICAgICAgICAgICAgZChkYXRlVG9DaGVjaykpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvb2w7XG4gICAgICAgICAgICBlbHNlIGlmIChkIGluc3RhbmNlb2YgRGF0ZSAmJlxuICAgICAgICAgICAgICAgIGRhdGVUb0NoZWNrICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBkLmdldFRpbWUoKSA9PT0gZGF0ZVRvQ2hlY2suZ2V0VGltZSgpKVxuICAgICAgICAgICAgICAgIHJldHVybiBib29sO1xuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkID0gc2VsZi5wYXJzZURhdGUoZCwgdW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VkICYmIHBhcnNlZC5nZXRUaW1lKCkgPT09IGRhdGVUb0NoZWNrLmdldFRpbWUoKVxuICAgICAgICAgICAgICAgICAgICA/IGJvb2xcbiAgICAgICAgICAgICAgICAgICAgOiAhYm9vbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICAgICAgZGF0ZVRvQ2hlY2sgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGQuZnJvbSAmJlxuICAgICAgICAgICAgICAgIGQudG8gJiZcbiAgICAgICAgICAgICAgICBkYXRlVG9DaGVjay5nZXRUaW1lKCkgPj0gZC5mcm9tLmdldFRpbWUoKSAmJlxuICAgICAgICAgICAgICAgIGRhdGVUb0NoZWNrLmdldFRpbWUoKSA8PSBkLnRvLmdldFRpbWUoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gYm9vbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIWJvb2w7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzSW5WaWV3KGVsZW0pIHtcbiAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuIChlbGVtLmNsYXNzTmFtZS5pbmRleE9mKFwiaGlkZGVuXCIpID09PSAtMSAmJlxuICAgICAgICAgICAgICAgIGVsZW0uY2xhc3NOYW1lLmluZGV4T2YoXCJmbGF0cGlja3ItZGlzYWJsZWRcIikgPT09IC0xICYmXG4gICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyLmNvbnRhaW5zKGVsZW0pKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbkJsdXIoZSkge1xuICAgICAgICB2YXIgaXNJbnB1dCA9IGUudGFyZ2V0ID09PSBzZWxmLl9pbnB1dDtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZCA9IHNlbGYuX2lucHV0LnZhbHVlLnRyaW1FbmQoKSAhPT0gZ2V0RGF0ZVN0cigpO1xuICAgICAgICBpZiAoaXNJbnB1dCAmJlxuICAgICAgICAgICAgdmFsdWVDaGFuZ2VkICYmXG4gICAgICAgICAgICAhKGUucmVsYXRlZFRhcmdldCAmJiBpc0NhbGVuZGFyRWxlbShlLnJlbGF0ZWRUYXJnZXQpKSkge1xuICAgICAgICAgICAgc2VsZi5zZXREYXRlKHNlbGYuX2lucHV0LnZhbHVlLCB0cnVlLCBlLnRhcmdldCA9PT0gc2VsZi5hbHRJbnB1dFxuICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcuYWx0Rm9ybWF0XG4gICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvbktleURvd24oZSkge1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgdmFyIGlzSW5wdXQgPSBzZWxmLmNvbmZpZy53cmFwXG4gICAgICAgICAgICA/IGVsZW1lbnQuY29udGFpbnMoZXZlbnRUYXJnZXQpXG4gICAgICAgICAgICA6IGV2ZW50VGFyZ2V0ID09PSBzZWxmLl9pbnB1dDtcbiAgICAgICAgdmFyIGFsbG93SW5wdXQgPSBzZWxmLmNvbmZpZy5hbGxvd0lucHV0O1xuICAgICAgICB2YXIgYWxsb3dLZXlkb3duID0gc2VsZi5pc09wZW4gJiYgKCFhbGxvd0lucHV0IHx8ICFpc0lucHV0KTtcbiAgICAgICAgdmFyIGFsbG93SW5saW5lS2V5ZG93biA9IHNlbGYuY29uZmlnLmlubGluZSAmJiBpc0lucHV0ICYmICFhbGxvd0lucHV0O1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAxMyAmJiBpc0lucHV0KSB7XG4gICAgICAgICAgICBpZiAoYWxsb3dJbnB1dCkge1xuICAgICAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShzZWxmLl9pbnB1dC52YWx1ZSwgdHJ1ZSwgZXZlbnRUYXJnZXQgPT09IHNlbGYuYWx0SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5hbHRGb3JtYXRcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYub3BlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzQ2FsZW5kYXJFbGVtKGV2ZW50VGFyZ2V0KSB8fFxuICAgICAgICAgICAgYWxsb3dLZXlkb3duIHx8XG4gICAgICAgICAgICBhbGxvd0lubGluZUtleWRvd24pIHtcbiAgICAgICAgICAgIHZhciBpc1RpbWVPYmogPSAhIXNlbGYudGltZUNvbnRhaW5lciAmJlxuICAgICAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5jb250YWlucyhldmVudFRhcmdldCk7XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1RpbWVPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzQW5kQ2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3REYXRlKGUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzQW5kQ2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIGNhc2UgNDY6XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lucHV0ICYmICFzZWxmLmNvbmZpZy5hbGxvd0lucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgICAgICBjYXNlIDM5OlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGltZU9iaiAmJiAhaXNJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBnZXRDbG9zZXN0QWN0aXZlRWxlbWVudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGFsbG93SW5wdXQgPT09IGZhbHNlIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhY3RpdmVFbGVtZW50ICYmIGlzSW5WaWV3KGFjdGl2ZUVsZW1lbnQpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGFfMSA9IGUua2V5Q29kZSA9PT0gMzkgPyAxIDogLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmN0cmxLZXkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzT25EYXkodW5kZWZpbmVkLCBkZWx0YV8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlTW9udGgoZGVsdGFfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzT25EYXkoZ2V0Rmlyc3RBdmFpbGFibGVEYXkoMSksIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzZWxmLmhvdXJFbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhID0gZS5rZXlDb2RlID09PSA0MCA/IDEgOiAtMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChzZWxmLmRheXNDb250YWluZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VGFyZ2V0LiRpICE9PSB1bmRlZmluZWQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldCA9PT0gc2VsZi5pbnB1dCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRUYXJnZXQgPT09IHNlbGYuYWx0SW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVllYXIoc2VsZi5jdXJyZW50WWVhciAtIGRlbHRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09uRGF5KGdldEZpcnN0QXZhaWxhYmxlRGF5KDEpLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFpc1RpbWVPYmopXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPbkRheSh1bmRlZmluZWQsIGRlbHRhICogNyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQgPT09IHNlbGYuY3VycmVudFllYXJFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VZZWFyKHNlbGYuY3VycmVudFllYXIgLSBkZWx0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1RpbWVPYmogJiYgc2VsZi5ob3VyRWxlbWVudClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaW1lKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGVib3VuY2VkQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNUaW1lT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYW1QTSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KHNlbGYucGx1Z2luRWxlbWVudHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGVsZW1zLmluZGV4T2YoZXZlbnRUYXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGVsZW1zW2kgKyAoZS5zaGlmdEtleSA/IC0xIDogMSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGFyZ2V0IHx8IHNlbGYuX2lucHV0KS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzZWxmLmNvbmZpZy5ub0NhbGVuZGFyICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci5jb250YWlucyhldmVudFRhcmdldCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkICYmIGV2ZW50VGFyZ2V0ID09PSBzZWxmLmFtUE0pIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGYubDEwbi5hbVBNWzBdLmNoYXJBdCgwKTpcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGYubDEwbi5hbVBNWzBdLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFtUE0udGV4dENvbnRlbnQgPSBzZWxmLmwxMG4uYW1QTVswXTtcbiAgICAgICAgICAgICAgICAgICAgc2V0SG91cnNGcm9tSW5wdXRzKCk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZi5sMTBuLmFtUE1bMV0uY2hhckF0KDApOlxuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZi5sMTBuLmFtUE1bMV0uY2hhckF0KDApLnRvTG93ZXJDYXNlKCk6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9IHNlbGYubDEwbi5hbVBNWzFdO1xuICAgICAgICAgICAgICAgICAgICBzZXRIb3Vyc0Zyb21JbnB1dHMoKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzSW5wdXQgfHwgaXNDYWxlbmRhckVsZW0oZXZlbnRUYXJnZXQpKSB7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbktleURvd25cIiwgZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb25Nb3VzZU92ZXIoZWxlbSwgY2VsbENsYXNzKSB7XG4gICAgICAgIGlmIChjZWxsQ2xhc3MgPT09IHZvaWQgMCkgeyBjZWxsQ2xhc3MgPSBcImZsYXRwaWNrci1kYXlcIjsgfVxuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCAhPT0gMSB8fFxuICAgICAgICAgICAgKGVsZW0gJiZcbiAgICAgICAgICAgICAgICAoIWVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKGNlbGxDbGFzcykgfHxcbiAgICAgICAgICAgICAgICAgICAgZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJmbGF0cGlja3ItZGlzYWJsZWRcIikpKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGhvdmVyRGF0ZSA9IGVsZW1cbiAgICAgICAgICAgID8gZWxlbS5kYXRlT2JqLmdldFRpbWUoKVxuICAgICAgICAgICAgOiBzZWxmLmRheXMuZmlyc3RFbGVtZW50Q2hpbGQuZGF0ZU9iai5nZXRUaW1lKCksIGluaXRpYWxEYXRlID0gc2VsZi5wYXJzZURhdGUoc2VsZi5zZWxlY3RlZERhdGVzWzBdLCB1bmRlZmluZWQsIHRydWUpLmdldFRpbWUoKSwgcmFuZ2VTdGFydERhdGUgPSBNYXRoLm1pbihob3ZlckRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXS5nZXRUaW1lKCkpLCByYW5nZUVuZERhdGUgPSBNYXRoLm1heChob3ZlckRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXS5nZXRUaW1lKCkpO1xuICAgICAgICB2YXIgY29udGFpbnNEaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgbWluUmFuZ2UgPSAwLCBtYXhSYW5nZSA9IDA7XG4gICAgICAgIGZvciAodmFyIHQgPSByYW5nZVN0YXJ0RGF0ZTsgdCA8IHJhbmdlRW5kRGF0ZTsgdCArPSBkdXJhdGlvbi5EQVkpIHtcbiAgICAgICAgICAgIGlmICghaXNFbmFibGVkKG5ldyBEYXRlKHQpLCB0cnVlKSkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5zRGlzYWJsZWQgPVxuICAgICAgICAgICAgICAgICAgICBjb250YWluc0Rpc2FibGVkIHx8ICh0ID4gcmFuZ2VTdGFydERhdGUgJiYgdCA8IHJhbmdlRW5kRGF0ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHQgPCBpbml0aWFsRGF0ZSAmJiAoIW1pblJhbmdlIHx8IHQgPiBtaW5SYW5nZSkpXG4gICAgICAgICAgICAgICAgICAgIG1pblJhbmdlID0gdDtcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0ID4gaW5pdGlhbERhdGUgJiYgKCFtYXhSYW5nZSB8fCB0IDwgbWF4UmFuZ2UpKVxuICAgICAgICAgICAgICAgICAgICBtYXhSYW5nZSA9IHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhvdmVyYWJsZUNlbGxzID0gQXJyYXkuZnJvbShzZWxmLnJDb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIio6bnRoLWNoaWxkKC1uK1wiICsgc2VsZi5jb25maWcuc2hvd01vbnRocyArIFwiKSA+IC5cIiArIGNlbGxDbGFzcykpO1xuICAgICAgICBob3ZlcmFibGVDZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChkYXlFbGVtKSB7XG4gICAgICAgICAgICB2YXIgZGF0ZSA9IGRheUVsZW0uZGF0ZU9iajtcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSBkYXRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgIHZhciBvdXRPZlJhbmdlID0gKG1pblJhbmdlID4gMCAmJiB0aW1lc3RhbXAgPCBtaW5SYW5nZSkgfHxcbiAgICAgICAgICAgICAgICAobWF4UmFuZ2UgPiAwICYmIHRpbWVzdGFtcCA+IG1heFJhbmdlKTtcbiAgICAgICAgICAgIGlmIChvdXRPZlJhbmdlKSB7XG4gICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QuYWRkKFwibm90QWxsb3dlZFwiKTtcbiAgICAgICAgICAgICAgICBbXCJpblJhbmdlXCIsIFwic3RhcnRSYW5nZVwiLCBcImVuZFJhbmdlXCJdLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QucmVtb3ZlKGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbnRhaW5zRGlzYWJsZWQgJiYgIW91dE9mUmFuZ2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgW1wic3RhcnRSYW5nZVwiLCBcImluUmFuZ2VcIiwgXCJlbmRSYW5nZVwiLCBcIm5vdEFsbG93ZWRcIl0uZm9yRWFjaChmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgICAgIGRheUVsZW0uY2xhc3NMaXN0LnJlbW92ZShjKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGVsZW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZChob3ZlckRhdGUgPD0gc2VsZi5zZWxlY3RlZERhdGVzWzBdLmdldFRpbWUoKVxuICAgICAgICAgICAgICAgICAgICA/IFwic3RhcnRSYW5nZVwiXG4gICAgICAgICAgICAgICAgICAgIDogXCJlbmRSYW5nZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhbERhdGUgPCBob3ZlckRhdGUgJiYgdGltZXN0YW1wID09PSBpbml0aWFsRGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QuYWRkKFwic3RhcnRSYW5nZVwiKTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpbml0aWFsRGF0ZSA+IGhvdmVyRGF0ZSAmJiB0aW1lc3RhbXAgPT09IGluaXRpYWxEYXRlKVxuICAgICAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5hZGQoXCJlbmRSYW5nZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAodGltZXN0YW1wID49IG1pblJhbmdlICYmXG4gICAgICAgICAgICAgICAgICAgIChtYXhSYW5nZSA9PT0gMCB8fCB0aW1lc3RhbXAgPD0gbWF4UmFuZ2UpICYmXG4gICAgICAgICAgICAgICAgICAgIGlzQmV0d2Vlbih0aW1lc3RhbXAsIGluaXRpYWxEYXRlLCBob3ZlckRhdGUpKVxuICAgICAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5hZGQoXCJpblJhbmdlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25SZXNpemUoKSB7XG4gICAgICAgIGlmIChzZWxmLmlzT3BlbiAmJiAhc2VsZi5jb25maWcuc3RhdGljICYmICFzZWxmLmNvbmZpZy5pbmxpbmUpXG4gICAgICAgICAgICBwb3NpdGlvbkNhbGVuZGFyKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9wZW4oZSwgcG9zaXRpb25FbGVtZW50KSB7XG4gICAgICAgIGlmIChwb3NpdGlvbkVsZW1lbnQgPT09IHZvaWQgMCkgeyBwb3NpdGlvbkVsZW1lbnQgPSBzZWxmLl9wb3NpdGlvbkVsZW1lbnQ7IH1cbiAgICAgICAgaWYgKHNlbGYuaXNNb2JpbGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHZhciBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudFRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYubW9iaWxlSW5wdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LmNsaWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk9wZW5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5faW5wdXQuZGlzYWJsZWQgfHwgc2VsZi5jb25maWcuaW5saW5lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdhc09wZW4gPSBzZWxmLmlzT3BlbjtcbiAgICAgICAgc2VsZi5pc09wZW4gPSB0cnVlO1xuICAgICAgICBpZiAoIXdhc09wZW4pIHtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgICAgICBzZWxmLl9pbnB1dC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25PcGVuXCIpO1xuICAgICAgICAgICAgcG9zaXRpb25DYWxlbmRhcihwb3NpdGlvbkVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5lbmFibGVUaW1lID09PSB0cnVlICYmIHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5hbGxvd0lucHV0ID09PSBmYWxzZSAmJlxuICAgICAgICAgICAgICAgIChlID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgIXNlbGYudGltZUNvbnRhaW5lci5jb250YWlucyhlLnJlbGF0ZWRUYXJnZXQpKSkge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5ob3VyRWxlbWVudC5zZWxlY3QoKTsgfSwgNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIG1pbk1heERhdGVTZXR0ZXIodHlwZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGUpIHtcbiAgICAgICAgICAgIHZhciBkYXRlT2JqID0gKHNlbGYuY29uZmlnW1wiX1wiICsgdHlwZSArIFwiRGF0ZVwiXSA9IHNlbGYucGFyc2VEYXRlKGRhdGUsIHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpKTtcbiAgICAgICAgICAgIHZhciBpbnZlcnNlRGF0ZU9iaiA9IHNlbGYuY29uZmlnW1wiX1wiICsgKHR5cGUgPT09IFwibWluXCIgPyBcIm1heFwiIDogXCJtaW5cIikgKyBcIkRhdGVcIl07XG4gICAgICAgICAgICBpZiAoZGF0ZU9iaiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZlt0eXBlID09PSBcIm1pblwiID8gXCJtaW5EYXRlSGFzVGltZVwiIDogXCJtYXhEYXRlSGFzVGltZVwiXSA9XG4gICAgICAgICAgICAgICAgICAgIGRhdGVPYmouZ2V0SG91cnMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVPYmouZ2V0TWludXRlcygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iai5nZXRTZWNvbmRzKCkgPiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcykge1xuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IHNlbGYuc2VsZWN0ZWREYXRlcy5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGlzRW5hYmxlZChkKTsgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoICYmIHR5cGUgPT09IFwibWluXCIpXG4gICAgICAgICAgICAgICAgICAgIHNldEhvdXJzRnJvbURhdGUoZGF0ZU9iaik7XG4gICAgICAgICAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICByZWRyYXcoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0ZU9iaiAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyRWxlbWVudFt0eXBlXSA9IGRhdGVPYmouZ2V0RnVsbFllYXIoKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhckVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHR5cGUpO1xuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXJFbGVtZW50LmRpc2FibGVkID1cbiAgICAgICAgICAgICAgICAgICAgISFpbnZlcnNlRGF0ZU9iaiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iaiAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlRGF0ZU9iai5nZXRGdWxsWWVhcigpID09PSBkYXRlT2JqLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBhcnNlQ29uZmlnKCkge1xuICAgICAgICB2YXIgYm9vbE9wdHMgPSBbXG4gICAgICAgICAgICBcIndyYXBcIixcbiAgICAgICAgICAgIFwid2Vla051bWJlcnNcIixcbiAgICAgICAgICAgIFwiYWxsb3dJbnB1dFwiLFxuICAgICAgICAgICAgXCJhbGxvd0ludmFsaWRQcmVsb2FkXCIsXG4gICAgICAgICAgICBcImNsaWNrT3BlbnNcIixcbiAgICAgICAgICAgIFwidGltZV8yNGhyXCIsXG4gICAgICAgICAgICBcImVuYWJsZVRpbWVcIixcbiAgICAgICAgICAgIFwibm9DYWxlbmRhclwiLFxuICAgICAgICAgICAgXCJhbHRJbnB1dFwiLFxuICAgICAgICAgICAgXCJzaG9ydGhhbmRDdXJyZW50TW9udGhcIixcbiAgICAgICAgICAgIFwiaW5saW5lXCIsXG4gICAgICAgICAgICBcInN0YXRpY1wiLFxuICAgICAgICAgICAgXCJlbmFibGVTZWNvbmRzXCIsXG4gICAgICAgICAgICBcImRpc2FibGVNb2JpbGVcIixcbiAgICAgICAgXTtcbiAgICAgICAgdmFyIHVzZXJDb25maWcgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlbGVtZW50LmRhdGFzZXQgfHwge30pKSksIGluc3RhbmNlQ29uZmlnKTtcbiAgICAgICAgdmFyIGZvcm1hdHMgPSB7fTtcbiAgICAgICAgc2VsZi5jb25maWcucGFyc2VEYXRlID0gdXNlckNvbmZpZy5wYXJzZURhdGU7XG4gICAgICAgIHNlbGYuY29uZmlnLmZvcm1hdERhdGUgPSB1c2VyQ29uZmlnLmZvcm1hdERhdGU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJlbmFibGVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fZW5hYmxlOyB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5fZW5hYmxlID0gcGFyc2VEYXRlUnVsZXMoZGF0ZXMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJkaXNhYmxlXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5jb25maWcuX2Rpc2FibGU7IH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChkYXRlcykge1xuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLl9kaXNhYmxlID0gcGFyc2VEYXRlUnVsZXMoZGF0ZXMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB0aW1lTW9kZSA9IHVzZXJDb25maWcubW9kZSA9PT0gXCJ0aW1lXCI7XG4gICAgICAgIGlmICghdXNlckNvbmZpZy5kYXRlRm9ybWF0ICYmICh1c2VyQ29uZmlnLmVuYWJsZVRpbWUgfHwgdGltZU1vZGUpKSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdERhdGVGb3JtYXQgPSBmbGF0cGlja3IuZGVmYXVsdENvbmZpZy5kYXRlRm9ybWF0IHx8IGRlZmF1bHRPcHRpb25zLmRhdGVGb3JtYXQ7XG4gICAgICAgICAgICBmb3JtYXRzLmRhdGVGb3JtYXQgPVxuICAgICAgICAgICAgICAgIHVzZXJDb25maWcubm9DYWxlbmRhciB8fCB0aW1lTW9kZVxuICAgICAgICAgICAgICAgICAgICA/IFwiSDppXCIgKyAodXNlckNvbmZpZy5lbmFibGVTZWNvbmRzID8gXCI6U1wiIDogXCJcIilcbiAgICAgICAgICAgICAgICAgICAgOiBkZWZhdWx0RGF0ZUZvcm1hdCArIFwiIEg6aVwiICsgKHVzZXJDb25maWcuZW5hYmxlU2Vjb25kcyA/IFwiOlNcIiA6IFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VyQ29uZmlnLmFsdElucHV0ICYmXG4gICAgICAgICAgICAodXNlckNvbmZpZy5lbmFibGVUaW1lIHx8IHRpbWVNb2RlKSAmJlxuICAgICAgICAgICAgIXVzZXJDb25maWcuYWx0Rm9ybWF0KSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEFsdEZvcm1hdCA9IGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnLmFsdEZvcm1hdCB8fCBkZWZhdWx0T3B0aW9ucy5hbHRGb3JtYXQ7XG4gICAgICAgICAgICBmb3JtYXRzLmFsdEZvcm1hdCA9XG4gICAgICAgICAgICAgICAgdXNlckNvbmZpZy5ub0NhbGVuZGFyIHx8IHRpbWVNb2RlXG4gICAgICAgICAgICAgICAgICAgID8gXCJoOmlcIiArICh1c2VyQ29uZmlnLmVuYWJsZVNlY29uZHMgPyBcIjpTIEtcIiA6IFwiIEtcIilcbiAgICAgICAgICAgICAgICAgICAgOiBkZWZhdWx0QWx0Rm9ybWF0ICsgKFwiIGg6aVwiICsgKHVzZXJDb25maWcuZW5hYmxlU2Vjb25kcyA/IFwiOlNcIiA6IFwiXCIpICsgXCIgS1wiKTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwibWluRGF0ZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9taW5EYXRlOyB9LFxuICAgICAgICAgICAgc2V0OiBtaW5NYXhEYXRlU2V0dGVyKFwibWluXCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcIm1heERhdGVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fbWF4RGF0ZTsgfSxcbiAgICAgICAgICAgIHNldDogbWluTWF4RGF0ZVNldHRlcihcIm1heFwiKSxcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBtaW5NYXhUaW1lU2V0dGVyID0gZnVuY3Rpb24gKHR5cGUpIHsgcmV0dXJuIGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnW3R5cGUgPT09IFwibWluXCIgPyBcIl9taW5UaW1lXCIgOiBcIl9tYXhUaW1lXCJdID0gc2VsZi5wYXJzZURhdGUodmFsLCBcIkg6aTpTXCIpO1xuICAgICAgICB9OyB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwibWluVGltZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9taW5UaW1lOyB9LFxuICAgICAgICAgICAgc2V0OiBtaW5NYXhUaW1lU2V0dGVyKFwibWluXCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcIm1heFRpbWVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fbWF4VGltZTsgfSxcbiAgICAgICAgICAgIHNldDogbWluTWF4VGltZVNldHRlcihcIm1heFwiKSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VyQ29uZmlnLm1vZGUgPT09IFwidGltZVwiKSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5ub0NhbGVuZGFyID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVuYWJsZVRpbWUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5hc3NpZ24oc2VsZi5jb25maWcsIGZvcm1hdHMsIHVzZXJDb25maWcpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvb2xPcHRzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgc2VsZi5jb25maWdbYm9vbE9wdHNbaV1dID1cbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1tib29sT3B0c1tpXV0gPT09IHRydWUgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWdbYm9vbE9wdHNbaV1dID09PSBcInRydWVcIjtcbiAgICAgICAgSE9PS1MuZmlsdGVyKGZ1bmN0aW9uIChob29rKSB7IHJldHVybiBzZWxmLmNvbmZpZ1tob29rXSAhPT0gdW5kZWZpbmVkOyB9KS5mb3JFYWNoKGZ1bmN0aW9uIChob29rKSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZ1tob29rXSA9IGFycmF5aWZ5KHNlbGYuY29uZmlnW2hvb2tdIHx8IFtdKS5tYXAoYmluZFRvSW5zdGFuY2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5pc01vYmlsZSA9XG4gICAgICAgICAgICAhc2VsZi5jb25maWcuZGlzYWJsZU1vYmlsZSAmJlxuICAgICAgICAgICAgICAgICFzZWxmLmNvbmZpZy5pbmxpbmUgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5tb2RlID09PSBcInNpbmdsZVwiICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLmRpc2FibGUubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLmVuYWJsZSAmJlxuICAgICAgICAgICAgICAgICFzZWxmLmNvbmZpZy53ZWVrTnVtYmVycyAmJlxuICAgICAgICAgICAgICAgIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmNvbmZpZy5wbHVnaW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcGx1Z2luQ29uZiA9IHNlbGYuY29uZmlnLnBsdWdpbnNbaV0oc2VsZikgfHwge307XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcGx1Z2luQ29uZikge1xuICAgICAgICAgICAgICAgIGlmIChIT09LUy5pbmRleE9mKGtleSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1trZXldID0gYXJyYXlpZnkocGx1Z2luQ29uZltrZXldKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChiaW5kVG9JbnN0YW5jZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoc2VsZi5jb25maWdba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB1c2VyQ29uZmlnW2tleV0gPT09IFwidW5kZWZpbmVkXCIpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnW2tleV0gPSBwbHVnaW5Db25mW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF1c2VyQ29uZmlnLmFsdElucHV0Q2xhc3MpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmFsdElucHV0Q2xhc3MgPVxuICAgICAgICAgICAgICAgIGdldElucHV0RWxlbSgpLmNsYXNzTmFtZSArIFwiIFwiICsgc2VsZi5jb25maWcuYWx0SW5wdXRDbGFzcztcbiAgICAgICAgfVxuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblBhcnNlQ29uZmlnXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRJbnB1dEVsZW0oKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmNvbmZpZy53cmFwXG4gICAgICAgICAgICA/IGVsZW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWlucHV0XVwiKVxuICAgICAgICAgICAgOiBlbGVtZW50O1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cExvY2FsZSgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmLmNvbmZpZy5sb2NhbGUgIT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgIHR5cGVvZiBmbGF0cGlja3IubDEwbnNbc2VsZi5jb25maWcubG9jYWxlXSA9PT0gXCJ1bmRlZmluZWRcIilcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVycm9ySGFuZGxlcihuZXcgRXJyb3IoXCJmbGF0cGlja3I6IGludmFsaWQgbG9jYWxlIFwiICsgc2VsZi5jb25maWcubG9jYWxlKSk7XG4gICAgICAgIHNlbGYubDEwbiA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBmbGF0cGlja3IubDEwbnMuZGVmYXVsdCksICh0eXBlb2Ygc2VsZi5jb25maWcubG9jYWxlID09PSBcIm9iamVjdFwiXG4gICAgICAgICAgICA/IHNlbGYuY29uZmlnLmxvY2FsZVxuICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5sb2NhbGUgIT09IFwiZGVmYXVsdFwiXG4gICAgICAgICAgICAgICAgPyBmbGF0cGlja3IubDEwbnNbc2VsZi5jb25maWcubG9jYWxlXVxuICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkKSk7XG4gICAgICAgIHRva2VuUmVnZXguRCA9IFwiKFwiICsgc2VsZi5sMTBuLndlZWtkYXlzLnNob3J0aGFuZC5qb2luKFwifFwiKSArIFwiKVwiO1xuICAgICAgICB0b2tlblJlZ2V4LmwgPSBcIihcIiArIHNlbGYubDEwbi53ZWVrZGF5cy5sb25naGFuZC5qb2luKFwifFwiKSArIFwiKVwiO1xuICAgICAgICB0b2tlblJlZ2V4Lk0gPSBcIihcIiArIHNlbGYubDEwbi5tb250aHMuc2hvcnRoYW5kLmpvaW4oXCJ8XCIpICsgXCIpXCI7XG4gICAgICAgIHRva2VuUmVnZXguRiA9IFwiKFwiICsgc2VsZi5sMTBuLm1vbnRocy5sb25naGFuZC5qb2luKFwifFwiKSArIFwiKVwiO1xuICAgICAgICB0b2tlblJlZ2V4LksgPSBcIihcIiArIHNlbGYubDEwbi5hbVBNWzBdICsgXCJ8XCIgKyBzZWxmLmwxMG4uYW1QTVsxXSArIFwifFwiICsgc2VsZi5sMTBuLmFtUE1bMF0udG9Mb3dlckNhc2UoKSArIFwifFwiICsgc2VsZi5sMTBuLmFtUE1bMV0udG9Mb3dlckNhc2UoKSArIFwiKVwiO1xuICAgICAgICB2YXIgdXNlckNvbmZpZyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBpbnN0YW5jZUNvbmZpZyksIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZWxlbWVudC5kYXRhc2V0IHx8IHt9KSkpO1xuICAgICAgICBpZiAodXNlckNvbmZpZy50aW1lXzI0aHIgPT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgZmxhdHBpY2tyLmRlZmF1bHRDb25maWcudGltZV8yNGhyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLnRpbWVfMjRociA9IHNlbGYubDEwbi50aW1lXzI0aHI7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5mb3JtYXREYXRlID0gY3JlYXRlRGF0ZUZvcm1hdHRlcihzZWxmKTtcbiAgICAgICAgc2VsZi5wYXJzZURhdGUgPSBjcmVhdGVEYXRlUGFyc2VyKHsgY29uZmlnOiBzZWxmLmNvbmZpZywgbDEwbjogc2VsZi5sMTBuIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBwb3NpdGlvbkNhbGVuZGFyKGN1c3RvbVBvc2l0aW9uRWxlbWVudCkge1xuICAgICAgICBpZiAodHlwZW9mIHNlbGYuY29uZmlnLnBvc2l0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB2b2lkIHNlbGYuY29uZmlnLnBvc2l0aW9uKHNlbGYsIGN1c3RvbVBvc2l0aW9uRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25QcmVDYWxlbmRhclBvc2l0aW9uXCIpO1xuICAgICAgICB2YXIgcG9zaXRpb25FbGVtZW50ID0gY3VzdG9tUG9zaXRpb25FbGVtZW50IHx8IHNlbGYuX3Bvc2l0aW9uRWxlbWVudDtcbiAgICAgICAgdmFyIGNhbGVuZGFySGVpZ2h0ID0gQXJyYXkucHJvdG90eXBlLnJlZHVjZS5jYWxsKHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2hpbGRyZW4sIChmdW5jdGlvbiAoYWNjLCBjaGlsZCkgeyByZXR1cm4gYWNjICsgY2hpbGQub2Zmc2V0SGVpZ2h0OyB9KSwgMCksIGNhbGVuZGFyV2lkdGggPSBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLm9mZnNldFdpZHRoLCBjb25maWdQb3MgPSBzZWxmLmNvbmZpZy5wb3NpdGlvbi5zcGxpdChcIiBcIiksIGNvbmZpZ1Bvc1ZlcnRpY2FsID0gY29uZmlnUG9zWzBdLCBjb25maWdQb3NIb3Jpem9udGFsID0gY29uZmlnUG9zLmxlbmd0aCA+IDEgPyBjb25maWdQb3NbMV0gOiBudWxsLCBpbnB1dEJvdW5kcyA9IHBvc2l0aW9uRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgZGlzdGFuY2VGcm9tQm90dG9tID0gd2luZG93LmlubmVySGVpZ2h0IC0gaW5wdXRCb3VuZHMuYm90dG9tLCBzaG93T25Ub3AgPSBjb25maWdQb3NWZXJ0aWNhbCA9PT0gXCJhYm92ZVwiIHx8XG4gICAgICAgICAgICAoY29uZmlnUG9zVmVydGljYWwgIT09IFwiYmVsb3dcIiAmJlxuICAgICAgICAgICAgICAgIGRpc3RhbmNlRnJvbUJvdHRvbSA8IGNhbGVuZGFySGVpZ2h0ICYmXG4gICAgICAgICAgICAgICAgaW5wdXRCb3VuZHMudG9wID4gY2FsZW5kYXJIZWlnaHQpO1xuICAgICAgICB2YXIgdG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0ICtcbiAgICAgICAgICAgIGlucHV0Qm91bmRzLnRvcCArXG4gICAgICAgICAgICAoIXNob3dPblRvcCA/IHBvc2l0aW9uRWxlbWVudC5vZmZzZXRIZWlnaHQgKyAyIDogLWNhbGVuZGFySGVpZ2h0IC0gMik7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYXJyb3dUb3BcIiwgIXNob3dPblRvcCk7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYXJyb3dCb3R0b21cIiwgc2hvd09uVG9wKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmlubGluZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGxlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgKyBpbnB1dEJvdW5kcy5sZWZ0O1xuICAgICAgICB2YXIgaXNDZW50ZXIgPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzUmlnaHQgPSBmYWxzZTtcbiAgICAgICAgaWYgKGNvbmZpZ1Bvc0hvcml6b250YWwgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgIGxlZnQgLT0gKGNhbGVuZGFyV2lkdGggLSBpbnB1dEJvdW5kcy53aWR0aCkgLyAyO1xuICAgICAgICAgICAgaXNDZW50ZXIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbmZpZ1Bvc0hvcml6b250YWwgPT09IFwicmlnaHRcIikge1xuICAgICAgICAgICAgbGVmdCAtPSBjYWxlbmRhcldpZHRoIC0gaW5wdXRCb3VuZHMud2lkdGg7XG4gICAgICAgICAgICBpc1JpZ2h0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFycm93TGVmdFwiLCAhaXNDZW50ZXIgJiYgIWlzUmlnaHQpO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFycm93Q2VudGVyXCIsIGlzQ2VudGVyKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhcnJvd1JpZ2h0XCIsIGlzUmlnaHQpO1xuICAgICAgICB2YXIgcmlnaHQgPSB3aW5kb3cuZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCAtXG4gICAgICAgICAgICAod2luZG93LnBhZ2VYT2Zmc2V0ICsgaW5wdXRCb3VuZHMucmlnaHQpO1xuICAgICAgICB2YXIgcmlnaHRNb3N0ID0gbGVmdCArIGNhbGVuZGFyV2lkdGggPiB3aW5kb3cuZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aDtcbiAgICAgICAgdmFyIGNlbnRlck1vc3QgPSByaWdodCArIGNhbGVuZGFyV2lkdGggPiB3aW5kb3cuZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aDtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJyaWdodE1vc3RcIiwgcmlnaHRNb3N0KTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLnN0YXRpYylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS50b3AgPSB0b3AgKyBcInB4XCI7XG4gICAgICAgIGlmICghcmlnaHRNb3N0KSB7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmxlZnQgPSBsZWZ0ICsgXCJweFwiO1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5yaWdodCA9IFwiYXV0b1wiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFjZW50ZXJNb3N0KSB7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmxlZnQgPSBcImF1dG9cIjtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmlnaHQgPSByaWdodCArIFwicHhcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkb2MgPSBnZXREb2N1bWVudFN0eWxlU2hlZXQoKTtcbiAgICAgICAgICAgIGlmIChkb2MgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB2YXIgYm9keVdpZHRoID0gd2luZG93LmRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICB2YXIgY2VudGVyTGVmdCA9IE1hdGgubWF4KDAsIGJvZHlXaWR0aCAvIDIgLSBjYWxlbmRhcldpZHRoIC8gMik7XG4gICAgICAgICAgICB2YXIgY2VudGVyQmVmb3JlID0gXCIuZmxhdHBpY2tyLWNhbGVuZGFyLmNlbnRlck1vc3Q6YmVmb3JlXCI7XG4gICAgICAgICAgICB2YXIgY2VudGVyQWZ0ZXIgPSBcIi5mbGF0cGlja3ItY2FsZW5kYXIuY2VudGVyTW9zdDphZnRlclwiO1xuICAgICAgICAgICAgdmFyIGNlbnRlckluZGV4ID0gZG9jLmNzc1J1bGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBjZW50ZXJTdHlsZSA9IFwie2xlZnQ6XCIgKyBpbnB1dEJvdW5kcy5sZWZ0ICsgXCJweDtyaWdodDphdXRvO31cIjtcbiAgICAgICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwicmlnaHRNb3N0XCIsIGZhbHNlKTtcbiAgICAgICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiY2VudGVyTW9zdFwiLCB0cnVlKTtcbiAgICAgICAgICAgIGRvYy5pbnNlcnRSdWxlKGNlbnRlckJlZm9yZSArIFwiLFwiICsgY2VudGVyQWZ0ZXIgKyBjZW50ZXJTdHlsZSwgY2VudGVySW5kZXgpO1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gY2VudGVyTGVmdCArIFwicHhcIjtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmlnaHQgPSBcImF1dG9cIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBnZXREb2N1bWVudFN0eWxlU2hlZXQoKSB7XG4gICAgICAgIHZhciBlZGl0YWJsZVNoZWV0ID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNoZWV0ID0gZG9jdW1lbnQuc3R5bGVTaGVldHNbaV07XG4gICAgICAgICAgICBpZiAoIXNoZWV0LmNzc1J1bGVzKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBzaGVldC5jc3NSdWxlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRhYmxlU2hlZXQgPSBzaGVldDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlZGl0YWJsZVNoZWV0ICE9IG51bGwgPyBlZGl0YWJsZVNoZWV0IDogY3JlYXRlU3R5bGVTaGVldCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVTdHlsZVNoZWV0KCkge1xuICAgICAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICByZXR1cm4gc3R5bGUuc2hlZXQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlZHJhdygpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgfHwgc2VsZi5pc01vYmlsZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCk7XG4gICAgICAgIGJ1aWxkRGF5cygpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmb2N1c0FuZENsb3NlKCkge1xuICAgICAgICBzZWxmLl9pbnB1dC5mb2N1cygpO1xuICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUVcIikgIT09IC0xIHx8XG4gICAgICAgICAgICBuYXZpZ2F0b3IubXNNYXhUb3VjaFBvaW50cyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHNlbGYuY2xvc2UsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNlbGVjdERhdGUoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHZhciBpc1NlbGVjdGFibGUgPSBmdW5jdGlvbiAoZGF5KSB7XG4gICAgICAgICAgICByZXR1cm4gZGF5LmNsYXNzTGlzdCAmJlxuICAgICAgICAgICAgICAgIGRheS5jbGFzc0xpc3QuY29udGFpbnMoXCJmbGF0cGlja3ItZGF5XCIpICYmXG4gICAgICAgICAgICAgICAgIWRheS5jbGFzc0xpc3QuY29udGFpbnMoXCJmbGF0cGlja3ItZGlzYWJsZWRcIikgJiZcbiAgICAgICAgICAgICAgICAhZGF5LmNsYXNzTGlzdC5jb250YWlucyhcIm5vdEFsbG93ZWRcIik7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0ID0gZmluZFBhcmVudChnZXRFdmVudFRhcmdldChlKSwgaXNTZWxlY3RhYmxlKTtcbiAgICAgICAgaWYgKHQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHRhcmdldCA9IHQ7XG4gICAgICAgIHZhciBzZWxlY3RlZERhdGUgPSAoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSBuZXcgRGF0ZSh0YXJnZXQuZGF0ZU9iai5nZXRUaW1lKCkpKTtcbiAgICAgICAgdmFyIHNob3VsZENoYW5nZU1vbnRoID0gKHNlbGVjdGVkRGF0ZS5nZXRNb250aCgpIDwgc2VsZi5jdXJyZW50TW9udGggfHxcbiAgICAgICAgICAgIHNlbGVjdGVkRGF0ZS5nZXRNb250aCgpID5cbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCArIHNlbGYuY29uZmlnLnNob3dNb250aHMgLSAxKSAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcubW9kZSAhPT0gXCJyYW5nZVwiO1xuICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZUVsZW0gPSB0YXJnZXQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInNpbmdsZVwiKVxuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gW3NlbGVjdGVkRGF0ZV07XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwibXVsdGlwbGVcIikge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSW5kZXggPSBpc0RhdGVTZWxlY3RlZChzZWxlY3RlZERhdGUpO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkSW5kZXgpXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnNwbGljZShwYXJzZUludChzZWxlY3RlZEluZGV4KSwgMSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnB1c2goc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGVhcihmYWxzZSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSBzZWxlY3RlZERhdGU7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMucHVzaChzZWxlY3RlZERhdGUpO1xuICAgICAgICAgICAgaWYgKGNvbXBhcmVEYXRlcyhzZWxlY3RlZERhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXSwgdHJ1ZSkgIT09IDApXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEuZ2V0VGltZSgpIC0gYi5nZXRUaW1lKCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHNldEhvdXJzRnJvbUlucHV0cygpO1xuICAgICAgICBpZiAoc2hvdWxkQ2hhbmdlTW9udGgpIHtcbiAgICAgICAgICAgIHZhciBpc05ld1llYXIgPSBzZWxmLmN1cnJlbnRZZWFyICE9PSBzZWxlY3RlZERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPSBzZWxlY3RlZERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gc2VsZWN0ZWREYXRlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICBpZiAoaXNOZXdZZWFyKSB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25ZZWFyQ2hhbmdlXCIpO1xuICAgICAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uTW9udGhDaGFuZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlTmF2aWdhdGlvbkN1cnJlbnRNb250aCgpO1xuICAgICAgICBidWlsZERheXMoKTtcbiAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgaWYgKCFzaG91bGRDaGFuZ2VNb250aCAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcubW9kZSAhPT0gXCJyYW5nZVwiICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5zaG93TW9udGhzID09PSAxKVxuICAgICAgICAgICAgZm9jdXNPbkRheUVsZW0odGFyZ2V0KTtcbiAgICAgICAgZWxzZSBpZiAoc2VsZi5zZWxlY3RlZERhdGVFbGVtICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVFbGVtICYmIHNlbGYuc2VsZWN0ZWREYXRlRWxlbS5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmhvdXJFbGVtZW50ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgc2VsZi5ob3VyRWxlbWVudC5mb2N1cygpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuY2xvc2VPblNlbGVjdCkge1xuICAgICAgICAgICAgdmFyIHNpbmdsZSA9IHNlbGYuY29uZmlnLm1vZGUgPT09IFwic2luZ2xlXCIgJiYgIXNlbGYuY29uZmlnLmVuYWJsZVRpbWU7XG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIgJiZcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAyICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLmVuYWJsZVRpbWU7XG4gICAgICAgICAgICBpZiAoc2luZ2xlIHx8IHJhbmdlKSB7XG4gICAgICAgICAgICAgICAgZm9jdXNBbmRDbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXJDaGFuZ2UoKTtcbiAgICB9XG4gICAgdmFyIENBTExCQUNLUyA9IHtcbiAgICAgICAgbG9jYWxlOiBbc2V0dXBMb2NhbGUsIHVwZGF0ZVdlZWtkYXlzXSxcbiAgICAgICAgc2hvd01vbnRoczogW2J1aWxkTW9udGhzLCBzZXRDYWxlbmRhcldpZHRoLCBidWlsZFdlZWtkYXlzXSxcbiAgICAgICAgbWluRGF0ZTogW2p1bXBUb0RhdGVdLFxuICAgICAgICBtYXhEYXRlOiBbanVtcFRvRGF0ZV0sXG4gICAgICAgIHBvc2l0aW9uRWxlbWVudDogW3VwZGF0ZVBvc2l0aW9uRWxlbWVudF0sXG4gICAgICAgIGNsaWNrT3BlbnM6IFtcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuY2xpY2tPcGVucyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImZvY3VzXCIsIHNlbGYub3Blbik7XG4gICAgICAgICAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiY2xpY2tcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBzZWxmLm9wZW4pO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH07XG4gICAgZnVuY3Rpb24gc2V0KG9wdGlvbiwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG9wdGlvbiAhPT0gbnVsbCAmJiB0eXBlb2Ygb3B0aW9uID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHNlbGYuY29uZmlnLCBvcHRpb24pO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9wdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChDQUxMQkFDS1Nba2V5XSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBDQUxMQkFDS1Nba2V5XS5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4KCk7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5jb25maWdbb3B0aW9uXSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKENBTExCQUNLU1tvcHRpb25dICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgQ0FMTEJBQ0tTW29wdGlvbl0uZm9yRWFjaChmdW5jdGlvbiAoeCkgeyByZXR1cm4geCgpOyB9KTtcbiAgICAgICAgICAgIGVsc2UgaWYgKEhPT0tTLmluZGV4T2Yob3B0aW9uKSA+IC0xKVxuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnW29wdGlvbl0gPSBhcnJheWlmeSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5yZWRyYXcoKTtcbiAgICAgICAgdXBkYXRlVmFsdWUodHJ1ZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldFNlbGVjdGVkRGF0ZShpbnB1dERhdGUsIGZvcm1hdCkge1xuICAgICAgICB2YXIgZGF0ZXMgPSBbXTtcbiAgICAgICAgaWYgKGlucHV0RGF0ZSBpbnN0YW5jZW9mIEFycmF5KVxuICAgICAgICAgICAgZGF0ZXMgPSBpbnB1dERhdGUubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBzZWxmLnBhcnNlRGF0ZShkLCBmb3JtYXQpOyB9KTtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXREYXRlIGluc3RhbmNlb2YgRGF0ZSB8fCB0eXBlb2YgaW5wdXREYXRlID09PSBcIm51bWJlclwiKVxuICAgICAgICAgICAgZGF0ZXMgPSBbc2VsZi5wYXJzZURhdGUoaW5wdXREYXRlLCBmb3JtYXQpXTtcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGlucHV0RGF0ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgc3dpdGNoIChzZWxmLmNvbmZpZy5tb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInNpbmdsZVwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJ0aW1lXCI6XG4gICAgICAgICAgICAgICAgICAgIGRhdGVzID0gW3NlbGYucGFyc2VEYXRlKGlucHV0RGF0ZSwgZm9ybWF0KV07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJtdWx0aXBsZVwiOlxuICAgICAgICAgICAgICAgICAgICBkYXRlcyA9IGlucHV0RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KHNlbGYuY29uZmlnLmNvbmp1bmN0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gc2VsZi5wYXJzZURhdGUoZGF0ZSwgZm9ybWF0KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJyYW5nZVwiOlxuICAgICAgICAgICAgICAgICAgICBkYXRlcyA9IGlucHV0RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KHNlbGYubDEwbi5yYW5nZVNlcGFyYXRvcilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHNlbGYucGFyc2VEYXRlKGRhdGUsIGZvcm1hdCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5lcnJvckhhbmRsZXIobmV3IEVycm9yKFwiSW52YWxpZCBkYXRlIHN1cHBsaWVkOiBcIiArIEpTT04uc3RyaW5naWZ5KGlucHV0RGF0ZSkpKTtcbiAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gKHNlbGYuY29uZmlnLmFsbG93SW52YWxpZFByZWxvYWRcbiAgICAgICAgICAgID8gZGF0ZXNcbiAgICAgICAgICAgIDogZGF0ZXMuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkIGluc3RhbmNlb2YgRGF0ZSAmJiBpc0VuYWJsZWQoZCwgZmFsc2UpOyB9KSk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpXG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS5nZXRUaW1lKCkgLSBiLmdldFRpbWUoKTsgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldERhdGUoZGF0ZSwgdHJpZ2dlckNoYW5nZSwgZm9ybWF0KSB7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlID09PSB2b2lkIDApIHsgdHJpZ2dlckNoYW5nZSA9IGZhbHNlOyB9XG4gICAgICAgIGlmIChmb3JtYXQgPT09IHZvaWQgMCkgeyBmb3JtYXQgPSBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0OyB9XG4gICAgICAgIGlmICgoZGF0ZSAhPT0gMCAmJiAhZGF0ZSkgfHwgKGRhdGUgaW5zdGFuY2VvZiBBcnJheSAmJiBkYXRlLmxlbmd0aCA9PT0gMCkpXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5jbGVhcih0cmlnZ2VyQ2hhbmdlKTtcbiAgICAgICAgc2V0U2VsZWN0ZWREYXRlKGRhdGUsIGZvcm1hdCk7XG4gICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID1cbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlc1tzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoIC0gMV07XG4gICAgICAgIHNlbGYucmVkcmF3KCk7XG4gICAgICAgIGp1bXBUb0RhdGUodW5kZWZpbmVkLCB0cmlnZ2VyQ2hhbmdlKTtcbiAgICAgICAgc2V0SG91cnNGcm9tRGF0ZSgpO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgc2VsZi5jbGVhcihmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlVmFsdWUodHJpZ2dlckNoYW5nZSk7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlKVxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DaGFuZ2VcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBhcnNlRGF0ZVJ1bGVzKGFycikge1xuICAgICAgICByZXR1cm4gYXJyXG4gICAgICAgICAgICAuc2xpY2UoKVxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBydWxlID09PSBcInN0cmluZ1wiIHx8XG4gICAgICAgICAgICAgICAgdHlwZW9mIHJ1bGUgPT09IFwibnVtYmVyXCIgfHxcbiAgICAgICAgICAgICAgICBydWxlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnBhcnNlRGF0ZShydWxlLCB1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocnVsZSAmJlxuICAgICAgICAgICAgICAgIHR5cGVvZiBydWxlID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICAgICAgcnVsZS5mcm9tICYmXG4gICAgICAgICAgICAgICAgcnVsZS50bylcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiBzZWxmLnBhcnNlRGF0ZShydWxlLmZyb20sIHVuZGVmaW5lZCksXG4gICAgICAgICAgICAgICAgICAgIHRvOiBzZWxmLnBhcnNlRGF0ZShydWxlLnRvLCB1bmRlZmluZWQpLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gcnVsZTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cERhdGVzKCkge1xuICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMgPSBbXTtcbiAgICAgICAgc2VsZi5ub3cgPSBzZWxmLnBhcnNlRGF0ZShzZWxmLmNvbmZpZy5ub3cpIHx8IG5ldyBEYXRlKCk7XG4gICAgICAgIHZhciBwcmVsb2FkZWREYXRlID0gc2VsZi5jb25maWcuZGVmYXVsdERhdGUgfHxcbiAgICAgICAgICAgICgoc2VsZi5pbnB1dC5ub2RlTmFtZSA9PT0gXCJJTlBVVFwiIHx8XG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC5ub2RlTmFtZSA9PT0gXCJURVhUQVJFQVwiKSAmJlxuICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQucGxhY2Vob2xkZXIgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnZhbHVlID09PSBzZWxmLmlucHV0LnBsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgPyBudWxsXG4gICAgICAgICAgICAgICAgOiBzZWxmLmlucHV0LnZhbHVlKTtcbiAgICAgICAgaWYgKHByZWxvYWRlZERhdGUpXG4gICAgICAgICAgICBzZXRTZWxlY3RlZERhdGUocHJlbG9hZGVkRGF0ZSwgc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgIHNlbGYuX2luaXRpYWxEYXRlID1cbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgPyBzZWxmLnNlbGVjdGVkRGF0ZXNbMF1cbiAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWluRGF0ZS5nZXRUaW1lKCkgPiBzZWxmLm5vdy5nZXRUaW1lKClcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5taW5EYXRlXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcubWF4RGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWF4RGF0ZS5nZXRUaW1lKCkgPCBzZWxmLm5vdy5nZXRUaW1lKClcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWF4RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBzZWxmLm5vdztcbiAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9IHNlbGYuX2luaXRpYWxEYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gc2VsZi5faW5pdGlhbERhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSBzZWxmLnNlbGVjdGVkRGF0ZXNbMF07XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5taW5UaW1lICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5UaW1lID0gc2VsZi5wYXJzZURhdGUoc2VsZi5jb25maWcubWluVGltZSwgXCJIOmlcIik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhUaW1lICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5tYXhUaW1lID0gc2VsZi5wYXJzZURhdGUoc2VsZi5jb25maWcubWF4VGltZSwgXCJIOmlcIik7XG4gICAgICAgIHNlbGYubWluRGF0ZUhhc1RpbWUgPVxuICAgICAgICAgICAgISFzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0SG91cnMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWluRGF0ZS5nZXRNaW51dGVzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0U2Vjb25kcygpID4gMCk7XG4gICAgICAgIHNlbGYubWF4RGF0ZUhhc1RpbWUgPVxuICAgICAgICAgICAgISFzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1heERhdGUuZ2V0SG91cnMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWF4RGF0ZS5nZXRNaW51dGVzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1heERhdGUuZ2V0U2Vjb25kcygpID4gMCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwSW5wdXRzKCkge1xuICAgICAgICBzZWxmLmlucHV0ID0gZ2V0SW5wdXRFbGVtKCk7XG4gICAgICAgIGlmICghc2VsZi5pbnB1dCkge1xuICAgICAgICAgICAgc2VsZi5jb25maWcuZXJyb3JIYW5kbGVyKG5ldyBFcnJvcihcIkludmFsaWQgaW5wdXQgZWxlbWVudCBzcGVjaWZpZWRcIikpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuaW5wdXQuX3R5cGUgPSBzZWxmLmlucHV0LnR5cGU7XG4gICAgICAgIHNlbGYuaW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICBzZWxmLmlucHV0LmNsYXNzTGlzdC5hZGQoXCJmbGF0cGlja3ItaW5wdXRcIik7XG4gICAgICAgIHNlbGYuX2lucHV0ID0gc2VsZi5pbnB1dDtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmFsdElucHV0KSB7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0ID0gY3JlYXRlRWxlbWVudChzZWxmLmlucHV0Lm5vZGVOYW1lLCBzZWxmLmNvbmZpZy5hbHRJbnB1dENsYXNzKTtcbiAgICAgICAgICAgIHNlbGYuX2lucHV0ID0gc2VsZi5hbHRJbnB1dDtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQucGxhY2Vob2xkZXIgPSBzZWxmLmlucHV0LnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC5kaXNhYmxlZCA9IHNlbGYuaW5wdXQuZGlzYWJsZWQ7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnJlcXVpcmVkID0gc2VsZi5pbnB1dC5yZXF1aXJlZDtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQudGFiSW5kZXggPSBzZWxmLmlucHV0LnRhYkluZGV4O1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgICAgICBzZWxmLmlucHV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICBpZiAoIXNlbGYuY29uZmlnLnN0YXRpYyAmJiBzZWxmLmlucHV0LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLmFsdElucHV0LCBzZWxmLmlucHV0Lm5leHRTaWJsaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLmFsbG93SW5wdXQpXG4gICAgICAgICAgICBzZWxmLl9pbnB1dC5zZXRBdHRyaWJ1dGUoXCJyZWFkb25seVwiLCBcInJlYWRvbmx5XCIpO1xuICAgICAgICB1cGRhdGVQb3NpdGlvbkVsZW1lbnQoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlUG9zaXRpb25FbGVtZW50KCkge1xuICAgICAgICBzZWxmLl9wb3NpdGlvbkVsZW1lbnQgPSBzZWxmLmNvbmZpZy5wb3NpdGlvbkVsZW1lbnQgfHwgc2VsZi5faW5wdXQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwTW9iaWxlKCkge1xuICAgICAgICB2YXIgaW5wdXRUeXBlID0gc2VsZi5jb25maWcuZW5hYmxlVGltZVxuICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5ub0NhbGVuZGFyXG4gICAgICAgICAgICAgICAgPyBcInRpbWVcIlxuICAgICAgICAgICAgICAgIDogXCJkYXRldGltZS1sb2NhbFwiXG4gICAgICAgICAgICA6IFwiZGF0ZVwiO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0ID0gY3JlYXRlRWxlbWVudChcImlucHV0XCIsIHNlbGYuaW5wdXQuY2xhc3NOYW1lICsgXCIgZmxhdHBpY2tyLW1vYmlsZVwiKTtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC50YWJJbmRleCA9IDE7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQudHlwZSA9IGlucHV0VHlwZTtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5kaXNhYmxlZCA9IHNlbGYuaW5wdXQuZGlzYWJsZWQ7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQucmVxdWlyZWQgPSBzZWxmLmlucHV0LnJlcXVpcmVkO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnBsYWNlaG9sZGVyID0gc2VsZi5pbnB1dC5wbGFjZWhvbGRlcjtcbiAgICAgICAgc2VsZi5tb2JpbGVGb3JtYXRTdHIgPVxuICAgICAgICAgICAgaW5wdXRUeXBlID09PSBcImRhdGV0aW1lLWxvY2FsXCJcbiAgICAgICAgICAgICAgICA/IFwiWS1tLWRcXFxcVEg6aTpTXCJcbiAgICAgICAgICAgICAgICA6IGlucHV0VHlwZSA9PT0gXCJkYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgPyBcIlktbS1kXCJcbiAgICAgICAgICAgICAgICAgICAgOiBcIkg6aTpTXCI7XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5kZWZhdWx0VmFsdWUgPSBzZWxmLm1vYmlsZUlucHV0LnZhbHVlID0gc2VsZi5mb3JtYXREYXRlKHNlbGYuc2VsZWN0ZWREYXRlc1swXSwgc2VsZi5tb2JpbGVGb3JtYXRTdHIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5taW5EYXRlKVxuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5taW4gPSBzZWxmLmZvcm1hdERhdGUoc2VsZi5jb25maWcubWluRGF0ZSwgXCJZLW0tZFwiKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1heERhdGUpXG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0Lm1heCA9IHNlbGYuZm9ybWF0RGF0ZShzZWxmLmNvbmZpZy5tYXhEYXRlLCBcIlktbS1kXCIpO1xuICAgICAgICBpZiAoc2VsZi5pbnB1dC5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKVxuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5zdGVwID0gU3RyaW5nKHNlbGYuaW5wdXQuZ2V0QXR0cmlidXRlKFwic3RlcFwiKSk7XG4gICAgICAgIHNlbGYuaW5wdXQudHlwZSA9IFwiaGlkZGVuXCI7XG4gICAgICAgIGlmIChzZWxmLmFsdElucHV0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnR5cGUgPSBcImhpZGRlblwiO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHNlbGYuaW5wdXQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYubW9iaWxlSW5wdXQsIHNlbGYuaW5wdXQubmV4dFNpYmxpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgIGJpbmQoc2VsZi5tb2JpbGVJbnB1dCwgXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShnZXRFdmVudFRhcmdldChlKS52YWx1ZSwgZmFsc2UsIHNlbGYubW9iaWxlRm9ybWF0U3RyKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uQ2hhbmdlXCIpO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DbG9zZVwiKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRvZ2dsZShlKSB7XG4gICAgICAgIGlmIChzZWxmLmlzT3BlbiA9PT0gdHJ1ZSlcbiAgICAgICAgICAgIHJldHVybiBzZWxmLmNsb3NlKCk7XG4gICAgICAgIHNlbGYub3BlbihlKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdHJpZ2dlckV2ZW50KGV2ZW50LCBkYXRhKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgaG9va3MgPSBzZWxmLmNvbmZpZ1tldmVudF07XG4gICAgICAgIGlmIChob29rcyAhPT0gdW5kZWZpbmVkICYmIGhvb2tzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBob29rc1tpXSAmJiBpIDwgaG9va3MubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgaG9va3NbaV0oc2VsZi5zZWxlY3RlZERhdGVzLCBzZWxmLmlucHV0LnZhbHVlLCBzZWxmLCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZlbnQgPT09IFwib25DaGFuZ2VcIikge1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUV2ZW50KFwiY2hhbmdlXCIpKTtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQuZGlzcGF0Y2hFdmVudChjcmVhdGVFdmVudChcImlucHV0XCIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVFdmVudChuYW1lKSB7XG4gICAgICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtcbiAgICAgICAgZS5pbml0RXZlbnQobmFtZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc0RhdGVTZWxlY3RlZChkYXRlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWREYXRlID0gc2VsZi5zZWxlY3RlZERhdGVzW2ldO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkRGF0ZSBpbnN0YW5jZW9mIERhdGUgJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoc2VsZWN0ZWREYXRlLCBkYXRlKSA9PT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIiArIGk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc0RhdGVJblJhbmdlKGRhdGUpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIiB8fCBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoIDwgMilcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIChjb21wYXJlRGF0ZXMoZGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzBdKSA+PSAwICYmXG4gICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzFdKSA8PSAwKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlTmF2aWdhdGlvbkN1cnJlbnRNb250aCgpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgfHwgc2VsZi5pc01vYmlsZSB8fCAhc2VsZi5tb250aE5hdilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2VsZi55ZWFyRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoeWVhckVsZW1lbnQsIGkpIHtcbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoc2VsZi5jdXJyZW50WWVhciwgc2VsZi5jdXJyZW50TW9udGgsIDEpO1xuICAgICAgICAgICAgZC5zZXRNb250aChzZWxmLmN1cnJlbnRNb250aCArIGkpO1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLnNob3dNb250aHMgPiAxIHx8XG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWcubW9udGhTZWxlY3RvclR5cGUgPT09IFwic3RhdGljXCIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vbnRoRWxlbWVudHNbaV0udGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgICAgICAgICBtb250aFRvU3RyKGQuZ2V0TW9udGgoKSwgc2VsZi5jb25maWcuc2hvcnRoYW5kQ3VycmVudE1vbnRoLCBzZWxmLmwxMG4pICsgXCIgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLnZhbHVlID0gZC5nZXRNb250aCgpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5ZWFyRWxlbWVudC52YWx1ZSA9IGQuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5faGlkZVByZXZNb250aEFycm93ID1cbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pbkRhdGUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIChzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKClcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmN1cnJlbnRNb250aCA8PSBzZWxmLmNvbmZpZy5taW5EYXRlLmdldE1vbnRoKClcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmN1cnJlbnRZZWFyIDwgc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpKTtcbiAgICAgICAgc2VsZi5faGlkZU5leHRNb250aEFycm93ID1cbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1heERhdGUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIChzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKClcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmN1cnJlbnRNb250aCArIDEgPiBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldE1vbnRoKClcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmN1cnJlbnRZZWFyID4gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0RGF0ZVN0cihzcGVjaWZpY0Zvcm1hdCkge1xuICAgICAgICB2YXIgZm9ybWF0ID0gc3BlY2lmaWNGb3JtYXQgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5hbHRJbnB1dCA/IHNlbGYuY29uZmlnLmFsdEZvcm1hdCA6IHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpO1xuICAgICAgICByZXR1cm4gc2VsZi5zZWxlY3RlZERhdGVzXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChkT2JqKSB7IHJldHVybiBzZWxmLmZvcm1hdERhdGUoZE9iaiwgZm9ybWF0KTsgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGQsIGksIGFycikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIiB8fFxuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLmVuYWJsZVRpbWUgfHxcbiAgICAgICAgICAgICAgICBhcnIuaW5kZXhPZihkKSA9PT0gaTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIlxuICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5jb25qdW5jdGlvblxuICAgICAgICAgICAgOiBzZWxmLmwxMG4ucmFuZ2VTZXBhcmF0b3IpO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVWYWx1ZSh0cmlnZ2VyQ2hhbmdlKSB7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlID09PSB2b2lkIDApIHsgdHJpZ2dlckNoYW5nZSA9IHRydWU7IH1cbiAgICAgICAgaWYgKHNlbGYubW9iaWxlSW5wdXQgIT09IHVuZGVmaW5lZCAmJiBzZWxmLm1vYmlsZUZvcm1hdFN0cikge1xuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC52YWx1ZSA9XG4gICAgICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuZm9ybWF0RGF0ZShzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiwgc2VsZi5tb2JpbGVGb3JtYXRTdHIpXG4gICAgICAgICAgICAgICAgICAgIDogXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmlucHV0LnZhbHVlID0gZ2V0RGF0ZVN0cihzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgaWYgKHNlbGYuYWx0SW5wdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC52YWx1ZSA9IGdldERhdGVTdHIoc2VsZi5jb25maWcuYWx0Rm9ybWF0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSAhPT0gZmFsc2UpXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblZhbHVlVXBkYXRlXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbk1vbnRoTmF2Q2xpY2soZSkge1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgdmFyIGlzUHJldk1vbnRoID0gc2VsZi5wcmV2TW9udGhOYXYuY29udGFpbnMoZXZlbnRUYXJnZXQpO1xuICAgICAgICB2YXIgaXNOZXh0TW9udGggPSBzZWxmLm5leHRNb250aE5hdi5jb250YWlucyhldmVudFRhcmdldCk7XG4gICAgICAgIGlmIChpc1ByZXZNb250aCB8fCBpc05leHRNb250aCkge1xuICAgICAgICAgICAgY2hhbmdlTW9udGgoaXNQcmV2TW9udGggPyAtMSA6IDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYueWVhckVsZW1lbnRzLmluZGV4T2YoZXZlbnRUYXJnZXQpID49IDApIHtcbiAgICAgICAgICAgIGV2ZW50VGFyZ2V0LnNlbGVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImFycm93VXBcIikpIHtcbiAgICAgICAgICAgIHNlbGYuY2hhbmdlWWVhcihzZWxmLmN1cnJlbnRZZWFyICsgMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYXJyb3dEb3duXCIpKSB7XG4gICAgICAgICAgICBzZWxmLmNoYW5nZVllYXIoc2VsZi5jdXJyZW50WWVhciAtIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRpbWVXcmFwcGVyKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB2YXIgaXNLZXlEb3duID0gZS50eXBlID09PSBcImtleWRvd25cIiwgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKSwgaW5wdXQgPSBldmVudFRhcmdldDtcbiAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkICYmIGV2ZW50VGFyZ2V0ID09PSBzZWxmLmFtUE0pIHtcbiAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICAgICAgc2VsZi5sMTBuLmFtUE1baW50KHNlbGYuYW1QTS50ZXh0Q29udGVudCA9PT0gc2VsZi5sMTBuLmFtUE1bMF0pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWluID0gcGFyc2VGbG9hdChpbnB1dC5nZXRBdHRyaWJ1dGUoXCJtaW5cIikpLCBtYXggPSBwYXJzZUZsb2F0KGlucHV0LmdldEF0dHJpYnV0ZShcIm1heFwiKSksIHN0ZXAgPSBwYXJzZUZsb2F0KGlucHV0LmdldEF0dHJpYnV0ZShcInN0ZXBcIikpLCBjdXJWYWx1ZSA9IHBhcnNlSW50KGlucHV0LnZhbHVlLCAxMCksIGRlbHRhID0gZS5kZWx0YSB8fFxuICAgICAgICAgICAgKGlzS2V5RG93biA/IChlLndoaWNoID09PSAzOCA/IDEgOiAtMSkgOiAwKTtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gY3VyVmFsdWUgKyBzdGVwICogZGVsdGE7XG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXQudmFsdWUgIT09IFwidW5kZWZpbmVkXCIgJiYgaW5wdXQudmFsdWUubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICB2YXIgaXNIb3VyRWxlbSA9IGlucHV0ID09PSBzZWxmLmhvdXJFbGVtZW50LCBpc01pbnV0ZUVsZW0gPSBpbnB1dCA9PT0gc2VsZi5taW51dGVFbGVtZW50O1xuICAgICAgICAgICAgaWYgKG5ld1ZhbHVlIDwgbWluKSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPVxuICAgICAgICAgICAgICAgICAgICBtYXggK1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgK1xuICAgICAgICAgICAgICAgICAgICAgICAgaW50KCFpc0hvdXJFbGVtKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAoaW50KGlzSG91ckVsZW0pICYmIGludCghc2VsZi5hbVBNKSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzTWludXRlRWxlbSlcbiAgICAgICAgICAgICAgICAgICAgaW5jcmVtZW50TnVtSW5wdXQodW5kZWZpbmVkLCAtMSwgc2VsZi5ob3VyRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuZXdWYWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID1cbiAgICAgICAgICAgICAgICAgICAgaW5wdXQgPT09IHNlbGYuaG91ckVsZW1lbnQgPyBuZXdWYWx1ZSAtIG1heCAtIGludCghc2VsZi5hbVBNKSA6IG1pbjtcbiAgICAgICAgICAgICAgICBpZiAoaXNNaW51dGVFbGVtKVxuICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnROdW1JbnB1dCh1bmRlZmluZWQsIDEsIHNlbGYuaG91ckVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuYW1QTSAmJlxuICAgICAgICAgICAgICAgIGlzSG91ckVsZW0gJiZcbiAgICAgICAgICAgICAgICAoc3RlcCA9PT0gMVxuICAgICAgICAgICAgICAgICAgICA/IG5ld1ZhbHVlICsgY3VyVmFsdWUgPT09IDIzXG4gICAgICAgICAgICAgICAgICAgIDogTWF0aC5hYnMobmV3VmFsdWUgLSBjdXJWYWx1ZSkgPiBzdGVwKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubDEwbi5hbVBNW2ludChzZWxmLmFtUE0udGV4dENvbnRlbnQgPT09IHNlbGYubDEwbi5hbVBNWzBdKV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHBhZChuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW5pdCgpO1xuICAgIHJldHVybiBzZWxmO1xufVxuZnVuY3Rpb24gX2ZsYXRwaWNrcihub2RlTGlzdCwgY29uZmlnKSB7XG4gICAgdmFyIG5vZGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlXG4gICAgICAgIC5jYWxsKG5vZGVMaXN0KVxuICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ7IH0pO1xuICAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBub2RlID0gbm9kZXNbaV07XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAobm9kZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLWZwLW9taXRcIikgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBpZiAobm9kZS5fZmxhdHBpY2tyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBub2RlLl9mbGF0cGlja3IuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIG5vZGUuX2ZsYXRwaWNrciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGUuX2ZsYXRwaWNrciA9IEZsYXRwaWNrckluc3RhbmNlKG5vZGUsIGNvbmZpZyB8fCB7fSk7XG4gICAgICAgICAgICBpbnN0YW5jZXMucHVzaChub2RlLl9mbGF0cGlja3IpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbnN0YW5jZXMubGVuZ3RoID09PSAxID8gaW5zdGFuY2VzWzBdIDogaW5zdGFuY2VzO1xufVxuaWYgKHR5cGVvZiBIVE1MRWxlbWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBIVE1MQ29sbGVjdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBOb2RlTGlzdCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIEhUTUxDb2xsZWN0aW9uLnByb3RvdHlwZS5mbGF0cGlja3IgPSBOb2RlTGlzdC5wcm90b3R5cGUuZmxhdHBpY2tyID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcih0aGlzLCBjb25maWcpO1xuICAgIH07XG4gICAgSFRNTEVsZW1lbnQucHJvdG90eXBlLmZsYXRwaWNrciA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIF9mbGF0cGlja3IoW3RoaXNdLCBjb25maWcpO1xuICAgIH07XG59XG52YXIgZmxhdHBpY2tyID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBjb25maWcpIHtcbiAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSwgY29uZmlnKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoc2VsZWN0b3IgaW5zdGFuY2VvZiBOb2RlKSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKFtzZWxlY3Rvcl0sIGNvbmZpZyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcihzZWxlY3RvciwgY29uZmlnKTtcbiAgICB9XG59O1xuZmxhdHBpY2tyLmRlZmF1bHRDb25maWcgPSB7fTtcbmZsYXRwaWNrci5sMTBucyA9IHtcbiAgICBlbjogX19hc3NpZ24oe30sIEVuZ2xpc2gpLFxuICAgIGRlZmF1bHQ6IF9fYXNzaWduKHt9LCBFbmdsaXNoKSxcbn07XG5mbGF0cGlja3IubG9jYWxpemUgPSBmdW5jdGlvbiAobDEwbikge1xuICAgIGZsYXRwaWNrci5sMTBucy5kZWZhdWx0ID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGZsYXRwaWNrci5sMTBucy5kZWZhdWx0KSwgbDEwbik7XG59O1xuZmxhdHBpY2tyLnNldERlZmF1bHRzID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgIGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnKSwgY29uZmlnKTtcbn07XG5mbGF0cGlja3IucGFyc2VEYXRlID0gY3JlYXRlRGF0ZVBhcnNlcih7fSk7XG5mbGF0cGlja3IuZm9ybWF0RGF0ZSA9IGNyZWF0ZURhdGVGb3JtYXR0ZXIoe30pO1xuZmxhdHBpY2tyLmNvbXBhcmVEYXRlcyA9IGNvbXBhcmVEYXRlcztcbmlmICh0eXBlb2YgalF1ZXJ5ICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBqUXVlcnkuZm4gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBqUXVlcnkuZm4uZmxhdHBpY2tyID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcih0aGlzLCBjb25maWcpO1xuICAgIH07XG59XG5EYXRlLnByb3RvdHlwZS5mcF9pbmNyID0gZnVuY3Rpb24gKGRheXMpIHtcbiAgICByZXR1cm4gbmV3IERhdGUodGhpcy5nZXRGdWxsWWVhcigpLCB0aGlzLmdldE1vbnRoKCksIHRoaXMuZ2V0RGF0ZSgpICsgKHR5cGVvZiBkYXlzID09PSBcInN0cmluZ1wiID8gcGFyc2VJbnQoZGF5cywgMTApIDogZGF5cykpO1xufTtcbmlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgd2luZG93LmZsYXRwaWNrciA9IGZsYXRwaWNrcjtcbn1cbmV4cG9ydCBkZWZhdWx0IGZsYXRwaWNrcjtcbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBOb3RpY2UsIHNldEljb24sIFRleHRBcmVhQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgTXVsdGlGaWxlTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL011bHRpRmlsZU1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUZpbGVGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIGR2UXVlcnlTdHJpbmc6IFRleHRBcmVhQ29tcG9uZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5NdWx0aUZpbGUpXG4gICAgfVxuXG4gICAgc3RhdGljIGJ1aWxkTWFya0Rvd25MaW5rKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgcGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZGVzdEZpbGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocGF0aCwgZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZGVzdEZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBwbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKFxuICAgICAgICAgICAgICAgIGRlc3RGaWxlLFxuICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgZGVzdEZpbGUuYmFzZW5hbWVcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0RmlsZXMgPSAoY3VycmVudEZpbGU/OiBURmlsZSk6IFRGaWxlW10gPT4ge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgZ2V0UmVzdWx0cyA9IChhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgXCJjdXJyZW50XCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZ31gKSkoYXBpLCBhcGkucGFnZShjdXJyZW50RmlsZT8ucGF0aCkpXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFdyb25nIHF1ZXJ5IGZvciBmaWVsZCA8JHt0aGlzLmZpZWxkLm5hbWV9PlxcbmNoZWNrIHlvdXIgc2V0dGluZ3NgLCAzMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYXRhdmlldyA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVEYXRhdmlld0pzICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVJbmxpbmVEYXRhdmlld0pzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzUGF0aCA9IGdldFJlc3VsdHMoZGF0YXZpZXcuYXBpKS52YWx1ZXMubWFwKCh2OiBhbnkpID0+IHYuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZpbHRlcihmID0+IGZpbGVzUGF0aC5pbmNsdWRlcyhmLnBhdGgpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE11bHRpRmlsZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSlcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChNdWx0aUZpbGVGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlICR7bmFtZX1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChNdWx0aUZpbGVGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoTXVsdGlGaWxlRmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSwgYWN0aW9uLCBgVXBkYXRlICR7bmFtZX0ncyB2YWx1ZWApO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBhZnRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFzTGlzdD86IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudD86IGJvb2xlYW4pXG4gICAgICAgIDogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgTXVsdGlGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM6IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSA9IHt9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGF0dHJzLmNscyA9IFwidmFsdWUtY29udGFpbmVyXCJcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKSlcblxuICAgICAgICBjb25zdCBzZWFyY2hCdG4gPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKHNlYXJjaEJ0biwgRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSlcbiAgICAgICAgY29uc3Qgc3BhY2VyID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic3BhY2VyXCIgfSlcblxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgIGxldCBmaWVsZE1vZGFsOiBNdWx0aUZpbGVNb2RhbDtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgTXVsdGlGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgc2VhcmNoQnRuLmhpZGUoKVxuICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VhcmNoQnRuLnNob3coKVxuICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VhcmNoQnRuLmhpZGUoKVxuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlRmlsZUNvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2UXVlcnlTdHJpbmdUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIGR2UXVlcnlTdHJpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJEYXRhdmlldyBRdWVyeSAob3B0aW9uYWwpXCIsIGNsczogJ2ZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIGNvbnN0IGR2UXVlcnlTdHJpbmdDb250YWluZXIgPSBkdlF1ZXJ5U3RyaW5nVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGR2UXVlcnlTdHJpbmdDb250YWluZXIpO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgfHwgXCJcIik7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRoaXMuZHZRdWVyeVN0cmluZyk7XG4gICAgICAgIH0pXG5cblxuICAgICAgICBjb25zdCBjdXN0b21lUmVuZGVyaW5nVG9wQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2c3RhY2tlZFwiIH0pXG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJBbGlhc1wiIH0pO1xuICAgICAgICBjdXN0b21lUmVuZGVyaW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiUGVyc29uYWxpc2UgdGhlIHJlbmRlcmluZyBvZiB5b3VyIGxpbmtzJyBhbGlhc2VzIHdpdGggYSBmdW5jdGlvbiByZXR1cm5pbmcgYSBzdHJpbmcgKDxwYWdlPiBvYmplY3QgaXMgYXZhaWxhYmxlKVwiLCBjbHM6ICdzdWItdGV4dCcgfSk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IGBmdW5jdGlvbihwYWdlKSB7IHJldHVybiA8ZnVuY3Rpb24gdXNpbmcgXCJwYWdlXCI+OyB9YFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBjdXN0b21lUmVuZGVyaW5nQ29udGFpbmVyID0gY3VzdG9tZVJlbmRlcmluZ1RvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGNvbnN0IGN1c3RvbVJlbmRlcmluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChjdXN0b21lUmVuZGVyaW5nQ29udGFpbmVyKTtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZyB8fCBcIlwiKTtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLnNldFBsYWNlaG9sZGVyKFwiSmF2YXNjcmlwdCBzdHJpbmcsIFwiICtcbiAgICAgICAgICAgIFwidGhlIFxcXCJwYWdlXFxcIiAoZGF0YXZpZXcgcGFnZSB0eXBlKSB2YXJpYWJsZSBpcyBhdmFpbGFibGVcXG5cIiArXG4gICAgICAgICAgICBcImV4YW1wbGUgMTogcGFnZS5maWxlLm5hbWVcXG5leGFtcGxlIDI6IGAke3BhZ2UuZmlsZS5uYW1lfSBvZiBnZW5kZXIgJHtwYWdlLmdlbmRlcn1gXCIpXG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGN1c3RvbVJlbmRlcmluZyk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgY3VzdG9tU29ydGluZ1RvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgY3VzdG9tU29ydGluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlNvcnRpbmcgb3JkZXJcIiB9KTtcbiAgICAgICAgY3VzdG9tU29ydGluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlBlcnNvbmFsaXNlIHRoZSBzb3J0aW5nIG9yZGVyIG9mIHlvdXIgbGlua3Mgd2l0aCBhIGluc3RydWN0aW9uIHRha2luZyAyIGZpbGVzIChhLCBiKSBhbmQgcmV0dXJuaW5nIC0xLCAwIG9yIDFcIiwgY2xzOiAnc3ViLXRleHQnIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBgKGE6IFRGaWxlLCBiOiBURmlsZSk6IG51bWJlcmBcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgY3VzdG9tU29ydGluZ0NvbnRhaW5lciA9IGN1c3RvbVNvcnRpbmdUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnN0IGN1c3RvbVNvcnRpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoY3VzdG9tU29ydGluZ0NvbnRhaW5lcik7XG4gICAgICAgIGN1c3RvbVNvcnRpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGN1c3RvbVNvcnRpbmcuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgY3VzdG9tU29ydGluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU29ydGluZyB8fCBcIlwiKTtcbiAgICAgICAgY3VzdG9tU29ydGluZy5zZXRQbGFjZWhvbGRlcihcIkphdmFzY3JpcHQgaW5zdHJ1Y3Rpb24sIFwiICtcbiAgICAgICAgICAgIFwiKGE6IFRGaWxlLCBiOiBURmlsZSk6IG51bWJlclxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAxIChhbHBoYWJldGljYWwgb3JkZXIpOiBhLmJhc2VuYW1lIDwgYi5iYXNlbmFtZSA/IDEgOiAtMSBcXG5cIiArXG4gICAgICAgICAgICBcImV4YW1wbGUgMiAoY3JlYXRpb24gdGltZSBuZXdlciB0byBvbGRlcik6IGIuc3RhdC5jdGltZSAtIGIuc3RhdC5jdGltZVwiKVxuICAgICAgICBjdXN0b21Tb3J0aW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21Tb3J0aW5nID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGN1c3RvbVNvcnRpbmcpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmNyZWF0ZUZpbGVDb250YWluZXIocGFyZW50Q29udGFpbmVyKVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcgfCB7IHBhdGg6IHN0cmluZyB9IHwgeyBwYXRoOiBzdHJpbmcgfVtdKTogYm9vbGVhbiB7XG4gICAgICAgIC8vdG9kbyA6IG1hbmFnZSBib3RoIHJhdyBsaW5rcyBhbmQgZHYgTGluayBvYmplY3RzXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2s6ICgpID0+IHt9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgZHZWYWx1ZSA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBBcnJheS5pc0FycmF5KGR2VmFsdWUpID8gZHZWYWx1ZSA6IFtkdlZhbHVlXVxuICAgICAgICAgICAgdmFsdWVzLmZvckVhY2goKHZhbHVlLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYScsIHsgdGV4dDogdmFsdWUucGF0aC5zcGxpdChcIi9cIikubGFzdCgpLnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpIH0pO1xuICAgICAgICAgICAgICAgICAgICBsaW5rLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh2YWx1ZS5wYXRoLCBmaWxlLnBhdGgsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB2YWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGkgPCB2YWx1ZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IFwiIHwgXCIgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoKVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUsIEZ1enp5U3VnZ2VzdE1vZGFsLCBGdXp6eU1hdGNoLCBCdXR0b25Db21wb25lbnQsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0gfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXVsdGlGaWxlRnV6enlTdWdnZXN0ZXIgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZEZpbGVzOiBURmlsZVtdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIGluaXRpYWxWYWx1ZU9iamVjdDogYW55LFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFZhbHVlczogQXJyYXk8YW55PiA9IEFycmF5LmlzQXJyYXkoaW5pdGlhbFZhbHVlT2JqZWN0KSA/IGluaXRpYWxWYWx1ZU9iamVjdCA6IFtpbml0aWFsVmFsdWVPYmplY3RdXG4gICAgICAgICAgICBzZWxlY3RlZFZhbHVlcy5mb3JFYWNoKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZHZBcGkudmFsdWUuaXNMaW5rKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh2YWx1ZS5wYXRoKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB0aGlzLnNlbGVjdGVkRmlsZXMucHVzaChmaWxlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwub25rZXlkb3duID0gYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PSBcIkVudGVyXCIgJiYgZS5hbHRLZXkpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXBsYWNlVmFsdWVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KVxuICAgICAgICBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGluZm9Db250YWluZXIgPSBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImluZm9cIiB9KVxuICAgICAgICBpbmZvQ29udGFpbmVyLnNldFRleHQoXCJBbHQrRW50ZXIgdG8gc2F2ZVwiKVxuICAgICAgICAvL2NvbmZpcm0gYnV0dG9uXG4gICAgICAgIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpXG4gICAgICAgIGNvbmZpcm1CdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlcGxhY2VWYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICB9KVxuICAgICAgICAvL2NhbmNlbCBidXR0b25cbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4geyB0aGlzLmNsb3NlKCk7IH0pXG4gICAgICAgIC8vY2xlYXIgdmFsdWUgYnV0dG9uXG4gICAgICAgIGNvbnN0IGNsZWFyQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNsZWFyQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2xlYXJWYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgY2xlYXJCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJkYW5nZXJcIilcblxuICAgICAgICB0aGlzLm1vZGFsRWwuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKVxuICAgIH1cblxuICAgIGdldEl0ZW1zKCk6IFRGaWxlW10ge1xuICAgICAgICBjb25zdCBzb3J0aW5nTWV0aG9kID0gbmV3IEZ1bmN0aW9uKFwiYVwiLCBcImJcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21Tb3J0aW5nfWApIHx8IGZ1bmN0aW9uIChhOiBURmlsZSwgYjogVEZpbGUpIHsgcmV0dXJuIGEuYmFzZW5hbWUgPCBiLmJhc2VuYW1lID8gLTEgOiAxIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgICAgIHJldHVybiBmaWxlTWFuYWdlci5nZXRGaWxlcyh0aGlzLmZpbGUpLnNvcnQoc29ydGluZ01ldGhvZCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQoaXRlbTogVEZpbGUpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaXRlbS5iYXNlbmFtZTtcbiAgICB9XG5cbiAgICBhc3luYyByZXBsYWNlVmFsdWVzKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnNlbGVjdGVkRmlsZXMubWFwKGZpbGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgICAgIGxldCBhbGlhczogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgICAgICBhbGlhcyA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZShmaWxlLnBhdGgpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEZNLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGZpbGUuYmFzZW5hbWUsIHVuZGVmaW5lZCwgYWxpYXMpXG4gICAgICAgIH0pXG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogcmVzdWx0LmpvaW4oXCIsIFwiKSB9IH1dLCB0aGlzLmZpbGUsIHRoaXMubGluZU51bWJlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KTtcbiAgICB9XG5cbiAgICBhc3luYyBjbGVhclZhbHVlcygpIHtcbiAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBcIlwiIH0gfV0sIHRoaXMuZmlsZSlcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHZhbHVlOiBGdXp6eU1hdGNoPFRGaWxlPiwgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSAmJiB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIml0ZW0td2l0aC1hZGQtb25cIiB9KTtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBuZXcgRnVuY3Rpb24oXCJwYWdlXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nfWApKGR2QXBpLnBhZ2UodmFsdWUuaXRlbS5wYXRoKSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImFkZC1vblwiIH0pXG4gICAgICAgICAgICBmaWxlUGF0aC5zZXRUZXh0KHZhbHVlLml0ZW0ucGF0aClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLnNldFRleHQodmFsdWUuaXRlbS5iYXNlbmFtZSlcbiAgICAgICAgfVxuICAgICAgICBlbC5hZGRDbGFzcyhcInZhbHVlLWNvbnRhaW5lclwiKVxuICAgICAgICBjb25zdCBzcGFjZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBlbC5hcHBlbmRDaGlsZChzcGFjZXIpXG5cbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGaWxlcy5zb21lKGZpbGUgPT4gZmlsZS5wYXRoID09PSB2YWx1ZS5pdGVtLnBhdGgpKSB7XG4gICAgICAgICAgICBlbC5hZGRDbGFzcyhcInZhbHVlLWNoZWNrZWRcIilcbiAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwiaWNvbi1jb250YWluZXJcIiB9KVxuICAgICAgICAgICAgc2V0SWNvbihpY29uQ29udGFpbmVyLCBcImNoZWNrLWNpcmNsZVwiKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVuZGVyU2VsZWN0ZWQoKSB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBjaG9vc2VyID0gdGhpcy5jaG9vc2VyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBIVE1MRGl2RWxlbWVudFtdID0gY2hvb3Nlci5zdWdnZXN0aW9uc1xuICAgICAgICBjb25zdCB2YWx1ZXM6IEZ1enp5TWF0Y2g8VEZpbGU+W10gPSBjaG9vc2VyLnZhbHVlc1xuXG4gICAgICAgIHN1Z2dlc3Rpb25zLmZvckVhY2goKHMsIGkpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRmlsZXMuc29tZShmaWxlID0+IGZpbGUucGF0aCA9PT0gdmFsdWVzW2ldLml0ZW0ucGF0aCkpIHtcbiAgICAgICAgICAgICAgICBzLmFkZENsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgICAgIGlmIChzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaWNvbi1jb250YWluZXJcIikubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHMuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihpY29uQ29udGFpbmVyLCBcImNoZWNrLWNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcy5yZW1vdmVDbGFzcyhcInZhbHVlLWNoZWNrZWRcIilcbiAgICAgICAgICAgICAgICBzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaWNvbi1jb250YWluZXJcIikuZm9yRWFjaChpY29uID0+IGljb24ucmVtb3ZlKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbih2YWx1ZTogRnV6enlNYXRjaDxURmlsZT4sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGaWxlcy5pbmNsdWRlcyh2YWx1ZS5pdGVtKSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZpbGVzLnJlbW92ZSh2YWx1ZS5pdGVtKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZpbGVzLnB1c2godmFsdWUuaXRlbSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlclNlbGVjdGVkKClcbiAgICB9XG5cbiAgICBhc3luYyBvbkNob29zZUl0ZW0oaXRlbTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHsgfVxuXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRGaWxlLCBNZW51LCBUZXh0QXJlYUNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCAqIGFzIExvb2t1cCBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBTdGF0dXMgfSBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IHsgdXBkYXRlTG9va3VwcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvdXBkYXRlTG9va3Vwc1wiO1xuaW1wb3J0IHsgcG9zdFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcG9zdFZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMb29rdXBGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5Mb29rdXApXG4gICAgICAgIHRoaXMuc2hvd01vZGFsT3B0aW9uID0gZmFsc2VcbiAgICB9XG5cbiAgICBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlICYmIHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGYgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4O1xuICAgICAgICAgICAgY29uc3QgaWQgPSBgJHtmaWxlLnBhdGh9X18ke3RoaXMuZmllbGQubmFtZX1gO1xuICAgICAgICAgICAgbGV0IHN0YXR1czogU3RhdHVzO1xuICAgICAgICAgICAgc3RhdHVzID0gZi5maWxlTG9va3VwRmllbGRzU3RhdHVzLmdldChpZCkgfHwgU3RhdHVzLmNoYW5nZWRcbiAgICAgICAgICAgIC8vZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUgaXMgdXBkYXRlZCBhZnRlciBmaWxlQ2xhc3MgY2hhbmdlIGNhY2hlIHJlc29sdXRpb24gc28gd29uJ3QgYmUgdHJpZ2dlcmVkIHByb3Blcmx5LiBcbiAgICAgICAgICAgIC8vd2UgYW50aWNpcGF0ZSB0aGlzIGNoYW5nZSBzbyB0aGF0IHRoZSB1cGRhdGUgYnV0dG9uIGFwcGVhcnNcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmdldChgJHtmaWxlLnBhdGh9X19yZWxhdGVkX18ke3RoaXMuZmllbGQuZmlsZUNsYXNzTmFtZX1fX18ke3RoaXMuZmllbGQubmFtZX1gKSAhPT1cbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZVxuICAgICAgICAgICAgKSBzdGF0dXMgPSBTdGF0dXMuY2hhbmdlZFxuICAgICAgICAgICAgY29uc3QgaWNvbiA9IHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQgPyBcInJlZnJlc2gtY2N3XCIgOiBcImZpbGUtY2hlY2tcIlxuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4geyB1cGRhdGVMb29rdXBzKHRoaXMucGx1Z2luLCBcInNpbmdsZV9jb21tYW5kXCIsIHsgZmlsZTogZmlsZSwgZmllbGROYW1lOiB0aGlzLmZpZWxkLm5hbWUgfSkgfVxuICAgICAgICAgICAgaWYgKExvb2t1cEZpZWxkLmlzTWVudShsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oaWNvbik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pICYmIHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb25cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihpY29uLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKExvb2t1cEZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSAmJiBzdGF0dXMgPT09IFN0YXR1cy51cFRvRGF0ZSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihpY29uLCAoKSA9PiB7IH0sIGAke25hbWV9IGlzIHVwIHRvIGRhdGVgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihcInNlcnZlci1jb2dcIiwgKCkgPT4geyB9LCBgJHtuYW1lfSBpcyBhdXRvLXVwZGF0ZWRgLCBcImRpc2FibGVkXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLFxuICAgICAgICB2YWx1ZT86IHN0cmluZyxcbiAgICAgICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICAgICAgYWZ0ZXI/OiBib29sZWFuLFxuICAgICAgICBhc0xpc3Q/OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ/OiBib29sZWFuXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogXCJcIiB9IH1dLCBmaWxlLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgfVxuXG4gICAgY3JlYXRlRHZGaWVsZChkdjogYW55LCBwOiBhbnksIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyB9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSBwLmZpbGVcbiAgICAgICAgY29uc3QgZmllbGROYW1lID0gdGhpcy5maWVsZC5uYW1lXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpPy5maWxlQ2xhc3NOYW1lIHx8IFwicHJlc2V0RmllbGRcIlxuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVMb29rdXBGaWVsZExhc3RWYWx1ZS5nZXQoYCR7ZmlsZS5wYXRofV9fcmVsYXRlZF9fJHtmaWxlQ2xhc3NOYW1lfV9fXyR7ZmllbGROYW1lfWApLCBhdHRycyk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZGlzcGxheVNlbGVjdGVkT3V0cHV0T3B0aW9uQ29udGFpbmVyKG9wdGlvbkNvbnRhaW5lcnM6IFtBcnJheTxrZXlvZiB0eXBlb2YgTG9va3VwLlR5cGU+LCBIVE1MRWxlbWVudCB8IHVuZGVmaW5lZF1bXSwgdmFsdWU6IGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSkge1xuICAgICAgICBvcHRpb25Db250YWluZXJzLmZvckVhY2gob3B0aW9uc19zZXQgPT4ge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnNfc2V0WzBdLmluY2x1ZGVzKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNfc2V0WzFdPy5zaG93KClcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc19zZXRbMV0/LmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQgPSAoKSA9PiB7IH0pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZiA9PiBmLm5hbWUgPT09IGZpZWxkTmFtZSk/LmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwiXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVMb29rdXBGaWVsZExhc3RWYWx1ZS5nZXQoYCR7ZmlsZS5wYXRofV9fcmVsYXRlZF9fJHtmaWxlQ2xhc3NOYW1lfV9fXyR7ZmllbGROYW1lfWApIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkaXNwbGF5U2VsZWN0ZWRPdXRwdXRXYXJuaW5nQ29udGFpbmVyKG9wdGlvbldhcm5pbmdDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCB2YWx1ZToga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKSB7XG4gICAgICAgIFtMb29rdXAuVHlwZS5MaW5rc0J1bGxldExpc3QudG9TdHJpbmcoKSwgTG9va3VwLlR5cGUuQ3VzdG9tQnVsbGV0TGlzdC50b1N0cmluZygpXS5pbmNsdWRlcyh2YWx1ZSkgP1xuICAgICAgICAgICAgb3B0aW9uV2FybmluZ0NvbnRhaW5lci5zaG93KCkgOiBvcHRpb25XYXJuaW5nQ29udGFpbmVyLmhpZGUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUxvb2t1cENvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG5cbiAgICAgICAgY29uc3QgYXV0b1VwZGF0ZVRvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgY29uc3QgYXV0b1VwZGF0ZUNvbnRhaW5lciA9IGF1dG9VcGRhdGVUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGF1dG9VcGRhdGVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJBdXRvIHVwZGF0ZSB0aGlzIGZpZWxkIFwiLCBjbHM6ICdsYWJlbCcgfSk7XG4gICAgICAgIGF1dG9VcGRhdGVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICBjb25zdCBhdXRvVXBkYXRlID0gbmV3IFRvZ2dsZUNvbXBvbmVudChhdXRvVXBkYXRlQ29udGFpbmVyKTtcbiAgICAgICAgYXV0b1VwZGF0ZVRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlRoaXMgY291bGQgbGVhZCB0byBsYXRlbmNpZXMgZGVwZW5kaW5nIG9uIHRoZSBxdWVyaWVzXCIsIGNsczogJ3N1Yi10ZXh0IHdhcm5pbmcnIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMuYXV0b1VwZGF0ZSA9PT0gdW5kZWZpbmVkKSB0aGlzLmZpZWxkLm9wdGlvbnMuYXV0b1VwZGF0ZSA9IGZhbHNlXG4gICAgICAgIGF1dG9VcGRhdGUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmF1dG9VcGRhdGUpO1xuICAgICAgICBhdXRvVXBkYXRlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlID0gdmFsdWVcbiAgICAgICAgfSlcblxuXG5cbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlBhZ2VzIHRvIGxvb2sgZm9yIGluIHlvdXIgdmF1bHQgKERhdGF2aWV3SlMgUXVlcnkpXCIsIGNsczogJ2xhYmVsJyB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3SlMgcXVlcnkgb2YgdGhlIGZvcm0gYGR2LnBhZ2VzKC4uLilgXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IGR2UXVlcnlTdHJpbmdUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnN0IGR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcbiAgICAgICAgZHZRdWVyeVN0cmluZy5zZXRQbGFjZWhvbGRlcihcImV4YW1wZTogZHYucGFnZXMoJyNzdHVkZW50JylcIilcblxuICAgICAgICBkdlF1ZXJ5U3RyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGR2UXVlcnlTdHJpbmcpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IHRhcmdldEZpZWxkVG9wQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2c3RhY2tlZFwiIH0pO1xuICAgICAgICBjb25zdCB0YXJnZXRGaWVsZENvbnRhaW5lciA9IHRhcmdldEZpZWxkVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICB0YXJnZXRGaWVsZENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIk5hbWUgb2YgdGhlIHJlbGF0ZWQgZmllbGRcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBjb25zdCB0YXJnZXRGaWVsZE5hbWUgPSBuZXcgVGV4dENvbXBvbmVudCh0YXJnZXRGaWVsZENvbnRhaW5lcik7XG4gICAgICAgIHRhcmdldEZpZWxkTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKVxuICAgICAgICB0YXJnZXRGaWVsZE5hbWUuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIilcbiAgICAgICAgdGFyZ2V0RmllbGRUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJmaWVsZCBpbiB0aGUgdGFyZ2V0IHBhZ2VzIHRoYXQgY29udGFpbnMgYSBsaW5rIHRvIHRoZSBwYWdlIHdoZXJlIHRoaXMgbG9va3VwIGZpZWxkIGlzXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgdGFyZ2V0RmllbGROYW1lLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy50YXJnZXRGaWVsZE5hbWUgfHwgXCJcIik7XG4gICAgICAgIHRhcmdldEZpZWxkTmFtZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudGFyZ2V0RmllbGROYW1lID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRhcmdldEZpZWxkTmFtZSlcbiAgICAgICAgfSlcblxuICAgICAgICAvL2xvb2t1cCB0eXBlIHNlbGVjdG9yXG4gICAgICAgIGNvbnN0IG91dHB1dFR5cGVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSA9IHRoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlIHx8IExvb2t1cC5UeXBlLkxpbmtzTGlzdFxuICAgICAgICBvdXRwdXRUeXBlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiVHlwZSBvZiBvdXRwdXRcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBvdXRwdXRUeXBlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBvdXRwdXRUeXBlTGlzdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChvdXRwdXRUeXBlQ29udGFpbmVyKTtcbiAgICAgICAgT2JqZWN0LmtleXMoTG9va3VwLlR5cGUpLmZvckVhY2goKG91dHB1dFR5cGU6IGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSkgPT4ge1xuICAgICAgICAgICAgb3V0cHV0VHlwZUxpc3QuYWRkT3B0aW9uKG91dHB1dFR5cGUsIExvb2t1cC5EZXNjcmlwdGlvbltvdXRwdXRUeXBlXSlcbiAgICAgICAgfSlcbiAgICAgICAgb3V0cHV0VHlwZUxpc3Quc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLm91dHB1dFR5cGUpXG5cbiAgICAgICAgY29uc3Qgb3V0cHV0V2FybmluZ0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgb3V0cHV0V2FybmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDpcbiAgICAgICAgICAgICAgICBcIldhcm5pbmc6IHRoaXMgbWF5IG92ZXJyaWRlIHNvbWUgbGluZXMgdW5kZXIgeW91ciBsaXN0LiBcIiArXG4gICAgICAgICAgICAgICAgXCJUaGVyZSBzaG91bGRuJ3QgYmUgYW4gZXh0cmEgbWFudWFsIGl0ZW0gaW4gdGhlIGxpc3QgdGhhdCBpcyBhdXRvbWF0aWNhbGx5IFwiICtcbiAgICAgICAgICAgICAgICBcInJlbmRlcmVkIGJ5IHRoaXMgZmllbGQ6IGl0IHdvdWxkIGJlIG92ZXJyaWRlbiBhZnRlciBlYWNoIGZpZWxkIGluZGV4aW5nXCIsXG4gICAgICAgICAgICBjbHM6IFwiZmllbGQtd2FybmluZ1wiXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vQnVpbHQgaW4gc3VtbWFyaXpuZyBmdW5jdGlvbiBvcHRpb25zXG4gICAgICAgIGNvbnN0IGJ1aWx0aW5PcHRpb25zQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Ub3BDb250YWluZXIgPSBidWlsdGluT3B0aW9uc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KVxuICAgICAgICBjb25zdCBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Db250YWluZXIgPSBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Ub3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gPSB0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gfHwgTG9va3VwLkRlZmF1bHQuQnVpbHRpblN1bW1hcml6aW5nXG4gICAgICAgIGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uTGFiZWwuQnVpbHRpblN1bW1hcml6aW5nLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uTGlzdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Db250YWluZXIpO1xuICAgICAgICBPYmplY3Qua2V5cyhMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nKS5mb3JFYWNoKChidWlsdGluRnVuY3Rpb246IGtleW9mIHR5cGVvZiBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nKSA9PiB7XG4gICAgICAgICAgICBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25MaXN0LmFkZE9wdGlvbihidWlsdGluRnVuY3Rpb24sIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdbYnVpbHRpbkZ1bmN0aW9uXSlcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgYnVpbHRpbk9wdGlvbnNEZXNjcmlwdGlvbkNvbnRhaW5lciA9IGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvblRvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3ViLXRleHRcIiB9KTtcbiAgICAgICAgY29uc3QgYnVpbHRpbkZ1bmN0aW9uID0gdGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uIGFzIGtleW9mIHR5cGVvZiBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nXG4gICAgICAgIGJ1aWx0aW5PcHRpb25zRGVzY3JpcHRpb25Db250YWluZXIuc2V0VGV4dChMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb25EZXNjcmlwdGlvbltidWlsdGluRnVuY3Rpb25dLnJlcGxhY2UoXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVwiLCB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSkpXG5cbiAgICAgICAgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uTGlzdC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24pXG4gICAgICAgIGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkxpc3Qub25DaGFuZ2UoKHZhbHVlOiBrZXlvZiB0eXBlb2YgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uID0gdmFsdWVcbiAgICAgICAgICAgIGJ1aWx0aW5PcHRpb25zRGVzY3JpcHRpb25Db250YWluZXIuc2V0VGV4dChMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb25EZXNjcmlwdGlvblt2YWx1ZV0ucmVwbGFjZShcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XCIsIHRoaXMuZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lKSlcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBzdW1tYXJpemVkRmllbGROYW1lVG9wQ29udGFpbmVyID0gYnVpbHRpbk9wdGlvbnNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lID0gdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWVcbiAgICAgICAgY29uc3Qgc3VtbWFyaXplZEZpZWxkTmFtZUNvbnRhaW5lciA9IHN1bW1hcml6ZWRGaWVsZE5hbWVUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIHN1bW1hcml6ZWRGaWVsZE5hbWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJTdW1tYXJpemVkIGZpZWxkIG5hbWVcIiwgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIGNvbnN0IHN1bW1hcml6ZWRGaWVsZE5hbWUgPSBuZXcgVGV4dENvbXBvbmVudChzdW1tYXJpemVkRmllbGROYW1lQ29udGFpbmVyKTtcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZVRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIk5hbWUgb2YgdGhlIGZpZWxkIGNvbnRhaW5pbmcgc3VtbWFyaXplZCB2YWx1ZSB1c2VkIGZvciB0aGUgc3VtbWFyaXppbmcgZnVuY3Rpb25cIiwgY2xzOiBcInN1Yi10ZXh0XCIgfSk7XG5cbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSlcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSA9IHZhbHVlXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gQ3VzdG9tIGxpc3QgZnVuY3Rpb24gb3B0aW9uc1xuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvblRvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbUxpc3RGdW5jdGlvbiA9IHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21MaXN0RnVuY3Rpb24gfHwgTG9va3VwLkRlZmF1bHQuQ3VzdG9tTGlzdFxuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvblRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uTGFiZWwuQ3VzdG9tTGlzdCwgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7IHRleHQ6IExvb2t1cC5PcHRpb25TdWJMYWJlbC5DdXN0b21MaXN0IH0pO1xuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lciA9IG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbiA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5zZXRQbGFjZWhvbGRlcihMb29rdXAuSGVscGVyLkN1c3RvbUxpc3QpXG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21MaXN0RnVuY3Rpb24pXG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLmlucHV0RWwuY29scyA9IDY1O1xuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tTGlzdEZ1bmN0aW9uID0gdmFsdWVcbiAgICAgICAgfSlcblxuXG4gICAgICAgIGNvbnN0IG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Ub3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uID0gdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb24gfHwgTG9va3VwLkRlZmF1bHQuQ3VzdG9tU3VtbWFyaXppbmdcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvblRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uTGFiZWwuQ3VzdG9tU3VtbWFyaXppbmcsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7IHRleHQ6IExvb2t1cC5PcHRpb25TdWJMYWJlbC5DdXN0b21TdW1tYXJpemluZyB9KTtcbiAgICAgICAgY29uc3Qgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lciA9IG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Ub3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnN0IG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24gPSBuZXcgVGV4dEFyZWFDb21wb25lbnQob3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24uaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24uc2V0UGxhY2Vob2xkZXIoTG9va3VwLkhlbHBlci5DdXN0b21TdW1tYXJpemluZylcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU3VtbWFyaXppbmdGdW5jdGlvbilcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5pbnB1dEVsLmNvbHMgPSA2NTtcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5pbnB1dEVsLnJvd3MgPSA4O1xuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uID0gdmFsdWVcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBvcHRpb25Db250YWluZXJzOiBbQXJyYXk8a2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlPiwgSFRNTEVsZW1lbnQgfCB1bmRlZmluZWRdW10gPSBbXG4gICAgICAgICAgICBbW1wiTGlua3NMaXN0XCIsIFwiTGlua3NCdWxsZXRMaXN0XCJdLCB1bmRlZmluZWRdLFxuICAgICAgICAgICAgW1tcIkJ1aWx0aW5TdW1tYXJpemluZ1wiXSwgYnVpbHRpbk9wdGlvbnNDb250YWluZXJdLFxuICAgICAgICAgICAgW1tcIkN1c3RvbUxpc3RcIiwgXCJDdXN0b21CdWxsZXRMaXN0XCJdLCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvblRvcENvbnRhaW5lcl0sXG4gICAgICAgICAgICBbW1wiQ3VzdG9tU3VtbWFyaXppbmdcIl0sIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Ub3BDb250YWluZXJdXG4gICAgICAgIF1cblxuICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dE9wdGlvbkNvbnRhaW5lcihvcHRpb25Db250YWluZXJzLCBvdXRwdXRUeXBlTGlzdC5nZXRWYWx1ZSgpIGFzIGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSlcbiAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRPdXRwdXRXYXJuaW5nQ29udGFpbmVyKG91dHB1dFdhcm5pbmdDb250YWluZXIsIG91dHB1dFR5cGVMaXN0LmdldFZhbHVlKCkgYXMga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKVxuXG4gICAgICAgIG91dHB1dFR5cGVMaXN0Lm9uQ2hhbmdlKCh2YWx1ZToga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRPdXRwdXRPcHRpb25Db250YWluZXIob3B0aW9uQ29udGFpbmVycywgdmFsdWUpXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dFdhcm5pbmdDb250YWluZXIob3V0cHV0V2FybmluZ0NvbnRhaW5lciwgdmFsdWUpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlTG9va3VwQ29udGFpbmVyKGNvbnRhaW5lcilcbiAgICB9XG5cbiAgICBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHNob3J0RGVzY3JpcHRpb24gPSBMb29rdXAuU2hvcnREZXNjcmlwdGlvblt0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSBhcyBMb29rdXAuVHlwZV1cbiAgICAgICAgbGV0IGNvbXBsZW1lbnQ6IHN0cmluZyA9IFwiXCJcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlID09PSBMb29rdXAuVHlwZS5CdWlsdGluU3VtbWFyaXppbmcpIHtcbiAgICAgICAgICAgIGNvbXBsZW1lbnQgPSBgICR7dGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9ufWAgK1xuICAgICAgICAgICAgICAgIGAke3RoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbiAhPT0gTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZy5Db3VudEFsbCA/IFwiIFwiICsgdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUgOiBcIlwifWBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hvcnREZXNjcmlwdGlvbiArIGNvbXBsZW1lbnRcbiAgICB9XG5cbiAgICB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBOb3RpY2UsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCAqIGFzIExvb2t1cCBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBnZXRWYWx1ZXMgfSBmcm9tIFwiLi9nZXRWYWx1ZXNcIjtcbmltcG9ydCB7IEZpZWxkc1BheWxvYWQsIHBvc3RWYWx1ZXMgfSBmcm9tIFwiLi9wb3N0VmFsdWVzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBhcnJheXNBc1N0cmluZ0FyZUVxdWFsKGE6IHN0cmluZywgYjogc3RyaW5nKSB7XG4gICAgY29uc3QgYUFzQXJyYXkgPSBhLnNwbGl0KFwiLFwiKS5tYXAodiA9PiB2LnRyaW0oKSlcbiAgICBjb25zdCBiQXNBcnJheSA9IGIuc3BsaXQoXCIsXCIpLm1hcCh2ID0+IHYudHJpbSgpKVxuICAgIHJldHVybiBhQXNBcnJheS5ldmVyeShpdGVtID0+IGJBc0FycmF5LmluY2x1ZGVzKGl0ZW0pKSAmJiBiQXNBcnJheS5ldmVyeShpdGVtID0+IGFBc0FycmF5LmluY2x1ZGVzKGl0ZW0pKVxufVxuXG5hc3luYyBmdW5jdGlvbiBwYXJzZUZpZWxkVmFsdWVzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCByYXdWYWx1ZSA9IChhd2FpdCBnZXRWYWx1ZXMocGx1Z2luLCBmaWxlLCBmaWVsZE5hbWUpKT8uWzBdXG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGA8ZGl2IGhpZGRlbiBpZD1cXFwiJHtmaWVsZE5hbWV9X3ZhbHVlc1xcXCI+KD88dmFsdWVzPi4qKTwvZGl2PmApXG4gICAgY29uc3QgZlIgPSByYXdWYWx1ZS5tYXRjaChyZWdleClcbiAgICByZXR1cm4gZlI/Lmdyb3VwcyAmJiAndmFsdWVzJyBpbiBmUj8uZ3JvdXBzID8gZlIuZ3JvdXBzLnZhbHVlcyA6IHJhd1ZhbHVlXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVMb29rdXBzKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIHNvdXJjZTogc3RyaW5nID0gXCJcIixcbiAgICBmb3JjZVVwZGF0ZU9uZT86IHsgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nIH0sXG4gICAgZm9yY2VVcGRhdGVBbGw6IGJvb2xlYW4gPSBmYWxzZVxuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpXG4gICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0IHVwZGF0ZSBsb29rdXBzIFtcIiwgc291cmNlLCBcIl1cIiwgcGx1Z2luLmZpZWxkSW5kZXgubGFzdFJldmlzaW9uLCBcIi0+XCIsIHBsdWdpbi5maWVsZEluZGV4LmR2Py5hcGkuaW5kZXgucmV2aXNpb24pXG4gICAgY29uc3QgZiA9IHBsdWdpbi5maWVsZEluZGV4O1xuICAgIGxldCByZW5kZXJpbmdFcnJvcnM6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCBwYXlsb2FkczogUmVjb3JkPHN0cmluZywgRmllbGRzUGF5bG9hZD4gPSB7fVxuICAgIGNvbnN0IHVwZGF0ZWRGaWVsZHM6IHN0cmluZ1tdID0gW11cbiAgICBmb3IgKGxldCBpZCBvZiBmLmZpbGVMb29rdXBGaWxlcy5rZXlzKCkpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hSZWdleCA9IC8oPzxmaWxlUGF0aD4uKilfX3JlbGF0ZWRfXyg/PGZpbGVDbGFzc05hbWU+LiopX19fKD88ZmllbGROYW1lPi4qKS9cbiAgICAgICAgY29uc3QgeyBmaWxlUGF0aCwgZmlsZUNsYXNzTmFtZSwgZmllbGROYW1lIH0gPSBpZC5tYXRjaChtYXRjaFJlZ2V4KT8uZ3JvdXBzIHx8IHt9XG4gICAgICAgIGNvbnN0IHRGaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpIGFzIFRGaWxlXG4gICAgICAgIGNvbnN0IGR2QXBpID0gcGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBjb25zdCBkdkZpbGUgPSBkdkFwaSAmJiBkdkFwaS5wYWdlKHRGaWxlLnBhdGgpXG4gICAgICAgIGlmICh0RmlsZSAmJiBkdkZpbGUpIHtcbiAgICAgICAgICAgIHBheWxvYWRzW2ZpbGVQYXRoXSA9IHBheWxvYWRzW2ZpbGVQYXRoXSB8fCBbXVxuICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VzID0gZi5maWxlTG9va3VwRmlsZXMuZ2V0KGlkKVxuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBmLmZpbGVzRmllbGRzLmdldChmaWxlUGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PSBmaWVsZE5hbWUpXG4gICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRUeXBlID0gZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlXG4gICAgICAgICAgICAgICAgaWYgKCFmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmdldChpZCkpIGYuZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUuc2V0KGlkLCBvdXRwdXRUeXBlKVxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3V0cHV0VHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkxpbmtzTGlzdDpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb29rdXAuVHlwZS5MaW5rc0J1bGxldExpc3Q6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWVzQXJyYXkgPSBwYWdlcz8ubWFwKChkdkZpbGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmllbGRNYW5hZ2VyLmJ1aWxkTWFya0Rvd25MaW5rKHBsdWdpbiwgdEZpbGUsIGR2RmlsZS5maWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gKG5ld1ZhbHVlc0FycmF5IHx8IFtdKS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkN1c3RvbUxpc3Q6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9va3VwLlR5cGUuQ3VzdG9tQnVsbGV0TGlzdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZW5kZXJpbmdGdW5jdGlvbiA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke2ZpZWxkLm9wdGlvbnMuY3VzdG9tTGlzdEZ1bmN0aW9ufWApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWVzQXJyYXkgPSBwYWdlcz8ubWFwKChkdkZpbGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlcmluZ0Z1bmN0aW9uKGR2RmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbmRlcmluZ0Vycm9ycy5pbmNsdWRlcyhmaWVsZC5uYW1lKSkgcmVuZGVyaW5nRXJyb3JzLnB1c2goZmllbGQubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gKG5ld1ZhbHVlc0FycmF5IHx8IFtdKS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkN1c3RvbVN1bW1hcml6aW5nOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb24gPSBmaWVsZC5vcHRpb25zLmN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb25cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcml6aW5nRnVuY3Rpb24gPSBuZXcgRnVuY3Rpb24oXCJwYWdlc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFx7XFx7c3VtbWFyaXplZEZpZWxkTmFtZVxcfVxcfS9nLCBmaWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gc3VtbWFyaXppbmdGdW5jdGlvbihwYWdlcykudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9va3VwLlR5cGUuQnVpbHRpblN1bW1hcml6aW5nOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1aWx0aW5GdW5jdGlvbiA9IGZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gYXMga2V5b2YgdHlwZW9mIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJpemluZ0Z1bmN0aW9uID0gbmV3IEZ1bmN0aW9uKFwicGFnZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uW2J1aWx0aW5GdW5jdGlvbl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHtcXHtzdW1tYXJpemVkRmllbGROYW1lXFx9XFx9L2csIGZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBzdW1tYXJpemluZ0Z1bmN0aW9uKHBhZ2VzKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbmRlcmluZ0Vycm9ycy5pbmNsdWRlcyhmaWVsZC5uYW1lKSkgcmVuZGVyaW5nRXJyb3JzLnB1c2goZmllbGQubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgdmFsdWUgaGFzIGNoYW5nZWQgaW4gb3JkZXIgbm90IHRvIGNyZWF0ZSBhbiBpbmZpbml0ZSBsb29wXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gZi5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUuZ2V0KGlkKSB8fCBhd2FpdCBwYXJzZUZpZWxkVmFsdWVzKHBsdWdpbiwgdEZpbGUsIGZpZWxkLm5hbWUpIHx8IFwiXCJcbiAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRDaGVja0ZvclVwZGF0ZSA9XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLm9wdGlvbnMuYXV0b1VwZGF0ZSB8fFxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgICAgICBmb3JjZVVwZGF0ZUFsbCB8fC8vZmllbGQgaXMgYXV0b1VwZGF0ZWQgT1JcbiAgICAgICAgICAgICAgICAgICAgKCAvL2ZpZWxkIGlzIG5vdCBhdXRvdXBkYXRlZCBhbmQgd2UgaGF2ZSB0byBjaGVjayBmb3IgcmVxdWVzdCB0byB1cGRhdGUgdGhpcyBvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlVXBkYXRlT25lPy5maWxlLnBhdGggPT09IHRGaWxlLnBhdGggJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlVXBkYXRlT25lPy5maWVsZE5hbWUgPT09IGZpZWxkLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlSGFzQ2hhbmdlZCA9ICghY3VycmVudFZhbHVlICYmIG5ld1ZhbHVlICE9PSBcIlwiKSB8fCAhYXJyYXlzQXNTdHJpbmdBcmVFcXVhbChjdXJyZW50VmFsdWUsIG5ld1ZhbHVlKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdEhhc0NoYW5nZWQgPSBvdXRwdXRUeXBlICE9PSBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmdldChpZClcbiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkQ2hlY2tGb3JVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZi5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUuc2V0KGlkLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUuc2V0KGlkLCBvdXRwdXRUeXBlKTtcbiAgICAgICAgICAgICAgICB9Ly8gbWFrZSBzdXJlIHRoYXQgdGhpcyBpcyBzZXQgYXQgZmlyc3QgaW5kZXhpbmd9XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZENoZWNrRm9yVXBkYXRlICYmICh2YWx1ZUhhc0NoYW5nZWQgfHwgZm9ybWF0SGFzQ2hhbmdlZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXNWYWx1ZXNDb3VudCA9IHBsdWdpbi5maWVsZEluZGV4LnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzLmdldChpZCkgfHwgMFxuICAgICAgICAgICAgICAgICAgICBwYXlsb2Fkc1tmaWxlUGF0aF0ucHVzaCh7IG5hbWU6IGZpZWxkTmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogbmV3VmFsdWUsIHByZXZpb3VzSXRlbXNDb3VudDogcHJldmlvdXNWYWx1ZXNDb3VudCB9IH0pXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRGaWVsZHMucHVzaChgJHtmaWxlUGF0aH1fXyR7ZmllbGROYW1lfWApXG4gICAgICAgICAgICAgICAgICAgIC8vYXdhaXQgcG9zdFZhbHVlcyhwbHVnaW4sIFt7IG5hbWU6IGZpZWxkTmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogbmV3VmFsdWUsIHByZXZpb3VzSXRlbXNDb3VudDogcHJldmlvdXNWYWx1ZXNDb3VudCB9IH1dLCB0RmlsZSlcbiAgICAgICAgICAgICAgICAgICAgLy9mLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuc2V0KGAke2ZpbGVQYXRofV9fJHtmaWVsZE5hbWV9YCwgTG9va3VwLlN0YXR1cy51cFRvRGF0ZSlcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNvdXJjZSAhPT0gXCJmdWxsIEluZGV4XCIpIHsgLy8gdGhpcyBjYXNlIGlzIGZvciBmaWxlQ2xhc3MgY2hhbmdlcywgbm8gbmVlZCBmb3IgcmV3cml0ZSBvdGhlciBsb29rdXBzIGFmdGVyIGNhY2hlIHVwZGF0ZVxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uZmllbGRJbmRleC5maWxlQ2hhbmdlZCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdmFsdWVIYXNDaGFuZ2VkICYmICFmb3JtYXRIYXNDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkc1N0YXR1cy5zZXQoYCR7ZmlsZVBhdGh9X18ke2ZpZWxkTmFtZX1gLCBMb29rdXAuU3RhdHVzLnVwVG9EYXRlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBPYmplY3QuZW50cmllcyhwYXlsb2FkcykuZm9yRWFjaChhc3luYyAoW2ZpbGVQYXRoLCBwYXlsb2FkXSkgPT4ge1xuICAgICAgICBpZiAocGF5bG9hZC5sZW5ndGgpIGF3YWl0IHBvc3RWYWx1ZXMocGx1Z2luLCBwYXlsb2FkLCBmaWxlUGF0aClcbiAgICB9KVxuICAgIHVwZGF0ZWRGaWVsZHMuZm9yRWFjaChmaWVsZCA9PiBmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuc2V0KGZpZWxkLCBMb29rdXAuU3RhdHVzLnVwVG9EYXRlKSlcbiAgICBpZiAocmVuZGVyaW5nRXJyb3JzLmxlbmd0aCkgbmV3IE5vdGljZShgVGhvc2UgZmllbGRzIGhhdmUgaW5jb3JyZWN0IG91dHB1dCByZW5kZXJpbmcgZnVuY3Rpb25zOlxcbiR7cmVuZGVyaW5nRXJyb3JzLmpvaW4oXCIsXFxuXCIpfWApXG4gICAgLy9jb25zb2xlLmxvZyhcImZpbmlzaGVkIHVwZGF0ZSBsb29rdXBzIFtcIiwgc291cmNlLCBcIl1cIiwgcGx1Z2luLmZpZWxkSW5kZXgubGFzdFJldmlzaW9uLCBcIi0+XCIsIHBsdWdpbi5maWVsZEluZGV4LmR2Py5hcGkuaW5kZXgucmV2aXNpb24sIGAkeyhEYXRlLm5vdygpIC0gc3RhcnQpfW1zYClcbn1cbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyBpbmxpbmVGaWVsZFJlZ2V4LCBlbmNvZGVMaW5rLCBkZWNvZGVMaW5rIH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFZhbHVlcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZU9yZmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPcmZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPcmZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yZmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjb250ZW50ID0gKGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKSkuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXI7XG4gICAgY29uc3QgeyBwb3NpdGlvbjogeyBzdGFydCwgZW5kIH0gfSA9IGZyb250bWF0dGVyID8gZnJvbnRtYXR0ZXIgOiB7IHBvc2l0aW9uOiB7IHN0YXJ0OiB1bmRlZmluZWQsIGVuZDogdW5kZWZpbmVkIH0gfTtcbiAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG4gICAgY29udGVudC5tYXAoKGxpbmUsIGkpID0+IHtcbiAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBpID49IHN0YXJ0LmxpbmUgJiYgaSA8PSBlbmQubGluZSkge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAke2F0dHJpYnV0ZX06KC4qKWAsICd1Jyk7XG4gICAgICAgICAgICBjb25zdCByID0gbGluZS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHJlc3VsdC5wdXNoKHJbMV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZnVsbExpbmVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX0oPzx2YWx1ZXM+W15cXFxcXV0qKWAsIFwidVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGZSID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaChmdWxsTGluZVJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChmUj8uZ3JvdXBzKSB7IHJlc3VsdC5wdXNoKGRlY29kZUxpbmsoZlIuZ3JvdXBzLnZhbHVlcykpIH07XG4gICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuICAgICAgICAgICAgY29uc3Qgc1JCID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhCcmFja2V0cyk7XG4gICAgICAgICAgICBsZXQgbmV4dCA9IHNSQi5uZXh0KCk7XG4gICAgICAgICAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICAgICAgICAgIGlmIChuZXh0LnZhbHVlLmdyb3VwcykgeyByZXN1bHQucHVzaChkZWNvZGVMaW5rKG5leHQudmFsdWUuZ3JvdXBzLnZhbHVlcykpIH1cbiAgICAgICAgICAgICAgICBuZXh0ID0gc1JCLm5leHQoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaW5TZW50ZW5jZVJlZ2V4UGFyID0gbmV3IFJlZ0V4cChgXFxcXCgke2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX0oPzx2YWx1ZXM+W15cXFxcKV0rKT9cXFxcKWAsIFwiZ3VcIik7XG4gICAgICAgICAgICBjb25zdCBzUlAgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoQWxsKGluU2VudGVuY2VSZWdleFBhcik7XG4gICAgICAgICAgICBuZXh0ID0gc1JQLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7IHJlc3VsdC5wdXNoKGRlY29kZUxpbmsobmV4dC52YWx1ZS5ncm91cHMudmFsdWVzKSkgfVxuICAgICAgICAgICAgICAgIG5leHQgPSBzUlAubmV4dCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiByZXN1bHQ7XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRGaWxlLCBNZW51LCBUZXh0QXJlYUNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSwgRmllbGRJY29uIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBTdGF0dXMgfSBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IHsgdXBkYXRlRm9ybXVsYXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3VwZGF0ZUZvcm11bGFzXCI7XG5pbXBvcnQgeyBwb3N0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9wb3N0VmFsdWVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm11bGFGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5Gb3JtdWxhKVxuICAgICAgICB0aGlzLnNob3dNb2RhbE9wdGlvbiA9IGZhbHNlXG4gICAgfVxuXG4gICAgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZiA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgICAgIGNvbnN0IGlkID0gYCR7ZmlsZS5wYXRofV9fJHt0aGlzLmZpZWxkLm5hbWV9YDtcbiAgICAgICAgbGV0IHN0YXR1czogU3RhdHVzO1xuICAgICAgICBzdGF0dXMgPSBmLmZpbGVGb3JtdWxhRmllbGRzU3RhdHVzLmdldChpZCkgfHwgU3RhdHVzLmNoYW5nZWRcbiAgICAgICAgY29uc3QgaWNvbiA9IHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQgPyBcInJlZnJlc2gtY2N3XCIgOiBcImZpbGUtY2hlY2tcIlxuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiB7IHVwZGF0ZUZvcm11bGFzKHRoaXMucGx1Z2luLCB7IGZpbGU6IGZpbGUsIGZpZWxkTmFtZTogdGhpcy5maWVsZC5uYW1lIH0pIH07XG4gICAgICAgIGlmIChGb3JtdWxhRmllbGQuaXNNZW51KGxvY2F0aW9uKSAmJiBzdGF0dXMgPT09IFN0YXR1cy5jaGFuZ2VkKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihpY29uKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoRm9ybXVsYUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IGljb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKEZvcm11bGFGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKGljb24sIGFjdGlvbiwgYFVwZGF0ZSAke25hbWV9J3MgdmFsdWVgKTtcbiAgICAgICAgfSBlbHNlIGlmIChGb3JtdWxhRmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pICYmIHN0YXR1cyA9PT0gU3RhdHVzLnVwVG9EYXRlKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oaWNvbiwgKCkgPT4geyB9LCBgJHtuYW1lfSBpcyB1cCB0byBkYXRlYCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBhZnRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFzTGlzdD86IGJvb2xlYW4sXG4gICAgICAgIGFzQ29tbWVudD86IGJvb2xlYW5cbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogdGhpcy5maWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBcIlwiIH0gfV0sIGZpbGUsIGxpbmVOdW1iZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudClcbiAgICB9XG5cbiAgICBjcmVhdGVEdkZpZWxkKGR2OiBhbnksIHA6IGFueSwgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LCBhdHRycz86IHsgY2xzPzogc3RyaW5nIHwgdW5kZWZpbmVkOyBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDsgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IH0pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycyk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQgPSAoKSA9PiB7IH0pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZiA9PiBmLm5hbWUgPT09IGZpZWxkTmFtZSk/LmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwiXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUuZ2V0KGAke2ZpbGUucGF0aH1fX2NhbGN1bGF0ZWRfXyR7ZmlsZUNsYXNzTmFtZX1fX18ke2ZpZWxkTmFtZX1gKSB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlRm9ybXVsYUNvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGF1dG9VcGRhdGVUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIGNvbnN0IGF1dG9VcGRhdGVDb250YWluZXIgPSBhdXRvVXBkYXRlVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICBhdXRvVXBkYXRlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiQXV0byB1cGRhdGUgdGhpcyBmaWVsZCBcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBhdXRvVXBkYXRlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgYXV0b1VwZGF0ZSA9IG5ldyBUb2dnbGVDb21wb25lbnQoYXV0b1VwZGF0ZUNvbnRhaW5lcik7XG4gICAgICAgIGF1dG9VcGRhdGVUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJUaGlzIGNvdWxkIGxlYWQgdG8gbGF0ZW5jaWVzIGRlcGVuZGluZyBvbiB0aGUgcXVlcmllc1wiLCBjbHM6ICdzdWItdGV4dCB3YXJuaW5nJyB9KTtcblxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgPT09IHVuZGVmaW5lZCkgdGhpcy5maWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgPSBmYWxzZVxuICAgICAgICBhdXRvVXBkYXRlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlKTtcbiAgICAgICAgYXV0b1VwZGF0ZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuYXV0b1VwZGF0ZSA9IHZhbHVlXG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgZm9ybXVsYVRvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgZm9ybXVsYVRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcImphdmFzY3JpcHQgZm9ybXVsYVwiLCBjbHM6ICdsYWJlbCcgfSk7XG4gICAgICAgIGZvcm11bGFUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJjdXJyZW50IGFuZCBwYWdlcyB2YXJpYWJsZXMgYXJlIGF2YWlsYWJsZWBcIiwgY2xzOiAnc3ViLXRleHQnIH0pO1xuICAgICAgICBjb25zdCBmb3JtdWxhQ29udGFpbmVyID0gZm9ybXVsYVRvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGNvbnN0IGZvcm11bGEgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZm9ybXVsYUNvbnRhaW5lcik7XG4gICAgICAgIGZvcm11bGEuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGZvcm11bGEuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGZvcm11bGEuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgZm9ybXVsYS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZm9ybXVsYSB8fCBcIlwiKTtcbiAgICAgICAgZm9ybXVsYS5zZXRQbGFjZWhvbGRlcihcImV4YW1wZTogY3VycmVudC5hcHBsZSArIGN1cnJlbnQuYmFuYW5hcyAtIDNcIik7XG5cbiAgICAgICAgZm9ybXVsYS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZm9ybXVsYSA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcihmb3JtdWxhKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jcmVhdGVGb3JtdWxhQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcilcbiAgICB9XG5cbiAgICBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuZm9ybXVsYVxuICAgIH1cblxuICAgIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBTdGF0dXMgfSBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBwb3N0VmFsdWVzIH0gZnJvbSBcIi4vcG9zdFZhbHVlc1wiO1xuaW1wb3J0IHsgYXJyYXlzQXNTdHJpbmdBcmVFcXVhbCB9IGZyb20gXCIuL3VwZGF0ZUxvb2t1cHNcIjtcblxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYW5SZW1vdmVkRm9ybXVsYXNGcm9tSW5kZXgoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbik6IHZvaWQge1xuICAgIGNvbnN0IGYgPSBwbHVnaW4uZmllbGRJbmRleDtcbiAgICBmb3IgKGxldCBpZCBvZiBmLmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUua2V5cygpKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoUmVnZXggPSAvKD88ZmlsZVBhdGg+LiopX19jYWxjdWxhdGVkX18oPzxmaWxlQ2xhc3NOYW1lPi4qKV9fXyg/PGZpZWxkTmFtZT4uKikvXG4gICAgICAgIGNvbnN0IHsgZmlsZVBhdGgsIGZpbGVDbGFzc05hbWUsIGZpZWxkTmFtZSB9ID0gaWQubWF0Y2gobWF0Y2hSZWdleCk/Lmdyb3VwcyB8fCB7fVxuICAgICAgICBjb25zdCBleGlzdGluZ0Zvcm11bGFGaWVsZFdpdGhOYW1lQW5kRmlsZUNsYXNzTmFtZSA9IGYuZmlsZXNGaWVsZHNcbiAgICAgICAgICAgIC5nZXQoZmlsZVBhdGgpPy5maW5kKGZpZWxkID0+XG4gICAgICAgICAgICAgICAgKGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSkgJiZcbiAgICAgICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgICAgIChmaWVsZC5maWxlQ2xhc3NOYW1lID09PSB1bmRlZmluZWQgJiYgZmlsZUNsYXNzTmFtZSA9PT0gXCJwcmVzZXRGaWVsZFwiKSB8fFxuICAgICAgICAgICAgICAgICAgICAoZmllbGQuZmlsZUNsYXNzTmFtZSA9PT0gZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgIGNvbnN0IGR2UGFnZSA9IGYuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpO1xuICAgICAgICBpZiAoZHZQYWdlID09PSB1bmRlZmluZWQgfHwgZHZQYWdlW2ZpZWxkTmFtZV0gPT09IHVuZGVmaW5lZCB8fCAhZXhpc3RpbmdGb3JtdWxhRmllbGRXaXRoTmFtZUFuZEZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGYuZmlsZUZvcm11bGFGaWVsZExhc3RWYWx1ZS5kZWxldGUoaWQpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlRm9ybXVsYXMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZm9yY2VVcGRhdGVPbmU/OiB7IGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZyB9LFxuICAgIGZvcmNlVXBkYXRlQWxsOiBib29sZWFuID0gZmFsc2Vcbik6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpXG4gICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0IHVwZGF0ZSBmb3JtdWxhc1wiLCBwbHVnaW4uZmllbGRJbmRleC5sYXN0UmV2aXNpb24sIFwiLT5cIiwgcGx1Z2luLmZpZWxkSW5kZXguZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgbGV0IHJlbmRlcmluZ0Vycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICAvLzEuIGZsYXR0ZW4gYWxsIGZpbGVfX2Zvcm11bGFGaWVsZCBpbiBhIE1hcFxuICAgIGNvbnN0IGZpbGVGb3JtdWxhc0ZpZWxkczogTWFwPHN0cmluZywgRmllbGQ+ID0gbmV3IE1hcCgpO1xuICAgIFsuLi5mLmZpbGVzTG9va3VwQW5kRm9ybXVsYUZpZWxkc0V4aXN0c10uZm9yRWFjaCgoW2ZpbGVQYXRoLCBmaWVsZHNdKSA9PiB7XG4gICAgICAgIGZpZWxkcy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkZvcm11bGEpLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICAgICAgZmlsZUZvcm11bGFzRmllbGRzLnNldChgJHtmaWxlUGF0aH1fX2NhbGN1bGF0ZWRfXyR7ZmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X19fJHtmaWVsZC5uYW1lfWAsIGZpZWxkKVxuICAgICAgICB9KVxuICAgIH0pO1xuICAgIC8vMi4gY2FsY3VsYXRlIGZvcm11bGEgYW5kIHVwZGF0ZSBmaWxlIGlmIHZhbHVlIGhhcyBjaGFuZ2VkXG4gICAgWy4uLmZpbGVGb3JtdWxhc0ZpZWxkc10uZm9yRWFjaChhc3luYyAoW2lkLCBmaWVsZF0pID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2hSZWdleCA9IC8oPzxmaWxlUGF0aD4uKilfX2NhbGN1bGF0ZWRfXyg/PGZpbGVDbGFzc05hbWU+LiopX19fKD88ZmllbGROYW1lPi4qKS9cbiAgICAgICAgY29uc3QgeyBmaWxlUGF0aCwgZmlsZUNsYXNzTmFtZSwgZmllbGROYW1lIH0gPSBpZC5tYXRjaChtYXRjaFJlZ2V4KT8uZ3JvdXBzIHx8IHt9XG4gICAgICAgIGNvbnN0IHNob3VsZFVwZGF0ZSA9XG4gICAgICAgICAgICBmb3JjZVVwZGF0ZUFsbCB8fFxuICAgICAgICAgICAgZm9yY2VVcGRhdGVPbmU/LmZpbGUucGF0aCA9PT0gZmlsZVBhdGggJiYgZm9yY2VVcGRhdGVPbmU/LmZpZWxkTmFtZSA9PT0gZmllbGROYW1lIHx8XG4gICAgICAgICAgICBmaWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgPT09IHRydWVcbiAgICAgICAgY29uc3QgZHZGaWxlID0gZi5kdi5hcGkucGFnZShmaWxlUGF0aClcbiAgICAgICAgY29uc3QgY3VycmVudGR2VmFsdWUgPSBkdkZpbGUgJiYgZHZGaWxlW2ZpZWxkLm5hbWVdXG5cbiAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gY3VycmVudGR2VmFsdWUgPyBjdXJyZW50ZHZWYWx1ZS50b1N0cmluZygpIDogXCJcIlxuICAgICAgICBmLmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUuc2V0KGlkLCBjdXJyZW50VmFsdWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAobmV3IEZ1bmN0aW9uKFwiY3VycmVudCwgZHZcIiwgYHJldHVybiAke2ZpZWxkLm9wdGlvbnMuZm9ybXVsYX1gKSkoZHZGaWxlLCBmLmR2LmFwaSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlSGFzQ2hhbmdlZCA9ICghY3VycmVudFZhbHVlICYmIG5ld1ZhbHVlICE9PSBcIlwiKSB8fCAhYXJyYXlzQXNTdHJpbmdBcmVFcXVhbChjdXJyZW50VmFsdWUsIG5ld1ZhbHVlKSB8fCBjdXJyZW50VmFsdWUgIT09IG5ld1ZhbHVlXG4gICAgICAgICAgICBpZiAoIXZhbHVlSGFzQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGYuZmlsZUZvcm11bGFGaWVsZHNTdGF0dXMuc2V0KGAke2ZpbGVQYXRofV9fJHtmaWVsZE5hbWV9YCwgU3RhdHVzLnVwVG9EYXRlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghc2hvdWxkVXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGYuZmlsZUZvcm11bGFGaWVsZHNTdGF0dXMuc2V0KGAke2ZpbGVQYXRofV9fJHtmaWVsZC5uYW1lfWAsIFN0YXR1cy5jaGFuZ2VkKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBvc3RWYWx1ZXMocGx1Z2luLCBbeyBuYW1lOiBmaWVsZC5uYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiBuZXdWYWx1ZSB9IH1dLCBmaWxlUGF0aClcbiAgICAgICAgICAgICAgICAgICAgZi5maWxlRm9ybXVsYUZpZWxkTGFzdFZhbHVlLnNldChpZCwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBmLmZpbGVGb3JtdWxhRmllbGRzU3RhdHVzLnNldChgJHtmaWxlUGF0aH1fXyR7ZmllbGQubmFtZX1gLCBTdGF0dXMudXBUb0RhdGUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIGlmIChyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgIH1cbiAgICB9KVxuICAgIGlmIChyZW5kZXJpbmdFcnJvcnMubGVuZ3RoKSBuZXcgTm90aWNlKGBUaG9zZSBmaWVsZHMgaGF2ZSBpbmNvcnJlY3Qgb3V0cHV0IHJlbmRlcmluZyBmdW5jdGlvbnM6XFxuJHtyZW5kZXJpbmdFcnJvcnMuam9pbihcIixcXG5cIil9YCk7XG4gICAgLy9jb25zb2xlLmxvZyhcImZpbmlzaGVkIHVwZGF0ZSBmb3JtdWxhc1wiLCBwbHVnaW4uZmllbGRJbmRleC5sYXN0UmV2aXNpb24sIFwiLT5cIiwgcGx1Z2luLmZpZWxkSW5kZXguZHY/LmFwaS5pbmRleC5yZXZpc2lvbiwgYCR7KERhdGUubm93KCkgLSBzdGFydCl9bXNgKVxuICAgIC8vMyByZW1vdmUgbm9uIGV4aXN0aW5nIGZvcm11bGEgZmllbGRzIGZyb20gaW5kZXgsIHNpbmNlIHRob3NlIGluZGV4ZXMgYXJlbid0IGZsdXNoZWQgZWFjaCB0aW1lXG4gICAgY2xlYW5SZW1vdmVkRm9ybXVsYXNGcm9tSW5kZXgocGx1Z2luKTtcbn1cbiIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgc2V0SWNvbiwgRHJvcGRvd25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBDb2xvckNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWxlU3VnZ2VzdCB9IGZyb20gXCJzcmMvc3VnZ2VzdGVyL0ZpbGVTdWdnZXN0ZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBhYnN0cmFjdCBjYW52YXNQYXRoSW5wdXQ6IFRleHRDb21wb25lbnQ7XG4gICAgcHJvdGVjdGVkIHN0YW5kYXJkQ29sb3JzID0gW1wiMVwiLCBcIjJcIiwgXCIzXCIsIFwiNFwiLCBcIjVcIiwgXCI2XCJdXG4gICAgcHJvdGVjdGVkIHNpZGVzID0gW1xuICAgICAgICBbXCJ0b3BcIiwgXCJjaGV2cm9uLXVwXCJdLFxuICAgICAgICBbXCJyaWdodFwiLCBcImNoZXZyb24tcmlnaHRcIl0sXG4gICAgICAgIFtcImJvdHRvbVwiLCBcImNoZXZyb24tZG93blwiXSxcbiAgICAgICAgW1wibGVmdFwiLCBcImNoZXZyb24tbGVmdFwiXVxuICAgIF1cblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQsIHR5cGU6IEZpZWxkVHlwZSkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCB0eXBlKVxuICAgIH1cblxuICAgIHB1YmxpYyBidWlsZENvbG9yc0NvbnRhaW5lciA9IChjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBjb2xvckxpc3Q6IHN0cmluZ1tdLCBsYWJlbDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnRhaW5lci5yZXBsYWNlQ2hpbGRyZW4oLi4uW10pO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogbGFiZWwsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICBjb25zdCB0b2dnbGVTdGFuZGFyZENvbG9yQnV0dG9uID0gKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGNvbG9yOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGlmIChjb2xvckxpc3QuaW5jbHVkZXMoY29sb3IpKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIHNldEljb24oY29udGFpbmVyLCBcImNyb3NzXCIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgc2V0SWNvbihjb250YWluZXIsIFwicGx1c1wiKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnN0YW5kYXJkQ29sb3JzLmZvckVhY2goY29sb3IgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29sb3JDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm9kZS1jb2xvciBjb2xvci0ke2NvbG9yfWAgfSlcbiAgICAgICAgICAgIHRvZ2dsZVN0YW5kYXJkQ29sb3JCdXR0b24oY29sb3JDb250YWluZXIsIGNvbG9yKVxuICAgICAgICAgICAgY29sb3JDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29sb3JDb250YWluZXIuc2V0QXR0cihcInN0eWxlXCIsIGBjb2xvcjogd2hpdGVgKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29sb3JDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb2xvckNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29sb3JDb250YWluZXIub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2xvcnMgPSBjb2xvckxpc3QgYXMgc3RyaW5nW11cbiAgICAgICAgICAgICAgICBpZiAoY29sb3JzLmluY2x1ZGVzKGNvbG9yKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnMucmVtb3ZlKGNvbG9yKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9ycy5wdXNoKGNvbG9yKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdG9nZ2xlU3RhbmRhcmRDb2xvckJ1dHRvbihjb2xvckNvbnRhaW5lciwgY29sb3IpXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCB0b2dnbGVBbHRDb2xvcnMgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhbHRHcm91cENvbG9yczogc3RyaW5nW10gPSBjb2xvckxpc3QgJiYgY29sb3JMaXN0LmZpbHRlcigoY29sb3I6IHN0cmluZykgPT4gIXRoaXMuc3RhbmRhcmRDb2xvcnMuaW5jbHVkZXMoY29sb3IpKSB8fCBbXVxuICAgICAgICAgICAgYWx0R3JvdXBDb2xvcnMuZm9yRWFjaChjb2xvciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29sb3JDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm9kZS1jb2xvcmAgfSlcbiAgICAgICAgICAgICAgICBjb2xvckNvbnRhaW5lci5zZXRBdHRyKFwic3R5bGVcIiwgYGJhY2tncm91bmQtY29sb3I6ICR7Y29sb3J9OyBjb2xvcjogJHtjb2xvcn1gKVxuICAgICAgICAgICAgICAgIGNvbG9yQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb2xvckNvbnRhaW5lci5zZXRBdHRyKFwic3R5bGVcIiwgYGJhY2tncm91bmQtY29sb3I6ICR7Y29sb3J9OyBjb2xvcjogd2hpdGVgKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2xvckNvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb2xvckNvbnRhaW5lci5zZXRBdHRyKFwic3R5bGVcIiwgYGJhY2tncm91bmQtY29sb3I6ICR7Y29sb3J9OyBjb2xvcjogJHtjb2xvcn1gKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRJY29uKGNvbG9yQ29udGFpbmVyLCBcImNyb3NzXCIpXG4gICAgICAgICAgICAgICAgY29sb3JDb250YWluZXIub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgKGNvbG9yTGlzdCBhcyBzdHJpbmdbXSkucmVtb3ZlKGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKGNvbG9yQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIHRvZ2dsZUFsdENvbG9ycygpXG5cbiAgICAgICAgY29uc3QgYWx0Q29sb3JQaWNrZXJDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm9kZS1jb2xvciBwaWNrZXJgIH0pXG4gICAgICAgIGNvbnN0IGFsdENvbG9yUGlja2VyID0gbmV3IENvbG9yQ29tcG9uZW50KGFsdENvbG9yUGlja2VyQ29udGFpbmVyKTtcbiAgICAgICAgYWx0Q29sb3JQaWNrZXIub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgY29sb3JMaXN0LnB1c2godmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5idWlsZENvbG9yc0NvbnRhaW5lcihjb250YWluZXIsIGNvbG9yTGlzdCwgbGFiZWwpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBidWlsZEVkZ2VTaWRlQ29udGFpbmVyID0gKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGVkZ2VMaXN0OiBzdHJpbmdbXSwgbGFiZWw6IHN0cmluZykgPT4ge1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImxhYmVsXCIsIHRleHQ6IGxhYmVsIH0pXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgdGhpcy5zaWRlcy5mb3JFYWNoKChbc2lkZSwgaWNvbk5hbWVdKSA9PiB7XG4gICAgICAgICAgICBlZGdlTGlzdCA9IChlZGdlTGlzdCBhcyBzdHJpbmdbXSB8IHVuZGVmaW5lZCkgfHwgdGhpcy5zaWRlcy5tYXAoc2lkZSA9PiBzaWRlWzBdKVxuICAgICAgICAgICAgY29uc3QgZWRnZVNpZGVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImVkZ2Utc2lkZVwiIH0pXG4gICAgICAgICAgICBjb25zdCBzaWRlSWNvbkNvbnRhaW5lciA9IGVkZ2VTaWRlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzaWRlLWljb25cIiB9KVxuICAgICAgICAgICAgc2V0SWNvbihzaWRlSWNvbkNvbnRhaW5lciwgaWNvbk5hbWUpXG4gICAgICAgICAgICBjb25zdCBzaWRlVG9nZ2xlckNvbnRhaW5lciA9IG5ldyBUb2dnbGVDb21wb25lbnQoZWRnZVNpZGVDb250YWluZXIpO1xuICAgICAgICAgICAgc2lkZVRvZ2dsZXJDb250YWluZXIuc2V0VmFsdWUoZWRnZUxpc3QuaW5jbHVkZXMoc2lkZSkpXG4gICAgICAgICAgICBzaWRlVG9nZ2xlckNvbnRhaW5lci5vbkNoYW5nZSh2YWx1ZSA9PiB2YWx1ZSA/IGVkZ2VMaXN0LnB1c2goc2lkZSkgOiBlZGdlTGlzdC5yZW1vdmUoc2lkZSkpXG4gICAgICAgIH0pXG5cbiAgICB9XG5cbiAgICBwdWJsaWMgYnVpbGRMYWJlbHNDb250YWluZXIgPSAoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgbGFiZWxzOiBzdHJpbmdbXSwgdGl0bGU6IHN0cmluZykgPT4ge1xuICAgICAgICBjb250YWluZXIucmVwbGFjZUNoaWxkcmVuKC4uLltdKTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiB0aXRsZSB9KTtcbiAgICAgICAgKGxhYmVscyBhcyBzdHJpbmdbXSkuZm9yRWFjaChsYWJlbCA9PiB7XG4gICAgICAgICAgICBjb25zdCBsYWJlbENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbSBjaGlwXCIsIHRleHQ6IGxhYmVsIH0pXG4gICAgICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGxhYmVsQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgIC5zZXRJY29uKFwieC1jaXJjbGVcIilcbiAgICAgICAgICAgICAgICAuc2V0Q2xhc3MoXCJpdGVtLXJlbW92ZVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWxzLnJlbW92ZShsYWJlbClcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKGxhYmVsQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGJ1aWxkTmV3TGFiZWxDb250YWluZXIgPSAoXG4gICAgICAgIGN1cnJlbnRMYWJlbHNDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBjdXJyZW50TGFiZWxzVGl0bGU6IHN0cmluZyxcbiAgICAgICAgbmV3TGFiZWxDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBsYWJlbHM6IHN0cmluZ1tdLFxuICAgICAgICB0aXRsZTogc3RyaW5nXG4gICAgKSA9PiB7XG4gICAgICAgIG5ld0xhYmVsQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiB0aXRsZSB9KVxuICAgICAgICBuZXdMYWJlbENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgbGFiZWxJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KG5ld0xhYmVsQ29udGFpbmVyKTtcbiAgICAgICAgY29uc3QgbGFiZWxWYWxpZGF0ZSA9IG5ldyBCdXR0b25Db21wb25lbnQobmV3TGFiZWxDb250YWluZXIpO1xuICAgICAgICBsYWJlbElucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHZhbHVlID8gbGFiZWxWYWxpZGF0ZS5zZXRDdGEoKSA6IGxhYmVsVmFsaWRhdGUucmVtb3ZlQ3RhKCkpXG4gICAgICAgIGxhYmVsVmFsaWRhdGUuc2V0SWNvbihcInBsdXMtY2lyY2xlXCIpXG4gICAgICAgIGxhYmVsVmFsaWRhdGUub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBsYWJlbHMucHVzaChsYWJlbElucHV0LmdldFZhbHVlKCkpO1xuICAgICAgICAgICAgdGhpcy5idWlsZExhYmVsc0NvbnRhaW5lcihjdXJyZW50TGFiZWxzQ29udGFpbmVyLCBsYWJlbHMsIGN1cnJlbnRMYWJlbHNUaXRsZSk7XG4gICAgICAgICAgICBsYWJlbElucHV0LnNldFZhbHVlKFwiXCIpXG4gICAgICAgICAgICBsYWJlbFZhbGlkYXRlLnJlbW92ZUN0YSgpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVDYW52YXNQYXRoQ29udGFpbmVyID0gKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpID0+IHtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IGBQYXRoIG9mIHRoZSBjYW52YXNgLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgY29uc3QgY2FudmFzUGF0aElucHV0ID0gbmV3IFRleHRDb21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgY2FudmFzUGF0aElucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBjYW52YXNQYXRoSW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIik7XG4gICAgICAgIG5ldyBGaWxlU3VnZ2VzdChcbiAgICAgICAgICAgIGNhbnZhc1BhdGhJbnB1dC5pbnB1dEVsLFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICBcIi9cIixcbiAgICAgICAgICAgIFwiY2FudmFzXCJcbiAgICAgICAgKVxuICAgICAgICBjb25zdCBjYW52YXNQYXRoID0gdGhpcy5maWVsZC5vcHRpb25zLmNhbnZhc1BhdGg7XG4gICAgICAgIGNhbnZhc1BhdGhJbnB1dC5zZXRWYWx1ZShjYW52YXNQYXRoIHx8IFwiXCIpO1xuICAgICAgICBjYW52YXNQYXRoSW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJQYXRoL29mL3RoZS9maWxlLmNhbnZhc1wiKTtcbiAgICAgICAgY2FudmFzUGF0aElucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY2FudmFzUGF0aElucHV0KVxuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmNhbnZhc1BhdGggPSB2YWx1ZVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jYW52YXNQYXRoSW5wdXQgPSBjYW52YXNQYXRoSW5wdXRcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRGlyZWN0aW9uQ29udGFpbmVyID0gKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHRpdGxlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHRpdGxlLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uU2VsZWN0aW9uID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIFtcbiAgICAgICAgICAgIFtcImluY29taW5nXCIsIFwiSW5jb21pbmdcIl0sXG4gICAgICAgICAgICBbXCJvdXRnb2luZ1wiLCBcIk91dGdvaW5nXCJdLFxuICAgICAgICAgICAgW1wiYm90aHNpZGVzXCIsIFwiQm90aCBzaWRlc1wiXVxuICAgICAgICBdLmZvckVhY2goKFtkaXJlY3Rpb24sIGxhYmVsXSkgPT4gZGlyZWN0aW9uU2VsZWN0aW9uLmFkZE9wdGlvbihkaXJlY3Rpb24sIGxhYmVsKSk7XG4gICAgICAgIGRpcmVjdGlvblNlbGVjdGlvbi5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZGlyZWN0aW9uIHx8IFwiaW5jb21pbmdcIilcbiAgICAgICAgZGlyZWN0aW9uU2VsZWN0aW9uLm9uQ2hhbmdlKHZhbHVlID0+IHRoaXMuZmllbGQub3B0aW9ucy5kaXJlY3Rpb24gPSB2YWx1ZSlcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZRdWVyeUNvbnRhaW5lciA9IChjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCB0aXRsZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiB0aXRsZSB9KTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGF0YXZpZXcgcXVlcnkgcmV0dXJuaW5nIGEgbGlzdCBvZiBmaWxlcyAoPGR2PiBvYmplY3QgaXMgYXZhaWxhYmxlKVwiLCBjbHM6IFwic3ViLXRleHRcIiB9KTtcbiAgICAgICAgY29uc3QgZmlsZXNGcm9tRFZRdWVyeUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgZmlsZXNGcm9tRFZRdWVyeSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChmaWxlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyKTtcbiAgICAgICAgZmlsZXNGcm9tRFZRdWVyeS5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgZmlsZXNGcm9tRFZRdWVyeS5pbnB1dEVsLmNvbHMgPSA2NTtcbiAgICAgICAgZmlsZXNGcm9tRFZRdWVyeS5pbnB1dEVsLnJvd3MgPSAzO1xuICAgICAgICBmaWxlc0Zyb21EVlF1ZXJ5LnNldFBsYWNlaG9sZGVyKFwiZXg6IGR2LnBhZ2VzKCcjc3R1ZGVudCcpXCIpXG4gICAgICAgIGZpbGVzRnJvbURWUXVlcnkuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmZpbGVzRnJvbURWUXVlcnkgfHwgXCJcIik7XG4gICAgICAgIGZpbGVzRnJvbURWUXVlcnkub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZmlsZXNGcm9tRFZRdWVyeSA9IHZhbHVlXG4gICAgICAgIH0pXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IFRGaWxlLCBNZW51LCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIlxuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIlxuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCJcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIlxuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCJcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIlxuaW1wb3J0IHsgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiXG5pbXBvcnQgQWJzdHJhY3RDYW52YXNCYXNlZEZpZWxkIGZyb20gXCIuL0Fic3RyYWN0Q2FudmFzQmFzZWRGaWVsZFwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhc0ZpZWxkIGV4dGVuZHMgQWJzdHJhY3RDYW52YXNCYXNlZEZpZWxkIHtcblxuICAgIGNhbnZhc1BhdGhJbnB1dDogVGV4dENvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLkNhbnZhcylcbiAgICB9XG5cbiAgICBwdWJsaWMgZGlzcGxheVZhbHVlKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZywgb25DbGljazogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IGR2VmFsdWUgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClbZmllbGROYW1lXVxuICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gQXJyYXkuaXNBcnJheShkdlZhbHVlKSA/IGR2VmFsdWUgOiBbZHZWYWx1ZV1cbiAgICAgICAgICAgIHZhbHVlcy5mb3JFYWNoKCh2YWx1ZSwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkdkFwaS52YWx1ZS5pc0xpbmsodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBjb250YWluZXIuY3JlYXRlRWwoJ2EnLCB7IHRleHQ6IHZhbHVlLnBhdGguc3BsaXQoXCIvXCIpLmxhc3QoKS5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgbGluay5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQodmFsdWUucGF0aCwgZmlsZS5wYXRoLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaygpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpIDwgdmFsdWVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBcIiB8IFwiIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KClcbiAgICB9XG5cbiAgICBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICAvL25vIGZpZWxkIG9wdGlvbiB0byBhZGQgZm9yIHRoaXMgZmllbGQsIGl0IGlzIGF1dG9tYXRpY2FsbHkgdXBkYXRlZFxuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogXCJcIiB9IH1dLCBmaWxlLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgfVxuXG4gICAgY3JlYXRlRHZGaWVsZChkdjogYW55LCBwOiBhbnksIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkIH0pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycyk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgIH1cblxuICAgIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG5cbiAgICAgICAgLy9vcHRpb25zXG4gICAgICAgIC8vaW5pdGlhbCB2YWx1ZXNcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICBvcHRpb25zLmRpcmVjdGlvbiA9IChvcHRpb25zLmRpcmVjdGlvbiBhcyBcImluY29taW5nXCIgfCBcIm91dGdvaW5nXCIgfCBcImJvdGhzaWRlc1wiKSB8fCBcImJvdGhzaWRlc1wiXG4gICAgICAgIG9wdGlvbnMubm9kZUNvbG9ycyA9IChvcHRpb25zLm5vZGVDb2xvcnMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMuZWRnZUNvbG9ycyA9IChvcHRpb25zLmVkZ2VDb2xvcnMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMuZWRnZUZyb21TaWRlcyA9IChvcHRpb25zLmVkZ2VGcm9tU2lkZXMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMuZWRnZVRvU2lkZXMgPSAob3B0aW9ucy5lZGdlVG9TaWRlcyBhcyBzdHJpbmdbXSB8IHVuZGVmaW5lZCkgfHwgW11cbiAgICAgICAgb3B0aW9ucy5lZGdlTGFiZWxzID0gKG9wdGlvbnMuZWRnZUxhYmVscyBhcyBzdHJpbmdbXSB8IHVuZGVmaW5lZCkgfHwgW11cblxuICAgICAgICAvL2xheW91dFxuICAgICAgICBjb25zdCBjYW52YXNQYXRoQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKFwiaHJcIik7XG4gICAgICAgIGNvbnN0IGRpcmVjdGlvbkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGNvbnN0IGVkZ2VDb2xvcnNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lciBjb2xvcnNcIiB9KTtcbiAgICAgICAgY29uc3QgZWRnZUZyb21TaWRlc0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyIGVkZ2VzXCIgfSlcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzdWItdGV4dFwiLCB0ZXh0OiBcIk5vIGVkZ2Ugc2VsZWN0ZWQgaXMgZXF1aXZhbGVudCB0byBhbGwgZWRnZXMgc2VsZWN0ZWRcIiB9KVxuICAgICAgICBjb25zdCBlZGdlVG9TaWRlc0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyIGVnZGVzXCIgfSlcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzdWItdGV4dFwiLCB0ZXh0OiBcIk5vIGVkZ2Ugc2VsZWN0ZWQgaXMgZXF1aXZhbGVudCB0byBhbGwgZWRnZXMgc2VsZWN0ZWRcIiB9KVxuICAgICAgICBjb25zdCBlZGdlTGFiZWxzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXIgbGFiZWxzXCIgfSk7XG4gICAgICAgIGNvbnN0IG5ld0VkZ2VMYWJlbENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbChcImhyXCIpO1xuICAgICAgICBjb25zdCBub2RlQ29sb3JzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXIgY29sb3JzXCIgfSk7XG4gICAgICAgIGNvbnN0IGZpbGVzRnJvbURWUXVlcnlUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSlcblxuICAgICAgICAvL2J1aWxkZXJzXG4gICAgICAgIHRoaXMuY3JlYXRlQ2FudmFzUGF0aENvbnRhaW5lcihjYW52YXNQYXRoQ29udGFpbmVyKVxuICAgICAgICB0aGlzLmNyZWF0ZURpcmVjdGlvbkNvbnRhaW5lcihkaXJlY3Rpb25Db250YWluZXIsIGBEaXJlY3Rpb24gb2YgdGhlIGVkZ2VzIHBvaW50aW5nIHRvIHRob3NlIG5vZGVzYClcbiAgICAgICAgdGhpcy5jcmVhdGVEdlF1ZXJ5Q29udGFpbmVyKGZpbGVzRnJvbURWUXVlcnlUb3BDb250YWluZXIsIFwiTWF0Y2hpbmcgZmlsZXNcIilcbiAgICAgICAgdGhpcy5idWlsZENvbG9yc0NvbnRhaW5lcihub2RlQ29sb3JzQ29udGFpbmVyLCBvcHRpb25zLm5vZGVDb2xvcnMsIFwiTm9kZSBtYXRjaGluZyBjb2xvcnM6XCIpO1xuICAgICAgICB0aGlzLmJ1aWxkQ29sb3JzQ29udGFpbmVyKGVkZ2VDb2xvcnNDb250YWluZXIsIG9wdGlvbnMuZWRnZUNvbG9ycywgXCJFZGdlIG1hdGNoaW5nIGNvbG9yczpcIilcbiAgICAgICAgdGhpcy5idWlsZEVkZ2VTaWRlQ29udGFpbmVyKGVkZ2VGcm9tU2lkZXNDb250YWluZXIsIG9wdGlvbnMuZWRnZUZyb21TaWRlcywgXCJFZGdlcyBtYXRjaGluIEZyb20gc2lkZTpcIilcbiAgICAgICAgdGhpcy5idWlsZEVkZ2VTaWRlQ29udGFpbmVyKGVkZ2VUb1NpZGVzQ29udGFpbmVyLCBvcHRpb25zLmVkZ2VUb1NpZGVzLCBcIkVkZ2VzIG1hdGNoaW4gVG8gc2lkZTpcIilcbiAgICAgICAgdGhpcy5idWlsZExhYmVsc0NvbnRhaW5lcihlZGdlTGFiZWxzQ29udGFpbmVyLCBvcHRpb25zLmVkZ2VMYWJlbHMsIFwiRWRnZXMgbWF0Y2hpbmcgbGFiZWxzOiBcIik7XG4gICAgICAgIHRoaXMuYnVpbGROZXdMYWJlbENvbnRhaW5lcihlZGdlTGFiZWxzQ29udGFpbmVyLCBcIkVkZ2VzIG1hdGNoaW5nIGxhYmVsczogXCIsIG5ld0VkZ2VMYWJlbENvbnRhaW5lciwgb3B0aW9ucy5lZGdlTGFiZWxzLCBcIkFkZCBhIG5ldyBtYXRjaGluZyBlZGdlIGxhYmVsXCIpXG4gICAgfVxuXG4gICAgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2U7XG4gICAgICAgIGlmICghKHRoaXMuZmllbGQub3B0aW9ucy5jYW52YXNQYXRoIGFzIHN0cmluZyk/LmVuZHNXaXRoKFwiLmNhbnZhc1wiKSkge1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc1BhdGhJbnB1dCxcbiAgICAgICAgICAgICAgICBcIlRoaXMgaXMgbm90IGEgY2FudmFzIGZpbGVcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIWVycm9yXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IFRGaWxlLCBNZW51LCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIlxuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIlxuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCJcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIlxuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCJcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIlxuaW1wb3J0IHsgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiXG5pbXBvcnQgQWJzdHJhY3RDYW52YXNCYXNlZEZpZWxkIGZyb20gXCIuL0Fic3RyYWN0Q2FudmFzQmFzZWRGaWVsZFwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhc0dyb3VwRmllbGQgZXh0ZW5kcyBBYnN0cmFjdENhbnZhc0Jhc2VkRmllbGQge1xuXG4gICAgY2FudmFzUGF0aElucHV0OiBUZXh0Q29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuQ2FudmFzR3JvdXApXG4gICAgfVxuXG4gICAgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgLy9ubyBmaWVsZCBvcHRpb24gdG8gYWRkIGZvciB0aGlzIGZpZWxkLCBpdCBpcyBhdXRvbWF0aWNhbGx5IHVwZGF0ZWRcbiAgICB9XG5cbiAgICBhc3luYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBhd2FpdCBwb3N0VmFsdWVzKHRoaXMucGx1Z2luLCBbeyBuYW1lOiB0aGlzLmZpZWxkLm5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IFwiXCIgfSB9XSwgZmlsZSwgbGluZU51bWJlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KVxuICAgIH1cblxuICAgIGNyZWF0ZUR2RmllbGQoZHY6IGFueSwgcDogYW55LCBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcgfCB1bmRlZmluZWQ7IGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZCB9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICB9XG5cbiAgICBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQge1xuXG4gICAgICAgIC8vaW5pdGlhbCB2YWx1ZXNcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICBvcHRpb25zLmdyb3VwQ29sb3JzID0gKG9wdGlvbnMuZ3JvdXBDb2xvcnMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMuZ3JvdXBMYWJlbHMgPSAob3B0aW9ucy5ncm91cExhYmVscyBhcyBzdHJpbmdbXSB8IHVuZGVmaW5lZCkgfHwgW11cblxuICAgICAgICAvL2xheW91dFxuICAgICAgICBjb25zdCBjYW52YXNQYXRoQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKFwiaHJcIik7XG4gICAgICAgIGNvbnN0IGdyb3VwQ29sb3JzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXIgY29sb3JzXCIgfSk7XG4gICAgICAgIGNvbnN0IGdyb3VwTGFiZWxzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXIgbGFiZWxzXCIgfSk7XG4gICAgICAgIGNvbnN0IG5ld0xhYmVsQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuXG4gICAgICAgIC8vYnVpbGRlcnNcbiAgICAgICAgdGhpcy5jcmVhdGVDYW52YXNQYXRoQ29udGFpbmVyKGNhbnZhc1BhdGhDb250YWluZXIpXG4gICAgICAgIHRoaXMuYnVpbGRDb2xvcnNDb250YWluZXIoZ3JvdXBDb2xvcnNDb250YWluZXIsIG9wdGlvbnMuZ3JvdXBDb2xvcnMsIFwiR3JvdXBzIG1hdGNoaW5nIGNvbG9yczpcIik7XG4gICAgICAgIHRoaXMuYnVpbGRMYWJlbHNDb250YWluZXIoZ3JvdXBMYWJlbHNDb250YWluZXIsIG9wdGlvbnMuZ3JvdXBMYWJlbHMsIFwiR3JvdXBzIG1hdGNoaW5nIGxhYmVsczogXCIpO1xuICAgICAgICB0aGlzLmJ1aWxkTmV3TGFiZWxDb250YWluZXIoZ3JvdXBMYWJlbHNDb250YWluZXIsIFwiR3JvdXBzIG1hdGNoaW5nIGxhYmVsczogXCIsIG5ld0xhYmVsQ29udGFpbmVyLCBvcHRpb25zLmdyb3VwTGFiZWxzLCBcIkFkZCBhIG5ldyBtYXRjaGluZyBncm91cCBuYW1lXCIpXG4gICAgfVxuXG4gICAgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2U7XG4gICAgICAgIGlmICghKHRoaXMuZmllbGQub3B0aW9ucy5jYW52YXNQYXRoIGFzIHN0cmluZyk/LmVuZHNXaXRoKFwiLmNhbnZhc1wiKSkge1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc1BhdGhJbnB1dCxcbiAgICAgICAgICAgICAgICBcIlRoaXMgaXMgbm90IGEgY2FudmFzIGZpbGVcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIWVycm9yXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IFRGaWxlLCBNZW51LCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCB7IHBvc3RWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIlxuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIlxuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCJcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIlxuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCJcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIlxuaW1wb3J0IHsgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiXG5pbXBvcnQgQWJzdHJhY3RDYW52YXNCYXNlZEZpZWxkIGZyb20gXCIuL0Fic3RyYWN0Q2FudmFzQmFzZWRGaWVsZFwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhc0dyb3VwTGlua0ZpZWxkIGV4dGVuZHMgQWJzdHJhY3RDYW52YXNCYXNlZEZpZWxkIHtcblxuICAgIGNhbnZhc1BhdGhJbnB1dDogVGV4dENvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLkNhbnZhc0dyb3VwTGluaylcbiAgICB9XG5cbiAgICBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICAvL25vIGZpZWxkIG9wdGlvbiB0byBhZGQgZm9yIHRoaXMgZmllbGQsIGl0IGlzIGF1dG9tYXRpY2FsbHkgdXBkYXRlZFxuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIFt7IG5hbWU6IHRoaXMuZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogXCJcIiB9IH1dLCBmaWxlLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgfVxuXG4gICAgY3JlYXRlRHZGaWVsZChkdjogYW55LCBwOiBhbnksIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkIH0pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycyk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgIH1cblxuICAgIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG5cbiAgICAgICAgLy9vcHRpb25zXG4gICAgICAgIC8vaW5pdCB2YWx1ZXNcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICBvcHRpb25zLmdyb3VwQ29sb3JzID0gKG9wdGlvbnMuZ3JvdXBDb2xvcnMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMubm9kZUNvbG9ycyA9IChvcHRpb25zLm5vZGVDb2xvcnMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMuZWRnZUNvbG9ycyA9IChvcHRpb25zLmVkZ2VDb2xvcnMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMuZWRnZUZyb21TaWRlcyA9IChvcHRpb25zLmVkZ2VGcm9tU2lkZXMgYXMgc3RyaW5nW10gfCB1bmRlZmluZWQpIHx8IFtdXG4gICAgICAgIG9wdGlvbnMuZWRnZVRvU2lkZXMgPSAob3B0aW9ucy5lZGdlVG9TaWRlcyBhcyBzdHJpbmdbXSB8IHVuZGVmaW5lZCkgfHwgW11cbiAgICAgICAgb3B0aW9ucy5ncm91cExhYmVscyA9IChvcHRpb25zLmdyb3VwTGFiZWxzIGFzIHN0cmluZ1tdIHwgdW5kZWZpbmVkKSB8fCBbXVxuICAgICAgICBvcHRpb25zLmVkZ2VMYWJlbHMgPSAob3B0aW9ucy5lZGdlTGFiZWxzIGFzIHN0cmluZ1tdIHwgdW5kZWZpbmVkKSB8fCBbXVxuICAgICAgICBvcHRpb25zLmRpcmVjdGlvbiA9IChvcHRpb25zLmRpcmVjdGlvbiBhcyBcImluY29taW5nXCIgfCBcIm91dGdvaW5nXCIgfCBcImJvdGhzaWRlc1wiKSB8fCBcImJvdGhzaWRlc1wiXG5cbiAgICAgICAgLy9jb250YWluZXJzIGxheW91dFxuICAgICAgICBjb25zdCBjYW52YXNQYXRoQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgY29uc3QgZ3JvdXBDb2xvcnNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lciBjb2xvcnNcIiB9KTtcbiAgICAgICAgY29uc3QgZ3JvdXBMYWJlbHNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lciBsYWJlbHNcIiB9KTtcbiAgICAgICAgY29uc3QgbmV3R3JvdXBMYWJlbENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKFwiaHJcIik7XG4gICAgICAgIGNvbnN0IGRpcmVjdGlvbkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGNvbnN0IGVkZ2VDb2xvcnNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lciBjb2xvcnNcIiB9KTtcbiAgICAgICAgY29uc3QgZWRnZUZyb21TaWRlc0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyIGVkZ2VzXCIgfSk7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3ViLXRleHRcIiwgdGV4dDogXCJObyBlZGdlIHNlbGVjdGVkIGlzIGVxdWl2YWxlbnQgdG8gYWxsIGVkZ2VzIHNlbGVjdGVkXCIgfSlcbiAgICAgICAgY29uc3QgZWRnZVRvU2lkZXNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lciBlZ2Rlc1wiIH0pXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3ViLXRleHRcIiwgdGV4dDogXCJObyBlZGdlIHNlbGVjdGVkIGlzIGVxdWl2YWxlbnQgdG8gYWxsIGVkZ2VzIHNlbGVjdGVkXCIgfSlcbiAgICAgICAgY29uc3QgZWRnZUxhYmVsc0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyIGxhYmVsc1wiIH0pO1xuICAgICAgICBjb25zdCBuZXdFZGdlTGFiZWxDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbChcImhyXCIpO1xuICAgICAgICBjb25zdCBub2RlQ29sb3JzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXIgY29sb3JzXCIgfSk7XG4gICAgICAgIGNvbnN0IGZpbGVzRnJvbURWUXVlcnlUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG5cbiAgICAgICAgLy9idWlsZGVyc1xuICAgICAgICBjb25zdCBncm91cExhYmVsc1RpdGxlID0gXCJHcm91cHMgbWF0Y2hpbmcgbGFiZWxzOiBcIlxuICAgICAgICBjb25zdCBlZGdlTGFiZWxzVGl0bGUgPSBcIkVkZ2VzIG1hdGNoaW5nIGxhYmVsczogXCJcblxuICAgICAgICB0aGlzLmNyZWF0ZUNhbnZhc1BhdGhDb250YWluZXIoY2FudmFzUGF0aENvbnRhaW5lcilcbiAgICAgICAgdGhpcy5jcmVhdGVEaXJlY3Rpb25Db250YWluZXIoZGlyZWN0aW9uQ29udGFpbmVyLCBgRGlyZWN0aW9uIG9mIHRoZSBlZGdlcyBwb2ludGluZyB0byB0aG9zZSBncm91cHNgKVxuICAgICAgICB0aGlzLmNyZWF0ZUR2UXVlcnlDb250YWluZXIoZmlsZXNGcm9tRFZRdWVyeVRvcENvbnRhaW5lciwgXCJNYXRjaGluZyBmaWxlcyBjb25uZWN0ZWQgdG8gdGhvc2UgZ3JvdXBzXCIpXG4gICAgICAgIHRoaXMuYnVpbGRDb2xvcnNDb250YWluZXIoZ3JvdXBDb2xvcnNDb250YWluZXIsIG9wdGlvbnMuZ3JvdXBDb2xvcnMsIFwiR3JvdXBzIG1hdGNoaW5nIGNvbG9yczpcIik7XG4gICAgICAgIHRoaXMuYnVpbGRDb2xvcnNDb250YWluZXIobm9kZUNvbG9yc0NvbnRhaW5lciwgb3B0aW9ucy5ub2RlQ29sb3JzLCBcIkdyb3VwcycgY29ubmVjdGVkIG5vZGVzIG1hdGNoaW5nIGNvbG9yczpcIik7XG4gICAgICAgIHRoaXMuYnVpbGRDb2xvcnNDb250YWluZXIoZWRnZUNvbG9yc0NvbnRhaW5lciwgb3B0aW9ucy5lZGdlQ29sb3JzLCBcIkdyb3VwcycgZWRnZXMgbWF0Y2hpbmcgY29sb3JzOlwiKVxuICAgICAgICB0aGlzLmJ1aWxkTGFiZWxzQ29udGFpbmVyKGdyb3VwTGFiZWxzQ29udGFpbmVyLCBvcHRpb25zLmdyb3VwTGFiZWxzLCBncm91cExhYmVsc1RpdGxlKTtcbiAgICAgICAgdGhpcy5idWlsZExhYmVsc0NvbnRhaW5lcihlZGdlTGFiZWxzQ29udGFpbmVyLCBvcHRpb25zLmVkZ2VMYWJlbHMsIGVkZ2VMYWJlbHNUaXRsZSk7XG4gICAgICAgIHRoaXMuYnVpbGRFZGdlU2lkZUNvbnRhaW5lcihlZGdlRnJvbVNpZGVzQ29udGFpbmVyLCBvcHRpb25zLmVkZ2VGcm9tU2lkZXMsIFwiR3JvdXBzJyBlZGdlcyBtYXRjaGluIEZyb20gc2lkZTpcIilcbiAgICAgICAgdGhpcy5idWlsZEVkZ2VTaWRlQ29udGFpbmVyKGVkZ2VUb1NpZGVzQ29udGFpbmVyLCBvcHRpb25zLmVkZ2VUb1NpZGVzLCBcIkdyb3VwcycgZWRnZXMgbWF0Y2hpbiBUbyBzaWRlOlwiKVxuICAgICAgICB0aGlzLmJ1aWxkTmV3TGFiZWxDb250YWluZXIoZ3JvdXBMYWJlbHNDb250YWluZXIsIGdyb3VwTGFiZWxzVGl0bGUsIG5ld0dyb3VwTGFiZWxDb250YWluZXIsIG9wdGlvbnMuZ3JvdXBMYWJlbHMsIFwiQWRkIGEgbmV3IG1hdGNoaW5nIGdyb3VwIG5hbWVcIilcbiAgICAgICAgdGhpcy5idWlsZE5ld0xhYmVsQ29udGFpbmVyKGVkZ2VMYWJlbHNDb250YWluZXIsIGVkZ2VMYWJlbHNUaXRsZSwgbmV3RWRnZUxhYmVsQ29udGFpbmVyLCBvcHRpb25zLmVkZ2VMYWJlbHMsIFwiQWRkIGEgbmV3IG1hdGNoaW5nIGVkZ2UgbGFiZWxcIilcbiAgICB9XG5cbiAgICBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBcIlwiXG4gICAgfVxuXG4gICAgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgaWYgKCEodGhpcy5maWVsZC5vcHRpb25zLmNhbnZhc1BhdGggYXMgc3RyaW5nKT8uZW5kc1dpdGgoXCIuY2FudmFzXCIpKSB7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzUGF0aElucHV0LFxuICAgICAgICAgICAgICAgIFwiVGhpcyBpcyBub3QgYSBjYW52YXMgZmlsZVwiXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhZXJyb3JcbiAgICB9XG59IiwgImltcG9ydCBJbnB1dCBmcm9tICcuL0lucHV0RmllbGQnXG5pbXBvcnQgQm9vbGVhbiBmcm9tICcuL0Jvb2xlYW5GaWVsZCdcbmltcG9ydCBOdW1iZXIgZnJvbSAnLi9OdW1iZXJGaWVsZCdcbmltcG9ydCBTZWxlY3QgZnJvbSAnLi9TZWxlY3RGaWVsZCdcbmltcG9ydCBDeWNsZSBmcm9tICcuL0N5Y2xlRmllbGQnXG5pbXBvcnQgTXVsdGkgZnJvbSAnLi9NdWx0aUZpZWxkJ1xuaW1wb3J0IEZpbGUgZnJvbSAnLi9GaWxlRmllbGQnXG5pbXBvcnQgRGF0ZSBmcm9tICcuL0RhdGVGaWVsZCdcbmltcG9ydCBNdWx0aUZpbGUgZnJvbSAnLi9NdWx0aUZpbGVGaWVsZCdcbmltcG9ydCBMb29rdXAgZnJvbSAnLi9Mb29rdXBGaWVsZCdcbmltcG9ydCBGb3JtdWxhIGZyb20gJy4vRm9ybXVsYUZpZWxkJ1xuaW1wb3J0IENhbnZhcyBmcm9tICcuL0NhbnZhc0ZpZWxkJ1xuaW1wb3J0IENhbnZhc0dyb3VwIGZyb20gJy4vQ2FudmFzR3JvdXBGaWVsZCdcbmltcG9ydCBDYW52YXNHcm91cExpbmsgZnJvbSAnLi9DYW52YXNHcm91cExpbmtGaWVsZCdcblxuY29uc3QgTWFuYWdlcnMgPSB7XG4gICAgSW5wdXQsXG4gICAgQm9vbGVhbixcbiAgICBOdW1iZXIsXG4gICAgU2VsZWN0LFxuICAgIEN5Y2xlLFxuICAgIE11bHRpLFxuICAgIEZpbGUsXG4gICAgRGF0ZSxcbiAgICBNdWx0aUZpbGUsXG4gICAgTG9va3VwLFxuICAgIEZvcm11bGEsXG4gICAgQ2FudmFzLFxuICAgIENhbnZhc0dyb3VwLFxuICAgIENhbnZhc0dyb3VwTGlua1xufVxuXG5leHBvcnQgZGVmYXVsdCBNYW5hZ2VycyIsICJpbXBvcnQgTWFuYWdlcnMgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vyc1wiO1xuXG5leHBvcnQgY29uc3QgZW51bSBGaWVsZFR5cGUge1xuICAgICdJbnB1dCcgPSBcIklucHV0XCIsXG4gICAgJ1NlbGVjdCcgPSBcIlNlbGVjdFwiLFxuICAgICdNdWx0aScgPSBcIk11bHRpXCIsXG4gICAgJ0N5Y2xlJyA9IFwiQ3ljbGVcIixcbiAgICAnQm9vbGVhbicgPSBcIkJvb2xlYW5cIixcbiAgICBcIk51bWJlclwiID0gXCJOdW1iZXJcIixcbiAgICBcIkZpbGVcIiA9IFwiRmlsZVwiLFxuICAgIFwiTXVsdGlGaWxlXCIgPSBcIk11bHRpRmlsZVwiLFxuICAgIFwiRGF0ZVwiID0gXCJEYXRlXCIsXG4gICAgXCJMb29rdXBcIiA9IFwiTG9va3VwXCIsXG4gICAgXCJGb3JtdWxhXCIgPSBcIkZvcm11bGFcIixcbiAgICBcIkNhbnZhc1wiID0gXCJDYW52YXNcIixcbiAgICBcIkNhbnZhc0dyb3VwXCIgPSBcIkNhbnZhc0dyb3VwXCIsXG4gICAgXCJDYW52YXNHcm91cExpbmtcIiA9IFwiQ2FudmFzR3JvdXBMaW5rXCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZUxhYmVsTWFwcGluZzogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIEZpZWxkVHlwZT4gPSB7XG4gICAgXCJJbnB1dFwiOiBGaWVsZFR5cGUuSW5wdXQsXG4gICAgXCJTZWxlY3RcIjogRmllbGRUeXBlLlNlbGVjdCxcbiAgICBcIk11bHRpXCI6IEZpZWxkVHlwZS5NdWx0aSxcbiAgICBcIkN5Y2xlXCI6IEZpZWxkVHlwZS5DeWNsZSxcbiAgICBcIkJvb2xlYW5cIjogRmllbGRUeXBlLkJvb2xlYW4sXG4gICAgXCJOdW1iZXJcIjogRmllbGRUeXBlLk51bWJlcixcbiAgICBcIkZpbGVcIjogRmllbGRUeXBlLkZpbGUsXG4gICAgXCJNdWx0aUZpbGVcIjogRmllbGRUeXBlLk11bHRpRmlsZSxcbiAgICBcIkRhdGVcIjogRmllbGRUeXBlLkRhdGUsXG4gICAgXCJMb29rdXBcIjogRmllbGRUeXBlLkxvb2t1cCxcbiAgICBcIkZvcm11bGFcIjogRmllbGRUeXBlLkZvcm11bGEsXG4gICAgXCJDYW52YXNcIjogRmllbGRUeXBlLkNhbnZhcyxcbiAgICBcIkNhbnZhc0dyb3VwXCI6IEZpZWxkVHlwZS5DYW52YXNHcm91cCxcbiAgICBcIkNhbnZhc0dyb3VwTGlua1wiOiBGaWVsZFR5cGUuQ2FudmFzR3JvdXBMaW5rXG59O1xuXG5leHBvcnQgY29uc3QgRmllbGRUeXBlVGFnQ2xhc3M6IFJlY29yZDxrZXlvZiB0eXBlb2YgRmllbGRUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiSW5wdXRcIjogXCJzaW5nbGVcIixcbiAgICBcIlNlbGVjdFwiOiBcInNlbGVjdFwiLFxuICAgIFwiTXVsdGlcIjogXCJtdWx0aVwiLFxuICAgIFwiQ3ljbGVcIjogXCJjeWNsZVwiLFxuICAgIFwiQm9vbGVhblwiOiBcImJvb2xlYW5cIixcbiAgICBcIk51bWJlclwiOiBcIm51bWJlclwiLFxuICAgIFwiRmlsZVwiOiBcImZpbGVcIixcbiAgICBcIk11bHRpRmlsZVwiOiBcImZpbGVcIixcbiAgICBcIkRhdGVcIjogXCJkYXRlXCIsXG4gICAgXCJMb29rdXBcIjogXCJsb29rdXBcIixcbiAgICBcIkZvcm11bGFcIjogXCJmb3JtdWxhXCIsXG4gICAgXCJDYW52YXNcIjogXCJjYW52YXMtbGlua3NcIixcbiAgICBcIkNhbnZhc0dyb3VwXCI6IFwiY2FudmFzLWxpbmtzXCIsXG4gICAgXCJDYW52YXNHcm91cExpbmtcIjogXCJjYW52YXMtbGlua3NcIlxufVxuXG5leHBvcnQgY29uc3QgRmllbGRUeXBlVG9vbHRpcDogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJJbnB1dFwiOiBcIkFjY2VwdCBhbnkgdmFsdWVcIixcbiAgICBcIlNlbGVjdFwiOiBcIkFjY2VwdCBhIHNpbmdsZSB2YWx1ZSBmcm9tIGEgbGlzdFwiLFxuICAgIFwiTXVsdGlcIjogXCJBY2NlcHQgbXVsdGlwbGUgdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJDeWNsZVwiOiBcIkN5Y2xlIHRocm91Z2ggdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJCb29sZWFuXCI6IFwiQWNjZXB0IHRydWUgb2YgZmFsc2VcIixcbiAgICBcIk51bWJlclwiOiBcIkFjY2VwdCBhIG51bWJlclwiLFxuICAgIFwiRmlsZVwiOiBcIkFjY2VwdCBhIGxpbmtcIixcbiAgICBcIk11bHRpRmlsZVwiOiBcIkFjY2VwdCBtdWx0aXBsZSBsaW5rc1wiLFxuICAgIFwiRGF0ZVwiOiBcIkFjY2VwdCBhIGRhdGVcIixcbiAgICBcIkxvb2t1cFwiOiBcIkFjY2VwdCBhIGxvb2t1cCBxdWVyeVwiLFxuICAgIFwiRm9ybXVsYVwiOiBcIkFjY2VwdCBhIGZvcm11bGFcIixcbiAgICBcIkNhbnZhc1wiOiBcIlVwZGF0ZXMgd2l0aCBsaW5rcyBpbiBjYW52YXNcIixcbiAgICBcIkNhbnZhc0dyb3VwXCI6IFwiVXBkYXRlcyB3aXRoIGdyb3VwcyBpbiBjYW52YXNcIixcbiAgICBcIkNhbnZhc0dyb3VwTGlua1wiOiBcIlVwZGF0ZXMgd2l0aCBsaW5rcyB0byBncm91cHMgaW4gY2FudmFzXCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkTWFuYWdlcjogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIGFueT4gPSB7XG4gICAgXCJJbnB1dFwiOiBNYW5hZ2Vycy5JbnB1dCxcbiAgICBcIlNlbGVjdFwiOiBNYW5hZ2Vycy5TZWxlY3QsXG4gICAgXCJNdWx0aVwiOiBNYW5hZ2Vycy5NdWx0aSxcbiAgICBcIkN5Y2xlXCI6IE1hbmFnZXJzLkN5Y2xlLFxuICAgIFwiQm9vbGVhblwiOiBNYW5hZ2Vycy5Cb29sZWFuLFxuICAgIFwiTnVtYmVyXCI6IE1hbmFnZXJzLk51bWJlcixcbiAgICBcIkZpbGVcIjogTWFuYWdlcnMuRmlsZSxcbiAgICBcIk11bHRpRmlsZVwiOiBNYW5hZ2Vycy5NdWx0aUZpbGUsXG4gICAgXCJEYXRlXCI6IE1hbmFnZXJzLkRhdGUsXG4gICAgXCJMb29rdXBcIjogTWFuYWdlcnMuTG9va3VwLFxuICAgIFwiRm9ybXVsYVwiOiBNYW5hZ2Vycy5Gb3JtdWxhLFxuICAgIFwiQ2FudmFzXCI6IE1hbmFnZXJzLkNhbnZhcyxcbiAgICBcIkNhbnZhc0dyb3VwXCI6IE1hbmFnZXJzLkNhbnZhc0dyb3VwLFxuICAgIFwiQ2FudmFzR3JvdXBMaW5rXCI6IE1hbmFnZXJzLkNhbnZhc0dyb3VwTGlua1xufVxuXG5leHBvcnQgY29uc3QgRmllbGRJY29uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIklucHV0XCI6IFwicGVuY2lsXCIsXG4gICAgXCJTZWxlY3RcIjogXCJyaWdodC10cmlhbmdsZVwiLFxuICAgIFwiTXVsdGlcIjogXCJidWxsZXQtbGlzdFwiLFxuICAgIFwiQ3ljbGVcIjogXCJzd2l0Y2hcIixcbiAgICBcIkJvb2xlYW5cIjogXCJjaGVja21hcmtcIixcbiAgICBcIk51bWJlclwiOiBcInBsdXMtbWludXMtZ2x5cGhcIixcbiAgICBcIkZpbGVcIjogXCJsaW5rXCIsXG4gICAgXCJNdWx0aUZpbGVcIjogXCJsaW5rXCIsXG4gICAgXCJEYXRlXCI6IFwiY2FsZW5kYXItd2l0aC1jaGVja21hcmtcIixcbiAgICBcIkxvb2t1cFwiOiBcImZpbGUtc2VhcmNoXCIsXG4gICAgXCJGb3JtdWxhXCI6IFwiZnVuY3Rpb24tc3F1YXJlXCIsXG4gICAgXCJDYW52YXNcIjogXCJsYXlvdXQtZGFzaGJvYXJkXCIsXG4gICAgXCJDYW52YXNHcm91cFwiOiBcImJveC1zZWxlY3RcIixcbiAgICBcIkNhbnZhc0dyb3VwTGlua1wiOiBcImJveC1zZWxlY3RcIlxufVxuXG5leHBvcnQgY29uc3QgRmllbGRCYWNrZ3JvdW5kQ29sb3JDbGFzczogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJJbnB1dFwiOiBcInNpbmdsZVwiLFxuICAgIFwiU2VsZWN0XCI6IFwic2VsZWN0XCIsXG4gICAgXCJNdWx0aVwiOiBcIm11bHRpXCIsXG4gICAgXCJDeWNsZVwiOiBcImN5Y2xlXCIsXG4gICAgXCJCb29sZWFuXCI6IFwiYm9vbGVhblwiLFxuICAgIFwiTnVtYmVyXCI6IFwibnVtYmVyXCIsXG4gICAgXCJGaWxlXCI6IFwiZmlsZVwiLFxuICAgIFwiTXVsdGlGaWxlXCI6IFwiZmlsZVwiLFxuICAgIFwiRGF0ZVwiOiBcImRhdGVcIixcbiAgICBcIkxvb2t1cFwiOiBcImxvb2t1cFwiLFxuICAgIFwiRm9ybXVsYVwiOiBcImxvb2t1cFwiLFxuICAgIFwiQ2FudmFzXCI6IFwiZmlsZVwiLFxuICAgIFwiQ2FudmFzR3JvdXBcIjogXCJmaWxlXCIsXG4gICAgXCJDYW52YXNHcm91cExpbmtcIjogXCJmaWxlXCJcbn1cblxuZXhwb3J0IGNvbnN0IG11bHRpVHlwZXMgPSBbXG4gICAgRmllbGRUeXBlLk11bHRpLFxuICAgIEZpZWxkVHlwZS5NdWx0aUZpbGUsXG4gICAgRmllbGRUeXBlLkNhbnZhcyxcbiAgICBGaWVsZFR5cGUuQ2FudmFzR3JvdXAsXG4gICAgRmllbGRUeXBlLkNhbnZhc0dyb3VwTGlua1xuXVxuXG5cbmV4cG9ydCBjb25zdCBSZXNlcnZlZE11bHRpQXR0cmlidXRlcyA9IFtcInRhZ3NcIiwgXCJ0YWdOYW1lc1wiLCBcImV4Y2x1ZGVzXCIsIFwiYWxpYXNlc1wiXVxuXG5leHBvcnQgZW51bSBNdWx0aURpc3BsYXlUeXBlIHtcbiAgICBcImFzQXJyYXlcIiA9ICdhc0FycmF5JyxcbiAgICBcImFzTGlzdFwiID0gXCJhc0xpc3RcIlxufSIsICJpbXBvcnQgeyBURmlsZSwgQnV0dG9uQ29tcG9uZW50LCBTdWdnZXN0TW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuaW50ZXJmYWNlIExpbmUge1xuICAgIGxpbmVOdW1iZXI6IG51bWJlclxuICAgIGxpbmVUZXh0OiBzdHJpbmdcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgY2hvb3NlU2VjdGlvbk1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPExpbmU+IHtcblxuICAgIHByaXZhdGUgYWRkQXNMaXN0SXRlbTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgYWRkQXNDb21tZW50OiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBhZGRBdEVuZE9mRnJvbnRNYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIG9uU2VsZWN0OiAobGluZU51bWJlcjogbnVtYmVyLCBhZnRlcjogYm9vbGVhbiwgYXNMaXN0OiBib29sZWFuLCBhc0NvbW1lbnQ6IGJvb2xlYW4pID0+IHZvaWQsXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3RcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5hZGRDbGFzcyhcInNlY3Rpb25zXCIpXG4gICAgfTtcblxuICAgIG9uT3BlbigpOiB2b2lkIHtcbiAgICAgICAgc3VwZXIub25PcGVuKCk7XG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic3VnZ2VzdGVyLWlucHV0XCIgfSlcbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dEVsKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmZpbmQoXCIucHJvbXB0XCIpLnByZXBlbmQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIC8vIGluc2VydEFzTGlzdEl0ZW1cbiAgICAgICAgY29uc3QgYWRkQXNMaXN0SXRlbUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGFkZEFzTGlzdEl0ZW1CdG4uc2V0SWNvbihcImxpc3RcIilcbiAgICAgICAgYWRkQXNMaXN0SXRlbUJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFkZEFzTGlzdEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBhZGRBc0xpc3RJdGVtQnRuLnJlbW92ZUN0YSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQXNMaXN0SXRlbSA9IGZhbHNlXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFkZEFzTGlzdEl0ZW1CdG4uc2V0Q3RhKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRBc0xpc3RJdGVtID0gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBhZGRBc0xpc3RJdGVtQnRuLnNldERpc2FibGVkKHRoaXMuYWRkQXRFbmRPZkZyb250TWF0dGVyKVxuICAgICAgICBhZGRBc0xpc3RJdGVtQnRuLnNldFRvb2x0aXAoXCJBZGQgdGhpcyBmaWVsZCBhcyBhIGxpc3QgaXRlbVwiKVxuXG4gICAgICAgIC8vIGluc2VydEFzQ29tbWVudEl0ZW1cblxuICAgICAgICBjb25zdCBhZGRBc0NvbW1lbnRJdGVtQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5zZXRJY29uKFwibWVzc2FnZS1zcXVhcmVcIilcbiAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFkZEFzQ29tbWVudCkge1xuICAgICAgICAgICAgICAgIGFkZEFzQ29tbWVudEl0ZW1CdG4ucmVtb3ZlQ3RhKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRBc0NvbW1lbnQgPSBmYWxzZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhZGRBc0NvbW1lbnRJdGVtQnRuLnNldEN0YSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQXNDb21tZW50ID0gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBhZGRBc0NvbW1lbnRJdGVtQnRuLnNldERpc2FibGVkKHRoaXMuYWRkQXRFbmRPZkZyb250TWF0dGVyKVxuICAgICAgICBhZGRBc0NvbW1lbnRJdGVtQnRuLnNldFRvb2x0aXAoXCJBZGQgdGhpcyBmaWVsZCBhcyBhIGNvbW1lbnQgaXRlbVwiKVxuXG5cbiAgICAgICAgLy8gaW5zZXJ0QXNDb21tZW50SXRlbVxuXG4gICAgICAgIGNvbnN0IGFkZEF0RW5kT2ZGcm9udE1hdHRlckJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGFkZEF0RW5kT2ZGcm9udE1hdHRlckJ0bi5zZXRJY29uKFwibGlzdC1lbmRcIilcbiAgICAgICAgYWRkQXRFbmRPZkZyb250TWF0dGVyQnRuLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vblNlbGVjdCgtMSwgZmFsc2UsIGZhbHNlLCBmYWxzZSlcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgYWRkQXRFbmRPZkZyb250TWF0dGVyQnRuLnNldFRvb2x0aXAoXCJBZGQgdGhpcyBmaWVsZCBhdCB0aGUgZW5kIG9mIHRoZSBmcm9udG1hdHRlclwiKVxuICAgIH1cblxuICAgIGFzeW5jIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPExpbmVbXT4ge1xuICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKVxuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogTGluZVtdID0gW3tcbiAgICAgICAgICAgIGxpbmVOdW1iZXI6IC0xLFxuICAgICAgICAgICAgbGluZVRleHQ6IFwiLS0tLS0tLS0tLUFkZCBvbiB0b3Agb2YgdGhlIGZpbGUtLS0tLS0tLVwiXG4gICAgICAgIH1dXG4gICAgICAgIGNvbnRlbnQuc3BsaXQoXCJcXG5cIilcbiAgICAgICAgICAgIC5mb3JFYWNoKChsaW5lQ29udGVudCwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lQ29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVUZXh0OiBsaW5lQ29udGVudC5zdWJzdHJpbmcoMCwgNTcpICsgKGxpbmVDb250ZW50Lmxlbmd0aCA8IDU3ID8gXCJcIiA6IFwiLi4uXCIpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogTGluZSwgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLmFkZENsYXNzKFwiaXRlbVwiKVxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibGluZVwiIH0pO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogYCR7dmFsdWUubGluZU51bWJlciArIDF9YCwgY2xzOiBcImxpbmVOdW1iZXJcIiB9KTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHZhbHVlLmxpbmVUZXh0LCBjbHM6IFwibGluZVRleHRcIiB9KTtcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogTGluZSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBjb25zdCBhZnRlciA9IGl0ZW0ubGluZU51bWJlciA9PSAtMSA/IGZhbHNlIDogdHJ1ZTtcbiAgICAgICAgdGhpcy5vblNlbGVjdChpdGVtLmxpbmVOdW1iZXIgPT0gLTEgPyAwIDogaXRlbS5saW5lTnVtYmVyLFxuICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICB0aGlzLmFkZEFzTGlzdEl0ZW0sXG4gICAgICAgICAgICB0aGlzLmFkZEFzQ29tbWVudClcbiAgICB9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCB7IGdldEZpbGVGcm9tRmlsZU9yUGF0aCB9IGZyb20gXCJzcmMvdXRpbHMvZmlsZVV0aWxzXCI7XG5pbXBvcnQgeyBGaWVsZHNQYXlsb2FkLCBwb3N0VmFsdWVzIH0gZnJvbSBcIi4vcG9zdFZhbHVlc1wiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5zZXJ0TWlzc2luZ0ZpZWxkcyhcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlT3JGaWxlUGF0aDogc3RyaW5nIHwgVEZpbGUsXG4gICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2UsXG4gICAgZmlsZUNsYXNzTmFtZT86IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZmlsZSA9IGdldEZpbGVGcm9tRmlsZU9yUGF0aChwbHVnaW4sIGZpbGVPckZpbGVQYXRoKVxuICAgIGNvbnN0IGR2QXBpID0gcGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgIGlmIChkdkFwaSkge1xuICAgICAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgICAgIGNvbnN0IHRtID0gcGx1Z2luLmZpbGVUYXNrTWFuYWdlcjtcbiAgICAgICAgY29uc3QgZmllbGRzID0gZi5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKVxuICAgICAgICBjb25zdCBjdXJyZW50RmllbGRzTmFtZXMgPSBnZW51aW5lS2V5cyhkdkFwaS5wYWdlKGZpbGUucGF0aCkpXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkQ2xhc3NGaWVsZHMgPSBmaWxlQ2xhc3NOYW1lID8gcGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVDbGFzc05hbWUpPy5maWx0ZXIoZmllbGQgPT4gZmllbGQuZmlsZUNsYXNzTmFtZSA9PT0gZmlsZUNsYXNzTmFtZSkgfHwgdW5kZWZpbmVkIDogdW5kZWZpbmVkXG4gICAgICAgIGNvbnN0IGZpZWxkc1RvSW5zZXJ0OiBGaWVsZHNQYXlsb2FkID0gW11cbiAgICAgICAgZmllbGRzPy5maWx0ZXIoZmllbGQgPT4gIWN1cnJlbnRGaWVsZHNOYW1lcy5pbmNsdWRlcyhmaWVsZC5uYW1lKSlcbiAgICAgICAgICAgIC5maWx0ZXIoZmllbGQgPT4gZmlsdGVyZWRDbGFzc0ZpZWxkcyA/IGZpbHRlcmVkQ2xhc3NGaWVsZHMubWFwKGYgPT4gZi5uYW1lKS5pbmNsdWRlcyhmaWVsZC5uYW1lKSA6IHRydWUpXG4gICAgICAgICAgICAuZm9yRWFjaChhc3luYyBmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgZmllbGRzVG9JbnNlcnQucHVzaCh7IG5hbWU6IGZpZWxkLm5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IFwiXCIgfSB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgaWYgKGZpZWxkc1RvSW5zZXJ0Lmxlbmd0aCkgYXdhaXQgcG9zdFZhbHVlcyhwbHVnaW4sIGZpZWxkc1RvSW5zZXJ0LCBmaWxlLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NWaWV3LCBGSUxFQ0xBU1NfVklFV19UWVBFIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzVmlld1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcIi4uL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCB7IEZpbGVDbGFzc0Nob2ljZU1vZGFsIH0gZnJvbSBcIi4uL2ZpbGVDbGFzcy9maWxlQ2xhc3NDaG9pY2VNb2RhbFwiO1xuXG5leHBvcnQgY2xhc3MgRmlsZUNsYXNzTWFuYWdlciBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgcHVibGljIGZpbGVDbGFzc1ZpZXc6IEZpbGVDbGFzc1ZpZXc7XG4gICAgcHVibGljIGZpbGVDbGFzc1ZpZXdUeXBlOiBzdHJpbmc7XG4gICAgcHVibGljIG5hbWU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3NcbiAgICApIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKCF0aGlzLmZpbGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NWaWV3VHlwZSA9IEZJTEVDTEFTU19WSUVXX1RZUEVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzVmlld1R5cGUgPSBGSUxFQ0xBU1NfVklFV19UWVBFICsgXCJfX1wiICsgdGhpcy5maWxlQ2xhc3MubmFtZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIGlmICh0aGlzLmZpbGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5maWxlQ2xhc3MubmFtZTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzVmlld1R5cGUgPSBGSUxFQ0xBU1NfVklFV19UWVBFICsgXCJfX1wiICsgdGhpcy5maWxlQ2xhc3MubmFtZVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5vcGVuRmlsZUNsYXNzVmlldygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdGFnc0FuZEZpbGVDbGFzc2VzID0gdGhpcy5nZXRBY3RpdmVGaWxlVGFnc0FuZEZpbGVDbGFzc2VzKCk7XG4gICAgICAgICAgICBpZiAodGFnc0FuZEZpbGVDbGFzc2VzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleFxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0YWdzQW5kRmlsZUNsYXNzZXNbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gaW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlQ2xhc3NOYW1lKSB8fCBpbmRleC50YWdzTWF0Y2hpbmdGaWxlQ2xhc3Nlcy5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9IGZpbGVDbGFzcy5uYW1lO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IGZpbGVDbGFzcztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NWaWV3VHlwZSA9IEZJTEVDTEFTU19WSUVXX1RZUEUgKyBcIl9fXCIgKyBmaWxlQ2xhc3MubmFtZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9wZW5GaWxlQ2xhc3NWaWV3KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ucmVtb3ZlQ2hpbGQodGhpcylcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxvYWQoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hvaWNlTW9kYWwgPSBuZXcgRmlsZUNsYXNzQ2hvaWNlTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMsIHRhZ3NBbmRGaWxlQ2xhc3NlcylcbiAgICAgICAgICAgICAgICBjaG9pY2VNb2RhbC5vbkNsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5yZW1vdmVDaGlsZCh0aGlzKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxvYWQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNob2ljZU1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9udW5sb2FkKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmRldGFjaExlYXZlc09mVHlwZSh0aGlzLmZpbGVDbGFzc1ZpZXdUeXBlKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmlld1JlZ2lzdHJ5LnVucmVnaXN0ZXJWaWV3KHRoaXMuZmlsZUNsYXNzVmlld1R5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBvcGVuRmlsZUNsYXNzVmlldygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLmZpbGVDbGFzc1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUodGhpcy5maWxlQ2xhc3NWaWV3VHlwZSk7XG5cbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyVmlldyh0aGlzLmZpbGVDbGFzc1ZpZXdUeXBlLFxuICAgICAgICAgICAgICAgIChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc1ZpZXcgPSBuZXcgRmlsZUNsYXNzVmlldyhsZWFmLCB0aGlzLnBsdWdpbiwgdGhpcywgdGhpcy5uYW1lLCBmaWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzVmlldyA9IGZpbGVDbGFzc1ZpZXc7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWxlQ2xhc3NWaWV3XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJywgJ3ZlcnRpY2FsJykuc2V0Vmlld1N0YXRlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0aGlzLmZpbGVDbGFzc1ZpZXdUeXBlLFxuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLnJldmVhbExlYWYoXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUodGhpcy5maWxlQ2xhc3NWaWV3VHlwZSkubGFzdCgpIVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJtZXRhZGF0YS1tZW51OnVwZGF0ZWQtaW5kZXhcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSh0aGlzLmZpbGVDbGFzc1ZpZXdUeXBlKVswXT8udmlldyBhcyBGaWxlQ2xhc3NWaWV3IHwgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy51cGRhdGVGaWVsZHNWaWV3KCk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcudXBkYXRlU2V0dGluZ3NWaWV3KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRBY3RpdmVGaWxlVGFnc0FuZEZpbGVDbGFzc2VzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4XG4gICAgICAgIGNvbnN0IGFjdGl2ZUZpbGVQYXRoID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk/LnBhdGhcbiAgICAgICAgY29uc3QgdGFnc0FuZEZpbGVDbGFzc2VzID0gW11cbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGFjdGl2ZUZpbGVQYXRoICYmIGFjdGl2ZUZpbGVQYXRoLmVuZHNXaXRoKFwiLm1kXCIpICYmIGR2QXBpKSB7XG4gICAgICAgICAgICB0YWdzQW5kRmlsZUNsYXNzZXMucHVzaCguLi4oZHZBcGkucGFnZShhY3RpdmVGaWxlUGF0aCkuZXRhZ3M/LmZpbHRlcigodGFnOiBzdHJpbmcpID0+IFsuLi5pbmRleC50YWdzTWF0Y2hpbmdGaWxlQ2xhc3Nlcy5rZXlzKCldLmluY2x1ZGVzKHRhZykpIHx8IFtdKSlcbiAgICAgICAgICAgIHRhZ3NBbmRGaWxlQ2xhc3Nlcy5wdXNoKC4uLihpbmRleC5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGFjdGl2ZUZpbGVQYXRoKSB8fCBbXSkpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFsuLi5uZXcgU2V0KHRhZ3NBbmRGaWxlQ2xhc3NlcyldXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWxlVmlldywgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpbGVDbGFzc01hbmFnZXIgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvZmlsZUNsYXNzTWFuYWdlclwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcIi4vZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NGaWVsZHNWaWV3IH0gZnJvbSBcIi4vZmlsZUNsYXNzRmllbGRzVmlld1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzU2V0dGluZ3NWaWV3IH0gZnJvbSBcIi4vZmlsZUNsYXNzU2V0dGluZ3NWaWV3XCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NUYWJsZVZpZXcgfSBmcm9tIFwiLi9maWxlQ2xhc3NUYWJsZVZpZXdcIjtcblxuZXhwb3J0IGNvbnN0IEZJTEVDTEFTU19WSUVXX1RZUEUgPSBcIkZpbGVDbGFzc1ZpZXdcIlxuXG5cbmNsYXNzIE1lbnVPcHRpb24ge1xuXG4gICAgcHJpdmF0ZSBpdGVtQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudFxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgbWVudTogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHB1YmxpYyBpZDogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIG5hbWU6IHN0cmluZyxcbiAgICAgICAgcHVibGljIHJlbGF0ZWRWaWV3OiBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSB2aWV3OiBGaWxlQ2xhc3NWaWV3LFxuICAgICkge1xuICAgICAgICB0aGlzLml0ZW1Db250YWluZXIgPSB0aGlzLm1lbnUuY3JlYXRlRGl2KHsgY2xzOiBcImZ2LW1lbnUtaXRlbVwiLCBhdHRyOiB7IGlkOiB0aGlzLmlkIH0gfSlcbiAgICAgICAgdGhpcy5pdGVtQ29udGFpbmVyLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiB0aGlzLm5hbWUgfSlcbiAgICAgICAgdGhpcy5pdGVtQ29udGFpbmVyLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnZpZXcudXBkYXRlRGlzcGxheVZpZXcodGhpcy5pZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b2dnbGVJbmFjdGl2ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pdGVtQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICB0aGlzLnJlbGF0ZWRWaWV3LmhpZGUoKTtcbiAgICB9XG5cbiAgICB0b2dnbGVBY3RpdmUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaXRlbUNvbnRhaW5lci5hZGRDbGFzcyhcImFjdGl2ZVwiKVxuICAgICAgICB0aGlzLnJlbGF0ZWRWaWV3LnNob3coKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGaWxlQ2xhc3NWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuXG4gICAgcHJpdmF0ZSBtZW51OiBIVE1MRGl2RWxlbWVudFxuICAgIHByaXZhdGUgbWVudU9wdGlvbnM6IE1lbnVPcHRpb25bXSA9IFtdXG4gICAgcHJpdmF0ZSB2aWV3Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudFxuICAgIHByaXZhdGUgdmlld3M6IEhUTUxEaXZFbGVtZW50W10gPSBbXVxuICAgIHByaXZhdGUgc2V0dGluZ3NWaWV3OiBGaWxlQ2xhc3NTZXR0aW5nc1ZpZXdcbiAgICBwdWJsaWMgdGFibGVWaWV3OiBGaWxlQ2xhc3NUYWJsZVZpZXdcbiAgICBwcml2YXRlIGZpZWxkc1ZpZXc6IEZpbGVDbGFzc0ZpZWxkc1ZpZXdcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgbGVhZjogV29ya3NwYWNlTGVhZixcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBjb21wb25lbnQ6IEZpbGVDbGFzc01hbmFnZXIsXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3M6IEZpbGVDbGFzc1xuICAgICkge1xuICAgICAgICBzdXBlcihsZWFmKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwiZmlsZWNsYXNzLXZpZXdcIilcbiAgICAgICAgdGhpcy5jb250ZW50RWwuYWRkQ2xhc3MoXCJmaWxlY2xhc3Mtdmlldy1jb250ZW50XCIpXG4gICAgICAgIHRoaXMubmF2aWdhdGlvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmljb24gPSBcImZpbGUtc3ByZWFkc2hlZXRcIlxuICAgICAgICB0aGlzLm9udW5sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmlld1JlZ2lzdHJ5LnVucmVnaXN0ZXJWaWV3KEZJTEVDTEFTU19WSUVXX1RZUEUgKyBcIl9fXCIgKyB0aGlzLmZpbGVDbGFzcy5uYW1lKTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlbW92ZUNoaWxkKHRoaXMuY29tcG9uZW50KVxuICAgICAgICAgICAgdGhpcy51bmxvYWQoKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuYnVpbGRMYXlvdXQoKTtcbiAgICB9XG5cbiAgICB1cGRhdGVEaXNwbGF5VmlldyhpZDogc3RyaW5nKSB7XG4gICAgICAgIChbLi4udGhpcy52aWV3Q29udGFpbmVyLmNoaWxkcmVuXSBhcyBIVE1MRGl2RWxlbWVudFtdKS5mb3JFYWNoKHZpZXcgPT4gdmlldy5oaWRlKCkpO1xuICAgICAgICB0aGlzLm1lbnVPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IG9wdGlvbi5pZCA9PT0gaWQgPyBvcHRpb24udG9nZ2xlQWN0aXZlKCkgOiBvcHRpb24udG9nZ2xlSW5hY3RpdmUoKSlcbiAgICB9XG5cbiAgICBidWlsZExheW91dCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5tZW51ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZ2LW1lbnVcIiB9KTtcbiAgICAgICAgdGhpcy52aWV3Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcInZpZXctY29udGFpbmVyXCIgfSlcbiAgICAgICAgdGhpcy5idWlsZFNldHRpbmdzVmlldygpO1xuICAgICAgICB0aGlzLmJ1aWxkRmllbGRzVmlldygpO1xuICAgICAgICB0aGlzLmJ1aWxkVGFibGVWaWV3KCk7XG4gICAgICAgIHRoaXMuYnVpbGRNZW51KCk7XG4gICAgICAgIHRoaXMudXBkYXRlRGlzcGxheVZpZXcoXCJ0YWJsZU9wdGlvblwiKTtcbiAgICB9XG5cbiAgICBidWlsZE1lbnUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubWVudU9wdGlvbnMucHVzaChuZXcgTWVudU9wdGlvbih0aGlzLm1lbnUsIFwidGFibGVPcHRpb25cIiwgXCJUYWJsZSB2aWV3XCIsIHRoaXMudGFibGVWaWV3LmNvbnRhaW5lciwgdGhpcykpXG4gICAgICAgIHRoaXMubWVudU9wdGlvbnMucHVzaChuZXcgTWVudU9wdGlvbih0aGlzLm1lbnUsIFwiZmllbGRzT3B0aW9uXCIsIFwiRmlsZWNsYXNzIGZpZWxkc1wiLCB0aGlzLmZpZWxkc1ZpZXcuY29udGFpbmVyLCB0aGlzKSlcbiAgICAgICAgdGhpcy5tZW51T3B0aW9ucy5wdXNoKG5ldyBNZW51T3B0aW9uKHRoaXMubWVudSwgXCJzZXR0aW5nc09wdGlvblwiLCBcIkZpbGVjbGFzcyBzZXR0aW5nc1wiLCB0aGlzLnNldHRpbmdzVmlldy5jb250YWluZXIsIHRoaXMpKVxuICAgIH1cblxuICAgIGJ1aWxkU2V0dGluZ3NWaWV3KCk6IHZvaWQge1xuICAgICAgICAvL3RvZG8gY3JlYXRlIHRoZSBzZXR0aW5ncyB2aWV3IGFuZCBtYW5hZ2UgaXQhIVxuICAgICAgICB0aGlzLnNldHRpbmdzVmlldyA9IG5ldyBGaWxlQ2xhc3NTZXR0aW5nc1ZpZXcodGhpcy5wbHVnaW4sIHRoaXMudmlld0NvbnRhaW5lciwgdGhpcy5maWxlQ2xhc3MpXG4gICAgICAgIHRoaXMudmlld3MucHVzaCh0aGlzLnNldHRpbmdzVmlldy5jb250YWluZXIpO1xuICAgIH1cblxuICAgIGJ1aWxkRmllbGRzVmlldygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWVsZHNWaWV3ID0gbmV3IEZpbGVDbGFzc0ZpZWxkc1ZpZXcodGhpcy5wbHVnaW4sIHRoaXMudmlld0NvbnRhaW5lciwgdGhpcy5maWxlQ2xhc3MpXG4gICAgICAgIHRoaXMudmlld3MucHVzaCh0aGlzLmZpZWxkc1ZpZXcuY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBidWlsZFRhYmxlVmlldygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50YWJsZVZpZXcgPSBuZXcgRmlsZUNsYXNzVGFibGVWaWV3KHRoaXMucGx1Z2luLCB0aGlzLmNvbXBvbmVudCwgdGhpcy52aWV3Q29udGFpbmVyLCB0aGlzLmZpbGVDbGFzcylcbiAgICAgICAgdGhpcy52aWV3cy5wdXNoKHRoaXMudGFibGVWaWV3LmNvbnRhaW5lcik7XG4gICAgfVxuXG4gICAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZSB8fCBcIkZpbGVDbGFzc1wiXG4gICAgfVxuXG4gICAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsZUNsYXNzID8gRklMRUNMQVNTX1ZJRVdfVFlQRSArIFwiX19cIiArIHRoaXMuZmlsZUNsYXNzLm5hbWUgOiBGSUxFQ0xBU1NfVklFV19UWVBFXG4gICAgfVxuXG4gICAgdXBkYXRlRmllbGRzVmlldygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MuZ2V0QXR0cmlidXRlcygpXG4gICAgICAgIHRoaXMuZmllbGRzVmlldy5idWlsZFNldHRpbmdzKClcbiAgICB9XG5cbiAgICB1cGRhdGVTZXR0aW5nc1ZpZXcoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3NWaWV3LmJ1aWxkU2V0dGluZ3MoKVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuaWNvbiA9IHRoaXMuZmlsZUNsYXNzPy5nZXRJY29uKCkgfHwgXCJmaWxlLXNwcmVhZHNoZWV0XCJcbiAgICAgICAgdGhpcy50YWJsZVZpZXcuYnVpbGRUYWJsZSgpO1xuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBzZXRJY29uLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZW1vdmVGaWxlQ2xhc3NBdHRyaWJ1dGVXaXRoTmFtZSB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVtb3ZlRmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGVUYWdDbGFzcyB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcIi4vZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwiLi9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0gZnJvbSBcIi4vRmlsZUNsYXNzQXR0cmlidXRlTW9kYWxcIjtcblxuY2xhc3MgRmlsZUNsYXNzRmllbGRTZXR0aW5nIHtcbiAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBmaWxlQ2xhc3M6IEZpbGVDbGFzcyxcbiAgICAgICAgcHVibGljIGZpbGVDbGFzc0F0dHJpYnV0ZTogRmlsZUNsYXNzQXR0cmlidXRlLFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudVxuICAgICkge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5idWlsZFNldHRpbmcoKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBidWlsZFNldHRpbmcoKTogdm9pZCB7XG5cbiAgICAgICAgY29uc3QgZmllbGROYW1lQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm5hbWUtY29udGFpbmVyXCIgfSlcbiAgICAgICAgZmllbGROYW1lQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IHRoaXMuZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIGNsczogXCJ0aXRsZVwiIH0pXG4gICAgICAgIGNvbnN0IHR5cGVDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidHlwZS1jb250YWluZXJcIiB9KVxuICAgICAgICBjb25zdCBjaGlwID0gdHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBjaGlwICR7RmllbGRUeXBlVGFnQ2xhc3NbdGhpcy5maWxlQ2xhc3NBdHRyaWJ1dGUudHlwZV19YCB9KVxuICAgICAgICBjaGlwLnNldFRleHQodGhpcy5maWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSlcbiAgICAgICAgY29uc3QgZmllbGRCdXR0b25zQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImJ1dHRvbnMtY29udGFpbmVyXCIgfSlcbiAgICAgICAgdGhpcy5hZGRFZGl0QnV0dG9uKGZpZWxkQnV0dG9uc0NvbnRhaW5lcilcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oZmllbGRCdXR0b25zQ29udGFpbmVyKTtcbiAgICAgICAgY29uc3QgZmllbGRPcHRpb25zQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9wdGlvbnMtY29udGFpbmVyXCIgfSlcbiAgICAgICAgZmllbGRPcHRpb25zQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IGNsczogXCJkZXNjcmlwdGlvblwiLCB0ZXh0OiBgJHt0aGlzLmZpbGVDbGFzc0F0dHJpYnV0ZS5nZXRPcHRpb25zU3RyaW5nKHRoaXMucGx1Z2luKX1gIH0pXG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRWRpdEJ1dHRvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgYnRuLnNldEljb24oXCJwZW5jaWxcIilcbiAgICAgICAgYnRuLnNldFRvb2x0aXAoXCJFZGl0XCIpXG4gICAgICAgIGJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIGxldCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbChcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzcyxcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc0F0dHJpYnV0ZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgfSlcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGREZWxldGVCdXR0b24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBidG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGJ0bi5zZXRJY29uKFwidHJhc2hcIik7XG4gICAgICAgIGJ0bi5zZXRUb29sdGlwKFwiRGVsZXRlXCIpO1xuICAgICAgICBidG4uc2V0Q2xhc3MoXCJjZWxsXCIpXG4gICAgICAgIGJ0bi5vbkNsaWNrKCgpID0+IHtcblxuICAgICAgICAgICAgcmVtb3ZlRmlsZUNsYXNzQXR0cmlidXRlV2l0aE5hbWUodGhpcy5wbHVnaW4sIHRoaXMuZmlsZUNsYXNzLCB0aGlzLmZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lKVxuICAgICAgICB9KVxuICAgIH07XG59XG5cbmV4cG9ydCBjbGFzcyBGaWxlQ2xhc3NGaWVsZHNWaWV3IHtcbiAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIHB1YmxpYyBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgdmlld0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgZmlsZUNsYXNzOiBGaWxlQ2xhc3NcbiAgICApIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gdGhpcy52aWV3Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmdi1maWVsZHNcIiB9KVxuICAgICAgICB0aGlzLmJ1aWxkU2V0dGluZ3MoKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBidWlsQWRkQnRuKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmb290ZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyXCIgfSk7XG4gICAgICAgIGNvbnN0IGJ0bkNvbnRhaW5lciA9IGZvb3Rlci5jcmVhdGVEaXYoeyBjbHM6IFwiY2VsbFwiIH0pXG4gICAgICAgIGNvbnN0IGFkZEJ0biA9IGJ0bkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJyk7XG4gICAgICAgIHNldEljb24oYWRkQnRuLCBcImxpc3QtcGx1c1wiKVxuICAgICAgICBhZGRCdG4ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCBGaWxlQ2xhc3MuY3JlYXRlRmlsZUNsYXNzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGVDbGFzcy5uYW1lKSlcbiAgICAgICAgICAgIGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsLm9wZW4oKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYnVpbGRTZXR0aW5ncygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIucmVwbGFjZUNoaWxkcmVuKCk7XG4gICAgICAgIGNvbnN0IGZpZWxkc0NvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZHMtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IEZpbGVDbGFzcy5nZXRGaWxlQ2xhc3NBdHRyaWJ1dGVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGVDbGFzcyk7XG4gICAgICAgIGF0dHJpYnV0ZXMuZm9yRWFjaChhdHRyaWJ1dGUgPT4ge1xuICAgICAgICAgICAgLy9jb25zdCBzZXR0aW5nQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNldHRpbmdcIiB9KVxuICAgICAgICAgICAgbmV3IEZpbGVDbGFzc0ZpZWxkU2V0dGluZyhmaWVsZHNDb250YWluZXIsIHRoaXMuZmlsZUNsYXNzLCBhdHRyaWJ1dGUsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnVpbEFkZEJ0bigpO1xuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVGaWxlQ2xhc3NBdHRyaWJ1dGVXaXRoTmFtZShwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZUNsYXNzOiBGaWxlQ2xhc3MsIG5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGZpbGUgPSBmaWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgaWYgKGZpbGUpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IChhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSkpLnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGNvbnRlbnQubWFwKChsaW5lLCBpKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWxpbmUuc3RhcnRzV2l0aChuYW1lKSkgcmV0dXJuIGxpbmU7XG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWVsZCwgeyBGaWVsZENvbW1hbmQgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUsIE11bHRpRGlzcGxheVR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcblxuY2xhc3MgRmlsZUNsYXNzQXR0cmlidXRlIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgb3JpZ2luOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyB0eXBlOiBGaWVsZFR5cGUgPSBGaWVsZFR5cGUuSW5wdXQsXG4gICAgICAgIHB1YmxpYyBvcHRpb25zOiBzdHJpbmdbXSB8IFJlY29yZDxzdHJpbmcsIGFueT4gPSBbXSxcbiAgICAgICAgcHVibGljIGZpbGVDbGFzc05hbWU6IHN0cmluZyxcbiAgICAgICAgcHVibGljIGNvbW1hbmQ6IEZpZWxkQ29tbWFuZCxcbiAgICAgICAgcHVibGljIGRpc3BsYXk/OiBNdWx0aURpc3BsYXlUeXBlXG4gICAgKSB7IH1cblxuICAgIHB1YmxpYyBnZXRGaWVsZCgpIHtcbiAgICAgICAgbGV0IG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5vcHRpb25zKSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zPy5mb3JFYWNoKChvcHRpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc1tpbmRleF0gPSBvcHRpb247XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgRmllbGQodGhpcy5uYW1lLCBvcHRpb25zLCB0aGlzLm5hbWUsIHRoaXMudHlwZSwgdGhpcy5maWxlQ2xhc3NOYW1lLCB0aGlzLmNvbW1hbmQsIHRoaXMuZGlzcGxheSk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNTdHJpbmcocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLmdldEZpZWxkKClcbiAgICAgICAgY29uc3QgbWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0ocGx1Z2luLCBmaWVsZClcbiAgICAgICAgcmV0dXJuIG1hbmFnZXIuZ2V0T3B0aW9uc1N0cigpXG4gICAgfVxufVxuXG5leHBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfTsiLCAiaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH0gZnJvbSBcIi4vZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUsIEZpZWxkVHlwZUxhYmVsTWFwcGluZywgTXVsdGlEaXNwbGF5VHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgY2FwaXRhbGl6ZSB9IGZyb20gXCJzcmMvdXRpbHMvdGV4dFV0aWxzXCI7XG5pbXBvcnQgeyBnZW51aW5lS2V5cyB9IGZyb20gXCJzcmMvdXRpbHMvZGF0YXZpZXdVdGlsc1wiO1xuaW1wb3J0IHsgRmllbGRDb21tYW5kIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRzUGF5bG9hZCwgcG9zdFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcG9zdFZhbHVlc1wiO1xuXG5jb25zdCBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCB7IG5hbWU6IHN0cmluZywgdG9WYWx1ZTogKHZhbHVlOiBhbnkpID0+IHN0cmluZyB9PiA9IHtcbiAgICBcImxpbWl0XCI6IHsgbmFtZTogXCJsaW1pdFwiLCB0b1ZhbHVlOiAodmFsdWU6IGFueSkgPT4gYCR7dmFsdWUgfHwgXCJcIn1gIH0sXG4gICAgXCJtYXBXaXRoVGFnXCI6IHsgbmFtZTogXCJtYXBXaXRoVGFnXCIsIHRvVmFsdWU6ICh2YWx1ZTogYm9vbGVhbikgPT4gdmFsdWUudG9TdHJpbmcoKSB9LFxuICAgIFwiaWNvblwiOiB7IG5hbWU6IFwiaWNvblwiLCB0b1ZhbHVlOiAodmFsdWU6IGFueSkgPT4gYCR7dmFsdWUgfHwgXCJcIn1gIH0sXG4gICAgXCJ0YWdOYW1lc1wiOiB7IG5hbWU6IFwidGFnTmFtZXNcIiwgdG9WYWx1ZTogKHZhbHVlczogc3RyaW5nW10pID0+IHZhbHVlcy5qb2luKFwiLCBcIikgfSxcbiAgICBcImV4Y2x1ZGVzXCI6IHsgbmFtZTogXCJleGNsdWRlc1wiLCB0b1ZhbHVlOiAodmFsdWVzOiBGaWxlQ2xhc3NBdHRyaWJ1dGVbXSkgPT4gdmFsdWVzLm1hcChhdHRyID0+IGF0dHIubmFtZSkuam9pbihcIiwgXCIpIH0sXG4gICAgXCJwYXJlbnRcIjogeyBuYW1lOiBcImV4dGVuZHNcIiwgdG9WYWx1ZTogKHZhbHVlOiBGaWxlQ2xhc3MpID0+IGAke3ZhbHVlPy5uYW1lIHx8IFwiXCJ9YCB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmlsZUNsYXNzT3B0aW9ucyB7XG4gICAgbGltaXQ6IG51bWJlcixcbiAgICBpY29uOiBzdHJpbmcsXG4gICAgcGFyZW50PzogRmlsZUNsYXNzO1xuICAgIGV4Y2x1ZGVzPzogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbiAgICB0YWdOYW1lcz86IHN0cmluZ1tdLFxuICAgIG1hcFdpdGhUYWc6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGNsYXNzIEZpbGVDbGFzc09wdGlvbnMge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBsaW1pdDogbnVtYmVyLFxuICAgICAgICBwdWJsaWMgaWNvbjogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgcGFyZW50PzogRmlsZUNsYXNzLFxuICAgICAgICBwdWJsaWMgZXhjbHVkZXM/OiBBcnJheTxGaWxlQ2xhc3NBdHRyaWJ1dGU+LFxuICAgICAgICBwdWJsaWMgdGFnTmFtZXM/OiBzdHJpbmdbXSxcbiAgICAgICAgcHVibGljIG1hcFdpdGhUYWc6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuXG4gICAgfVxufVxuXG5pbnRlcmZhY2UgRmlsZUNsYXNzIGV4dGVuZHMgRmlsZUNsYXNzT3B0aW9ucyB7XG4gICAgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbiAgICBvYmplY3RzOiBGaWxlQ2xhc3NPYmplY3RzO1xuICAgIGVycm9yczogc3RyaW5nW107XG4gICAgb3B0aW9uczogRmlsZUNsYXNzT3B0aW9ucztcbn1cblxuZXhwb3J0IGNsYXNzIEFkZEZpbGVDbGFzc1RvRmlsZU1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGVcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcClcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10gfCBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiBbLi4udGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUua2V5cygpXVxuICAgICAgICAgICAgLmZpbHRlcihmaWxlQ2xhc3NOYW1lID0+ICF0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXNcbiAgICAgICAgICAgICAgICAuZ2V0KHRoaXMuZmlsZS5wYXRoKT8ubWFwKGZpbGVDbGFzcyA9PiBmaWxlQ2xhc3MubmFtZSlcbiAgICAgICAgICAgICAgICAuaW5jbHVkZXMoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5maWx0ZXIoZmlsZUNsYXNzTmFtZSA9PiBmaWxlQ2xhc3NOYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkuY29udGFpbnMocXVlcnkudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgICAgICAuc29ydCgpO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLnNldFRleHQodmFsdWUpO1xuICAgIH1cblxuICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgdGhpcy5pbnNlcnRGaWxlQ2xhc3NUb0ZpbGUoaXRlbSlcbiAgICB9XG5cbiAgICBhc3luYyBpbnNlcnRGaWxlQ2xhc3NUb0ZpbGUodmFsdWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzXG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQodGhpcy5maWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gY3VycmVudEZpbGVDbGFzc2VzID8gWy4uLmN1cnJlbnRGaWxlQ2xhc3Nlcy5tYXAoZmMgPT4gZmMubmFtZSksIHZhbHVlXS5qb2luKFwiLCBcIikgOiB2YWx1ZVxuICAgICAgICBhd2FpdCBwb3N0VmFsdWVzKHRoaXMucGx1Z2luLCBbeyBuYW1lOiBmaWxlQ2xhc3NBbGlhcywgcGF5bG9hZDogeyB2YWx1ZTogbmV3VmFsdWUgfSB9XSwgdGhpcy5maWxlKVxuICAgIH1cbn1cblxuY2xhc3MgRmlsZUNsYXNzT2JqZWN0cyB7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgaW5zdGFuY2U6IEZpbGVDbGFzcykgeyB9XG5cbiAgICBwdWJsaWMgYWxsKCkge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5maWx0ZXIoZmlsZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGU/LmZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgJiYgT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpLmluY2x1ZGVzKGZpbGVDbGFzc0FsaWFzKVxuICAgICAgICAgICAgICAgICYmIGNhY2hlLmZyb250bWF0dGVyW2ZpbGVDbGFzc0FsaWFzXSA9PSB0aGlzLmluc3RhbmNlLm5hbWU7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQobmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzV2l0aE5hbWUgPSB0aGlzLmFsbCgpLmZpbHRlcihmaWxlID0+IGZpbGUucGF0aC5yZXBsYWNlKC9tZCQvLCBcIlwiKS5lbmRzV2l0aChuYW1lKSk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQYXRoKHBhdGg6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhOYW1lID0gdGhpcy5hbGwoKS5maWx0ZXIoZmlsZSA9PiBmaWxlLnBhdGggPT0gcGF0aCk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cbn1cblxuY2xhc3MgRmlsZUNsYXNzIHtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5vYmplY3RzID0gbmV3IEZpbGVDbGFzc09iamVjdHModGhpcyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRGaWxlQ2xhc3NPcHRpb25zKCk6IEZpbGVDbGFzc09wdGlvbnMge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBleHRlbmRzOiBfcGFyZW50LFxuICAgICAgICAgICAgbGltaXQ6IF9saW1pdCxcbiAgICAgICAgICAgIGV4Y2x1ZGVzOiBfZXhjbHVkZXMsXG4gICAgICAgICAgICBtYXBXaXRoVGFnOiBfbWFwV2l0aFRhZyxcbiAgICAgICAgICAgIHRhZ05hbWVzOiBfdGFnTmFtZXMsXG4gICAgICAgICAgICBpY29uOiBfaWNvblxuICAgICAgICB9ID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKHRoaXMuZ2V0Q2xhc3NGaWxlKCkpPy5mcm9udG1hdHRlciBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+IHx8IHt9XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleFxuICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoX3BhcmVudCk7XG4gICAgICAgIGNvbnN0IGV4Y2x1ZGVkTmFtZXMgPSBGaWxlQ2xhc3MuZ2V0RXhjbHVkZWRGaWVsZHNGcm9tRnJvbnRtYXR0ZXIoX2V4Y2x1ZGVzKTtcblxuICAgICAgICBjb25zdCBleGNsdWRlczogRmlsZUNsYXNzQXR0cmlidXRlW10gPSBbXVxuICAgICAgICBpbmRleC5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5nZXQodGhpcy5nZXRDbGFzc0ZpbGUoKS5iYXNlbmFtZSk/LmZvckVhY2goYW5jZXN0b3JOYW1lID0+IHtcbiAgICAgICAgICAgIGluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoYW5jZXN0b3JOYW1lKT8uYXR0cmlidXRlcy5mb3JFYWNoKGF0dHIgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChleGNsdWRlZE5hbWVzLmluY2x1ZGVzKGF0dHIubmFtZSkgJiYgIWV4Y2x1ZGVzLm1hcChhdHRyID0+IGF0dHIubmFtZSkuaW5jbHVkZXMoYXR0ci5uYW1lKSkgZXhjbHVkZXMucHVzaChhdHRyKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgbGltaXQgPSB0eXBlb2YgKF9saW1pdCkgPT09ICdudW1iZXInID8gX2xpbWl0IDogdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFibGVWaWV3TWF4UmVjb3Jkc1xuICAgICAgICBjb25zdCBtYXBXaXRoVGFnID0gRmllbGRNYW5hZ2VyLnN0cmluZ1RvQm9vbGVhbihfbWFwV2l0aFRhZyk7XG4gICAgICAgIGNvbnN0IHRhZ05hbWVzID0gRmlsZUNsYXNzLmdldFRhZ05hbWVzRnJvbUZyb250TWF0dGVyKF90YWdOYW1lcyk7XG4gICAgICAgIGNvbnN0IGljb24gPSB0eXBlb2YgKF9pY29uKSA9PT0gJ3N0cmluZycgPyBfaWNvbiA6IHRoaXMucGx1Z2luLnNldHRpbmdzLmJ1dHRvbkljb25cbiAgICAgICAgcmV0dXJuIG5ldyBGaWxlQ2xhc3NPcHRpb25zKGxpbWl0LCBpY29uLCBwYXJlbnQsIGV4Y2x1ZGVzLCB0YWdOYW1lcywgbWFwV2l0aFRhZyk7XG4gICAgfVxuXG4gICAgcHVibGljIGlzTWFwcGVkV2l0aFRhZygpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0ZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICAgICAgY29uc3QgbWFwV2l0aFRhZyA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlQ2xhc3NGaWxlKT8uZnJvbnRtYXR0ZXI/Lm1hcFdpdGhUYWc7XG4gICAgICAgICAgICByZXR1cm4gISFtYXBXaXRoVGFnO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0Q2xhc3NGaWxlKCk6IFRGaWxlIHtcbiAgICAgICAgY29uc3QgZmlsZXNDbGFzc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aDtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7ZmlsZXNDbGFzc1BhdGh9JHt0aGlzLm5hbWV9Lm1kYCk7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgIGBubyBmaWxlIG5hbWVkIDwke3RoaXMubmFtZX0ubWQ+IGluIDwke2ZpbGVzQ2xhc3NQYXRofT4gZm9sZGVyIHRvIG1hdGNoIDwke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfTogJHt0aGlzLm5hbWV9PiBpbiBvbmUgb2YgdGhlc2Ugbm90ZXNgXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRJY29uKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IHBhcmVudHMgPSBbdGhpcy5uYW1lLCAuLi50aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzQW5jZXN0b3JzLmdldCh0aGlzLm5hbWUpIHx8IFtdXVxuICAgICAgICBsZXQgaWNvbjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBwYXJlbnRzLnNvbWUoKGZpbGVDbGFzc05hbWUsIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBmaWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgX2ljb24gPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyPy5pY29uXG4gICAgICAgICAgICAgICAgaWYgKF9pY29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGljb24gPSBfaWNvblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gaWNvblxuICAgIH1cblxuICAgIHN0YXRpYyBnZXRGaWxlQ2xhc3NBdHRyaWJ1dGVzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlQ2xhc3M6IEZpbGVDbGFzcywgZXhjbHVkZXM/OiBzdHJpbmdbXSk6IEZpbGVDbGFzc0F0dHJpYnV0ZVtdIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IGZpbGVDbGFzcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgbGV0IGF0dHJpYnV0ZXM6IEFycmF5PEZpbGVDbGFzc0F0dHJpYnV0ZT4gPSBbXTtcbiAgICAgICAgY29uc3QgZHZBcGkgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGdlbnVpbmVLZXlzKGR2RmlsZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSBcImZpbGVcIiAmJiAhT2JqZWN0LmtleXMoZHZGaWxlLmZpbGUuZnJvbnRtYXR0ZXIgfHwge30pLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0eXBlb2YgZHZGaWxlW2tleV0gIT09IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IEpTT04uc3RyaW5naWZ5KGR2RmlsZVtrZXldKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogZHZGaWxlW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgb3B0aW9ucywgY29tbWFuZCwgZGlzcGxheSB9ID0gSlNPTi5wYXJzZShpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZFR5cGUgPSBGaWVsZFR5cGVMYWJlbE1hcHBpbmdbY2FwaXRhbGl6ZSh0eXBlKSBhcyBrZXlvZiB0eXBlb2YgRmllbGRUeXBlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZSh0aGlzLm5hbWUsIGtleSwgZmllbGRUeXBlLCBvcHRpb25zLCBmaWxlQ2xhc3MubmFtZSwgY29tbWFuZCwgZGlzcGxheSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnB1c2goYXR0cilcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2RvIG5vdGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4Y2x1ZGVzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXR0cmlidXRlcy5maWx0ZXIoYXR0ciA9PiAhZXhjbHVkZXMuaW5jbHVkZXMoYXR0ci5uYW1lKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0RXhjbHVkZWRGaWVsZHNGcm9tRnJvbnRtYXR0ZXIoZXhjbHVkZWRGaWVsZHM6IHN0cmluZ1tdIHwgc3RyaW5nIHwgdW5kZWZpbmVkKTogc3RyaW5nW10ge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShleGNsdWRlZEZpZWxkcykpIHtcbiAgICAgICAgICAgIHJldHVybiBleGNsdWRlZEZpZWxkcztcbiAgICAgICAgfSBlbHNlIGlmIChleGNsdWRlZEZpZWxkcykge1xuICAgICAgICAgICAgcmV0dXJuIGV4Y2x1ZGVkRmllbGRzLnNwbGl0KFwiLFwiKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtdXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0VGFnTmFtZXNGcm9tRnJvbnRNYXR0ZXIoX3RhZ05hbWVzOiBzdHJpbmdbXSB8IHN0cmluZyB8IHVuZGVmaW5lZCk6IHN0cmluZ1tdIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoX3RhZ05hbWVzKSkge1xuICAgICAgICAgICAgcmV0dXJuIF90YWdOYW1lcztcbiAgICAgICAgfSBlbHNlIGlmIChfdGFnTmFtZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGFnTmFtZXMuc3BsaXQoXCIsXCIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRBdHRyaWJ1dGVzKCk6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgICAgICBjb25zdCBhbmNlc3RvcnMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzQW5jZXN0b3JzLmdldCh0aGlzLm5hbWUpO1xuICAgICAgICAgICAgY29uc3QgX2V4Y2x1ZGVkRmllbGRzID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcj8uZXhjbHVkZXNcbiAgICAgICAgICAgIGxldCBleGNsdWRlZEZpZWxkcyA9IEZpbGVDbGFzcy5nZXRFeGNsdWRlZEZpZWxkc0Zyb21Gcm9udG1hdHRlcihfZXhjbHVkZWRGaWVsZHMpO1xuXG4gICAgICAgICAgICBjb25zdCBhbmNlc3RvcnNBdHRyaWJ1dGVzOiBNYXA8c3RyaW5nLCBGaWxlQ2xhc3NBdHRyaWJ1dGVbXT4gPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICBhbmNlc3RvcnNBdHRyaWJ1dGVzLnNldCh0aGlzLm5hbWUsIEZpbGVDbGFzcy5nZXRGaWxlQ2xhc3NBdHRyaWJ1dGVzKHRoaXMucGx1Z2luLCB0aGlzLCBleGNsdWRlZEZpZWxkcykpXG5cbiAgICAgICAgICAgIGFuY2VzdG9ycz8uZm9yRWFjaChhbmNlc3Rvck5hbWUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9yRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGh9JHthbmNlc3Rvck5hbWV9Lm1kYClcbiAgICAgICAgICAgICAgICBjb25zdCBhbmNlc3RvciA9IG5ldyBGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIGFuY2VzdG9yTmFtZSk7XG4gICAgICAgICAgICAgICAgYW5jZXN0b3JzQXR0cmlidXRlcy5zZXQoYW5jZXN0b3JOYW1lLCBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzQXR0cmlidXRlcyh0aGlzLnBsdWdpbiwgYW5jZXN0b3IsIGV4Y2x1ZGVkRmllbGRzKSlcbiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3JGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgYW5jZXN0b3JGaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IF9leGNsdWRlZEZpZWxkcyA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhbmNlc3RvckZpbGUpPy5mcm9udG1hdHRlcj8uZXhjbHVkZXNcbiAgICAgICAgICAgICAgICAgICAgZXhjbHVkZWRGaWVsZHMucHVzaCguLi5GaWxlQ2xhc3MuZ2V0RXhjbHVkZWRGaWVsZHNGcm9tRnJvbnRtYXR0ZXIoX2V4Y2x1ZGVkRmllbGRzKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2ZpbGVDbGFzc05hbWUsIGZpbGVDbGFzc0F0dHJpYnV0ZXNdIG9mIGFuY2VzdG9yc0F0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMucHVzaCguLi5maWxlQ2xhc3NBdHRyaWJ1dGVzLmZpbHRlcihhdHRyID0+ICF0aGlzLmF0dHJpYnV0ZXMubWFwKF9hdHRyID0+IF9hdHRyLm5hbWUpLmluY2x1ZGVzKGF0dHIubmFtZSkpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRWZXJzaW9uKCk6IG51bWJlciB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWZXJzaW9uID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKHRoaXMuZ2V0Q2xhc3NGaWxlKCkpPy5mcm9udG1hdHRlcj8udmVyc2lvblxuICAgICAgICByZXR1cm4gY3VycmVudFZlcnNpb24gJiYgIWlzTmFOKGN1cnJlbnRWZXJzaW9uKSA/IGN1cnJlbnRWZXJzaW9uIDogMDtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgdXBkYXRlT3B0aW9ucyhuZXdPcHRpb25zOiBGaWxlQ2xhc3NPcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmdldENsYXNzRmlsZSgpLnBhdGhcbiAgICAgICAgY29uc3QgcGF5bG9hZDogRmllbGRzUGF5bG9hZCA9IFtdXG4gICAgICAgIE9iamVjdC5rZXlzKG9wdGlvbnMpLmZvckVhY2goYXN5bmMgKGtleToga2V5b2YgdHlwZW9mIG9wdGlvbnMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSwgdG9WYWx1ZSB9ID0gb3B0aW9uc1trZXldXG4gICAgICAgICAgICBwYXlsb2FkLnB1c2goeyBuYW1lOiBuYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiB0b1ZhbHVlKG5ld09wdGlvbnNba2V5IGFzIGtleW9mIEZpbGVDbGFzc09wdGlvbnNdKSB9IH0pXG4gICAgICAgIH0pXG4gICAgICAgIC8vaW5jcmVtZW50aW5nIGEgdmVyc2lvbiB0byBmb3JjZSBvYnNpZGlhbiByZXNvbHZlIHRoaXMgbmV3IGZpbGUgZXZlbiBpZiBpdCBsb29rcyBsaWtlIHRoZSBwcmV2aW91cyB2ZXJzaW9uXG4gICAgICAgIHBheWxvYWQucHVzaCh7IG5hbWU6IFwidmVyc2lvblwiLCBwYXlsb2FkOiB7IHZhbHVlOiBgJHt0aGlzLmdldFZlcnNpb24oKSArIDF9YCB9IH0pXG4gICAgICAgIGF3YWl0IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIHBheWxvYWQsIHBhdGgpXG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHVwZGF0ZUF0dHJpYnV0ZShcbiAgICAgICAgbmV3VHlwZToga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSxcbiAgICAgICAgbmV3TmFtZTogc3RyaW5nLFxuICAgICAgICBuZXdPcHRpb25zPzogc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuICAgICAgICBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlLFxuICAgICAgICBuZXdDb21tYW5kPzogRmllbGRDb21tYW5kLFxuICAgICAgICBuZXdEaXNwbGF5PzogTXVsdGlEaXNwbGF5VHlwZVxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBhdHRyID8gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGF0dHIuZmlsZUNsYXNzTmFtZSkhIDogdGhpc1xuICAgICAgICBjb25zdCBmaWxlID0gZmlsZUNsYXNzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgaWYgKGF0dHIpIHtcbiAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoYXR0ci5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2V0dGluZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld09wdGlvbnMpIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdDb21tYW5kKSBzZXR0aW5nc1tcImNvbW1hbmRcIl0gPSBuZXdDb21tYW5kO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3RGlzcGxheSkgc2V0dGluZ3NbXCJkaXNwbGF5XCJdID0gbmV3RGlzcGxheTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke25ld05hbWV9OjogJHtKU09OLnN0cmluZ2lmeShzZXR0aW5ncyl9YCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHNldHRpbmdzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gICAgICAgICAgICBzZXR0aW5nc1tcInR5cGVcIl0gPSBuZXdUeXBlO1xuICAgICAgICAgICAgaWYgKG5ld09wdGlvbnMpIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICBpZiAobmV3Q29tbWFuZCkgc2V0dGluZ3NbXCJjb21tYW5kXCJdID0gbmV3Q29tbWFuZDtcbiAgICAgICAgICAgIGlmIChuZXdEaXNwbGF5KSBzZXR0aW5nc1tcImRpc3BsYXlcIl0gPSBuZXdEaXNwbGF5O1xuICAgICAgICAgICAgcmVzdWx0ICs9IChgXFxuJHtuZXdOYW1lfTo6ICR7SlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpfWApO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHJlbW92ZUF0dHJpYnV0ZShhdHRyOiBGaWxlQ2xhc3NBdHRyaWJ1dGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICByZXN1bHQuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICBpZiAoIWxpbmUuc3RhcnRzV2l0aChhdHRyLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgIH1cblxuICAgIHN0YXRpYyBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZywgZXhjbHVkZVBhcmVudDogYm9vbGVhbiA9IGZhbHNlKTogRmlsZUNsYXNzIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gbmV3IEZpbGVDbGFzcyhwbHVnaW4sIG5hbWUpO1xuICAgICAgICBmaWxlQ2xhc3Mub3B0aW9ucyA9IGZpbGVDbGFzcy5nZXRGaWxlQ2xhc3NPcHRpb25zKClcbiAgICAgICAgZmlsZUNsYXNzLmdldEF0dHJpYnV0ZXMoKTtcbiAgICAgICAgcmV0dXJuIGZpbGVDbGFzc1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRGaWxlQ2xhc3NOYW1lRnJvbVBhdGgocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHBhdGg6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWVSZWdleCA9IG5ldyBSZWdFeHAoYCR7cGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRofSg/PGZpbGVDbGFzc05hbWU+LiopLm1kYCk7XG4gICAgICAgIHJldHVybiBwYXRoLm1hdGNoKGZpbGVDbGFzc05hbWVSZWdleCk/Lmdyb3Vwcz8uZmlsZUNsYXNzTmFtZVxuICAgIH1cbn1cblxuZXhwb3J0IHsgRmlsZUNsYXNzIH07IiwgImV4cG9ydCBjb25zdCBjYXBpdGFsaXplID0gKHM6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiBzICYmIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSk7XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgTWFya2Rvd25SZW5kZXJlciwgc2V0SWNvbiwgU3VnZ2VzdE1vZGFsLCBUZXh0Q29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpbGVDbGFzcywgRmlsZUNsYXNzT3B0aW9ucyB9IGZyb20gXCIuL2ZpbGVDbGFzc1wiO1xuXG5cbmNsYXNzIFBhcmVudFN1Z2dlc3RNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxzdHJpbmc+IHtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdmlldzogRmlsZUNsYXNzU2V0dGluZ3NWaWV3KSB7XG4gICAgICAgIHN1cGVyKHZpZXcucGx1Z2luLmFwcClcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3Nlc05hbWVzID0gWy4uLnRoaXMudmlldy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUua2V5cygpXSBhcyBzdHJpbmdbXVxuICAgICAgICBjb25zdCBjdXJyZW50TmFtZSA9IHRoaXMudmlldy5maWxlQ2xhc3MubmFtZVxuICAgICAgICByZXR1cm4gZmlsZUNsYXNzZXNOYW1lc1xuICAgICAgICAgICAgLnNvcnQoKVxuICAgICAgICAgICAgLmZpbHRlcihuYW1lID0+IG5hbWUgIT09IGN1cnJlbnROYW1lICYmIG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSlcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLnZpZXcuZmlsZUNsYXNzLmdldEZpbGVDbGFzc09wdGlvbnMoKVxuICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLnZpZXcucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChpdGVtKVxuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICBvcHRpb25zLnBhcmVudCA9IHBhcmVudFxuICAgICAgICAgICAgdGhpcy52aWV3LmZpbGVDbGFzcy51cGRhdGVPcHRpb25zKG9wdGlvbnMpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5zZXRUZXh0KHZhbHVlKVxuICAgIH1cbn1cblxuXG5jbGFzcyBUYWdTdWdnZXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHZpZXc6IEZpbGVDbGFzc1NldHRpbmdzVmlldykge1xuICAgICAgICBzdXBlcih2aWV3LnBsdWdpbi5hcHApXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IHRhZ3MgPSBPYmplY3Qua2V5cyh0aGlzLnZpZXcucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldFRhZ3MoKSlcbiAgICAgICAgcmV0dXJuIHRhZ3MuZmlsdGVyKHQgPT4gdC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKVxuICAgIH1cblxuICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMudmlldy5maWxlQ2xhc3MuZ2V0RmlsZUNsYXNzT3B0aW9ucygpXG4gICAgICAgIGNvbnN0IHRhZ05hbWVzID0gb3B0aW9ucy50YWdOYW1lcyB8fCBbXVxuICAgICAgICB0YWdOYW1lcy5wdXNoKGl0ZW0ucmVwbGFjZSgvXiMoLiopLywgXCIkMVwiKSlcbiAgICAgICAgb3B0aW9ucy50YWdOYW1lcyA9IHRhZ05hbWVzXG4gICAgICAgIHRoaXMudmlldy5maWxlQ2xhc3MudXBkYXRlT3B0aW9ucyhvcHRpb25zKVxuXG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZSlcbiAgICB9XG59XG5cbmNsYXNzIEZpZWxkU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB2aWV3OiBGaWxlQ2xhc3NTZXR0aW5nc1ZpZXcpIHtcbiAgICAgICAgc3VwZXIodmlldy5wbHVnaW4uYXBwKVxuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0aGlzLnZpZXcuZmlsZUNsYXNzLm5hbWVcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzRmllbGRzID0gdGhpcy52aWV3LnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzRmllbGRzLmdldChmaWxlQ2xhc3NOYW1lKSB8fCBbXVxuICAgICAgICBjb25zdCBleGNsdWRlZEZpZWxkcyA9IHRoaXMudmlldy5maWxlQ2xhc3MuZ2V0RmlsZUNsYXNzT3B0aW9ucygpLmV4Y2x1ZGVzXG4gICAgICAgIHJldHVybiBmaWxlQ2xhc3NGaWVsZHNcbiAgICAgICAgICAgIC5maWx0ZXIoZkNBID0+XG4gICAgICAgICAgICAgICAgZkNBLmZpbGVDbGFzc05hbWUgIT09IGZpbGVDbGFzc05hbWVcbiAgICAgICAgICAgICAgICAmJiBmQ0EuZmlsZUNsYXNzTmFtZT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgICAgICYmICFleGNsdWRlZEZpZWxkcz8ubWFwKGF0dHIgPT4gYXR0ci5uYW1lKS5pbmNsdWRlcyhmQ0EubmFtZSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5tYXAoZkNBID0+IGZDQS5uYW1lKVxuICAgIH1cblxuICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMudmlldy5maWxlQ2xhc3MuZ2V0RmlsZUNsYXNzT3B0aW9ucygpXG4gICAgICAgIGNvbnN0IGV4Y2x1ZGVkRmllbGRzID0gb3B0aW9ucy5leGNsdWRlcyB8fCBbXVxuICAgICAgICBjb25zdCBleGNsdWRlZEZpZWxkID0gdGhpcy52aWV3LmZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gaXRlbSlcbiAgICAgICAgaWYgKGV4Y2x1ZGVkRmllbGQpIHtcbiAgICAgICAgICAgIGV4Y2x1ZGVkRmllbGRzLnB1c2goZXhjbHVkZWRGaWVsZClcbiAgICAgICAgICAgIG9wdGlvbnMuZXhjbHVkZXMgPSBleGNsdWRlZEZpZWxkc1xuICAgICAgICAgICAgdGhpcy52aWV3LmZpbGVDbGFzcy51cGRhdGVPcHRpb25zKG9wdGlvbnMpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5zZXRUZXh0KHZhbHVlKVxuICAgIH1cbn1cblxuY2xhc3MgRmlsZUNsYXNzU2V0dGluZyB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgbGFiZWw6IHN0cmluZyxcbiAgICAgICAgcHJpdmF0ZSB0b29sVGlwVGV4dDogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGJ1aWxkT3B0aW9uQW5kQWN0aW9uOiAoYWN0aW9uOiBIVE1MRGl2RWxlbWVudCkgPT4gdm9pZCxcbiAgICApIHtcbiAgICAgICAgdGhpcy5idWlsZFNldHRpbmcoKVxuICAgIH07XG5cbiAgICBwcml2YXRlIGJ1aWxkU2V0dGluZygpOiB2b2lkIHtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB0aGlzLmxhYmVsLCBjbHM6IFwibGFiZWxcIiB9KVxuICAgICAgICBjb25zdCB0b29sVGlwQnRuQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInRvb2x0aXAtYnRuXCIgfSk7XG4gICAgICAgIGNvbnN0IHRvb2x0aXBCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHRvb2xUaXBCdG5Db250YWluZXIpXG4gICAgICAgICAgICAuc2V0SWNvbihcImhlbHAtY2lyY2xlXCIpXG4gICAgICAgICAgICAuc2V0Q2xhc3MoXCJ0b29sdGlwLWJ1dHRvblwiKVxuICAgICAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiYWN0aW9uXCIgfSlcbiAgICAgICAgdGhpcy5idWlsZE9wdGlvbkFuZEFjdGlvbihhY3Rpb24pO1xuICAgICAgICBjb25zdCB0b29sdGlwID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInRvb2x0aXAtdGV4dFwiIH0pO1xuICAgICAgICB0b29sdGlwLmlubmVySFRNTCA9IHRoaXMudG9vbFRpcFRleHRcbiAgICAgICAgdG9vbHRpcC5oaWRlKCk7XG4gICAgICAgIHRvb2x0aXBCdG4uYnV0dG9uRWwub25tb3VzZW92ZXIgPSAoKSA9PiB0b29sdGlwLnNob3coKTtcbiAgICAgICAgdG9vbHRpcEJ0bi5idXR0b25FbC5vbm1vdXNlb3V0ID0gKCkgPT4gdG9vbHRpcC5oaWRlKCk7XG4gICAgfTtcbn1cblxuZXhwb3J0IGNsYXNzIEZpbGVDbGFzc1NldHRpbmdzVmlldyB7XG4gICAgcHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIHB1YmxpYyBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50XG4gICAgcHJpdmF0ZSBmaWxlQ2xhc3NPcHRpb25zOiBGaWxlQ2xhc3NPcHRpb25zXG4gICAgcHJpdmF0ZSBzYXZlQnRuOiBIVE1MQnV0dG9uRWxlbWVudFxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIHZpZXdDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBwdWJsaWMgZmlsZUNsYXNzOiBGaWxlQ2xhc3NcbiAgICApIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gdGhpcy52aWV3Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmdi1zZXR0aW5nc1wiIH0pXG4gICAgICAgIHRoaXMuYnVpbGRTZXR0aW5ncygpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgYnVpbGRTZXR0aW5ncygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3NPcHRpb25zID0gdGhpcy5maWxlQ2xhc3MuZ2V0RmlsZUNsYXNzT3B0aW9ucygpXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlcGxhY2VDaGlsZHJlbigpO1xuICAgICAgICBjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzZXR0aW5ncy1jb250YWluZXJcIiB9KVxuICAgICAgICBuZXcgRmlsZUNsYXNzU2V0dGluZyhcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLFxuICAgICAgICAgICAgXCJNYXggcmVjb3JkcyBwZXIgcGFnZVwiLFxuICAgICAgICAgICAgXCJNYXhpbXVtIGxpbmVzIGRpc3BsYXllZCBwZXIgcGFnZSBpbiB0aGUgdGFibGUgdmlld1wiLFxuICAgICAgICAgICAgKGFjdGlvbjogSFRNTERpdkVsZW1lbnQpID0+IHRoaXMuYnVpbGRMaW1pdENvbXBvbmVudChhY3Rpb24pXG4gICAgICAgICk7XG4gICAgICAgIG5ldyBGaWxlQ2xhc3NTZXR0aW5nKFxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIsXG4gICAgICAgICAgICBcIk1hcCB3aXRoIHRhZ1wiLFxuICAgICAgICAgICAgYEJpbmQgdGFncyB3aXRoICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9PGJyLz5gICtcbiAgICAgICAgICAgIGBJZiBUYWcgTmFtZXMgYXJlIGVtcHR5IHRoaXMgZmlsZUNsYXNzIHdpbGwgYmUgYm91bmQgd2l0aCB0aGUgdGFnIG9mIHNhbWUgbmFtZWAsXG4gICAgICAgICAgICAoYWN0aW9uOiBIVE1MRGl2RWxlbWVudCkgPT4gdGhpcy5idWlsZE1hcFdpdGhUYWdDb21wb25lbnQoYWN0aW9uKVxuICAgICAgICApXG4gICAgICAgIG5ldyBGaWxlQ2xhc3NTZXR0aW5nKFxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIsXG4gICAgICAgICAgICBcIkJ1dHRvbiBJY29uXCIsXG4gICAgICAgICAgICBcIk5hbWUgb2YgdGhlIGljb24gZm9yIHRoZSBtZXRhZGF0YSBtZW51IGJ1dHRvbjxici8+KGx1Y2lkZS5kZXYpXCIsXG4gICAgICAgICAgICAoYWN0aW9uOiBIVE1MRGl2RWxlbWVudCkgPT4gdGhpcy5idWlsZEljb25Db21wb25lbnQoYWN0aW9uKVxuICAgICAgICApXG4gICAgICAgIG5ldyBGaWxlQ2xhc3NTZXR0aW5nKFxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIsXG4gICAgICAgICAgICBcIlRhZyBOYW1lc1wiLFxuICAgICAgICAgICAgYE5hbWVzIG9mIHRhZ3MgdG8gYmluZCB0aGlzICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9IHdpdGhgLFxuICAgICAgICAgICAgKGFjdGlvbjogSFRNTERpdkVsZW1lbnQpID0+IHRoaXMuYnVpbGRUYWdOYW1lc0NvbXBvbmVudChhY3Rpb24pXG4gICAgICAgIClcbiAgICAgICAgbmV3IEZpbGVDbGFzc1NldHRpbmcoXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lcixcbiAgICAgICAgICAgIFwiUGFyZW50IEZpbGVjbGFzc1wiLFxuICAgICAgICAgICAgXCJDaG9vc2UgYSBmaWxlQ2xhc3MgdG8gaW5oZXJpdCBmaWVsZHMgZnJvbVwiLFxuICAgICAgICAgICAgKGFjdGlvbjogSFRNTERpdkVsZW1lbnQpID0+IHRoaXMuYnVpbGRFeHRlbmRDb21wb25lbnQoYWN0aW9uKVxuICAgICAgICApXG4gICAgICAgIG5ldyBGaWxlQ2xhc3NTZXR0aW5nKFxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIsXG4gICAgICAgICAgICBcIkV4Y2x1ZGVkIEZpZWxkc1wiLFxuICAgICAgICAgICAgYE5hbWVzIG9mIGZpZWxkcyB0byBleGNsdWRlIGZyb20gYW5jZXN0b3IgZmlsZWNsYXNzZXNgLFxuICAgICAgICAgICAgKGFjdGlvbjogSFRNTERpdkVsZW1lbnQpID0+IHRoaXMuYnVpbGRFeGNsdWRlc0NvbXBvbmVudChhY3Rpb24pXG4gICAgICAgIClcbiAgICAgICAgdGhpcy5idWlsZFNhdmVCdG4oKTtcbiAgICAgICAgdGhpcy5zYXZlQnRuLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFNhdmVCdG4oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZvb3RlciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmb290ZXJcIiB9KTtcbiAgICAgICAgY29uc3QgYnRuQ29udGFpbmVyID0gZm9vdGVyLmNyZWF0ZURpdih7IGNsczogXCJjZWxsXCIgfSlcbiAgICAgICAgdGhpcy5zYXZlQnRuID0gYnRuQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nKTtcbiAgICAgICAgc2V0SWNvbih0aGlzLnNhdmVCdG4sIFwic2F2ZVwiKVxuICAgICAgICB0aGlzLnNhdmVCdG4ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZmlsZUNsYXNzLnVwZGF0ZU9wdGlvbnModGhpcy5maWxlQ2xhc3NPcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRMaW1pdENvbXBvbmVudChhY3Rpb246IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQoYWN0aW9uKVxuICAgICAgICBpbnB1dC5zZXRWYWx1ZShgJHt0aGlzLmZpbGVDbGFzc09wdGlvbnMubGltaXR9YClcbiAgICAgICAgaW5wdXQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNhdmVCdG4uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc09wdGlvbnMubGltaXQgPSBwYXJzZUludCh2YWx1ZSkgfHwgdGhpcy5maWxlQ2xhc3NPcHRpb25zLmxpbWl0O1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRNYXBXaXRoVGFnQ29tcG9uZW50KGFjdGlvbjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdG9nZ2xlciA9IG5ldyBUb2dnbGVDb21wb25lbnQoYWN0aW9uKTtcbiAgICAgICAgdG9nZ2xlci5zZXRWYWx1ZSh0aGlzLmZpbGVDbGFzc09wdGlvbnMubWFwV2l0aFRhZylcbiAgICAgICAgdG9nZ2xlci5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2F2ZUJ0bi5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzT3B0aW9ucy5tYXBXaXRoVGFnID0gdmFsdWU7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZEljb25Db21wb25lbnQoYWN0aW9uOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpY29uTWFuYWdlckNvbnRhaW5lciA9IGFjdGlvbi5jcmVhdGVEaXYoeyBjbHM6IFwiaWNvbi1tYW5hZ2VyXCIgfSlcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChpY29uTWFuYWdlckNvbnRhaW5lcik7XG4gICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBpY29uTWFuYWdlckNvbnRhaW5lci5jcmVhdGVEaXYoe30pXG4gICAgICAgIGlucHV0LnNldFZhbHVlKHRoaXMuZmlsZUNsYXNzT3B0aW9ucy5pY29uKTtcbiAgICAgICAgc2V0SWNvbihpY29uQ29udGFpbmVyLCB0aGlzLmZpbGVDbGFzc09wdGlvbnMuaWNvbik7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zYXZlQnRuLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NPcHRpb25zLmljb24gPSB2YWx1ZTtcbiAgICAgICAgICAgIHNldEljb24oaWNvbkNvbnRhaW5lciwgdGhpcy5maWxlQ2xhc3NPcHRpb25zLmljb24pO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRUYWdOYW1lc0NvbXBvbmVudChhY3Rpb246IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRhZ3NDb250YWluZXIgPSBhY3Rpb24uY3JlYXRlRGl2KHsgY2xzOiBcIml0ZW1zXCIgfSlcbiAgICAgICAgdGhpcy5maWxlQ2xhc3NPcHRpb25zLnRhZ05hbWVzPy5mb3JFYWNoKHRhZ05hbWUgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFnQ29udGFpbmVyID0gdGFnc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbSBjaGlwXCIsIHRleHQ6IHRhZ05hbWUgfSlcbiAgICAgICAgICAgIG5ldyBCdXR0b25Db21wb25lbnQodGFnQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgIC5zZXRJY29uKFwieC1jaXJjbGVcIilcbiAgICAgICAgICAgICAgICAuc2V0Q2xhc3MoXCJpdGVtLXJlbW92ZVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NPcHRpb25zLnRhZ05hbWVzPy5yZW1vdmUodGFnTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5maWxlQ2xhc3MudXBkYXRlT3B0aW9ucyh0aGlzLmZpbGVDbGFzc09wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IHRhZ0FkZEJ0biA9IHRhZ3NDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiBcIml0ZW0gYWRkXCIgfSlcbiAgICAgICAgc2V0SWNvbih0YWdBZGRCdG4sIFwicGx1cy1jaXJjbGVcIilcbiAgICAgICAgdGFnQWRkQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBuZXcgVGFnU3VnZ2VzdE1vZGFsKHRoaXMpLm9wZW4oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRFeGNsdWRlc0NvbXBvbmVudChhY3Rpb246IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkc0NvbnRhaW5lciA9IGFjdGlvbi5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbXNcIiB9KVxuICAgICAgICB0aGlzLmZpbGVDbGFzc09wdGlvbnMuZXhjbHVkZXM/LmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmllbGRvbnRhaW5lciA9IGZpZWxkc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbSBjaGlwXCIsIHRleHQ6IGZpZWxkLm5hbWUgfSlcbiAgICAgICAgICAgIG5ldyBCdXR0b25Db21wb25lbnQoZmllbGRvbnRhaW5lcilcbiAgICAgICAgICAgICAgICAuc2V0SWNvbihcIngtY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgLnNldENsYXNzKFwiaXRlbS1yZW1vdmVcIilcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4Y2x1ZGVkRmllbGRzID0gdGhpcy5maWxlQ2xhc3NPcHRpb25zLmV4Y2x1ZGVzPy5maWx0ZXIoYXR0ciA9PiBhdHRyLm5hbWUgIT09IGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzT3B0aW9ucy5leGNsdWRlcyA9IGV4Y2x1ZGVkRmllbGRzXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZmlsZUNsYXNzLnVwZGF0ZU9wdGlvbnModGhpcy5maWxlQ2xhc3NPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBmaWVsZEFkZEJ0biA9IGZpZWxkc0NvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6IFwiaXRlbVwiIH0pXG4gICAgICAgIHNldEljb24oZmllbGRBZGRCdG4sIFwicGx1cy1jaXJjbGVcIilcbiAgICAgICAgZmllbGRBZGRCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIG5ldyBGaWVsZFN1Z2dlc3RNb2RhbCh0aGlzKS5vcGVuKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkRXh0ZW5kQ29tcG9uZW50KGFjdGlvbjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcGFyZW50TWFuYWdlckNvbnRhaW5lciA9IGFjdGlvbi5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbXNcIiB9KVxuICAgICAgICBjb25zdCBwYXJlbnRMaW5rQ29udGFpbmVyID0gcGFyZW50TWFuYWdlckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbVwiIH0pXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHRoaXMuZmlsZUNsYXNzT3B0aW9ucy5wYXJlbnRcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMuZmlsZUNsYXNzLmdldENsYXNzRmlsZSgpLnBhdGhcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMucGx1Z2luXG4gICAgICAgICAgICBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKGBbWyR7cGFyZW50Lm5hbWV9XV1gLCBwYXJlbnRMaW5rQ29udGFpbmVyLCBwYXRoLCBjb21wb25lbnQpXG4gICAgICAgICAgICBwYXJlbnRMaW5rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJhLmludGVybmFsLWxpbmtcIik/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KFxuICAgICAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQuZ2V0QXR0cihcImRhdGEtaHJlZlwiKS5zcGxpdChcIi9cIikubGFzdCgpPy5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSxcbiAgICAgICAgICAgICAgICAgICAgcGF0aCxcbiAgICAgICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgICd0YWInXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnRNYW5hZ2VyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJpdGVtIHNwYWNlclwiIH0pXG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudFJlbW92ZUJ0biA9IHBhcmVudE1hbmFnZXJDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiBcIml0ZW1cIiB9KVxuICAgICAgICAgICAgc2V0SWNvbihwYXJlbnRSZW1vdmVCdG4sIFwidHJhc2hcIilcbiAgICAgICAgICAgIHBhcmVudFJlbW92ZUJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAodGhpcy5maWxlQ2xhc3NPcHRpb25zLnBhcmVudCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5maWxlQ2xhc3MudXBkYXRlT3B0aW9ucyh0aGlzLmZpbGVDbGFzc09wdGlvbnMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGFyZW50Q2hhbmdlQnRuID0gcGFyZW50TWFuYWdlckNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6IFwiaXRlbSByaWdodC1hbGlnblwiIH0pXG4gICAgICAgIHNldEljb24ocGFyZW50Q2hhbmdlQnRuLCBcImVkaXRcIilcbiAgICAgICAgcGFyZW50Q2hhbmdlQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBuZXcgUGFyZW50U3VnZ2VzdE1vZGFsKHRoaXMpLm9wZW4oKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NNYW5hZ2VyIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL2ZpbGVDbGFzc01hbmFnZXJcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCIuL2ZpbGVDbGFzc1wiO1xuXG5jb25zdCBvcHBvc2l0ZURpcmVjdGlvbiA9IHtcbiAgICAnYXNjJzogJ2Rlc2MnLFxuICAgICdkZXNjJzogJ2FzYydcbn1cblxuZXhwb3J0IGNsYXNzIEZpbGVDbGFzc1RhYmxlVmlldyB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwdWJsaWMgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudFxuICAgIHByaXZhdGUgbGltaXQ6IG51bWJlclxuICAgIHByaXZhdGUgdGFibGVDb250YWluZXI6IEhUTUxEaXZFbGVtZW50XG4gICAgcHJpdmF0ZSBmaWx0ZXJzOiBSZWNvcmQ8c3RyaW5nLCBUZXh0Q29tcG9uZW50PiA9IHt9XG4gICAgcHJpdmF0ZSBzb3J0ZXJzOiBSZWNvcmQ8c3RyaW5nLCB7IGJ0bjogQnV0dG9uQ29tcG9uZW50LCBhY3RpdmU6IGJvb2xlYW4sIGRpcmVjdGlvbjogJ2FzYycgfCAnZGVzYycsIG5hbWU6IHN0cmluZyB9PiA9IHt9XG4gICAgcHJpdmF0ZSByZWZyZXNoQnV0dG9uOiBCdXR0b25Db21wb25lbnRcbiAgICBwcml2YXRlIHBhZ2luYXRpb25Db250YWluZXI6IEhUTUxEaXZFbGVtZW50XG4gICAgcHJpdmF0ZSBzbGljZVN0YXJ0OiBudW1iZXIgPSAwXG4gICAgcHJpdmF0ZSBmaXJzdENvbGxXaWR0aDogbnVtYmVyO1xuICAgIHByaXZhdGUgdGFibGVGb250U2l6ZTogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGNvbXBvbmVudDogRmlsZUNsYXNzTWFuYWdlcixcbiAgICAgICAgcHJpdmF0ZSB2aWV3Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBmaWxlQ2xhc3M6IEZpbGVDbGFzc1xuICAgICkge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSB0aGlzLnZpZXdDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZ2LXRhYmxlXCIgfSlcbiAgICAgICAgdGhpcy5saW1pdCA9IHRoaXMuZmlsZUNsYXNzLmdldEZpbGVDbGFzc09wdGlvbnMoKS5saW1pdFxuICAgICAgICB0aGlzLmNyZWF0ZUhlYWRlcigpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUhlYWRlcigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9wdGlvbnNcIiB9KVxuICAgICAgICBjb25zdCBsaW1pdENvbnRhaW5lciA9IGhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwibGltaXRcIiB9KTtcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uQ29udGFpbmVyID0gaGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJwYWdpbmF0aW9uXCIgfSk7XG4gICAgICAgIGNvbnN0IGZpZWxkc0NvbnRhaW5lciA9IGhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGRzXCIgfSlcbiAgICAgICAgY29uc3QgYXBwbHlDb250YWluZXIgPSBoZWFkZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZvb3RlclwiIH0pXG4gICAgICAgIHRoaXMuYnVpbGRMaW1pdE1hbmFnZXIobGltaXRDb250YWluZXIpO1xuICAgICAgICB0aGlzLmJ1aWxkUGFnaW5hdGlvbk1hbmFnZXIodGhpcy5wYWdpbmF0aW9uQ29udGFpbmVyKVxuICAgICAgICB0aGlzLmJ1aWxkRmlsdGVyc0FuZFNvcnRNYW5hZ2VyKGZpZWxkc0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuYnVpbGRSZWZyZXNoTWFuYWdlcihhcHBseUNvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuYnVpbGRDbGVhbkZpbHRlcnMoYXBwbHlDb250YWluZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyB1ZHBhdGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYnVpbGRUYWJsZSgpO1xuICAgICAgICB0aGlzLmJ1aWxkUGFnaW5hdGlvbkNvbXBvbmVudCh0aGlzLnBhZ2luYXRpb25Db250YWluZXIpO1xuICAgICAgICB0aGlzLnJlZnJlc2hCdXR0b24ucmVtb3ZlQ3RhKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGJ1aWxkVGFibGUoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnRhYmxlQ29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLnRhYmxlQ29udGFpbmVyLnJlbW92ZSgpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudGFibGVDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBhdHRyOiB7IGlkOiBgdGFibGUtY29udGFpbmVyLSR7TWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCl9YCB9IH0pXG4gICAgICAgIHRoaXMudGFibGVDb250YWluZXIub25zY3JvbGwgPSAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFibGUgPSB0aGlzLnRhYmxlQ29udGFpbmVyXG4gICAgICAgICAgICBjb25zdCBmaXJzdENvbGwgPSB0aGlzLnRhYmxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3Rib2R5ID4gdHIgPiB0ZDpmaXJzdC1jaGlsZCcpXG4gICAgICAgICAgICBjb25zdCBmaXJzdEZpbGVMaW5rID0gZmlyc3RDb2xsWzBdPy5xdWVyeVNlbGVjdG9yKFwiYS5pbnRlcm5hbC1saW5rXCIpXG4gICAgICAgICAgICBpZiAoZmlyc3RDb2xsICYmIGZpcnN0RmlsZUxpbmspIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZmlyc3RDb2xsV2lkdGgpIHRoaXMuZmlyc3RDb2xsV2lkdGggPSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUoZmlyc3RDb2xsWzBdKS53aWR0aClcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudGFibGVGb250U2l6ZSkgdGhpcy50YWJsZUZvbnRTaXplID0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKGZpcnN0RmlsZUxpbmspLndpZHRoKVxuICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gKGUudGFyZ2V0IGFzIEhUTUxEaXZFbGVtZW50KS5zY3JvbGxMZWZ0XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNDAwcHgpXCIpLm1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5hZGRDbGFzcyhcInNjcm9sbGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUucXVlcnlTZWxlY3RvckFsbCgndGJvZHkgPiB0ciA+IHRkOmZpcnN0LWNoaWxkJykuZm9yRWFjaCgoaXRlbTogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaXRlbS5xdWVyeVNlbGVjdG9yKFwiYTpmaXJzdC1jaGlsZFwiKSBhcyBIVE1MRWxlbWVudCkuc3R5bGUubWF4V2lkdGggPSBgJHtNYXRoLm1heChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMyAqIHRoaXMudGFibGVGb250U2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJzdENvbGxXaWR0aCAtIHRoaXMudGFibGVGb250U2l6ZSAtIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1weGA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YWJsZUNvbnRhaW5lci5yZW1vdmVDbGFzcyhcInNjcm9sbGVkXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSA+IHRyID4gdGQ6Zmlyc3QtY2hpbGQnKS5mb3JFYWNoKChpdGVtOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpdGVtLnF1ZXJ5U2VsZWN0b3IoXCJhOmZpcnN0LWNoaWxkXCIpIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5tYXhXaWR0aCA9IFwiMTAwJVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBkdkFwaS5leGVjdXRlSnModGhpcy5idWlsZER2SlNSZW5kZXJpbmcoKSwgdGhpcy50YWJsZUNvbnRhaW5lciwgdGhpcy5wbHVnaW4sIHRoaXMuZmlsZUNsYXNzLmdldENsYXNzRmlsZSgpLnBhdGgpXG4gICAgICAgIH1cbiAgICAgICAgLy8gbGlua3MgYXJlbid0IGNsaWNrYWJsZSBhbnltb3JlLCByZWJpbmRpbmcgdGhlbSB0byBjbGljayBldmVudFxuICAgICAgICB0aGlzLmFkZENsaWNrRXZlbnRUb0xpbmsoKVxuICAgIH1cblxuICAgIHByaXZhdGUgYWRkQ2xpY2tFdmVudFRvTGluaygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcImEuaW50ZXJuYWwtbGlua1wiKVxuICAgICAgICAgICAgLmZvckVhY2goKGxpbms6IEhUTUxMaW5rRWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KFxuICAgICAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgbGluay5nZXRBdHRyKFwiZGF0YS1ocmVmXCIpLnNwbGl0KFwiL1wiKS5sYXN0KCk/LnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzcy5nZXRDbGFzc0ZpbGUoKS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAndGFiJ1xuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRQYWdpbmF0aW9uQ29tcG9uZW50KGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29udGFpbmVyLnJlcGxhY2VDaGlsZHJlbigpO1xuXG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gKG5ldyBGdW5jdGlvbihcImR2XCIsIFwiY3VycmVudFwiLCBgcmV0dXJuICR7dGhpcy5idWlsZER2SlNRdWVyeSgpfWApKShkdkFwaSkudmFsdWVzO1xuICAgICAgICAgICAgY29uc3QgY291bnQgPSB2YWx1ZXMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gTWF0aC5mbG9vcihjb3VudCAvIHRoaXMubGltaXQpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoaSAqIHRoaXMubGltaXQgPCBjb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByYW5nZUNvbXBvbmVudCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiBgcmFuZ2UgJHtpID09PSB0aGlzLnNsaWNlU3RhcnQgLyB0aGlzLmxpbWl0ID8gXCJhY3RpdmVcIiA6IFwiXCJ9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGAke2kgKiB0aGlzLmxpbWl0ICsgMX0gLSAke01hdGgubWluKChpICsgMSkgKiB0aGlzLmxpbWl0LCBjb3VudCl9YFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICByYW5nZUNvbXBvbmVudC5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zbGljZVN0YXJ0ID0gaSAqIHRoaXMubGltaXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVkcGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFBhZ2luYXRpb25NYW5hZ2VyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5idWlsZFBhZ2luYXRpb25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkTGltaXRNYW5hZ2VyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29udGFpbmVyLnJlcGxhY2VDaGlsZHJlbigpO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJSZXN1bHRzIHBlciBwYWdlOiBcIiwgY2xzOiBcImxhYmVsXCIgfSlcbiAgICAgICAgY29uc3QgbGltaXRJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lcilcbiAgICAgICAgbGltaXRJbnB1dC5zZXRWYWx1ZShgJHt0aGlzLmxpbWl0fWApXG4gICAgICAgIGxpbWl0SW5wdXQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxpbWl0ID0gcGFyc2VJbnQodmFsdWUpIHx8IHRoaXMubGltaXQ7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hCdXR0b24uc2V0Q3RhKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSB0b2dnbGVCdG5TdGF0ZShuYW1lOiBzdHJpbmcsIGRpcmVjdGlvbjogJ2FzYycgfCAnZGVzYycpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYnRuTmFtZSA9IGAke25hbWV9X18ke2RpcmVjdGlvbn1gO1xuICAgICAgICBjb25zdCBvcHBvc2l0ZUJ0bk5hbWUgPSBgJHtuYW1lfV9fJHtvcHBvc2l0ZURpcmVjdGlvbltkaXJlY3Rpb25dfWBcbiAgICAgICAgY29uc3QgeyBidG4sIGFjdGl2ZSB9ID0gdGhpcy5zb3J0ZXJzW2J0bk5hbWVdXG4gICAgICAgIGNvbnN0IHsgYnRuOiBvcHBCdG4gfSA9IHRoaXMuc29ydGVyc1tvcHBvc2l0ZUJ0bk5hbWVdXG4gICAgICAgIGlmIChhY3RpdmUpIHtcbiAgICAgICAgICAgIGJ0bi5idXR0b25FbC5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgIHRoaXMuc29ydGVyc1tidG5OYW1lXS5hY3RpdmUgPSBmYWxzZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnRuLnNldENsYXNzKFwiYWN0aXZlXCIpXG4gICAgICAgICAgICBvcHBCdG4uYnV0dG9uRWwucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB0aGlzLnNvcnRlcnNbYnRuTmFtZV0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuc29ydGVyc1tvcHBvc2l0ZUJ0bk5hbWVdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFNvcnRCdG4obmFtZTogc3RyaW5nLCBkaXJlY3Rpb246ICdhc2MnIHwgJ2Rlc2MnLCBjb21wb25lbnQ6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoY29tcG9uZW50KTtcbiAgICAgICAgYnRuLnNldEljb24oZGlyZWN0aW9uID09PSAnYXNjJyA/IFwiY2hldnJvbi11cFwiIDogXCJjaGV2cm9uLWRvd25cIik7XG4gICAgICAgIHRoaXMuc29ydGVyc1tgJHtuYW1lfV9fJHtkaXJlY3Rpb259YF0gPSB7IGJ0bjogYnRuLCBhY3RpdmU6IGZhbHNlLCBuYW1lOiBuYW1lLCBkaXJlY3Rpb246IGRpcmVjdGlvbiB9XG4gICAgICAgIGJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnRuU3RhdGUobmFtZSwgZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMudWRwYXRlKClcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkRmllbGROYW1lQW5kU29ydENvbXBvbmVudChuYW1lOiBzdHJpbmcsIGxhYmVsOiBzdHJpbmcsIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGROYW1lQW5kU29ydENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtaGVhZGVyXCIgfSk7XG4gICAgICAgIHRoaXMuYnVpbGRTb3J0QnRuKG5hbWUsICdhc2MnLCBmaWVsZE5hbWVBbmRTb3J0Q29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5idWlsZFNvcnRCdG4obmFtZSwgJ2Rlc2MnLCBmaWVsZE5hbWVBbmRTb3J0Q29udGFpbmVyKTtcbiAgICAgICAgZmllbGROYW1lQW5kU29ydENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBsYWJlbCwgY2xzOiBcImZpZWxkLW5hbWVcIiB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRGaWx0ZXJDb21wb25lbnQobmFtZTogc3RyaW5nLCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkRmlsdGVyQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWx0ZXItaW5wdXRcIiB9KTtcbiAgICAgICAgY29uc3QgZmlsdGVyID0gbmV3IFRleHRDb21wb25lbnQoZmllbGRGaWx0ZXJDb250YWluZXIpO1xuICAgICAgICBmaWx0ZXIuc2V0VmFsdWUoXCJcIik7XG4gICAgICAgIGZpbHRlci5vbkNoYW5nZSgoKSA9PiB0aGlzLnJlZnJlc2hCdXR0b24uc2V0Q3RhKCkpO1xuICAgICAgICB0aGlzLmZpbHRlcnNbbmFtZV0gPSBmaWx0ZXI7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZEZpbHRlcnNBbmRTb3J0TWFuYWdlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICB0aGlzLmJ1aWxkRmllbGROYW1lQW5kU29ydENvbXBvbmVudChcImZpbGVcIiwgXCJGaWxlIG5hbWVcIiwgZmllbGRDb250YWluZXIpXG4gICAgICAgIHRoaXMuYnVpbGRGaWx0ZXJDb21wb25lbnQoXCJmaWxlXCIsIGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQodGhpcy5maWxlQ2xhc3MubmFtZSkgfHwgW107XG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICAgICAgdGhpcy5idWlsZEZpZWxkTmFtZUFuZFNvcnRDb21wb25lbnQoZmllbGQubmFtZSwgZmllbGQubmFtZSwgZmllbGRDb250YWluZXIpXG4gICAgICAgICAgICB0aGlzLmJ1aWxkRmlsdGVyQ29tcG9uZW50KGZpZWxkLm5hbWUsIGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFJlZnJlc2hNYW5hZ2VyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYnRuQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjZWxsXCIgfSlcbiAgICAgICAgdGhpcy5yZWZyZXNoQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidG5Db250YWluZXIpO1xuICAgICAgICB0aGlzLnJlZnJlc2hCdXR0b24uc2V0SWNvbihcInJlZnJlc2gtY2N3XCIpO1xuICAgICAgICB0aGlzLnJlZnJlc2hCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnVkcGF0ZSgpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZENsZWFuRmlsdGVycyhjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGJ0bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY2VsbFwiIH0pXG4gICAgICAgIGNvbnN0IGNsZWFuRmlsdGVyQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidG5Db250YWluZXIpO1xuICAgICAgICBjbGVhbkZpbHRlckJ0bi5zZXRJY29uKFwiZXJhc2VyXCIpO1xuICAgICAgICBjbGVhbkZpbHRlckJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5maWx0ZXJzKS5mb3JFYWNoKGZpbHRlciA9PiBmaWx0ZXIuc2V0VmFsdWUoXCJcIikpXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hCdXR0b24uc2V0Q3RhKClcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkRmlsdGVyUXVlcnkoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHRoaXMuZmlsdGVycykubWFwKChbZmllbGROYW1lLCBpbnB1dF0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZmllbGROYW1lID09PSBcImZpbGVcIiA/IGBwLmZpbGUubmFtZWAgOiBgcFtcIiR7ZmllbGROYW1lfVwiXWBcbiAgICAgICAgICAgIGlmIChpbnB1dC5nZXRWYWx1ZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAgICAgLmZpbHRlcihwID0+ICR7ZmllbGR9ICYmICR7ZmllbGR9LnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIiR7aW5wdXQuZ2V0VmFsdWUoKX1cIi50b0xvd2VyQ2FzZSgpKSlcXG5gXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmpvaW4oXCJcIilcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkU29ydGVyUXVlcnkoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHRoaXMuc29ydGVycykubWFwKChbZmllbGRTb3J0ZXIsIHsgYnRuLCBhY3RpdmUsIGRpcmVjdGlvbiwgbmFtZSB9XSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmllbGRLZXkgPSBuYW1lID09PSBcImZpbGVcIiA/IFwicC5maWxlLm5hbWVcIiA6IGBwW1wiJHtuYW1lfVwiXWBcbiAgICAgICAgICAgIGlmIChhY3RpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYCAgICAuc29ydChwID0+ICR7ZmllbGRLZXl9LCBcIiR7ZGlyZWN0aW9ufVwiKVxcbmBcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkuam9pbihcIlwiKVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGREdkpTUXVlcnkoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgdGFnc01hcHBlZFRvRmlsZUNsYXNzOiBzdHJpbmdbXSA9IFtdXG4gICAgICAgIHRoaXMucGx1Z2luLmZpZWxkSW5kZXgudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMuZm9yRWFjaCgoY2xzLCB0YWcpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpbGVDbGFzcy5uYW1lID09PSBjbHMubmFtZSkge1xuICAgICAgICAgICAgICAgIHRhZ3NNYXBwZWRUb0ZpbGVDbGFzcy5wdXNoKCcjJyArIHRhZylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICBsZXQgZHZRdWVyeSA9IFwiXCI7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXNcbiAgICAgICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgICAgICBjb25zdCB0ZW1wbGF0ZXNGb2xkZXIgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1widGVtcGxhdGVyLW9ic2lkaWFuXCJdPy5zZXR0aW5nc1tcInRlbXBsYXRlc19mb2xkZXJcIl07XG4gICAgICAgIGR2UXVlcnkgKz0gYGR2LnBhZ2VzKClcXG5gO1xuICAgICAgICBkdlF1ZXJ5ICs9IGAgICAgLndoZXJlKHAgPT5cXG5cbiAgICAgICAgKFxcblxuICAgICAgICAgICAgKHR5cGVvZihwWycke2ZpbGVDbGFzc0FsaWFzfSddKSA9PT0gJ3N0cmluZycgJiYgcFsnJHtmaWxlQ2xhc3NBbGlhc30nXSA9PT0gJyR7dGhpcy5maWxlQ2xhc3MubmFtZX0nKVxcblxuICAgICAgICAgICAgfHwgKEFycmF5LmlzQXJyYXkocFsnJHtmaWxlQ2xhc3NBbGlhc30nXSkgJiYgcFsnJHtmaWxlQ2xhc3NBbGlhc30nXS5pbmNsdWRlcygnJHt0aGlzLmZpbGVDbGFzcy5uYW1lfScpKVxcblxuICAgICAgICAgICAgfHwgcC5maWxlLmV0YWdzLnZhbHVlcy5zb21lKGV0ID0+ICR7SlNPTi5zdHJpbmdpZnkodGFnc01hcHBlZFRvRmlsZUNsYXNzKX0uc29tZSh0ID0+IGV0LnN0YXJ0c1dpdGgodCkpKVxcblxuICAgICAgICApXFxuXG4gICAgICAgICR7ISFjbGFzc0ZpbGVzUGF0aCA/IFwiICAgICAgICAmJiAhcC5maWxlLnBhdGguaW5jbHVkZXMoJ1wiICsgY2xhc3NGaWxlc1BhdGggKyBcIicpXFxuXCIgOiBcIlwifVxuICAgICAgICAke3RlbXBsYXRlc0ZvbGRlciA/IFwiICAgICAgICAmJiAhcC5maWxlLnBhdGguaW5jbHVkZXMoJ1wiICsgdGVtcGxhdGVzRm9sZGVyICsgXCInKVxcblwiIDogXCJcIn1cbiAgICAgICAgKVxcbmA7XG4gICAgICAgIGR2UXVlcnkgKz0gdGhpcy5idWlsZEZpbHRlclF1ZXJ5KCk7XG4gICAgICAgIHJldHVybiBkdlF1ZXJ5O1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGREdkpTUmVuZGVyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZUNsYXNzLm5hbWUpIHx8IFtdXG4gICAgICAgIGxldCBkdkpTID0gXCJjb25zdCB7ZmllbGRNb2RpZmllcjogZn0gPSB0aGlzLmFwcC5wbHVnaW5zLnBsdWdpbnNbXFxcIm1ldGFkYXRhLW1lbnVcXFwiXS5hcGk7XFxuXCIgK1xuICAgICAgICAgICAgXCJkdi50YWJsZShbXFxcIkZpbGVcXFwiLFwiO1xuICAgICAgICBkdkpTICs9IGZpZWxkcy5tYXAoZmllbGQgPT4gYFwiJHtmaWVsZC5uYW1lfVwiYCkuam9pbihcIixcIik7XG4gICAgICAgIGR2SlMgKz0gYF0sIFxcbmA7XG4gICAgICAgIGR2SlMgKz0gdGhpcy5idWlsZER2SlNRdWVyeSgpO1xuICAgICAgICBkdkpTICs9IHRoaXMuYnVpbGRTb3J0ZXJRdWVyeSgpO1xuICAgICAgICBkdkpTICs9IGAgICAgLnNsaWNlKCR7dGhpcy5zbGljZVN0YXJ0fSwgJHt0aGlzLnNsaWNlU3RhcnQgKyB0aGlzLmxpbWl0fSlcXG5gO1xuICAgICAgICBkdkpTICs9IFwiICAgIC5tYXAocCA9PiBbXFxuICAgICAgICBkdi5lbChcXFwic3BhblxcXCIsIHAuZmlsZS5saW5rLCB7Y2xzOiBcXFwiZmllbGQtbmFtZVxcXCJ9KSxcXG5cIjtcbiAgICAgICAgZHZKUyArPSBmaWVsZHMubWFwKGZpZWxkID0+IGAgICAgICAgIGYoZHYsIHAsIFwiJHtmaWVsZC5uYW1lfVwiLCB7b3B0aW9uczoge2Fsd2F5c09uOiBmYWxzZSwgc2hvd0FkZEZpZWxkOiB0cnVlfX0pYCkuam9pbihcIixcXG5cIik7XG4gICAgICAgIGR2SlMgKz0gXCIgICAgXFxuXSlcIjtcbiAgICAgICAgZHZKUyArPSBcIlxcbik7XCJcbiAgICAgICAgcmV0dXJuIGR2SlNcblxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NNYW5hZ2VyIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvZmlsZUNsYXNzTWFuYWdlclwiO1xuaW1wb3J0IHsgRklMRUNMQVNTX1ZJRVdfVFlQRSB9IGZyb20gXCIuL2ZpbGVDbGFzc1ZpZXdcIjtcblxuZXhwb3J0IGNsYXNzIEZpbGVDbGFzc0Nob2ljZU1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZUNsYXNzTWFuYWdlcjogRmlsZUNsYXNzTWFuYWdlcixcbiAgICAgICAgcHJpdmF0ZSB0YWdzQW5kRmlsZUNsYXNzZXM6IHN0cmluZ1tdXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKTtcbiAgICB9O1xuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4O1xuICAgICAgICBjb25zdCB2YWx1ZXM6IHN0cmluZ1tdID0gWy4uLm5ldyBTZXQoXG4gICAgICAgICAgICBbLi4uaW5kZXguZmlsZUNsYXNzZXNOYW1lLmtleXMoKSwgLi4uaW5kZXgudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMua2V5cygpXVxuICAgICAgICApXVxuICAgICAgICAgICAgLmZpbHRlcihuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSlcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLmxvY2FsZUNvbXBhcmUoYikpXG4gICAgICAgIGlmICh0aGlzLnRhZ3NBbmRGaWxlQ2xhc3Nlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXMuZmlsdGVyKHZhbHVlID0+IHRoaXMudGFnc0FuZEZpbGVDbGFzc2VzLmluY2x1ZGVzKHZhbHVlKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXNcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLnNldFRleHQodmFsdWUpXG4gICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY29udGFpbmVyXCIpO1xuICAgIH1cblxuICAgIGFzeW5jIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4O1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBpbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGl0ZW0pIHx8IGluZGV4LnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzLmdldChpdGVtKVxuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZmlsZUNsYXNzICYmIGR2QXBpKSB7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc01hbmFnZXIubmFtZSA9IGl0ZW1cbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzTWFuYWdlci5maWxlQ2xhc3MgPSBmaWxlQ2xhc3NcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzTWFuYWdlci5maWxlQ2xhc3NWaWV3VHlwZSA9IEZJTEVDTEFTU19WSUVXX1RZUEUgKyBcIl9fXCIgKyBmaWxlQ2xhc3MubmFtZVxuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NNYW5hZ2VyLm9wZW5GaWxlQ2xhc3NWaWV3KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIEZ1enp5TWF0Y2gsIEZ1enp5U3VnZ2VzdE1vZGFsLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmludGVyZmFjZSBPcHRpb24ge1xuICAgIGlkOiBzdHJpbmcsXG4gICAgYWN0aW9uTGFiZWw6IHN0cmluZyxcbiAgICBhY3Rpb246IGFueSxcbiAgICBpY29uPzogc3RyaW5nXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPE9wdGlvbj4ge1xuICAgIHB1YmxpYyBvcHRpb25zOiBPcHRpb25bXSA9IFtdXG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKTtcbiAgICB9XG5cbiAgICBnZXRJdGVtcygpOiBPcHRpb25bXSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBPcHRpb24pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaXRlbS5hY3Rpb25MYWJlbFxuICAgIH1cblxuICAgIG9uQ2hvb3NlSXRlbShpdGVtOiBPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaXRlbS5hY3Rpb24oKTtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IEZ1enp5TWF0Y2g8T3B0aW9uPiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY29udGFpbmVyXCIpO1xuICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tY29udGFpbmVyXCIgfSlcbiAgICAgICAgaXRlbS5pdGVtLmljb24gPyBzZXRJY29uKGljb25Db250YWluZXIsIGl0ZW0uaXRlbS5pY29uKSA6IHNldEljb24oaWNvbkNvbnRhaW5lciwgXCJwZW5jaWxcIilcbiAgICAgICAgY29uc3QgYWN0aW9uTGFiZWwgPSBlbC5jcmVhdGVEaXYoKVxuICAgICAgICBhY3Rpb25MYWJlbC5pbm5lckhUTUwgPSBpdGVtLml0ZW0uYWN0aW9uTGFiZWxcbiAgICB9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBOb3RpY2UsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRNaXNzaW5nRmllbGRzXCI7XG5pbXBvcnQgeyBwb3N0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9wb3N0VmFsdWVzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NNYW5hZ2VyIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL2ZpbGVDbGFzc01hbmFnZXJcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsXCI7XG5pbXBvcnQgY2hvb3NlU2VjdGlvbk1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbFwiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcIi4vRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5cbmZ1bmN0aW9uIGlzTWVudShsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpOiBsb2NhdGlvbiBpcyBNZW51IHtcbiAgICByZXR1cm4gKGxvY2F0aW9uIGFzIE1lbnUpLmFkZEl0ZW0gIT09IHVuZGVmaW5lZDtcbn07XG5cbmZ1bmN0aW9uIGlzSW5zZXJ0RmllbGRDb21tYW5kKGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk6IGxvY2F0aW9uIGlzIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIge1xuICAgIHJldHVybiAobG9jYXRpb24gYXMgc3RyaW5nKSA9PT0gXCJJbnNlcnRGaWVsZENvbW1hbmRcIjtcbn1cblxuZnVuY3Rpb24gaXNTdWdnZXN0KGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk6IGxvY2F0aW9uIGlzIEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB7XG4gICAgcmV0dXJuIChsb2NhdGlvbiBhcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpLmdldEl0ZW1zICE9PSB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NPcHRpb25zTGlzdCB7XG5cbiAgICAvLyBhZGRzIG9wdGlvbnMgdG8gY29udGV4dCBtZW51IG9yIHRvIGEgZHJvcGRvd24gbW9kYWwgdHJpZ2dlciB3aXRoIFwiRmllbGQ6IE9wdGlvbnNcIiBjb21tYW5kIGluIGNvbW1hbmQgcGFsbGV0dGVcbiAgICBwcml2YXRlIGZpbGVDbGFzczogRmlsZUNsYXNzIHwgdW5kZWZpbmVkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgbG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsLFxuICAgICAgICBwcml2YXRlIGZyb21GaWxlPzogVEZpbGVcbiAgICApIHtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzUGF0aC5nZXQodGhpcy5maWxlLnBhdGgpXG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVFeHRyYU9wdGlvbkxpc3Qob3BlbkFmdGVyQ3JlYXRlOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuICAgICAgICBjb25zdCBtYXBXaXRoVGFnQWN0aW9uID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcG9zdFZhbHVlcyh0aGlzLnBsdWdpbiwgW3sgbmFtZTogXCJtYXBXaXRoVGFnXCIsIHBheWxvYWQ6IHsgdmFsdWU6IFwidHJ1ZVwiIH0gfV0sIHRoaXMuZmlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3BlbkZpbGVDbGFzc1RhYmxlVmlld0FjdGlvbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0NvbXBvbmVudCA9IG5ldyBGaWxlQ2xhc3NNYW5hZ2VyKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MpXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hZGRDaGlsZChmaWxlQ2xhc3NDb21wb25lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHsgdGhpcy5sb2NhdGlvbi5hZGRTZXBhcmF0b3IoKTsgfTtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy5maWxlQ2xhc3NcbiAgICAgICAgY29uc3QgY3VycmVudEZpZWxkc05hbWVzOiBzdHJpbmdbXSA9IFtdXG4gICAgICAgIGxldCBhZGRNaXNzaW5nRmllbGRzQWN0aW9uID0gKCkgPT4geyBuZXcgTm90aWNlKFwiU29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSBjaGVjayB5b3VyIGZpbGVDbGFzcyBkZWZpbml0aW9uc1wiKSB9XG4gICAgICAgIGlmICh0aGlzLmZyb21GaWxlKSB7XG4gICAgICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZyb21GaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChkdkZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpZWxkc05hbWVzLnB1c2goLi4uZ2VudWluZUtleXMoZHZGaWxlKSlcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZyb21GaWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICAgICApID0+IGluc2VydE1pc3NpbmdGaWVsZHMoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHZGaWxlLmZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzPy5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGFkZE1pc3NpbmdGaWVsZHNBY3Rpb24gPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtaXNzaW5nRmllbGRzID0gZmlsZUNsYXNzICYmIHRoaXMuZnJvbUZpbGUgP1xuICAgICAgICAgICAgIXRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVDbGFzcy5uYW1lKT8ubWFwKGYgPT4gZi5uYW1lKS5ldmVyeShmaWVsZE5hbWUgPT4gY3VycmVudEZpZWxkc05hbWVzLmluY2x1ZGVzKGZpZWxkTmFtZSkpIDpcbiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgIGlmIChpc0luc2VydEZpZWxkQ29tbWFuZCh0aGlzLmxvY2F0aW9uKSAmJiBmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MpO1xuICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGBkaXNwbGF5X3RhYmxlX3ZpZXdfZm9yXyR7ZmlsZUNsYXNzLm5hbWUucmVwbGFjZShcIi9cIiwgXCJfXCIpfWAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgRGlzcGxheSAke2ZpbGVDbGFzcy5uYW1lfSB0YWJsZSB2aWV3YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBvcGVuRmlsZUNsYXNzVGFibGVWaWV3QWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBcImZpbGUtc3ByZWFkc2hlZXRcIlxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmICFmaWxlQ2xhc3MuaXNNYXBwZWRXaXRoVGFnKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBcIm1hcF9maWxlQ2xhc3Nfd2l0aF90YWdcIixcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5NYXAgPGI+JHtmaWxlQ2xhc3MubmFtZX08L2I+IHdpdGggdGFnIG9mIHNhbWUgbmFtZTwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IG1hcFdpdGhUYWdBY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiaGFzaFwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIG1pc3NpbmdGaWVsZHMgJiYgdGhpcy5mcm9tRmlsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGBpbnNlcnRfbWlzc2lnX2ZpZWxkc19mcm9tXyR7ZmlsZUNsYXNzLm5hbWUucmVwbGFjZShcIi9cIiwgXCJfXCIpfWAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+SW5zZXJ0IG1pc3NpbmcgZmllbGRzIGZyb20gPGI+JHtmaWxlQ2xhc3MubmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogYWRkTWlzc2luZ0ZpZWxkc0FjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJiYXR0ZXJ5LWZ1bGxcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuXG5cbiAgICAgICAgICAgIGlmIChvcGVuQWZ0ZXJDcmVhdGUpIHRoaXMubG9jYXRpb24ub3BlbigpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBEaXNwbGF5ICR7ZmlsZUNsYXNzLm5hbWV9IHRhYmxlIHZpZXdgKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKG9wZW5GaWxlQ2xhc3NUYWJsZVZpZXdBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJmaWxlLXNwcmVhZHNoZWV0XCIpO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7ZmlsZUNsYXNzLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcyAmJiAhZmlsZUNsYXNzLmlzTWFwcGVkV2l0aFRhZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYE1hcCAke2ZpbGVDbGFzcy5uYW1lfSB3aXRoIHRhZ2ApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJoYXNoXCIpO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2sobWFwV2l0aFRhZ0FjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHtmaWxlQ2xhc3MubmFtZX0uZmlsZWNsYXNzLWZpZWxkc2ApO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIG1pc3NpbmdGaWVsZHMgJiYgdGhpcy5mcm9tRmlsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBJbnNlcnQgbWlzc2luZyBmaWVsZHMgZnJvbSAke2ZpbGVDbGFzcy5uYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJiYXR0ZXJ5LWZ1bGxcIik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhZGRNaXNzaW5nRmllbGRzQWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKGBtZXRhZGF0YS1tZW51LWZpbGVjbGFzcy4ke2ZpbGVDbGFzcy5uYW1lfS5maWxlY2xhc3MtZmllbGRzYCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYnVpbGRGaWVsZE9wdGlvbnMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRGaWVsZE9wdGlvbnNcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRGaWVsZE9wdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzPy5hdHRyaWJ1dGVzLmZvckVhY2goKGF0dHI6IEZpbGVDbGFzc0F0dHJpYnV0ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZUNsYXNzISwgYXR0cilcbiAgICAgICAgICAgIGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgJHt0aGlzLmZpbGVDbGFzcyEubmFtZX0gLSAke2F0dHIubmFtZX1gKVxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJ3cmVuY2hcIilcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7dGhpcy5maWxlQ2xhc3MhLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHthdHRyLm5hbWV9YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj4ke2F0dHIubmFtZX08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiZ2VhclwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MhKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpO1xuICAgICAgICBpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pICYmIHRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKFwiQWRkIG5ldyBmaWVsZFwiKVxuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcInBsdXMtY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbilcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7dGhpcy5maWxlQ2xhc3MhLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikgJiYgdGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogXCJhZGRfZmlsZUNsYXNzX2F0dHJpYnV0ZVwiLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+SW5zZXJ0IGFuIGF0dHJpYnV0ZSBmb3IgPGI+JHt0aGlzLmZpbGVDbGFzcy5uYW1lfTwvYj4gZmlsZUNsYXNzPC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogXCJwbHVzLWNpcmNsZVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufTtcbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIE1lbnUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRNaXNzaW5nRmllbGRzXCI7XG5pbXBvcnQgTm90ZUZpZWxkc0NvbXBvbmVudCBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IEJvb2xlYW5GaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Jvb2xlYW5GaWVsZFwiO1xuaW1wb3J0IEN5Y2xlRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9DeWNsZUZpZWxkXCI7XG5pbXBvcnQgTWFuYWdlcnMgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vyc1wiO1xuaW1wb3J0IHsgQWRkRmlsZUNsYXNzVG9GaWxlTW9kYWwgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCBBZGROZXdGaWxlQ2xhc3NNb2RhbCBmcm9tIFwic3JjL21vZGFscy9hZGROZXdGaWxlQ2xhc3NNb2RhbFwiO1xuaW1wb3J0IElucHV0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL0lucHV0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5pbXBvcnQgY2hvb3NlU2VjdGlvbk1vZGFsIGZyb20gXCIuLi9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCIuL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IEZpbGVDbGFzc09wdGlvbnNMaXN0IGZyb20gXCIuL0ZpbGVDbGFzc09wdGlvbnNMaXN0XCI7XG5cbmZ1bmN0aW9uIGlzTWVudShsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKTogbG9jYXRpb24gaXMgTWVudSB7XG5cdHJldHVybiAobG9jYXRpb24gYXMgTWVudSkuYWRkSXRlbSAhPT0gdW5kZWZpbmVkO1xufTtcblxuZnVuY3Rpb24gaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgXCJNYW5hZ2VBdEN1cnNvckNvbW1hbmRcIik6IGxvY2F0aW9uIGlzIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIge1xuXHRyZXR1cm4gKGxvY2F0aW9uIGFzIHN0cmluZykgPT09IFwiSW5zZXJ0RmllbGRDb21tYW5kXCI7XG59XG5cbmZ1bmN0aW9uIGlzU3VnZ2VzdChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKTogbG9jYXRpb24gaXMgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHtcblx0cmV0dXJuIChsb2NhdGlvbiBhcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpLmdldEl0ZW1zICE9PSB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPcHRpb25zTGlzdCB7XG5cblx0Ly8gYWRkcyBvcHRpb25zIHRvIGNvbnRleHQgbWVudSBvciB0byBhIGRyb3Bkb3duIG1vZGFsIHRyaWdnZXIgd2l0aCBcIkZpZWxkOiBPcHRpb25zXCIgY29tbWFuZCBpbiBjb21tYW5kIHBhbGxldHRlXG5cdHBhdGg6IHN0cmluZztcblx0YXR0cmlidXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblx0ZmllbGRzRnJvbUluZGV4OiBSZWNvcmQ8c3RyaW5nLCBGaWVsZD4gPSB7fTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuXHRcdHByaXZhdGUgZmlsZTogVEZpbGUsXG5cdFx0cHJpdmF0ZSBsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiLFxuXHRcdHByaXZhdGUgaW5jbHVkZWRGaWVsZHM/OiBzdHJpbmdbXVxuXHQpIHtcblx0XHR0aGlzLmZpbGUgPSBmaWxlO1xuXHRcdHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcblx0XHR0aGlzLmF0dHJpYnV0ZXMgPSB7fTtcblx0XHR0aGlzLmluY2x1ZGVkRmllbGRzID0gaW5jbHVkZWRGaWVsZHMgPyBbdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMsIC4uLmluY2x1ZGVkRmllbGRzXSA6IFt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc107XG5cdFx0dGhpcy5nZXRGaWVsZHNGcm9tSW5kZXgoKTtcblx0XHR0aGlzLmdldEZpZWxkc1ZhbHVlcygpO1xuXHR9O1xuXG5cdHByaXZhdGUgZ2V0RmllbGRzVmFsdWVzKCk6IHZvaWQge1xuXHRcdGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcblx0XHQvL0B0cy1pZ25vcmVcblx0XHRpZiAoZHZBcGkpIHtcblx0XHRcdGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRnZW51aW5lS2V5cyhkdkZpbGUpLmZvckVhY2goa2V5ID0+IHRoaXMuYWRkQXR0cmlidXRlKGtleSwgZHZGaWxlW2tleV0pKVxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0dGhyb3cgKGVycm9yKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFkZEF0dHJpYnV0ZShrZXk6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xuXHRcdGNvbnN0IGluY2x1ZGVkRmllbGRzID0gdGhpcy5pbmNsdWRlZEZpZWxkcyEuZmlsdGVyKGYgPT4gZiAhPT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMpXG5cdFx0aWYgKGluY2x1ZGVkRmllbGRzLmxlbmd0aCA+IDApIHtcblx0XHRcdGlmIChcblx0XHRcdFx0dGhpcy5pbmNsdWRlZEZpZWxkcyEuaW5jbHVkZXMoa2V5KVxuXHRcdFx0XHQmJlxuXHRcdFx0XHQhdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzLmluY2x1ZGVzKGtleSlcblx0XHRcdCkge1xuXHRcdFx0XHR0aGlzLmF0dHJpYnV0ZXNba2V5XSA9IHZhbHVlXG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzLmluY2x1ZGVzKGtleSkpIHtcblx0XHRcdHRoaXMuYXR0cmlidXRlc1trZXldID0gdmFsdWVcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGdldEZpZWxkc0Zyb21JbmRleCgpOiB2b2lkIHtcblx0XHRjb25zdCBpbmRleCA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXhcblx0XHRjb25zdCBmaWVsZHMgPSBpbmRleC5maWxlc0ZpZWxkcy5nZXQodGhpcy5maWxlLnBhdGgpXG5cdFx0ZmllbGRzPy5mb3JFYWNoKGZpZWxkID0+IHRoaXMuZmllbGRzRnJvbUluZGV4W2ZpZWxkLm5hbWVdID0gZmllbGQpXG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmllbGROYW1lOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBmaWVsZCA9IHRoaXMuZmllbGRzRnJvbUluZGV4W2ZpZWxkTmFtZV1cblx0XHRpZiAoZmllbGQpIHtcblx0XHRcdGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIGZpZWxkKSBhcyBGO1xuXHRcdFx0c3dpdGNoIChmaWVsZE1hbmFnZXIudHlwZSkge1xuXHRcdFx0XHRjYXNlIEZpZWxkVHlwZS5Cb29sZWFuOlxuXHRcdFx0XHRcdChmaWVsZE1hbmFnZXIgYXMgQm9vbGVhbkZpZWxkKS50b2dnbGUoZmllbGQubmFtZSwgdGhpcy5hdHRyaWJ1dGVzW2ZpZWxkLm5hbWVdLCB0aGlzLmZpbGUpXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgRmllbGRUeXBlLkN5Y2xlOlxuXHRcdFx0XHRcdChmaWVsZE1hbmFnZXIgYXMgQ3ljbGVGaWVsZCkubmV4dChmaWVsZC5uYW1lLCB0aGlzLmF0dHJpYnV0ZXNbZmllbGQubmFtZV0sIHRoaXMuZmlsZSlcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRmaWVsZE1hbmFnZXIuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwodGhpcy5maWxlLCBmaWVsZC5uYW1lLCB0aGlzLmF0dHJpYnV0ZXNbZmllbGQubmFtZV0pXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgZGVmYXVsdEZpZWxkID0gbmV3IEZpZWxkKGZpZWxkTmFtZSlcblx0XHRcdGRlZmF1bHRGaWVsZC50eXBlID0gRmllbGRUeXBlLklucHV0XG5cdFx0XHRpZiAoZmllbGROYW1lID09PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcykge1xuXHRcdFx0XHR0aGlzLmJ1aWxkRmlsZUNsYXNzRmllbGRPcHRpb25zKGRlZmF1bHRGaWVsZCwgdGhpcy5hdHRyaWJ1dGVzW2ZpZWxkTmFtZV0pXG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMubG9jYXRpb24gPT09IFwiTWFuYWdlQXRDdXJzb3JDb21tYW5kXCIpIHtcblx0XHRcdFx0Y29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IE1hbmFnZXJzLklucHV0KHRoaXMucGx1Z2luLCBkZWZhdWx0RmllbGQpIGFzIEZcblx0XHRcdFx0KGZpZWxkTWFuYWdlciBhcyBGKS5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmZpbGUsIGZpZWxkTmFtZSwgdGhpcy5hdHRyaWJ1dGVzW2ZpZWxkTmFtZV0pXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHVibGljIGNyZWF0ZUV4dHJhT3B0aW9uTGlzdChvcGVuQWZ0ZXJDcmVhdGU6IGJvb2xlYW4gPSB0cnVlKTogdm9pZCB7XG5cdFx0Y29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcblx0XHRjb25zdCBsb2NhdGlvbiA9IHRoaXMubG9jYXRpb25cblx0XHRpZiAoaXNNZW51KGxvY2F0aW9uKSkgeyBsb2NhdGlvbi5hZGRTZXBhcmF0b3IoKTsgfTtcblx0XHRpZiAoaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTtcblx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdChsb2NhdGlvbikpIHtcblx0XHRcdHRoaXMub3Blbk5vdGVGaWVsZE1vZGFsT3B0aW9uKCk7XG5cdFx0XHR0aGlzLmJ1aWxkRmllbGRPcHRpb25zKCk7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRUaGVFbmRPZkZyb250bWF0dGVyT3B0aW9uKCk7XG5cdFx0XHRpZiAoZHZBcGkpIHtcblx0XHRcdFx0Y29uc3QgY3VycmVudEZpZWxkc05hbWVzID0gZ2VudWluZUtleXMoZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aCkpXG5cdFx0XHRcdGlmICghWy4uLnRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXV0ubWFwKGZpZWxkID0+IGZpZWxkLm5hbWUpLmV2ZXJ5KGZpZWxkTmFtZSA9PiBjdXJyZW50RmllbGRzTmFtZXMuaW5jbHVkZXMoZmllbGROYW1lKSkpIHtcblx0XHRcdFx0XHR0aGlzLmFkZEFsbE1pc3NpbmdGaWVsZHNBdFNlY3Rpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y29uc3QgZmlsZUNsYXNzZXMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXVxuXHRcdFx0ZmlsZUNsYXNzZXMuZm9yRWFjaChmaWxlQ2xhc3MgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgPSBuZXcgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKHRoaXMucGx1Z2luLmFwcClcblx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgRmlsZUNsYXNzT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIGZpbGVDbGFzcy5nZXRDbGFzc0ZpbGUoKSwgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsLCB0aGlzLmZpbGUpO1xuXHRcdFx0XHRvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoZmFsc2UpO1xuXHRcdFx0XHRsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuXHRcdFx0XHRcdGlkOiBcIm1hbmFnZV9maWxlQ2xhc3NfYXR0cmlidXRlc1wiLFxuXHRcdFx0XHRcdGFjdGlvbkxhYmVsOiBgPHNwYW4+TWFuYWdlIDxiPiR7ZmlsZUNsYXNzLm5hbWV9PC9iPiBmaWxlQ2xhc3MgZmllbGRzPC9zcGFuPmAsXG5cdFx0XHRcdFx0YWN0aW9uOiAoKSA9PiB7IGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbC5vcGVuKCkgfSxcblx0XHRcdFx0XHRpY29uOiBcIndyZW5jaFwiXG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXHRcdFx0dGhpcy5hZGRGaWxlQ2xhc3NUb0ZpbGVPcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkTmV3RmlsZUNsYXNzT3B0aW9uKCk7XG5cdFx0XHRpZiAob3BlbkFmdGVyQ3JlYXRlKSBsb2NhdGlvbi5vcGVuKCk7XG5cdFx0fSBlbHNlIGlmIChpc01lbnUobG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLm9wZW5Ob3RlRmllbGRNb2RhbE9wdGlvbigpO1xuXHRcdFx0dGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuXHRcdFx0dGhpcy5hZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkRmllbGRBdEN1cnJlbnRQb3NpdGlvbk9wdGlvbigpO1xuXHRcdFx0dGhpcy5hZGRGaWVsZEF0VGhlRW5kT2ZGcm9udG1hdHRlck9wdGlvbigpO1xuXHRcdFx0aWYgKGR2QXBpKSB7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWVsZHNOYW1lcyA9IGdlbnVpbmVLZXlzKGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpKVxuXHRcdFx0XHRpZiAoIVsuLi50aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldCh0aGlzLmZpbGUucGF0aCkgfHwgW11dLm1hcChmaWVsZCA9PiBmaWVsZC5uYW1lKS5ldmVyeShmaWVsZE5hbWUgPT4gY3VycmVudEZpZWxkc05hbWVzLmluY2x1ZGVzKGZpZWxkTmFtZSkpKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRBbGxNaXNzaW5nRmllbGRzQXRTZWN0aW9uKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGNvbnN0IGZpbGVDbGFzc2VzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzLmdldCh0aGlzLmZpbGUucGF0aCkgfHwgW11cblx0XHRcdGZpbGVDbGFzc2VzLmZvckVhY2goZmlsZUNsYXNzID0+IHtcblx0XHRcdFx0Y29uc3QgZmlsZUNsYXNzT3B0aW9uc0xpc3QgPSBuZXcgRmlsZUNsYXNzT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIGZpbGVDbGFzcy5nZXRDbGFzc0ZpbGUoKSwgbG9jYXRpb24sIHRoaXMuZmlsZSlcblx0XHRcdFx0ZmlsZUNsYXNzT3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KGZhbHNlKTtcblx0XHRcdH0pXG5cdFx0XHR0aGlzLmFkZEZpbGVDbGFzc1RvRmlsZU9wdGlvbigpO1xuXHRcdFx0dGhpcy5hZGROZXdGaWxlQ2xhc3NPcHRpb24oKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGJ1aWxkRmlsZUNsYXNzRmllbGRPcHRpb25zKGZpZWxkOiBGaWVsZCwgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IElucHV0TW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmllbGQsIHZhbHVlKTtcblx0XHRtb2RhbC50aXRsZUVsLnNldFRleHQoYENoYW5nZSBWYWx1ZSBmb3IgPCR7ZmllbGQubmFtZX0+YCk7XG5cdFx0aWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSAke2ZpZWxkLm5hbWV9YCk7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbihcIndyZW5jaFwiKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKCgpID0+IG1vZGFsLm9wZW4oKSk7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnVcIik7XG5cdFx0XHR9KVxuXHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdGlkOiBgdXBkYXRlXyR7ZmllbGQubmFtZX1gLFxuXHRcdFx0XHRhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke2ZpZWxkLm5hbWV9PC9iPjwvc3Bhbj5gLFxuXHRcdFx0XHRhY3Rpb246ICgpID0+IG1vZGFsLm9wZW4oKSxcblx0XHRcdFx0aWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5JbnB1dF1cblx0XHRcdH0pO1xuXHRcdH07XG5cdH1cblxuXG5cdHByaXZhdGUgb3Blbk5vdGVGaWVsZE1vZGFsT3B0aW9uKCk6IHZvaWQge1xuXHRcdGNvbnN0IGxhc3RGaWxlQ2xhc3NOYW1lID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KHRoaXMuZmlsZS5wYXRoKT8ubGFzdCgpXG5cdFx0aWYgKGxhc3RGaWxlQ2xhc3NOYW1lKSB7XG5cdFx0XHRjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQobGFzdEZpbGVDbGFzc05hbWUpXG5cdFx0XHRpZiAoZmlsZUNsYXNzKSB7XG5cdFx0XHRcdGNvbnN0IGljb24gPSBmaWxlQ2xhc3MuZ2V0SWNvbigpIHx8IFwiY2xpcGJvYXJkLWxpc3RcIlxuXHRcdFx0XHRjb25zdCBub3RlRmllbGRzQ29tcG9uZW50ID0gbmV3IE5vdGVGaWVsZHNDb21wb25lbnQodGhpcy5wbHVnaW4sIFwiMVwiLCAoKSA9PiB7IH0sIHRoaXMuZmlsZSlcblx0XHRcdFx0Y29uc3QgYWN0aW9uID0gKCkgPT4gdGhpcy5wbHVnaW4uYWRkQ2hpbGQobm90ZUZpZWxkc0NvbXBvbmVudCk7XG5cdFx0XHRcdGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYE9wZW4gZmllbGRzIG1vZGFsYCk7XG5cdFx0XHRcdFx0XHRpdGVtLnNldEljb24oaWNvbik7XG5cdFx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soYWN0aW9uKTtcblx0XHRcdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnVcIik7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0XHRpZDogYG9wZW5fZmllbGRzX21vZGFsYCxcblx0XHRcdFx0XHRcdGFjdGlvbkxhYmVsOiBgPHNwYW4+T3BlbiBmaWVsZHMgbW9kYWw8L3NwYW4+YCxcblx0XHRcdFx0XHRcdGFjdGlvbjogYWN0aW9uLFxuXHRcdFx0XHRcdFx0aWNvbjogaWNvblxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH1cblxuXHR9XG5cblx0cHJpdmF0ZSBidWlsZEZpZWxkT3B0aW9ucygpOiB2b2lkIHtcblx0XHRPYmplY3Qua2V5cyh0aGlzLmF0dHJpYnV0ZXMpLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB7XG5cdFx0XHRjb25zdCB2YWx1ZSA9IHRoaXMuYXR0cmlidXRlc1trZXldO1xuXHRcdFx0Y29uc3QgZmllbGQgPSB0aGlzLmZpZWxkc0Zyb21JbmRleFtrZXldXG5cblx0XHRcdGlmIChmaWVsZCkge1xuXHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCBmaWVsZCk7XG5cdFx0XHRcdGZpZWxkTWFuYWdlci5hZGRGaWVsZE9wdGlvbihrZXksIHZhbHVlLCB0aGlzLmZpbGUsIHRoaXMubG9jYXRpb24pO1xuXHRcdFx0fSBlbHNlIGlmIChrZXkgIT09IFwiZmlsZVwiICYmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikgfHwgaXNNZW51KHRoaXMubG9jYXRpb24pKSkge1xuXHRcdFx0XHRjb25zdCBkZWZhdWx0RmllbGQgPSBuZXcgRmllbGQoa2V5KVxuXHRcdFx0XHRkZWZhdWx0RmllbGQudHlwZSA9IEZpZWxkVHlwZS5JbnB1dFxuXHRcdFx0XHRpZiAoa2V5ID09PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcykge1xuXHRcdFx0XHRcdHRoaXMuYnVpbGRGaWxlQ2xhc3NGaWVsZE9wdGlvbnMoZGVmYXVsdEZpZWxkLCB2YWx1ZSlcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgTWFuYWdlcnMuSW5wdXQodGhpcy5wbHVnaW4sIGRlZmF1bHRGaWVsZClcblx0XHRcdFx0XHRmaWVsZE1hbmFnZXIuYWRkRmllbGRPcHRpb24oa2V5LCB2YWx1ZSB8fCBcIlwiLCB0aGlzLmZpbGUsIHRoaXMubG9jYXRpb24pXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuXHRcdFx0dGhpcy5wbHVnaW4sXG5cdFx0XHR0aGlzLmZpbGUsXG5cdFx0XHQoXG5cdFx0XHRcdGxpbmVOdW1iZXI6IG51bWJlcixcblx0XHRcdFx0YWZ0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdGFzTGlzdDogYm9vbGVhbixcblx0XHRcdFx0YXNDb21tZW50OiBib29sZWFuXG5cdFx0XHQpID0+IEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHR0aGlzLmZpbGUsXG5cdFx0XHRcdHVuZGVmaW5lZCxcblx0XHRcdFx0XCJcIixcblx0XHRcdFx0bGluZU51bWJlcixcblx0XHRcdFx0YWZ0ZXIsXG5cdFx0XHRcdGFzTGlzdCxcblx0XHRcdFx0YXNDb21tZW50XG5cdFx0XHQpXG5cdFx0KTtcblx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRJY29uKFwiZW50ZXJcIik7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgYXQgc2VjdGlvbi4uLlwiKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51XCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0aWQ6IFwiYWRkX2ZpZWxkX2F0X3NlY3Rpb25cIixcblx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIGZpZWxkIGF0IHNlY3Rpb24uLi5cIixcblx0XHRcdFx0YWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG5cdFx0XHRcdGljb246IFwiZW50ZXJcIlxuXHRcdFx0fSlcblx0XHR9O1xuXHR9O1xuXG5cdHByaXZhdGUgYWRkQWxsTWlzc2luZ0ZpZWxkc0F0U2VjdGlvbigpOiB2b2lkIHtcblx0XHRjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuXHRcdGlmIChkdkFwaSkge1xuXHRcdFx0Y29uc3QgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aCk7XG5cdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG5cdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHR0aGlzLmZpbGUsXG5cdFx0XHRcdChcblx0XHRcdFx0XHRsaW5lTnVtYmVyOiBudW1iZXIsXG5cdFx0XHRcdFx0YWZ0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdFx0YXNMaXN0OiBib29sZWFuLFxuXHRcdFx0XHRcdGFzQ29tbWVudDogYm9vbGVhblxuXHRcdFx0XHQpID0+IGluc2VydE1pc3NpbmdGaWVsZHMoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sXG5cdFx0XHRcdFx0ZHZGaWxlLmZpbGUucGF0aCxcblx0XHRcdFx0XHRsaW5lTnVtYmVyLFxuXHRcdFx0XHRcdGFmdGVyLFxuXHRcdFx0XHRcdGFzTGlzdCxcblx0XHRcdFx0XHRhc0NvbW1lbnRcblx0XHRcdFx0KVxuXHRcdFx0KTtcblx0XHRcdGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwiYmF0dGVyeS1mdWxsXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgbWlzc2luZyBmaWVsZHMgYXQgc2VjdGlvbi4uLlwiKTtcblx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnVcIik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuXHRcdFx0XHRcdGlkOiBcImFkZF9taXNzaW5nX2ZpZWxkc19hdF9zZWN0aW9uXCIsXG5cdFx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIG1pc3NpbmcgZmllbGRzIGF0IHNlY3Rpb24uLi5cIixcblx0XHRcdFx0XHRhY3Rpb246ICgpID0+IG1vZGFsLm9wZW4oKSxcblx0XHRcdFx0XHRpY29uOiBcImJhdHRlcnktZnVsbFwiXG5cdFx0XHRcdH0pXG5cdFx0XHR9O1xuXHRcdH1cblx0fTtcblxuXHRwcml2YXRlIGFkZEZpZWxkQXRUaGVFbmRPZkZyb250bWF0dGVyT3B0aW9uKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZSh0aGlzLmZpbGUucGF0aCk/LmZyb250bWF0dGVyKSB7XG5cdFx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcInBpblwiKTtcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiQWRkIGZpZWxkIGluIGZyb250bWF0dGVyXCIpO1xuXHRcdFx0XHRcdGl0ZW0ub25DbGljayhhc3luYyAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRGLm9wZW5GaWVsZE1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHVuZGVmaW5lZCwgXCJcIiwgLTEsIGZhbHNlLCBmYWxzZSwgZmFsc2UpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IFwiYWRkX2ZpZWxkX2luX2Zyb250bWF0dGVyXCIsXG5cdFx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIGEgZmllbGQgaW4gZnJvbnRtYXR0ZXIuLi5cIixcblx0XHRcdFx0XHRhY3Rpb246ICgpID0+IEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB1bmRlZmluZWQsIFwiXCIsIC0xLCBmYWxzZSwgZmFsc2UsIGZhbHNlKSxcblx0XHRcdFx0XHRpY29uOiBcInBpblwiXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhZGRGaWVsZEF0Q3VycmVudFBvc2l0aW9uT3B0aW9uKCk6IHZvaWQge1xuXHRcdGNvbnN0IGN1cnJlbnRWaWV3ID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcblx0XHRjb25zdCBjdXJyZW50TGluZU51bWJlciA9IGN1cnJlbnRWaWV3Py5lZGl0b3IuZ2V0Q3Vyc29yKCkubGluZTtcblx0XHRpZiAoY3VycmVudExpbmVOdW1iZXIgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmZpbGUucGF0aCA9PSBjdXJyZW50Vmlldz8uZmlsZS5wYXRoKSB7XG5cdFx0XHRjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpPy5mcm9udG1hdHRlclxuXHRcdFx0bGV0IGxpbmVOdW1iZXIgPSBjdXJyZW50TGluZU51bWJlclxuXHRcdFx0aWYgKGZyb250bWF0dGVyKSB7XG5cdFx0XHRcdGNvbnN0IHsgcG9zaXRpb246IHsgc3RhcnQsIGVuZCB9IH0gPSBmcm9udG1hdHRlclxuXHRcdFx0XHRpZiAoY3VycmVudExpbmVOdW1iZXIgPj0gc3RhcnQubGluZSAmJiBjdXJyZW50TGluZU51bWJlciA8IGVuZC5saW5lKSBsaW5lTnVtYmVyID0gLTFcblx0XHRcdH1cblx0XHRcdGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwicGluXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgYXQgY3Vyc29yXCIpO1xuXHRcdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRGLm9wZW5GaWVsZE1vZGFsKFxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB1bmRlZmluZWQsIFwiXCIsIGxpbmVOdW1iZXIsIGZhbHNlLCBmYWxzZSwgZmFsc2UpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGlzSW5zZXJ0RmllbGRDb21tYW5kKHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcblx0XHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0XHRpZDogXCJhZGRfZmllbGRfYXRfY3Vyc29yXCIsXG5cdFx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIGZpZWxkIGF0IGN1cnNvci4uLlwiLFxuXHRcdFx0XHRcdGFjdGlvbjogKCkgPT4gRi5vcGVuRmllbGRNb2RhbChcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHVuZGVmaW5lZCwgXCJcIiwgbGluZU51bWJlciwgZmFsc2UsIGZhbHNlLCBmYWxzZSksXG5cdFx0XHRcdFx0aWNvbjogXCJwaW5cIlxuXHRcdFx0XHR9KVxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFkZEZpbGVDbGFzc1RvRmlsZU9wdGlvbigpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IG5ldyBBZGRGaWxlQ2xhc3NUb0ZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlKVxuXHRcdGNvbnN0IGFjdGlvbiA9ICgpID0+IG1vZGFsLm9wZW4oKTtcblx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRJY29uKFwicGx1cy1zcXVhcmVcIik7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYEFkZCAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfSB0byAke3RoaXMuZmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKGFjdGlvbik7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzXCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0aWQ6IFwiYWRkX2ZpbGVjbGFzc190b19maWxlXCIsXG5cdFx0XHRcdGFjdGlvbkxhYmVsOiBgQWRkICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9IHRvICR7dGhpcy5maWxlLmJhc2VuYW1lfWAsXG5cdFx0XHRcdGFjdGlvbjogYWN0aW9uLFxuXHRcdFx0XHRpY29uOiBcInBsdXMtc3F1YXJlXCJcblx0XHRcdH0pXG5cdFx0fTtcblx0fVxuXG5cdHByaXZhdGUgYWRkTmV3RmlsZUNsYXNzT3B0aW9uKCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IEFkZE5ld0ZpbGVDbGFzc01vZGFsKHRoaXMucGx1Z2luKTtcblx0XHRjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoKSB7XG5cdFx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImZpbGUtcGx1cy0yXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYEFkZCBhIG5ldyAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfWApXG5cdFx0XHRcdFx0aXRlbS5vbkNsaWNrKGFjdGlvbik7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS1maWxlY2xhc3NcIik7XG5cdFx0XHRcdH0pXG5cdFx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IFwiYWRkX25ld19maWxlY2xhc3NcIixcblx0XHRcdFx0XHRhY3Rpb25MYWJlbDogYEFkZCBhIG5ldyAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfWAsXG5cdFx0XHRcdFx0YWN0aW9uOiBhY3Rpb24sXG5cdFx0XHRcdFx0aWNvbjogXCJmaWxlLXBsdXMtMlwiXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuIiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgTW9kYWwsIFRleHRDb21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY3JlYXRlRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9jcmVhdGVGaWxlQ2xhc3NcIjtcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZGROZXdGaWxlQ2xhc3NNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICB9XG5cbiAgICBvbk9wZW4oKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KFwiQWRkIGEgbmV3IGZpbGVDbGFzc1wiKTtcbiAgICAgICAgdGhpcy5idWlsZEFkZEZpbGVDbGFzc0Zvcm0oKTtcbiAgICB9XG5cbiAgICBidWlsZEFkZEZpbGVDbGFzc0Zvcm0oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc2VzUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoIVxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG5cbiAgICAgICAgbmFtZUNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBgJHtmaWxlQ2xhc3NBbGlhc30gbmFtZWAsIGNsczogXCJsYWJlbFwiIH0pXG4gICAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KG5hbWVDb250YWluZXIpO1xuICAgICAgICBuYW1lSW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIik7XG4gICAgICAgIG5hbWVJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgY29uc3QgbmFtZUVycm9yQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWVycm9yXCIsIHRleHQ6IGBUaGlzICR7ZmlsZUNsYXNzQWxpYXN9IGZpbGUgYWxyZWFkeSBleGlzdHNgIH0pO1xuXG4gICAgICAgIGNvbnN0IG1hcFdpdGhUYWdDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIG1hcFdpdGhUYWdDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImxhYmVsXCIsIHRleHQ6IGBNYXAgdGhpcyAke2ZpbGVDbGFzc0FsaWFzfSBmaWxlIHdpdGggdGhlIHRhZyBvZiBzYW1lIG5hbWVgIH0pO1xuICAgICAgICBtYXBXaXRoVGFnQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgbWFwV2l0aFRhZ1RvZ2dsZXIgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KG1hcFdpdGhUYWdDb250YWluZXIpXG4gICAgICAgIG1hcFdpdGhUYWdUb2dnbGVyLnNldFZhbHVlKGZhbHNlKTtcbiAgICAgICAgbWFwV2l0aFRhZ1RvZ2dsZXIub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7IHRhZ05hbWVzQ29udGFpbmVyLnNob3coKTsgfSBlbHNlIHsgdGFnTmFtZXNDb250YWluZXIuaGlkZSgpOyB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgdGFnTmFtZXNDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHRhZ05hbWVzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiBcIkFsaWFzZXMgKG9wdGlvbmFsKVwiIH0pO1xuICAgICAgICBjb25zdCB0YWdOYW1lc0lucHV0ID0gbmV3IFRleHRDb21wb25lbnQodGFnTmFtZXNDb250YWluZXIpO1xuICAgICAgICB0YWdOYW1lc0lucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICB0YWdOYW1lc0lucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0YWdOYW1lc0lucHV0LnNldFBsYWNlaG9sZGVyKFwiTGVhdmUgZW1wdHkgdG8gbWFwIHdpdGggdGhlIHRhZyBvZiBzYW1lIG5hbWUgYXMgZmlsZWNsYXNzXCIpXG4gICAgICAgIHRhZ05hbWVzQ29udGFpbmVyLmhpZGUoKTtcblxuICAgICAgICBjb25zdCBhY3Rpb25zQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZvb3Rlci1hY3Rpb25zXCIgfSk7XG4gICAgICAgIGFjdGlvbnNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IHNhdmVCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGFjdGlvbnNDb250YWluZXIpO1xuICAgICAgICBzYXZlQnRuLnNldERpc2FibGVkKHRydWUpO1xuICAgICAgICBzYXZlQnRuLnNldEljb24oXCJmaWxlLXBsdXMtMlwiKTtcblxuICAgICAgICBuYW1lRXJyb3JDb250YWluZXIuaGlkZSgpO1xuICAgICAgICBuYW1lSW5wdXQub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuICAgICAgICAgICAgbmFtZUVycm9yQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgICAgIHNhdmVCdG4uc2V0RGlzYWJsZWQoZmFsc2UpXG4gICAgICAgICAgICBzYXZlQnRuLnNldEN0YSgpXG4gICAgICAgICAgICBpZiAoYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIuZXhpc3RzKGAke2ZpbGVDbGFzc2VzUGF0aH0ke3ZhbHVlfS5tZGApKSB7XG4gICAgICAgICAgICAgICAgbmFtZUVycm9yQ29udGFpbmVyLnNob3coKTtcbiAgICAgICAgICAgICAgICBzYXZlQnRuLnNldERpc2FibGVkKHRydWUpXG4gICAgICAgICAgICAgICAgc2F2ZUJ0bi5yZW1vdmVDdGEoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2F2ZUJ0bi5zZXREaXNhYmxlZChmYWxzZSk7XG4gICAgICAgICAgICAgICAgc2F2ZUJ0bi5zZXRDdGEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHNhdmVCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBjcmVhdGVGaWxlQ2xhc3MoXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgbmFtZUlucHV0LmdldFZhbHVlKCksXG4gICAgICAgICAgICAgICAgbWFwV2l0aFRhZ1RvZ2dsZXIuZ2V0VmFsdWUoKSxcbiAgICAgICAgICAgICAgICB0YWdOYW1lc0lucHV0LmdldFZhbHVlKCkuc3BsaXQoXCIsXCIpLm1hcCh0ID0+IHQudHJpbSgpKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUZpbGVDbGFzcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgbmFtZTogc3RyaW5nLCBtYXBXaXRoVGFnOiBib29sZWFuID0gZmFsc2UsIHRhZ05hbWVzOiBzdHJpbmdbXSA9IFtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBpZiAoY2xhc3NGaWxlc1BhdGgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBtYXBXaXRoVGFnID8gYC0tLVxcbm1hcFdpdGhUYWc6IHRydWVcXG4ke3RhZ05hbWVzLmxlbmd0aCA/IFwidGFnTmFtZXM6IFtcIiArIHRhZ05hbWVzLmpvaW4oXCIsIFwiKSArIFwiXVxcblwiIDogXCJcIn0tLS1cXG5gIDogXCJcIlxuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jcmVhdGUoYCR7Y2xhc3NGaWxlc1BhdGh9JHtuYW1lfS5tZGAsIGNvbnRlbnQpXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyAoZXJyb3IpXG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IENvbXBvbmVudCwgTWVudSwgUGxhdGZvcm0sIHJlcXVpcmVBcGlWZXJzaW9uLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE9wdGlvbnNMaXN0IGZyb20gXCJzcmMvb3B0aW9ucy9PcHRpb25zTGlzdFwiO1xuaW1wb3J0IEZpbGVDbGFzc09wdGlvbnNMaXN0IGZyb20gXCIuLi9vcHRpb25zL0ZpbGVDbGFzc09wdGlvbnNMaXN0XCI7XG5pbXBvcnQgeyBmcm9udE1hdHRlckxpbmVGaWVsZCwgZ2V0TGluZUZpZWxkcyB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCIuLi9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbnRleHRNZW51IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG5cdFx0c3VwZXIoKVxuXHR9O1xuXG5cdG9ubG9hZCgpOiB2b2lkIHtcblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignZmlsZS1tZW51JywgKG1lbnUsIGFic3RyYWN0RmlsZSwgc291cmNlKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGFic3RyYWN0RmlsZS5wYXRoKTtcblx0XHRcdFx0dGhpcy5idWlsZE9wdGlvbnMoZmlsZSwgbWVudSk7XG5cdFx0XHR9KVxuXHRcdCk7XG5cblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLW1lbnUnLCAobWVudSwgZWRpdG9yLCB2aWV3KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0Y29uc3QgaW5jbHVkZWRGaWVsZHM6IHN0cmluZ1tdID0gW107XG5cdFx0XHRcdGNvbnN0IGZyb250bWF0dGVyID0gdmlldy5maWxlICYmIHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh2aWV3LmZpbGUpPy5mcm9udG1hdHRlcjtcblx0XHRcdFx0aWYgKGZyb250bWF0dGVyXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPiBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPCBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRjb25zdCBhdHRyaWJ1dGUgPSBmcm9udE1hdHRlckxpbmVGaWVsZChlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSkpXG5cdFx0XHRcdFx0aWYgKGF0dHJpYnV0ZSkgaW5jbHVkZWRGaWVsZHMucHVzaChhdHRyaWJ1dGUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGdldExpbmVGaWVsZHMoZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpKS5mb3JFYWNoKGZpZWxkID0+IHtcblx0XHRcdFx0XHRcdGlmIChlZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggPD0gZmllbGQuaW5kZXggKyBmaWVsZC5sZW5ndGggJiYgZWRpdG9yLmdldEN1cnNvcigpLmNoID49IGZpZWxkLmluZGV4KSB7XG5cdFx0XHRcdFx0XHRcdGluY2x1ZGVkRmllbGRzLnB1c2goZmllbGQuYXR0cmlidXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChpbmNsdWRlZEZpZWxkcy5sZW5ndGgpIHtcblx0XHRcdFx0XHR0aGlzLmJ1aWxkT3B0aW9ucyhmaWxlLCBtZW51LCBpbmNsdWRlZEZpZWxkcyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5idWlsZE9wdGlvbnMoZmlsZSwgbWVudSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSlcblx0XHQpXG5cdH1cblxuXHRwcml2YXRlIGJ1aWxkT3B0aW9ucyhmaWxlOiBURmlsZSB8IFRBYnN0cmFjdEZpbGUgfCBudWxsLCBtZW51OiBNZW51LCBpbmNsdWRlZEZpZWxkcz86IHN0cmluZ1tdKTogdm9pZCB7XG5cdFx0Y29uc3QgY2xhc3NGaWxlc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuXHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcblx0XHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUgJiYgcmVxdWlyZUFwaVZlcnNpb24oXCIwLjE2LjBcIikpIHtcblx0XHRcdFx0aWYgKGNsYXNzRmlsZXNQYXRoICYmIGZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkge1xuXHRcdFx0XHRcdGNvbnN0IGZpbGVDbGFzc05hbWUgPSBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzTmFtZUZyb21QYXRoKHRoaXMucGx1Z2luLCBmaWxlLnBhdGgpXG5cdFx0XHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRcdFx0bWVudS5zZXRTZWN0aW9uU3VibWVudShgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHtmaWxlQ2xhc3NOYW1lfS5maWxlY2xhc3MtZmllbGRzYCwgeyB0aXRsZTogXCJNYW5hZ2UgZmllbGRzXCIsIGljb246IFwid3JlbmNoXCIgfSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRcdFx0bWVudS5zZXRTZWN0aW9uU3VibWVudShcIm1ldGFkYXRhLW1lbnUuY3VycmVudF9maWVsZFwiLCB7IHRpdGxlOiBcIkN1cnJlbnQgZmllbGRcIiwgaWNvbjogXCJwZW5jaWxcIiB9KVxuXHRcdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRcdG1lbnUuc2V0U2VjdGlvblN1Ym1lbnUoXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiLCB7IHRpdGxlOiBcIk1hbmFnZSBmaWVsZHNcIiwgaWNvbjogXCJwZW5jaWxcIiB9KVxuXHRcdFx0XHRcdGNvbnN0IGZpbGVDbGFzc2VzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzLmdldChmaWxlLnBhdGgpIHx8IFtdO1xuXHRcdFx0XHRcdGZpbGVDbGFzc2VzLmZvckVhY2goZmlsZUNsYXNzID0+IHtcblx0XHRcdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRcdFx0bWVudS5zZXRTZWN0aW9uU3VibWVudShgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHtmaWxlQ2xhc3MubmFtZX0uZmlsZWNsYXNzLWZpZWxkc2AsIHsgdGl0bGU6IGBNYW5hZ2UgJHtmaWxlQ2xhc3MubmFtZX0gZmllbGRzYCwgaWNvbjogXCJ3cmVuY2hcIiB9KVxuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSkge1xuXHRcdFx0XHQvL0lmIGZpbGVDbGFzc1xuXHRcdFx0XHRpZiAoY2xhc3NGaWxlc1BhdGggJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKSB7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZUNsYXNzT3B0aW9uc0xpc3QgPSBuZXcgRmlsZUNsYXNzT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIGZpbGUsIG1lbnUpXG5cdFx0XHRcdFx0ZmlsZUNsYXNzT3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIGZpbGUsIG1lbnUsIGluY2x1ZGVkRmllbGRzKTtcblx0XHRcdFx0XHRvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcblx0XHRcdFx0fTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImxpc3RcIilcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiRmllbGQgT3B0aW9uc1wiKVxuXHRcdFx0XHRcdGl0ZW0ub25DbGljaygoKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgPSBuZXcgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKHRoaXMucGx1Z2luLmFwcClcblx0XHRcdFx0XHRcdGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCBmaWxlLCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpO1xuXHRcdFx0XHRcdFx0b3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9O1xuXHR9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBDb21wb25lbnQsIFRGaWxlLCBkZWJvdW5jZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY2xlYXJFeHRyYUF0dHJpYnV0ZXMsIHVwZGF0ZURpdkV4dHJhQXR0cmlidXRlcywgdXBkYXRlRWxMaW5rcywgdXBkYXRlVmlzaWJsZUxpbmtzIH0gZnJvbSBcInNyYy9vcHRpb25zL2xpbmtBdHRyaWJ1dGVzXCI7XG5pbXBvcnQgeyBQcmVjIH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XG5pbXBvcnQgeyBidWlsZENNVmlld1BsdWdpbiB9IGZyb20gXCJzcmMvb3B0aW9ucy9saXZlUHJldmlld1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFeHRyYUJ1dHRvbiBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBwcml2YXRlIG9ic2VydmVyczogW011dGF0aW9uT2JzZXJ2ZXIsIHN0cmluZywgc3RyaW5nXVtdO1xuICAgIHByaXZhdGUgbW9kYWxPYnNlcnZlcnM6IE11dGF0aW9uT2JzZXJ2ZXJbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHVibGljIGNhY2hlVmVyc2lvbjogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgb25DaGFuZ2U6ICgpID0+IHZvaWQsXG5cbiAgICApIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICBvbmxvYWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XG4gICAgICAgICAgICB1cGRhdGVFbExpbmtzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4sIGVsLCBjdHgpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIExpdmUgcHJldmlld1xuICAgICAgICBjb25zdCBleHQgPSBQcmVjLmxvd2VzdChidWlsZENNVmlld1BsdWdpbih0aGlzLnBsdWdpbikpO1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckVkaXRvckV4dGVuc2lvbihleHQpO1xuXG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XG4gICAgICAgICAgICB1cGRhdGVFbExpbmtzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4sIGVsLCBjdHgpXG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgY29uc3QgcGx1Z2luID0gdGhpcy5wbHVnaW47XG4gICAgICAgIGNvbnN0IHVwZGF0ZUxpbmtzID0gKF9maWxlOiBURmlsZSkgPT4ge1xuICAgICAgICAgICAgdXBkYXRlVmlzaWJsZUxpbmtzKHBsdWdpbi5hcHAsIHBsdWdpbik7XG4gICAgICAgICAgICB0aGlzLm9ic2VydmVycy5mb3JFYWNoKChbb2JzZXJ2ZXIsIHR5cGUsIG93bl9jbGFzc106IFthbnksIGFueSwgYW55XSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSh0eXBlKTtcbiAgICAgICAgICAgICAgICBsZWF2ZXMuZm9yRWFjaCgobGVhZjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKGxlYWYudmlldy5jb250YWluZXJFbCwgb3duX2NsYXNzLCB0eXBlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuXG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluaXRWaWV3T2JzZXJ2ZXJzKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRNb2RhbE9ic2VydmVycyhkb2N1bWVudCk7XG4gICAgICAgICAgICB1cGRhdGVWaXNpYmxlTGlua3ModGhpcy5wbHVnaW4uYXBwLCB0aGlzLnBsdWdpbik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemF0aW9uXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsIGRlYm91bmNlKHVwZGF0ZUxpbmtzLCA1MDAsIHRydWUpKSk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJsYXlvdXQtY2hhbmdlXCIsIGRlYm91bmNlKHVwZGF0ZUxpbmtzLCAxMCwgdHJ1ZSkpKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJ3aW5kb3ctb3BlblwiLCAod2luZG93LCB3aW4pID0+IHRoaXMuaW5pdE1vZGFsT2JzZXJ2ZXJzKHdpbmRvdy5nZXRDb250YWluZXIoKSEuZG9jKSkpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImxheW91dC1jaGFuZ2VcIiwgKCkgPT4gdGhpcy5pbml0Vmlld09ic2VydmVycygpKSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFwibWV0YWRhdGEtbWVudTppbmRleGVkXCIsICgpID0+IHRoaXMucmVsb2FkT2JzZXJ2ZXJzKCkpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRWaWV3T2JzZXJ2ZXJzKCkge1xuICAgICAgICAvLyBSZXNldCBvYnNlcnZlcnNcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMuZm9yRWFjaCgoW29ic2VydmVyLCB0eXBlXSkgPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcblxuICAgICAgICAvLyBSZWdpc3RlciBuZXcgb2JzZXJ2ZXJzXG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnYmFja2xpbmsnLCBcIi50cmVlLWl0ZW0taW5uZXJcIiwgdHJ1ZSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnb3V0Z29pbmctbGluaycsIFwiLnRyZWUtaXRlbS1pbm5lclwiLCB0cnVlKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXdUeXBlKCdzZWFyY2gnLCBcIi50cmVlLWl0ZW0taW5uZXJcIiwgdHJ1ZSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnQkMtbWF0cml4JywgJy5CQy1MaW5rJyk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnQkMtZHVja3MnLCAnLmludGVybmFsLWxpbmsnKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXdUeXBlKCdCQy10cmVlJywgJ2EuaW50ZXJuYWwtbGluaycpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlld1R5cGUoJ2dyYXBoLWFuYWx5c2lzJywgJy5pbnRlcm5hbC1saW5rJyk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnc3RhcnJlZCcsICcubmF2LWZpbGUtdGl0bGUtY29udGVudCcsIHRydWUpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlld1R5cGUoJ2ZpbGUtZXhwbG9yZXInLCAnLm5hdi1maWxlLXRpdGxlLWNvbnRlbnQnLCB0cnVlKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXdUeXBlKCdyZWNlbnQtZmlsZXMnLCAnLm5hdi1maWxlLXRpdGxlLWNvbnRlbnQnLCB0cnVlKTtcbiAgICAgICAgLy8gSWYgYmFja2xpbmtzIGluIGVkaXRvciBpcyBvblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHA/LmludGVybmFsUGx1Z2lucz8ucGx1Z2lucz8uYmFja2xpbms/Lmluc3RhbmNlPy5vcHRpb25zPy5iYWNrbGlua0luRG9jdW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnbWFya2Rvd24nLCAnLnRyZWUtaXRlbS1pbm5lcicsIHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0TW9kYWxPYnNlcnZlcnMoZG9jOiBEb2N1bWVudCkge1xuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBzdWJ0cmVlOiBmYWxzZSxcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5tb2RhbE9ic2VydmVycy5wdXNoKG5ldyBNdXRhdGlvbk9ic2VydmVyKHJlY29yZHMgPT4ge1xuICAgICAgICAgICAgcmVjb3Jkcy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbi5hZGRlZE5vZGVzLmZvckVhY2gobiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ2NsYXNzTmFtZScgaW4gbiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobi5jbGFzc05hbWUuaW5jbHVkZXMoJ21vZGFsLWNvbnRhaW5lcicpICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVF1aWNrU3dpdGNoZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBuLmNsYXNzTmFtZS5pbmNsdWRlcygnc3VnZ2VzdGlvbi1jb250YWluZXInKSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTdWdnZXN0b3IpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdG9yID0gXCIuc3VnZ2VzdGlvbi10aXRsZSwgLnN1Z2dlc3Rpb24tbm90ZSwgLmFub3RoZXItcXVpY2stc3dpdGNoZXJfX2l0ZW1fX3RpdGxlLCAub21uaXNlYXJjaC1yZXN1bHRfX3RpdGxlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmNsYXNzTmFtZS5pbmNsdWRlcygnc3VnZ2VzdGlvbi1jb250YWluZXInKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IFwiLnN1Z2dlc3Rpb24tdGl0bGUsIC5zdWdnZXN0aW9uLW5vdGVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIobiBhcyBIVE1MRWxlbWVudCwgc2VsZWN0b3IsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3dhdGNoQ29udGFpbmVyKG51bGwsIG4gYXMgSFRNTEVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5tb2RhbE9ic2VydmVycy5sYXN0KCk/Lm9ic2VydmUoZG9jLmJvZHksIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWdpc3RlclZpZXdUeXBlKHZpZXdUeXBlTmFtZTogc3RyaW5nLCBzZWxlY3Rvcjogc3RyaW5nLCB1cGRhdGVEeW5hbWljID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUodmlld1R5cGVOYW1lKTtcbiAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlYXZlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGxlYXZlc1tpXS52aWV3LmNvbnRhaW5lckVsO1xuICAgICAgICAgICAgICAgIGlmICh1cGRhdGVEeW5hbWljKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dhdGNoQ29udGFpbmVyRHluYW1pYyh2aWV3VHlwZU5hbWUgKyBpLCBjb250YWluZXIsIHNlbGVjdG9yKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2F0Y2hDb250YWluZXIodmlld1R5cGVOYW1lICsgaSwgY29udGFpbmVyLCBzZWxlY3Rvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxlYXZlcy5sZW5ndGggPCAxKSByZXR1cm47XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gbGVhdmVzWzBdLnZpZXcuY29udGFpbmVyRWw7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lcihjb250YWluZXIsIHNlbGVjdG9yLCB2aWV3VHlwZU5hbWUpO1xuICAgICAgICAgICAgaWYgKHVwZGF0ZUR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93YXRjaENvbnRhaW5lckR5bmFtaWModmlld1R5cGVOYW1lLCBjb250YWluZXIsIHNlbGVjdG9yKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd2F0Y2hDb250YWluZXIodmlld1R5cGVOYW1lLCBjb250YWluZXIsIHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcsIHZpZXdUeXBlTmFtZTogc3RyaW5nIHwgbnVsbCkge1xuICAgICAgICBjb25zdCBub2RlcyA9IGNvbnRhaW5lci5maW5kQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgY29uc3QgZWwgPSBub2Rlc1tpXSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IGlzQ2FudmFzRmlsZUxpbmsgPSBlbC5wYXJlbnRFbGVtZW50Py5nZXRBdHRyKFwiZGF0YS1wYXRoXCIpPy5pbmNsdWRlcyhcIi5jYW52YXNcIilcbiAgICAgICAgICAgIGlmICghaXNDYW52YXNGaWxlTGluaykge1xuICAgICAgICAgICAgICAgIHVwZGF0ZURpdkV4dHJhQXR0cmlidXRlcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMucGx1Z2luLCBlbCwgdmlld1R5cGVOYW1lLCBcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVtb3ZlRnJvbUNvbnRhaW5lcihjb250YWluZXI6IEhUTUxFbGVtZW50LCBzZWxlY3Rvcjogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gY29udGFpbmVyLmZpbmRBbGwoc2VsZWN0b3IpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBjb25zdCBlbCA9IG5vZGVzW2ldIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgY2xlYXJFeHRyYUF0dHJpYnV0ZXMoZWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfd2F0Y2hDb250YWluZXIodmlld1R5cGU6IHN0cmluZyB8IG51bGwsIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKHJlY29yZHMsIF8pID0+IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKGNvbnRhaW5lciwgc2VsZWN0b3IsIHZpZXdUeXBlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUoY29udGFpbmVyLCB7IHN1YnRyZWU6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgYXR0cmlidXRlczogZmFsc2UgfSk7XG4gICAgICAgIGlmICh2aWV3VHlwZSkge1xuICAgICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChbb2JzZXJ2ZXIsIHZpZXdUeXBlLCBzZWxlY3Rvcl0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfd2F0Y2hDb250YWluZXJEeW5hbWljKHZpZXdUeXBlOiBzdHJpbmcsIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcsIG93bkNsYXNzID0gJ3RyZWUtaXRlbS1pbm5lcicsIHBhcmVudF9jbGFzcyA9ICd0cmVlLWl0ZW0nKSB7XG4gICAgICAgIC8vIFVzZWQgZm9yIGVmZmljaWVudCB1cGRhdGluZyBvZiB0aGUgYmFja2xpbmtzIHBhbmVsXG4gICAgICAgIC8vIE9ubHkgbG9vcHMgdGhyb3VnaCBuZXdseSBhZGRlZCBET00gbm9kZXMgaW5zdGVhZCBvZiBjaGFuZ2luZyBhbGwgb2YgdGhlbVxuICAgICAgICBsZXQgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigocmVjb3JkcywgXykgPT4ge1xuICAgICAgICAgICAgcmVjb3Jkcy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbi5hZGRlZE5vZGVzLmZvckVhY2goKG4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnY2xhc3NOYW1lJyBpbiBuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmNsYXNzTmFtZS5pbmNsdWRlcyAmJiB0eXBlb2Ygbi5jbGFzc05hbWUuaW5jbHVkZXMgPT09ICdmdW5jdGlvbicgJiYgbi5jbGFzc05hbWUuaW5jbHVkZXMocGFyZW50X2NsYXNzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlRGl2cyA9IChuIGFzIEhUTUxFbGVtZW50KS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG93bkNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlRGl2cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGZpbGVEaXZzW2ldIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGl2RXh0cmFBdHRyaWJ1dGVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4sIGxpbmssIHZpZXdUeXBlLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGNvbnRhaW5lciwgeyBzdWJ0cmVlOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIGF0dHJpYnV0ZXM6IGZhbHNlIH0pO1xuICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKFtvYnNlcnZlciwgdmlld1R5cGUsIHNlbGVjdG9yXSk7XG4gICAgfVxuXG4gICAgcmVsb2FkT2JzZXJ2ZXJzKCkge1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RPYnNlcnZlcnMoKTtcbiAgICAgICAgdGhpcy5pbml0TW9kYWxPYnNlcnZlcnMoZG9jdW1lbnQpO1xuICAgICAgICB0aGlzLmluaXRWaWV3T2JzZXJ2ZXJzKCk7XG4gICAgICAgIHVwZGF0ZVZpc2libGVMaW5rcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMucGx1Z2luKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRpc2Nvbm5lY3RPYnNlcnZlcnMoKSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLmZvckVhY2goKFtvYnNlcnZlciwgdHlwZSwgb3duX2NsYXNzXSkgPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUodHlwZSk7XG4gICAgICAgICAgICBsZWF2ZXMuZm9yRWFjaChsZWFmID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUZyb21Db250YWluZXIobGVhZi52aWV3LmNvbnRhaW5lckVsLCBvd25fY2xhc3MpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgdGhpcy5tb2RhbE9ic2VydmVycykge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb251bmxvYWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdE9ic2VydmVycygpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBnZXRMaW5rcGF0aCwgTGlua0NhY2hlLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBNYXJrZG93blZpZXcsIFRGaWxlLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBOb3RlRmllbGRzQ29tcG9uZW50IGZyb20gXCIuLi9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcbmltcG9ydCB7IEZpbGVDbGFzc01hbmFnZXIgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvZmlsZUNsYXNzTWFuYWdlclwiO1xuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJFeHRyYUF0dHJpYnV0ZXMobGluazogSFRNTEVsZW1lbnQpIHtcbiAgICBPYmplY3QudmFsdWVzKGxpbmsuYXR0cmlidXRlcykuZm9yRWFjaChhdHRyID0+IHtcbiAgICAgICAgaWYgKGF0dHIubmFtZS5pbmNsdWRlcyhcImZpbGVjbGFzcy1uYW1lXCIpKSB7XG4gICAgICAgICAgICBsaW5rLnJlbW92ZUF0dHJpYnV0ZShhdHRyLm5hbWUpXG4gICAgICAgICAgICBjb25zdCBlbCA9IGxpbmsubmV4dEVsZW1lbnRTaWJsaW5nXG4gICAgICAgICAgICBpZiAoZWw/Lmhhc0NsYXNzKFwiZmlsZWNsYXNzLWljb25cIikpIHtcbiAgICAgICAgICAgICAgICBlbC5yZW1vdmUoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gc2V0TGlua01ldGFkYXRhRm9ybUJ1dHRvbihwbHVnaW46IE1ldGFkYXRhTWVudSwgbGluazogSFRNTEVsZW1lbnQsIGRlc3RQYXRoOiBzdHJpbmcsIHZpZXdUeXBlTmFtZTogc3RyaW5nIHwgbnVsbCwgZmlsZUNsYXNzTmFtZT86IHN0cmluZykge1xuICAgIGlmIChsaW5rLmNsYXNzTGlzdC5jb250YWlucyhcIm1ldGFkYXRhLW1lbnUtYnV0dG9uLWhpZGRlblwiKSkgcmV0dXJuOyAvL3NvIHRoYXQgc25pcHBldHMgY2FuIHByZXZlbnQgdGhlIGJ1dHRvbiBmcm9tIGJlaW5nIGFkZGVkXG4gICAgc3dpdGNoICh2aWV3VHlwZU5hbWUpIHtcbiAgICAgICAgY2FzZSBcImEuaW50ZXJuYWwtbGlua1wiOiBpZiAoIXBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaW5rcykgcmV0dXJuOyBicmVhaztcbiAgICAgICAgY2FzZSBcInRhYkhlYWRlclwiOiBpZiAoIXBsdWdpbi5zZXR0aW5ncy5lbmFibGVUYWJIZWFkZXIpIHJldHVybjsgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzdGFycmVkXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZVN0YXJyZWQpIHJldHVybjsgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJmaWxlLWV4cGxvcmVyXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZUZpbGVFeHBsb3JlcikgcmV0dXJuOyBicmVhaztcbiAgICAgICAgY2FzZSBcImJhY2tsaW5rXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZUJhY2tsaW5rcykgcmV0dXJuOyBicmVhaztcbiAgICAgICAgY2FzZSBcInNlYXJjaFwiOiBpZiAoIXBsdWdpbi5zZXR0aW5ncy5lbmFibGVTZWFyY2gpIHJldHVybjsgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IHJldHVybjtcbiAgICB9XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGZvciAoY29uc3QgYSBvZiBsaW5rLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgaWYgKGEubmFtZS5pbmNsdWRlcyhcImZpbGVjbGFzcy1uYW1lXCIpICYmIChhLm5hbWUgIT09IGZpbGVDbGFzc05hbWUpKSB7XG4gICAgICAgICAgICBsaW5rLnJlbW92ZUF0dHJpYnV0ZShhLm5hbWUpO1xuICAgICAgICAgICAgY29uc3QgZWwgPSBsaW5rLm5leHRFbGVtZW50U2libGluZ1xuICAgICAgICAgICAgaWYgKGVsPy5oYXNDbGFzcyhcImZpbGVjbGFzcy1pY29uXCIpKSB7XG4gICAgICAgICAgICAgICAgZWwucmVtb3ZlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjbGFzc0ZpbGVzc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBjb25zdCBmaWxlQ2xhc3MgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc1BhdGguZ2V0KGRlc3RQYXRoICsgXCIubWRcIilcbiAgICBpZiAoY2xhc3NGaWxlc3NQYXRoICYmIGZpbGVDbGFzcykge1xuXG4gICAgICAgIGNvbnN0IGljb24gPSBcImZpbGUtc3ByZWFkc2hlZXRcIlxuICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZShcImZpbGVjbGFzcy1uYW1lXCIsIGZpbGVDbGFzcy5uYW1lKVxuICAgICAgICBjb25zdCBlbCA9IGxpbmsubmV4dEVsZW1lbnRTaWJsaW5nXG4gICAgICAgIGlmICghZWw/Lmhhc0NsYXNzKFwiZmlsZWNsYXNzLWljb25cIikpIHtcbiAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhTWVudUJ0biA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmNvbnRhaW5lckVsLmNyZWF0ZUVsKCdhJywgeyBjbHM6IFwibWV0YWRhdGEtbWVudSBmaWxlY2xhc3MtaWNvblwiIH0pXG4gICAgICAgICAgICBpZiAobWV0YWRhdGFNZW51QnRuKSB7XG4gICAgICAgICAgICAgICAgc2V0SWNvbihtZXRhZGF0YU1lbnVCdG4sIGljb24pXG4gICAgICAgICAgICAgICAgbGluay5wYXJlbnRFbGVtZW50Py5pbnNlcnRCZWZvcmUobWV0YWRhdGFNZW51QnRuLCBsaW5rLm5leHRTaWJsaW5nKVxuICAgICAgICAgICAgICAgIG1ldGFkYXRhTWVudUJ0bi5vbmNsaWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5hZGRDaGlsZChuZXcgRmlsZUNsYXNzTWFuYWdlcihwbHVnaW4sIGZpbGVDbGFzcykpXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfVxuICAgIGVsc2UgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlQ2xhc3NOYW1lKVxuICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICBjb25zdCBpY29uID0gZmlsZUNsYXNzLmdldEljb24oKVxuICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoXCJmaWxlY2xhc3MtbmFtZVwiLCBmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgY29uc3QgZWwgPSBsaW5rLm5leHRFbGVtZW50U2libGluZ1xuICAgICAgICAgICAgaWYgKCFlbD8uaGFzQ2xhc3MoXCJmaWxlY2xhc3MtaWNvblwiKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhTWVudUJ0biA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmNvbnRhaW5lckVsLmNyZWF0ZUVsKCdhJywgeyBjbHM6IFwibWV0YWRhdGEtbWVudSBmaWxlY2xhc3MtaWNvblwiIH0pXG4gICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhTWVudUJ0bikge1xuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKG1ldGFkYXRhTWVudUJ0biwgaWNvbiB8fCBwbHVnaW4uc2V0dGluZ3MuYnV0dG9uSWNvbilcbiAgICAgICAgICAgICAgICAgICAgbGluay5wYXJlbnRFbGVtZW50Py5pbnNlcnRCZWZvcmUobWV0YWRhdGFNZW51QnRuLCBsaW5rLm5leHRTaWJsaW5nKVxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YU1lbnVCdG4ub25jbGljayA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGAke2Rlc3RQYXRofS5tZGApXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlRmllbGRzQ29tcG9uZW50ID0gbmV3IE5vdGVGaWVsZHNDb21wb25lbnQocGx1Z2luLCBcIjFcIiwgKCkgPT4geyB9LCBmaWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5hZGRDaGlsZChub3RlRmllbGRzQ29tcG9uZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVMaW5rTWV0YWRhdGFNZW51Rm9ybUJ1dHRvbihhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxpbms6IEhUTUxFbGVtZW50LCB2aWV3VHlwZU5hbWU6IHN0cmluZyB8IG51bGwsIHNvdXJjZTogc3RyaW5nKSB7XG4gICAgY29uc3QgbGlua0hyZWYgPSBsaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicpPy5zcGxpdCgnIycpWzBdO1xuICAgIGNvbnN0IGRlc3QgPSBsaW5rSHJlZiAmJiBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rSHJlZiwgc291cmNlKTtcblxuICAgIGlmIChkZXN0KSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGRlc3QucGF0aCk/Lmxhc3QoKVxuICAgICAgICBzZXRMaW5rTWV0YWRhdGFGb3JtQnV0dG9uKHBsdWdpbiwgbGluaywgZGVzdC5wYXRoLnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpLCB2aWV3VHlwZU5hbWUsIGZpbGVDbGFzc05hbWUpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZURpdkV4dHJhQXR0cmlidXRlcyhhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxpbms6IEhUTUxFbGVtZW50LCB2aWV3VHlwZU5hbWU6IHN0cmluZyB8IG51bGwsIHNvdXJjZU5hbWU6IHN0cmluZywgX2xpbmtOYW1lPzogc3RyaW5nKSB7XG4gICAgY29uc3QgbGlua05hbWUgPSBfbGlua05hbWUgfHwgbGluay50ZXh0Q29udGVudFxuICAgIGNvbnN0IGRlc3QgPSBsaW5rTmFtZSAmJiBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChnZXRMaW5rcGF0aChsaW5rTmFtZSksIHNvdXJjZU5hbWUpXG4gICAgaWYgKGRlc3QpIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZGVzdC5wYXRoKT8ubGFzdCgpXG4gICAgICAgIHNldExpbmtNZXRhZGF0YUZvcm1CdXR0b24ocGx1Z2luLCBsaW5rLCBkZXN0LnBhdGgucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIiksIHZpZXdUeXBlTmFtZSwgZmlsZUNsYXNzTmFtZSk7XG4gICAgfVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVFbExpbmtzKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSwgZWw6IEhUTUxFbGVtZW50LCBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQpIHtcbiAgICBjb25zdCBsaW5rcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2EuaW50ZXJuYWwtbGluaycpO1xuICAgIGNvbnN0IHNvdXJjZSA9IGN0eC5zb3VyY2VQYXRoLnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpO1xuICAgIGxpbmtzLmZvckVhY2goKGxpbms6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgICAgIHVwZGF0ZUxpbmtNZXRhZGF0YU1lbnVGb3JtQnV0dG9uKGFwcCwgcGx1Z2luLCBsaW5rLCAnYS5pbnRlcm5hbC1saW5rJywgc291cmNlKVxuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlVmlzaWJsZUxpbmtzKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIGNvbnN0IHNldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzO1xuICAgIGFwcC53b3Jrc3BhY2UuaXRlcmF0ZVJvb3RMZWF2ZXMoKGxlYWYpID0+IHtcbiAgICAgICAgaWYgKGxlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyAmJiBsZWFmLnZpZXcuZmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZmlsZTogVEZpbGUgPSBsZWFmLnZpZXcuZmlsZTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZEZpbGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGUucGF0aC5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKVxuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICBjb25zdCB0YWJIZWFkZXI6IEhUTUxFbGVtZW50ID0gbGVhZi50YWJIZWFkZXJJbm5lclRpdGxlRWw7XG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MuZW5hYmxlVGFiSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gU3VwZXJjaGFyZ2UgdGFiIGhlYWRlcnNcbiAgICAgICAgICAgICAgICB1cGRhdGVEaXZFeHRyYUF0dHJpYnV0ZXMoYXBwLCBwbHVnaW4sIHRhYkhlYWRlciwgJ3RhYkhlYWRlcicsIGZpbGVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNsZWFyRXh0cmFBdHRyaWJ1dGVzKHRhYkhlYWRlcik7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgaWYgKGNhY2hlZEZpbGU/LmxpbmtzICYmIHNldHRpbmdzLmVuYWJsZUxpbmtzKSB7XG4gICAgICAgICAgICAgICAgY2FjaGVkRmlsZS5saW5rcy5mb3JFYWNoKChsaW5rOiBMaW5rQ2FjaGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVzdCA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGxpbmsubGluaywgZmlsZU5hbWUpXG4gICAgICAgICAgICAgICAgICAgIGlmIChkZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLmdldChkZXN0LnBhdGgpPy5sYXN0KClcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW50ZXJuYWxMaW5rcyA9IGxlYWYudmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsKGBhLmludGVybmFsLWxpbmtbaHJlZj1cIiR7bGluay5saW5rfVwiXWApXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcm5hbExpbmtzLmZvckVhY2goKGludGVybmFsTGluazogSFRNTEVsZW1lbnQpID0+IHNldExpbmtNZXRhZGF0YUZvcm1CdXR0b24ocGx1Z2luLCBpbnRlcm5hbExpbmssIGRlc3QucGF0aC5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSwgYGEuaW50ZXJuYWwtbGlua2AsIGZpbGVDbGFzc05hbWUpKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59IiwgImltcG9ydCB7IEFwcCwgZWRpdG9yVmlld0ZpZWxkLCBNYXJrZG93blZpZXcsIHNldEljb24sIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBEZWNvcmF0aW9uLCBEZWNvcmF0aW9uU2V0LCBFZGl0b3JWaWV3LCBWaWV3UGx1Z2luLCBWaWV3VXBkYXRlLCBXaWRnZXRUeXBlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IFJhbmdlU2V0QnVpbGRlciB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgc3ludGF4VHJlZSB9IGZyb20gXCJAY29kZW1pcnJvci9sYW5ndWFnZVwiO1xuaW1wb3J0IHsgdG9rZW5DbGFzc05vZGVQcm9wIH0gZnJvbSBcIkBjb2RlbWlycm9yL2xhbmd1YWdlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgTm90ZUZpZWxkc0NvbXBvbmVudCBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzTWFuYWdlciB9IGZyb20gXCJzcmMvY29tcG9uZW50cy9maWxlQ2xhc3NNYW5hZ2VyXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBidWlsZENNVmlld1BsdWdpbihwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIC8vIEltcGxlbWVudHMgdGhlIGxpdmUgcHJldmlldyBzdXBlcmNoYXJnaW5nXG4gICAgLy8gQ29kZSBzdHJ1Y3R1cmUgYmFzZWQgb24gaHR0cHM6Ly9naXRodWIuY29tL25vdGhpbmdpc2xvc3Qvb2JzaWRpYW4tY202LWF0dHJpYnV0ZXMvYmxvYi83NDNkNzFiMGFhNjE2NDA3MTQ5YTBiNmVhNWZmZWEyOGUyMTU0MTU4L3NyYy9tYWluLnRzXG4gICAgLy8gQ29kZSBoZWxwIGNyZWRpdHMgdG8gQE5vdGhpbmdJc0xvc3QhIFRoZXkgaGF2ZSBiZWVuIGEgZ3JlYXQgaGVscCBnZXR0aW5nIHRoaXMgdG8gd29yayBwcm9wZXJseS5cbiAgICBjbGFzcyBIZWFkZXJXaWRnZXQgZXh0ZW5kcyBXaWRnZXRUeXBlIHtcbiAgICAgICAgZmlsZUNsYXNzTmFtZT86IHN0cmluZ1xuICAgICAgICBhZnRlcjogYm9vbGVhblxuICAgICAgICBkZXN0TmFtZTogc3RyaW5nXG5cbiAgICAgICAgY29uc3RydWN0b3IoZmlsZUNsYXNzTmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkLCBhZnRlcjogYm9vbGVhbiwgZGVzdE5hbWU6IHN0cmluZykge1xuICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzTmFtZSA9IGZpbGVDbGFzc05hbWVcbiAgICAgICAgICAgIHRoaXMuYWZ0ZXIgPSBhZnRlclxuICAgICAgICAgICAgdGhpcy5kZXN0TmFtZSA9IGRlc3ROYW1lXG4gICAgICAgIH1cblxuICAgICAgICB0b0RPTSgpIHtcbiAgICAgICAgICAgIGxldCBtZXRhZGF0YU1lbnVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhTWVudUJ0bi5zZXRBdHRyKFwiZmlsZWNsYXNzLW5hbWVcIiwgdGhpcy5maWxlQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICBtZXRhZGF0YU1lbnVCdG4uYWRkQ2xhc3MoJ2ZpbGVjbGFzcy1pY29uJyk7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGFNZW51QnRuLmFkZENsYXNzKCdtZXRhZGF0YS1tZW51Jyk7XG4gICAgICAgICAgICAgICAgbGV0IGZpbGVDbGFzcyA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQodGhpcy5maWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgICAgICAgICAgICAgaWYgKGNsYXNzRmlsZXNQYXRoICYmIHRoaXMuZGVzdE5hbWUuaW5jbHVkZXMoY2xhc3NGaWxlc1BhdGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGljb24gPSBcImZpbGUtc3ByZWFkc2hlZXRcIlxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3MgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc1BhdGguZ2V0KHRoaXMuZGVzdE5hbWUgKyBcIi5tZFwiKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRJY29uKG1ldGFkYXRhTWVudUJ0biwgaWNvbiB8fCBzZXR0aW5ncy5idXR0b25JY29uKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGFNZW51QnRuLm9uY2xpY2sgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uYWRkQ2hpbGQobmV3IEZpbGVDbGFzc01hbmFnZXIocGx1Z2luLCBmaWxlQ2xhc3MpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVDbGFzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGljb24gPSBmaWxlQ2xhc3MuZ2V0SWNvbigpO1xuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKG1ldGFkYXRhTWVudUJ0biwgaWNvbiB8fCBzZXR0aW5ncy5idXR0b25JY29uKVxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YU1lbnVCdG4ub25jbGljayA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGAke3RoaXMuZGVzdE5hbWV9Lm1kYClcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVGaWVsZHNDb21wb25lbnQgPSBuZXcgTm90ZUZpZWxkc0NvbXBvbmVudChwbHVnaW4sIFwiMVwiLCAoKSA9PiB7IH0sIGZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmFkZENoaWxkKG5vdGVGaWVsZHNDb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY3JlYXRlIGEgbmFpdmUgYnJlYWQgY3J1bWJcbiAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YU1lbnVCdG47XG4gICAgICAgIH1cblxuICAgICAgICBpZ25vcmVFdmVudCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgc2V0dGluZ3MgPSBwbHVnaW4uc2V0dGluZ3M7XG4gICAgY29uc3Qgdmlld1BsdWdpbiA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxuICAgICAgICBjbGFzcyB7XG4gICAgICAgICAgICBkZWNvcmF0aW9uczogRGVjb3JhdGlvblNldDtcblxuICAgICAgICAgICAgY29uc3RydWN0b3IodmlldzogRWRpdG9yVmlldykge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModmlldyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodXBkYXRlLmRvY0NoYW5nZWQgfHwgdXBkYXRlLnZpZXdwb3J0Q2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gdGhpcy5idWlsZERlY29yYXRpb25zKHVwZGF0ZS52aWV3KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJ1aWxkRGVjb3JhdGlvbnModmlldzogRWRpdG9yVmlldykge1xuICAgICAgICAgICAgICAgIGxldCBidWlsZGVyID0gbmV3IFJhbmdlU2V0QnVpbGRlcjxEZWNvcmF0aW9uPigpO1xuICAgICAgICAgICAgICAgIGlmICghc2V0dGluZ3MuZW5hYmxlRWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBidWlsZGVyLmZpbmlzaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBtZFZpZXcgPSB2aWV3LnN0YXRlLmZpZWxkKGVkaXRvclZpZXdGaWVsZCkgYXMgTWFya2Rvd25WaWV3O1xuICAgICAgICAgICAgICAgIGxldCBsYXN0QXR0cmlidXRlcyA9IHt9O1xuICAgICAgICAgICAgICAgIGxldCBpY29uRGVjb0FmdGVyOiBEZWNvcmF0aW9uIHwgbnVsbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgbGV0IGljb25EZWNvQWZ0ZXJXaGVyZTogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICBsZXQgbWRBbGlhc0Zyb206IG51bWJlciB8IG51bGwgPSBudWxsO1xuICAgICAgICAgICAgICAgIGxldCBtZEFsaWFzVG86IG51bWJlciB8IG51bGwgPSBudWxsO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IHsgZnJvbSwgdG8gfSBvZiB2aWV3LnZpc2libGVSYW5nZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ludGF4VHJlZSh2aWV3LnN0YXRlKS5pdGVyYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb20sXG4gICAgICAgICAgICAgICAgICAgICAgICB0byxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyOiAobm9kZSkgPT4ge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b2tlblByb3BzID0gbm9kZS50eXBlLnByb3AodG9rZW5DbGFzc05vZGVQcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5Qcm9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9wcyA9IG5ldyBTZXQodG9rZW5Qcm9wcy5zcGxpdChcIiBcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0xpbmsgPSBwcm9wcy5oYXMoXCJobWQtaW50ZXJuYWwtbGlua1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBbGlhcyA9IHByb3BzLmhhcyhcImxpbmstYWxpYXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzUGlwZSA9IHByb3BzLmhhcyhcImxpbmstYWxpYXMtcGlwZVwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgJ2FsaWFzJyBvZiB0aGUgbWQgbGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc01ETGluayA9IHByb3BzLmhhcygnbGluaycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgJ2ludGVybmFsIGxpbmsnIG9mIHRoZSBtZCBsaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTURVcmwgPSBwcm9wcy5oYXMoJ3VybCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc01ERm9ybWF0dGluZyA9IHByb3BzLmhhcygnZm9ybWF0dGluZy1saW5rJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTURMaW5rICYmICFpc01ERm9ybWF0dGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGluazogVGhlICdhbGlhcydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVSTDogVGhlIGludGVybmFsIGxpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1kQWxpYXNGcm9tID0gbm9kZS5mcm9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWRBbGlhc1RvID0gbm9kZS50bztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNQaXBlICYmICFpc0FsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWNvbkRlY29BZnRlciAmJiBpY29uRGVjb0FmdGVyV2hlcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChpY29uRGVjb0FmdGVyV2hlcmUsIGljb25EZWNvQWZ0ZXJXaGVyZSwgaWNvbkRlY29BZnRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlcldoZXJlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNMaW5rICYmICFpc0FsaWFzICYmICFpc1BpcGUgfHwgaXNNRFVybCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmtUZXh0ID0gdmlldy5zdGF0ZS5kb2Muc2xpY2VTdHJpbmcobm9kZS5mcm9tLCBub2RlLnRvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtUZXh0ID0gbGlua1RleHQuc3BsaXQoXCIjXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGlua1RleHQsIG1kVmlldy5maWxlLmJhc2VuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc01EVXJsICYmICFmaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRlY29kZVVSSUNvbXBvbmVudChsaW5rVGV4dCkpIGFzIFRGaWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGZpbGUucGF0aCk/Lmxhc3QoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7IFwiZmlsZWNsYXNzLW5hbWVcIjogZmlsZUNsYXNzTmFtZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWNvID0gRGVjb3JhdGlvbi5tYXJrKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJmaWxlY2xhc3MtdGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaWNvbkRlY29CZWZvcmUgPSBEZWNvcmF0aW9uLndpZGdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXQ6IG5ldyBIZWFkZXJXaWRnZXQoZmlsZUNsYXNzTmFtZSwgZmFsc2UpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlciA9IERlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldDogbmV3IEhlYWRlcldpZGdldChmaWxlQ2xhc3NOYW1lLCB0cnVlLCBmaWxlLnBhdGgucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIikpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNRFVybCAmJiBtZEFsaWFzRnJvbSAmJiBtZEFsaWFzVG8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHJldHJvYWN0aXZlbHkgdG8gdGhlIGFsaWFzIGZvdW5kIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRlY28gPSBEZWNvcmF0aW9uLm1hcmsoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFwiZmlsZWNsYXNzLXRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2J1aWxkZXIuYWRkKG1kQWxpYXNGcm9tLCBtZEFsaWFzRnJvbSwgaWNvbkRlY29CZWZvcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobWRBbGlhc0Zyb20sIG1kQWxpYXNUbywgZGVjbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWNvbkRlY29BZnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKG1kQWxpYXNUbywgbWRBbGlhc1RvLCBpY29uRGVjb0FmdGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyV2hlcmUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1kQWxpYXNGcm9tID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZEFsaWFzVG8gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobm9kZS5mcm9tLCBub2RlLmZyb20sIGljb25EZWNvQmVmb3JlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKG5vZGUuZnJvbSwgbm9kZS50bywgZGVjbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RBdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlcldoZXJlID0gbm9kZS50bztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNMaW5rICYmIGlzQWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWNvID0gRGVjb3JhdGlvbi5tYXJrKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBsYXN0QXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJmaWxlY2xhc3MtdGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKG5vZGUuZnJvbSwgbm9kZS50bywgZGVjbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWNvbkRlY29BZnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKG5vZGUudG8sIG5vZGUudG8sIGljb25EZWNvQWZ0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25EZWNvQWZ0ZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25EZWNvQWZ0ZXJXaGVyZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXIuZmluaXNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlY29yYXRpb25zOiB2ID0+IHYuZGVjb3JhdGlvbnNcbiAgICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIHZpZXdQbHVnaW47XG59IiwgImltcG9ydCB7IENvbXBvbmVudCwgTm90aWNlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgcmVzb2x2ZUxvb2t1cHMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Jlc29sdmVMb29rdXBzXCI7XG5pbXBvcnQgeyB1cGRhdGVMb29rdXBzIH0gZnJvbSBcInNyYy9jb21tYW5kcy91cGRhdGVMb29rdXBzXCI7XG5pbXBvcnQgeyB1cGRhdGVGb3JtdWxhcywgY2xlYW5SZW1vdmVkRm9ybXVsYXNGcm9tSW5kZXggfSBmcm9tIFwic3JjL2NvbW1hbmRzL3VwZGF0ZUZvcm11bGFzXCI7XG5cbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgU3RhdHVzIGFzIExvb2t1cFN0YXR1cywgVHlwZSBhcyBMb29rdXBUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9sb29rdXBUeXBlc1wiO1xuaW1wb3J0IHsgdXBkYXRlQ2FudmFzIH0gZnJvbSBcInNyYy9jb21tYW5kcy91cGRhdGVDYW52YXNcIjtcbmltcG9ydCB7IENhbnZhc0RhdGEgfSBmcm9tIFwib2JzaWRpYW4vY2FudmFzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZWxkSW5kZXggZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgcHVibGljIGZpbGVDbGFzc2VzRmllbGRzOiBNYXA8c3RyaW5nLCBGaWVsZFtdPjtcbiAgICBwdWJsaWMgZmllbGRzRnJvbUdsb2JhbEZpbGVDbGFzczogRmllbGRbXTtcbiAgICBwdWJsaWMgZmlsZXNGaWVsZHNGcm9tVGFnczogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpbGVzRmllbGRzRnJvbUZpbGVDbGFzc1F1ZXJpZXM6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzOiBNYXA8c3RyaW5nLCBGaWVsZFtdPjtcbiAgICBwdWJsaWMgZmlsZXNGaWVsZHM6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWxlc0xvb2t1cHNBbmRGb3JtdWxhc0ZpZWxkczogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpbGVzTG9va3VwQW5kRm9ybXVsYUZpZWxkc0V4aXN0czogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpbGVzRmlsZUNsYXNzZXM6IE1hcDxzdHJpbmcsIEZpbGVDbGFzc1tdPjtcbiAgICBwdWJsaWMgZmlsZXNGaWxlQ2xhc3Nlc05hbWVzOiBNYXA8c3RyaW5nLCBzdHJpbmdbXSB8IHVuZGVmaW5lZD47XG4gICAgcHVibGljIGZpbGVDbGFzc2VzQW5jZXN0b3JzOiBNYXA8c3RyaW5nLCBzdHJpbmdbXT5cbiAgICBwdWJsaWMgZmlsZUNsYXNzZXNQYXRoOiBNYXA8c3RyaW5nLCBGaWxlQ2xhc3M+O1xuICAgIHB1YmxpYyBmaWxlQ2xhc3Nlc05hbWU6IE1hcDxzdHJpbmcsIEZpbGVDbGFzcz47XG4gICAgcHVibGljIHZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlczogTWFwPHN0cmluZywgc3RyaW5nW10+O1xuICAgIHB1YmxpYyB0YWdzTWF0Y2hpbmdGaWxlQ2xhc3NlczogTWFwPHN0cmluZywgRmlsZUNsYXNzPjtcbiAgICBwdWJsaWMgZmlsZUxvb2t1cEZpbGVzOiBNYXA8c3RyaW5nLCBhbnlbXT47XG4gICAgcHVibGljIGZpbGVMb29rdXBGaWVsZHNTdGF0dXM6IE1hcDxzdHJpbmcsIExvb2t1cFN0YXR1cz47XG4gICAgcHVibGljIGZpbGVGb3JtdWxhRmllbGRzU3RhdHVzOiBNYXA8c3RyaW5nLCBMb29rdXBTdGF0dXM+O1xuICAgIHB1YmxpYyBwcmV2aW91c0ZpbGVMb29rdXBGaWxlc1ZhbHVlczogTWFwPHN0cmluZywgbnVtYmVyPjtcbiAgICBwdWJsaWMgZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlOiBNYXA8c3RyaW5nLCBzdHJpbmc+O1xuICAgIHB1YmxpYyBmaWxlTG9va3VwRmllbGRMYXN0T3V0cHV0VHlwZTogTWFwPHN0cmluZywga2V5b2YgdHlwZW9mIExvb2t1cFR5cGU+O1xuICAgIHB1YmxpYyBmaWxlRm9ybXVsYUZpZWxkTGFzdFZhbHVlOiBNYXA8c3RyaW5nLCBzdHJpbmc+O1xuICAgIHB1YmxpYyBjYW52YXNMYXN0RmlsZXM6IE1hcDxzdHJpbmcsIHN0cmluZ1tdPlxuICAgIHB1YmxpYyBsb29rdXBRdWVyaWVzOiBNYXA8c3RyaW5nLCBGaWVsZD47XG4gICAgcHVibGljIGR2OiBhbnk7XG4gICAgcHVibGljIGxhc3RSZXZpc2lvbjogMDtcbiAgICBwdWJsaWMgZmlsZUNoYW5nZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwdWJsaWMgZHZSZWFkeTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHB1YmxpYyBsb2FkVGltZTogbnVtYmVyO1xuICAgIHB1YmxpYyBmaXJzdEluZGV4aW5nRG9uZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgY2xhc3NGaWxlc1BhdGg6IHN0cmluZyB8IG51bGw7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LCBwdWJsaWMgY2FjaGVWZXJzaW9uOiBzdHJpbmcsIHB1YmxpYyBvbkNoYW5nZTogKCkgPT4gdm9pZCkge1xuICAgICAgICBzdXBlcigpXG4gICAgICAgIHRoaXMuZmx1c2hDYWNoZSgpO1xuICAgICAgICB0aGlzLmZpbGVMb29rdXBGaWxlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUxvb2t1cEZpZWxkc1N0YXR1cyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlRm9ybXVsYUZpZWxkc1N0YXR1cyA9IG5ldyBNYXAoKVxuICAgICAgICB0aGlzLnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuY2FudmFzTGFzdEZpbGVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmR2ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldztcbiAgICAgICAgdGhpcy5jbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aDtcbiAgICB9XG5cbiAgICBhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cbiAgICAgICAgdGhpcy5sb2FkVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIGF3YWl0IChhc3luYyAoKSA9PiB7IH0pKCk7IC8vb25seSB3YXkgdG8gaGF2ZSBtZXRhZGF0YSBidXR0b24gdG8gc2hvdyB1cCBhdCByZWxvYWQgIT8hXG5cbiAgICAgICAgaWYgKHRoaXMuZHY/LmFwaS5pbmRleC5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgdGhpcy5kdiA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc7XG4gICAgICAgICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMuZHYuYXBpLmluZGV4LnJldmlzaW9uO1xuICAgICAgICAgICAgdGhpcy5kdlJlYWR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZnVsbEluZGV4KFwiZHYgaXMgcnVubmluZ1wiLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbihcImRhdGF2aWV3OmluZGV4LXJlYWR5XCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmR2ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldztcbiAgICAgICAgICAgICAgICB0aGlzLmR2UmVhZHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZnVsbEluZGV4KFwiZHYgaW5kZXhcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdFJldmlzaW9uID0gdGhpcy5kdi5hcGkuaW5kZXgucmV2aXNpb247XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ3Jlc29sdmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJvYnNpZGlhbiByZXNvbHZlZFwiKVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmZ1bGxJbmRleChcImNhY2hlIHJlc29sdmVkXCIsIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24gfHwgMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm9uKFwibW9kaWZ5XCIsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZmlsZSAke2ZpbGUucGF0aH0gY2hhbmdlZGApXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJjYW52YXNcIikge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVDYW52YXModGhpcy5wbHVnaW4sIHsgY2FudmFzOiBmaWxlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignZGF0YXZpZXc6bWV0YWRhdGEtY2hhbmdlJywgYXN5bmMgKG9wOiBhbnksIGZpbGU6IFRGaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInNvbWUgZmlsZSBjaGFuZ2VkXCIsIHRoaXMuZmlsZUNoYW5nZWQpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuZXcgcmV2aXNpb25cIiwgdGhpcy5kdj8uYXBpLmluZGV4LnJldmlzaW9uKVxuICAgICAgICAgICAgICAgIGlmIChvcCA9PT0gXCJ1cGRhdGVcIlxuICAgICAgICAgICAgICAgICAgICAvL2RhdGF2aWV3IGlzIHRyaWdnZXJpbmcgXCJ1cGRhdGVcIiBvbiBtZXRhZGF0YWNhY2hlLm9uKFwicmVzb2x2ZVwiKSBldmVuIGlmIG5vIGNoYW5nZSBpbiB0aGUgZmlsZS4gSXQgb2NjdXJzIGF0IGFwcCBsYXVuY2hcbiAgICAgICAgICAgICAgICAgICAgLy9jaGVjayBpZiB0aGUgZmlsZSBtdGltZSBpcyBvbGRlciB0aGF0IHBsdWdpbiBsb2FkIC0+IGluIHRoaXMgY2FzZSBubyBmaWxlIGhhcyBjaGFuZ2UsIG5vIG5lZWQgdG8gdXBsZGF0ZSBsb29rdXBzXG4gICAgICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5maWxlQ2FjaGVbZmlsZS5wYXRoXS5tdGltZSA+PSB0aGlzLmxvYWRUaW1lXG4gICAgICAgICAgICAgICAgICAgICYmIHRoaXMuZHY/LmFwaS5pbmRleC5yZXZpc2lvbiAhPT0gdGhpcy5sYXN0UmV2aXNpb25cbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5maWxlQ2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLmR2UmVhZHlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9tYXliZSBmdWxsSW5kZXggZGlkbid0IGNhdGNoIG5ldyBmaWxlcyB0aGF0IGhhdmUgdG8gYmUgdXBkYXRlZDogbGV0J3MgcmVidWlsZCBnZXRGaWxlRmllbGRzRXhpc3QgZm9yIHRoaXMgZmlsZVxuICAgICAgICAgICAgICAgICAgICBjbGVhblJlbW92ZWRGb3JtdWxhc0Zyb21JbmRleCh0aGlzLnBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RmlsZXNMb29rdXBBbmRGb3JtdWxhRmllbGRzRXhpc3RzKGZpbGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jbGFzc0ZpbGVzUGF0aCAmJiBmaWxlLnBhdGguc3RhcnRzV2l0aCh0aGlzLmNsYXNzRmlsZXNQYXRoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5mdWxsSW5kZXgoXCJmaWxlQ2xhc3MgY2hhbmdlZFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRoaXMuZmlsZUNsYXNzZXNQYXRoLmdldChmaWxlLnBhdGgpPy5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW52YXNGaWVsZHMgPSAoZmlsZUNsYXNzTmFtZSAmJiB0aGlzLmZpbGVDbGFzc2VzRmllbGRzLmdldChmaWxlQ2xhc3NOYW1lKT8uZmlsdGVyKGZpZWxkID0+IGZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5DYW52YXMpKSB8fCBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzRmllbGRzLmZvckVhY2goYXN5bmMgZmllbGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbnZhc0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpZWxkLm9wdGlvbnMuY2FudmFzUGF0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FudmFzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGNhbnZhc0ZpbGUuZXh0ZW5zaW9uID09PSBcImNhbnZhc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZUNhbnZhcyh0aGlzLnBsdWdpbiwgeyBjYW52YXM6IGNhbnZhc0ZpbGUgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVGb3JtdWxhcyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc29sdmVMb29rdXBzKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzTmFtZUZyb21QYXRoKHRoaXMucGx1Z2luLCBmaWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUxvb2t1cHMoZmlsZUNsYXNzTmFtZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMuZHYuYXBpLmluZGV4LnJldmlzaW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLnRyaWdnZXIoXCJtZXRhZGF0YS1tZW51OmluZGV4ZWRcIilcbiAgICB9XG5cblxuICAgIHByaXZhdGUgZmx1c2hDYWNoZSgpIHtcbiAgICAgICAgdGhpcy5maWxlc0ZpZWxkcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0xvb2t1cHNBbmRGb3JtdWxhc0ZpZWxkcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0xvb2t1cEFuZEZvcm11bGFGaWVsZHNFeGlzdHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmllbGRzRnJvbUdsb2JhbEZpbGVDbGFzcyA9IFtdO1xuICAgICAgICB0aGlzLmZpbGVzRmllbGRzRnJvbVRhZ3MgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzUXVlcmllcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVDbGFzc2VzUGF0aCA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc05hbWUgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMudmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmxvb2t1cFF1ZXJpZXMgPSBuZXcgTWFwKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZnVsbEluZGV4KGV2ZW50OiBzdHJpbmcsIGZvcmNlX3VwZGF0ZV9hbGwgPSBmYWxzZSwgd2l0aG91dF9sb29rdXBzID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0IGluZGV4IFtcIiwgZXZlbnQsIFwiXVwiLCB0aGlzLmxhc3RSZXZpc2lvbiwgXCItPlwiLCB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24pXG4gICAgICAgIGxldCBzdGFydCA9IERhdGUubm93KCksIHRpbWUgPSBEYXRlLm5vdygpXG4gICAgICAgIHRoaXMuZmx1c2hDYWNoZSgpO1xuICAgICAgICB0aGlzLmdldEZpbGVDbGFzc2VzQW5jZXN0b3JzKCk7XG4gICAgICAgIHRoaXMuZ2V0R2xvYmFsRmlsZUNsYXNzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZUNsYXNzZXMoKTtcbiAgICAgICAgdGhpcy5nZXRMb29rdXBRdWVyaWVzKCk7XG4gICAgICAgIHRoaXMucmVzb2x2ZUZpbGVDbGFzc01hdGNoaW5nVGFncygpO1xuICAgICAgICB0aGlzLnJlc29sdmVGaWxlQ2xhc3NRdWVyaWVzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZXNGaWVsZHMoKTtcbiAgICAgICAgdGhpcy5nZXRGaWxlc0xvb2t1cEFuZEZvcm11bGFGaWVsZHNFeGlzdHMoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5nZXRDYW52YXNlc0ZpbGVzKCk7XG4gICAgICAgIGF3YWl0IHRoaXMuZ2V0VmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzKCk7XG4gICAgICAgIHRoaXMucmVzb2x2ZUxvb2t1cHMod2l0aG91dF9sb29rdXBzKTtcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVMb29rdXBzKFwiZnVsbCBJbmRleFwiLCB3aXRob3V0X2xvb2t1cHMsIGZvcmNlX3VwZGF0ZV9hbGwpO1xuICAgICAgICBpZiAoZm9yY2VfdXBkYXRlX2FsbCB8fCAhdGhpcy5maXJzdEluZGV4aW5nRG9uZSkgYXdhaXQgdGhpcy51cGRhdGVGb3JtdWxhcyhmb3JjZV91cGRhdGVfYWxsKTsgLy9jYWxjdWxhdGUgZm9ybXVsYXMgYXQgc3RhcnQgb2Ygd2l0aCBmb3JjZSB1cGRhdGVcbiAgICAgICAgdGhpcy5maXJzdEluZGV4aW5nRG9uZSA9IHRydWU7XG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UudHJpZ2dlcihcIm1ldGFkYXRhLW1lbnU6dXBkYXRlZC1pbmRleFwiKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImVuZCBpbmRleCBbXCIsIGV2ZW50LCBcIl1cIiwgdGhpcy5sYXN0UmV2aXNpb24sIFwiLT5cIiwgdGhpcy5kdj8uYXBpLmluZGV4LnJldmlzaW9uLCBgJHsoRGF0ZS5ub3coKSAtIHN0YXJ0KX1tc2ApXG4gICAgfVxuXG4gICAgcmVzb2x2ZUxvb2t1cHMod2l0aG91dF9sb29rdXBzOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGlmICghd2l0aG91dF9sb29rdXBzKSByZXNvbHZlTG9va3Vwcyh0aGlzLnBsdWdpbik7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0Q2FudmFzZXNGaWxlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY2FudmFzZXMgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIodCA9PiB0LmV4dGVuc2lvbiA9PT0gXCJjYW52YXNcIilcbiAgICAgICAgY2FudmFzZXMuZm9yRWFjaChhc3luYyBjYW52YXMgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudEZpbGVzUGF0aHM6IHN0cmluZ1tdID0gW11cbiAgICAgICAgICAgIGxldCB7IG5vZGVzLCBlZGdlcyB9OiBDYW52YXNEYXRhID0geyBub2RlczogW10sIGVkZ2VzOiBbXSB9O1xuICAgICAgICAgICAgY29uc3QgcmF3Q29udGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKGNhbnZhcylcbiAgICAgICAgICAgIGlmIChyYXdDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FudmFzQ29udGVudCA9IEpTT04ucGFyc2UocmF3Q29udGVudCkgYXMgQ2FudmFzRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMgPSBjYW52YXNDb250ZW50Lm5vZGVzO1xuICAgICAgICAgICAgICAgICAgICBlZGdlcyA9IGNhbnZhc0NvbnRlbnQuZWRnZXNcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgQ291bGRuJ3QgcmVhZCAke2NhbnZhcy5wYXRofWApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZXM/LmZvckVhY2goYXN5bmMgbm9kZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gXCJmaWxlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0RmlsZVBhdGggPSBub2RlLmZpbGVcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50RmlsZXNQYXRocy5pbmNsdWRlcyh0YXJnZXRGaWxlUGF0aCkpIGN1cnJlbnRGaWxlc1BhdGhzLnB1c2godGFyZ2V0RmlsZVBhdGgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHRoaXMuY2FudmFzTGFzdEZpbGVzLnNldChjYW52YXMucGF0aCwgY3VycmVudEZpbGVzUGF0aHMpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlTG9va3Vwcyhzb3VyY2U6IHN0cmluZyA9IFwiXCIsIHdpdGhvdXRfbG9va3VwczogYm9vbGVhbiwgZm9yY2VfdXBkYXRlX2FsbDogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXdpdGhvdXRfbG9va3Vwcykge1xuICAgICAgICAgICAgaWYgKGZvcmNlX3VwZGF0ZV9hbGwpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVMb29rdXBzKHRoaXMucGx1Z2luLCBzb3VyY2UsIHVuZGVmaW5lZCwgdHJ1ZSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlTG9va3Vwcyh0aGlzLnBsdWdpbiwgc291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZUZvcm11bGFzKGZvcmNlX3VwZGF0ZV9hbGw6IGJvb2xlYW4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdXBkYXRlRm9ybXVsYXModGhpcy5wbHVnaW4sIHVuZGVmaW5lZCwgZm9yY2VfdXBkYXRlX2FsbCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0VmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmZpbGVDbGFzc2VzTmFtZS5mb3JFYWNoKChmaWxlQ2xhc3MpID0+IHtcbiAgICAgICAgICAgIGZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZvckVhY2goYXN5bmMgYXR0ciA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhdHRyLm9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgISEoYXR0ci5vcHRpb25zIGFzIFJlY29yZDxzdHJpbmcsIGFueT4pW1widmFsdWVzTGlzdE5vdGVQYXRoXCJdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzLnNldChcbiAgICAgICAgICAgICAgICAgICAgICAgIChhdHRyLm9wdGlvbnMgYXMgUmVjb3JkPHN0cmluZywgYW55PikudmFsdWVzTGlzdE5vdGVQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgRmllbGRTZXR0aW5nLmdldFZhbHVlc0xpc3RGcm9tTm90ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYXR0ci5vcHRpb25zIGFzIFJlY29yZDxzdHJpbmcsIGFueT4pLnZhbHVlc0xpc3ROb3RlUGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZvckVhY2goYXN5bmMgc2V0dGluZyA9PiB7XG4gICAgICAgICAgICBpZiAoc2V0dGluZy5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzLnNldChcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZy5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgRmllbGRTZXR0aW5nLmdldFZhbHVlc0xpc3RGcm9tTm90ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZy5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aFxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEZpbGVDbGFzc2VzQW5jZXN0b3JzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgICAgIC8vMS4gaXRlcmF0ZSBvdmVyIGZpbGVDbGFzc2VzIHRvIGluaXQgZmlsZUNsYXNzZXNBbmNlc3RvcnNcbiAgICAgICAgaWYgKGNsYXNzRmlsZXNQYXRoKSB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmID0+IGYucGF0aC5pbmNsdWRlcyhjbGFzc0ZpbGVzUGF0aCkpXG4gICAgICAgICAgICAgICAgLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzTmFtZUZyb21QYXRoKHRoaXMucGx1Z2luLCBmLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZik/LmZyb250bWF0dGVyPy5leHRlbmRzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50RmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7Y2xhc3NGaWxlc1BhdGh9JHtwYXJlbnR9Lm1kYClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50RmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzQW5jZXN0b3JzLnNldChmaWxlQ2xhc3NOYW1lLCBbcGFyZW50XSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzQW5jZXN0b3JzLnNldChmaWxlQ2xhc3NOYW1lLCBbXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMuc2V0KGZpbGVDbGFzc05hbWUsIFtdKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICAvLzIuIGZvciBlYWNoIGZpbGVDbGFzcyBnZXQgYW5jZXN0b3JzIHJlY3Vyc2l2ZWx5IC0gc3RvcCB3aGVuIGFuIGFuY2VzdG9yIGlzIHRoZSBmaWxlQ2xhc3NcbiAgICAgICAgWy4uLnRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnNdLmZvckVhY2goKFtmaWxlQ2xhc3NOYW1lLCBhbmNlc3RvcnNdKSA9PiB7XG4gICAgICAgICAgICBpZiAoYW5jZXN0b3JzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdldEFuY2VzdG9yc1JlY3Vyc2l2ZWx5KGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG5cbiAgICBnZXRBbmNlc3RvcnNSZWN1cnNpdmVseShmaWxlQ2xhc3NOYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgYW5jZXN0b3JzID0gdGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgaWYgKGFuY2VzdG9ycyAmJiBhbmNlc3RvcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBsYXN0QW5jZXN0b3IgPSBhbmNlc3RvcnMubGFzdCgpO1xuICAgICAgICAgICAgY29uc3QgbGFzdEFuY2VzdG9yUGFyZW50ID0gdGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5nZXQobGFzdEFuY2VzdG9yISk/LlswXTtcbiAgICAgICAgICAgIGlmIChsYXN0QW5jZXN0b3JQYXJlbnQgJiYgbGFzdEFuY2VzdG9yUGFyZW50ICE9PSBmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5zZXQoZmlsZUNsYXNzTmFtZSwgWy4uLmFuY2VzdG9ycywgbGFzdEFuY2VzdG9yUGFyZW50XSk7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRBbmNlc3RvcnNSZWN1cnNpdmVseShmaWxlQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEdsb2JhbEZpbGVDbGFzcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZ2xvYmFsRmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzXG4gICAgICAgIGlmICghZ2xvYmFsRmlsZUNsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MgPSBbXVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MgPSBGaWxlQ2xhc3NcbiAgICAgICAgICAgICAgICAgICAgLmNyZWF0ZUZpbGVDbGFzcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cmlidXRlcy5tYXAoYXR0ciA9PiBhdHRyLmdldEZpZWxkKCkpXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgeyB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRGaWxlQ2xhc3NlcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSB0aGlzLmNsYXNzRmlsZXNQYXRoXG4gICAgICAgIGlmIChjbGFzc0ZpbGVzUGF0aCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLnBhdGguaW5jbHVkZXMoY2xhc3NGaWxlc1BhdGgpKVxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLnBsdWdpbiwgZi5wYXRoKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBGaWxlQ2xhc3MuY3JlYXRlRmlsZUNsYXNzKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMuc2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3MuYXR0cmlidXRlcy5tYXAoYXR0ciA9PiBhdHRyLmdldEZpZWxkKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNQYXRoLnNldChmLnBhdGgsIGZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzTmFtZS5zZXQoZmlsZUNsYXNzLm5hbWUsIGZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyPy5tYXBXaXRoVGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZT8uZnJvbnRtYXR0ZXI/LnRhZ05hbWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBfdGFnTmFtZXMgPSBjYWNoZT8uZnJvbnRtYXR0ZXI/LnRhZ05hbWVzIGFzIHN0cmluZyB8IHN0cmluZ1tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnTmFtZXMgPSBBcnJheS5pc0FycmF5KF90YWdOYW1lcykgPyBbLi4uX3RhZ05hbWVzXSA6IF90YWdOYW1lcy5zcGxpdChcIixcIikubWFwKHQgPT4gdC50cmltKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOYW1lcy5mb3JFYWNoKHRhZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0YWcuaW5jbHVkZXMoXCIgXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMuc2V0KHRhZywgZmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWZpbGVDbGFzc05hbWUuaW5jbHVkZXMoXCIgXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzLnNldChmaWxlQ2xhc3NOYW1lLCBmaWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZXJyb3IpIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldExvb2t1cFF1ZXJpZXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkxvb2t1cCkuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvb2t1cFF1ZXJpZXMuc2V0KGBwcmVzZXRGaWVsZF9fXyR7ZmllbGQubmFtZX1gLCBmaWVsZClcbiAgICAgICAgfSk7XG4gICAgICAgIFsuLi50aGlzLmZpbGVDbGFzc2VzRmllbGRzXS5mb3JFYWNoKChbZmlsZUNsYXNzTmFtZSwgZmllbGRzXSkgPT4ge1xuICAgICAgICAgICAgZmllbGRzLmZpbHRlcihmaWVsZCA9PiBmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwKS5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvb2t1cFF1ZXJpZXMuc2V0KGAke2ZpbGVDbGFzc05hbWV9X19fJHtmaWVsZC5uYW1lfWAsIGZpZWxkKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICByZXNvbHZlRmlsZUNsYXNzTWF0Y2hpbmdUYWdzKCk6IHZvaWQge1xuICAgICAgICBpZiAoIVsuLi50aGlzLnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzXS5sZW5ndGgpIHJldHVyblxuICAgICAgICAvL0FsdGVybmF0aXZlIHdheVxuICAgICAgICBjb25zdCBtYXBwZWRUYWdzID0gWy4uLnRoaXMudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMua2V5cygpXVxuICAgICAgICBjb25zdCBmaWxlc1dpdGhNYXBwZWRUYWdRdWVyeSA9IG1hcHBlZFRhZ3MubWFwKHQgPT4gYCMke3R9YCkuam9pbihcIiBvciBcIilcbiAgICAgICAgdGhpcy5kdi5hcGkucGFnZXMoZmlsZXNXaXRoTWFwcGVkVGFnUXVlcnkpLmZvckVhY2goKGR2RmlsZTogYW55KSA9PiB7XG4gICAgICAgICAgICBkdkZpbGUuZmlsZS50YWdzLmZvckVhY2goKF90YWc6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZyA9IF90YWcucmVwbGFjZSgvXlxcIy8sIFwiXCIpXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy50YWdzTWF0Y2hpbmdGaWxlQ2xhc3Nlcy5nZXQodGFnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGR2RmlsZS5maWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXMuc2V0KGZpbGVQYXRoLCBbLi4ubmV3IFNldChbLi4uKHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5nZXQoZmlsZVBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzXSldKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5zZXQoZHZGaWxlLmZpbGUucGF0aCwgWy4uLm5ldyBTZXQoWy4uLih0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZmlsZVBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzLm5hbWVdKV0pXG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVRhZyA9IHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVDbGFzcy5uYW1lKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmllbGRzID0gdGhpcy5maWxlc0ZpZWxkc0Zyb21UYWdzLmdldChmaWxlUGF0aClcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVRhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3RmllbGRzID0gWy4uLmZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21UYWddXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJlZEN1cnJlbnRGaWVsZHMgPSBjdXJyZW50RmllbGRzPy5maWx0ZXIoZmllbGQgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhbmV3RmllbGRzLm1hcChmID0+IGYubmFtZSkuaW5jbHVkZXMoZmllbGQubmFtZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZmlsZUNsYXNzLm9wdGlvbnM/LmV4Y2x1ZGVzPy5tYXAoYXR0ciA9PiBhdHRyLm5hbWUpLmluY2x1ZGVzKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICApIHx8IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5maWx0ZXJlZEN1cnJlbnRGaWVsZHMpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmllbGRzRnJvbVRhZ3Muc2V0KGZpbGVQYXRoLCBuZXdGaWVsZHMpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHJlc29sdmVGaWxlQ2xhc3NRdWVyaWVzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NRdWVyaWVzLmZvckVhY2goc2ZjcSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmY3EgPSBuZXcgRmlsZUNsYXNzUXVlcnkoc2ZjcS5uYW1lLCBzZmNxLmlkLCBzZmNxLnF1ZXJ5LCBzZmNxLmZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICBmY3EuZ2V0UmVzdWx0cyhkdkFwaSkuZm9yRWFjaCgocmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLmZpbGVDbGFzc2VzTmFtZS5nZXQoZmNxLmZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmID0gcmVzdWx0LmZpbGVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFsuLi5uZXcgU2V0KFsuLi4odGhpcy5maWxlc0ZpbGVDbGFzc2VzLmdldChmLnBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzXSldKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5zZXQoZi5wYXRoLCBbLi4ubmV3IFNldChbLi4uKHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLmdldChmLnBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzLm5hbWVdKV0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21RdWVyeSA9IHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZjcS5maWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlRmlsZUNsYXNzZXNGaWVsZHNGcm9tUXVlcnkpIHRoaXMuZmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzUXVlcmllcy5zZXQocmVzdWx0LmZpbGUucGF0aCwgZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVF1ZXJ5KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBnZXRGaWxlc0ZpZWxkc0Zyb21GaWxlQ2xhc3MoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKClcbiAgICAgICAgICAgIC5maWx0ZXIoZiA9PiAhdGhpcy5jbGFzc0ZpbGVzUGF0aFxuICAgICAgICAgICAgICAgIHx8ICFmLnBhdGguaW5jbHVkZXModGhpcy5jbGFzc0ZpbGVzUGF0aClcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWxlQ2xhc3Nlc05hbWVzID0gW107XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzZXNDYWNoZTogc3RyaW5nW10gfCBzdHJpbmcgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZik/LmZyb250bWF0dGVyPy5bdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXNdXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc2VzQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheShmaWxlQ2xhc3Nlc0NhY2hlKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlRmlsZUNsYXNzZXNOYW1lcy5wdXNoKC4uLmZpbGVDbGFzc2VzQ2FjaGUpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVGaWxlQ2xhc3Nlc05hbWVzLnB1c2goLi4uZmlsZUNsYXNzZXNDYWNoZS5zcGxpdCgnLCcpLm1hcChmY24gPT4gZmNuLnRyaW0oKSkpXG4gICAgICAgICAgICAgICAgICAgIGZpbGVGaWxlQ2xhc3Nlc05hbWVzLmZvckVhY2goZmlsZUZpbGVDbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVGaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBbLi4ubmV3IFNldChbLi4uKHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5nZXQoZi5wYXRoKSB8fCBbXSksIGZpbGVDbGFzc10pXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5zZXQoZi5wYXRoLCBbLi4ubmV3IFNldChbLi4uKHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLmdldChmLnBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzLm5hbWVdKV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzZXNGaWVsZHNGcm9tRmlsZSA9IHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVGaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGaWVsZHMgPSB0aGlzLmZpbGVzRmllbGRzRnJvbUlubmVyRmlsZUNsYXNzZXMuZ2V0KGYucGF0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzZXNGaWVsZHNGcm9tRmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdGaWVsZHMgPSBbLi4uZmlsZUNsYXNzZXNGaWVsZHNGcm9tRmlsZV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRDdXJyZW50RmllbGRzID0gY3VycmVudEZpZWxkcz8uZmlsdGVyKGZpZWxkID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhbmV3RmllbGRzLm1hcChmID0+IGYubmFtZSkuaW5jbHVkZXMoZmllbGQubmFtZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFmaWxlQ2xhc3Mub3B0aW9ucz8uZXhjbHVkZXM/Lm1hcChhdHRyID0+IGF0dHIubmFtZSkuaW5jbHVkZXMoZmllbGQubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB8fCBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5maWx0ZXJlZEN1cnJlbnRGaWVsZHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBuZXdGaWVsZHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFtdKTsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFtdKTsgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBbXSk7IH1cbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgaXNMb29rdXBPckZvcm11bGEoZmllbGQ6IEZpZWxkKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBbRmllbGRUeXBlLkxvb2t1cCwgRmllbGRUeXBlLkZvcm11bGFdLmluY2x1ZGVzKGZpZWxkLnR5cGUpXG4gICAgfVxuXG4gICAgZ2V0RmlsZXNGaWVsZHMoKTogdm9pZCB7XG4gICAgICAgIC8qXG4gICAgICAgIFByaW9yaXR5IG9yZGVyOlxuICAgICAgICAxLiBJbm5lciBmaWxlQ2xhc3NcbiAgICAgICAgMi4gVGFnIG1hdGNoXG4gICAgICAgIDMuIGZpbGVDbGFzc1F1ZXJ5IG1hdGNoXG4gICAgICAgIDQuIEdsb2JhbCBmaWxlQ2xhc3NcbiAgICAgICAgNS4gc2V0dGluZ3MgcHJlc2V0IGZpZWxkc1xuICAgICAgICAqL1xuICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpXG4gICAgICAgICAgICAuZmlsdGVyKGYgPT4gIXRoaXMuY2xhc3NGaWxlc1BhdGggfHwgIWYucGF0aC5pbmNsdWRlcyh0aGlzLmNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgICAgIC5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3NlcyA9IHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5nZXQoZi5wYXRoKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWVsZHNGcm9tUXVlcnkgPSB0aGlzLmZpbGVzRmllbGRzRnJvbUZpbGVDbGFzc1F1ZXJpZXMuZ2V0KGYucGF0aCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpZWxkc0Zyb21UYWcgPSB0aGlzLmZpbGVzRmllbGRzRnJvbVRhZ3MuZ2V0KGYucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBmaWxlRmllbGRzRnJvbUlubmVyRmlsZUNsYXNzZXM/Lmxlbmd0aCB8fFxuICAgICAgICAgICAgICAgICAgICBmaWxlRmllbGRzRnJvbVF1ZXJ5Py5sZW5ndGggfHxcbiAgICAgICAgICAgICAgICAgICAgZmlsZUZpZWxkc0Zyb21UYWc/Lmxlbmd0aFxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlc0ZpZWxkczogRmllbGRbXSA9IGZpbGVGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3NlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgZmlsZXNGaWVsZHMucHVzaCguLi4oZmlsZUZpZWxkc0Zyb21UYWcgfHwgW10pLmZpbHRlcihmaWVsZCA9PiAhZmlsZXNGaWVsZHMubWFwKGYgPT4gZi5uYW1lKS5pbmNsdWRlcyhmaWVsZC5uYW1lKSkpXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzRmllbGRzLnB1c2goLi4uKGZpbGVGaWVsZHNGcm9tUXVlcnkgfHwgW10pLmZpbHRlcihmaWVsZCA9PiAhZmlsZXNGaWVsZHMubWFwKGYgPT4gZi5uYW1lKS5pbmNsdWRlcyhmaWVsZC5uYW1lKSkpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHMuc2V0KGYucGF0aCwgZmlsZXNGaWVsZHMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlc0xvb2t1cEFuZEZvcm11bGFzRmllbGRzOiBGaWVsZFtdID0gZmlsZXNGaWVsZHMuZmlsdGVyKGYgPT4gdGhpcy5pc0xvb2t1cE9yRm9ybXVsYShmKSlcbiAgICAgICAgICAgICAgICAgICAgZmlsZXNMb29rdXBBbmRGb3JtdWxhc0ZpZWxkcy5wdXNoKC4uLihmaWxlRmllbGRzRnJvbVRhZyB8fCBbXSkuZmlsdGVyKGZpZWxkID0+ICFmaWxlc0xvb2t1cEFuZEZvcm11bGFzRmllbGRzLm1hcChmID0+IGYubmFtZSkuaW5jbHVkZXMoZmllbGQubmFtZSkgJiYgdGhpcy5pc0xvb2t1cE9yRm9ybXVsYShmaWVsZCkpKVxuICAgICAgICAgICAgICAgICAgICBmaWxlc0xvb2t1cEFuZEZvcm11bGFzRmllbGRzLnB1c2goLi4uKGZpbGVGaWVsZHNGcm9tUXVlcnkgfHwgW10pLmZpbHRlcihmaWVsZCA9PiAhZmlsZXNMb29rdXBBbmRGb3JtdWxhc0ZpZWxkcy5tYXAoZiA9PiBmLm5hbWUpLmluY2x1ZGVzKGZpZWxkLm5hbWUpICYmIHRoaXMuaXNMb29rdXBPckZvcm11bGEoZmllbGQpKSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVzTG9va3VwQW5kRm9ybXVsYXNGaWVsZHMubGVuZ3RoKSB0aGlzLmZpbGVzTG9va3Vwc0FuZEZvcm11bGFzRmllbGRzLnNldChmLnBhdGgsIGZpbGVzTG9va3VwQW5kRm9ybXVsYXNGaWVsZHMpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHMuc2V0KGYucGF0aCwgdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlc0xvb2t1cEFuZEZvcm11bGFzRmllbGRzID0gdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzLmZpbHRlcihmID0+IHRoaXMuaXNMb29rdXBPckZvcm11bGEoZikpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlc0xvb2t1cEFuZEZvcm11bGFzRmllbGRzLmxlbmd0aCkgdGhpcy5maWxlc0xvb2t1cHNBbmRGb3JtdWxhc0ZpZWxkcy5zZXQoZi5wYXRoLCB0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MuZmlsdGVyKGYgPT4gdGhpcy5pc0xvb2t1cE9yRm9ybXVsYShmKSkpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBbdGhpcy5maWxlQ2xhc3Nlc05hbWUuZ2V0KHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyEpIV0pXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLnNldChmLnBhdGgsIFt0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MhXSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMubWFwKHByb3AgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSBuZXcgRmllbGQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHMuc2V0KGYucGF0aCwgZmllbGRzKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlc0xvb2t1cEFuZEZvcm11bGFzRmllbGRzID0gZmllbGRzLmZpbHRlcihmID0+IHRoaXMuaXNMb29rdXBPckZvcm11bGEoZikpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlc0xvb2t1cEFuZEZvcm11bGFzRmllbGRzLmxlbmd0aCkgdGhpcy5maWxlc0xvb2t1cHNBbmRGb3JtdWxhc0ZpZWxkcy5zZXQoZi5wYXRoLCBmaWVsZHMuZmlsdGVyKGYgPT4gdGhpcy5pc0xvb2t1cE9yRm9ybXVsYShmKSkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICB9XG5cbiAgICBnZXRGaWxlc0xvb2t1cEFuZEZvcm11bGFGaWVsZHNFeGlzdHMoZmlsZT86IFRGaWxlKTogdm9pZCB7XG4gICAgICAgIGxldCBmaWxlRmllbGRzOiBBcnJheTxbc3RyaW5nLCBGaWVsZFtdXT5cbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVGaWVsZHMgPSBbW2ZpbGUucGF0aCwgdGhpcy5maWxlc0xvb2t1cHNBbmRGb3JtdWxhc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKSB8fCBbXV1dXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaWxlRmllbGRzID0gWy4uLnRoaXMuZmlsZXNMb29rdXBzQW5kRm9ybXVsYXNGaWVsZHNdXG4gICAgICAgIH1cbiAgICAgICAgZmlsZUZpZWxkcy5mb3JFYWNoKChbZmlsZVBhdGgsIGZpZWxkc10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGR2RmlsZSA9IHRoaXMuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0ZpZWxkczogRmllbGRbXSA9IFtdXG4gICAgICAgICAgICBmaWVsZHMuZmlsdGVyKGYgPT4gW0ZpZWxkVHlwZS5Mb29rdXAsIEZpZWxkVHlwZS5Gb3JtdWxhXVxuICAgICAgICAgICAgICAgIC5pbmNsdWRlcyhmLnR5cGUpKS5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGR2RmlsZSAmJiBkdkZpbGVbZmllbGQubmFtZV0gIT09IHVuZGVmaW5lZCkgeyBleGlzdGluZ0ZpZWxkcy5wdXNoKGZpZWxkKSB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGlmIChleGlzdGluZ0ZpZWxkcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVzTG9va3VwQW5kRm9ybXVsYUZpZWxkc0V4aXN0cy5zZXQoZmlsZVBhdGgsIGV4aXN0aW5nRmllbGRzKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVzTG9va3VwQW5kRm9ybXVsYUZpZWxkc0V4aXN0cy5kZWxldGUoZmlsZVBhdGgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuIiwgImltcG9ydCB7IE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuY2xhc3MgRmlsZUNsYXNzUXVlcnkge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIHB1YmxpYyBxdWVyeTogc3RyaW5nID0gXCJcIixcbiAgICAgICAgcHVibGljIGZpbGVDbGFzc05hbWU6IHN0cmluZyA9IFwiXCJcbiAgICApIHsgfTtcblxuICAgIC8vQHRzLWlnbm9yZVxuICAgIHB1YmxpYyBnZXRSZXN1bHRzKGFwaTogRGF0YXZpZXdQbHVnaW5bXCJhcGlcIl0pOiBhbnkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJkdlwiLCBgcmV0dXJuICR7dGhpcy5xdWVyeX1gKSkoYXBpKVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgcXVlcnkgZm9yIDwke3RoaXMubmFtZX0+LiBDaGVjayB5b3VyIHNldHRpbmdzYCk7XG4gICAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwdWJsaWMgbWF0Y2hGaWxlKGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG5cbiAgICAgICAgY29uc3QgZGF0YXZpZXcgPSBhcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBpZiAodGhpcy5xdWVyeSAmJiBkYXRhdmlldz8uc2V0dGluZ3MuZW5hYmxlRGF0YXZpZXdKcyAmJiBkYXRhdmlldz8uc2V0dGluZ3MuZW5hYmxlSW5saW5lRGF0YXZpZXdKcykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlc1BhdGggPSB0aGlzLmdldFJlc3VsdHMoZGF0YXZpZXcuYXBpKS52YWx1ZXMubWFwKCh2OiBhbnkpID0+IHYuZmlsZS5wYXRoKSBhcyBzdHJpbmdbXVxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlc1BhdGguaW5jbHVkZXMoZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RhdGljIGNvcHlQcm9wZXJ0eSh0YXJnZXQ6IEZpbGVDbGFzc1F1ZXJ5LCBzb3VyY2U6IEZpbGVDbGFzc1F1ZXJ5KSB7XG4gICAgICAgIHRhcmdldC5pZCA9IHNvdXJjZS5pZDtcbiAgICAgICAgdGFyZ2V0Lm5hbWUgPSBzb3VyY2UubmFtZTtcbiAgICAgICAgdGFyZ2V0LnF1ZXJ5ID0gc291cmNlLnF1ZXJ5O1xuICAgICAgICB0YXJnZXQuZmlsZUNsYXNzTmFtZSA9IHNvdXJjZS5maWxlQ2xhc3NOYW1lXG4gICAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZpbGVDbGFzc1F1ZXJ5OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IFN0YXR1cyB9IGZyb20gXCJzcmMvdHlwZXMvbG9va3VwVHlwZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVMb29rdXBzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBzb3VyY2U6IHN0cmluZyA9IFwiXCIpOiB2b2lkIHtcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgLy9maXJzdCByZXNvbHZlIGFsbCBleGlzdGluZyBsb29rdXAgcXVlcmllcyBmcm9tIHRoZWlyIGRlZmluaXRpb25zIGluIGZpbGVDbGFzc2VzIGFuZCBzZXR0aW5nc1xuICAgIGNvbnN0IGxvb2t1cFF1ZXJ5UmVzdWx0czogTWFwPHN0cmluZywgYW55W10+ID0gbmV3IE1hcCgpO1xuICAgIFsuLi5mLmxvb2t1cFF1ZXJpZXNdLmZvckVhY2goKFtsb29rdXBOYW1lLCBmaWVsZF0pID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnlSZWxhdGVkRFZGaWxlcyA9IChuZXcgRnVuY3Rpb24oXCJkdlwiLCBgcmV0dXJuICR7ZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nfWApKShmLmR2LmFwaSkudmFsdWVzIGFzIEFycmF5PGFueT47XG4gICAgICAgIGxvb2t1cFF1ZXJ5UmVzdWx0cy5zZXQobG9va3VwTmFtZSwgcXVlcnlSZWxhdGVkRFZGaWxlcyk7XG5cbiAgICB9KTtcbiAgICAvL3RoZW4gYXNzaWduIHJlc3VsdHMgdG8gYWxsIGZpbGVzIGhhdmluZyBpbXBsZW1lbnRlZCBhIGxvb2t1cGZpZWxkXG4gICAgWy4uLmYuZmlsZXNMb29rdXBBbmRGb3JtdWxhRmllbGRzRXhpc3RzXS5mb3JFYWNoKChbZmlsZVBhdGgsIGZpZWxkc10pID0+IHtcbiAgICAgICAgZmllbGRzLmZpbHRlcihmaWVsZCA9PiBmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwKS5mb3JFYWNoKGxvb2t1cEZpZWxkID0+IHtcbiAgICAgICAgICAgIC8vZm9yIGFsbCBsb29rdXAgZmllbGRzIGluIGZpbGVzIHRoYXQgaGF2ZSBsb29rdXBmaWVsZHM6XG4gICAgICAgICAgICAvLzEuIGdldCB0aGUgcXVlcnkgcmVzdWx0c1xuICAgICAgICAgICAgY29uc3QgcXVlcnlSZWxhdGVkRFZGaWxlcyA9IGxvb2t1cFF1ZXJ5UmVzdWx0cy5nZXQoYCR7bG9va3VwRmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X19fJHtsb29rdXBGaWVsZC5uYW1lfWApIHx8IFtdO1xuICAgICAgICAgICAgLy8yLiBmaWx0ZXIgdGhvc2UgcmVzdWx0cyBieSB0aGVpciB0YXJnZXRGaWVsZCBjb250ZW50IGluY2x1ZGluZyB0aGlzIGZpbGUgLy9cbiAgICAgICAgICAgIGNvbnN0IGZpbGVSZWxhdGVkRFZGaWxlcyA9IHF1ZXJ5UmVsYXRlZERWRmlsZXMuZmlsdGVyKGR2RmlsZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSBkdkZpbGVbbG9va3VwRmllbGQub3B0aW9ucy50YXJnZXRGaWVsZE5hbWVdO1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0VmFsdWUuZmlsdGVyKHYgPT4gZi5kdi5hcGkudmFsdWUuaXNMaW5rKHYpKS5tYXAodiA9PiB2LnBhdGgpLmluY2x1ZGVzKGZpbGVQYXRoKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRWYWx1ZT8ucGF0aCA9PT0gZmlsZVBhdGhcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy8zLiBhc3NpZ24gdGhvc2UgcmVzdWx0cyB0byBmaWxlTG9va3VwRmlsZXNcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0ZWRGaWVsZE5hbWUgPSBgJHtmaWxlUGF0aH1fX3JlbGF0ZWRfXyR7bG9va3VwRmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X19fJHtsb29rdXBGaWVsZC5uYW1lfWBcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRmlsZUxvb2t1cEZpZWxkcyA9IGYuZmlsZUxvb2t1cEZpbGVzLmdldChyZWxhdGVkRmllbGROYW1lKVxuICAgICAgICAgICAgZi5maWxlTG9va3VwRmlsZXMuc2V0KHJlbGF0ZWRGaWVsZE5hbWUsIGZpbGVSZWxhdGVkRFZGaWxlcylcbiAgICAgICAgICAgIC8vNC4gcmVzZXQgUHJldmlvdXMgcmVzdWx0cyBjb3VudCB0byBjdXJyZW50IHZhbHVlXG4gICAgICAgICAgICBpZiAoIShmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuZ2V0KGAke2ZpbGVQYXRofV9fJHtsb29rdXBGaWVsZC5uYW1lfWApID09PSBTdGF0dXMuY2hhbmdlZCkpIGYucHJldmlvdXNGaWxlTG9va3VwRmlsZXNWYWx1ZXMuc2V0KHJlbGF0ZWRGaWVsZE5hbWUsIChleGlzdGluZ0ZpbGVMb29rdXBGaWVsZHMgfHwgZmlsZVJlbGF0ZWREVkZpbGVzKS5sZW5ndGgpXG4gICAgICAgICAgICAvLzUuIGNoYW5nZSB0aGUgc3RhdHVzIG9mIHRoaXMgbG9va3VwIGZpZWxkXG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuc2V0KGAke2ZpbGVQYXRofV9fJHtsb29rdXBGaWVsZC5uYW1lfWAsIFN0YXR1cy5jaGFuZ2VkKVxuICAgICAgICB9KVxuICAgIH0pXG4gICAgLy9yZW1vdmUgbm9uIGV4aXN0aW5nIGxvb2t1cCBmaWVsZHMgZnJvbSBpbmRleCwgc2luY2UgdGhvc2UgaW5kZXhlcyBhcmVuJ3QgZmx1c2hlZCBlYWNoIHRpbWVcbiAgICBmb3IgKGxldCBpZCBvZiBmLmZpbGVMb29rdXBGaWxlcy5rZXlzKCkpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hSZWdleCA9IC8oPzxmaWxlUGF0aD4uKilfX3JlbGF0ZWRfXyg/PGZpbGVDbGFzc05hbWU+LiopX19fKD88ZmllbGROYW1lPi4qKS9cbiAgICAgICAgY29uc3QgeyBmaWxlUGF0aCwgZmlsZUNsYXNzTmFtZSwgZmllbGROYW1lIH0gPSBpZC5tYXRjaChtYXRjaFJlZ2V4KT8uZ3JvdXBzIHx8IHt9XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nTG9va0ZpZWxkV2l0aE5hbWVBbmRGaWxlQ2xhc3NOYW1lID0gZi5maWxlc0ZpZWxkc1xuICAgICAgICAgICAgLmdldChmaWxlUGF0aCk/LmZpbmQoZmllbGQgPT5cbiAgICAgICAgICAgICAgICAoZmllbGQubmFtZSA9PT0gZmllbGROYW1lKSAmJlxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgKGZpZWxkLmZpbGVDbGFzc05hbWUgPT09IHVuZGVmaW5lZCAmJiBmaWxlQ2xhc3NOYW1lID09PSBcInByZXNldEZpZWxkXCIpIHx8XG4gICAgICAgICAgICAgICAgICAgIChmaWVsZC5maWxlQ2xhc3NOYW1lID09PSBmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgY29uc3QgZHZQYWdlID0gZi5kdi5hcGkucGFnZShmaWxlUGF0aCk7XG4gICAgICAgIGlmIChkdlBhZ2UgPT09IHVuZGVmaW5lZCB8fCBkdlBhZ2VbZmllbGROYW1lXSA9PT0gdW5kZWZpbmVkIHx8ICFleGlzdGluZ0xvb2tGaWVsZFdpdGhOYW1lQW5kRmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgZi5maWxlTG9va3VwRmlsZXMuZGVsZXRlKGlkKTtcbiAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuZGVsZXRlKGAke2ZpbGVQYXRofV9fJHtmaWVsZE5hbWV9YClcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTm90aWNlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQWxsQ2FudmFzTm9kZURhdGEsIENhbnZhc0RhdGEsIENhbnZhc0VkZ2VEYXRhLCBDYW52YXNGaWxlRGF0YSwgQ2FudmFzR3JvdXBEYXRhLCBDYW52YXNOb2RlRGF0YSB9IGZyb20gXCJvYnNpZGlhbi9jYW52YXNcIlxuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZHNQYXlsb2FkLCBwb3N0VmFsdWVzIH0gZnJvbSBcIi4vcG9zdFZhbHVlc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhbnZhcyhcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmb3JjZVVwZGF0ZU9uZT86IHsgY2FudmFzOiBURmlsZSB9XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KClcbiAgICAvL2NvbnNvbGUubG9nKFwic3RhcnQgdXBkYXRlIGNhbnZhc1wiLCBwbHVnaW4uZmllbGRJbmRleC5sYXN0UmV2aXNpb24sIFwiLT5cIiwgcGx1Z2luLmZpZWxkSW5kZXguZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgY29uc3QgZHZBcGkgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgY29uc3QgY2FudmFzZXMgPSBmb3JjZVVwZGF0ZU9uZSA/IFtmb3JjZVVwZGF0ZU9uZS5jYW52YXNdIDogcGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcih0ID0+IHQuZXh0ZW5zaW9uID09PSBcImNhbnZhc1wiKVxuXG4gICAgY29uc3QgaXNOb2RlSW5Hcm91cCA9IChub2RlOiBDYW52YXNGaWxlRGF0YSwgZ3JvdXA6IENhbnZhc0dyb3VwRGF0YSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICBjb25zdCB7IHg6IHgxLCB5OiB5MSwgd2lkdGg6IHcxLCBoZWlnaHQ6IGgxIH0gPSBub2RlO1xuICAgICAgICBjb25zdCB7IHg6IHgyLCB5OiB5Miwgd2lkdGg6IHcyLCBoZWlnaHQ6IGgyIH0gPSBncm91cDtcbiAgICAgICAgcmV0dXJuIHgyIDw9IHgxICYmIHkyIDw9IHkxICYmICh4MiArIHcyKSA+PSAoeDEgKyB3MSkgJiYgKHkyICsgaDIpID49ICh5MSArIGgxKVxuICAgIH1cblxuICAgIGNvbnN0IG9yaWVudGVkRWRnZXMgPSAoXG4gICAgICAgIGRpcmVjdGlvbjogXCJpbmNvbWluZ1wiIHwgXCJvdXRnb2luZ1wiIHwgXCJib3Roc2lkZXNcIixcbiAgICAgICAgZWRnZXM6IENhbnZhc0VkZ2VEYXRhW10sXG4gICAgICAgIG5vZGU6IENhbnZhc05vZGVEYXRhXG4gICAgKTogQ2FudmFzRWRnZURhdGFbXSA9PiB7XG4gICAgICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiaW5jb21pbmdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gZWRnZXMuZmlsdGVyKGVkZ2UgPT4gZWRnZS50b05vZGUgPT09IG5vZGUuaWQpO1xuICAgICAgICAgICAgY2FzZSBcIm91dGdvaW5nXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVkZ2VzLmZpbHRlcihlZGdlID0+IGVkZ2UuZnJvbU5vZGUgPT09IG5vZGUuaWQpO1xuICAgICAgICAgICAgY2FzZSBcImJvdGhzaWRlc1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBlZGdlcy5maWx0ZXIoZWRnZSA9PiBlZGdlLmZyb21Ob2RlID09PSBub2RlLmlkIHx8IGVkZ2UudG9Ob2RlID09PSBub2RlLmlkKVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB0YXJnZXROb2RlID0gKFxuICAgICAgICBkaXJlY3Rpb246IFwiaW5jb21pbmdcIiB8IFwib3V0Z29pbmdcIiB8IFwiYm90aHNpZGVzXCIsXG4gICAgICAgIGVkZ2U6IENhbnZhc0VkZ2VEYXRhLFxuICAgICAgICBub2RlczogQWxsQ2FudmFzTm9kZURhdGFbXSxcbiAgICAgICAgY3VycmVudE5vZGU6IEFsbENhbnZhc05vZGVEYXRhXG4gICAgKTogKEFsbENhbnZhc05vZGVEYXRhIHwgdW5kZWZpbmVkKSA9PiB7XG4gICAgICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiaW5jb21pbmdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXMuZmluZChub2RlID0+IG5vZGUuaWQgIT09IGN1cnJlbnROb2RlLmlkICYmIG5vZGUuaWQgPT09IGVkZ2UuZnJvbU5vZGUpO1xuICAgICAgICAgICAgY2FzZSBcIm91dGdvaW5nXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVzLmZpbmQobm9kZSA9PiBub2RlLmlkICE9PSBjdXJyZW50Tm9kZS5pZCAmJiBub2RlLmlkID09PSBlZGdlLnRvTm9kZSk7XG4gICAgICAgICAgICBjYXNlIFwiYm90aHNpZGVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVzLmZpbmQobm9kZSA9PiBub2RlLmlkICE9PSBjdXJyZW50Tm9kZS5pZCAmJiAobm9kZS5pZCA9PT0gZWRnZS50b05vZGUgfHwgbm9kZS5pZCA9PT0gZWRnZS5mcm9tTm9kZSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmVzb2x2ZUZpZWxkTGlua3NGb3JOb2RlID0gKFxuICAgICAgICBmaWVsZDogRmllbGQsXG4gICAgICAgIHRhcmdldEZpbGVQYXRoOiBzdHJpbmcsXG4gICAgICAgIGVkZ2VzOiBDYW52YXNFZGdlRGF0YVtdLFxuICAgICAgICBub2RlczogQWxsQ2FudmFzTm9kZURhdGFbXSxcbiAgICAgICAgbm9kZTogQ2FudmFzRmlsZURhdGEgfCBDYW52YXNHcm91cERhdGEsXG4gICAgICAgIGN1bXVsYXRpdmVTZXQ6IE1hcDxzdHJpbmcsIENhbnZhc0ZpbGVEYXRhW10+XG4gICAgKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgbm9kZUNvbG9ycywgZWRnZUNvbG9ycywgZWRnZUZyb21TaWRlcywgZWRnZVRvU2lkZXMsIGVkZ2VMYWJlbHMsIGZpbGVzRnJvbURWUXVlcnksIGRpcmVjdGlvbiB9ID0gZmllbGQub3B0aW9uc1xuXG4gICAgICAgIGNvbnN0IG1hdGNoaW5nRmlsZXM6IHN0cmluZ1tdIHwgdW5kZWZpbmVkID0gZmlsZXNGcm9tRFZRdWVyeSA/XG4gICAgICAgICAgICBuZXcgRnVuY3Rpb24oXCJkdlwiLCBcImN1cnJlbnRcIiwgYHJldHVybiAke2ZpbGVzRnJvbURWUXVlcnl9YCkoZHZBcGksIGR2QXBpLnBhZ2UodGFyZ2V0RmlsZVBhdGgpKSA6XG4gICAgICAgICAgICB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IG1hdGNoaW5nRWRnZXMgPSBvcmllbnRlZEVkZ2VzKGRpcmVjdGlvbiwgZWRnZXMsIG5vZGUpXG4gICAgICAgIGNvbnN0IGxpbmtOb2RlcyA9IG1hdGNoaW5nRWRnZXMuZmlsdGVyKGVkZ2UgPT5cbiAgICAgICAgICAgICFlZGdlTGFiZWxzXG4gICAgICAgICAgICB8fCBlZGdlTGFiZWxzLmxlbmd0aCA9PT0gMFxuICAgICAgICAgICAgfHwgZWRnZUxhYmVscy5pbmNsdWRlcyhlZGdlLmxhYmVsKVxuICAgICAgICApXG4gICAgICAgICAgICAvL21hdGNoIGVkZ2VDb2xvclxuICAgICAgICAgICAgLmZpbHRlcihlZGdlID0+XG4gICAgICAgICAgICAgICAgIWVkZ2VDb2xvcnNcbiAgICAgICAgICAgICAgICB8fCBlZGdlQ29sb3JzLmxlbmd0aCA9PT0gMFxuICAgICAgICAgICAgICAgIHx8ICFlZGdlLmNvbG9yICYmIGVkZ2VDb2xvcnMuaW5jbHVkZXMoXCIwXCIpXG4gICAgICAgICAgICAgICAgfHwgZWRnZUNvbG9ycy5pbmNsdWRlcyhlZGdlLmNvbG9yKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLy9tYXRjaCBlZGdlRnJvbVNpZGVcbiAgICAgICAgICAgIC5maWx0ZXIoZWRnZSA9PlxuICAgICAgICAgICAgICAgICFlZGdlRnJvbVNpZGVzXG4gICAgICAgICAgICAgICAgfHwgZWRnZUZyb21TaWRlcy5sZW5ndGggPT09IDBcbiAgICAgICAgICAgICAgICB8fCBlZGdlRnJvbVNpZGVzLmluY2x1ZGVzKGVkZ2UuZnJvbVNpZGUpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAvL21hdGNoIGVkZ2VGcm9tU2lkZVxuICAgICAgICAgICAgLmZpbHRlcihlZGdlID0+XG4gICAgICAgICAgICAgICAgIWVkZ2VUb1NpZGVzXG4gICAgICAgICAgICAgICAgfHwgZWRnZVRvU2lkZXMubGVuZ3RoID09PSAwXG4gICAgICAgICAgICAgICAgfHwgZWRnZVRvU2lkZXMuaW5jbHVkZXMoZWRnZS50b1NpZGUpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAvL21hcCBjb3JyZXNwb25kaW5nIG5vZGVzXG4gICAgICAgICAgICAubWFwKGVkZ2UgPT4gdGFyZ2V0Tm9kZShkaXJlY3Rpb24sIGVkZ2UsIG5vZGVzLCBub2RlKSlcbiAgICAgICAgICAgIC8vZmlsdGVyIG9ubHkgZmlsZSBub2Rlc1xuICAgICAgICAgICAgLmZpbHRlcihub2RlID0+ICEhbm9kZSAmJiBub2RlLnR5cGUgPT09IFwiZmlsZVwiKVxuICAgICAgICAgICAgLy9tYXRjaCB0YXJnZXROb2RlIGNvbG9yXG4gICAgICAgICAgICAuZmlsdGVyKChub2RlOiBDYW52YXNGaWxlRGF0YSkgPT5cbiAgICAgICAgICAgICAgICAhbm9kZUNvbG9yc1xuICAgICAgICAgICAgICAgIHx8IG5vZGVDb2xvcnMubGVuZ3RoID09PSAwXG4gICAgICAgICAgICAgICAgfHwgIW5vZGUuY29sb3IgJiYgbm9kZUNvbG9ycy5pbmNsdWRlcyhcIjBcIilcbiAgICAgICAgICAgICAgICB8fCBub2RlQ29sb3JzLmluY2x1ZGVzKG5vZGUuY29sb3IpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAvLyBmaWx0ZXIgZmlsZXMgbWF0Y2hpbmcgZHZqcyBxdWVyeVxuICAgICAgICAgICAgLmZpbHRlcigobm9kZTogQ2FudmFzRmlsZURhdGEpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hpbmdGaWxlcyA9PT0gdW5kZWZpbmVkIHx8IG1hdGNoaW5nRmlsZXMubWFwKChmOiBhbnkpID0+IGYuZmlsZS5wYXRoKS5pbmNsdWRlcyhub2RlLmZpbGUpXG4gICAgICAgICAgICB9KSBhcyBDYW52YXNGaWxlRGF0YVtdXG5cbiAgICAgICAgY29uc3QgdW5pcXVlTGlua05vZGVzID0gWy4uLm5ldyBNYXAobGlua05vZGVzLm1hcCgobGluaykgPT4gW2xpbmsuZmlsZSwgbGlua10pKS52YWx1ZXMoKV07XG4gICAgICAgIGN1bXVsYXRpdmVTZXQuc2V0KFxuICAgICAgICAgICAgZmllbGQubmFtZSxcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAuLi4oY3VtdWxhdGl2ZVNldC5nZXQoZmllbGQubmFtZSkgfHwgW10pLFxuICAgICAgICAgICAgICAgIC4uLih1bmlxdWVMaW5rTm9kZXNcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsgPT4gIWN1bXVsYXRpdmVTZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KGZpZWxkLm5hbWUpPy5tYXAobGluayA9PiBsaW5rLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5pbmNsdWRlcyhsaW5rLmlkKVxuICAgICAgICAgICAgICAgICAgICApIGFzIENhbnZhc0ZpbGVEYXRhW11cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICBdXG4gICAgICAgIClcbiAgICB9XG5cbiAgICBjb25zdCBmaWx0ZXJHcm91cHNGb3JGaWVsZCA9IChmaWVsZDogRmllbGQsIGNhbnZhc0dyb3VwczogQ2FudmFzR3JvdXBEYXRhW10sIG5vZGU6IENhbnZhc0ZpbGVEYXRhKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZ3JvdXBDb2xvcnMsIGdyb3VwTGFiZWxzIH0gPSBmaWVsZC5vcHRpb25zXG4gICAgICAgIGNvbnN0IGdyb3VwTm9kZXMgPSBjYW52YXNHcm91cHNcbiAgICAgICAgICAgIC5maWx0ZXIoZ3JvdXAgPT5cbiAgICAgICAgICAgICAgICAhZ3JvdXBDb2xvcnNcbiAgICAgICAgICAgICAgICB8fCBncm91cENvbG9ycy5sZW5ndGggPT09IDBcbiAgICAgICAgICAgICAgICB8fCAhZ3JvdXAuY29sb3IgJiYgZ3JvdXBDb2xvcnMuaW5jbHVkZXMoXCIwXCIpXG4gICAgICAgICAgICAgICAgfHwgZ3JvdXBDb2xvcnMuaW5jbHVkZXMoZ3JvdXAuY29sb3IpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuZmlsdGVyKGdyb3VwID0+XG4gICAgICAgICAgICAgICAgIWdyb3VwTGFiZWxzXG4gICAgICAgICAgICAgICAgfHwgZ3JvdXBMYWJlbHMubGVuZ3RoID09PSAwXG4gICAgICAgICAgICAgICAgfHwgZ3JvdXBMYWJlbHMuaW5jbHVkZXMoZ3JvdXAubGFiZWwpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAvLyBmaWx0ZXIgZmlsZXMgbWF0Y2hpbmcgZHZqcyBxdWVyeVxuICAgICAgICAgICAgLmZpbHRlcihncm91cCA9PiBpc05vZGVJbkdyb3VwKG5vZGUsIGdyb3VwKSkgYXMgQ2FudmFzR3JvdXBEYXRhW11cbiAgICAgICAgcmV0dXJuIGdyb3VwTm9kZXNcbiAgICB9XG5cbiAgICBjb25zdCByZXNvbHZlRmllbGRHcm91cHNGb3JOb2RlID0gKFxuICAgICAgICBmaWVsZDogRmllbGQsXG4gICAgICAgIGNhbnZhc0dyb3VwczogQ2FudmFzR3JvdXBEYXRhW10sXG4gICAgICAgIG5vZGU6IENhbnZhc0ZpbGVEYXRhLFxuICAgICAgICBjdW11bGF0ZWRHcm91cHNGaWVsZHM6IE1hcDxzdHJpbmcsIENhbnZhc0dyb3VwRGF0YVtdPlxuICAgICkgPT4ge1xuICAgICAgICBjb25zdCBncm91cE5vZGVzID0gZmlsdGVyR3JvdXBzRm9yRmllbGQoZmllbGQsIGNhbnZhc0dyb3Vwcywgbm9kZSlcbiAgICAgICAgY3VtdWxhdGVkR3JvdXBzRmllbGRzLnNldChcbiAgICAgICAgICAgIGZpZWxkLm5hbWUsXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgLi4uKGN1bXVsYXRlZEdyb3Vwc0ZpZWxkcy5nZXQoZmllbGQubmFtZSkgfHwgW10pLFxuICAgICAgICAgICAgICAgIC4uLihncm91cE5vZGVzXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cCA9PiAhY3VtdWxhdGVkR3JvdXBzRmllbGRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldChmaWVsZC5uYW1lKT8ubWFwKGdyb3VwID0+IGdyb3VwLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5pbmNsdWRlcyhncm91cC5pZClcbiAgICAgICAgICAgICAgICAgICAgKSBhcyBDYW52YXNHcm91cERhdGFbXVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIF1cbiAgICAgICAgKVxuICAgIH1cblxuICAgIGNhbnZhc2VzLmZvckVhY2goYXN5bmMgY2FudmFzID0+IHtcbiAgICAgICAgY29uc3QgcHJldmlvdXNGaWxlc1BhdGhzID0gcGx1Z2luLmZpZWxkSW5kZXguY2FudmFzTGFzdEZpbGVzLmdldChjYW52YXMucGF0aCkgfHwgW11cbiAgICAgICAgY29uc3QgY3VycmVudEZpbGVzUGF0aHM6IHN0cmluZ1tdID0gW11cbiAgICAgICAgbGV0IHsgbm9kZXMsIGVkZ2VzIH06IENhbnZhc0RhdGEgPSB7IG5vZGVzOiBbXSwgZWRnZXM6IFtdIH07XG4gICAgICAgIGNvbnN0IHJhd0NvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoY2FudmFzKVxuICAgICAgICBpZiAocmF3Q29udGVudCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW52YXNDb250ZW50ID0gSlNPTi5wYXJzZShyYXdDb250ZW50KSBhcyBDYW52YXNEYXRhO1xuICAgICAgICAgICAgICAgIG5vZGVzID0gY2FudmFzQ29udGVudC5ub2RlcztcbiAgICAgICAgICAgICAgICBlZGdlcyA9IGNhbnZhc0NvbnRlbnQuZWRnZXNcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgQ291bGRuJ3QgcmVhZCAke2NhbnZhcy5wYXRofWApXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2FudmFzR3JvdXBzOiBDYW52YXNHcm91cERhdGFbXSA9IG5vZGVzLmZpbHRlcihub2RlID0+IG5vZGUudHlwZSA9PT0gXCJncm91cFwiKSBhcyBDYW52YXNHcm91cERhdGFbXVxuICAgICAgICBjb25zdCBjdXJyZW50RmlsZXM6IE1hcDxzdHJpbmcsIHtcbiAgICAgICAgICAgIGN1bXVsYXRlZEdyb3Vwc0ZpZWxkczogTWFwPHN0cmluZywgQ2FudmFzR3JvdXBEYXRhW10+LFxuICAgICAgICAgICAgY3VtdWxhdGVkTGlua3NGaWVsZHM6IE1hcDxzdHJpbmcsIENhbnZhc0ZpbGVEYXRhW10+LFxuICAgICAgICAgICAgY3VtdWxhdGVkR3JvdXBzTGlua3NGaWVsZHM6IE1hcDxzdHJpbmcsIENhbnZhc0ZpbGVEYXRhW10+XG4gICAgICAgIH0+ID0gbmV3IE1hcCgpXG4gICAgICAgIG5vZGVzLmZvckVhY2goYXN5bmMgbm9kZSA9PiB7XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSBcImZpbGVcIiAmJiBkdkFwaSkge1xuICAgICAgICAgICAgICAgIC8vdXBkYXRlIENhbnZhc0dyb3VwIGZpZWxkc1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgY3VtdWxhdGVkTGlua3NGaWVsZHMsIGN1bXVsYXRlZEdyb3Vwc0ZpZWxkcywgY3VtdWxhdGVkR3JvdXBzTGlua3NGaWVsZHMgfSA9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWxlcy5nZXQobm9kZS5maWxlKSB8fFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdW11bGF0ZWRHcm91cHNGaWVsZHM6IG5ldyBNYXA8c3RyaW5nLCBDYW52YXNHcm91cERhdGFbXT4oKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1bXVsYXRlZExpbmtzRmllbGRzOiBuZXcgTWFwPHN0cmluZywgQ2FudmFzRmlsZURhdGFbXT4oKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1bXVsYXRlZEdyb3Vwc0xpbmtzRmllbGRzOiBuZXcgTWFwPHN0cmluZywgQ2FudmFzRmlsZURhdGFbXT4oKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRGaWxlUGF0aCA9IG5vZGUuZmlsZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudEZpbGVzUGF0aHMuaW5jbHVkZXModGFyZ2V0RmlsZVBhdGgpKSBjdXJyZW50RmlsZXNQYXRocy5wdXNoKHRhcmdldEZpbGVQYXRoKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWVsZHMgPSBmLmZpbGVzRmllbGRzLmdldCh0YXJnZXRGaWxlUGF0aClcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rc0ZpZWxkcyA9IGZpbGVGaWVsZHM/LmZpbHRlcihmaWVsZCA9PlxuICAgICAgICAgICAgICAgICAgICBmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuQ2FudmFzXG4gICAgICAgICAgICAgICAgICAgICYmIGZpZWxkLm9wdGlvbnMuY2FudmFzUGF0aCA9PT0gY2FudmFzLnBhdGhcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgY29uc3QgZ3JvdXBzRmllbGRzID0gZmlsZUZpZWxkcz8uZmlsdGVyKGZpZWxkID0+XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5DYW52YXNHcm91cFxuICAgICAgICAgICAgICAgICAgICAmJiBmaWVsZC5vcHRpb25zLmNhbnZhc1BhdGggPT09IGNhbnZhcy5wYXRoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIGNvbnN0IGdyb3Vwc0xpbmtzRmllbGRzID0gZmlsZUZpZWxkcz8uZmlsdGVyKGZpZWxkID0+XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5DYW52YXNHcm91cExpbmtcbiAgICAgICAgICAgICAgICAgICAgJiYgZmllbGQub3B0aW9ucy5jYW52YXNQYXRoID09PSBjYW52YXMucGF0aFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAvLyBmb3IgZWFjaCBjYW52YXMgZmllbGQsIGlmIHRoZSBjYW52YXMgZmllbGQgbWF0Y2ggdGhlIGNvbmRpdGlvbnMsIHRoZW4sIGFkZCB0aGUgb3JpZ2luIGZpbGUgdG8gdGhlIHRhcmdldCBjYW52YXMgZmllbGQgbGlzdCBvZiBmaWxlc1xuICAgICAgICAgICAgICAgIGxpbmtzRmllbGRzPy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUZpZWxkTGlua3NGb3JOb2RlKGZpZWxkLCB0YXJnZXRGaWxlUGF0aCwgZWRnZXMsIG5vZGVzLCBub2RlLCBjdW11bGF0ZWRMaW5rc0ZpZWxkcylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGdyb3Vwc0ZpZWxkcz8uZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmVGaWVsZEdyb3Vwc0Zvck5vZGUoZmllbGQsIGNhbnZhc0dyb3Vwcywgbm9kZSwgY3VtdWxhdGVkR3JvdXBzRmllbGRzKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgZ3JvdXBzTGlua3NGaWVsZHM/LmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBmaXJzdCBmaWx0ZXIgdGhlIGdyb3VwcyBtYXRjaGluZyBjb25kaXRpb25zXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwTm9kZXMgPSBmaWx0ZXJHcm91cHNGb3JGaWVsZChmaWVsZCwgY2FudmFzR3JvdXBzLCBub2RlKVxuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgdGhlaXIgbGlua3MgZWRnZXNcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBOb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUZpZWxkTGlua3NGb3JOb2RlKGZpZWxkLCB0YXJnZXRGaWxlUGF0aCwgZWRnZXMsIG5vZGVzLCBub2RlLCBjdW11bGF0ZWRHcm91cHNMaW5rc0ZpZWxkcylcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChncm91cE5vZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VtdWxhdGVkR3JvdXBzTGlua3NGaWVsZHMuc2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgWy4uLihjdW11bGF0ZWRHcm91cHNMaW5rc0ZpZWxkcy5nZXQoZmllbGQubmFtZSkgfHwgW10pXVxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGN1cnJlbnRGaWxlcy5zZXQobm9kZS5maWxlLCB7XG4gICAgICAgICAgICAgICAgICAgIGN1bXVsYXRlZExpbmtzRmllbGRzOiBjdW11bGF0ZWRMaW5rc0ZpZWxkcyxcbiAgICAgICAgICAgICAgICAgICAgY3VtdWxhdGVkR3JvdXBzRmllbGRzOiBjdW11bGF0ZWRHcm91cHNGaWVsZHMsXG4gICAgICAgICAgICAgICAgICAgIGN1bXVsYXRlZEdyb3Vwc0xpbmtzRmllbGRzOiBjdW11bGF0ZWRHcm91cHNMaW5rc0ZpZWxkc1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC8vdXBkYXRlIHRhcmdldCBmaWxlc1xuICAgICAgICBjdXJyZW50RmlsZXMuZm9yRWFjaChhc3luYyAoeyBjdW11bGF0ZWRMaW5rc0ZpZWxkcywgY3VtdWxhdGVkR3JvdXBzRmllbGRzLCBjdW11bGF0ZWRHcm91cHNMaW5rc0ZpZWxkcyB9LCBmaWxlUGF0aCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpXG4gICAgICAgICAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXlsb2FkOiBGaWVsZHNQYXlsb2FkID0gW11cbiAgICAgICAgICAgICAgICBjdW11bGF0ZWRMaW5rc0ZpZWxkcy5mb3JFYWNoKChsaW5rTm9kZXMsIG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gbGlua05vZGVzLm1hcCgobm9kZTogQ2FudmFzRmlsZURhdGEpID0+IEZpZWxkTWFuYWdlci5idWlsZE1hcmtEb3duTGluayhwbHVnaW4sIGZpbGUsIG5vZGUuZmlsZSwgbm9kZS5zdWJwYXRoKSlcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC5wdXNoKHsgbmFtZTogbmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogdmFsdWVzID8gWy4uLihuZXcgU2V0KHZhbHVlcykpXS5qb2luKFwiLFwiKSA6IFwiXCIgfSB9KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY3VtdWxhdGVkR3JvdXBzRmllbGRzLmZvckVhY2goKGdyb3VwTm9kZXMsIG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gZ3JvdXBOb2Rlcy5tYXAoKGdyb3VwOiBDYW52YXNHcm91cERhdGEpID0+IGdyb3VwLmxhYmVsKVxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnB1c2goeyBuYW1lOiBuYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiB2YWx1ZXMgPyBbLi4uKG5ldyBTZXQodmFsdWVzLmZpbHRlcih2ID0+ICEhdikpKV0uam9pbihcIixcIikgOiBcIlwiIH0gfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGN1bXVsYXRlZEdyb3Vwc0xpbmtzRmllbGRzLmZvckVhY2goKGxpbmtOb2RlcywgbmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBsaW5rTm9kZXMubWFwKChub2RlOiBDYW52YXNGaWxlRGF0YSkgPT4gRmllbGRNYW5hZ2VyLmJ1aWxkTWFya0Rvd25MaW5rKHBsdWdpbiwgZmlsZSwgbm9kZS5maWxlLCBub2RlLnN1YnBhdGgpKVxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnB1c2goeyBuYW1lOiBuYW1lLCBwYXlsb2FkOiB7IHZhbHVlOiB2YWx1ZXMgPyBbLi4uKG5ldyBTZXQodmFsdWVzKSldLmpvaW4oXCIsXCIpIDogXCJcIiB9IH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBpZiAocGF5bG9hZC5sZW5ndGgpIGF3YWl0IHBvc3RWYWx1ZXMocGx1Z2luLCBwYXlsb2FkLCBmaWxlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vY2xlYW4gcmVtb3ZlZCBmaWxlcyBieSBwdXR0aW5nIHRoZWlyIHJlbGF0ZWQgY2FudmFzIGZpZWxkcyB0byBudWxsIHNpbmNlIHRoZXkgZG9uJ3QgaGF2ZSBhbnltb3JlIGNvbm5lY3Rpb25zXG4gICAgICAgIHByZXZpb3VzRmlsZXNQYXRocy5maWx0ZXIoZiA9PiAhY3VycmVudEZpbGVzUGF0aHMuaW5jbHVkZXMoZikpLmZvckVhY2goYXN5bmMgZmlsZVBhdGggPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0RmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpXG4gICAgICAgICAgICBpZiAodGFyZ2V0RmlsZSAmJiB0YXJnZXRGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXlsb2FkOiBGaWVsZHNQYXlsb2FkID0gW11cbiAgICAgICAgICAgICAgICAvLyBjYW52YXMgZmllbGRzXG4gICAgICAgICAgICAgICAgY29uc3QgY2FudmFzRmllbGRzID0gZi5maWxlc0ZpZWxkcy5nZXQoZmlsZVBhdGgpPy5maWx0ZXIoZmllbGQgPT5cbiAgICAgICAgICAgICAgICAgICAgZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkNhbnZhc1xuICAgICAgICAgICAgICAgICAgICAmJiBmaWVsZC5vcHRpb25zLmNhbnZhc1BhdGggPT09IGNhbnZhcy5wYXRoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIGNhbnZhc0ZpZWxkcz8uZm9yRWFjaChmaWVsZCA9PiB7IHBheWxvYWQucHVzaCh7IG5hbWU6IGZpZWxkLm5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IFwiXCIgfSB9KSB9KVxuICAgICAgICAgICAgICAgIC8vIGNhbnZhcyBncm91cCBmaWVsZHNcbiAgICAgICAgICAgICAgICBjb25zdCBjYW52YXNHcm91cEZpZWxkcyA9IGYuZmlsZXNGaWVsZHMuZ2V0KGZpbGVQYXRoKT8uZmlsdGVyKGZpZWxkID0+XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5DYW52YXNHcm91cFxuICAgICAgICAgICAgICAgICAgICAmJiBmaWVsZC5vcHRpb25zLmNhbnZhc1BhdGggPT09IGNhbnZhcy5wYXRoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIGNhbnZhc0dyb3VwRmllbGRzPy5mb3JFYWNoKGZpZWxkID0+IHsgcGF5bG9hZC5wdXNoKHsgbmFtZTogZmllbGQubmFtZSwgcGF5bG9hZDogeyB2YWx1ZTogXCJcIiB9IH0pIH0pXG4gICAgICAgICAgICAgICAgLy8gY2FudmFzIGdyb3VwIGxpbmtzIGZpZWxkc1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhbnZhc0dyb3VwTGlua3NGaWVsZHMgPSBmLmZpbGVzRmllbGRzLmdldChmaWxlUGF0aCk/LmZpbHRlcihmaWVsZCA9PlxuICAgICAgICAgICAgICAgICAgICBmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuQ2FudmFzR3JvdXBMaW5rXG4gICAgICAgICAgICAgICAgICAgICYmIGZpZWxkLm9wdGlvbnMuY2FudmFzUGF0aCA9PT0gY2FudmFzLnBhdGhcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgY2FudmFzR3JvdXBMaW5rc0ZpZWxkcz8uZm9yRWFjaChmaWVsZCA9PiB7IHBheWxvYWQucHVzaCh7IG5hbWU6IGZpZWxkLm5hbWUsIHBheWxvYWQ6IHsgdmFsdWU6IFwiXCIgfSB9KSB9KVxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLmxlbmd0aCkgYXdhaXQgcG9zdFZhbHVlcyhwbHVnaW4sIHBheWxvYWQsIHRhcmdldEZpbGUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIHBsdWdpbi5maWVsZEluZGV4LmNhbnZhc0xhc3RGaWxlcy5zZXQoY2FudmFzLnBhdGgsIGN1cnJlbnRGaWxlc1BhdGhzKVxuICAgIH0pXG59XG4iLCAiaW1wb3J0IHsgQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnO1xuXG5cbmV4cG9ydCBjbGFzcyBUYXNrIHtcbiAgICBwdWJsaWMgc3RhdHVzOiBcInBlbmRpbmdcIiB8IFwib25nb2luZ1wiIHwgXCJkb25lXCI7XG4gICAgcHVibGljIGlkOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZm46ICgpID0+IGFueSkge1xuICAgICAgICB0aGlzLnN0YXR1cyA9IFwicGVuZGluZ1wiXG4gICAgICAgIHRoaXMuaWQgPSB1dWlkdjQoKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZVRhc2tNYW5hZ2VyIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIHB1YmxpYyBxdWV1ZTogTWFwPHN0cmluZywgVGFzaz47XG4gICAgcHVibGljIGJ1c3k6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBjYWNoZVZlcnNpb246IHN0cmluZywgcHVibGljIG9uQ2hhbmdlOiAoKSA9PiB2b2lkKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucXVldWUgPSBuZXcgTWFwKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdyZXNvbHZlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJvYnNpZGlhbiByZXNvbHZlZFwiKTtcbiAgICAgICAgICAgIHRoaXMuYnVzeSA9IGZhbHNlO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlTmV4dCgpO1xuICAgICAgICB9KSlcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbihcIm1vZGlmeVwiLCBhc3luYyAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09IFwiY2FudmFzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idXN5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZU5leHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgfVxuXG5cbiAgICBwdWJsaWMgYXN5bmMgcHVzaFRhc2soZm46ICgpID0+IGFueSkge1xuICAgICAgICBjb25zdCB0YXNrID0gbmV3IFRhc2soZm4pO1xuICAgICAgICB0aGlzLnF1ZXVlLnNldCh0YXNrLmlkLCB0YXNrKTtcbiAgICAgICAgaWYgKCF0aGlzLmJ1c3kpIGF3YWl0IHRoaXMuZXhlY3V0ZU5leHQoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZXhlY3V0ZU5leHQoKSB7XG4gICAgICAgIGNvbnN0IFtmaXJzdFRhc2tJblF1ZXVlSWQsIGZpcnN0VGFza0luUXVldWVdID0gWy4uLnRoaXMucXVldWVdWzBdIHx8IFt1bmRlZmluZWQsIHVuZGVmaW5lZF1cbiAgICAgICAgaWYgKGZpcnN0VGFza0luUXVldWUgJiYgIXRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmluUHJvZ3Jlc3NUYXNrQ291bnQpIHtcbiAgICAgICAgICAgIHRoaXMuYnVzeSA9IHRydWU7XG4gICAgICAgICAgICBmaXJzdFRhc2tJblF1ZXVlLnN0YXR1cyA9IFwib25nb2luZ1wiXG4gICAgICAgICAgICBhd2FpdCBmaXJzdFRhc2tJblF1ZXVlLmZuKClcbiAgICAgICAgICAgIGZpcnN0VGFza0luUXVldWUuc3RhdHVzID0gXCJkb25lXCJcbiAgICAgICAgICAgIHRoaXMucXVldWUuZGVsZXRlKGZpcnN0VGFza0luUXVldWVJZClcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJkb25lOiBcIiwgZmlyc3RUYXNrSW5RdWV1ZUlkKVxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJlbWFpbmluZ1wiLCBbLi4udGhpcy5xdWV1ZV0ubGVuZ3RoKVxuICAgICAgICAgICAgLy8gaW4gY2FzZSBub3RoaW5nIGhhcyBjaGFuZ2VkIGluIGZyb250bWF0dGVyLCBwcm9jZXNzRnJvbnRtYXR0ZXIgd29udCB0cmlnZ2VyIG1ldGFkYXRhY2FjaGUgcmVzb2x2ZSBcbiAgICAgICAgICAgIC8vIGFuZCBubyB0YXNrIHdpbGwgYmUgaW4gcHJvZ3Jlc3Mgc28gd2UgY2FuIGV4ZWN1dGUgbmV4dFxuICAgICAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50KSBhd2FpdCB0aGlzLmV4ZWN1dGVOZXh0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuaW5Qcm9ncmVzc1Rhc2tDb3VudCkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgd2FpdCAuLi4gJHt0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50fSB0YXNrcyBpbiBwcm9ncmVzc2ApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibm90aGluZyBlbHNlIHRvIGRvXCIpXG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8vIFVuaXF1ZSBJRCBjcmVhdGlvbiByZXF1aXJlcyBhIGhpZ2ggcXVhbGl0eSByYW5kb20gIyBnZW5lcmF0b3IuIEluIHRoZSBicm93c2VyIHdlIHRoZXJlZm9yZVxuLy8gcmVxdWlyZSB0aGUgY3J5cHRvIEFQSSBhbmQgZG8gbm90IHN1cHBvcnQgYnVpbHQtaW4gZmFsbGJhY2sgdG8gbG93ZXIgcXVhbGl0eSByYW5kb20gbnVtYmVyXG4vLyBnZW5lcmF0b3JzIChsaWtlIE1hdGgucmFuZG9tKCkpLlxubGV0IGdldFJhbmRvbVZhbHVlcztcbmNvbnN0IHJuZHM4ID0gbmV3IFVpbnQ4QXJyYXkoMTYpO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcm5nKCkge1xuICAvLyBsYXp5IGxvYWQgc28gdGhhdCBlbnZpcm9ubWVudHMgdGhhdCBuZWVkIHRvIHBvbHlmaWxsIGhhdmUgYSBjaGFuY2UgdG8gZG8gc29cbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAvLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG8gaW1wbGVtZW50YXRpb24uXG4gICAgZ2V0UmFuZG9tVmFsdWVzID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcblxuICAgIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59IiwgImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIChieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXSkudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZ2lmaWVkIFVVSUQgaXMgaW52YWxpZCcpO1xuICB9XG5cbiAgcmV0dXJuIHV1aWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHN0cmluZ2lmeTsiLCAiY29uc3QgcmFuZG9tVVVJRCA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5yYW5kb21VVUlEICYmIGNyeXB0by5yYW5kb21VVUlELmJpbmQoY3J5cHRvKTtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgcmFuZG9tVVVJRFxufTsiLCAiaW1wb3J0IG5hdGl2ZSBmcm9tICcuL25hdGl2ZS5qcyc7XG5pbXBvcnQgcm5nIGZyb20gJy4vcm5nLmpzJztcbmltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgaWYgKG5hdGl2ZS5yYW5kb21VVUlEICYmICFidWYgJiYgIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmF0aXZlLnJhbmRvbVVVSUQoKTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBjb25zdCBybmRzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IHJuZykoKTsgLy8gUGVyIDQuNCwgc2V0IGJpdHMgZm9yIHZlcnNpb24gYW5kIGBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkYFxuXG4gIHJuZHNbNl0gPSBybmRzWzZdICYgMHgwZiB8IDB4NDA7XG4gIHJuZHNbOF0gPSBybmRzWzhdICYgMHgzZiB8IDB4ODA7IC8vIENvcHkgYnl0ZXMgdG8gYnVmZmVyLCBpZiBwcm92aWRlZFxuXG4gIGlmIChidWYpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgYnVmW29mZnNldCArIGldID0gcm5kc1tpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmO1xuICB9XG5cbiAgcmV0dXJuIHVuc2FmZVN0cmluZ2lmeShybmRzKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdjQ7IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCAqIGFzIExvb2t1cCBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdldExpc3RCb3VuZHMgfSBmcm9tIFwic3JjL3V0aWxzL2xpc3RcIjtcbmltcG9ydCB7IGZpZWxkQ29tcG9uZW50cywgaW5saW5lRmllbGRSZWdleCwgZW5jb2RlTGluaywgZGVjb2RlTGluayB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5cbmNvbnN0IGVudW0gTG9jYXRpb24ge1xuICAgICdmdWxsTGluZScgPSAnZnVsbExpbmUnLFxuICAgICdicmFja2V0cycgPSAnYnJhY2tldHMnLFxuICAgICdwYXJlbnRoZXNpcycgPSAncGFyZW50aGVzaXMnXG59XG5cbmNvbnN0IExvY2F0aW9uV3JhcHBlcjogUmVjb3JkPGtleW9mIHR5cGVvZiBMb2NhdGlvbiwgeyBzdGFydDogXCJcIiB8IFwiW1wiIHwgXCIoXCIsIGVuZDogXCJcIiB8IFwiXVwiIHwgXCIpXCIgfT4gPSB7XG4gICAgXCJmdWxsTGluZVwiOiB7IHN0YXJ0OiBcIlwiLCBlbmQ6IFwiXCIgfSxcbiAgICBcImJyYWNrZXRzXCI6IHsgc3RhcnQ6IFwiW1wiLCBlbmQ6IFwiXVwiIH0sXG4gICAgXCJwYXJlbnRoZXNpc1wiOiB7IHN0YXJ0OiBcIihcIiwgZW5kOiBcIilcIiB9XG59XG5cbnR5cGUgRmllbGRSZXBsYWNlID0ge1xuICAgIG9sZEZpZWxkOiBzdHJpbmcsXG4gICAgbmV3RmllbGQ6IHN0cmluZyxcbn1cblxuZXhwb3J0IGNvbnN0IG1hdGNoSW5saW5lRmllbGRzID0gKHJlZ2V4OiBSZWdFeHAsIGxpbmU6IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcsIGxvY2F0aW9uOiBrZXlvZiB0eXBlb2YgTG9jYXRpb24gPSBcImZ1bGxMaW5lXCIpOiBGaWVsZFJlcGxhY2VbXSA9PiB7XG4gICAgY29uc3Qgc1IgPSBsaW5lLm1hdGNoQWxsKHJlZ2V4KTtcbiAgICBsZXQgbmV4dCA9IHNSLm5leHQoKTtcbiAgICBjb25zdCBuZXdGaWVsZHM6IEZpZWxkUmVwbGFjZVtdID0gW107XG4gICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBuZXh0LnZhbHVlO1xuICAgICAgICBpZiAobWF0Y2guZ3JvdXBzICYmIE9iamVjdC5rZXlzKG1hdGNoLmdyb3VwcykuZXZlcnkoaiA9PiBmaWVsZENvbXBvbmVudHMuaW5jbHVkZXMoaikpKSB7XG4gICAgICAgICAgICBjb25zdCB7IGluTGlzdCwgaW5RdW90ZSwgcHJlU3BhY2VyLCBzdGFydFN0eWxlLCBlbmRTdHlsZSwgYmVmb3JlU2VwYXJhdG9yU3BhY2VyLCBhZnRlclNlcGFyYXRvclNwYWNlciwgdmFsdWVzIH0gPSBtYXRjaC5ncm91cHNcbiAgICAgICAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSBpbnB1dCA/IGlucHV0LnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykgOiBbXCJcIl07XG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IGlucHV0QXJyYXkubGVuZ3RoID09IDEgPyBpbnB1dEFycmF5WzBdIDogYCR7aW5wdXRBcnJheS5qb2luKCcsICcpfWA7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IExvY2F0aW9uV3JhcHBlcltsb2NhdGlvbl0uc3RhcnQ7XG4gICAgICAgICAgICBjb25zdCBlbmQgPSBMb2NhdGlvbldyYXBwZXJbbG9jYXRpb25dLmVuZDtcbiAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBvbGRGaWVsZDogbWF0Y2hbMF0sXG4gICAgICAgICAgICAgICAgbmV3RmllbGQ6IGAke2luUXVvdGUgfHwgXCJcIn0ke3N0YXJ0fSR7aW5MaXN0IHx8IFwiXCJ9JHtwcmVTcGFjZXIgfHwgXCJcIn0ke3N0YXJ0U3R5bGV9JHthdHRyaWJ1dGV9JHtlbmRTdHlsZX0ke2JlZm9yZVNlcGFyYXRvclNwYWNlcn06OiR7YWZ0ZXJTZXBhcmF0b3JTcGFjZXJ9JHtuZXdWYWx1ZX0ke2VuZH1gLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBuZXh0ID0gc1IubmV4dCgpXG4gICAgfVxuICAgIHJldHVybiBuZXdGaWVsZHNcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VWYWx1ZXMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLFxuICAgIGF0dHJpYnV0ZTogc3RyaW5nLFxuICAgIGlucHV0OiBzdHJpbmcsXG4gICAgcHJldmlvdXNJdGVtc0NvdW50OiBudW1iZXIgPSAwXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPckZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPckZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yRmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjb250ZW50ID0gKGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKSkuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXI7XG4gICAgLy9maXJzdCBsb29rIGZvciBsb29rdXAgbGlzdHNcblxuICAgIGNvbnN0IHNraXBwZWRMaW5lczogbnVtYmVyW10gPSBbXVxuXG4gICAgY29uc3QgeyBwb3NpdGlvbjogeyBzdGFydCwgZW5kIH0gfSA9IGZyb250bWF0dGVyID8gZnJvbnRtYXR0ZXIgOiB7IHBvc2l0aW9uOiB7IHN0YXJ0OiB1bmRlZmluZWQsIGVuZDogdW5kZWZpbmVkIH0gfTtcbiAgICBjb25zdCBuZXdDb250ZW50ID0gY29udGVudC5tYXAoKGxpbmUsIGkpID0+IHtcbiAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBpID49IHN0YXJ0LmxpbmUgJiYgaSA8PSBlbmQubGluZSkge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHthdHRyaWJ1dGV9OmAsICd1Jyk7XG4gICAgICAgICAgICBjb25zdCByID0gbGluZS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEFycmF5ID0gaW5wdXQgPyBpbnB1dC5yZXBsYWNlKC8oXFwsXFxzKykvZywgJywnKS5zcGxpdCgnLCcpIDogW1wiXCJdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgWyR7aW5wdXRBcnJheS5qb2luKCcsICcpfV1gO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHthdHRyaWJ1dGV9OiAke25ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZW5jb2RlZElucHV0ID0gZW5jb2RlTGluayhpbnB1dClcbiAgICAgICAgICAgIGxldCBlbmNvZGVkTGluZSA9IGVuY29kZUxpbmsobGluZSlcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxMaW5lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKilgLCBcInVcIik7XG4gICAgICAgICAgICBjb25zdCBmUiA9IGVuY29kZWRMaW5lLm1hdGNoKGZ1bGxMaW5lUmVnZXgpO1xuICAgICAgICAgICAgaWYgKGZSPy5ncm91cHMgJiYgT2JqZWN0LmtleXMoZlIuZ3JvdXBzKS5ldmVyeShqID0+IGZpZWxkQ29tcG9uZW50cy5pbmNsdWRlcyhqKSkpIHtcbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIHRoaXMgZmllbGQgaXMgYSBsb29rdXAgYW5kIGdldCBsaXN0IGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBhdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkPy50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhwcmV2aW91c0l0ZW1zQ291bnQpXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvdW5kcyA9IGdldExpc3RCb3VuZHMocGx1Z2luLCBmaWxlLCBpKVxuICAgICAgICAgICAgICAgICAgICBpZiAoYm91bmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IGJvdW5kcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSBzdGFydCArIDE7IGogPCBzdGFydCArIHByZXZpb3VzSXRlbXNDb3VudCArIDEgJiYgaiA8IGVuZCArIDE7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRMaW5lcy5wdXNoKGopXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgeyBpbkxpc3QsIGluUXVvdGUsIHByZVNwYWNlciwgc3RhcnRTdHlsZSwgZW5kU3R5bGUsIGJlZm9yZVNlcGFyYXRvclNwYWNlciwgYWZ0ZXJTZXBhcmF0b3JTcGFjZXIsIHZhbHVlcyB9ID0gZlIuZ3JvdXBzXG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXRBcnJheSA9IGlucHV0ID8gaW5wdXQucmVwbGFjZSgvKFxcLFxccyspL2csICcsJykuc3BsaXQoJywnKS5zb3J0KCkgOiBbXTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3VmFsdWU6IHN0cmluZztcbiAgICAgICAgICAgICAgICBsZXQgaGlkZGVuVmFsdWUgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkPy50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwICYmIExvb2t1cC5idWxsZXRMaXN0TG9va3VwVHlwZXMuaW5jbHVkZXMoZmllbGQ/Lm9wdGlvbnMub3V0cHV0VHlwZSBhcyBMb29rdXAuVHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gXCJcXG4tIFwiICsgaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkubGVuZ3RoID4gMCA/IFwiXFxuXCIgOiBcIlwifSR7aW5wdXRBcnJheS5tYXAoaXRlbSA9PiBcIi0gXCIgKyBpdGVtKS5qb2luKCdcXG4nKX1gO1xuICAgICAgICAgICAgICAgICAgICAvLyBoaWRlIHRoZSB2YWx1ZXMgbmV4dCB0byB0aGUgZmllbGQgc28gdGhhdCB0aGV5IGFyZSByZWFkYWJsZSBieSBnZXRWYWx1ZXMuIFxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIGdldFZhbHVlcyBpbnN0ZWFkIG9mIGR2LnBhZ2UgdG8gaGF2ZSB0aGUgcmF3VmFsdWUgYmVjYXVzZSBkdiBpcyB0cmFuc2Zvcm1pbmcgZGF0YSwgbWFraW5nIGNvbXBhcmlzb24gaW1wb3NzaWJsZVxuICAgICAgICAgICAgICAgICAgICBoaWRkZW5WYWx1ZSA9IGA8ZGl2IGhpZGRlbiBpZD1cIiR7ZmllbGQubmFtZX1fdmFsdWVzXCI+JHtpbnB1dH08L2Rpdj5gXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkuam9pbignLCAnKX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7aW5RdW90ZSB8fCBcIlwifSR7aW5MaXN0IHx8IFwiXCJ9JHtwcmVTcGFjZXIgfHwgXCJcIn0ke3N0YXJ0U3R5bGV9JHthdHRyaWJ1dGV9JHtlbmRTdHlsZX0ke2JlZm9yZVNlcGFyYXRvclNwYWNlcn06OiR7YWZ0ZXJTZXBhcmF0b3JTcGFjZXJ9JHtoaWRkZW5WYWx1ZSArIG5ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkczogRmllbGRSZXBsYWNlW10gPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluU2VudGVuY2VSZWdleFBhciA9IG5ldyBSZWdFeHAoYFxcXFwoJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXCldKyk/XFxcXClgLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKC4uLm1hdGNoSW5saW5lRmllbGRzKGluU2VudGVuY2VSZWdleEJyYWNrZXRzLCBlbmNvZGVkTGluZSwgYXR0cmlidXRlLCBlbmNvZGVkSW5wdXQsIExvY2F0aW9uLmJyYWNrZXRzKSlcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5tYXRjaElubGluZUZpZWxkcyhpblNlbnRlbmNlUmVnZXhQYXIsIGVuY29kZWRMaW5lLCBhdHRyaWJ1dGUsIGVuY29kZWRJbnB1dCwgTG9jYXRpb24ucGFyZW50aGVzaXMpKVxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRSZWdleCA9IG5ldyBSZWdFeHAoZmllbGQub2xkRmllbGQucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKSwgXCJ1XCIpXG4gICAgICAgICAgICAgICAgICAgIGVuY29kZWRMaW5lID0gZW5jb2RlZExpbmUucmVwbGFjZShmaWVsZFJlZ2V4LCBmaWVsZC5uZXdGaWVsZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlTGluayhlbmNvZGVkTGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvL2NvbnNvbGUubG9nKFwic3RhcnRlZCB3cml0aW5nLi4uXCIsIGlucHV0KVxuICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuZmlsdGVyKChsaW5lLCBpKSA9PiAhc2tpcHBlZExpbmVzLmluY2x1ZGVzKGkpKS5qb2luKCdcXG4nKSk7XG4gICAgLy9jb25zb2xlLmxvZyhcImZpbmlzaGVkIHdyaXRpbmcuLi5cIiwgaW5wdXQpXG4gICAgY29uc3QgZWRpdG9yID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3JcbiAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZVxuICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogZWRpdG9yLmdldEN1cnNvcigpLmxpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShsaW5lTnVtYmVyKS5sZW5ndGggfSlcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyB9IGZyb20gXCIuL2luc2VydEZyb250bWF0dGVyV2l0aEZpZWxkc1wiO1xuXG4vKiBERVBSRUNBVEVEICovXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRWYWx1ZXMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLFxuICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgIHZhbHVlOiBzdHJpbmcsXG4gICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICBpbkZyb250bWF0dGVyPzogYm9vbGVhbixcbiAgICBhZnRlcjogYm9vbGVhbiA9IHRydWUsXG4gICAgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2Vcbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGxldCBmaWxlOiBURmlsZTtcbiAgICBpZiAoZmlsZU9yRmlsZVBhdGggaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICBmaWxlID0gZmlsZU9yRmlsZVBhdGg7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgX2ZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlT3JGaWxlUGF0aClcbiAgICAgICAgaWYgKF9maWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgX2ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmlsZSA9IF9maWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXJcbiAgICBpZiAoaW5Gcm9udG1hdHRlciAmJiBsaW5lTnVtYmVyID09IC0yICYmICFmcm9udG1hdHRlcikge1xuICAgICAgICBjb25zdCBmaWVsZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuICAgICAgICBmaWVsZHNbZmllbGROYW1lXSA9IHZhbHVlXG4gICAgICAgIGF3YWl0IGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyhwbHVnaW4sIGZpbGUsIGZpZWxkcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCB0YXJnZXRMaW5lTnVtYmVyID0gaW5Gcm9udG1hdHRlciAmJiBsaW5lTnVtYmVyID09IC0yICYmIGZyb250bWF0dGVyID9cbiAgICAgICAgICAgIGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lIC0gMSA6IGxpbmVOdW1iZXJcbiAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBpZiAoX2xpbmVOdW1iZXIgPT0gdGFyZ2V0TGluZU51bWJlcikge1xuICAgICAgICAgICAgICAgIGlmIChhZnRlcikgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xpbmUgPSBgJHshaW5Gcm9udG1hdHRlciAmJiBhc0NvbW1lbnQgPyBcIj5cIiA6IFwiXCJ9JHshaW5Gcm9udG1hdHRlciAmJiBhc0xpc3QgPyBcIi0gXCIgOiBcIlwifSR7ZmllbGROYW1lfSR7aW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke3ZhbHVlfWA7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKG5ld0xpbmUpO1xuICAgICAgICAgICAgICAgIGlmICghYWZ0ZXIpIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3JcbiAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lXG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogZWRpdG9yLmdldEN1cnNvcigpLmxpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShsaW5lTnVtYmVyKS5sZW5ndGggfSlcbiAgICAgICAgfVxuICAgIH1cblxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbi8qIERlcHJlY2F0ZWQgKi9cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyhcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsXG4gICAgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JGaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JGaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPckZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gXCItLS1cXG5cIiArIE9iamVjdC5lbnRyaWVzKGZpZWxkcykubWFwKChbZmllbGROYW1lLCB2YWx1ZV0pID0+IGAke2ZpZWxkTmFtZX06ICR7dmFsdWV9YCkuam9pbihcIlxcblwiKSArIChcIlxcbi0tLVxcblwiKVxuXG4gICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgZnJvbnRtYXR0ZXIgKyBjb250ZW50KTtcbiAgICBjb25zdCBlZGl0b3IgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvclxuICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgY29uc3QgbGluZU51bWJlciA9IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lXG4gICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSwgY2g6IGVkaXRvci5nZXRMaW5lKGxpbmVOdW1iZXIpLmxlbmd0aCB9KVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IGNob29zZVNlY3Rpb25Nb2RhbCBmcm9tIFwic3JjL21vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWxcIjtcbmltcG9ydCB7IHNldEljb24sIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmZ1bmN0aW9uIGJ1aWxkQW5kT3Blbk1vZGFsKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGZpbGU6IFRGaWxlLFxuICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4pOiB2b2lkIHtcbiAgICBpZiAoYXR0cnM/Lm9wdGlvbnM/LmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgY29uc3QgbGluZU51bWJlciA9IC0gMVxuICAgICAgICBGLm9wZW5GaWVsZE1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBcIlwiLCBsaW5lTnVtYmVyLCBmYWxzZSwgZmFsc2UsIGZhbHNlKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICBwbHVnaW4sXG4gICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgICAgICAgICBhZnRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICApID0+IEYub3BlbkZpZWxkTW9kYWwoXG4gICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgZmllbGROYW1lLFxuICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICApXG4gICAgICAgICkub3BlbigpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlRHZGaWVsZChcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBkdjogYW55LFxuICAgIHA6IGFueSxcbiAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbik6IHZvaWQge1xuICAgIGNvbnN0IGZpZWxkID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHAuZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSBmaWVsZE5hbWUpXG4gICAgaWYgKGZpZWxkPy50eXBlKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0ocGx1Z2luLCBmaWVsZCk7XG4gICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKGR2LCBwLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSk7XG4gICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKGR2LCBwLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpZWxkTW9kaWZpZXIoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZHY6IGFueSxcbiAgICBwOiBhbnksXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbik6IEhUTUxFbGVtZW50IHtcblxuICAgIC8qIGZpZWxkQ29udGFpbmVyKi9cbiAgICBjb25zdCBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQgPSBkdi5lbChcImRpdlwiLCBcIlwiKVxuICAgIGZpZWxkQ29udGFpbmVyLnNldEF0dHIoXCJjbGFzc1wiLCBgbWV0YWRhdGEtbWVudS1kdi1maWVsZC1jb250YWluZXIgJHtmaWVsZE5hbWV9YClcblxuICAgIC8qIGNyZWF0ZSBmaWVsZE1vZGlmaWVyIGRlcGVuZGluZyBvbiBmaWxlQ2xhc3MgdHlwZSBvciBwcmVzZXQgdmFsdWUqL1xuXG4gICAgaWYgKHBbZmllbGROYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LnNob3dBZGRGaWVsZCkge1xuICAgICAgICAgICAgY29uc3QgZW1wdHlGaWVsZCA9IGR2LmVsKFwic3BhblwiLCBudWxsLCBhdHRycyk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChlbXB0eUZpZWxkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGFkZEZpZWxkQnRuID0gZHYuZWwoXCJidXR0b25cIiwgYXR0cnMpO1xuICAgICAgICAgICAgc2V0SWNvbihhZGRGaWVsZEJ0biwgXCJwbHVzLXdpdGgtY2lyY2xlXCIpXG4gICAgICAgICAgICBhZGRGaWVsZEJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gZmllbGROYW1lKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBhdHRycylcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT4gRi5vcGVuRmllbGRNb2RhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICApLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChhZGRGaWVsZEJ0bik7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUR2RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGRDb250YWluZXIsIGZpZWxkTmFtZSwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSk7XG4gICAgICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUR2RmllbGQoZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkQ29udGFpbmVyXG59OyAiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWVsZEluZm8ge1xuICAgIHByb3RlY3RlZCB0eXBlPzogRmllbGRUeXBlID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBzb3VyY2VUeXBlPzogXCJmaWxlQ2xhc3NcIiB8IFwic2V0dGluZ3NcIiA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgZmlsZUNsYXNzPzogc3RyaW5nID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHN0cmluZ1tdID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBpc1ZhbGlkPzogYm9vbGVhbiA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgaWdub3JlSW5NZW51OiBib29sZWFuXG4gICAgcHJvdGVjdGVkIHZhbHVlOiBzdHJpbmcgPSBcIlwiO1xuICAgIHByb3RlY3RlZCB2YWx1ZXNMaXN0Tm90ZVBhdGg/OiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgcHVibGljIHVuaXF1ZTogYm9vbGVhbiA9IHRydWVcblxuICAgIHB1YmxpYyBzZXRJbmZvcyhcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgbWF0Y2hpbmdGaWxlQ2xhc3NRdWVyeT86IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgICk6IHZvaWQge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuaWdub3JlSW5NZW51ID0gcGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpO1xuICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgdGhpcy5pc1ZhbGlkID0gZmllbGRNYW5hZ2VyLnZhbGlkYXRlVmFsdWUodmFsdWUpXG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IGZpZWxkLmZpbGVDbGFzc05hbWU7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSBmaWVsZC50eXBlO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9IGZpZWxkLmZpbGVDbGFzc05hbWUgPyBcImZpbGVDbGFzc1wiIDogXCJzZXR0aW5nc1wiXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWxlRmllbGRzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlT3JmaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcpOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+IHtcbiAgICAvKlxuICAgIHJldHVybnMgYWxsIGZpZWxkcyB3aXRoIHNvdXJjZSwgdHlwZSwgb3B0aW9ucywgaXNWYWxpZCwgaWdub3JlZFxuICAgICovXG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JmaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JmaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPcmZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+ID0ge31cbiAgICBjb25zdCBkdkFwaSA9IHBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBnZW51aW5lS2V5cyhkdkZpbGUpLmZvckVhY2goYXN5bmMga2V5ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSBcImZpbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBuZXcgRmllbGRJbmZvO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZEluZm8udW5pcXVlID0gIU9iamVjdC5rZXlzKGZpZWxkcykuaW5jbHVkZXMoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzW2tleV0gPSBmaWVsZEluZm87XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkSW5mby5zZXRJbmZvcyhwbHVnaW4sIGZpbGUsIGtleSwgZHZGaWxlW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpZWxkcztcbn0iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgeyBnZXRWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9nZXRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IGZpZWxkTW9kaWZpZXIgfSBmcm9tIFwiLi9jb21tYW5kcy9maWVsZE1vZGlmaWVyXCI7XG5pbXBvcnQgeyBmaWxlRmllbGRzLCBGaWVsZEluZm8gfSBmcm9tIFwiLi9jb21tYW5kcy9maWxlRmllbGRzXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcIi4vY29tbWFuZHMvaW5zZXJ0TWlzc2luZ0ZpZWxkc1wiO1xuaW1wb3J0IHsgcG9zdFZhbHVlcywgRmllbGRzUGF5bG9hZCB9IGZyb20gXCIuL2NvbW1hbmRzL3Bvc3RWYWx1ZXNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBJTWV0YWRhdGFNZW51QXBpIHtcbiAgICBnZXRWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZ1tdPjtcbiAgICByZXBsYWNlVmFsdWVzOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgICBpbnNlcnRWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKSA9PiBQcm9taXNlPHZvaWQ+XG4gICAgZmlsZUZpZWxkczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+PjtcbiAgICBmaWVsZE1vZGlmaWVyOiAoZHY6IGFueSwgcDogYW55LCBmaWVsZE5hbWU6IHN0cmluZywgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0pID0+IEhUTUxFbGVtZW50O1xuICAgIGluc2VydE1pc3NpbmdGaWVsZHM6IChmaWxlT3JGaWxlUGF0aDogc3RyaW5nIHwgVEZpbGUsIGxpbmVOdW1iZXI6IG51bWJlciwgYWZ0ZXI6IGJvb2xlYW4sIGFzTGlzdDogYm9vbGVhbiwgYXNDb21tZW50OiBib29sZWFuLCBmaWxlQ2xhc3NOYW1lPzogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuICAgIHBvc3RWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIHBheWxvYWQ6IEZpZWxkc1BheWxvYWQsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNsYXNzIE1ldGFkYXRhTWVudUFwaSB7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51KSB7IH1cblxuICAgIHB1YmxpYyBtYWtlKCk6IElNZXRhZGF0YU1lbnVBcGkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0VmFsdWVzOiB0aGlzLmdldFZhbHVlcygpLFxuICAgICAgICAgICAgcmVwbGFjZVZhbHVlczogdGhpcy5yZXBsYWNlVmFsdWVzKCksXG4gICAgICAgICAgICBpbnNlcnRWYWx1ZXM6IHRoaXMuaW5zZXJ0VmFsdWVzKCksXG4gICAgICAgICAgICBmaWVsZE1vZGlmaWVyOiB0aGlzLmZpZWxkTW9kaWZpZXIoKSxcbiAgICAgICAgICAgIGZpbGVGaWVsZHM6IHRoaXMuZmlsZUZpZWxkcygpLFxuICAgICAgICAgICAgaW5zZXJ0TWlzc2luZ0ZpZWxkczogdGhpcy5pbnNlcnRNaXNzaW5nRmllbGRzKCksXG4gICAgICAgICAgICBwb3N0VmFsdWVzOiB0aGlzLnBvc3RWYWx1ZXMoKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0VmFsdWVzKCk6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZykgPT4gZ2V0VmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aCwgYXR0cmlidXRlKVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVwbGFjZVZhbHVlcygpOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcInJlcGxhY2VWYWx1ZXMgaXMgZGVwcmVjYXRlZCwgdXNlIHBvc3RWYWx1ZXMgaW5zdGVhZFwiKVxuICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZU9yRmlsZVBhdGgsIGF0dHJpYnV0ZSwgYCR7aW5wdXR9YClcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGluc2VydFZhbHVlcygpOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbikgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcImluc2VydFZhbHVlcyBpcyBkZXByZWNhdGVkLCB1c2UgcG9zdFZhbHVlcyBpbnN0ZWFkXCIpXG4gICAgICAgICAgICBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGVPckZpbGVQYXRoLCBmaWVsZE5hbWUsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaWVsZE1vZGlmaWVyKCk6IChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gSFRNTEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gKGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSA9PiBmaWVsZE1vZGlmaWVyKHRoaXMucGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBhdHRycylcbiAgICB9XG5cbiAgICBwcml2YXRlIGZpbGVGaWVsZHMoKTogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+PiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nKSA9PiBmaWxlRmllbGRzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aClcbiAgICB9XG5cbiAgICBwcml2YXRlIGluc2VydE1pc3NpbmdGaWVsZHMoKTogKGZpbGVPckZpbGVQYXRoOiBzdHJpbmcgfCBURmlsZSwgbGluZU51bWJlcjogbnVtYmVyLCBhZnRlcjogYm9vbGVhbiwgYXNMaXN0OiBib29sZWFuLCBhc0NvbW1lbnQ6IGJvb2xlYW4sIGZpbGVDbGFzc05hbWU/OiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBzdHJpbmcgfCBURmlsZSwgbGluZU51bWJlcjogbnVtYmVyLCBhZnRlcjogYm9vbGVhbiwgYXNMaXN0OiBib29sZWFuLCBhc0NvbW1lbnQ6IGJvb2xlYW4sIGZpbGVDbGFzc05hbWU/OiBzdHJpbmcpID0+IGluc2VydE1pc3NpbmdGaWVsZHModGhpcy5wbHVnaW4sIGZpbGVPckZpbGVQYXRoLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQsIGZpbGVDbGFzc05hbWUpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwb3N0VmFsdWVzKCk6IChmaWxlT3JGaWxlUGF0aDogc3RyaW5nIHwgVEZpbGUsIHBheWxvYWQ6IEZpZWxkc1BheWxvYWQsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IHN0cmluZyB8IFRGaWxlLCBwYXlsb2FkOiBGaWVsZHNQYXlsb2FkLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pID0+IHBvc3RWYWx1ZXModGhpcy5wbHVnaW4sIHBheWxvYWQsIGZpbGVPckZpbGVQYXRoLCBsaW5lTnVtYmVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgfVxufSIsICJpbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IHsgTXVsdGlEaXNwbGF5VHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1ldGFkYXRhTWVudVNldHRpbmdzIHtcblx0cHJlc2V0RmllbGRzOiBBcnJheTxGaWVsZD47XG5cdGZpbGVDbGFzc1F1ZXJpZXM6IEFycmF5PEZpbGVDbGFzc1F1ZXJ5Pjtcblx0ZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnU6IGJvb2xlYW47XG5cdGdsb2JhbGx5SWdub3JlZEZpZWxkczogQXJyYXk8c3RyaW5nPjtcblx0Y2xhc3NGaWxlc1BhdGg6IHN0cmluZyB8IG51bGw7XG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiBib29sZWFuO1xuXHRmaWxlQ2xhc3NBbGlhczogc3RyaW5nO1xuXHRzZXR0aW5nc1ZlcnNpb24/OiBudW1iZXI7XG5cdGdsb2JhbEZpbGVDbGFzcz86IHN0cmluZztcblx0Zmlyc3REYXlPZldlZWs6IG51bWJlcjtcblx0ZW5hYmxlTGlua3M6IGJvb2xlYW47XG5cdGVuYWJsZVRhYkhlYWRlcjogYm9vbGVhbjtcblx0ZW5hYmxlRWRpdG9yOiBib29sZWFuO1xuXHRlbmFibGVCYWNrbGlua3M6IGJvb2xlYW47XG5cdGVuYWJsZVN0YXJyZWQ6IGJvb2xlYW47XG5cdGVuYWJsZUZpbGVFeHBsb3JlcjogYm9vbGVhbjtcblx0ZW5hYmxlU2VhcmNoOiBib29sZWFuO1xuXHRidXR0b25JY29uOiBzdHJpbmc7XG5cdHRhYmxlVmlld01heFJlY29yZHM6IG51bWJlcjtcblx0ZnJvbnRtYXR0ZXJMaXN0RGlzcGxheTogTXVsdGlEaXNwbGF5VHlwZTtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE1ldGFkYXRhTWVudVNldHRpbmdzID0ge1xuXHRwcmVzZXRGaWVsZHM6IFtdLFxuXHRmaWxlQ2xhc3NRdWVyaWVzOiBbXSxcblx0ZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnU6IHRydWUsXG5cdGdsb2JhbGx5SWdub3JlZEZpZWxkczogW10sXG5cdGNsYXNzRmlsZXNQYXRoOiBudWxsLFxuXHRpc0F1dG9zdWdnZXN0RW5hYmxlZDogdHJ1ZSxcblx0ZmlsZUNsYXNzQWxpYXM6IFwiZmlsZUNsYXNzXCIsXG5cdHNldHRpbmdzVmVyc2lvbjogdW5kZWZpbmVkLFxuXHRnbG9iYWxGaWxlQ2xhc3M6IHVuZGVmaW5lZCxcblx0Zmlyc3REYXlPZldlZWs6IDEsXG5cdGVuYWJsZUxpbmtzOiB0cnVlLFxuXHRlbmFibGVUYWJIZWFkZXI6IHRydWUsXG5cdGVuYWJsZUVkaXRvcjogdHJ1ZSxcblx0ZW5hYmxlQmFja2xpbmtzOiB0cnVlLFxuXHRlbmFibGVTdGFycmVkOiB0cnVlLFxuXHRlbmFibGVGaWxlRXhwbG9yZXI6IHRydWUsXG5cdGVuYWJsZVNlYXJjaDogdHJ1ZSxcblx0YnV0dG9uSWNvbjogXCJjbGlwYm9hcmQtbGlzdFwiLFxuXHR0YWJsZVZpZXdNYXhSZWNvcmRzOiAxMDAsXG5cdGZyb250bWF0dGVyTGlzdERpc3BsYXk6IE11bHRpRGlzcGxheVR5cGUuYXNBcnJheVxufTsiLCAiaW1wb3J0IHsgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgQnV0dG9uQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQsIE1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgbW9tZW50LCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IEZvbGRlclN1Z2dlc3QgfSBmcm9tIFwic3JjL3N1Z2dlc3Rlci9Gb2xkZXJTdWdnZXN0ZXJcIjtcbmltcG9ydCB7IEZpbGVTdWdnZXN0IH0gZnJvbSBcInNyYy9zdWdnZXN0ZXIvRmlsZVN1Z2dlc3RlclwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5XCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnlTZXR0aW5nc01vZGFsIGZyb20gXCIuL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ01vZGFsXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnlTZXR0aW5nIGZyb20gXCIuL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ1wiO1xuaW1wb3J0IHsgTXVsdGlEaXNwbGF5VHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcblx0XHR0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwic2V0dGluZ3NcIilcblx0fTtcblxuXHRwcml2YXRlIGNyZWF0ZVNldHRpbmdHcm91cCh0aXRsZTogc3RyaW5nLCBzdWJUaXRsZT86IHN0cmluZywgd2l0aEJ1dHRvbjogYm9vbGVhbiA9IGZhbHNlKTogSFRNTERpdkVsZW1lbnQge1xuXHRcdGNvbnN0IHNldHRpbmdIZWFkZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKVxuXHRcdGNvbnN0IHNldHRpbmdIZWFkZXJDb250YWluZXIgPSBzZXR0aW5nSGVhZGVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcImhlYWRlci1jb250YWluZXJcIiB9KTtcblx0XHRjb25zdCBzZXR0aW5nSGVhZGVyVGV4dENvbnRhaW5lciA9IHNldHRpbmdIZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwidGV4dC1jb250YWluZXJcIiB9KTtcblx0XHRzZXR0aW5nSGVhZGVyVGV4dENvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6IHRpdGxlLCBjbHM6IFwic2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRpZiAoc3ViVGl0bGUpIHNldHRpbmdIZWFkZXJUZXh0Q29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IHN1YlRpdGxlLCBjbHM6IFwic2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uXCIgfSk7XG5cblx0XHRjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIik7XG5cdFx0aWYgKHdpdGhCdXR0b24pIHtcblx0XHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbkNvbnRhaW5lciA9IHNldHRpbmdIZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic2V0dGluZy1pdGVtLWNvbnRyb2xcIiB9KTtcblx0XHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoc2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uQ29udGFpbmVyKTtcblx0XHRcdHNldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcInNldHRpbmctaXRlbS1jb250cm9sXCIpO1xuXHRcdFx0c2V0dGluZ3NDb250YWluZXIuaGlkZSgpO1xuXHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnNldEN0YSgpO1xuXHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnNldEljb24oXCJjaGV2cm9ucy11cC1kb3duXCIpO1xuXG5cdFx0XHRjb25zdCB0b2dnbGVTdGF0ZSA9ICgpID0+IHtcblx0XHRcdFx0aWYgKHNldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSkge1xuXHRcdFx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmhpZGUoKTtcblx0XHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24uc2V0SWNvbihcImNoZXZyb25zLXVwLWRvd25cIik7XG5cdFx0XHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnNldEN0YSgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNldHRpbmdzQ29udGFpbmVyLnNob3coKTtcblx0XHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24uc2V0SWNvbihcImNoZXZyb25zLWRvd24tdXBcIik7XG5cdFx0XHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnJlbW92ZUN0YSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRzZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24ub25DbGljaygoKSA9PiB0b2dnbGVTdGF0ZSgpKTtcblx0XHR9XG5cblxuXHRcdHJldHVybiBzZXR0aW5nc0NvbnRhaW5lclxuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRHbG9iYWwgU2V0dGluZ3MgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdGNvbnN0IGdsb2JhbFNldHRpbmdzID0gdGhpcy5jcmVhdGVTZXR0aW5nR3JvdXAoXG5cdFx0XHQnR2xvYmFsIHNldHRpbmdzJyxcblx0XHRcdFwiR2xvYmFsIHNldHRpbmdzIHRvIGFwcGx5IHRvIHlvdXIgd2hvbGUgdmF1bHRcIixcblx0XHRcdHRydWVcblx0XHQpXG5cblx0XHQvKiBNYW5hZ2UgbWVudSBvcHRpb25zIGRpc3BsYXkqL1xuXHRcdG5ldyBTZXR0aW5nKGdsb2JhbFNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJEaXNwbGF5IGZpZWxkIG9wdGlvbnMgaW4gY29udGV4dCBtZW51XCIpXG5cdFx0XHQuc2V0RGVzYyhcIkNob29zZSB0byBzaG93IG9yIGhpZGUgZmllbGRzIG9wdGlvbnMgaW4gdGhlIGNvbnRleHQgbWVudSBvZiBhIGxpbmsgb3IgYSBmaWxlXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGU6IFRvZ2dsZUNvbXBvbmVudCkgPT4ge1xuXHRcdFx0XHR0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnUpXG5cdFx0XHRcdHRvZ2dsZS5vbkNoYW5nZShhc3luYyB2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnUgPSB2YWx1ZVxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXHRcdC8qIEV4Y2x1ZGUgRmllbGRzIGZyb20gY29udGV4dCBtZW51Ki9cblx0XHRjb25zdCBnbG9iYWxseUlnbm9yZWRGaWVsZHNTZXR0aW5nID0gbmV3IFNldHRpbmcoZ2xvYmFsU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnR2xvYmFsbHkgaWdub3JlZCBmaWVsZHMnKVxuXHRcdFx0LnNldERlc2MoJ0ZpZWxkcyB0byBiZSBpZ25vcmVkIGJ5IHRoZSBwbHVnaW4gd2hlbiBhZGRpbmcgb3B0aW9ucyB0byB0aGUgY29udGV4dCBtZW51Jylcblx0XHRcdC5hZGRUZXh0QXJlYSgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBmaWVsZHMgYXMgc3RyaW5nLCBjb21tYSBzZXBhcmF0ZWQnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMuam9pbignLCAnKSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChpdGVtID0+IGl0ZW0udHJpbSgpKTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwucm93cyA9IDY7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5jb2xzID0gMjU7XG5cdFx0XHR9KVxuXHRcdGdsb2JhbGx5SWdub3JlZEZpZWxkc1NldHRpbmcuc2V0dGluZ0VsLmFkZENsYXNzKFwidnN0YWNrZWRcIik7XG5cdFx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzU2V0dGluZy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cdFx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzU2V0dGluZy5jb250cm9sRWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuXG5cdFx0LyogRXhjbHVkZSBGaWVsZHMgZnJvbSBjb250ZXh0IG1lbnUqL1xuXHRcdGNvbnN0IGVuYWJsZUF1dG9Db21wbGV0ZSA9IG5ldyBTZXR0aW5nKGdsb2JhbFNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoJ0F1dG9jb21wbGV0ZScpXG5cdFx0XHQuc2V0RGVzYygnQWN0aXZhdGUgYXV0b2NvbXBsZXRlIGZpZWxkcycpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaXNBdXRvc3VnZ2VzdEVuYWJsZWQpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuaXNBdXRvc3VnZ2VzdEVuYWJsZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0ZW5hYmxlQXV0b0NvbXBsZXRlLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblx0XHRlbmFibGVBdXRvQ29tcGxldGUuY29udHJvbEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcblxuXG5cdFx0LyogbGlzdHMgZGlzcGxheSBpbiBmcm9udG1hdHRlciovXG5cdFx0Y29uc3QgZnJvbnRtYXR0ZXJMaXN0RGlzcGxheSA9IG5ldyBTZXR0aW5nKGdsb2JhbFNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoJ0Zyb250bWF0dGVyIGxpc3QgZGlzcGxheScpXG5cdFx0XHQuc2V0RGVzYygnQ2hvb3NlIHdldGhlciBsaXN0cyBzaG91bGQgYmUgZGlzcGxheWVkIGFzIGFycmF5cyBvciBpbmRlbnRlZCBsaXN0cyBpbiBmcm9udG1hdHRlcicpXG5cdFx0XHQuYWRkRHJvcGRvd24oKGNiOiBEcm9wZG93bkNvbXBvbmVudCkgPT4ge1xuXHRcdFx0XHRbW1wiQXJyYXlcIiwgXCJhc0FycmF5XCJdLCBbXCJJbmRlbnRlZCBMaXN0XCIsIFwiYXNMaXN0XCJdXS5mb3JFYWNoKChbZGlzcGxheSwgdmFsdWVdOiBbc3RyaW5nLCBNdWx0aURpc3BsYXlUeXBlXSkgPT4ge1xuXHRcdFx0XHRcdGNiLmFkZE9wdGlvbih2YWx1ZSwgZGlzcGxheSlcblx0XHRcdFx0fSlcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheSB8fCBNdWx0aURpc3BsYXlUeXBlLmFzQXJyYXkpXG5cdFx0XHRcdGNiLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogTXVsdGlEaXNwbGF5VHlwZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZyb250bWF0dGVyTGlzdERpc3BsYXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHRmcm9udG1hdHRlckxpc3REaXNwbGF5LnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblx0XHRmcm9udG1hdHRlckxpc3REaXNwbGF5LmNvbnRyb2xFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG5cblx0XHQvKiBGaXJzdCBkYXkgb2Ygd2VlayAoZm9yIERhdGUgRmllbGRzKi9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdGaXJzdCBkYXkgb2Ygd2VlaycpXG5cdFx0XHQuc2V0RGVzYygnRm9yIGRhdGUgZmllbGRzLCB3aGljaCBkYXkgdGhlIGRhdGUgcGlja2VyXFwncyB3ZWVrIHNob3VsZCBzdGFydCB3aXRoJylcblx0XHRcdC5hZGREcm9wZG93bigoY2I6IERyb3Bkb3duQ29tcG9uZW50KSA9PiB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgMjsgaSsrKSB7XG5cdFx0XHRcdFx0Y2IuYWRkT3B0aW9uKGkudG9TdHJpbmcoKSwgbW9tZW50KCkuZGF5KGkpLmZvcm1hdChcImRkZGRcIikpXG5cdFx0XHRcdH1cblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlyc3REYXlPZldlZWsudG9TdHJpbmcoKSB8fCBcIjFcIilcblx0XHRcdFx0Y2Iub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlyc3REYXlPZldlZWsgPSBwYXJzZUludCh2YWx1ZSk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNYW5hZ2luZyBwcmVkZWZpbmVkIG9wdGlvbnMgZm9yIHByb3BlcnRpZXMgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIEFkZCBuZXcgcHJvcGVydHkgZm9yIHdoaWNoIHdlIHdhbnQgdG8gcHJlc2V0IG9wdGlvbnMqL1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJzZXR0aW5nLWRpdmlkZXJcIiB9KVxuXHRcdGNvbnN0IHByZXNldEZpZWxkc1NldHRpbmdzID0gdGhpcy5jcmVhdGVTZXR0aW5nR3JvdXAoXG5cdFx0XHQnUHJlc2V0IEZpZWxkcyBzZXR0aW5ncycsXG5cdFx0XHRcIk1hbmFnZSBnbG9iYWxseSBwcmVkZWZpbmVkIHR5cGUgYW5kIG9wdGlvbnMgZm9yIGEgZmllbGQgdGhyb3VnaG91dCB5b3VyIHdob2xlIHZhdWx0XCIsXG5cdFx0XHR0cnVlXG5cdFx0KVxuXHRcdG5ldyBTZXR0aW5nKHByZXNldEZpZWxkc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJBZGQgTmV3IEZpZWxkIFNldHRpbmdcIilcblx0XHRcdC5zZXREZXNjKFwiQWRkIGEgbmV3IEZyb250bWF0dGVyIHByb3BlcnR5IGZvciB3aGljaCB5b3Ugd2FudCBwcmVzZXQgb3B0aW9ucy5cIilcblx0XHRcdC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcblx0XHRcdFx0cmV0dXJuIGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRUb29sdGlwKFwiQWRkIE5ldyBQcm9wZXJ0eSBNYW5hZ2VyXCIpXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCJBZGQgbmV3XCIpXG5cdFx0XHRcdFx0LnNldEN0YSgpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IG1vZGFsID0gbmV3IEZpZWxkU2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgcHJlc2V0RmllbGRzU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0LyogTWFuYWdlZCBwcm9wZXJ0aWVzIHRoYXQgY3VycmVudGx5IGhhdmUgcHJlc2V0IG9wdGlvbnMgKi9cblx0XHR0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5mb3JFYWNoKHByb3AgPT4ge1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBuZXcgRmllbGQoKTtcblx0XHRcdE9iamVjdC5hc3NpZ24ocHJvcGVydHksIHByb3ApO1xuXHRcdFx0bmV3IEZpZWxkU2V0dGluZyhwcmVzZXRGaWVsZHNTZXR0aW5ncywgcHJvcGVydHksIHRoaXMucGx1Z2luKTtcblx0XHR9KTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgZmlsZUNsYXNzIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ki9cblxuXHRcdC8qIFNldCBjbGFzc0ZpbGVzIFBhdGgqL1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJzZXR0aW5nLWRpdmlkZXJcIiB9KTtcblx0XHRjb25zdCBjbGFzc0ZpbGVzU2V0dGluZ3MgPSB0aGlzLmNyZWF0ZVNldHRpbmdHcm91cChcblx0XHRcdCdGaWxlQ2xhc3Mgc2V0dGluZ3MnLFxuXHRcdFx0XCJNYW5hZ2UgZmlsZUNsYXNzIGZvbGRlciBhbmQgYWxpYXMuIFwiICtcblx0XHRcdFwiV2hlbiBhIG5vdGUgaGFzIGEgZmlsZUNsYXNzIGRlZmluZWQsIGZpbGVDbGFzcyBmaWVsZCBwcm9wZXJ0aWVzIHdpbGwgb3ZlcnJpZGUgXCIgK1xuXHRcdFx0XCJnbG9iYWwgcHJlc2V0IGZpZWxkcyBzZXR0aW5ncyBmb3IgdGhlIHNhbWUgZmllbGQgbmFtZVwiLFxuXHRcdFx0dHJ1ZVxuXHRcdClcblxuXHRcdGNvbnN0IHBhdGggPSBuZXcgU2V0dGluZyhjbGFzc0ZpbGVzU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnY2xhc3MgRmlsZXMgcGF0aCcpXG5cdFx0XHQuc2V0RGVzYygnUGF0aCB0byB0aGUgZmlsZXMgY29udGFpbmluZyB0aGUgYXV0aG9yaXplZCBmaWVsZHMgZm9yIGEgdHlwZSBvZiBub3RlJylcblx0XHRcdC5hZGRTZWFyY2goKGNmcykgPT4ge1xuXHRcdFx0XHRuZXcgRm9sZGVyU3VnZ2VzdCh0aGlzLnBsdWdpbiwgY2ZzLmlucHV0RWwpO1xuXHRcdFx0XHRjZnMuc2V0UGxhY2Vob2xkZXIoXCJGb2xkZXJcIilcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGggfHwgXCJcIilcblx0XHRcdFx0XHQub25DaGFuZ2UoKG5ld19mb2xkZXIpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IG5ld1BhdGggPSBuZXdfZm9sZGVyLmVuZHNXaXRoKFwiL1wiKSB8fCAhbmV3X2ZvbGRlciA/IG5ld19mb2xkZXIgOiBuZXdfZm9sZGVyICsgXCIvXCI7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCA9IG5ld1BhdGggfHwgbnVsbDtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0cGF0aC5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cdFx0cGF0aC5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuYXJyb3ctdGl0bGVcIik7XG5cdFx0cGF0aC5jb250cm9sRWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuXG5cdFx0Y29uc3QgYWxpYXMgPSBuZXcgU2V0dGluZyhjbGFzc0ZpbGVzU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnZmlsZUNsYXNzIGZpZWxkIGFsaWFzJylcblx0XHRcdC5zZXREZXNjKCdDaG9vc2UgYW5vdGhlciBuYW1lIGZvciBmaWxlQ2xhc3MgZmllbGQgaW4gZnJvbnRtYXR0ZXIgKGV4YW1wbGU6IENhdGVnb3J5LCB0eXBlLCAuLi4nKVxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcblx0XHRcdFx0dGV4dFxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcyA9IHZhbHVlIHx8IFwiZmlsZUNsYXNzXCI7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pXG5cdFx0YWxpYXMuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXHRcdGFsaWFzLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5hcnJvdy10aXRsZVwiKTtcblx0XHRhbGlhcy5jb250cm9sRWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuXG5cdFx0LyogXG5cblx0XHQvKiBTZXQgZ2xvYmFsIGZpbGVDbGFzcyovXG5cdFx0Y29uc3QgZ2xvYmFsID0gbmV3IFNldHRpbmcoY2xhc3NGaWxlc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoJ2dsb2JhbCBmaWxlQ2xhc3MnKVxuXHRcdFx0LnNldERlc2MoJ0Nob29zZSBvbmUgZmlsZUNsYXNzIHRvIGJlIGFwcGxpY2FibGUgdG8gYWxsIGZpbGVzICcgK1xuXHRcdFx0XHQnKGV2ZW4gaXQgaXMgbm90IHByZXNlbnQgYXMgYSBmaWxlQ2xhc3MgYXR0cmlidXRlIGluIHRoZWlyIGZyb250bWF0dGVyKS4gJyArXG5cdFx0XHRcdCdUaGlzIHdpbGwgb3ZlcnJpZGUgdGhlIHByZXNldCBGaWVsZHMgZGVmaW5lZCBhYm92ZScpXG5cdFx0XHQuYWRkU2VhcmNoKChjZnMpID0+IHtcblx0XHRcdFx0bmV3IEZpbGVTdWdnZXN0KFxuXHRcdFx0XHRcdGNmcy5pbnB1dEVsLFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoIHx8IFwiXCJcblx0XHRcdFx0KTtcblx0XHRcdFx0Y2ZzLnNldFBsYWNlaG9sZGVyKFwiR2xvYmFsIGZpbGVDbGFzc1wiKVxuXHRcdFx0XHRjZnMuc2V0VmFsdWUoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzID9cblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoICsgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzICsgXCIubWRcIiA6XG5cdFx0XHRcdFx0XHRcIlwiXG5cdFx0XHRcdClcblx0XHRcdFx0XHQub25DaGFuZ2UoKG5ld1BhdGgpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyA9IG5ld1BhdGggP1xuXHRcdFx0XHRcdFx0XHRuZXdQYXRoLnNwbGl0KCdcXFxcJykucG9wKCkhLnNwbGl0KCcvJykucG9wKCk/LnJlcGxhY2UoXCIubWRcIiwgXCJcIikgOlxuXHRcdFx0XHRcdFx0XHRcIlwiO1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KVxuXHRcdGdsb2JhbC5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cdFx0Z2xvYmFsLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5hcnJvdy10aXRsZVwiKTtcblx0XHRnbG9iYWwuY29udHJvbEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgZXh0cmEgYnV0dG9uIGRpc3BsYXkgb3B0aW9uc1xuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ki9cblx0XHRjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic2V0dGluZy1kaXZpZGVyXCIgfSk7XG5cdFx0Y29uc3QgbWV0YWRhdGFNZW51QnRuU2V0dGluZ3MgPSB0aGlzLmNyZWF0ZVNldHRpbmdHcm91cChcblx0XHRcdCdNZXRhZGF0YSBNZW51IGJ1dHRvbicsXG5cdFx0XHQnU2hvdyBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgbW9kYWwgb2YgZmllbGRzJyxcblx0XHRcdHRydWUpXG5cblx0XHRuZXcgU2V0dGluZyhtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiTWV0YWRhdGEgTWVudSBidXR0b24gaWNvblwiKVxuXHRcdFx0LnNldERlc2MoXCJuYW1lIG9mIHRoZSBkZWZhdWx0IGljb24gd2hlbiBub3QgZGVmaW5lZCBpbiBmaWxlQ2xhc3NcIilcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYnV0dG9uSWNvbilcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5idXR0b25JY29uID0gdmFsdWUgfHwgXCJjbGlwYm9hcmQtbGlzdFwiO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KS5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cblx0XHRuZXcgU2V0dGluZyhtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiUmVhZGluZyBtb2RlIGxpbmtzXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgYW4gZXh0cmEgYnV0dG9uIHRvIGFjY2VzcyBtZXRhZGF0YSBtZW51IGZvcm0gYWZ0ZXIgYSBsaW5rIGluIHJlYWRpbmcgbW9kZVwiKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpbmtzKTtcblx0XHRcdFx0Y2Iub25DaGFuZ2UodmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpbmtzID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KS5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cblx0XHRuZXcgU2V0dGluZyhtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiTGl2ZSBwcmV2aWV3IG1vZGVcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBhZnRlciBhIGxpbmsgaW4gbGl2ZSBwcmV2aWV3XCIpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRWRpdG9yKTtcblx0XHRcdFx0Y2Iub25DaGFuZ2UodmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUVkaXRvciA9IHZhbHVlO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIlRhYiBoZWFkZXJcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBpbiB0aGUgdGFiIGhlYWRlclwiKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVRhYkhlYWRlcik7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVUYWJIZWFkZXIgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblxuXHRcdG5ldyBTZXR0aW5nKG1ldGFkYXRhTWVudUJ0blNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJCYWNrbGlua3NcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBpbiB0aGUgYmFja2xpbmtzIHBhbmVsXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlQmFja2xpbmtzKTtcblx0XHRcdFx0Y2Iub25DaGFuZ2UodmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUJhY2tsaW5rcyA9IHZhbHVlO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIlNlYXJjaFwiKVxuXHRcdFx0LnNldERlc2MoXCJEaXNwbGF5IGFuIGV4dHJhIGJ1dHRvbiB0byBhY2Nlc3MgbWV0YWRhdGEgbWVudSBmb3JtIGluIHRoZSBzZWFyY2ggcGFuZWxcIilcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xuXHRcdFx0XHRjYi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTZWFyY2gpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlU2VhcmNoID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KS5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cblx0XHRuZXcgU2V0dGluZyhtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiRmlsZSBleHBsb3JlclwiKVxuXHRcdFx0LnNldERlc2MoXCJEaXNwbGF5IGFuIGV4dHJhIGJ1dHRvbiB0byBhY2Nlc3MgbWV0YWRhdGEgbWVudSBmb3JtIGluIHRoZSBmaWxlIGV4cGxvcmVyXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRmlsZUV4cGxvcmVyKTtcblx0XHRcdFx0Y2Iub25DaGFuZ2UodmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZpbGVFeHBsb3JlciA9IHZhbHVlO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIlN0YXJyZWRcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBpbiB0aGUgc3RhcnJlZCBwYW5lbFwiKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVN0YXJyZWQpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlU3RhcnJlZCA9IHZhbHVlO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNYW5hZ2luZyBwcmVkZWZpbmVkIGZpbGVDbGFzcyBmb3IgcXVlcnkncyBtYXRjaGluZyBmaWxlcyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0LyogQWRkIG5ldyBxdWVyeSBmb3Igd2hpY2ggbWF0Y2hpbmcgZmlsZXMgd2lsbCBiZSBhcHBsaWVkIHRoZSBmaWxlQ2xhc3MqL1xuXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInNldHRpbmctZGl2aWRlclwiIH0pO1xuXHRcdGNvbnN0IHF1ZXJ5RmlsZUNsYXNzU2V0dGluZ3MgPSB0aGlzLmNyZWF0ZVNldHRpbmdHcm91cChcblx0XHRcdCdRdWVyeSBiYXNlZCBGaWxlQ2xhc3Mgc2V0dGluZ3MnLFxuXHRcdFx0XCJNYW5hZ2UgZ2xvYmFsbHkgcHJlZGVmaW5lZCB0eXBlIGFuZCBvcHRpb25zIGZvciBhIGZpZWxkIG1hdGNoaW5nIHRoaXMgcXVlcnlcIixcblx0XHRcdHRydWVcblx0XHQpXG5cdFx0bmV3IFNldHRpbmcocXVlcnlGaWxlQ2xhc3NTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiQWRkIE5ldyBRdWVyeSBmb3IgZmlsZUNsYXNzXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkFkZCBhIG5ldyBxdWVyeSBhbmQgYSBGaWxlQ2xhc3MgdGhhdCB3aWxsIGFwcGx5IHRvIGZpbGVzIG1hdGNoaW5nIHRoaXMgcXVlcnkuXCIpXG5cdFx0XHQuYWRkQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG5cdFx0XHRcdHJldHVybiBidXR0b25cblx0XHRcdFx0XHQuc2V0VG9vbHRpcChcIkFkZCBOZXcgZmlsZUNsYXNzIHF1ZXJ5XCIpXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCJBZGQgbmV3XCIpXG5cdFx0XHRcdFx0LnNldEN0YSgpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IG1vZGFsID0gbmV3IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgcXVlcnlGaWxlQ2xhc3NTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KS5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cblx0XHQvKiBNYW5hZ2VkIHByb3BlcnRpZXMgdGhhdCBjdXJyZW50bHkgaGF2ZSBwcmVzZXQgb3B0aW9ucyAqL1xuXHRcdHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzXG5cdFx0XHQuZm9yRWFjaChxdWVyeSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbGVDbGFzc1F1ZXJ5ID0gbmV3IEZpbGVDbGFzc1F1ZXJ5KCk7XG5cdFx0XHRcdE9iamVjdC5hc3NpZ24oZmlsZUNsYXNzUXVlcnksIHF1ZXJ5KTtcblx0XHRcdFx0bmV3IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZyhxdWVyeUZpbGVDbGFzc1NldHRpbmdzLCBmaWxlQ2xhc3NRdWVyeSwgdGhpcy5wbHVnaW4pO1xuXHRcdFx0fSk7XG5cdH07XG59O1xuIiwgIi8vIENyZWRpdHMgZ28gdG8gTGlhbSdzIFBlcmlvZGljIE5vdGVzIFBsdWdpbjogaHR0cHM6Ly9naXRodWIuY29tL2xpYW1jYWluL29ic2lkaWFuLXBlcmlvZGljLW5vdGVzXG5cbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRBYnN0cmFjdEZpbGUsIFRGb2xkZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRleHRJbnB1dFN1Z2dlc3QgfSBmcm9tIFwiLi9zdWdnZXN0XCI7XG5cbmV4cG9ydCBjbGFzcyBGb2xkZXJTdWdnZXN0IGV4dGVuZHMgVGV4dElucHV0U3VnZ2VzdDxURm9sZGVyPiB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHVibGljIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50XG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGlucHV0RWwpO1xuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKGlucHV0U3RyOiBzdHJpbmcpOiBURm9sZGVyW10ge1xuICAgICAgICBjb25zdCBhYnN0cmFjdEZpbGVzID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFsbExvYWRlZEZpbGVzKCk7XG4gICAgICAgIGNvbnN0IGZvbGRlcnM6IFRGb2xkZXJbXSA9IFtdO1xuICAgICAgICBjb25zdCBsb3dlckNhc2VJbnB1dFN0ciA9IGlucHV0U3RyLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgYWJzdHJhY3RGaWxlcy5mb3JFYWNoKChmb2xkZXI6IFRBYnN0cmFjdEZpbGUpID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyICYmXG4gICAgICAgICAgICAgICAgZm9sZGVyLnBhdGgudG9Mb3dlckNhc2UoKS5jb250YWlucyhsb3dlckNhc2VJbnB1dFN0cilcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGZvbGRlcnMucHVzaChmb2xkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9sZGVycztcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGb2xkZXIsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5zZXRUZXh0KGZpbGUucGF0aCk7XG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihmaWxlOiBURm9sZGVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaW5wdXRFbC52YWx1ZSA9IGZpbGUucGF0aDtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnRyaWdnZXIoXCJpbnB1dFwiKTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgTW9kYWwsIFNldHRpbmcsIFRleHRBcmVhQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZyBmcm9tIFwiLi9GaWxlQ2xhc3NRdWVyeVNldHRpbmdcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZUNsYXNzUXVlcnlTZXR0aW5nc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgc2F2ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGZpbGVDbGFzc1F1ZXJ5OiBGaWxlQ2xhc3NRdWVyeTtcbiAgICBwcml2YXRlIGluaXRpYWxGaWxlQ2xhc3NRdWVyeTogRmlsZUNsYXNzUXVlcnk7XG4gICAgcHJpdmF0ZSBuZXc6IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgcGFyZW50U2V0dGluZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcGFyZW50U2V0dGluZz86IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZyxcbiAgICAgICAgZmlsZUNsYXNzUXVlcnk/OiBGaWxlQ2xhc3NRdWVyeVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcnkgPSBuZXcgRmlsZUNsYXNzUXVlcnkoKTtcbiAgICAgICAgaWYgKGZpbGVDbGFzc1F1ZXJ5KSB7XG4gICAgICAgICAgICB0aGlzLm5ldyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NRdWVyeSA9IGZpbGVDbGFzc1F1ZXJ5O1xuICAgICAgICAgICAgRmlsZUNsYXNzUXVlcnkuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IG5ld0lkID0gMTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHByb3AuaWQpICYmIHBhcnNlSW50KHByb3AuaWQpID49IG5ld0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0lkID0gcGFyc2VJbnQocHJvcC5pZCkgKyAxO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkgPSBuZXcgRmlsZUNsYXNzUXVlcnkoKTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkuaWQgPSBuZXdJZC50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcnkuaWQgPSBuZXdJZC50b1N0cmluZygpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKTtcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lID09IFwiXCIpIHtcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgYSBmaWxlQ2xhc3MgYW5kIGFkZCBhbiBhcHBsaWNhYmxlIHF1ZXJ5YCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlICR7dGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lfSBzZXR0aW5nc2ApO1xuICAgICAgICB9O1xuICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUZvcm0oKTtcbiAgICB9O1xuXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgIGlmICghdGhpcy5uZXcgJiYgdGhpcy5wYXJlbnRTZXR0aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmcuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zYXZlZCkge1xuICAgICAgICAgICAgbmV3IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZyh0aGlzLnBhcmVudFNldHRpbmdDb250YWluZXIsIHRoaXMuZmlsZUNsYXNzUXVlcnksIHRoaXMucGx1Z2luKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVuYW1lSW5wdXRDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IFRleHRDb21wb25lbnQge1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbGFiZWwnLCB0ZXh0OiBgRmlsZUNsYXNzIFF1ZXJ5IE5hbWU6YCB9KTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgaW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmZpbGVDbGFzc1F1ZXJ5Lm5hbWU7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKG5hbWUpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIk5hbWUgb2YgdGhpcyBmaWxlQ2xhc3MgcXVlcnlcIik7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkubmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYE1hbmFnZSBvcHRpb25zIGZvciAke3RoaXMuZmlsZUNsYXNzUXVlcnkubmFtZX1gKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWxlQ2xhc3NTZWxlY3RvckNvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibGFiZWxcIiwgdGV4dDogYEZpbGVjbGFzczpgIH0pO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnc3BhY2VyJyB9KTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzZXMgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHRcbiAgICAgICAgICAgIC5nZXRGaWxlcygpXG4gICAgICAgICAgICAuZmlsdGVyKGYgPT4gY2xhc3NGaWxlc1BhdGggJiYgZi5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKVxuICAgICAgICAgICAgLnJldmVyc2UoKTtcbiAgICAgICAgc2VsZWN0LmFkZE9wdGlvbihcIi0tU2VsZWN0IGEgZmlsZUNsYXNzLS1cIiwgXCItLVNlbGVjdCBhIGZpbGVDbGFzcy0tXCIpXG4gICAgICAgIGZpbGVDbGFzc2VzLmZvckVhY2goZmlsZUNsYXNzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzTmFtZUZyb21QYXRoKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MucGF0aCk7XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzTmFtZSkgc2VsZWN0LmFkZE9wdGlvbihmaWxlQ2xhc3NOYW1lLCBmaWxlQ2xhc3NOYW1lKTtcbiAgICAgICAgfSlcbiAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzUXVlcnkuZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgc2VsZWN0LnNldFZhbHVlKHRoaXMuZmlsZUNsYXNzUXVlcnkuZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPSBcIi0tU2VsZWN0IGEgZmlsZUNsYXNzLS1cIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkuZmlsZUNsYXNzTmFtZSA9IHZhbHVlXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkuZmlsZUNsYXNzTmFtZSA9IFwiXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVF1ZXJ5SW5wdXRDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJkYXRhdmlld0pTIHF1ZXJ5OlwiIH0pO1xuICAgICAgICBjb25zdCBxdWVyeVN0cmluZ0lucHV0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICBjb25zdCBxdWVyeVN0cmluZ0lucHV0ID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHF1ZXJ5U3RyaW5nSW5wdXRDb250YWluZXIpO1xuICAgICAgICBxdWVyeVN0cmluZ0lucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBxdWVyeVN0cmluZ0lucHV0LmlucHV0RWwucm93cyA9IDRcbiAgICAgICAgcXVlcnlTdHJpbmdJbnB1dC5zZXRWYWx1ZSh0aGlzLmZpbGVDbGFzc1F1ZXJ5LnF1ZXJ5KTtcbiAgICAgICAgcXVlcnlTdHJpbmdJbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB0aGlzLmZpbGVDbGFzc1F1ZXJ5LnF1ZXJ5ID0gdmFsdWUpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBjcmVhdGVGb3JtKCk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIC8qIFNlY3Rpb25zICovXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlbmFtZUlucHV0Q29udGFpbmVyKG5hbWVDb250YWluZXIpO1xuXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1NlbGVjdENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVGaWxlQ2xhc3NTZWxlY3RvckNvbnRhaW5lcihmaWxlQ2xhc3NTZWxlY3RDb250YWluZXIpXG5cbiAgICAgICAgY29uc3QgZmlsZUNsYXNzUXVlcnlDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVRdWVyeUlucHV0Q29udGFpbmVyKGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyKTtcblxuICAgICAgICAvKiBmb290ZXIgYnV0dG9ucyovXG4gICAgICAgIGNvbnN0IGZvb3RlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmb290ZXItYWN0aW9uc1wiIH0pO1xuICAgICAgICBmb290ZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIHRoaXMuY3JlYXRlU2F2ZUJ1dHRvbihmb290ZXIpO1xuICAgICAgICB0aGlzLmNyZWF0ZUNhbmNlbEJ1dHRvbihmb290ZXIpO1xuXG4gICAgICAgIC8qIGluaXQgc3RhdGUgKi9cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVTYXZlQnV0dG9uKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKVxuICAgICAgICBiLnNldFRvb2x0aXAoXCJTYXZlXCIpO1xuICAgICAgICBiLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIGIub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5maWxlQ2xhc3NRdWVyeS5maWxlQ2xhc3NOYW1lICYmIHRoaXMuZmlsZUNsYXNzUXVlcnkubmFtZSAmJiB0aGlzLmZpbGVDbGFzc1F1ZXJ5LnF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nRmlsZUNsYXNzUXVlcnkgPSB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllc1xuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKHAgPT4gcC5pZCA9PSB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmlkKVswXTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nRmlsZUNsYXNzUXVlcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgRmlsZUNsYXNzUXVlcnkuY29weVByb3BlcnR5KGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5wdXNoKHRoaXMuZmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgRmlsZUNsYXNzUXVlcnkuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudFNldHRpbmcpIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eSh0aGlzLnBhcmVudFNldHRpbmcuZmlsZUNsYXNzUXVlcnksIHRoaXMuZmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50U2V0dGluZz8uc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVDYW5jZWxCdXR0b24oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBiID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpXG4gICAgICAgIGIuc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgICAgICAuc2V0VG9vbHRpcChcIkNhbmNlbFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvKiByZXNldCBvcHRpb25zIGZyb20gc2V0dGluZ3MgKi9cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcnkubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWxlQ2xhc3NRdWVyeSwgdGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcbn07IiwgImltcG9ydCB7IFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCBmcm9tIFwiLi9GaWxlQ2xhc3NRdWVyeVNldHRpbmdNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NRdWVyeVNldHRpbmcgZXh0ZW5kcyBTZXR0aW5nIHtcbiAgICBwdWJsaWMgZmlsZUNsYXNzUXVlcnk6IEZpbGVDbGFzc1F1ZXJ5O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBwcm9wZXJ0eTogRmlsZUNsYXNzUXVlcnksXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbiAgICApIHtcbiAgICAgICAgc3VwZXIoY29udGFpbmVyRWwpO1xuICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5ID0gcHJvcGVydHk7XG4gICAgICAgIHRoaXMuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpO1xuICAgICAgICB0aGlzLmFkZEVkaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGRNb3ZlVXBCdXR0b24oKTtcbiAgICAgICAgdGhpcy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIilcbiAgICB9O1xuXG4gICAgcHVibGljIHNldFRleHRDb250ZW50V2l0aG5hbWUoKTogdm9pZCB7XG5cbiAgICAgICAgdGhpcy5pbmZvRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICB0aGlzLmluZm9FbC5hZGRDbGFzcyhcInNldHRpbmctaXRlbVwiKVxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NRdWVyeUNvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZURpdigpO1xuXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSBmaWxlQ2xhc3NRdWVyeUNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCBcIm5hbWVcIilcbiAgICAgICAgbmFtZUNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke3RoaXMuZmlsZUNsYXNzUXVlcnkubmFtZX08L3N0cm9uZz5gXG5cbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZUNvbnRhaW5lciA9IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXIuaW5uZXJIVE1MID0gYDxzcGFuPkZpbGVDbGFzczwvc3Bhbj4gOiAke3RoaXMuZmlsZUNsYXNzUXVlcnkuZmlsZUNsYXNzTmFtZX1gXG5cbiAgICAgICAgY29uc3QgcXVlcnlDb250YWluZXIgPSBmaWxlQ2xhc3NRdWVyeUNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiKVxuICAgICAgICBxdWVyeUNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHNwYW4+UXVlcnk8L3NwYW4+IDogJHt0aGlzLmZpbGVDbGFzc1F1ZXJ5LnF1ZXJ5fWBcblxuICAgIH07XG5cbiAgICBwcml2YXRlIGFkZEVkaXRCdXR0b24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJwZW5jaWxcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkVkaXRcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NRdWVyeVNldHRpbmdzTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuY29udGFpbmVyRWwsIHRoaXMsIHRoaXMuZmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFkZERlbGV0ZUJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJEZWxldGVcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5ID0gdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMuZmluZChwID0+IHAuaWQgPT0gdGhpcy5maWxlQ2xhc3NRdWVyeS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMucmVtb3ZlKGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5nRWwucGFyZW50RWxlbWVudD8ucmVtb3ZlQ2hpbGQodGhpcy5zZXR0aW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkTW92ZVVwQnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwidXAtY2hldnJvbi1nbHlwaFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiTW92ZSB1cCAobG93ZXIgcHJpb3JpdHkpXCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmlsZUNsYXNzUXVlcnlJbmRleCA9IHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLm1hcChmY3EgPT4gZmNxLmlkKS5pbmRleE9mKHRoaXMuZmlsZUNsYXNzUXVlcnkuaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEZpbGVDbGFzc1F1ZXJ5SW5kZXggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmluc2VydEJlZm9yZSh0aGlzLnNldHRpbmdFbCwgdGhpcy5zZXR0aW5nRWwucHJldmlvdXNFbGVtZW50U2libGluZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5zcGxpY2UoY3VycmVudEZpbGVDbGFzc1F1ZXJ5SW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMuc3BsaWNlKGN1cnJlbnRGaWxlQ2xhc3NRdWVyeUluZGV4IC0gMSwgMCwgdGhpcy5maWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL2ZpZWxkcy9GaWVsZFwiXG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIlxuaW1wb3J0ICogYXMgc2VsZWN0VmFsdWVzU291cmNlIGZyb20gXCIuLi90eXBlcy9zZWxlY3RWYWx1ZXNTb3VyY2VUeXBlc1wiXG5cbmludGVyZmFjZSBWMUZpZWxkIGV4dGVuZHMgRmllbGQge1xuICAgIGlzTXVsdGk/OiBib29sZWFuLFxuICAgIGlzQ3ljbGU/OiBib29sZWFuLFxuICAgIGlzQm9vbGVhbj86IGJvb2xlYW4sXG4gICAgdmFsdWVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxufVxuXG5pbnRlcmZhY2UgVjJGaWVsZCBleHRlbmRzIEZpZWxkIHtcbiAgICB2YWx1ZXNMaXN0Tm90ZVBhdGg/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGNvbnN0IG1pZ3JhdGVTZXR0aW5nc1YxdG9WMiA9IGFzeW5jIChwbHVnaW46IE1ldGFkYXRhTWVudSkgPT4ge1xuICAgIGNvbnN0IHByZXNldEZpZWxkcyA9IHBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHNcbiAgICBwcmVzZXRGaWVsZHMuZm9yRWFjaCgocDogVjFGaWVsZCkgPT4ge1xuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKHApLmNvbnRhaW5zKFwidHlwZVwiKSkge1xuICAgICAgICAgICAgaWYgKHAuaXNNdWx0aSkgcC50eXBlID0gRmllbGRUeXBlLk11bHRpXG4gICAgICAgICAgICBlbHNlIGlmIChwLmlzQ3ljbGUpIHAudHlwZSA9IEZpZWxkVHlwZS5DeWNsZVxuICAgICAgICAgICAgZWxzZSBpZiAocC5pc0Jvb2xlYW4pIHAudHlwZSA9IEZpZWxkVHlwZS5Cb29sZWFuXG4gICAgICAgICAgICBlbHNlIGlmIChwLm9wdGlvbnMgJiYgT2JqZWN0LmtleXMocC5vcHRpb25zKS5sZW5ndGggPiAwKSBwLnR5cGUgPSBGaWVsZFR5cGUuU2VsZWN0XG4gICAgICAgICAgICBlbHNlIHAudHlwZSA9IEZpZWxkVHlwZS5JbnB1dFxuICAgICAgICB9XG4gICAgICAgIC8vZXJhc2UgaXNNdWx0aSwgaXNDeWNsZSwgaXNCb29sZWFuIGlmIGV4aXN0c1xuICAgICAgICBkZWxldGUgcC5pc011bHRpO1xuICAgICAgICBkZWxldGUgcC5pc0N5Y2xlO1xuICAgICAgICBkZWxldGUgcC5pc0Jvb2xlYW5cbiAgICAgICAgLy9yZW5hbWUgXCJ2YWx1ZXNcIiBpbiBcIm9wdGlvblwiXG4gICAgICAgIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHAsIFwidmFsdWVzXCIpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwLCBcIm9wdGlvbnNcIixcbiAgICAgICAgICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHAsIFwidmFsdWVzXCIpISk7XG4gICAgICAgICAgICBkZWxldGUgcFtcInZhbHVlc1wiXTtcbiAgICAgICAgfVxuICAgIH0pXG4gICAgcGx1Z2luLnNldHRpbmdzLnNldHRpbmdzVmVyc2lvbiA9IDJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEocGx1Z2luLnNldHRpbmdzKVxuICAgIGNvbnNvbGUubG9nKFwiTWV0YWRhdGEgbWVudSBzZXR0aW5ncyBtaWdyYXRlZCB0byB2ZXJzaW9uIDJcIilcbn1cblxuZXhwb3J0IGNvbnN0IG1pZ3JhdGVTZXR0aW5nc1YydG9WMyA9IGFzeW5jIChwbHVnaW46IE1ldGFkYXRhTWVudSkgPT4ge1xuICAgIGNvbnN0IHByZXNldEZpZWxkcyA9IHBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHNcbiAgICBwcmVzZXRGaWVsZHMuZm9yRWFjaCgocDogVjJGaWVsZCkgPT4ge1xuICAgICAgICBpZiAoW0ZpZWxkVHlwZS5TZWxlY3QsIEZpZWxkVHlwZS5NdWx0aV0uaW5jbHVkZXMocC50eXBlKSkge1xuICAgICAgICAgICAgLy9TdGVwMDogbW9kaWZ5IG9wdGlvbnMgZm9yIFNlbGVjdCBhbmQgTXVsdGlTZWxlY3RcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRPcHRpb25LZXlzID0gT2JqZWN0LmtleXMocC5vcHRpb25zKTtcbiAgICAgICAgICAgIHAub3B0aW9ucy52YWx1ZXNMaXN0ID0ge31cbiAgICAgICAgICAgIGN1cnJlbnRPcHRpb25LZXlzLmZvckVhY2goa2V5ID0+IHAub3B0aW9ucy52YWx1ZXNMaXN0W2tleV0gPSBwLm9wdGlvbnNba2V5XSlcbiAgICAgICAgICAgIC8vU3RlcDE6IHNldCB0aGUgdmFsdWVzU291cmNlVHlwZVxuICAgICAgICAgICAgaWYgKHAudmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0VHlwZSA9IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aDtcbiAgICAgICAgICAgICAgICBwLm9wdGlvbnMuc291cmNlVHlwZSA9IHNlbGVjdFR5cGU7XG4gICAgICAgICAgICAgICAgcC5vcHRpb25zW3NlbGVjdFZhbHVlc1NvdXJjZS5LZXlbc2VsZWN0VHlwZV1dO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwLm9wdGlvbnMuc291cmNlVHlwZSA9IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3RcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vU3RlcDI6IG1vdmUgdmFsdWVzTGlzdE5vdGVQYXRoXG4gICAgICAgICAgICBwLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoID0gcC52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgIC8vU3RlcDM6IGRlbGV0ZSBsZWdhY3kgb3B0aW9uc1xuICAgICAgICAgICAgY3VycmVudE9wdGlvbktleXMuZm9yRWFjaChrZXkgPT4gZGVsZXRlIHAub3B0aW9uc1trZXldKVxuICAgICAgICAgICAgLy9TdGVwNDogcG9wdWxhdGUgdmFsdWVzRnJvbURWUXVlcnkgb3B0aW9uIHdpdGggZW1wdHkgc3RyaW5nXG4gICAgICAgICAgICBwLm9wdGlvbnMudmFsdWVzRnJvbURWUXVlcnkgPSBcIlwiXG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIHAudmFsdWVzTGlzdE5vdGVQYXRoXG4gICAgfSlcbiAgICBwbHVnaW4uc2V0dGluZ3Muc2V0dGluZ3NWZXJzaW9uID0gM1xuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShwbHVnaW4uc2V0dGluZ3MpXG4gICAgY29uc29sZS5sb2coXCJNZXRhZGF0YSBtZW51IHNldHRpbmdzIG1pZ3JhdGVkIHRvIHZlcnNpb24gM1wiKVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQge1xuICAgIEVkaXRvcixcbiAgICBFZGl0b3JQb3NpdGlvbixcbiAgICBFZGl0b3JTdWdnZXN0LFxuICAgIEVkaXRvclN1Z2dlc3RDb250ZXh0LFxuICAgIEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyxcbiAgICBNYXJrZG93blZpZXcsXG4gICAgVEZpbGUsXG4gICAgcGFyc2VZYW1sLFxuICAgIE5vdGljZSxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSwgTXVsdGlEaXNwbGF5VHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgZ2VuZXJpY0ZpZWxkUmVnZXgsIGdldExpbmVGaWVsZHMsIGVuY29kZUxpbmsgfSBmcm9tIFwiLi4vdXRpbHMvcGFyc2VyXCI7XG5pbXBvcnQgRmlsZUZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRmlsZUZpZWxkXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Fic3RyYWN0TGlzdEJhc2VkRmllbGRcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuXG5pbnRlcmZhY2UgSVZhbHVlQ29tcGxldGlvbiB7XG4gICAgYXR0cjogc3RyaW5nO1xuICAgIHZhbHVlOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgY29uc3QgbGlzdFByZWZpeCA9IFwiICAtIFwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZhbHVlU3VnZ2VzdCBleHRlbmRzIEVkaXRvclN1Z2dlc3Q8SVZhbHVlQ29tcGxldGlvbj4ge1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpbkZ1bGxMaW5lOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpblNlbnRlbmNlOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBkaWRTZWxlY3Q6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGZpZWxkPzogRmllbGQ7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuc2V0SW5zdHJ1Y3Rpb25zKFt7IGNvbW1hbmQ6IFwiU2hpZnRcIiwgcHVycG9zZTogXCJyZW1vdmUgc3BhY2UgYWZ0ZXI6OlwiIH1dKTtcblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW1wiU2hpZnRcIl0sIFwiRW50ZXJcIiwgKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy51c2VTZWxlY3RlZEl0ZW0oZXZ0KTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIGlzSW5Gcm9udG1hdHRlcihlZGl0b3I6IEVkaXRvciwgY3Vyc29yOiBFZGl0b3JQb3NpdGlvbik6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZnJvbnRtYXR0ZXJFbmQ6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZFxuICAgICAgICBpZiAoZWRpdG9yLmdldExpbmUoMCkgPT09IFwiLS0tXCIpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGVkaXRvci5sYXN0TGluZSgpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmdldExpbmUoaSkgPT09IFwiLS0tXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJFbmQgPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gISFmcm9udG1hdHRlckVuZCAmJiBjdXJzb3IubGluZSA8IGZyb250bWF0dGVyRW5kXG4gICAgfVxuXG4gICAgb25UcmlnZ2VyKFxuICAgICAgICBjdXJzb3I6IEVkaXRvclBvc2l0aW9uLFxuICAgICAgICBlZGl0b3I6IEVkaXRvcixcbiAgICAgICAgZmlsZTogVEZpbGVcbiAgICApOiBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8gfCBudWxsIHtcbiAgICAgICAgaWYgKHRoaXMuZGlkU2VsZWN0KSB7XG4gICAgICAgICAgICB0aGlzLmRpZFNlbGVjdCA9IGZhbHNlXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuaXNBdXRvc3VnZ2VzdEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoZmlsZT8uZXh0ZW5zaW9uICE9PSBcIm1kXCIpIHJldHVybiBudWxsXG4gICAgICAgIGNvbnN0IGZ1bGxMaW5lID0gZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpXG4gICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlciA9IHRoaXMuaXNJbkZyb250bWF0dGVyKGVkaXRvciwgY3Vyc29yKVxuICAgICAgICBpZiAodGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTooPzx2YWx1ZXM+LiopYCwgXCJ1XCIpO1xuICAgICAgICAgICAgaWYgKCFyZWdleC50ZXN0KGZ1bGxMaW5lKSAmJiAhZnVsbExpbmUuc3RhcnRzV2l0aChsaXN0UHJlZml4KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vbWFrZSBzdXJlIHdlIGhhdmUgYSBzcGFjZSBhZnRlciAnOidcbiAgICAgICAgICAgICAgICAvL2ZpbmQgZmllbGRcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VwYXJhdG9yUG9zID0gbGluZS5pbmRleE9mKFwiOlwiKVxuICAgICAgICAgICAgICAgIGlmICghW1wiXCIsIFwiIFwiXS5pbmNsdWRlcyhsaW5lLnNsaWNlKHNlcGFyYXRvclBvcyArIDEsIHNlcGFyYXRvclBvcyArIDIpKSkge1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKFwiIFwiLCB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogc2VwYXJhdG9yUG9zICsgMSB9LCB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogc2VwYXJhdG9yUG9zICsgMSB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSBpZiAoZ2V0TGluZUZpZWxkcyhmdWxsTGluZSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3RhcnQ6IGN1cnNvcixcbiAgICAgICAgICAgIGVuZDogY3Vyc29yLFxuICAgICAgICAgICAgcXVlcnk6IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKSxcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBmaWx0ZXJPcHRpb24gPSAoZmlyc3RWYWx1ZXM6IHN0cmluZ1tdIHwgdW5kZWZpbmVkLCBsYXN0VmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCwgb3B0aW9uOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuICFmaXJzdFZhbHVlcyB8fFxuICAgICAgICAgICAgIWZpcnN0VmFsdWVzPy5jb250YWlucyhlbmNvZGVMaW5rKG9wdGlvbikpICYmICghbGFzdFZhbHVlIHx8XG4gICAgICAgICAgICAgICAgISFsYXN0VmFsdWUgJiYgZW5jb2RlTGluayhvcHRpb24pLmluY2x1ZGVzKGxhc3RWYWx1ZSkpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRBbGlhcyh0RmlsZTogVEZpbGUpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBsZXQgYWxpYXM6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQ/Lm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nKSB7XG4gICAgICAgICAgICBhbGlhcyA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh0RmlsZS5wYXRoKSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWxpYXNcbiAgICB9XG5cbiAgICBhc3luYyBnZXRTdWdnZXN0aW9ucyhjb250ZXh0OiBFZGl0b3JTdWdnZXN0Q29udGV4dCk6IFByb21pc2U8SVZhbHVlQ29tcGxldGlvbltdPiB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gYXdhaXQgdGhpcy5nZXRWYWx1ZVN1Z2dlc3Rpb25zKGNvbnRleHQpO1xuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG5cbiAgICBhc3luYyBnZXRWYWx1ZVN1Z2dlc3Rpb25zKGNvbnRleHQ6IEVkaXRvclN1Z2dlc3RDb250ZXh0KTogUHJvbWlzZTxJVmFsdWVDb21wbGV0aW9uW10+IHtcbiAgICAgICAgY29uc3QgbGluZU51bWJlciA9IGNvbnRleHQuc3RhcnQubGluZTtcbiAgICAgICAgY29uc3QgbWF0Y2hGaWVsZDogeyBhdHRyaWJ1dGU/OiBzdHJpbmcsIHZhbHVlcz86IHN0cmluZ1tdIH0gPSB7IGF0dHJpYnV0ZTogdW5kZWZpbmVkLCB2YWx1ZXM6IFtdIH1cbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcblxuICAgICAgICBjb25zdCBzcGxpdFZhbHVlcyA9ICh2YWx1ZXM6IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcz8ucmVwbGFjZSgvXlxcW3xeXFxzXFxbfF5cXCh8Xlxcc1xcKC8sICcnKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXF0kfFxcKSQvLCAnJylcbiAgICAgICAgICAgICAgICAuc3BsaXQoXCIsXCIpXG4gICAgICAgICAgICAgICAgLm1hcChvID0+IGVuY29kZUxpbmsoby50cmltKCkpKSB8fCBbJyddXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBnZXRGaWx0ZXJlZE9wdGlvbnNMaXN0ID0gKGZpZWxkOiBGaWVsZCwgZmlyc3RWYWx1ZXM6IHN0cmluZ1tdIHwgdW5kZWZpbmVkLCBsYXN0VmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZClcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gKGZpZWxkTWFuYWdlciBhcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkKVxuICAgICAgICAgICAgICAgIC5nZXRPcHRpb25zTGlzdChkdkFwaS5wYWdlKHRoaXMuY29udGV4dD8uZmlsZS5wYXRoKSlcbiAgICAgICAgICAgICAgICAuZmlsdGVyKG9wdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlck9wdGlvbihmaXJzdFZhbHVlcywgbGFzdFZhbHVlLCBvcHRpb24pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKF92YWx1ZSA9PiBPYmplY3QoeyBhdHRyOiBmaWVsZC5uYW1lLCB2YWx1ZTogX3ZhbHVlIH0pKVxuICAgICAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgY29uc3QgbGluZUZpZWxkcyA9IGdldExpbmVGaWVsZHMoZW5jb2RlTGluayhjb250ZXh0LmVkaXRvci5nZXRMaW5lKGxpbmVOdW1iZXIpKSk7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNvbnRleHQuZWRpdG9yLmdldEN1cnNvcigpLmNoXG4gICAgICAgICAgICBjb25zdCBhY3RpdmVMaW5lRmllbGQgPSBsaW5lRmllbGRzLmZpbmQobGluZUZpZWxkID0+IGxpbmVGaWVsZC5pbmRleCA8PSBwb3NpdGlvbiAmJiBsaW5lRmllbGQuaW5kZXggKyBsaW5lRmllbGQubGVuZ3RoID49IHBvc2l0aW9uKVxuICAgICAgICAgICAgaWYgKGFjdGl2ZUxpbmVGaWVsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5TZW50ZW5jZSA9IGFjdGl2ZUxpbmVGaWVsZC5pbmRleCA+IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbkZ1bGxMaW5lID0gYWN0aXZlTGluZUZpZWxkLmluZGV4ID09PSAwO1xuICAgICAgICAgICAgICAgIG1hdGNoRmllbGQuYXR0cmlidXRlID0gYWN0aXZlTGluZUZpZWxkLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLnZhbHVlcyA9IHNwbGl0VmFsdWVzKGFjdGl2ZUxpbmVGaWVsZC52YWx1ZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmllbGRSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTooPzx2YWx1ZXM+LispP2AsIFwidVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RJdGVtUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtsaXN0UHJlZml4fSg/PHZhbHVlcz4uKyk/YCwgXCJ1XCIpO1xuICAgICAgICAgICAgbGV0IGZpZWxkTGluZSA9IGxpbmVOdW1iZXI7XG4gICAgICAgICAgICB3aGlsZSAoIWNvbnRleHQuZWRpdG9yLmdldExpbmUoZmllbGRMaW5lKS5pbmNsdWRlcyhcIjpcIikgJiYgZmllbGRMaW5lID4gMCkgZmllbGRMaW5lID0gZmllbGRMaW5lIC0gMVxuICAgICAgICAgICAgY29uc3QgcmVnZXhSZXN1bHQgPSBjb250ZXh0LmVkaXRvci5nZXRSYW5nZSh7IGxpbmU6IGZpZWxkTGluZSwgY2g6IDAgfSwgY29udGV4dC5lbmQpLm1hdGNoKGZpZWxkUmVnZXgpO1xuICAgICAgICAgICAgaWYgKHJlZ2V4UmVzdWx0Py5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLmF0dHJpYnV0ZSA9IHJlZ2V4UmVzdWx0Lmdyb3Vwcy5hdHRyaWJ1dGU7XG4gICAgICAgICAgICAgICAgbWF0Y2hGaWVsZC52YWx1ZXMgPSBzcGxpdFZhbHVlcyhyZWdleFJlc3VsdC5ncm91cHMudmFsdWVzKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGkgPSAxO1xuICAgICAgICAgICAgd2hpbGUgKGNvbnRleHQuZWRpdG9yLmdldExpbmUoZmllbGRMaW5lICsgaSkuc3RhcnRzV2l0aChsaXN0UHJlZml4KSAmJiBmaWVsZExpbmUgKyBpIDw9IGNvbnRleHQuZWRpdG9yLmxhc3RMaW5lKCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWdleFJlc3VsdCA9IGNvbnRleHQuZWRpdG9yLmdldExpbmUoZmllbGRMaW5lICsgaSkubWF0Y2gobGlzdEl0ZW1SZWdleCk7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2V4UmVzdWx0Py5ncm91cHMpIG1hdGNoRmllbGQudmFsdWVzPy5wdXNoKC4uLnNwbGl0VmFsdWVzKHJlZ2V4UmVzdWx0Lmdyb3Vwcy52YWx1ZXMpKVxuICAgICAgICAgICAgICAgIGkgKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAobWF0Y2hGaWVsZC5hdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkTmFtZSA9IG1hdGNoRmllbGQuYXR0cmlidXRlO1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGNvbnRleHQuZmlsZS5wYXRoKT8uZmluZChmID0+IGYubmFtZSA9PT0gZmllbGROYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBtYXRjaEZpZWxkLnZhbHVlc1xuICAgICAgICAgICAgY29uc3QgbGFzdFZhbHVlID0gdmFsdWVzTGlzdD8ubGFzdCgpXG4gICAgICAgICAgICBjb25zdCBmaXJzdFZhbHVlcyA9IHZhbHVlc0xpc3Q/LnNsaWNlKDAsIC0xKVxuXG4gICAgICAgICAgICAvL3RhZ3Mgc3BlY2lmaWMgY2FzZVxuICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJ0YWdzXCIgJiYgdGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldFRhZ3MoKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih0ID0+IGxhc3RWYWx1ZSA/IHQuY29udGFpbnMobGFzdFZhbHVlKSA6IHQpXG4gICAgICAgICAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgICAgICAgICAgLm1hcCh0YWcgPT4gT2JqZWN0KHsgYXR0cjogZmllbGROYW1lLCB2YWx1ZTogdGFnLnJlcGxhY2UoL14jLywgXCJcIikgfSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZCAmJiBbRmllbGRUeXBlLkN5Y2xlLCBGaWVsZFR5cGUuTXVsdGksIEZpZWxkVHlwZS5TZWxlY3RdLmNvbnRhaW5zKHRoaXMuZmllbGQudHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RmlsdGVyZWRPcHRpb25zTGlzdCh0aGlzLmZpZWxkLCBmaXJzdFZhbHVlcywgbGFzdFZhbHVlKVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpZWxkICYmIFtGaWVsZFR5cGUuRmlsZSwgRmllbGRUeXBlLk11bHRpRmlsZV0uaW5jbHVkZXModGhpcy5maWVsZC50eXBlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvcnRpbmdNZXRob2QgPSBuZXcgRnVuY3Rpb24oXCJhXCIsIFwiYlwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmd9YCkgfHxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGE6IFRGaWxlLCBiOiBURmlsZSkgeyByZXR1cm4gYS5iYXNlbmFtZSA8IGIuYmFzZW5hbWUgPyAtMSA6IDEgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlcjogRmlsZUZpZWxkID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gZmllbGRNYW5hZ2VyLmdldEZpbGVzKHRoaXMuY29udGV4dD8uZmlsZSkuc29ydChzb3J0aW5nTWV0aG9kIGFzIChhOiBURmlsZSwgYjogVEZpbGUpID0+IG51bWJlcik7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3RWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRzID0gZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobGFzdFZhbHVlLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgdGhpcy5nZXRBbGlhcyhmKT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsYXN0VmFsdWUudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGYgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyOiBmaWVsZE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIGNvbnRleHQuZmlsZSwgZi5iYXNlbmFtZSwgdW5kZWZpbmVkLCB0aGlzLmdldEFsaWFzKGYpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGYgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhbGlhczogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdkFwaSAmJiB0aGlzLmZpZWxkPy5vcHRpb25zLmN1c3RvbVJlbmRlcmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGlhcyA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZShmLnBhdGgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0KHsgYXR0cjogZmllbGROYW1lLCB2YWx1ZTogRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCBjb250ZXh0LmZpbGUsIGYuYmFzZW5hbWUsIHVuZGVmaW5lZCwgYWxpYXMpIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogSVZhbHVlQ29tcGxldGlvbiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgICAgICBlbC5hZGRDbGFzcyhcInN1Z2dlc3RlclwiKVxuICAgICAgICBjb25zdCBbcmF3VmFsdWUsIGFsaWFzXSA9IGAke3N1Z2dlc3Rpb24udmFsdWV9YC5yZXBsYWNlKC9eXFxbXFxbLywgXCJcIikucmVwbGFjZSgvXFxdXFxdJC8sIFwiXCIpLnNwbGl0KFwifFwiKVxuICAgICAgICBjb25zdCB0YXJnZXRGaWxlID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocmF3VmFsdWUsIHRoaXMuY29udGV4dCEuZmlsZS5wYXRoKVxuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZCAmJiB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nICYmIHRhcmdldEZpbGUpIHtcbiAgICAgICAgICAgIGlmIChhbGlhcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbS13aXRoLWFsaWFzXCIgfSk7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBhbGlhcyB9KVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbS13aXRoLWFsaWFzLWZpbGVwYXRoXCIgfSlcbiAgICAgICAgICAgICAgICBmaWxlUGF0aC5zZXRUZXh0KHJhd1ZhbHVlKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbC5zZXRUZXh0KG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh0YXJnZXRGaWxlLnBhdGgpKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLnNldFRleHQocmF3VmFsdWUpXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgYXN5bmMgc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBJVmFsdWVDb21wbGV0aW9uLCBldmVudDogS2V5Ym9hcmRFdmVudCB8IE1vdXNlRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUxpbmUgPSBlZGl0b3IuZ2V0TGluZSh0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5jb250ZXh0Py5maWxlXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5jb250ZXh0Py5lZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggfHwgMFxuICAgICAgICBjb25zdCBmaWVsZE5hbWUgPSBzdWdnZXN0aW9uLmF0dHJcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcblxuICAgICAgICBjb25zdCBjbGVhbiA9IChpdGVtOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtPy5yZXBsYWNlKC9cXHM/XFwsJC8sIFwiXCIpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5pbkZyb250bWF0dGVyICYmIGZpbGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbGV0IGJlZ2luRmllbGRMaW5lTnVtYmVyID0gdGhpcy5jb250ZXh0IS5zdGFydC5saW5lXG4gICAgICAgICAgICAgICAgbGV0IGVuZEZpZWxkTGluZU51bWJlciA9IHRoaXMuY29udGV4dCEuc3RhcnQubGluZVxuICAgICAgICAgICAgICAgIHdoaWxlICghZWRpdG9yLmdldExpbmUoYmVnaW5GaWVsZExpbmVOdW1iZXIpLnN0YXJ0c1dpdGgoYCR7ZmllbGROYW1lfTpgKVxuICAgICAgICAgICAgICAgICAgICAmJiBiZWdpbkZpZWxkTGluZU51bWJlciA+IDApXG4gICAgICAgICAgICAgICAgICAgIGJlZ2luRmllbGRMaW5lTnVtYmVyID0gYmVnaW5GaWVsZExpbmVOdW1iZXIgLSAxXG4gICAgICAgICAgICAgICAgd2hpbGUgKCFlZGl0b3IuZ2V0TGluZShlbmRGaWVsZExpbmVOdW1iZXIgKyAxKS5pbmNsdWRlcygnOicpXG4gICAgICAgICAgICAgICAgICAgICYmICEoZWRpdG9yLmdldExpbmUoZW5kRmllbGRMaW5lTnVtYmVyICsgMSkgPT09IFwiLS0tXCIpXG4gICAgICAgICAgICAgICAgICAgICYmIGVuZEZpZWxkTGluZU51bWJlciArIDEgPD0gdGhpcy5jb250ZXh0IS5lZGl0b3IubGFzdExpbmUoKSlcbiAgICAgICAgICAgICAgICAgICAgZW5kRmllbGRMaW5lTnVtYmVyID0gZW5kRmllbGRMaW5lTnVtYmVyICsgMVxuICAgICAgICAgICAgICAgIGNvbnN0IHNlcmlhbGl6ZWRGaWVsZCA9IGVkaXRvci5nZXRSYW5nZShcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBiZWdpbkZpZWxkTGluZU51bWJlciwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBlbmRGaWVsZExpbmVOdW1iZXIsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRGaWVsZExpbmVOdW1iZXIpLmxlbmd0aCB9KVxuICAgICAgICAgICAgICAgIGxldCBwYXJzZWRGaWVsZDogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgc3RyaW5nW10gfCBudWxsPiA9IHBhcnNlWWFtbChzZXJpYWxpemVkRmllbGQpXG4gICAgICAgICAgICAgICAgbGV0IFthdHRyLCBwYXN0VmFsdWVzXSA9IE9iamVjdC5lbnRyaWVzKHBhcnNlZEZpZWxkKVswXVxuICAgICAgICAgICAgICAgIGxldCBuZXdGaWVsZDogc3RyaW5nXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQgJiYgdGhpcy5maWVsZC5nZXREaXNwbGF5KHRoaXMucGx1Z2luKSA9PT0gTXVsdGlEaXNwbGF5VHlwZS5hc0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0gKGZpZWxkTWFuYWdlciBhcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldE9wdGlvbnNMaXN0KGR2QXBpLnBhZ2UodGhpcy5jb250ZXh0Py5maWxlLnBhdGgpKVxuICAgICAgICAgICAgICAgICAgICAvL2NsZWFuIHRoZSBwYXN0IHZhbHVlcyBpbiBjYXNlIHRoZSB1c2VyIGhhcyB0eXBlZCBhIGNvbW1hIHRvIGluc2VydCBhIG5ldyB2YWx1ZSwgYW5kIGFwcGVuZCB0aGUgbmV3IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZXNBcnJheTogc3RyaW5nW10gPSBbc3VnZ2VzdGlvbi52YWx1ZV1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXN0VmFsdWVzID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNBcnJheSA9IFsuLi5uZXcgU2V0KFtjbGVhbihwYXN0VmFsdWVzKSwgLi4udmFsdWVzQXJyYXldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihpdGVtID0+IG9wdGlvbnMuaW5jbHVkZXMoaXRlbSkpKV1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHBhc3RWYWx1ZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNBcnJheSA9IFsuLi5uZXcgU2V0KFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5wYXN0VmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIodiA9PiAhIXYpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAodmFsdWUgPT4gY2xlYW4odmFsdWUpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZXNBcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgXS5maWx0ZXIoaXRlbSA9PiBvcHRpb25zLmluY2x1ZGVzKGl0ZW0pKSldXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBgJHthdHRyfTogJHt2YWx1ZXNBcnJheS5tYXAodmFsdWUgPT4gYFxcbiAgLSAke2NsZWFuKHZhbHVlKX1gKS5qb2luKFwiXCIpfWBcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpZWxkTmFtZSA9PT0gXCJ0YWdzXCIgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJvbnRtYXR0ZXJMaXN0RGlzcGxheSA9PT0gTXVsdGlEaXNwbGF5VHlwZS5hc0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlc0FycmF5OiBzdHJpbmdbXSA9IFtzdWdnZXN0aW9uLnZhbHVlXVxuICAgICAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5rZXlzKHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldFRhZ3MoKSkubWFwKHQgPT4gdC5yZXBsYWNlKC9eIy8sIFwiXCIpKVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBhc3RWYWx1ZXMgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc0FycmF5ID0gWy4uLm5ldyBTZXQoW2NsZWFuKHBhc3RWYWx1ZXMpLCAuLi52YWx1ZXNBcnJheV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gb3B0aW9ucy5pbmNsdWRlcyhpdGVtKSkpXVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocGFzdFZhbHVlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc0FycmF5ID0gWy4uLm5ldyBTZXQoW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnBhc3RWYWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih2ID0+ICEhdilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCh2YWx1ZSA9PiBjbGVhbih2YWx1ZSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlc0FycmF5XG4gICAgICAgICAgICAgICAgICAgICAgICBdLmZpbHRlcihpdGVtID0+IG9wdGlvbnMuaW5jbHVkZXMoaXRlbSkpKV1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGAke2F0dHJ9OiAke3ZhbHVlc0FycmF5Lm1hcCh2YWx1ZSA9PiBgXFxuICAtICR7Y2xlYW4odmFsdWUpfWApLmpvaW4oXCJcIil9YFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXkgYXMgYW4gYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXN0VmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogXCIgKyBzdWdnZXN0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwYXN0VmFsdWVzID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhc3RWYWx1ZXMuY29udGFpbnMoXCIsXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFwiICsgc3VnZ2VzdGlvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFzdFZhbHVlc0FycmF5ID0gcGFzdFZhbHVlcy5zcGxpdChcIixcIikubWFwKG8gPT4gby50cmltKCkpLnNsaWNlKDAsIC0xKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBwYXN0VmFsdWVzQXJyYXkuam9pbignLCAnKSArIFwiLCBcIiArIGNsZWFuKHN1Z2dlc3Rpb24udmFsdWUpICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwYXN0VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUxpbmUuZW5kc1dpdGgoXCIsXVwiKSB8fCBhY3RpdmVMaW5lLmVuZHNXaXRoKFwiLCBdXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YWx1ZSBjYW4gYmUgZGlyZWN0bHkgYWRkZWQgc2luY2UgcGFyc2VZYW1sIHdvbnQgY3JlYXRlIGFuIGVtcHR5IGxhc3QgaXRlbSBpbiBwYXN0VmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIFsuLi5wYXN0VmFsdWVzLCBjbGVhbihzdWdnZXN0aW9uLnZhbHVlKV0uam9pbihcIiwgXCIpICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgaGF2ZSB0eXBlZCBzb21ldGhpbmcgdGhhdCB3ZSBhaHZlIHRvIHJlbW92ZSB0byByZXBsYWNlIHdpdGggc2VsZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXMuc2xpY2UoMCwgLTEpLCBjbGVhbihzdWdnZXN0aW9uLnZhbHVlKV0uam9pbihcIiwgXCIpICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXNdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3RmllbGQsIHsgbGluZTogYmVnaW5GaWVsZExpbmVOdW1iZXIsIGNoOiAwIH0sIHsgbGluZTogZW5kRmllbGRMaW5lTnVtYmVyLCBjaDogZWRpdG9yLmdldExpbmUoZW5kRmllbGRMaW5lTnVtYmVyKS5sZW5ndGggfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLmZpZWxkPy5nZXREaXNwbGF5KHRoaXMucGx1Z2luKSA9PT0gTXVsdGlEaXNwbGF5VHlwZS5hc0xpc3QpXG4gICAgICAgICAgICAgICAgICAgICYmICEoZmllbGROYW1lID09PSBcInRhZ3NcIiAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcm9udG1hdHRlckxpc3REaXNwbGF5ID09PSBNdWx0aURpc3BsYXlUeXBlLmFzTGlzdClcbiAgICAgICAgICAgICAgICAgICAgJiYgKEFycmF5LmlzQXJyYXkocGFzdFZhbHVlcykgfHwgdHlwZW9mIHBhc3RWYWx1ZXMgPT09ICdzdHJpbmcnICYmIHBhc3RWYWx1ZXMuY29udGFpbnMoXCIsXCIpKSkge1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogYmVnaW5GaWVsZExpbmVOdW1iZXIsIGNoOiBuZXdGaWVsZC5sZW5ndGggLSAxIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZEZpZWxkTGluZU51bWJlciA9IHRoaXMuY29udGV4dCEuc3RhcnQubGluZVxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIWVkaXRvci5nZXRMaW5lKGVuZEZpZWxkTGluZU51bWJlciArIDEpLmluY2x1ZGVzKCc6JykgJiYgIShlZGl0b3IuZ2V0TGluZShlbmRGaWVsZExpbmVOdW1iZXIgKyAxKSA9PT0gXCItLS1cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5nZXRMaW5lKGVuZEZpZWxkTGluZU51bWJlcik7IGVuZEZpZWxkTGluZU51bWJlciA9IGVuZEZpZWxkTGluZU51bWJlciArIDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogZW5kRmllbGRMaW5lTnVtYmVyLCBjaDogZWRpdG9yLmdldExpbmUoZW5kRmllbGRMaW5lTnVtYmVyKS5sZW5ndGggfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGcm9udG1hdHRlciB3cm9uZ2x5IGZvcm1hdHRlZFwiLCAyMDAwKVxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5GdWxsTGluZSAmJiB0aGlzLmZpZWxkICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vcmVwbGFjZSBkaXJlY3RseSBpbiBwbGFjZSB0byBtYWludGFpbiBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgIGxldCBjbGVhbmVkTGluZSA9IGFjdGl2ZUxpbmVcbiAgICAgICAgICAgIHdoaWxlICghWycsJywgJzonXS5jb250YWlucyhjbGVhbmVkTGluZS5jaGFyQXQoY2xlYW5lZExpbmUubGVuZ3RoIC0gMSkpKSB7XG4gICAgICAgICAgICAgICAgY2xlYW5lZExpbmUgPSBjbGVhbmVkTGluZS5zbGljZSgwLCAtMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoYCR7Y2xlYW5lZExpbmV9JHtldmVudC5zaGlmdEtleSA/IFwiXCIgOiBcIiBcIn1gICsgc3VnZ2VzdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IDAgfSwgdGhpcy5jb250ZXh0IS5lbmQpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5TZW50ZW5jZSAmJiB0aGlzLmZpZWxkICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vcmVwbGFjZSBkaXJlY3RseSBpbiBwbGFjZSB0byBtYWludGFpbiBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgIGxldCBiZWZvcmVDdXJzb3IgPSBhY3RpdmVMaW5lLnNsaWNlKDAsIHBvc2l0aW9uKVxuICAgICAgICAgICAgbGV0IGFmdGVyQ3Vyc29yID0gYWN0aXZlTGluZS5zbGljZShwb3NpdGlvbilcbiAgICAgICAgICAgIGxldCBzZXBhcmF0b3JQb3MgPSBwb3NpdGlvbjtcbiAgICAgICAgICAgIGxldCBjdXJyZW50VmFsdWVMZW5ndGggPSAwO1xuICAgICAgICAgICAgd2hpbGUgKCFiZWZvcmVDdXJzb3IuZW5kc1dpdGgoXCI6OlwiKSAmJiAhYmVmb3JlQ3Vyc29yLmVuZHNXaXRoKFwiLFwiKSAmJiBiZWZvcmVDdXJzb3IubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgc2VwYXJhdG9yUG9zID0gc2VwYXJhdG9yUG9zIC0gMTtcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWVMZW5ndGggPSBjdXJyZW50VmFsdWVMZW5ndGggKyAxXG4gICAgICAgICAgICAgICAgYmVmb3JlQ3Vyc29yID0gYmVmb3JlQ3Vyc29yLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBuZXh0QnJhY2tldFBvcyA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgd2hpbGUgKCFlbmNvZGVMaW5rKGFmdGVyQ3Vyc29yKS5tYXRjaChcIihcXFxcXXxcXFxcKSkuKlwiKSAmJiBhZnRlckN1cnNvci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBuZXh0QnJhY2tldFBvcyA9IG5leHRCcmFja2V0UG9zICsgMTtcbiAgICAgICAgICAgICAgICBhZnRlckN1cnNvciA9IGFmdGVyQ3Vyc29yLnNsaWNlKG5leHRCcmFja2V0UG9zIC0gcG9zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9uLnZhbHVlLFxuICAgICAgICAgICAgICAgIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogc2VwYXJhdG9yUG9zIH0sXG4gICAgICAgICAgICAgICAgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBuZXh0QnJhY2tldFBvcyB9XG4gICAgICAgICAgICApXG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV4dEJyYWNrZXRQb3MgLSBjdXJyZW50VmFsdWVMZW5ndGggKyBzdWdnZXN0aW9uLnZhbHVlLmxlbmd0aCB9KVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlkU2VsZWN0ID0gdHJ1ZVxuICAgICAgICB0aGlzLmNsb3NlKClcbiAgICB9O1xufTsiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdCQUE2Qzs7O0FDQzdDLHdCQUE0RDs7O0FDQTVELHdCQUF5RDs7O0FDRHpELHdCQUEyRzs7O0FDQzNHLHdCQUF3RDs7O0FDQXhELHVCQUE0Rjs7O0FDQTVGLHVCQUErQzs7O0FDQS9DLHNCQU1PO0FBR0EseUJBQXlCLFFBQXNCLFlBQTZCO0FBQy9FLGVBQWEsbUNBQWMsVUFBVTtBQUVyQyxRQUFNLFNBQVMsT0FBTyxJQUFJLE1BQU0sc0JBQXNCLFVBQVU7QUFDaEUsTUFBSSxDQUFDLFFBQVE7QUFDVCxVQUFNLElBQUksTUFBTSxXQUFXLDJCQUEyQjtBQUFBLEVBQzFEO0FBQ0EsTUFBSSxDQUFFLG1CQUFrQiwwQkFBVTtBQUM5QixVQUFNLElBQUksTUFBTSxHQUFHLG9DQUFvQztBQUFBLEVBQzNEO0FBRUEsU0FBTztBQUNYO0FBRU8sZ0NBQ0gsUUFDQSxZQUNZO0FBQ1osUUFBTSxTQUFTLGdCQUFnQixRQUFRLFVBQVU7QUFFakQsUUFBTSxRQUFzQixDQUFDO0FBQzdCLHdCQUFNLGdCQUFnQixRQUFRLENBQUMsU0FBd0I7QUFDbkQsUUFBSSxnQkFBZ0IsdUJBQU87QUFDdkIsWUFBTSxLQUFLLElBQUk7QUFBQSxJQUNuQjtBQUFBLEVBQ0osQ0FBQztBQUVELFFBQU0sS0FBSyxDQUFDLEdBQUcsTUFBTTtBQUNqQixXQUFPLEVBQUUsU0FBUyxjQUFjLEVBQUUsUUFBUTtBQUFBLEVBQzlDLENBQUM7QUFFRCxTQUFPO0FBQ1g7QUFFTywrQkFBK0IsUUFBc0IsZ0JBQWdDO0FBQ3hGLE1BQUk7QUFDSixNQUFJLDBCQUEwQix1QkFBTztBQUNqQyxXQUFPO0FBQUEsRUFDWCxPQUFPO0FBQ0gsVUFBTSxRQUFRLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixjQUFjO0FBQ25FLFFBQUksaUJBQWlCLHlCQUFTLE1BQU0sYUFBYSxNQUFNO0FBQ25ELGFBQU87QUFBQSxJQUNYLE9BQU87QUFDSCxZQUFNLE1BQU0sMENBQTBDO0FBQUEsSUFDMUQ7QUFBQSxFQUNKO0FBQ0EsU0FBTztBQUNYOzs7QUN0RE8sdUJBQXVCLFFBQXNCLE1BQWEsUUFBNEQ7QUFIN0g7QUFJSSxRQUFNLFlBQThCLGNBQU8sSUFBSSxjQUFjLGFBQWEsSUFBSSxNQUExQyxtQkFBNkMsY0FBYSxDQUFDO0FBQy9GLFNBQU8sbUNBQW1DLFdBQVcsTUFBTTtBQUMvRDtBQUVPLDRDQUNILFdBQ0EsUUFDMEM7QUFDMUMsUUFBTSxrQkFBa0IsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUNwQyxNQUFJLFNBQWdCO0FBQ3BCLE1BQUksT0FBYztBQUNsQixNQUFJLFlBQXFCO0FBQ3pCLFlBQ0ssS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLFNBQVMsTUFBTSxPQUFPLEVBQUUsU0FBUyxNQUFNLElBQUksRUFDNUQsUUFBUSxjQUFZO0FBQ2pCLFFBQUksZ0JBQWdCLFNBQVMsU0FBUyxNQUFNLEtBQUssQ0FBQyxXQUFXO0FBQ3pELHNCQUFnQixLQUFLLFNBQVMsU0FBUyxNQUFNLElBQUk7QUFDakQsVUFBSSxTQUFRLFNBQVMsU0FBUyxNQUFNO0FBQU0saUJBQVEsU0FBUyxTQUFTLE1BQU07QUFDMUUsVUFBSSxRQUFPLFNBQVMsU0FBUyxJQUFJLE1BQU07QUFDbkMsWUFBSSxTQUFTLFNBQVMsSUFBSSxRQUFRLFNBQVMsU0FBUyxNQUFNLE1BQU07QUFDNUQsaUJBQU0sU0FBUyxTQUFTLElBQUk7QUFBQSxRQUNoQyxPQUFPO0FBQ0gsaUJBQU0sU0FBUyxTQUFTLE1BQU07QUFDOUIsc0JBQVk7QUFBQSxRQUNoQjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFDSixDQUFDO0FBQ0wsTUFBSSxRQUFPLEdBQUc7QUFFVixXQUFPLEVBQUUsT0FBTyxRQUFPLEtBQUssS0FBSTtBQUFBLEVBQ3BDO0FBQ0E7QUFDSjs7O0FDckNPLElBQUsscUJBQUwsa0JBQUssd0JBQUw7QUFDSCwrQkFBUTtBQUNSLGlDQUFVO0FBQ1Ysb0NBQWE7QUFDYixtQ0FBWTtBQUNaLCtCQUFRO0FBQ1IsK0JBQVE7QUFOQTtBQUFBO0FBU0wsSUFBTSx3Q0FBeUY7QUFBQSxFQUNsRyxPQUFPO0FBQUEsRUFDUCxTQUFTO0FBQUEsRUFDVCxZQUFZO0FBQUEsRUFDWixXQUFXO0FBQUEsRUFDWCxPQUFPO0FBQUEsRUFDUCxPQUFPO0FBQ1g7QUFFTyxJQUFNLDZCQUE4RTtBQUFBLEVBQ3ZGLE9BQU87QUFBQSxFQUNQLFlBQVk7QUFBQSxFQUNaLFNBQVM7QUFBQSxFQUNULFdBQVc7QUFBQSxFQUNYLE9BQU87QUFBQSxFQUNQLE9BQU87QUFDWDtBQUVPLElBQUssT0FBTCxrQkFBSyxVQUFMO0FBQ0gsdUJBQWM7QUFDZCw2QkFBb0I7QUFDcEIsZ0NBQXVCO0FBQ3ZCLHdCQUFlO0FBQ2YsOEJBQXFCO0FBQ3JCLCtCQUFzQjtBQU5kO0FBQUE7QUFTTCxJQUFNLG1CQUFzRDtBQUFBLEVBQy9ELGFBQWE7QUFBQSxFQUNiLG1CQUFtQjtBQUFBLEVBQ25CLHNCQUFzQjtBQUFBLEVBQ3RCLGNBQWM7QUFBQSxFQUNkLG9CQUFvQjtBQUFBLEVBQ3BCLHFCQUFxQjtBQUN6QjtBQVdPLElBQU0sY0FBaUQ7QUFBQSxFQUMxRCxhQUFhO0FBQUEsRUFDYixtQkFBbUI7QUFBQSxFQUNuQixzQkFBc0I7QUFBQSxFQUN0QixjQUFjO0FBQUEsRUFDZCxvQkFBb0I7QUFBQSxFQUNwQixxQkFBcUI7QUFDekI7QUFFTyxJQUFNLGNBQWlEO0FBQUEsRUFDMUQsYUFBYTtBQUFBLEVBQ2IsbUJBQW1CO0FBQUEsRUFDbkIsc0JBQXNCO0FBQUEsRUFDdEIsY0FBYztBQUFBLEVBQ2Qsb0JBQW9CO0FBQUEsRUFDcEIscUJBQXFCO0FBQ3pCO0FBR08sSUFBTSxpQkFBb0Q7QUFBQSxFQUM3RCxhQUFhO0FBQUEsRUFDYixtQkFBbUI7QUFBQSxFQUNuQixzQkFBc0I7QUFBQSxFQUN0QixjQUFjO0FBQUEsRUFDZCxvQkFBb0I7QUFBQSxFQUNwQixxQkFBcUI7QUFDekI7QUFFTyxJQUFNLFNBQTRDO0FBQUEsRUFDckQsYUFBYTtBQUFBLEVBQ2IsbUJBQW1CO0FBQUEsRUFDbkIsc0JBQXNCO0FBQUEsRUFDdEIsY0FBYztBQUFBLEVBR2Qsb0JBQW9CO0FBQUEsRUFHcEIscUJBQXFCO0FBS3pCO0FBRU8sSUFBTSxVQUE2QztBQUFBLEVBQ3RELGFBQWE7QUFBQSxFQUNiLG1CQUFtQjtBQUFBLEVBQ25CLHNCQUFzQjtBQUFBLEVBQ3RCLGNBQWM7QUFBQSxFQUNkLG9CQUFvQjtBQUFBLEVBQ3BCLHFCQUFxQjtBQUN6QjtBQUVPLElBQU0sd0JBQXdCO0FBQUEsRUFDakM7QUFBQSxFQUNBO0FBQ0o7OztBQy9HTyxJQUFNLGtCQUFrQixDQUFDLFdBQVcsVUFBVSxhQUFhLGNBQWMsYUFBYSxZQUFZLHlCQUF5Qix3QkFBd0IsUUFBUTtBQUUzSixJQUFNLG9CQUFvQjtBQUUxQixJQUFNLG1CQUFtQixDQUFDLGNBQXNCLGtHQUFtRztBQUVuSixJQUFNLGdCQUFnQixJQUFJLE9BQU8sSUFBSSx5Q0FBeUMsR0FBRztBQUVqRixJQUFNLDBCQUEwQixJQUFJLE9BQU8sTUFBTSxpREFBaUQsSUFBSTtBQUV0RyxJQUFNLHFCQUFxQixJQUFJLE9BQU8sTUFBTSxpREFBaUQsSUFBSTtBQUVqRyxJQUFNLGFBQWEsQ0FBQyxVQUEwQjtBQUVqRCxTQUFPLFFBQVEsTUFDVixRQUFRLFNBQVMsb0JBQU0sRUFDdkIsUUFBUSxTQUFTLG9CQUFNLElBQUk7QUFDcEM7QUFFTyxJQUFNLGFBQWEsQ0FBQyxVQUEwQjtBQUVqRCxTQUFPLFFBQVEsTUFDVixRQUFRLFVBQVUsSUFBSSxFQUN0QixRQUFRLFVBQVUsSUFBSSxJQUFJO0FBQ25DO0FBRU8sSUFBTSx1QkFBdUIsQ0FBQyxTQUFxQztBQUN0RSxRQUFNLG1CQUFtQixJQUFJLE9BQU8sV0FBQywwTEFBNkssR0FBQztBQUNuTixRQUFNLEtBQUssS0FBSyxNQUFNLGdCQUFnQjtBQUV0QyxNQUFJLHlCQUFJLFFBQVE7QUFDWixVQUFNLEVBQUUsV0FBVyxXQUFXLHlCQUFJO0FBQ2xDLFdBQU87QUFBQSxFQUNYO0FBQ0o7QUFFTyxJQUFNLGdCQUFnQixDQUFDLFNBQXlGO0FBQ25ILFFBQU0sU0FBaUYsQ0FBQztBQUN4RixRQUFNLEtBQUssS0FBSyxNQUFNLGFBQWE7QUFDbkMsTUFBSSx5QkFBSSxRQUFRO0FBQ1osVUFBTSxFQUFFLFdBQVcsV0FBVyx5QkFBSTtBQUNsQyxXQUFPLEtBQUssRUFBRSxXQUFXLFFBQVEsT0FBTyxHQUFHLFFBQVEsS0FBSyxPQUFPLENBQUM7QUFBQSxFQUNwRSxPQUFPO0FBQ0gsVUFBTSxPQUFPLFdBQVcsSUFBSSxFQUFFLFNBQVMsdUJBQXVCO0FBQzlELFFBQUksT0FBTyxLQUFLLEtBQUs7QUFDckIsV0FBTyxDQUFDLEtBQUssTUFBTTtBQUNmLFVBQUksS0FBSyxNQUFNLFFBQVE7QUFDbkIsY0FBTSxFQUFFLFdBQVcsV0FBVyxLQUFLLE1BQU07QUFDekMsZUFBTyxLQUFLLEVBQUUsV0FBVyxRQUFRLFdBQVcsTUFBTSxHQUFHLE9BQU8sS0FBSyxNQUFNLFNBQVMsR0FBRyxRQUFRLEtBQUssTUFBTSxHQUFHLE9BQU8sQ0FBQztBQUFBLE1BQ3JIO0FBQ0EsYUFBTyxLQUFLLEtBQUs7QUFBQSxJQUNyQjtBQUNBLFVBQU0sT0FBTyxXQUFXLElBQUksRUFBRSxTQUFTLGtCQUFrQjtBQUN6RCxXQUFPLEtBQUssS0FBSztBQUNqQixXQUFPLENBQUMsS0FBSyxNQUFNO0FBQ2YsVUFBSSxLQUFLLE1BQU0sUUFBUTtBQUNuQixjQUFNLEVBQUUsV0FBVyxXQUFXLEtBQUssTUFBTTtBQUN6QyxlQUFPLEtBQUssRUFBRSxXQUFXLFFBQVEsV0FBVyxNQUFNLEdBQUcsT0FBTyxLQUFLLE1BQU0sU0FBUyxHQUFHLFFBQVEsS0FBSyxNQUFNLEdBQUcsT0FBTyxDQUFDO0FBQUEsTUFDckg7QUFDQSxhQUFPLEtBQUssS0FBSztBQUFBLElBQ3JCO0FBQUEsRUFDSjtBQUNBLFNBQU8sS0FBSyxDQUFDLEdBQUcsTUFBTTtBQUNsQixRQUFJLEVBQUUsUUFBUSxFQUFFO0FBQU8sYUFBTztBQUM5QixRQUFJLEVBQUUsUUFBUSxFQUFFO0FBQU8sYUFBTztBQUM5QixXQUFPO0FBQUEsRUFDWCxDQUFDO0FBQ0QsU0FBTztBQUNYOzs7QUNwRU8scUJBQXFCLFFBQXVCO0FBQy9DLFFBQU0sZUFBd0IsQ0FBQztBQUMvQixTQUFPLEtBQUssTUFBTSxFQUFFLFFBQVEsU0FBTztBQUMvQixRQUFJLENBQUMsYUFBWSxJQUFJLE9BQUssRUFBRSxZQUFZLEVBQUUsUUFBUSxPQUFPLEdBQUcsQ0FBQyxFQUFFLFNBQVMsSUFBSSxZQUFZLEVBQUUsUUFBUSxPQUFPLEdBQUcsQ0FBQyxHQUFHO0FBQzVHLG1CQUFZLEtBQUssR0FBRztBQUFBLElBQ3hCLE9BQU87QUFDSCxVQUFJLFFBQVEsSUFBSSxZQUFZLEVBQUUsUUFBUSxPQUFPLEdBQUcsR0FBRztBQUMvQyxxQkFBWSxhQUFZLFFBQVEsSUFBSSxZQUFZLEVBQUUsUUFBUSxPQUFPLEdBQUcsQ0FBQyxLQUFLO0FBQUEsTUFDOUU7QUFBQSxJQUNKO0FBQUEsRUFDSixDQUFDO0FBQ0QsU0FBTztBQUNYO0FBRU8seUJBQXlCLFFBQWEsUUFBc0I7QUFDL0QsUUFBTSxjQUFjLE9BQU8sUUFBUSxTQUFTLFVBQVUsU0FBUyxRQUFRLFNBQVMsV0FBVyxXQUFXLGNBQWMsRUFBRSxVQUFVO0FBQ2hJLFFBQU0sY0FBYyxPQUFPLFFBQVEsU0FBUyxVQUFVLFNBQVMsUUFBUSxTQUFTLFdBQVcsV0FBVyxjQUFjLEVBQUUsVUFBVTtBQUNoSSxTQUFPLFlBQVksT0FBTyxXQUFXO0FBQ3pDOzs7QUxTQSxJQUFNLGtCQUFpRztBQUFBLEVBQ25HLFlBQVksRUFBRSxPQUFPLElBQUksS0FBSyxHQUFHO0FBQUEsRUFDakMsWUFBWSxFQUFFLE9BQU8sS0FBSyxLQUFLLElBQUk7QUFBQSxFQUNuQyxlQUFlLEVBQUUsT0FBTyxLQUFLLEtBQUssSUFBSTtBQUMxQztBQU9PLHFCQUNILFFBQ0EsTUFDQSxXQUNBLFVBQ0EsVUFDRztBQTVDUDtBQTZDSSxRQUFNLFFBQVEsYUFBTyxXQUFXLFlBQVksSUFBSSxLQUFLLElBQUksTUFBM0MsbUJBQThDLEtBQUssT0FBSyxFQUFFLFNBQVM7QUFDakYsUUFBTSxrQkFBa0IsQ0FBQyxjQUFzQjtBQUMzQyxRQUFJLFdBQVc7QUFDWCxVQUFJLFVBQVUsV0FBVyxJQUFJLEdBQUc7QUFDNUIsZUFBTyxJQUFJO0FBQUEsTUFDZixXQUFXLFVBQVUsV0FBVyxHQUFHLEdBQUc7QUFDbEMsZUFBTyxHQUFHO0FBQUEsTUFDZCxPQUFPO0FBQ0gsZUFBTyxnQ0FBVSxTQUFTO0FBQUEsTUFDOUI7QUFBQztBQUFBLElBQ0wsT0FBTztBQUNILGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUNBLFFBQU0sb0JBQW9CLENBQUMsV0FBa0Isa0JBQThDO0FBQ3ZGLFVBQU0sU0FBUyxVQUNWLFFBQVEsWUFBWSxHQUFHLEVBQ3ZCLE1BQU0sR0FBRyxFQUNULE9BQU8sT0FBSyxDQUFDLENBQUMsQ0FBQyxFQUNmLElBQUksV0FBUyxjQUFjLEtBQUssQ0FBQztBQUN0QyxXQUFPLE9BQU8sU0FBUyxTQUFTO0FBQUEsRUFDcEM7QUFDQSxVQUFRO0FBQUEsU0FDQztBQUNELGNBQVEsK0JBQU87QUFBQSxhQUNOO0FBQWtCLGlCQUFPLGtCQUFrQixVQUFVLENBQUMsU0FBUyxnQkFBZ0IsSUFBSSxDQUFDO0FBQUEsYUFDcEY7QUFBaUIsaUJBQU8sa0JBQWtCLFVBQVUsQ0FBQyxTQUFTLGdCQUFnQixJQUFJLENBQUM7QUFBQSxhQUNuRjtBQUFxQixpQkFBTyxrQkFBa0IsVUFBVSxDQUFDLFNBQVMsSUFBSSxPQUFPO0FBQUEsYUFDN0U7QUFBa0IsaUJBQU8sa0JBQWtCLFVBQVUsQ0FBQyxTQUFTLE9BQU8sR0FBRyxTQUFTLEVBQUU7QUFBQSxhQUNwRjtBQUFXLGNBQUksQ0FBQyxHQUFHLHlCQUF5QixPQUFPLFNBQVMsY0FBYyxFQUFFLFNBQVMsU0FBUyxHQUFHO0FBQ2xHLG1CQUFPLGtCQUFrQixVQUFVLENBQUMsU0FBUyxHQUFHLE1BQU07QUFBQSxVQUMxRCxPQUFPO0FBQ0gsbUJBQU8sZ0JBQWdCLFFBQVE7QUFBQSxVQUNuQztBQUFDO0FBQUE7QUFDUSxpQkFBTyxnQkFBZ0IsUUFBUTtBQUFBO0FBQUEsU0FFM0M7QUFDRCxhQUFPO0FBQUE7QUFHbkI7QUFFTyxJQUFNLG9CQUFvQixDQUFDLE9BQWUsTUFBYyxXQUFtQixPQUFlLFdBQWtDLGVBQStCO0FBQzlKLFFBQU0sS0FBSyxLQUFLLFNBQVMsS0FBSztBQUM5QixNQUFJLE9BQU8sR0FBRyxLQUFLO0FBQ25CLFFBQU0sWUFBNEIsQ0FBQztBQUNuQyxTQUFPLENBQUMsS0FBSyxNQUFNO0FBQ2YsVUFBTSxRQUFRLEtBQUs7QUFDbkIsUUFBSSxNQUFNLFVBQVUsT0FBTyxLQUFLLE1BQU0sTUFBTSxFQUFFLE1BQU0sT0FBSyxnQkFBZ0IsU0FBUyxDQUFDLENBQUMsR0FBRztBQUNuRixZQUFNLEVBQUUsUUFBUSxTQUFTLFdBQVcsWUFBWSxVQUFVLHVCQUF1QixzQkFBc0IsV0FBVyxNQUFNO0FBQ3hILFlBQU0sYUFBYSxRQUFRLE1BQU0sUUFBUSxZQUFZLEdBQUcsRUFBRSxNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUU7QUFDMUUsWUFBTSxXQUFXLFdBQVcsVUFBVSxJQUFJLFdBQVcsS0FBSyxHQUFHLFdBQVcsS0FBSyxJQUFJO0FBQ2pGLFlBQU0sU0FBUSxnQkFBZ0IsVUFBVTtBQUN4QyxZQUFNLE9BQU0sZ0JBQWdCLFVBQVU7QUFDdEMsZ0JBQVUsS0FBSztBQUFBLFFBQ1gsVUFBVSxNQUFNO0FBQUEsUUFDaEIsVUFBVSxHQUFHLFdBQVcsS0FBSyxTQUFRLFVBQVUsS0FBSyxhQUFhLEtBQUssYUFBYSxZQUFZLFdBQVcsMEJBQTBCLHdCQUF3QixNQUFNLFdBQVc7QUFBQSxNQUNqTCxDQUFDO0FBQUEsSUFDTDtBQUNBLFdBQU8sR0FBRyxLQUFLO0FBQUEsRUFDbkI7QUFDQSxTQUFPO0FBQ1g7QUFFQSwwQkFDSSxRQUNBLE1BQ0EsUUFDRjtBQUFBO0FBakhGO0FBa0hJLFVBQU0sY0FBYyxhQUFPLElBQUksY0FBYyxhQUFhLElBQUksTUFBMUMsbUJBQTZDO0FBQ2pFLFVBQU0sYUFBYSxDQUFDO0FBQ3BCLFVBQU0sY0FBYyxNQUFNLElBQUksTUFBTSxLQUFLLElBQUk7QUFDN0MsVUFBTSxlQUF5QixDQUFDO0FBQ2hDLFVBQU0sZUFBZSxDQUFDLFdBQW1CLFlBQWdDO0FBdEg3RTtBQXVIUSxZQUFNLFdBQVcsWUFBWSxRQUFRLE1BQU0sV0FBVyxRQUFRLE9BQU8sTUFBTTtBQUMzRSxVQUFJLE1BQU0sUUFBUSxRQUFRLEdBQUc7QUFDekIsY0FBTSxRQUFRLGNBQU8sV0FBVyxZQUFZLElBQUksS0FBSyxJQUFJLE1BQTNDLG9CQUE4QyxLQUFLLE9BQUssRUFBRSxTQUFTO0FBQ2pGLFlBQUksZ0NBQU8sV0FBVyxhQUFZLHVCQUF5QjtBQUN2RCxxQkFBVyxLQUFLLEdBQUcsWUFBWTtBQUMvQixtQkFBUyxPQUFPLE9BQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUFRLFVBQVE7QUFBRSx1QkFBVyxLQUFLLE9BQU8sTUFBTTtBQUFBLFVBQUUsQ0FBQztBQUFBLFFBQ2hGLE9BQU87QUFDSCxxQkFBVyxLQUFLLEdBQUcsZUFBZSxTQUFTLEtBQUssSUFBSSxJQUFJO0FBQUEsUUFDNUQ7QUFBQSxNQUNKLE9BQU87QUFDSCxtQkFBVyxLQUFLLEdBQUcsY0FBYyxVQUFVO0FBQUEsTUFDL0M7QUFBQSxJQUNKO0FBRUEsUUFBSSxDQUFDLGFBQWE7QUFDZCxpQkFBVyxLQUFLLEtBQUs7QUFDckIsYUFBTyxRQUFRLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQyxXQUFXLGFBQWEsYUFBYSxXQUFXLE9BQU8sQ0FBQztBQUN6RixpQkFBVyxLQUFLLEtBQUs7QUFDckIsaUJBQVcsS0FBSyxHQUFHLFlBQVksTUFBTSxJQUFJLENBQUM7QUFBQSxJQUM5QyxPQUFPO0FBQ0gsWUFBTSxpQkFBaUIsWUFBWSxNQUFNLElBQUk7QUFDN0MscUJBQWUsUUFBUSxDQUFDLE1BQU0sZUFBZTtBQUN6QyxZQUFJLGFBQWEsWUFBWSxTQUFTLElBQUksTUFBTTtBQUU1QyxxQkFBVyxLQUFLLElBQUk7QUFBQSxRQUN4QixXQUFXLGVBQWUsWUFBWSxTQUFTLElBQUksTUFBTTtBQUVyRCxpQkFBTyxRQUFRLE1BQU0sRUFDaEIsT0FBTyxDQUFDLENBQUMsV0FBVyxhQUFhLENBQUMsT0FBTyxLQUFLLFdBQVcsRUFBRSxTQUFTLFNBQVMsQ0FBQyxFQUM5RSxRQUFRLENBQUMsQ0FBQyxXQUFXLGFBQWE7QUFDL0IseUJBQWEsV0FBVyxPQUFPO0FBQUEsVUFDbkMsQ0FBQztBQUNMLHFCQUFXLEtBQUssSUFBSTtBQUFBLFFBQ3hCLFdBQVcsQ0FBQyxhQUFhLFNBQVMsVUFBVSxHQUFHO0FBRTNDLGdCQUFNLGVBQWdGLEVBQUUsTUFBTSxRQUFXLFNBQVMsT0FBVTtBQUU1SCxpQkFBTyxRQUFRLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQyxXQUFXLGFBQWE7QUFDckQsa0JBQU0sUUFBUSxJQUFJLE9BQU8sSUFBSSxjQUFjLEdBQUc7QUFDOUMsa0JBQU0sSUFBSSxLQUFLLE1BQU0sS0FBSztBQUMxQixnQkFBSSxLQUFLLEVBQUUsU0FBUyxHQUFHO0FBRW5CLGtCQUFJLElBQUk7QUFDUixxQkFBTyxlQUFlLGFBQWEsR0FBRyxXQUFXLE1BQU0sR0FBRztBQUN0RCw2QkFBYSxLQUFLLGFBQWEsQ0FBQztBQUNoQyxvQkFBSSxJQUFJO0FBQUEsY0FDWjtBQUVBLDJCQUFhLE9BQU87QUFDcEIsMkJBQWEsVUFBVTtBQUFBLFlBQzNCO0FBQUEsVUFDSixDQUFDO0FBQ0QsY0FBSSxhQUFhLFFBQVEsYUFBYSxTQUFTO0FBQzNDLHlCQUFhLGFBQWEsTUFBTSxhQUFhLE9BQU87QUFBQSxVQUN4RCxPQUFPO0FBQ0gsdUJBQVcsS0FBSyxJQUFJO0FBQUEsVUFDeEI7QUFBQSxRQUNKO0FBQUEsTUFDSixDQUFDO0FBQUEsSUFDTDtBQUNBLFVBQU0sY0FBYyxXQUFXLEtBQUssSUFBSTtBQUN4QyxVQUFNLE9BQU8sSUFBSSxNQUFNLE9BQU8sTUFBTSxXQUFXO0FBQUEsRUFDbkQ7QUFBQTtBQUVBLDBCQUNJLFFBQ0EsTUFDQSxnQkFDQSxnQkFDQSxZQUNBLFFBQWlCLE1BQ2pCLFNBQWtCLE9BQ2xCLFlBQXFCLE9BQ3ZCO0FBQUE7QUFoTUY7QUFtTUksVUFBTSxlQUF5QixDQUFDO0FBQ2hDLFFBQUksYUFBdUIsQ0FBQztBQUM1QixVQUFNLGlCQUFpQixNQUFNLE9BQU8sSUFBSSxNQUFNLEtBQUssSUFBSTtBQUd2RCxtQkFBZSxNQUFNLElBQUksRUFBRSxRQUFRLENBQUMsTUFBTSxnQkFBZ0I7QUFDdEQsVUFBSSxlQUFlLFlBQVk7QUFDM0IsWUFBSTtBQUFPLHFCQUFXLEtBQUssSUFBSTtBQUMvQixlQUFPLFFBQVEsY0FBYyxFQUFFLFFBQVEsQ0FBQyxDQUFDLFdBQVcsYUFBYTtBQUM3RCxnQkFBTSxVQUFVLEdBQUcsWUFBWSxNQUFNLEtBQUssU0FBUyxPQUFPLEtBQUssZUFBZSxRQUFRO0FBQ3RGLHFCQUFXLEtBQUssT0FBTztBQUFBLFFBQzNCLENBQUM7QUFDRCxZQUFJLENBQUM7QUFBTyxxQkFBVyxLQUFLLElBQUk7QUFBQSxNQUNwQyxPQUFPO0FBQ0gsbUJBQVcsS0FBSyxJQUFJO0FBQUEsTUFDeEI7QUFBQSxJQUNKLENBQUM7QUFFRCxVQUFNLHlCQUF5QixDQUFDLFNBQW1CLFdBQW1CLFlBQW9DO0FBQ3RHLGFBQU8sUUFBUSxJQUFJLENBQUMsTUFBTSxNQUFNO0FBdE54QztBQXVOWSxjQUFNLGVBQWUsV0FBVyxRQUFRLEtBQUs7QUFDN0MsWUFBSSxjQUFjLFdBQVcsSUFBSTtBQUNqQyxjQUFNLGlCQUFnQixJQUFJLE9BQU8sSUFBSSxpQkFBaUIsU0FBUyx1QkFBdUIsR0FBRztBQUN6RixjQUFNLEtBQUssWUFBWSxNQUFNLGNBQWE7QUFDMUMsWUFBSSwwQkFBSSxXQUFVLE9BQU8sS0FBSyxHQUFHLE1BQU0sRUFBRSxNQUFNLE9BQUssZ0JBQWdCLFNBQVMsQ0FBQyxDQUFDLEdBQUc7QUFFOUUsZ0JBQU0sUUFBUSxjQUFPLFdBQVcsWUFBWSxJQUFJLEtBQUssSUFBSSxNQUEzQyxvQkFBOEMsS0FBSyxPQUFLLEVBQUUsU0FBUztBQUNqRixjQUFJLGdDQUFPLFVBQVMsdUJBQWtCO0FBQ2xDLGtCQUFNLFNBQVMsY0FBYyxRQUFRLE1BQU0sQ0FBQztBQUM1QyxnQkFBSSxRQUFRO0FBQ1Isb0JBQU0sRUFBRSxlQUFPLGNBQVE7QUFDdkIsdUJBQVMsSUFBSSxTQUFRLEdBQUcsSUFBSSxTQUFTLFNBQVEsc0JBQXNCLEtBQUssS0FBSyxJQUFJLE9BQU0sR0FBRyxLQUFLO0FBQzNGLDZCQUFhLEtBQUssQ0FBQztBQUFBLGNBQ3ZCO0FBQUEsWUFDSjtBQUFBLFVBQ0o7QUFDQSxnQkFBTSxFQUFFLFFBQVEsU0FBUyxXQUFXLFlBQVksVUFBVSx1QkFBdUIsc0JBQXNCLFdBQVcsR0FBRztBQUNySCxnQkFBTSxhQUFhLFFBQVEsUUFBUSxRQUFRLE1BQU0sUUFBUSxZQUFZLEdBQUcsRUFBRSxNQUFNLEdBQUcsRUFBRSxLQUFLLElBQUksQ0FBQztBQUMvRixjQUFJO0FBQ0osY0FBSSxjQUFjO0FBQ2xCLGNBQUkscUJBQXFCO0FBQ3pCLGNBQUksZ0NBQU8sVUFBUyx5QkFBb0IsQUFBTyxzQkFBc0IsU0FBUywrQkFBTyxRQUFRLFVBQXlCLEdBQUc7QUFFckgsaUNBQXFCLFFBQVEsSUFBSyxTQUFRLHNCQUFzQixLQUFLLE9BQU8sS0FBSyxPQUFPO0FBQ3hGLHVCQUFXLFdBQVcsV0FBVyxJQUFJLFNBQVMsV0FBVyxLQUFLLEdBQUcsV0FBVyxTQUFTLElBQUksT0FBTyxLQUFLLFdBQVcsSUFBSSxVQUFRLE9BQU8sSUFBSSxFQUFFLEtBQUssSUFBSTtBQUdsSiwwQkFBYyxtQkFBbUIsTUFBTSxnQkFBZ0IsUUFBUTtBQUFBLFVBQ25FLE9BQU87QUFDSCx1QkFBVyxXQUFXLFVBQVUsSUFBSSxXQUFXLEtBQUssR0FBRyxXQUFXLEtBQUssSUFBSTtBQUFBLFVBQy9FO0FBQ0EsaUJBQU8sR0FBRyxXQUFXLEtBQUssVUFBVSxLQUFLLGFBQWEsS0FBSyxhQUFhLFlBQVksV0FBVywwQkFBMEIsd0JBQXdCLE1BQU0sY0FBYyxXQUFXO0FBQUEsUUFDcEwsT0FBTztBQUNILGdCQUFNLFlBQTRCLENBQUM7QUFDbkMsZ0JBQU0sMkJBQTBCLElBQUksT0FBTyxNQUFNLGlCQUFpQixTQUFTLDJCQUEyQixJQUFJO0FBQzFHLGdCQUFNLHNCQUFxQixJQUFJLE9BQU8sTUFBTSxpQkFBaUIsU0FBUywyQkFBMkIsSUFBSTtBQUNyRyxvQkFBVSxLQUFLLEdBQUcsa0JBQWtCLDBCQUF5QixhQUFhLFdBQVcsY0FBYyx5QkFBaUIsQ0FBQztBQUNySCxvQkFBVSxLQUFLLEdBQUcsa0JBQWtCLHFCQUFvQixhQUFhLFdBQVcsY0FBYywrQkFBb0IsQ0FBQztBQUNuSCxvQkFBVSxRQUFRLFdBQVM7QUFDdkIsa0JBQU0sYUFBYSxJQUFJLE9BQU8sTUFBTSxTQUFTLFFBQVEsdUJBQXVCLE1BQU0sR0FBRyxHQUFHO0FBQ3hGLDBCQUFjLFlBQVksUUFBUSxZQUFZLE1BQU0sUUFBUTtBQUFBLFVBQ2hFLENBQUM7QUFDRCxpQkFBTyxXQUFXLFdBQVc7QUFBQSxRQUNqQztBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0w7QUFHQSxXQUFPLFFBQVEsY0FBYyxFQUFFLFFBQVEsQ0FBQyxDQUFDLFdBQVcsYUFBYTtBQUM3RCxtQkFBYSx1QkFBdUIsWUFBWSxXQUFXLE9BQU87QUFBQSxJQUN0RSxDQUFDO0FBR0QsVUFBTSxjQUFjLFdBQVcsT0FBTyxDQUFDLE1BQU0sTUFBTSxDQUFDLGFBQWEsU0FBUyxDQUFDLENBQUMsRUFBRSxLQUFLLElBQUk7QUFDdkYsVUFBTSxPQUFPLElBQUksTUFBTSxPQUFPLE1BQU0sV0FBVztBQUUvQyxVQUFNLFNBQVMsYUFBTyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZLE1BQXJELG1CQUF3RDtBQUN2RSxRQUFJLFFBQVE7QUFDUixZQUFNLGNBQWEsT0FBTyxVQUFVLEVBQUU7QUFDdEMsYUFBTyxVQUFVLEVBQUUsTUFBTSxPQUFPLFVBQVUsRUFBRSxNQUFNLElBQUksT0FBTyxRQUFRLFdBQVUsRUFBRSxPQUFPLENBQUM7QUFBQSxJQUM3RjtBQUFBLEVBQ0o7QUFBQTtBQUdBLG9CQUNJLFFBQ0EsU0FDQSxnQkFDQSxZQUNBLFFBQWlCLE1BQ2pCLFNBQWtCLE9BQ2xCLFlBQXFCLE9BQ1I7QUFBQTtBQS9SakI7QUFnU0ksVUFBTSxPQUFPLHNCQUFzQixRQUFRLGNBQWM7QUFDekQsVUFBTSxjQUFjLGFBQU8sSUFBSSxjQUFjLGFBQWEsSUFBSSxNQUExQyxtQkFBNkM7QUFDakUsVUFBTSxFQUFFLFVBQVUsRUFBRSxlQUFPLGdCQUFVLGNBQWMsY0FBYyxFQUFFLFVBQVUsRUFBRSxPQUFPLFFBQVcsS0FBSyxPQUFVLEVBQUU7QUFDbEgsVUFBTSxRQUFRLGFBQU8sSUFBSSxRQUFRLFFBQVEsYUFBM0IsbUJBQXFDO0FBQ25ELFVBQU0sZ0JBQWdCLENBQUMsQ0FBRSxnQkFBZSxNQUFPLGNBQWMsVUFBUyxRQUFPLGNBQWMsT0FBTSxRQUFRLGNBQWMsS0FBSTtBQUMzSCxVQUFNLGlCQUErQyxDQUFDO0FBQ3RELFVBQU0saUJBQStDLENBQUM7QUFDdEQsVUFBTSxTQUF1QyxDQUFDO0FBQzlDLFlBQVEsUUFBUSxDQUFNLFNBQVE7QUF4U2xDO0FBeVNRLFlBQU0sU0FBUyxDQUFDLFlBQVksTUFBTSxLQUFLLEtBQUssSUFBSSxDQUFDLEVBQUUsU0FBUyxLQUFLLElBQUk7QUFDckUsVUFBSSxRQUFRO0FBQ1IsWUFBSSxDQUFDLGNBQWMsZUFBZTtBQUM5QixpQkFBTyxLQUFLLFFBQVEsS0FBSztBQUFBLFFBQzdCLE9BQU87QUFDSCx5QkFBZSxLQUFLLFFBQVEsS0FBSztBQUFBLFFBQ3JDO0FBQUEsTUFDSixPQUFPO0FBQ0gsY0FBTSxRQUFRLGNBQU8sSUFBSSxRQUFRLFFBQVEsYUFBM0Isb0JBQXFDO0FBQ25ELGNBQU0sZUFBZSxTQUFTLGNBQU0sS0FBSyxLQUFLLElBQUksTUFBcEIsb0JBQXdCLEtBQUs7QUFDM0QsY0FBTSxRQUFRLGFBQU8sV0FBVyxZQUFZLElBQUksS0FBSyxJQUFJLE1BQTNDLG1CQUE4QyxLQUFLLE9BQUssRUFBRSxTQUFTLEtBQUs7QUFDdEYsY0FBTSxRQUFRLFNBQVMsV0FBVyxTQUFTLE1BQU0sSUFBSTtBQUNyRCxjQUFNLFdBQVcsZ0JBQ1YsS0FBSyxRQUFRLHNCQUNaLFVBQVMsd0JBQXdCLFNBQVMsS0FBSyxJQUFJLEtBQ3ZELEdBQUcsaUJBQWlCLEtBQUssUUFBUSxVQUNqQyxLQUFLLFFBQVE7QUFDakIsYUFBSyxRQUFRLFFBQVE7QUFDckIsWUFBSSxlQUFlLE9BQU8sS0FBSyxXQUFXLEVBQUUsU0FBUyxLQUFLLElBQUksR0FBRztBQUM3RCxpQkFBTyxLQUFLLFFBQVEsS0FBSztBQUFBLFFBQzdCLE9BQU87QUFDSCx5QkFBZSxLQUFLLFFBQVEsS0FBSztBQUFBLFFBQ3JDO0FBQUEsTUFDSjtBQUFBLElBQ0osRUFBQztBQUNELFlBQVEsSUFBSSxRQUFRLGdCQUFnQixjQUFjO0FBQ2xELFFBQUksT0FBTyxLQUFLLE1BQU0sRUFBRTtBQUFRLFlBQU0sT0FBTyxnQkFDeEMsU0FBUyxNQUFNO0FBQUUseUJBQWlCLFFBQVEsTUFBTSxNQUFNO0FBQUEsTUFBRSxDQUFDO0FBQzlELFFBQUksT0FBTyxLQUFLLGNBQWMsRUFBRSxVQUFVLE9BQU8sS0FBSyxjQUFjLEVBQUU7QUFBUSxZQUFNLE9BQU8sZ0JBQ3RGLFNBQVMsTUFBTTtBQUFFLHlCQUFpQixRQUFRLE1BQU0sZ0JBQWdCLGdCQUFnQixZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQUEsTUFBRSxDQUFDO0FBQUEsRUFDaEk7QUFBQTs7O0FNdFVBLHVCQUF1QztBQUV2QyxJQUFxQixZQUFyQixjQUF1Qyx1QkFBTTtBQUFBLEVBQ3pDLFlBQ1csUUFDVDtBQUNFLFVBQU0sT0FBTyxHQUFHO0FBRlQ7QUFBQSxFQUdYO0FBQUEsRUFDQSxTQUFlO0FBQ1gsU0FBSyxZQUFZLFlBQVksQ0FBTyxNQUFNO0FBQ3RDLFVBQUksRUFBRSxPQUFPLFNBQVM7QUFDbEIsVUFBRSxlQUFlO0FBQ2pCLGNBQU0sS0FBSyxLQUFLO0FBQUEsTUFDcEI7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBYSxLQUFLLEdBQTBCO0FBQUE7QUFFeEMsWUFBTSxNQUFNLHlDQUF5QztBQUFBLElBQ3pEO0FBQUE7QUFBQSxFQUVBLEFBQU8sYUFBYSxnQkFBZ0M7QUFDaEQsbUJBQWUsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQzFDLFVBQU0sVUFBVSxJQUFJLGlDQUFnQixjQUFjO0FBQ2xELFlBQVEsUUFBUSxXQUFXO0FBQzNCLFlBQVEsUUFBUSxDQUFPLE1BQWE7QUFDaEMsWUFBTSxLQUFLLEtBQUssQ0FBQztBQUFBLElBQ3JCLEVBQUM7QUFBQSxFQUNMO0FBQ0o7OztBUHpCQSxJQUFxQixhQUFyQixjQUF3QyxVQUFVO0FBQUEsRUFLOUMsWUFDVyxRQUNDLE1BQ0EsT0FDQSxPQUNBLGFBQXFCLElBQ3JCLFFBQWlCLE9BQ2pCLFNBQWtCLE9BQ2xCLFlBQXFCLE9BQy9CO0FBQUUsVUFBTSxNQUFNO0FBUkw7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpaLFNBQVEsaUJBQXlDLENBQUM7QUFBQSxFQWEvQjtBQUFBLEVBRW5CLFNBQVM7QUFDTCxVQUFNLE9BQU87QUFDYixRQUFJLEtBQUssTUFBTSxRQUFRLFVBQVU7QUFDN0IsWUFBTSxxQkFBcUIsSUFBSSxPQUFPLGtDQUFrQyxJQUFJO0FBQzVFLFlBQU0sS0FBSyxLQUFLLE1BQU0sUUFBUSxTQUFTLFNBQVMsa0JBQWtCO0FBQ2xFLFVBQUksT0FBTyxHQUFHLEtBQUs7QUFDbkIsYUFBTyxDQUFDLEtBQUssTUFBTTtBQUNmLFlBQUksS0FBSyxNQUFNLFFBQVE7QUFDbkIsZ0JBQU0sUUFBUSxLQUFLLE1BQU0sT0FBTztBQUNoQyxnQkFBTSxDQUFDLE1BQU0saUJBQWlCLE1BQU0sTUFBTSxXQUFDLFNBQU0sR0FBQyxHQUFFLElBQUksQ0FBQyxNQUFjLEVBQUUsS0FBSyxDQUFDO0FBQy9FLGVBQUssZUFBZSxRQUFRO0FBQzVCLGNBQUksZUFBZTtBQUNmLGtCQUFNLFdBQVUsS0FBSyxNQUFNLGFBQWE7QUFDeEMsaUJBQUssd0JBQXdCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQyxHQUFHLE1BQU0sUUFBTztBQUFBLFVBQ3BHLE9BQU87QUFDSCxpQkFBSyx1QkFBdUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDLEdBQUcsSUFBSTtBQUFBLFVBQzFGO0FBQUEsUUFDSjtBQUNBLGVBQU8sR0FBRyxLQUFLO0FBQUEsTUFDbkI7QUFDQSxXQUFLLFVBQVUsVUFBVSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDbkQsV0FBSyxtQkFBbUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDLENBQUM7QUFBQSxJQUNoRixPQUFPO0FBQ0gsV0FBSyxhQUFhLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQyxDQUFDO0FBQUEsSUFDMUU7QUFDQSxTQUFLLGFBQWEsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDLENBQUM7QUFDckUsU0FBSyxZQUFZLFNBQVMsZUFBZTtBQUFBLEVBQzdDO0FBQUEsRUFFQSxBQUFRLGNBQWM7QUFDbEIsUUFBSSxpQkFBaUIsS0FBSyxNQUFNLFFBQVEsU0FBUyxNQUFNO0FBQ3ZELFdBQU8sS0FBSyxLQUFLLGNBQWMsRUFBRSxRQUFRLE9BQUs7QUFDMUMsWUFBTSxhQUFhLElBQUksT0FBTyxTQUFTLEVBQUUsUUFBUSx1QkFBdUIsTUFBTSxzQkFBc0IsR0FBRztBQUN2Ryx1QkFBaUIsZUFBZSxRQUFRLFlBQVksS0FBSyxlQUFlLEVBQUU7QUFBQSxJQUM5RSxDQUFDO0FBRUQsU0FBSyxjQUFjLFNBQVMsY0FBYztBQUMxQyxTQUFLLFdBQVc7QUFBQSxFQUNwQjtBQUFBLEVBRUEsQUFBUSx1QkFBdUIsZ0JBQWdDLE1BQWM7QUFDekUsbUJBQWUsVUFBVSxFQUFFLEtBQUssU0FBUyxNQUFNLEtBQUssQ0FBQztBQUNyRCxVQUFNLFFBQVEsSUFBSSwrQkFBYyxjQUFjO0FBQzlDLFVBQU0sUUFBUSxTQUFTLFlBQVk7QUFDbkMsVUFBTSxRQUFRLFNBQVMsWUFBWTtBQUNuQyxVQUFNLGVBQWUscUJBQXFCLE1BQU07QUFDaEQsVUFBTSxTQUFTLFdBQVM7QUFDcEIsV0FBSyxlQUFlLFFBQVE7QUFDNUIsV0FBSyxZQUFZO0FBQUEsSUFDckIsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQVEsd0JBQXdCLGdCQUFnQyxNQUFjLFVBQW1CO0FBQzdGLG1CQUFlLFVBQVUsRUFBRSxNQUFNLE1BQU0sS0FBSyxRQUFRLENBQUM7QUFDckQsbUJBQWUsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQzFDLFVBQU0sV0FBVyxJQUFJLG1DQUFrQixjQUFjO0FBQ3JELGFBQVMsVUFBVSxJQUFJLFlBQVk7QUFDbkMsYUFBUSxRQUFRLE9BQUssU0FBUyxVQUFVLEdBQUcsQ0FBQyxDQUFDO0FBQzdDLGFBQVMsU0FBUyxXQUFTO0FBQ3ZCLFdBQUssZUFBZSxRQUFRO0FBQzVCLFdBQUssWUFBWTtBQUFBLElBQ3JCLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLG1CQUFtQixnQkFBZ0M7QUFDdkQsU0FBSyxnQkFBZ0IsSUFBSSxtQ0FBa0IsY0FBYztBQUN6RCxTQUFLLGNBQWMsUUFBUSxTQUFTLFlBQVk7QUFDaEQsU0FBSyxjQUFjLFFBQVEsT0FBTztBQUNsQyxTQUFLLGNBQWMsU0FBUyxLQUFLLEtBQUs7QUFBQSxFQUMxQztBQUFBLEVBRUEsQUFBUSxhQUFhLFdBQWlDO0FBQ2xELFVBQU0sVUFBVSxJQUFJLG1DQUFrQixTQUFTO0FBQy9DLFlBQVEsUUFBUSxPQUFPO0FBQ3ZCLFlBQVEsUUFBUSxNQUFNO0FBQ3RCLFlBQVEsUUFBUSxTQUFTLFlBQVk7QUFDckMsWUFBUSxTQUFTLEdBQUcsS0FBSyxTQUFTLElBQUk7QUFDdEMsWUFBUSxTQUFTLFdBQVMsS0FBSyxXQUFXLEtBQUs7QUFBQSxFQUNuRDtBQUFBLEVBRUEsQUFBYSxPQUFzQjtBQUFBO0FBQy9CLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxNQUFNLE1BQU0sU0FBUyxFQUFFLE9BQU8sS0FBSyxTQUFTLEVBQUUsQ0FBQyxHQUFHLEtBQUssTUFBTSxLQUFLLFlBQVksS0FBSyxPQUFPLEtBQUssUUFBUSxLQUFLLFNBQVM7QUFDakssV0FBSyxNQUFNO0FBQUEsSUFDZjtBQUFBO0FBQ0o7OztBUXpHQSx1QkFBMkM7OztBQ0EzQyx1QkFBOEQ7OztBQ0Q5RCx1QkFBNkQ7QUFJN0QsSUFBcUIsbUJBQXJCLGNBQThDLHVCQUFNO0FBQUEsRUFFaEQsWUFDWSxRQUNBLFlBQ0EsTUFDQSxPQUNWO0FBQ0UsVUFBTSxPQUFPLEdBQUc7QUFMUjtBQUNBO0FBQ0E7QUFDQTtBQUdSLFNBQUssWUFBWSxTQUFTLGVBQWU7QUFBQSxFQUM3QztBQUFBLEVBRUEsU0FBUztBQUNMLFNBQUssUUFBUSxRQUFRLGtCQUFrQjtBQUN2QyxVQUFNLGdCQUFnQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDekUsa0JBQWMsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLEtBQUssUUFBUSxDQUFDO0FBQzlELFVBQU0sWUFBWSxJQUFJLCtCQUFjLGFBQWE7QUFDakQsY0FBVSxRQUFRLFNBQVMsWUFBWTtBQUN2QyxjQUFVLFFBQVEsU0FBUyxZQUFZO0FBQ3ZDLFVBQU0saUJBQWlCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUMxRSxtQkFBZSxVQUFVLEVBQUUsTUFBTSxpQkFBaUIsS0FBSyxRQUFRLENBQUM7QUFDaEUsVUFBTSxhQUFhLElBQUksK0JBQWMsY0FBYztBQUNuRCxlQUFXLFFBQVEsU0FBUyxZQUFZO0FBQ3hDLGVBQVcsUUFBUSxTQUFTLFlBQVk7QUFDeEMsVUFBTSxnQkFBZ0IsS0FBSyxVQUFVLFVBQVU7QUFBQSxNQUMzQyxLQUFLO0FBQUEsSUFDVCxDQUFDO0FBQ0Qsa0JBQWMsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQ3pDLFVBQU0sYUFBYSxJQUFJLGlDQUFnQixhQUFhO0FBQ3BELGVBQVcsUUFBUSxXQUFXO0FBQzlCLGVBQVcsUUFBUSxNQUFZO0FBQzNCLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sVUFBVSxTQUFTLEdBQUcsU0FBUyxFQUFFLE9BQU8sV0FBVyxTQUFTLEVBQUUsRUFBRSxDQUFDLEdBQUcsS0FBSyxNQUFNLEtBQUssWUFBWSxLQUFLLEtBQUs7QUFDakosV0FBSyxNQUFNO0FBQUEsSUFDZixFQUFDO0FBQ0QsVUFBTSxlQUFlLElBQUksaUNBQWdCLGFBQWE7QUFDdEQsaUJBQWEsUUFBUSxPQUFPO0FBQzVCLGlCQUFhLFFBQVEsTUFBTTtBQUN2QixXQUFLLE1BQU07QUFBQSxJQUNmLENBQUM7QUFBQSxFQUNMO0FBQ0o7OztBRGhDQSxJQUFxQiwwQkFBckIsY0FBcUQsbUNBQTBCO0FBQUEsRUFFM0UsWUFDWSxRQUNBLE1BQ0EsWUFDQSxPQUNWO0FBQ0UsVUFBTSxPQUFPLEdBQUc7QUFMUjtBQUNBO0FBQ0E7QUFDQTtBQUdSLFNBQUssWUFBWSxTQUFTLGVBQWU7QUFBQSxFQUM3QztBQUFBLEVBRUEsV0FBcUI7QUF4QnpCO0FBeUJRLFdBQU8sQ0FBQyxFQUFFLGFBQWEsVUFBVSxDQUFDLEVBQzdCLE9BQU8sWUFBSyxPQUFPLFdBQVcsWUFDMUIsSUFBSSxLQUFLLEtBQUssSUFBSSxNQURmLG1CQUNrQixJQUFJLFdBQVM7QUFDL0IsYUFBTyxFQUFFLGFBQWEsTUFBTSxNQUFNLE1BQU0sTUFBTSxLQUFLO0FBQUEsSUFDdkQsT0FBTSxDQUFDLENBQ1g7QUFBQSxFQUNSO0FBQUEsRUFFQSxZQUFZLE1BQXNCO0FBQzlCLFdBQU8sS0FBSztBQUFBLEVBQ2hCO0FBQUEsRUFFQSxpQkFBaUIsTUFBMEIsSUFBdUI7QUFDOUQsT0FBRyxTQUFTLGlCQUFpQjtBQUM3QixVQUFNLGdCQUFnQixHQUFHLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQzVELFNBQUssS0FBSyxPQUFPLDhCQUFRLGVBQWUsVUFBVSxLQUFLLEtBQUssS0FBSyxJQUFJLDhCQUFRLGVBQWUsa0JBQWtCO0FBQzlHLE9BQUcsVUFBVSxFQUFFLE1BQU0sS0FBSyxLQUFLLFlBQVksQ0FBQztBQUM1QyxPQUFHLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUM5QixRQUFJLEtBQUssS0FBSztBQUFNLFNBQUcsVUFBVSxFQUFFLEtBQUssUUFBUSxrQkFBa0IsS0FBSyxLQUFLLFNBQVMsTUFBTSxLQUFLLEtBQUssS0FBSyxDQUFDO0FBQUEsRUFDL0c7QUFBQSxFQUVBLGFBQWEsTUFBYyxLQUF1QztBQTlDdEU7QUErQ1EsUUFBSSxLQUFLLGdCQUFnQixXQUFXO0FBQ2hDLFlBQU0sZ0JBQWdCLElBQUksaUJBQWlCLEtBQUssUUFBUSxLQUFLLFlBQVksS0FBSyxNQUFNLEtBQUssS0FBSztBQUM5RixvQkFBYyxLQUFLO0FBQ25CLFdBQUssTUFBTTtBQUFBLElBQ2YsT0FBTztBQUNILFlBQU0sUUFBUSxXQUFLLE9BQU8sV0FBVyxZQUFZLElBQUksS0FBSyxLQUFLLElBQUksTUFBckQsbUJBQXdELEtBQUssWUFBUyxPQUFNLFNBQVMsS0FBSztBQUN4RyxVQUFJLE9BQU87QUFDUCxjQUFNLGVBQWUsSUFBSSxhQUFhLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSztBQUNwRSxxQkFBYSx3QkFBd0IsS0FBSyxNQUFNLEtBQUssYUFBYSxJQUFJLEtBQUssWUFBWSxLQUFLLE9BQU8sT0FBTyxLQUFLO0FBQUEsTUFDbkg7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNKOzs7QUUxREEsdUJBQThIOzs7QUNTOUgsSUFBTSxRQUFOLE1BQVk7QUFBQSxFQUVSLFlBQ1csT0FBZSxJQUNmLFdBQStCLENBQUMsR0FDaEMsS0FBYSxJQUNiLE9BQWtCLHFCQUNsQixlQUNBLFNBQ0EsU0FDVDtBQVBTO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUEsRUFDUDtBQUFBLEVBRUosQUFBTyxXQUFXLFFBQXdDO0FBQ3RELFdBQU8sS0FBSyxXQUFXLE9BQU8sU0FBUztBQUFBLEVBQzNDO0FBQUEsRUFFQSxPQUFPLGFBQWEsUUFBZSxRQUFlO0FBQzlDLFdBQU8sS0FBSyxPQUFPO0FBQ25CLFdBQU8sT0FBTyxPQUFPO0FBQ3JCLFdBQU8sT0FBTyxPQUFPO0FBQ3JCLFdBQU8sS0FBSyxPQUFPLE9BQU8sRUFBRSxRQUFRLE9BQUs7QUFDckMsYUFBTyxRQUFRLEtBQUssT0FBTyxRQUFRO0FBQUEsSUFDdkMsQ0FBQztBQUNELFdBQU8sS0FBSyxPQUFPLE9BQU8sRUFBRSxRQUFRLE9BQUs7QUFDckMsVUFBSSxDQUFDLE9BQU8sS0FBSyxPQUFPLE9BQU8sRUFBRSxTQUFTLENBQUMsR0FBRztBQUMxQyxlQUFPLE9BQU8sUUFBUTtBQUFBLE1BQzFCO0FBQUM7QUFBQSxJQUNMLENBQUM7QUFDRCxXQUFPLFVBQVUsT0FBTztBQUN4QixXQUFPLFVBQVUsT0FBTztBQUFBLEVBQzVCO0FBQUEsRUFFQSxPQUFjLGNBQWMsTUFBcUI7QUFDN0MsVUFBTSxRQUFRLElBQUksTUFBTTtBQUN4QixVQUFNLE9BQU87QUFDYixVQUFNLE9BQU87QUFDYixXQUFPO0FBQUEsRUFDWDtBQUNKO0FBRUEsSUFBTyxnQkFBUTs7O0FDbERmLHVCQUErQjtBQU8vQixJQUFxQixlQUFyQixjQUEwQyx5QkFBUTtBQUFBLEVBSzlDLFlBQ1ksYUFDRCxPQUNDLFFBQ1Y7QUFDRSxVQUFNLFdBQVc7QUFKVDtBQUNEO0FBQ0M7QUFHUixTQUFLLHVCQUF1QjtBQUM1QixTQUFLLGNBQWM7QUFDbkIsU0FBSyxnQkFBZ0I7QUFDckIsU0FBSyxVQUFVLFNBQVMsV0FBVztBQUFBLEVBQ3ZDO0FBQUEsRUFFQSxBQUFPLHlCQUErQjtBQUVsQyxVQUFNLFVBQVUsSUFBSSxhQUFhLEtBQUssTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLLEtBQUs7QUFDekUsU0FBSyxPQUFPLGNBQWM7QUFDMUIsU0FBSyxPQUFPLFNBQVMsY0FBYztBQUNuQyxTQUFLLHFCQUFxQixLQUFLLE9BQU8sU0FBUyxPQUFPLE1BQU07QUFDNUQsU0FBSyxtQkFBbUIsUUFBUSxLQUFLLE1BQU0sSUFBSTtBQUMvQyxTQUFLLGdCQUFnQixLQUFLLE9BQU8sU0FBUyxLQUFLO0FBQy9DLFNBQUssY0FBYyxRQUFRLFNBQVMsUUFBUSxrQkFBa0IsS0FBSyxNQUFNLE9BQU87QUFDaEYsU0FBSyxjQUFjLFFBQVEsS0FBSyxNQUFNLElBQUk7QUFDMUMsU0FBSyx3QkFBd0IsS0FBSyxPQUFPLFNBQVMsS0FBSztBQUN2RCxTQUFLLHNCQUFzQixRQUFRLEdBQUcsUUFBUSxjQUFjLEdBQUc7QUFBQSxFQUNuRTtBQUFBLEVBRUEsQUFBUSxnQkFBc0I7QUFDMUIsU0FBSyxVQUFVLENBQUMsTUFBTTtBQUNsQixRQUFFLFFBQVEsUUFBUSxFQUNiLFdBQVcsTUFBTSxFQUNqQixRQUFRLE1BQU07QUFDWCxZQUFJLFFBQVEsSUFBSSxtQkFBbUIsS0FBSyxRQUFRLEtBQUssYUFBYSxNQUFNLEtBQUssS0FBSztBQUNsRixjQUFNLEtBQUs7QUFBQSxNQUNmLENBQUM7QUFBQSxJQUNULENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLGtCQUF3QjtBQUM1QixTQUFLLFVBQVUsQ0FBQyxNQUFNO0FBQ2xCLFFBQUUsUUFBUSxPQUFPLEVBQ1osV0FBVyxRQUFRLEVBQ25CLFFBQVEsTUFBTTtBQXJEL0I7QUFzRG9CLGNBQU0sMEJBQTBCLEtBQUssT0FBTyxrQkFBa0IsT0FBTyxPQUFLLEVBQUUsTUFBTSxLQUFLLE1BQU0sRUFBRSxFQUFFO0FBQ2pHLFlBQUkseUJBQXlCO0FBQ3pCLGVBQUssT0FBTyxrQkFBa0IsT0FBTyx1QkFBdUI7QUFBQSxRQUNoRTtBQUFDO0FBQ0QsbUJBQUssVUFBVSxrQkFBZixtQkFBOEIsWUFBWSxLQUFLO0FBQy9DLGFBQUssT0FBTyxhQUFhO0FBQUEsTUFDN0IsQ0FBQztBQUFBLElBQ1QsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLE9BQW9CLHNCQUFzQixRQUFzQixVQUFxQztBQUFBO0FBQ2pHLFVBQUksU0FBd0IsQ0FBQztBQUM3QixZQUFNLE9BQU8sT0FBTyxJQUFJLE1BQU0sc0JBQXNCLFFBQVE7QUFDNUQsVUFBSSxnQkFBZ0IsMEJBQVMsS0FBSyxhQUFhLE1BQU07QUFDakQsY0FBTSxTQUFTLE1BQU0sT0FBTyxJQUFJLE1BQU0sS0FBSyxJQUFJO0FBQy9DLGVBQU8sTUFBTSxJQUFJLEVBQUUsUUFBUSxVQUFRO0FBQy9CLGNBQUksU0FBUyxLQUFLLElBQUksR0FBRztBQUNyQixtQkFBTyxLQUFLLEtBQUssS0FBSyxDQUFDO0FBQUEsVUFDM0I7QUFBQztBQUFBLFFBQ0wsQ0FBQztBQUNELGVBQU87QUFBQSxNQUNYLE9BQU87QUFDSCxlQUFPLENBQUM7QUFBQSxNQUNaO0FBQUM7QUFBQSxJQUNMO0FBQUE7QUFDSjs7O0FGeEVBLElBQXFCLHFCQUFyQixjQUFnRCx1QkFBTTtBQUFBLEVBZWxELFlBQ1ksUUFDQSx3QkFDQSxlQUNSLE9BQ0Y7QUFDRSxVQUFNLE9BQU8sR0FBRztBQUxSO0FBQ0E7QUFDQTtBQWhCWixTQUFRLFFBQWlCO0FBR3pCLFNBQVEsTUFBZTtBQWlCbkIsU0FBSyxlQUFlLElBQUksY0FBTTtBQUM5QixRQUFJLE9BQU87QUFDUCxXQUFLLE1BQU07QUFDWCxXQUFLLFFBQVE7QUFDYixvQkFBTSxhQUFhLEtBQUssY0FBYyxLQUFLLEtBQUs7QUFBQSxJQUNwRCxPQUFPO0FBQ0gsVUFBSSxRQUFRO0FBQ1osV0FBSyxPQUFPLGtCQUFrQixRQUFRLFVBQVE7QUFDMUMsWUFBSSxTQUFTLEtBQUssRUFBRSxLQUFLLFNBQVMsS0FBSyxFQUFFLEtBQUssT0FBTztBQUNqRCxrQkFBUSxTQUFTLEtBQUssRUFBRSxJQUFJO0FBQUEsUUFDaEM7QUFBQztBQUFBLE1BQ0wsQ0FBQztBQUNELFdBQUssUUFBUSxJQUFJLGNBQU07QUFDdkIsV0FBSyxNQUFNLEtBQUssTUFBTSxTQUFTO0FBQy9CLFdBQUssYUFBYSxLQUFLLE1BQU0sU0FBUztBQUFBLElBQzFDO0FBQUM7QUFDRCxTQUFLLGVBQWUsSUFBSSxhQUFhLEtBQUssTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLLEtBQUs7QUFDN0UsU0FBSyxhQUFhLEtBQUssTUFBTSxZQUFZO0FBQ3pDLFNBQUssVUFBVSxLQUFLLE1BQU0sV0FBVztBQUFBLE1BQ2pDLElBQUksS0FBSyxRQUFRLFdBQVcsS0FBSyxNQUFNLGlCQUFpQixrQkFBa0IsS0FBSyxNQUFNLFNBQVM7QUFBQSxNQUM5RixNQUFNO0FBQUEsTUFDTixPQUFPLEtBQUssUUFBUSxVQUFVLEtBQUssTUFBTSxlQUFlO0FBQUEsTUFDeEQsUUFBUTtBQUFBLElBQ1o7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFNLFNBQXdCO0FBQUE7QUFDMUIsV0FBSyxZQUFZLFNBQVMsZUFBZTtBQUN6QyxVQUFJLEtBQUssTUFBTSxRQUFRLElBQUk7QUFDdkIsYUFBSyxRQUFRLFFBQVEsZ0NBQWdDO0FBQUEsTUFDekQsT0FBTztBQUNILGFBQUssUUFBUSxRQUFRLCtCQUErQixLQUFLLE1BQU0sTUFBTTtBQUFBLE1BQ3pFO0FBQUM7QUFHRCxXQUFLLHlCQUF5QjtBQUM5QixXQUFLLFVBQVUsU0FBUyxJQUFJO0FBRzVCLFdBQUssdUJBQXVCO0FBRzVCLFdBQUssc0NBQXNDO0FBRzNDLFlBQU0sc0JBQXNCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUMvRSxXQUFLLFVBQVUsU0FBUyxJQUFJO0FBRzVCLFdBQUssd0JBQXdCLEtBQUssVUFBVSxVQUFVO0FBR3RELFlBQU0sU0FBUyxLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssaUJBQWlCLENBQUM7QUFDakUsYUFBTyxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDbEMsV0FBSyxpQkFBaUIsTUFBTTtBQUM1QixXQUFLLG1CQUFtQixNQUFNO0FBRzlCLFdBQUssNEJBQTRCLG1CQUFtQjtBQUNwRCxXQUFLLGFBQWEsdUJBQXVCLEtBQUssdUJBQXVCLEtBQUssUUFBUSxzQkFBOEI7QUFBQSxJQUNwSDtBQUFBO0FBQUEsRUFFQSxVQUFnQjtBQUNaLFdBQU8sT0FBTyxLQUFLLE9BQU8sS0FBSyxZQUFZO0FBQzNDLFFBQUksQ0FBQyxLQUFLLE9BQU8sS0FBSyxlQUFlO0FBQ2pDLFdBQUssY0FBYyx1QkFBdUI7QUFBQSxJQUM5QyxXQUFXLEtBQUssT0FBTztBQUNuQixVQUFJLGFBQWEsS0FBSyx3QkFBd0IsS0FBSyxPQUFPLEtBQUssTUFBTTtBQUFBLElBQ3pFO0FBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLDJCQUFpQztBQUNyQyxVQUFNLFlBQVksS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ3JFLGNBQVUsVUFBVSxFQUFFLEtBQUssU0FBUyxNQUFNLGVBQWUsQ0FBQztBQUMxRCxVQUFNLFFBQVEsSUFBSSwrQkFBYyxTQUFTO0FBQ3pDLFVBQU0sUUFBUSxTQUFTLFlBQVk7QUFDbkMsVUFBTSxRQUFRLFNBQVMsWUFBWTtBQUNuQyxVQUFNLE9BQU8sS0FBSyxNQUFNO0FBQ3hCLFVBQU0sU0FBUyxJQUFJO0FBQ25CLFVBQU0sZUFBZSxtQkFBbUI7QUFDeEMsVUFBTSxTQUFTLFdBQVM7QUFDcEIsV0FBSyxNQUFNLE9BQU87QUFDbEIsV0FBSyxRQUFRLEtBQUssV0FBVyxLQUFLLE1BQU0saUJBQWlCLGtCQUFrQjtBQUMzRSxXQUFLLFFBQVEsUUFBUSxVQUFVO0FBQy9CLFdBQUssUUFBUSxRQUFRLGlDQUFpQyxLQUFLLE1BQU0sTUFBTTtBQUN2RSx5QkFBbUIsc0JBQXNCLEtBQUs7QUFBQSxJQUNsRCxDQUFDO0FBQ0QsU0FBSyxzQkFBc0I7QUFBQSxFQUMvQjtBQUFBLEVBRUEsQUFBUSw0QkFBNEIsWUFBa0M7QUFDbEUsVUFBTSw2QkFBNkIsV0FBVyxVQUFVLEVBQUUsS0FBSyxRQUFRLENBQUM7QUFDeEUsK0JBQTJCLFFBQVEsYUFBYTtBQUNoRCxlQUFXLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUN0QyxVQUFNLFNBQVMsSUFBSSxtQ0FBa0IsVUFBVTtBQUMvQyxXQUFPLEtBQUsscUJBQXFCLEVBQUUsUUFBUSxDQUFDLE1BQThCLE9BQU8sVUFBVSxHQUFHLGlCQUFpQixFQUFFLENBQUM7QUFDbEgsUUFBSSxLQUFLLE1BQU0sTUFBTTtBQUNqQixhQUFPLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDL0IsVUFBSSxDQUFDLHFCQUFpQix1QkFBa0IsbUJBQWUsRUFBRSxTQUFTLEtBQUssTUFBTSxJQUFJLEdBQUc7QUFDaEYsYUFBSyxnQ0FBZ0MsS0FBSztBQUFBLE1BQzlDLE9BQU87QUFDSCxhQUFLLGdDQUFnQyxLQUFLO0FBQUEsTUFDOUM7QUFBQSxJQUNKO0FBRUEsV0FBTyxTQUFTLENBQUMsY0FBc0M7QUFDbkQsV0FBSyxRQUFRLElBQUksY0FBTTtBQUN2QixvQkFBTSxhQUFhLEtBQUssT0FBTyxLQUFLLFlBQVk7QUFDaEQsV0FBSyxNQUFNLE9BQU8sS0FBSyxvQkFBb0IsU0FBUztBQUNwRCxXQUFLLE1BQU0sT0FBTyxzQkFBc0I7QUFDeEMsVUFBSSxLQUFLLE1BQU0sU0FBUyxLQUFLLGFBQWEsUUFDdEMsQ0FBQyxDQUFDLEtBQUssTUFBTSxNQUFNLEtBQUssYUFBYSxJQUFJLEVBQUUsTUFBTSxlQUM3QyxDQUFDLHFCQUFpQix1QkFBa0IsbUJBQWUsRUFBRSxTQUFTLFNBQVMsQ0FDM0UsR0FDRjtBQUNFLGFBQUssTUFBTSxVQUFVLENBQUM7QUFBQSxNQUMxQjtBQUNBLFVBQUksQ0FBQyxxQkFBaUIsdUJBQWtCLG1CQUFlLEVBQUUsU0FBUyxLQUFLLE1BQU0sSUFBSSxHQUFHO0FBQ2hGLGFBQUssZ0NBQWdDLEtBQUs7QUFBQSxNQUM5QyxPQUFPO0FBQ0gsYUFBSyxnQ0FBZ0MsS0FBSztBQUFBLE1BQzlDO0FBQ0EsYUFBTyxLQUFLLHNCQUFzQixZQUFZO0FBQzFDLGFBQUssc0JBQXNCLFlBQVksS0FBSyxzQkFBc0IsVUFBVTtBQUFBLE1BQ2hGO0FBQ0EsV0FBSyxlQUFlLElBQUksYUFBYSxLQUFLLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSyxLQUFLO0FBQzdFLFdBQUssYUFBYSx1QkFBdUIsS0FBSyx1QkFBdUIsS0FBSyxRQUFRLHNCQUE4QjtBQUFBLElBQ3BILENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLHdDQUE4QztBQUNsRCxTQUFLLGtDQUFrQyxLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFFMUYsU0FBSyxnQ0FBZ0MsVUFBVSxFQUFFLE1BQU0saUNBQWlDLEtBQUssUUFBUSxDQUFDO0FBQ3RHLFNBQUssZ0NBQWdDLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUVoRSxVQUFNLHlCQUF5QixJQUFJLG1DQUFrQixLQUFLLCtCQUErQjtBQUN6RixVQUFNLFdBQWtDLENBQUM7QUFDekMsYUFBUSxhQUFhO0FBQ3JCLGFBQVEsWUFBWTtBQUNwQixhQUFRLGVBQWUsbUJBQW1CLEtBQUssT0FBTyxTQUFTO0FBQy9ELDJCQUF1QixXQUFXLFFBQU87QUFDekMsWUFBUSxLQUFLLE1BQU07QUFBQSxXQUNWO0FBQTBCLCtCQUF1QixTQUFTLFNBQVM7QUFBRztBQUFBLFdBQ3RFO0FBQXlCLCtCQUF1QixTQUFTLFFBQVE7QUFBRztBQUFBLFdBQ3BFO0FBQVcsK0JBQXVCLFNBQVMsV0FBVztBQUFHO0FBQUE7QUFHbEUsMkJBQXVCLFNBQVMsV0FBUztBQUNyQyxjQUFRO0FBQUEsYUFDQztBQUFXLGVBQUsseUJBQXlCO0FBQTBCO0FBQUEsYUFDbkU7QUFBVSxlQUFLLHlCQUF5QjtBQUF5QjtBQUFBLGFBQ2pFO0FBQWEsZUFBSyx5QkFBeUI7QUFBVztBQUFBO0FBQ2xELGVBQUsseUJBQXlCO0FBQUE7QUFBQSxJQUUvQyxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSx5QkFBK0I7QUFFbkMsVUFBTSxtQkFBbUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBRTVFLHFCQUFpQixVQUFVLEVBQUUsTUFBTSxpQ0FBaUMsS0FBSyxRQUFRLENBQUM7QUFDbEYscUJBQWlCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUU1QyxVQUFNLG9CQUFvQixJQUFJLGlDQUFnQixnQkFBZ0I7QUFDOUQsc0JBQWtCLFNBQVMsS0FBSyxVQUFVO0FBRzFDLFVBQU0sZ0JBQWdCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUN6RSxTQUFLLGFBQWEsY0FBYyxLQUFLLElBQUksY0FBYyxLQUFLO0FBRzVELGtCQUFjLFVBQVUsRUFBRSxNQUFNLGFBQWEsS0FBSyxRQUFRLENBQUM7QUFDM0QsU0FBSyxXQUFXLElBQUksK0JBQWMsYUFBYTtBQUMvQyxTQUFLLFNBQVMsUUFBUSxTQUFTLFlBQVk7QUFDM0MsU0FBSyxTQUFTLFFBQVEsU0FBUyxZQUFZO0FBQzNDLFVBQU0sY0FBYyxjQUFjLFVBQVUsRUFBRSxLQUFLLGVBQWUsQ0FBQztBQUNuRSxTQUFLLFNBQVMsU0FBUyxLQUFLLFFBQVEsSUFBSTtBQUN4QyxrQ0FBUSxhQUFhLEtBQUssUUFBUSxJQUFJO0FBQ3RDLFNBQUssU0FBUyxTQUFTLFdBQVM7QUFDNUIsV0FBSyxRQUFRLE9BQU87QUFDcEIsb0NBQVEsYUFBYSxLQUFLO0FBQUEsSUFDOUIsQ0FBQztBQUVELHNCQUFrQixTQUFTLFdBQVM7QUFDaEMsV0FBSyxhQUFhO0FBQ2xCLFdBQUssYUFBYSxjQUFjLEtBQUssSUFBSSxjQUFjLEtBQUs7QUFBQSxJQUNoRSxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxpQkFBMEI7QUFDOUIsV0FBTyxLQUFLLGFBQWEsYUFDckIsS0FBSyxxQkFDTCxLQUFLLFNBQ1QsS0FDSSxLQUFLLGFBQWEsZ0JBQWdCO0FBQUEsRUFDMUM7QUFBQSxFQUVBLEFBQVEsaUJBQWlCLFdBQWlDO0FBQ3RELFVBQU0sSUFBSSxJQUFJLGlDQUFnQixTQUFTO0FBQ3ZDLE1BQUUsV0FBVyxNQUFNO0FBQ25CLE1BQUUsUUFBUSxXQUFXO0FBQ3JCLE1BQUUsUUFBUSxNQUFZO0FBeE85QjtBQXlPWSxVQUFJLFFBQVEsQ0FBQyxLQUFLLGVBQWU7QUFDakMsVUFBSSxPQUFPO0FBQ1AsWUFBSSx3QkFBTywyQkFBMkI7QUFDdEM7QUFBQSxNQUNKO0FBQUM7QUFDRCxVQUFJLEtBQUssWUFBWTtBQUNqQixhQUFLLE1BQU0sVUFBVSxLQUFLO0FBQUEsTUFDOUIsT0FBTztBQUNILGVBQU8sS0FBSyxNQUFNO0FBQUEsTUFDdEI7QUFDQSxVQUFJLEtBQUssMkJBQTJCLFFBQVc7QUFDM0MsYUFBSyxNQUFNLFVBQVUsS0FBSztBQUFBLE1BQzlCLE9BQU87QUFDSCxlQUFPLEtBQUssTUFBTTtBQUFBLE1BQ3RCO0FBQ0EsV0FBSyxRQUFRO0FBQ2IsWUFBTSx1QkFBdUIsS0FBSyxPQUFPLGtCQUFrQixPQUFPLE9BQUssRUFBRSxNQUFNLEtBQUssTUFBTSxFQUFFLEVBQUU7QUFDOUYsVUFBSSxzQkFBc0I7QUFDdEIsc0JBQU0sYUFBYSxzQkFBc0IsS0FBSyxLQUFLO0FBQUEsTUFDdkQsT0FBTztBQUNILGFBQUssT0FBTyxrQkFBa0IsS0FBSyxLQUFLLEtBQUs7QUFBQSxNQUNqRDtBQUFDO0FBQ0Qsb0JBQU0sYUFBYSxLQUFLLGNBQWMsS0FBSyxLQUFLO0FBQ2hELFVBQUksS0FBSztBQUFlLHNCQUFNLGFBQWEsS0FBSyxjQUFjLE9BQU8sS0FBSyxLQUFLO0FBQy9FLGlCQUFLLGtCQUFMLG1CQUFvQjtBQUNwQixXQUFLLE9BQU8sYUFBYTtBQUN6QixXQUFLLE1BQU07QUFBQSxJQUNmLEVBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLG1CQUFtQixXQUFpQztBQUN4RCxVQUFNLElBQUksSUFBSSxpQ0FBZ0IsU0FBUztBQUN2QyxNQUFFLFFBQVEsT0FBTyxFQUNaLFdBQVcsUUFBUSxFQUNuQixRQUFRLE1BQU07QUFDWCxXQUFLLFFBQVE7QUFFYixVQUFJLEtBQUssYUFBYSxRQUFRLElBQUk7QUFDOUIsZUFBTyxPQUFPLEtBQUssT0FBTyxLQUFLLFlBQVk7QUFBQSxNQUMvQztBQUFDO0FBQ0QsV0FBSyxNQUFNO0FBQUEsSUFDZixDQUFDO0FBQUEsRUFDVDtBQUFBLEVBSUEsT0FBYyxtQkFBbUIsV0FBMEIsU0FBa0I7QUFDekUsY0FBVSxRQUFRLFNBQVMsWUFBWTtBQUN2QyxVQUFNLGlCQUFpQixVQUFVLFFBQVE7QUFDekMsVUFBTSxrQkFBa0IsaURBQWdCO0FBQ3hDLFFBQUksV0FBVyxpQkFBaUI7QUFDNUIsVUFBSSxPQUFPLGdCQUFnQixjQUFjLGNBQWM7QUFDdkQsVUFBSSxDQUFDO0FBQU0sZUFBTyxVQUFVLEVBQUUsS0FBSyxjQUFjLENBQUM7QUFDbEQsV0FBSyxZQUFZO0FBQ2pCLHNCQUFnQixhQUFhLE1BQU0sY0FBYztBQUFBLElBQ3JEO0FBQUEsRUFDSjtBQUFBLEVBQ0EsT0FBYyxzQkFBc0IsV0FBOEM7QUFDOUUsUUFBSSxVQUFVLFFBQVEsU0FBUyxZQUFZO0FBQUcsZ0JBQVUsUUFBUSxZQUFZLFlBQVk7QUFDeEYsVUFBTSxpQkFBaUIsVUFBVSxRQUFRO0FBQ3pDLFVBQU0sa0JBQWtCLGlEQUFnQjtBQUN4QyxVQUFNLGFBQWEsbURBQWlCLGNBQWM7QUFDbEQsUUFBSTtBQUFZLHNCQUFpQixZQUFZLFVBQVU7QUFBQSxFQUMzRDtBQUNKOzs7QUgxUk8sSUFBZSxnQkFBZixNQUE0QjtBQUFBLEVBbUIvQixZQUFtQixRQUE2QixPQUFxQixNQUFpQjtBQUFuRTtBQUE2QjtBQUFxQjtBQUZyRSxTQUFPLGtCQUEyQjtBQUc5QixRQUFJLE1BQU0sU0FBUztBQUFNLFlBQU0sTUFBTSw2QkFBNkIsTUFBTTtBQUFBLEVBQzVFO0FBQUEsRUFFQSxPQUFPLGtCQUFrQixRQUFzQixNQUFhLE1BQWMsU0FBa0IsT0FBd0I7QUFDaEgsVUFBTSxXQUFXLE9BQU8sSUFBSSxjQUFjLHFCQUFxQixNQUFNLEtBQUssSUFBSTtBQUM5RSxRQUFJLFVBQVU7QUFDVixhQUFPLE9BQU8sSUFBSSxZQUFZLHFCQUMxQixVQUNBLEtBQUssTUFDTCxTQUNBLEtBQ0o7QUFBQSxJQUNKO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLEFBQU8sYUFBYSxXQUEwQixXQUE2QjtBQUN2RSxRQUFJLFFBQVE7QUFDWixRQUFJLFNBQVMsS0FBSyxLQUFLLE1BQU0sSUFBSSxHQUFHO0FBQ2hDLHlCQUFtQixtQkFDZixXQUNBLHNDQUNKO0FBQ0EsY0FBUTtBQUFBLElBQ1o7QUFBQztBQUNELFFBQUksS0FBSyxNQUFNLFFBQVEsSUFBSTtBQUN2Qix5QkFBbUIsbUJBQ2YsV0FDQSw2QkFDSjtBQUNBLGNBQVE7QUFBQSxJQUNaO0FBQUM7QUFDRCxXQUFPLENBQUM7QUFBQSxFQUNaO0FBQUEsRUFFQSxBQUFPLGNBQWMsT0FBd0I7QUFDekMsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLE9BQW9CLGNBQWMsUUFBc0IsTUFBYyxXQUFtQixPQUE4QjtBQUFBO0FBQ25ILFlBQU0sT0FBTyxPQUFPLElBQUksTUFBTSxzQkFBc0IsSUFBSTtBQUN4RCxVQUFJLGdCQUFnQiwwQkFBUyxLQUFLLGFBQWEsTUFBTTtBQUNqRCxjQUFNLFdBQVcsUUFBUSxDQUFDLEVBQUUsTUFBTSxXQUFXLFNBQVMsRUFBRSxNQUFhLEVBQUUsQ0FBQyxHQUFHLElBQUk7QUFBQSxNQUNuRjtBQUFBLElBQ0o7QUFBQTtBQUFBLEVBRUEsT0FBYyxPQUFPLFVBQStFO0FBQ2hHLFdBQVEsU0FBa0IsWUFBWTtBQUFBLEVBQzFDO0FBQUEsRUFFQSxPQUFjLFVBQVUsVUFBK0U7QUFDbkcsV0FBUSxTQUFrQixhQUFhO0FBQUEsRUFDM0M7QUFBQSxFQUVBLE9BQWMscUJBQXFCLFVBQStGO0FBQzlILFdBQVEsYUFBd0I7QUFBQSxFQUNwQztBQUFBLEVBRUEsT0FBYyxlQUFlLFVBQXVGO0FBQ2hILFdBQVEsU0FBMEIsY0FBYztBQUFBLEVBQ3BEO0FBQUEsRUFFQSxPQUFjLG1CQUNWLFFBQ0EsTUFDQSxXQUNBLE9BQ0EsT0FDQSxZQUNBLE9BQ0EsUUFDQSxXQUNJO0FBQ0osUUFBSSxPQUFPO0FBQ1AsWUFBTSxlQUFlLElBQUksYUFBRyxNQUFNLE1BQU0sUUFBUSxLQUFLO0FBQ3JELG1CQUFhLHdCQUF3QixNQUFNLFdBQVcsT0FBTyxZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQUEsSUFDckcsT0FBTztBQUNILFlBQU0sZUFBZSxjQUFhLGNBQWMsUUFBUSxTQUFVO0FBQ2xFLG1CQUFhLHdCQUF3QixNQUFNLFdBQVksT0FBTyxZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQUEsSUFDdEc7QUFBQSxFQUNKO0FBQUEsRUFFQSxPQUFjLGVBQ1YsUUFDQSxNQUNBLFdBQ0EsT0FDQSxZQUNBLE9BQ0EsUUFDQSxXQUNGO0FBOUhOO0FBK0hRLFFBQUksQ0FBQyxXQUFXO0FBQ1osWUFBTSxRQUFRLElBQUksd0JBQXdCLFFBQVEsTUFBTSxZQUFZLEtBQUs7QUFDekUsWUFBTSxLQUFLO0FBQUEsSUFDZixPQUFPO0FBQ0gsWUFBTSxRQUFRLGFBQU8sV0FBVyxZQUFZLElBQUksS0FBSyxJQUFJLE1BQTNDLG1CQUE4QyxLQUFLLFlBQVMsT0FBTSxTQUFTO0FBQ3pGLFVBQUk7QUFBTyxhQUFLLG1CQUFtQixRQUFRLE1BQU0sV0FBVyxPQUFPLE9BQU8sWUFBWSxPQUFPLFFBQVEsU0FBUztBQUFBLElBQ2xIO0FBQUEsRUFDSjtBQUFBLEVBRUEsT0FBYyxjQUFjLFFBQXNCLE1BQTRCO0FBQzFFLFVBQU0sUUFBUSxjQUFNLGNBQWMsSUFBSTtBQUN0QyxXQUFPLElBQUksYUFBRyxNQUFNLE1BQU0sUUFBUSxLQUFLO0FBQUEsRUFDM0M7QUFBQSxFQUVBLE9BQWMsZ0JBQWdCLE9BQXdCO0FBQ2xELFFBQUksaUJBQTBCO0FBQzlCLFFBQUksVUFBVSxLQUFLLEdBQUc7QUFDbEIsdUJBQWlCO0FBQUEsSUFDckIsV0FBVyxRQUFRLEtBQUssS0FBSyxLQUFLLElBQUksS0FBSyxLQUFLLEdBQUc7QUFDL0MsdUJBQWlCO0FBQUEsSUFDckIsV0FBVyxTQUFTLEtBQUssS0FBSyxLQUFLLElBQUksS0FBSyxLQUFLLEdBQUc7QUFDaEQsdUJBQWlCO0FBQUEsSUFDckI7QUFBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFPLGFBQWEsV0FBMkIsTUFBYSxXQUFtQixZQUFZLE1BQU07QUFBQSxFQUFFLEdBQVM7QUF6SmhIO0FBMEpRLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFFBQUk7QUFDSixRQUFJLE9BQU87QUFDUCxjQUFRLE1BQU0sS0FBSyxLQUFLLElBQUksRUFBRTtBQUFBLGFBQ3JCO0FBQVcsc0JBQVk7QUFBSTtBQUFBLGFBQzNCO0FBQU0sc0JBQVk7QUFBSTtBQUFBLGFBQ3RCO0FBQU8sc0JBQVk7QUFBUztBQUFBLGFBQzVCO0FBQUcsc0JBQVk7QUFBSztBQUFBO0FBQ2hCLHNCQUFZLE1BQU0sS0FBSyxLQUFLLElBQUksRUFBRTtBQUFBO0FBQUEsSUFFbkQsT0FBTztBQUNILGtCQUFZO0FBQUEsSUFDaEI7QUFDQSxjQUFVLFVBQVUsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUFBLEVBQzNDO0FBQ0o7OztBVGhLQSxJQUFxQixhQUFyQixjQUF3QyxjQUFhO0FBQUEsRUFFakQsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLG1CQUFlO0FBQUEsRUFDeEM7QUFBQSxFQUVBLEFBQU8sZ0JBQXdCO0FBQzNCLFdBQU8sS0FBSyxNQUFNLFFBQVEsWUFBWTtBQUFBLEVBQzFDO0FBQUEsRUFFQSxBQUFPLGVBQWUsTUFBYyxPQUFlLE1BQWEsVUFBZ0U7QUFDNUgsVUFBTSxRQUFRLElBQUksV0FBVyxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sS0FBSztBQUNqRSxVQUFNLFFBQVEsUUFBUSxxQkFBcUIsT0FBTztBQUNsRCxVQUFNLFdBQVcsVUFBVTtBQUMzQixVQUFNLFNBQVMsTUFBTSxNQUFNLEtBQUs7QUFDaEMsUUFBSSxXQUFXLE9BQU8sUUFBUSxHQUFHO0FBQzdCLGVBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsYUFBSyxTQUFTLFdBQVcsT0FBTztBQUNoQyxhQUFLLFFBQVEsUUFBUTtBQUNyQixhQUFLLFFBQVEsTUFBTTtBQUNuQixhQUFLLFdBQVcsc0JBQXNCO0FBQUEsTUFDMUMsQ0FBQztBQUFBLElBQ0wsV0FBVyxXQUFXLFVBQVUsUUFBUSxHQUFHO0FBQ3ZDLGVBQVMsUUFBUSxLQUFLO0FBQUEsUUFDbEIsSUFBSSxVQUFVO0FBQUEsUUFDZCxhQUFhLG1CQUFtQjtBQUFBLFFBQ2hDO0FBQUEsUUFDQSxNQUFNO0FBQUEsTUFDVixDQUFDO0FBQUEsSUFDTCxXQUFXLFdBQVcsZUFBZSxRQUFRLEdBQUc7QUFDNUMsZUFBUyxVQUFVLFVBQVUsc0JBQWtCLFFBQVEsVUFBVSxjQUFjO0FBQUEsSUFDbkY7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFPLHVCQUF1QixXQUEyQixRQUE0QjtBQUNqRixjQUFVLFNBQVMsUUFBUSxFQUFFLE1BQU0sWUFBWSxLQUFLLFFBQVEsQ0FBQztBQUM3RCxVQUFNLG9CQUFvQixVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ3hFLFVBQU0sZ0JBQWdCLElBQUksb0NBQWtCLGlCQUFpQjtBQUM3RCxrQkFBYyxRQUFRLE9BQU87QUFDN0Isa0JBQWMsUUFBUSxPQUFPO0FBQzdCLGtCQUFjLFFBQVEsU0FBUyxZQUFZO0FBQzNDLGtCQUFjLFNBQVMsS0FBSyxNQUFNLFFBQVEsWUFBWSxFQUFFO0FBQ3hELGtCQUFjLFNBQVMsQ0FBQyxVQUFrQjtBQUN0QyxXQUFLLE1BQU0sUUFBUSxXQUFXO0FBQUEsSUFDbEMsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQU8sa0JBQTJCO0FBRTlCLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFPLHdCQUNILE1BQ0EsbUJBQ0EsT0FDQSxZQUNBLE9BQ0EsUUFDQSxXQUNJO0FBQ0osVUFBTSxhQUFhLElBQUksV0FBVyxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sU0FBUyxJQUFJLFlBQVksT0FBTyxRQUFRLFNBQVM7QUFDbEgsZUFBVyxRQUFRLFFBQVEsbUJBQW1CLG1CQUFtQjtBQUNqRSxlQUFXLEtBQUs7QUFBQSxFQUNwQjtBQUFBLEVBRUEsQUFBTyxjQUNILElBQ0EsR0FDQSxnQkFDQSxRQUEyRixDQUFDLEdBQ3hGO0FBaEZaO0FBaUZRLFVBQU0sTUFBTTtBQUVaLFVBQU0sVUFBVSxlQUFlLFNBQVMsUUFBUTtBQUNoRCxVQUFNLGFBQWMsR0FBRyxHQUFHLFFBQVEsRUFBRSxLQUFLLE1BQU0sT0FBTyxLQUFLO0FBQzNELG1CQUFlLFlBQVksVUFBVTtBQUNyQyxVQUFNLGlCQUFpQixlQUFlLFVBQVUsQ0FBQyxDQUFDO0FBQ2xELG1CQUFlLEtBQUs7QUFDcEIsVUFBTSxRQUFRLGVBQWUsU0FBUyxPQUFPO0FBQzdDLFVBQU0sUUFBUSxFQUFFLEtBQUssTUFBTTtBQUUzQixVQUFNLFNBQVMsZUFBZSxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDM0QsUUFBSSxZQUFNLFlBQU4sbUJBQWU7QUFBVSxhQUFPLEtBQUs7QUFDekMsbUNBQVEsU0FBUyxVQUFVLG9CQUFnQjtBQUMzQyxRQUFJLENBQUMsc0NBQU8sWUFBUCxtQkFBZ0IsV0FBVTtBQUMzQixjQUFRLEtBQUs7QUFDYixhQUFPLEtBQUs7QUFDWixxQkFBZSxjQUFjLE1BQU07QUFDL0IsWUFBSSxDQUFDLGVBQWUsUUFBUSxHQUFHO0FBQzNCLGtCQUFRLEtBQUs7QUFDYixpQkFBTyxLQUFLO0FBQUEsUUFDaEI7QUFBQSxNQUNKO0FBQ0EscUJBQWUsYUFBYSxNQUFNO0FBdkc5QztBQXdHZ0IsZ0JBQVEsS0FBSztBQUNiLFlBQUksQ0FBQyxjQUFNLFlBQU4sb0JBQWU7QUFBVSxpQkFBTyxLQUFLO0FBQUEsTUFDOUM7QUFBQSxJQUNKO0FBRUEsVUFBTSxlQUFlLGVBQWUsU0FBUyxRQUFRO0FBQ3JELG1DQUFRLGNBQWMsV0FBVztBQUNqQyxpQkFBYSxVQUFVLENBQUMsTUFBTTtBQUMxQixpQkFBVyxjQUFjLEtBQUssUUFBUSxFQUFFLEtBQUssTUFBTSxLQUFLLE1BQU0sTUFBTSxNQUFNLEtBQUs7QUFDL0UscUJBQWUsS0FBSztBQUFBLElBQ3hCO0FBQ0EsVUFBTSxhQUFhLGVBQWUsU0FBUyxRQUFRO0FBQ25ELG1DQUFRLFlBQVksT0FBTztBQUMzQixlQUFXLFVBQVUsQ0FBQyxNQUFNO0FBckhwQztBQXNIWSxxQkFBZSxLQUFLO0FBQ3BCLGlCQUFXLEtBQUs7QUFDaEIsY0FBUSxLQUFLO0FBQ2IsVUFBSSxDQUFDLGNBQU0sWUFBTixvQkFBZTtBQUFVLGVBQU8sS0FBSztBQUFBLElBQzlDO0FBQ0EsVUFBTSxNQUFNO0FBRVosVUFBTSxZQUFZLENBQUMsTUFBTTtBQTdIakM7QUE4SFksVUFBSSxFQUFFLFFBQVEsU0FBUztBQUNuQixtQkFBVyxjQUFjLEtBQUssUUFBUSxFQUFFLEtBQUssTUFBTSxLQUFLLE1BQU0sTUFBTSxNQUFNLEtBQUs7QUFDL0UsdUJBQWUsS0FBSztBQUFBLE1BQ3hCO0FBQ0EsVUFBSSxFQUFFLFFBQVEsVUFBVTtBQUNwQix1QkFBZSxLQUFLO0FBQ3BCLG1CQUFXLEtBQUs7QUFDaEIsZ0JBQVEsS0FBSztBQUNiLFlBQUksQ0FBQyxjQUFNLFlBQU4sb0JBQWU7QUFBVSxpQkFBTyxLQUFLO0FBQUEsTUFDOUM7QUFBQSxJQUNKO0FBRUEsWUFBUSxVQUFVLE1BQU07QUFDcEIsVUFBSSxLQUFLLE1BQU0sUUFBUSxVQUFVO0FBQzdCLGNBQU0sT0FBTyxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixFQUFFLEtBQUssSUFBSTtBQUNwRSxZQUFJLGdCQUFnQiwyQkFBUyxLQUFLLGNBQWMsTUFBTTtBQUNsRCxnQkFBTSxhQUFhLElBQUksV0FBVyxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sRUFBRSxLQUFLLE1BQU0sS0FBSztBQUNuRixxQkFBVyxLQUFLO0FBQUEsUUFDcEI7QUFBQSxNQUNKLE9BQU87QUFDSCx1QkFBZSxLQUFLO0FBQ3BCLGNBQU0sTUFBTTtBQUFBLE1BQ2hCO0FBQ0EsaUJBQVcsS0FBSztBQUNoQixjQUFRLEtBQUs7QUFDYixhQUFPLEtBQUs7QUFBQSxJQUNoQjtBQUFBLEVBQ0o7QUFDSjs7O0FlekpBLHdCQUE4QztBQUk5QyxJQUFxQixlQUFyQixjQUEwQyx3QkFBTTtBQUFBLEVBRTVDLFlBQ1ksUUFDQSxNQUNBLE9BQ0EsT0FDQSxhQUFxQixJQUNyQixRQUFpQixPQUNqQixTQUFrQixPQUNsQixZQUFxQixPQUMvQjtBQUNFLFVBQU0sT0FBTyxHQUFHO0FBVFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSLFNBQUssU0FBUztBQUNkLFNBQUssT0FBTztBQUNaLFNBQUssUUFBUTtBQUNiLFNBQUssYUFBYTtBQUNsQixTQUFLLFFBQVE7QUFDYixTQUFLLFNBQVM7QUFDZCxTQUFLLFlBQVk7QUFDakIsU0FBSyxRQUFRO0FBQUEsRUFDakI7QUFBQSxFQUVBLFNBQVM7QUFDTCxTQUFLLFlBQVksU0FBUyxlQUFlO0FBQ3pDLFNBQUssWUFBWSxTQUFTLFFBQVE7QUFDbEMsU0FBSyxjQUFjO0FBQUEsRUFDdkI7QUFBQSxFQUdBLEFBQVEsZ0JBQXNCO0FBQzFCLFVBQU0sbUJBQW1CLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUM1RSxxQkFBaUIsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQzVDLFVBQU0sYUFBYSxJQUFJLGtDQUFnQixnQkFBZ0I7QUFDdkQsZUFBVyxjQUFjLE1BQU07QUFDL0IsZUFBVyxTQUFTLE1BQU07QUFDMUIscUJBQWlCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUM1QyxVQUFNLGNBQWMsSUFBSSxrQ0FBZ0IsZ0JBQWdCO0FBQ3hELGdCQUFZLGNBQWMsT0FBTztBQUNqQyxxQkFBaUIsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQzVDLFFBQUksS0FBSyxPQUFPO0FBQ1osaUJBQVcsT0FBTztBQUNsQixrQkFBWSxVQUFVO0FBQUEsSUFDMUIsT0FBTztBQUNILGtCQUFZLE9BQU87QUFDbkIsaUJBQVcsVUFBVTtBQUFBLElBQ3pCO0FBQ0EsZ0JBQVksUUFBUSxNQUFNO0FBQ3RCLFdBQUssUUFBUTtBQUNiLGtCQUFZLE9BQU87QUFDbkIsaUJBQVcsVUFBVTtBQUFBLElBQ3pCLENBQUM7QUFDRCxlQUFXLFFBQVEsTUFBTTtBQUNyQixXQUFLLFFBQVE7QUFDYixpQkFBVyxPQUFPO0FBQ2xCLGtCQUFZLFVBQVU7QUFBQSxJQUMxQixDQUFDO0FBQ0QsVUFBTSxhQUFhLElBQUksa0NBQWdCLGdCQUFnQjtBQUN2RCxlQUFXLFNBQVMsT0FBTztBQUMzQixlQUFXLFFBQVEsV0FBVztBQUM5QixlQUFXLFFBQVEsTUFBWTtBQUMzQixZQUFNLFFBQVEsS0FBSyxNQUFNLFNBQVM7QUFDbEMsWUFBTSxXQUFXLEtBQUssUUFBUSxDQUFDLEVBQUUsTUFBTSxLQUFLLE1BQU0sTUFBTSxTQUFTLEVBQUUsTUFBYSxFQUFFLENBQUMsR0FBRyxLQUFLLE1BQU0sS0FBSyxZQUFZLEtBQUssT0FBTyxLQUFLLFFBQVEsS0FBSyxTQUFTO0FBQ3pKLFdBQUssTUFBTTtBQUFBLElBQ2YsRUFBQztBQUFBLEVBQ0w7QUFDSjs7O0FDN0RBLElBQXFCLGVBQXJCLGNBQTBDLGNBQWE7QUFBQSxFQUVuRCxZQUFZLFFBQXNCLE9BQWM7QUFDNUMsVUFBTSxRQUFRLE9BQU8sdUJBQWlCO0FBQ3RDLFNBQUssa0JBQWtCO0FBQUEsRUFDM0I7QUFBQSxFQUVBLEFBQWEsT0FBTyxNQUFjLE9BQWUsTUFBNEI7QUFBQTtBQUN6RSxZQUFNLFNBQVMsYUFBYSxnQkFBZ0IsS0FBSztBQUNqRCxZQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFZLFNBQVMsRUFBRSxPQUFRLEVBQUMsUUFBUSxTQUFTLEVBQUUsRUFBRSxDQUFDLEdBQUcsSUFBSTtBQUFBLElBQ2xHO0FBQUE7QUFBQSxFQUVBLEFBQU8sZUFBZSxNQUFjLE9BQWUsTUFBYSxVQUFnRTtBQUM1SCxVQUFNLFNBQVMsYUFBYSxnQkFBZ0IsS0FBSztBQUNqRCxVQUFNLFdBQVcsVUFBVTtBQUMzQixVQUFNLFNBQVMsTUFBUztBQUFHLG1CQUFNLEtBQUssT0FBTyxNQUFNLE9BQU8sSUFBSTtBQUFBO0FBRTlELFFBQUksYUFBYSxPQUFPLFFBQVEsR0FBRztBQUMvQixlQUFTLFFBQVEsQ0FBQyxTQUFTO0FBQ3ZCLGFBQUssU0FBUyxJQUFJLFNBQVMsU0FBUyx5QkFBVSx3QkFBUztBQUN2RCxhQUFLLFFBQVEsUUFBUTtBQUNyQixhQUFLLFFBQVEsTUFBTTtBQUNuQixhQUFLLFdBQVcsc0JBQXNCO0FBQUEsTUFDMUMsQ0FBQztBQUFBLElBQ0wsV0FBVyxhQUFhLFVBQVUsUUFBUSxHQUFHO0FBQ3pDLGVBQVMsUUFBUSxLQUFLO0FBQUEsUUFDbEIsSUFBSSxVQUFVO0FBQUEsUUFDZCxhQUFhLFlBQVksWUFBWSxTQUFTLHlCQUFVO0FBQUEsUUFDeEQ7QUFBQSxRQUNBLE1BQU07QUFBQSxNQUNWLENBQUM7QUFBQSxJQUNMLFdBQVcsYUFBYSxlQUFlLFFBQVEsR0FBRztBQUM5QyxlQUFTLFVBQ0wsU0FBUyxhQUFhLGdCQUN0QixRQUNBLFNBQVMseUJBQVUsc0JBQU87QUFBQSxJQUNsQztBQUFDO0FBQUEsRUFDTDtBQUFBLEVBQ0EsQUFBTyxnQkFBd0I7QUFDM0IsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLEFBQU8sdUJBQXVCLGlCQUFpQyxRQUE0QjtBQUFBLEVBRTNGO0FBQUEsRUFFQSxBQUFPLGNBQWMsT0FBd0I7QUFDekMsUUFBSTtBQUNBLFlBQU0sU0FBUyxhQUFhLGdCQUFnQixLQUFLO0FBQ2pELGFBQU8sVUFBVSxNQUFNO0FBQUEsSUFDM0IsU0FBUyxPQUFQO0FBQ0UsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFPLGtCQUEyQjtBQUU5QixXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsQUFBTyx3QkFDSCxNQUNBLG1CQUNBLE9BQ0EsWUFDQSxPQUNBLFFBQ0EsV0FDSTtBQUNKLFVBQU0sU0FBUyxhQUFhLGdCQUFnQixTQUFTLE9BQU87QUFDNUQsVUFBTSxhQUFhLElBQUksYUFBYSxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sUUFBUSxZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQy9HLGVBQVcsUUFBUSxRQUFRLGlCQUFpQixtQkFBbUI7QUFDL0QsZUFBVyxLQUFLO0FBQUEsRUFDcEI7QUFBQSxFQUVBLEFBQU8sY0FDSCxJQUNBLEdBQ0EsZ0JBQ0EsT0FDSTtBQUNKLFVBQU0sV0FBNkIsR0FBRyxHQUFHLFNBQVMsSUFBSSxpQ0FBSyxRQUFMLEVBQVksUUFBUSxXQUFXLEVBQUM7QUFDdEYsYUFBUyxVQUFVLEVBQUUsS0FBSyxNQUFNO0FBQ2hDLG1CQUFlLFlBQVksUUFBUTtBQUNuQyxhQUFTLFdBQVcsQ0FBQyxVQUFVO0FBQzNCLG1CQUFhLGNBQWMsS0FBSyxRQUFRLEVBQUUsS0FBSyxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsUUFBUSxTQUFTLENBQUM7QUFBQSxJQUNyRztBQUFBLEVBQ0o7QUFDSjs7O0FDakdBLHdCQUFvRDs7O0FDQXBELHdCQUE2RDtBQU83RCxJQUFxQixjQUFyQixjQUF5QyxVQUFVO0FBQUEsRUFNL0MsWUFDVyxRQUNDLE1BQ0EsT0FDQSxPQUNBLGFBQXFCLElBQ3JCLFFBQWlCLE9BQ2pCLFNBQWtCLE9BQ2xCLFlBQXFCLE9BQy9CO0FBQ0UsVUFBTSxNQUFNO0FBVEw7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSLFNBQUssZUFBZSxJQUFJLGFBQWEsS0FBSyxNQUFNLE1BQU0sS0FBSyxRQUFRLEtBQUssS0FBSztBQUM3RSxTQUFLLFlBQVksU0FBUyxlQUFlO0FBQUEsRUFDN0M7QUFBQSxFQUVBLFNBQVM7QUFDTCxVQUFNLE9BQU87QUFDYixTQUFLLGFBQWE7QUFBQSxFQUN0QjtBQUFBLEVBRUEsQUFBUSxVQUFVLGFBQWtDO0FBQ2hELFVBQU0sRUFBRSxTQUFTLEtBQUssTUFBTTtBQUM1QixVQUFNLFFBQVEsV0FBVyxJQUFJO0FBQzdCLFFBQUksQ0FBQyxNQUFNLEtBQUssR0FBRztBQUNmLGtCQUFZLFNBQVUsWUFBVyxZQUFZLFNBQVMsQ0FBQyxJQUFJLE9BQU8sU0FBUyxDQUFDO0FBQUEsSUFDaEYsT0FBTztBQUNILGtCQUFZLFNBQVUsWUFBVyxZQUFZLFNBQVMsQ0FBQyxJQUFJLEdBQUcsU0FBUyxDQUFDO0FBQUEsSUFDNUU7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFRLFVBQVUsYUFBa0M7QUFDaEQsVUFBTSxFQUFFLFNBQVMsS0FBSyxNQUFNO0FBQzVCLFVBQU0sUUFBUSxXQUFXLElBQUk7QUFDN0IsUUFBSSxDQUFDLE1BQU0sS0FBSyxHQUFHO0FBQ2Ysa0JBQVksU0FBVSxZQUFXLFlBQVksU0FBUyxDQUFDLElBQUksT0FBTyxTQUFTLENBQUM7QUFBQSxJQUNoRixPQUFPO0FBQ0gsa0JBQVksU0FBVSxZQUFXLFlBQVksU0FBUyxDQUFDLElBQUksR0FBRyxTQUFTLENBQUM7QUFBQSxJQUM1RTtBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQVEsbUJBQW1CLFVBQTJCLFNBQTBCLGFBQWtDO0FBQzlHLGFBQVMsWUFBWSxDQUFDLEtBQUssYUFBYSxhQUFhLFlBQVksU0FBUyxDQUFDLENBQUM7QUFDNUUsWUFBUSxZQUFZLENBQUMsS0FBSyxhQUFhLGFBQWEsWUFBWSxTQUFTLENBQUMsQ0FBQztBQUMzRSxRQUFJLEtBQUssYUFBYSxhQUFhLFlBQVksU0FBUyxDQUFDLEdBQUc7QUFDeEQsZUFBUyxPQUFPO0FBQUEsSUFDcEIsT0FBTztBQUNILGVBQVMsVUFBVTtBQUFBLElBQ3ZCO0FBQ0EsUUFBSSxLQUFLLGFBQWEsYUFBYSxZQUFZLFNBQVMsQ0FBQyxHQUFHO0FBQ3hELGNBQVEsT0FBTztBQUFBLElBQ25CLE9BQU87QUFDSCxjQUFRLFVBQVU7QUFBQSxJQUN0QjtBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQVEsZUFBcUI7QUFDekIsVUFBTSxFQUFFLFNBQVMsS0FBSyxNQUFNO0FBRTVCLFVBQU0saUJBQWlCLEtBQUssVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBRWhGLFNBQUssY0FBYyxJQUFJLGdDQUFjLGNBQWM7QUFDbkQsVUFBTSxjQUFjLEtBQUs7QUFDekIsZ0JBQVksUUFBUSxNQUFNO0FBQzFCLGdCQUFZLFNBQVMsR0FBRyxLQUFLLE9BQU87QUFFcEMsVUFBTSxXQUFXLElBQUksa0NBQWdCLGNBQWM7QUFDbkQsYUFBUyxjQUFjLEtBQUssQ0FBQyxDQUFDLE9BQU8sT0FBTyxHQUFHO0FBQy9DLGFBQVMsWUFBWSxDQUFDLEtBQUssYUFBYSxhQUFhLFlBQVksU0FBUyxDQUFDLENBQUM7QUFFNUUsVUFBTSxVQUFVLElBQUksa0NBQWdCLGNBQWM7QUFDbEQsWUFBUSxjQUFjLEtBQUssQ0FBQyxDQUFDLE9BQU8sT0FBTyxHQUFHO0FBQzlDLFlBQVEsWUFBWSxDQUFDLEtBQUssYUFBYSxhQUFhLFlBQVksU0FBUyxDQUFDLENBQUM7QUFFM0UsbUJBQWUsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBRTFDLFVBQU0sY0FBYyxJQUFJLGtDQUFnQixjQUFjO0FBQ3RELGdCQUFZLFFBQVEsV0FBVztBQUUvQixVQUFNLFlBQVksSUFBSSxrQ0FBZ0IsY0FBYztBQUNwRCxjQUFVLFFBQVEsT0FBTztBQUV6QixTQUFLLGFBQWEsS0FBSyxVQUFVLFNBQVMsT0FBTyxFQUFFLEtBQUssY0FBYyxDQUFDO0FBQ3ZFLFNBQUssV0FBVyxLQUFLO0FBRXJCLFNBQUssbUJBQW1CLFVBQVUsU0FBUyxXQUFXO0FBR3RELGdCQUFZLFNBQVMsTUFBTTtBQUN2QixrQkFBWSxRQUFRLFlBQVksWUFBWTtBQUM1QyxXQUFLLFdBQVcsS0FBSztBQUNyQixXQUFLLFdBQVcsUUFBUSxFQUFFO0FBQzFCLFdBQUssbUJBQW1CLFVBQVUsU0FBUyxXQUFXO0FBQUEsSUFDMUQsQ0FBQztBQUVELFlBQVEsUUFBUSxDQUFDLE1BQU07QUFDbkIsUUFBRSxlQUFlO0FBQ2pCLFdBQUssVUFBVSxXQUFXO0FBQzFCLFdBQUssbUJBQW1CLFVBQVUsU0FBUyxXQUFXO0FBQUEsSUFDMUQsQ0FBQztBQUVELGFBQVMsUUFBUSxDQUFDLE1BQU07QUFDcEIsUUFBRSxlQUFlO0FBQ2pCLFdBQUssVUFBVSxXQUFXO0FBQzFCLFdBQUssbUJBQW1CLFVBQVUsU0FBUyxXQUFXO0FBQUEsSUFDMUQsQ0FBQztBQUVELGNBQVUsUUFBUSxDQUFDLE1BQU07QUFDckIsUUFBRSxlQUFlO0FBQ2pCLFdBQUssTUFBTTtBQUFBLElBQ2YsQ0FBQztBQUVELGdCQUFZLFFBQVEsTUFBWTtBQUM1QixXQUFLLEtBQUs7QUFBQSxJQUNkLEVBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFhLE9BQXNCO0FBQUE7QUFDL0IsWUFBTSxhQUFhLEtBQUssWUFBWSxTQUFTO0FBRTdDLFVBQUksQ0FBQyxLQUFLLGFBQWEsY0FBYyxVQUFVLEdBQUc7QUFDOUMsY0FBTSxFQUFFLFdBQUssY0FBUSxLQUFLLE1BQU07QUFDaEMsYUFBSyxXQUFXLEtBQUs7QUFDckIsYUFBSyxXQUFXLFFBQVEsd0JBQXdCLE9BQU0sYUFBYSxPQUFNLE1BQU0sT0FBTSxhQUFhLE9BQU0sSUFBSTtBQUM1RyxhQUFLLFlBQVksUUFBUSxRQUFRLFNBQVMsWUFBWTtBQUN0RDtBQUFBLE1BQ0o7QUFDQSxZQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLFdBQVcsRUFBRSxDQUFDLEdBQUcsS0FBSyxNQUFNLEtBQUssWUFBWSxLQUFLLE9BQU8sS0FBSyxRQUFRLEtBQUssU0FBUztBQUM5SixXQUFLLE1BQU07QUFBQSxJQUNmO0FBQUE7QUFDSjs7O0FEcElBLElBQXFCLGNBQXJCLGNBQXlDLGNBQWE7QUFBQSxFQU9sRCxZQUFZLFFBQXNCLE9BQWM7QUFDNUMsVUFBTSxRQUFRLE9BQU8scUJBQWdCO0FBQUEsRUFDekM7QUFBQSxFQUVBLEFBQU8sZ0JBQXdCO0FBQzNCLFVBQU0sV0FBb0IsQ0FBQztBQUMzQixXQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sRUFBRSxRQUFRLENBQUMsTUFBTTtBQUFFLFVBQUksS0FBSyxNQUFNLFFBQVE7QUFBSSxpQkFBUSxLQUFLLEdBQUcsTUFBTSxLQUFLLE1BQU0sUUFBUSxJQUFJO0FBQUEsSUFBRSxDQUFDO0FBQzVILFdBQU8sU0FBUSxLQUFLLEtBQUs7QUFBQSxFQUM3QjtBQUFBLEVBRUEsQUFBTyxhQUFhLE9BQXdCO0FBQ3hDLFVBQU0sRUFBRSxNQUFNLGNBQVEsS0FBSyxNQUFNO0FBQ2pDLFVBQU0sUUFBUSxXQUFXLElBQUk7QUFDN0IsVUFBTSxPQUFPLFdBQVcsSUFBRztBQUMzQixXQUFPLENBQ0gsT0FBTSxXQUFXLEtBQUssQ0FBQyxLQUN2QixDQUFDLE1BQU0sSUFBSSxLQUVQLEVBQUMsTUFBTSxLQUFLLEtBQ1IsWUFBVyxLQUFLLElBQUksUUFBUSxRQUM1QixXQUFXLEtBQUssSUFBSSxJQUFJO0FBQUEsRUFJeEM7QUFBQSxFQUVBLEFBQU8sYUFBYSxPQUF3QjtBQUN4QyxVQUFNLEVBQUUsTUFBTSxjQUFRLEtBQUssTUFBTTtBQUNqQyxVQUFNLFFBQVEsV0FBVyxJQUFJO0FBQzdCLFVBQU0sT0FBTyxXQUFXLElBQUc7QUFDM0IsV0FBTyxDQUNILE9BQU0sV0FBVyxLQUFLLENBQUMsS0FDdkIsQ0FBQyxNQUFNLElBQUksS0FFUCxFQUFDLE1BQU0sS0FBSyxLQUNSLFlBQVcsS0FBSyxJQUFJLFFBQVEsUUFDNUIsV0FBVyxLQUFLLElBQUksSUFBSTtBQUFBLEVBSXhDO0FBQUEsRUFFQSxBQUFPLGNBQWMsT0FBd0I7QUFDekMsVUFBTSxFQUFFLFdBQUssY0FBUSxLQUFLLE1BQU07QUFDaEMsVUFBTSxPQUFPLFdBQVcsSUFBRztBQUMzQixVQUFNLE9BQU8sV0FBVyxJQUFHO0FBQzNCLFVBQU0sU0FBUyxXQUFXLEtBQUs7QUFDL0IsV0FDSSxDQUFDLE1BQU0sTUFBTSxLQUFNLE9BQU0sSUFBSSxLQUFLLFVBQVUsU0FBVSxPQUFNLElBQUksS0FBSyxVQUFVO0FBQUEsRUFFdkY7QUFBQSxFQUVBLEFBQU8sZUFBZSxNQUFjLE9BQWUsTUFBYSxVQUFnRTtBQUM1SCxVQUFNLFFBQVEsSUFBSSxZQUFZLEtBQUssUUFBUSxNQUFNLEtBQUssT0FBTyxLQUFLO0FBQ2xFLFVBQU0sUUFBUSxRQUFRLHFCQUFxQixPQUFPO0FBQ2xELFVBQU0sRUFBRSxXQUFLLFdBQUssU0FBUyxLQUFLLE1BQU07QUFDdEMsVUFBTSxPQUFPLFdBQVcsSUFBRztBQUMzQixVQUFNLE9BQU8sV0FBVyxJQUFHO0FBQzNCLFVBQU0sUUFBUSxXQUFXLElBQUk7QUFDN0IsVUFBTSxTQUFTLFdBQVcsS0FBSztBQUMvQixVQUFNLGNBQWMsQ0FBQyxNQUFNLElBQUksS0FBSyxTQUFTLFNBQVM7QUFDdEQsVUFBTSxjQUFjLENBQUMsTUFBTSxJQUFJLEtBQUssU0FBUyxTQUFTO0FBQ3RELFVBQU0sU0FBUyxNQUFNLE1BQU0sS0FBSztBQUNoQyxVQUFNLFdBQVcsTUFBUztBQUFHLG1CQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFZLFNBQVMsRUFBRSxPQUFRLFVBQVMsT0FBTyxTQUFTLEVBQUUsRUFBRSxDQUFDLEdBQUcsSUFBSTtBQUFBO0FBQ2xJLFVBQU0sV0FBVyxNQUFTO0FBQUcsbUJBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQVksU0FBUyxFQUFFLE9BQVEsVUFBUyxPQUFPLFNBQVMsRUFBRSxFQUFFLENBQUMsR0FBRyxJQUFJO0FBQUE7QUFDbEksUUFBSSxZQUFZLE9BQU8sUUFBUSxHQUFHO0FBQzlCLGVBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsYUFBSyxTQUFTLFdBQVcsT0FBTztBQUNoQyxhQUFLLFFBQVEsVUFBVSxzQkFBaUI7QUFDeEMsYUFBSyxRQUFRLE1BQU07QUFDbkIsYUFBSyxXQUFXLHNCQUFzQjtBQUFBLE1BQzFDLENBQUM7QUFFRCxVQUFJLE9BQU87QUFDUCxZQUFJO0FBQ0EsbUJBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsaUJBQUssUUFBUSxjQUFjO0FBQzNCLGlCQUFLLFNBQVMsSUFBSSxzQkFBWSxTQUFTLE9BQU87QUFDOUMsaUJBQUssUUFBUSxRQUFRO0FBQ3JCLGlCQUFLLFdBQVcsc0JBQXNCO0FBQUEsVUFDMUMsQ0FBQztBQUNMLFlBQUk7QUFDQSxtQkFBUyxRQUFRLENBQUMsU0FBUztBQUN2QixpQkFBSyxRQUFRLGFBQWE7QUFDMUIsaUJBQUssU0FBUyxJQUFJLHNCQUFZLFNBQVMsT0FBTztBQUM5QyxpQkFBSyxRQUFRLFFBQVE7QUFDckIsaUJBQUssV0FBVyxzQkFBc0I7QUFBQSxVQUMxQyxDQUFDO0FBQUEsTUFDVDtBQUFBLElBQ0osV0FBVyxZQUFZLFVBQVUsUUFBUSxHQUFHO0FBQ3hDLGVBQVMsUUFBUSxLQUFLO0FBQUEsUUFDbEIsSUFBSSxVQUFVO0FBQUEsUUFDZCxhQUFhLG1CQUFtQjtBQUFBLFFBQ2hDO0FBQUEsUUFDQSxNQUFNLFVBQVU7QUFBQSxNQUNwQixDQUFDO0FBQUEsSUFDTCxXQUFXLFlBQVksZUFBZSxRQUFRLEdBQUc7QUFDN0MsVUFBSSxNQUFNO0FBQ04sWUFBSSxhQUFhO0FBQ2IsbUJBQVMsVUFBVSxnQkFBZ0IsVUFBVSxZQUFZLFdBQVcsTUFBTTtBQUFBLFFBQzlFO0FBQ0EsWUFBSSxhQUFhO0FBQ2IsbUJBQVMsVUFBVSxlQUFlLFVBQVUsWUFBWSxXQUFXLE1BQU07QUFBQSxRQUM3RTtBQUFBLE1BQ0o7QUFDQSxlQUFTLFVBQVUsVUFBVSx3QkFBbUIsUUFBUSxVQUFVLGNBQWM7QUFBQSxJQUNwRjtBQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxzQkFBc0IsV0FBaUM7QUFDM0QsVUFBTSwyQkFBMkIsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUMvRSw2QkFBeUIsU0FBUyxRQUFRLEVBQUUsTUFBTSxtQkFBbUIsS0FBSyxRQUFRLENBQUM7QUFDbkYsNkJBQXlCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUNwRCxTQUFLLGtCQUFrQixJQUFJLGdDQUFjLHdCQUF3QjtBQUNqRSxTQUFLLGdCQUFnQixRQUFRLFNBQVMsWUFBWTtBQUNsRCxTQUFLLGdCQUFnQixTQUFTLEtBQUssTUFBTSxRQUFRLFFBQVEsRUFBRTtBQUUzRCxVQUFNLDBCQUEwQixVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzlFLDRCQUF3QixTQUFTLFFBQVEsRUFBRSxNQUFNLHdCQUF3QixLQUFLLFFBQVEsQ0FBQztBQUN2RixTQUFLLGlCQUFpQixJQUFJLGdDQUFjLHVCQUF1QjtBQUMvRCxTQUFLLGVBQWUsUUFBUSxTQUFTLFlBQVk7QUFDakQsU0FBSyxlQUFlLFFBQVEsU0FBUyxZQUFZO0FBQ2pELFNBQUssZUFBZSxTQUFTLEtBQUssTUFBTSxRQUFRLE9BQU8sRUFBRTtBQUV6RCxVQUFNLDBCQUEwQixVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzlFLDRCQUF3QixTQUFTLFFBQVEsRUFBRSxNQUFNLHdCQUF3QixLQUFLLFFBQVEsQ0FBQztBQUN2RixTQUFLLGlCQUFpQixJQUFJLGdDQUFjLHVCQUF1QjtBQUMvRCxTQUFLLGVBQWUsUUFBUSxTQUFTLFlBQVk7QUFDakQsU0FBSyxlQUFlLFFBQVEsU0FBUyxZQUFZO0FBQ2pELFNBQUssZUFBZSxTQUFTLEtBQUssTUFBTSxRQUFRLE9BQU8sRUFBRTtBQUN6RCxTQUFLLGdCQUFnQixTQUFTLFdBQVM7QUFDbkMsV0FBSyxNQUFNLFFBQVEsT0FBTztBQUMxQix5QkFBbUIsc0JBQXNCLEtBQUssZUFBZTtBQUFBLElBQ2pFLENBQUM7QUFDRCxTQUFLLGVBQWUsU0FBUyxXQUFTO0FBQ2xDLFdBQUssTUFBTSxRQUFRLE1BQU07QUFDekIseUJBQW1CLHNCQUFzQixLQUFLLGNBQWM7QUFBQSxJQUNoRSxDQUFDO0FBQ0QsU0FBSyxlQUFlLFNBQVMsV0FBUztBQUNsQyxXQUFLLE1BQU0sUUFBUSxNQUFNO0FBQ3pCLHlCQUFtQixzQkFBc0IsS0FBSyxjQUFjO0FBQUEsSUFDaEUsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQU8sdUJBQXVCLFdBQTJCLFFBQTRCO0FBRWpGLFNBQUssc0JBQXNCLFNBQVM7QUFBQSxFQUN4QztBQUFBLEVBRUEsQUFBTyxrQkFBMkI7QUFDOUIsUUFBSSxRQUFRO0FBQ1osUUFBSSxLQUFLLE1BQU0sUUFBUSxRQUFRLE1BQU0sV0FBVyxLQUFLLE1BQU0sUUFBUSxJQUFJLENBQUMsR0FBRztBQUN2RSx5QkFBbUIsbUJBQ2YsS0FBSyxpQkFDTCx5QkFDSjtBQUNBLGNBQVE7QUFBQSxJQUNaO0FBQ0EsUUFBSSxLQUFLLE1BQU0sUUFBUSxPQUFPLE1BQU0sV0FBVyxLQUFLLE1BQU0sUUFBUSxHQUFHLENBQUMsR0FBRztBQUNyRSx5QkFBbUIsbUJBQ2YsS0FBSyxnQkFDTCx5QkFDSjtBQUNBLGNBQVE7QUFBQSxJQUNaO0FBQ0EsUUFBSSxLQUFLLE1BQU0sUUFBUSxPQUFPLE1BQU0sV0FBVyxLQUFLLE1BQU0sUUFBUSxHQUFHLENBQUMsR0FBRztBQUNyRSx5QkFBbUIsbUJBQ2YsS0FBSyxnQkFDTCx5QkFDSjtBQUNBLGNBQVE7QUFBQSxJQUNaO0FBQ0EsV0FBTyxDQUFDO0FBQUEsRUFDWjtBQUFBLEVBRUEsQUFBTyx3QkFDSCxNQUNBLG1CQUNBLE9BQ0EsWUFDQSxPQUNBLFFBQ0EsV0FDSTtBQUNKLFVBQU0sYUFBYSxJQUFJLFlBQVksS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLFNBQVMsSUFBSSxZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQ25ILGVBQVcsUUFBUSxRQUFRLG1CQUFtQixtQkFBbUI7QUFDakUsZUFBVyxLQUFLO0FBQUEsRUFDcEI7QUFBQSxFQUVBLEFBQVEsZ0JBQWdCLGNBQWlDLGNBQWlDLE9BQWU7QUFDckcsUUFBSSxLQUFLLGFBQWEsS0FBSyxHQUFHO0FBQzFCLG1CQUFhLFlBQVksVUFBVTtBQUFBLElBQ3ZDLE9BQU87QUFDSCxtQkFBYSxTQUFTLFVBQVU7QUFBQSxJQUNwQztBQUNBLFFBQUksS0FBSyxhQUFhLEtBQUssR0FBRztBQUMxQixtQkFBYSxZQUFZLFVBQVU7QUFBQSxJQUN2QyxPQUFPO0FBQ0gsbUJBQWEsU0FBUyxVQUFVO0FBQUU7QUFBQSxJQUN0QztBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQU8sY0FDSCxJQUNBLEdBQ0EsZ0JBQ0EsUUFBMkYsQ0FBQyxHQUN4RjtBQWpPWjtBQWtPUSxVQUFNLE1BQU07QUFDWixVQUFNLGFBQWMsR0FBRyxHQUFHLFFBQVEsRUFBRSxLQUFLLE1BQU0sT0FBTyxLQUFLO0FBQzNELG1CQUFlLFlBQVksVUFBVTtBQUNyQyxVQUFNLGlCQUFpQixlQUFlLFVBQVUsQ0FBQyxDQUFDO0FBQ2xELFVBQU0sUUFBUSxlQUFlLFNBQVMsT0FBTztBQUM3QyxVQUFNLFFBQVEsRUFBRSxLQUFLLE1BQU07QUFFM0IsVUFBTSxlQUFlLGVBQWUsVUFBVSxFQUFFLEtBQUssV0FBVyxDQUFDO0FBR2pFLFVBQU0sYUFBYSxlQUFlLFNBQVMsUUFBUTtBQUNuRCxtQ0FBUSxZQUFZLFVBQVUsc0JBQWlCO0FBRy9DLFVBQU0sa0JBQWtCLGVBQWUsU0FBUyxRQUFRO0FBQ3hELG1DQUFRLGlCQUFpQixZQUFZO0FBR3JDLFVBQU0sa0JBQWtCLGVBQWUsU0FBUyxRQUFRO0FBQ3hELG1DQUFRLGlCQUFpQixhQUFhO0FBRXRDLFFBQUksQ0FBQyxzQ0FBTyxZQUFQLG1CQUFnQixXQUFVO0FBQzNCLGlCQUFXLEtBQUs7QUFDaEIsc0JBQWdCLEtBQUs7QUFDckIsc0JBQWdCLEtBQUs7QUFDckIsbUJBQWEsS0FBSztBQUVsQixxQkFBZSxjQUFjLE1BQU07QUFDL0IsbUJBQVcsS0FBSztBQUNoQix3QkFBZ0IsS0FBSztBQUNyQix3QkFBZ0IsS0FBSztBQUNyQixxQkFBYSxLQUFLO0FBQUEsTUFDdEI7QUFDQSxxQkFBZSxhQUFhLE1BQU07QUFDOUIsbUJBQVcsS0FBSztBQUNoQix3QkFBZ0IsS0FBSztBQUNyQix3QkFBZ0IsS0FBSztBQUNyQixxQkFBYSxLQUFLO0FBQUEsTUFDdEI7QUFBQSxJQUNKO0FBRUEsVUFBTSxlQUFlLGVBQWUsU0FBUyxRQUFRO0FBQ3JELG1DQUFRLGNBQWMsV0FBVztBQUNqQyxpQkFBYSxVQUFVLE1BQVk7QUFDL0IsVUFBSSxLQUFLLGNBQWMsTUFBTSxLQUFLLEdBQUc7QUFDakMsY0FBTSxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsS0FBSyxJQUFJO0FBQ3BFLFlBQUksZ0JBQWdCLDJCQUFTLEtBQUssYUFBYSxNQUFNO0FBQ2pELGdCQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLE1BQU0sTUFBTSxFQUFFLENBQUMsR0FBRyxJQUFJO0FBQ2hHLGVBQUssZ0JBQWdCLGlCQUFpQixpQkFBaUIsTUFBTSxLQUFLO0FBQUEsUUFDdEU7QUFDQSx1QkFBZSxZQUFZLGNBQWM7QUFBQSxNQUM3QztBQUFBLElBQ0o7QUFDQSxxREFBZ0IsWUFBWTtBQUM1QixVQUFNLGFBQWEsZUFBZSxTQUFTLFFBQVE7QUFDbkQsbUNBQVEsWUFBWSxPQUFPO0FBQzNCLGVBQVcsVUFBVSxDQUFDLE1BQU07QUFDeEIscUJBQWUsWUFBWSxjQUFjO0FBQ3pDLHFCQUFlLFlBQVksVUFBVTtBQUNyQyxxQkFBZSxZQUFZLGVBQWU7QUFDMUMscUJBQWUsWUFBWSxVQUFVO0FBQ3JDLHFCQUFlLFlBQVksZUFBZTtBQUMxQyxxQkFBZSxZQUFZLFlBQVk7QUFBQSxJQUMzQztBQUNBLG1CQUFlLFlBQVksVUFBVTtBQUNyQyxVQUFNLE1BQU07QUFFWixVQUFNLFVBQVUsQ0FBQyxNQUFNO0FBQ25CLFVBQUksQ0FBQyxLQUFLLGNBQWMsTUFBTSxLQUFLLEdBQUc7QUFDbEMsY0FBTSxTQUFTLFlBQVk7QUFDM0IscUJBQWEsU0FBUyxVQUFVO0FBQUEsTUFDcEMsT0FBTztBQUNILGNBQU0sWUFBWSxZQUFZO0FBQzlCLHFCQUFhLFlBQVksVUFBVTtBQUFBLE1BQ3ZDO0FBQUEsSUFDSjtBQUVBLFVBQU0sWUFBWSxDQUFPLE1BQU07QUFDM0IsVUFBSSxFQUFFLFFBQVEsU0FBUztBQUNuQixZQUFJLEtBQUssY0FBYyxNQUFNLEtBQUssR0FBRztBQUNqQyxnQkFBTSxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsS0FBSyxJQUFJO0FBQ3BFLGNBQUksZ0JBQWdCLDJCQUFTLEtBQUssYUFBYSxNQUFNO0FBQ2pELGtCQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLE1BQU0sTUFBTSxFQUFFLENBQUMsR0FBRyxJQUFJO0FBQ2hHLGlCQUFLLGdCQUFnQixpQkFBaUIsaUJBQWlCLE1BQU0sS0FBSztBQUFBLFVBQ3RFO0FBQ0EseUJBQWUsWUFBWSxjQUFjO0FBQUEsUUFDN0M7QUFBQSxNQUNKO0FBQ0EsVUFBSSxFQUFFLFFBQVEsVUFBVTtBQUNwQix1QkFBZSxZQUFZLGNBQWM7QUFDekMsdUJBQWUsWUFBWSxVQUFVO0FBQ3JDLHVCQUFlLFlBQVksZUFBZTtBQUMxQyx1QkFBZSxZQUFZLFVBQVU7QUFDckMsdUJBQWUsWUFBWSxlQUFlO0FBQzFDLHVCQUFlLFlBQVksWUFBWTtBQUFBLE1BQzNDO0FBQUEsSUFDSjtBQUVBLGVBQVcsVUFBVSxNQUFNO0FBQ3ZCLHFCQUFlLFlBQVksVUFBVTtBQUNyQyxxQkFBZSxZQUFZLFVBQVU7QUFDckMscUJBQWUsWUFBWSxlQUFlO0FBQzFDLHFCQUFlLFlBQVksZUFBZTtBQUMxQyxxQkFBZSxZQUFZLFlBQVk7QUFDdkMscUJBQWUsWUFBWSxjQUFjO0FBQ3pDLFlBQU0sTUFBTTtBQUFBLElBQ2hCO0FBR0Esb0JBQWdCLFVBQVUsTUFBWTtBQUNsQyxVQUFJLEtBQUssYUFBYSxFQUFFLEtBQUssTUFBTSxLQUFLLEdBQUc7QUFDdkMsY0FBTSxFQUFFLFNBQVMsS0FBSyxNQUFNO0FBQzVCLGNBQU0sUUFBUSxXQUFXLElBQUk7QUFDN0IsY0FBTSxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsUUFBUSxPQUFPO0FBQzFFLFlBQUksZ0JBQWdCLDJCQUFTLEtBQUssYUFBYSxNQUFNO0FBQ2pELGdCQUFNLFdBQVksRUFBQyxDQUFDLFFBQVEsRUFBRSxLQUFLLE1BQU0sUUFBUSxRQUFRLEVBQUUsS0FBSyxNQUFNLFFBQVEsR0FBRyxTQUFTO0FBQzFGLGdCQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLFNBQVMsRUFBRSxDQUFDLEdBQUcsSUFBSTtBQUM3RixlQUFLLGdCQUFnQixpQkFBaUIsaUJBQWlCLFFBQVE7QUFBQSxRQUNuRTtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBR0Esb0JBQWdCLFVBQVUsTUFBWTtBQUNsQyxVQUFJLEtBQUssYUFBYSxFQUFFLEtBQUssTUFBTSxLQUFLLEdBQUc7QUFDdkMsY0FBTSxFQUFFLFNBQVMsS0FBSyxNQUFNO0FBQzVCLGNBQU0sUUFBUSxXQUFXLElBQUk7QUFDN0IsY0FBTSxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsUUFBUSxPQUFPO0FBQzFFLFlBQUksZ0JBQWdCLDJCQUFTLEtBQUssYUFBYSxNQUFNO0FBQ2pELGdCQUFNLFdBQVksRUFBQyxDQUFDLFFBQVEsRUFBRSxLQUFLLE1BQU0sUUFBUSxRQUFRLEVBQUUsS0FBSyxNQUFNLFFBQVEsR0FBRyxTQUFTO0FBQzFGLGdCQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLFNBQVMsRUFBRSxDQUFDLEdBQUcsSUFBSTtBQUM3RixlQUFLLGdCQUFnQixpQkFBaUIsaUJBQWlCLFFBQVE7QUFBQSxRQUNuRTtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBR0EsbUJBQWUsWUFBWSxjQUFjO0FBQ3pDLG1CQUFlLFlBQVksVUFBVTtBQUNyQyxtQkFBZSxZQUFZLGVBQWU7QUFDMUMsbUJBQWUsWUFBWSxVQUFVO0FBQ3JDLG1CQUFlLFlBQVksZUFBZTtBQUMxQyxtQkFBZSxZQUFZLFlBQVk7QUFDdkMsU0FBSyxnQkFBZ0IsaUJBQWlCLGlCQUFpQixFQUFFLEtBQUssTUFBTSxLQUFLO0FBQUEsRUFDN0U7QUFDSjs7O0FFbFhBLHdCQUFvRDs7O0FDRHBELHdCQUFxRDs7O0FDQTlDLElBQUssUUFBTCxrQkFBSyxVQUFMO0FBQ0gsd0JBQWU7QUFDZixnQ0FBdUI7QUFDdkIsK0JBQXNCO0FBSGQ7QUFBQTtBQU1MLElBQU0sTUFBeUM7QUFBQSxFQUNsRCxjQUFjO0FBQUEsRUFDZCxzQkFBc0I7QUFBQSxFQUN0QixxQkFBcUI7QUFDekI7QUFFTyxJQUFNLGNBQWlEO0FBQUEsRUFDMUQsY0FBYztBQUFBLEVBQ2Qsc0JBQXNCO0FBQUEsRUFDdEIscUJBQXFCO0FBQ3pCOzs7QURSQSxJQUFxQixvQkFBckIsY0FBK0MsK0JBQW9CO0FBQUEsRUFJL0QsWUFDWSxRQUNBLE1BQ0EsT0FDQSxPQUNBLGFBQXFCLElBQ3JCLFFBQWlCLE9BQ2pCLFNBQWtCLE9BQ2xCLFlBQXFCLE9BQy9CO0FBQ0UsVUFBTSxPQUFPLEdBQUc7QUFUUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1IsU0FBSyxZQUFZLFNBQVMsZUFBZTtBQUFBLEVBQzdDO0FBQUEsRUFFQSxBQUFNLFNBQXdCO0FBQUE7QUFDMUIsb0RBQU0sZUFBTixJQUFhO0FBQ2IsWUFBTSxpQkFBaUIsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzVFLHFCQUFlLFlBQVksS0FBSyxPQUFPO0FBQ3ZDLFdBQUssWUFBWSxLQUFLLFNBQVMsRUFBRSxRQUFRLGNBQWM7QUFDdkQsWUFBTSxrQkFBa0IsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQzVFLHNCQUFnQixVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDM0MsWUFBTSxnQkFBZ0IsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLE9BQU8sQ0FBQztBQUMvRCxvQkFBYyxRQUFRLHFCQUFxQjtBQUUzQyxXQUFLLFlBQVksSUFBSSxrQ0FBZ0IsY0FBYztBQUNuRCxXQUFLLFVBQVUsUUFBUSxNQUFNO0FBQzdCLFdBQUssVUFBVSxRQUFRLE1BQU0sS0FBSyxzQkFBc0IsQ0FBQztBQUN6RCxXQUFLLFVBQVUsT0FBTztBQUN0QixXQUFLLFVBQVUsV0FBVyx1Q0FBdUM7QUFDakUsV0FBSyxVQUFVLFNBQVMsS0FBSztBQUU3QixZQUFNLGVBQWUsSUFBSSxrQ0FBZ0IsZUFBZTtBQUN4RCxtQkFBYSxRQUFRLE9BQU87QUFDNUIsbUJBQWEsUUFBUSxNQUFNLEtBQUssTUFBTSxDQUFDO0FBQ3ZDLG1CQUFhLFdBQVcsUUFBUTtBQUVoQyxZQUFNLGNBQWMsSUFBSSxrQ0FBZ0IsZUFBZTtBQUN2RCxrQkFBWSxRQUFRLFFBQVE7QUFDNUIsa0JBQVksUUFBUSxNQUFZO0FBQzVCLGNBQU0sS0FBSyxZQUFZO0FBQ3ZCLGFBQUssTUFBTTtBQUFBLE1BQ2YsRUFBQztBQUNELGtCQUFZLFNBQVMsU0FBUyxRQUFRO0FBQ3RDLGtCQUFZLFdBQVcsdUJBQXVCO0FBQzlDLFdBQUssUUFBUSxZQUFZLGVBQWU7QUFBQSxJQUM1QztBQUFBO0FBQUEsRUFFQSxBQUFNLHdCQUF1QztBQUFBO0FBM0RqRDtBQTREUSxZQUFNLFdBQVcsS0FBSyxRQUFRO0FBQzlCLFlBQU0sZ0JBQWdCLGlCQUFLLE9BQU8sV0FBVyxZQUFZLElBQUksS0FBSyxLQUFLLElBQUksTUFBckQsbUJBQXdELEtBQUssV0FBUyxNQUFNLFNBQVMsS0FBSyxNQUFNLFVBQWhHLG1CQUF1RztBQUM3SCxVQUFJLGVBQWU7QUFDZixjQUFNLFlBQVksS0FBSyxPQUFPLFdBQVcsZ0JBQWdCLElBQUksYUFBYTtBQUMxRSxjQUFNLHFCQUFxQix1Q0FBVyxXQUFXLEtBQUssVUFBUSxLQUFLLFNBQVMsS0FBSyxNQUFNO0FBQ3ZGLFlBQUksYUFBYSxvQkFBb0I7QUFDakMsY0FBSTtBQUNKLGNBQUksTUFBTSxRQUFRLG1CQUFtQixPQUFPLEdBQUc7QUFDM0MseUJBQWEsQ0FBQyxHQUFHLG1CQUFtQixTQUFTLFFBQVE7QUFDckQsa0JBQU0sVUFBVSxnQkFBZ0IsbUJBQW1CLE1BQU0sbUJBQW1CLE1BQU0sWUFBWSxrQkFBa0I7QUFBQSxVQUNwSCxXQUFXLG1CQUFtQixRQUFRLGVBQWUsK0JBQW9DO0FBQ3JGLHlCQUFhLG1CQUFtQixRQUFRO0FBQ3hDLHVCQUFXLEdBQUcsT0FBTyxLQUFLLG1CQUFtQixRQUFRLFVBQVUsRUFBRSxTQUFTLE9BQU87QUFDakYsa0JBQU0sVUFBVSxnQkFBZ0IsbUJBQW1CLE1BQU0sbUJBQW1CLE1BQU0sWUFBWSxrQkFBa0I7QUFBQSxVQUNwSCxXQUFXLG1CQUFtQixRQUFRLGVBQWUsK0NBQTRDO0FBQzdGLGtCQUFNLGFBQWEsS0FBSyxPQUFPLElBQUksTUFBTSxzQkFBc0IsbUJBQW1CLFFBQVEsa0JBQWtCO0FBQzVHLGdCQUFJLHNCQUFzQiwyQkFBUyxXQUFXLGFBQWEsTUFBTTtBQUM3RCxvQkFBTSxTQUFTLE1BQU0sS0FBSyxPQUFPLElBQUksTUFBTSxLQUFLLFVBQVU7QUFDMUQsbUJBQUssT0FBTyxJQUFJLE1BQU0sT0FBTyxZQUFZLEdBQUc7QUFBQSxFQUFXLFVBQVU7QUFBQSxZQUNyRTtBQUFBLFVBQ0osT0FBTztBQUNILHlCQUFhLG1CQUFtQjtBQUNoQyx1QkFBVyxHQUFHLE9BQU8sS0FBSyxtQkFBbUIsT0FBTyxFQUFFLFNBQVMsT0FBTztBQUN0RSxrQkFBTSxVQUFVLGdCQUFnQixtQkFBbUIsTUFBTSxtQkFBbUIsTUFBTSxZQUFZLGtCQUFrQjtBQUFBLFVBQ3BIO0FBQUEsUUFDSjtBQUFBLE1BQ0osT0FBTztBQUNILGNBQU0sY0FBYyxLQUFLLE9BQU8sU0FBUyxhQUFhLEtBQUssV0FBUyxNQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDbEcsWUFBSSw0Q0FBYSxRQUFRLGdCQUFlLCtDQUE0QztBQUNoRixnQkFBTSxhQUFhLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLFlBQVksUUFBUSxrQkFBa0I7QUFDckcsY0FBSSxzQkFBc0IsMkJBQVMsV0FBVyxhQUFhLE1BQU07QUFDN0Qsa0JBQU0sU0FBUyxNQUFNLEtBQUssT0FBTyxJQUFJLE1BQU0sS0FBSyxVQUFVO0FBQzFELGlCQUFLLE9BQU8sSUFBSSxNQUFNLE9BQU8sWUFBWSxHQUFHO0FBQUEsRUFBVyxVQUFVO0FBQUEsVUFDckU7QUFBQSxRQUNKLFdBQVcsNENBQWEsUUFBUSxnQkFBZSwrQkFBb0M7QUFDL0UsZ0JBQU0sdUJBQXVCLEtBQUssT0FBTyxrQkFBa0IsS0FBSyxPQUFLLEVBQUUsTUFBTSxLQUFLLE1BQU0sRUFBRTtBQUMxRixjQUFJLHNCQUFzQjtBQUN0QixrQkFBTSxhQUFhLHFCQUFxQixRQUFRO0FBQ2hELHVCQUFXLEdBQUcsT0FBTyxLQUFLLFVBQVUsRUFBRSxTQUFTLE9BQU87QUFBQSxVQUMxRDtBQUNBLGVBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0I7QUFBQSxNQUNKO0FBQ0EsWUFBTSxLQUFLLFNBQVMsUUFBUTtBQUM1QixXQUFLLE1BQU07QUFBQSxJQUNmO0FBQUE7QUFBQSxFQUVBLEFBQU0sY0FBYztBQUFBO0FBQ2hCLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxNQUFNLE1BQU0sU0FBUyxFQUFFLE9BQU8sR0FBRyxFQUFFLENBQUMsR0FBRyxLQUFLLE1BQU0sS0FBSyxZQUFZLEtBQUssT0FBTyxLQUFLLFFBQVEsS0FBSyxTQUFTO0FBQUEsSUFFMUo7QUFBQTtBQUFBLEVBRUEsZUFBZSxPQUF5QjtBQWhINUM7QUFpSFEsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsUUFBSTtBQUNKLFFBQUk7QUFBTyxlQUFTLE1BQU0sS0FBSyxLQUFLLEtBQUssSUFBSTtBQUM3QyxVQUFNLGVBQWUsSUFBSSxhQUFhLEtBQUssTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLLEtBQUs7QUFDOUUsVUFBTSxTQUFTLGFBQWEsZUFBZSxNQUFNLEVBQUUsT0FBTyxPQUFLLEVBQUUsWUFBWSxFQUFFLFNBQVMsTUFBTSxZQUFZLENBQUMsQ0FBQztBQUM1RyxRQUFJLEtBQUssV0FBVztBQUNoQixNQUFDLE9BQU8sS0FBSyxPQUFLLE1BQU0sS0FBSyxLQUFLLEtBQUssTUFBTSxRQUFRLGNBQWMsK0NBQTZDLENBQUMsUUFDN0csS0FBSyxVQUFVLFNBQVMsS0FBSyxJQUM3QixLQUFLLFVBQVUsU0FBUyxLQUFLO0FBQUEsSUFDckM7QUFBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxpQkFBaUIsT0FBZSxJQUFpQjtBQUM3QyxPQUFHLFFBQVEsS0FBSztBQUNoQixPQUFHLFNBQVMsaUJBQWlCO0FBQzdCLFFBQUksVUFBVSxLQUFLO0FBQU8sU0FBRyxTQUFTLGVBQWU7QUFBQSxFQUN6RDtBQUFBLEVBRUEsQUFBYyxTQUFTLE1BQTZCO0FBQUE7QUFDaEQsWUFBTSxXQUFXLEtBQUssUUFBUSxDQUFDLEVBQUUsTUFBTSxLQUFLLE1BQU0sTUFBTSxTQUFTLEVBQUUsT0FBTyxLQUFLLFNBQVMsRUFBRSxFQUFFLENBQUMsR0FBRyxLQUFLLE1BQU0sS0FBSyxZQUFZLEtBQUssT0FBTyxLQUFLLFFBQVEsS0FBSyxTQUFTO0FBQUEsSUFDdks7QUFBQTtBQUFBLEVBRUEsQUFBTSxtQkFBbUIsTUFBYyxLQUFpQztBQUFBO0FBQ3BFLFdBQUssU0FBUyxJQUFJO0FBQUEsSUFDdEI7QUFBQTtBQUNKOzs7QUV4SUEsd0JBQThGOzs7QUNEOUYsd0JBQXFDOzs7QUNBckMsd0JBQXFDOzs7QUNGOUIsSUFBSSxNQUFNO0FBQ1YsSUFBSSxTQUFTO0FBQ2IsSUFBSSxRQUFRO0FBQ1osSUFBSSxPQUFPO0FBQ1gsSUFBSSxPQUFPO0FBQ1gsSUFBSSxpQkFBaUIsQ0FBQyxLQUFLLFFBQVEsT0FBTyxJQUFJO0FBQzlDLElBQUksUUFBUTtBQUNaLElBQUksTUFBTTtBQUNWLElBQUksa0JBQWtCO0FBQ3RCLElBQUksV0FBVztBQUNmLElBQUksU0FBUztBQUNiLElBQUksWUFBWTtBQUNoQixJQUFJLHNCQUFtQywrQkFBZSxPQUFPLFNBQVUsS0FBSyxXQUFXO0FBQzVGLFNBQU8sSUFBSSxPQUFPLENBQUMsWUFBWSxNQUFNLE9BQU8sWUFBWSxNQUFNLEdBQUcsQ0FBQztBQUNwRSxHQUFHLENBQUMsQ0FBQztBQUNFLElBQUksYUFBMEIsaUJBQUMsRUFBRSxPQUFPLGdCQUFnQixDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sU0FBVSxLQUFLLFdBQVc7QUFDdEcsU0FBTyxJQUFJLE9BQU8sQ0FBQyxXQUFXLFlBQVksTUFBTSxPQUFPLFlBQVksTUFBTSxHQUFHLENBQUM7QUFDL0UsR0FBRyxDQUFDLENBQUM7QUFFRSxJQUFJLGFBQWE7QUFDakIsSUFBSSxPQUFPO0FBQ1gsSUFBSSxZQUFZO0FBRWhCLElBQUksYUFBYTtBQUNqQixJQUFJLE9BQU87QUFDWCxJQUFJLFlBQVk7QUFFaEIsSUFBSSxjQUFjO0FBQ2xCLElBQUksUUFBUTtBQUNaLElBQUksYUFBYTtBQUNqQixJQUFJLGlCQUFpQixDQUFDLFlBQVksTUFBTSxXQUFXLFlBQVksTUFBTSxXQUFXLGFBQWEsT0FBTyxVQUFVOzs7QUM5QnRHLHFCQUFxQixTQUFTO0FBQzNDLFNBQU8sVUFBVyxTQUFRLFlBQVksSUFBSSxZQUFZLElBQUk7QUFDNUQ7OztBQ0ZlLG1CQUFtQixNQUFNO0FBQ3RDLE1BQUksUUFBUSxNQUFNO0FBQ2hCLFdBQU87QUFBQSxFQUNUO0FBRUEsTUFBSSxLQUFLLFNBQVMsTUFBTSxtQkFBbUI7QUFDekMsUUFBSSxnQkFBZ0IsS0FBSztBQUN6QixXQUFPLGdCQUFnQixjQUFjLGVBQWUsU0FBUztBQUFBLEVBQy9EO0FBRUEsU0FBTztBQUNUOzs7QUNUQSxtQkFBbUIsTUFBTTtBQUN2QixNQUFJLGFBQWEsVUFBVSxJQUFJLEVBQUU7QUFDakMsU0FBTyxnQkFBZ0IsY0FBYyxnQkFBZ0I7QUFDdkQ7QUFFQSx1QkFBdUIsTUFBTTtBQUMzQixNQUFJLGFBQWEsVUFBVSxJQUFJLEVBQUU7QUFDakMsU0FBTyxnQkFBZ0IsY0FBYyxnQkFBZ0I7QUFDdkQ7QUFFQSxzQkFBc0IsTUFBTTtBQUUxQixNQUFJLE9BQU8sZUFBZSxhQUFhO0FBQ3JDLFdBQU87QUFBQSxFQUNUO0FBRUEsTUFBSSxhQUFhLFVBQVUsSUFBSSxFQUFFO0FBQ2pDLFNBQU8sZ0JBQWdCLGNBQWMsZ0JBQWdCO0FBQ3ZEOzs7QUNoQkEscUJBQXFCLE1BQU07QUFDekIsTUFBSSxRQUFRLEtBQUs7QUFDakIsU0FBTyxLQUFLLE1BQU0sUUFBUSxFQUFFLFFBQVEsU0FBVSxNQUFNO0FBQ2xELFFBQUksUUFBUSxNQUFNLE9BQU8sU0FBUyxDQUFDO0FBQ25DLFFBQUksYUFBYSxNQUFNLFdBQVcsU0FBUyxDQUFDO0FBQzVDLFFBQUksVUFBVSxNQUFNLFNBQVM7QUFFN0IsUUFBSSxDQUFDLGNBQWMsT0FBTyxLQUFLLENBQUMsWUFBWSxPQUFPLEdBQUc7QUFDcEQ7QUFBQSxJQUNGO0FBS0EsV0FBTyxPQUFPLFFBQVEsT0FBTyxLQUFLO0FBQ2xDLFdBQU8sS0FBSyxVQUFVLEVBQUUsUUFBUSxTQUFVLE9BQU07QUFDOUMsVUFBSSxRQUFRLFdBQVc7QUFFdkIsVUFBSSxVQUFVLE9BQU87QUFDbkIsZ0JBQVEsZ0JBQWdCLEtBQUk7QUFBQSxNQUM5QixPQUFPO0FBQ0wsZ0JBQVEsYUFBYSxPQUFNLFVBQVUsT0FBTyxLQUFLLEtBQUs7QUFBQSxNQUN4RDtBQUFBLElBQ0YsQ0FBQztBQUFBLEVBQ0gsQ0FBQztBQUNIO0FBRUEsZ0JBQWdCLE9BQU87QUFDckIsTUFBSSxRQUFRLE1BQU07QUFDbEIsTUFBSSxnQkFBZ0I7QUFBQSxJQUNsQixRQUFRO0FBQUEsTUFDTixVQUFVLE1BQU0sUUFBUTtBQUFBLE1BQ3hCLE1BQU07QUFBQSxNQUNOLEtBQUs7QUFBQSxNQUNMLFFBQVE7QUFBQSxJQUNWO0FBQUEsSUFDQSxPQUFPO0FBQUEsTUFDTCxVQUFVO0FBQUEsSUFDWjtBQUFBLElBQ0EsV0FBVyxDQUFDO0FBQUEsRUFDZDtBQUNBLFNBQU8sT0FBTyxNQUFNLFNBQVMsT0FBTyxPQUFPLGNBQWMsTUFBTTtBQUMvRCxRQUFNLFNBQVM7QUFFZixNQUFJLE1BQU0sU0FBUyxPQUFPO0FBQ3hCLFdBQU8sT0FBTyxNQUFNLFNBQVMsTUFBTSxPQUFPLGNBQWMsS0FBSztBQUFBLEVBQy9EO0FBRUEsU0FBTyxXQUFZO0FBQ2pCLFdBQU8sS0FBSyxNQUFNLFFBQVEsRUFBRSxRQUFRLFNBQVUsTUFBTTtBQUNsRCxVQUFJLFVBQVUsTUFBTSxTQUFTO0FBQzdCLFVBQUksYUFBYSxNQUFNLFdBQVcsU0FBUyxDQUFDO0FBQzVDLFVBQUksa0JBQWtCLE9BQU8sS0FBSyxNQUFNLE9BQU8sZUFBZSxJQUFJLElBQUksTUFBTSxPQUFPLFFBQVEsY0FBYyxLQUFLO0FBRTlHLFVBQUksUUFBUSxnQkFBZ0IsT0FBTyxTQUFVLFFBQU8sVUFBVTtBQUM1RCxlQUFNLFlBQVk7QUFDbEIsZUFBTztBQUFBLE1BQ1QsR0FBRyxDQUFDLENBQUM7QUFFTCxVQUFJLENBQUMsY0FBYyxPQUFPLEtBQUssQ0FBQyxZQUFZLE9BQU8sR0FBRztBQUNwRDtBQUFBLE1BQ0Y7QUFFQSxhQUFPLE9BQU8sUUFBUSxPQUFPLEtBQUs7QUFDbEMsYUFBTyxLQUFLLFVBQVUsRUFBRSxRQUFRLFNBQVUsV0FBVztBQUNuRCxnQkFBUSxnQkFBZ0IsU0FBUztBQUFBLE1BQ25DLENBQUM7QUFBQSxJQUNILENBQUM7QUFBQSxFQUNIO0FBQ0Y7QUFHQSxJQUFPLHNCQUFRO0FBQUEsRUFDYixNQUFNO0FBQUEsRUFDTixTQUFTO0FBQUEsRUFDVCxPQUFPO0FBQUEsRUFDUCxJQUFJO0FBQUEsRUFDSjtBQUFBLEVBQ0EsVUFBVSxDQUFDLGVBQWU7QUFDNUI7OztBQ2xGZSwwQkFBMEIsV0FBVztBQUNsRCxTQUFPLFVBQVUsTUFBTSxHQUFHLEVBQUU7QUFDOUI7OztBQ0hPLElBQUksTUFBTSxLQUFLO0FBQ2YsSUFBSSxNQUFNLEtBQUs7QUFDZixJQUFJLFFBQVEsS0FBSzs7O0FDRlQsdUJBQXVCO0FBQ3BDLE1BQUksU0FBUyxVQUFVO0FBRXZCLE1BQUksVUFBVSxRQUFRLE9BQU8sUUFBUTtBQUNuQyxXQUFPLE9BQU8sT0FBTyxJQUFJLFNBQVUsTUFBTTtBQUN2QyxhQUFPLEtBQUssUUFBUSxNQUFNLEtBQUs7QUFBQSxJQUNqQyxDQUFDLEVBQUUsS0FBSyxHQUFHO0FBQUEsRUFDYjtBQUVBLFNBQU8sVUFBVTtBQUNuQjs7O0FDVGUsNEJBQTRCO0FBQ3pDLFNBQU8sQ0FBQyxpQ0FBaUMsS0FBSyxZQUFZLENBQUM7QUFDN0Q7OztBQ0NlLCtCQUErQixTQUFTLGNBQWMsaUJBQWlCO0FBQ3BGLE1BQUksaUJBQWlCLFFBQVE7QUFDM0IsbUJBQWU7QUFBQSxFQUNqQjtBQUVBLE1BQUksb0JBQW9CLFFBQVE7QUFDOUIsc0JBQWtCO0FBQUEsRUFDcEI7QUFFQSxNQUFJLGFBQWEsUUFBUSxzQkFBc0I7QUFDL0MsTUFBSSxTQUFTO0FBQ2IsTUFBSSxTQUFTO0FBRWIsTUFBSSxnQkFBZ0IsY0FBYyxPQUFPLEdBQUc7QUFDMUMsYUFBUyxRQUFRLGNBQWMsSUFBSSxNQUFNLFdBQVcsS0FBSyxJQUFJLFFBQVEsZUFBZSxJQUFJO0FBQ3hGLGFBQVMsUUFBUSxlQUFlLElBQUksTUFBTSxXQUFXLE1BQU0sSUFBSSxRQUFRLGdCQUFnQixJQUFJO0FBQUEsRUFDN0Y7QUFFQSxNQUFJLE9BQU8sVUFBVSxPQUFPLElBQUksVUFBVSxPQUFPLElBQUksUUFDakQsaUJBQWlCLEtBQUs7QUFFMUIsTUFBSSxtQkFBbUIsQ0FBQyxpQkFBaUIsS0FBSztBQUM5QyxNQUFJLElBQUssWUFBVyxPQUFRLHFCQUFvQixpQkFBaUIsZUFBZSxhQUFhLE1BQU07QUFDbkcsTUFBSSxJQUFLLFlBQVcsTUFBTyxxQkFBb0IsaUJBQWlCLGVBQWUsWUFBWSxNQUFNO0FBQ2pHLE1BQUksUUFBUSxXQUFXLFFBQVE7QUFDL0IsTUFBSSxTQUFTLFdBQVcsU0FBUztBQUNqQyxTQUFPO0FBQUEsSUFDTDtBQUFBLElBQ0E7QUFBQSxJQUNBLEtBQUs7QUFBQSxJQUNMLE9BQU8sSUFBSTtBQUFBLElBQ1gsUUFBUSxJQUFJO0FBQUEsSUFDWixNQUFNO0FBQUEsSUFDTjtBQUFBLElBQ0E7QUFBQSxFQUNGO0FBQ0Y7OztBQ3JDZSx1QkFBdUIsU0FBUztBQUM3QyxNQUFJLGFBQWEsc0JBQXNCLE9BQU87QUFHOUMsTUFBSSxRQUFRLFFBQVE7QUFDcEIsTUFBSSxTQUFTLFFBQVE7QUFFckIsTUFBSSxLQUFLLElBQUksV0FBVyxRQUFRLEtBQUssS0FBSyxHQUFHO0FBQzNDLFlBQVEsV0FBVztBQUFBLEVBQ3JCO0FBRUEsTUFBSSxLQUFLLElBQUksV0FBVyxTQUFTLE1BQU0sS0FBSyxHQUFHO0FBQzdDLGFBQVMsV0FBVztBQUFBLEVBQ3RCO0FBRUEsU0FBTztBQUFBLElBQ0wsR0FBRyxRQUFRO0FBQUEsSUFDWCxHQUFHLFFBQVE7QUFBQSxJQUNYO0FBQUEsSUFDQTtBQUFBLEVBQ0Y7QUFDRjs7O0FDdkJlLGtCQUFrQixRQUFRLE9BQU87QUFDOUMsTUFBSSxXQUFXLE1BQU0sZUFBZSxNQUFNLFlBQVk7QUFFdEQsTUFBSSxPQUFPLFNBQVMsS0FBSyxHQUFHO0FBQzFCLFdBQU87QUFBQSxFQUNULFdBQ1MsWUFBWSxhQUFhLFFBQVEsR0FBRztBQUN6QyxRQUFJLE9BQU87QUFFWCxPQUFHO0FBQ0QsVUFBSSxRQUFRLE9BQU8sV0FBVyxJQUFJLEdBQUc7QUFDbkMsZUFBTztBQUFBLE1BQ1Q7QUFHQSxhQUFPLEtBQUssY0FBYyxLQUFLO0FBQUEsSUFDakMsU0FBUztBQUFBLEVBQ1g7QUFHRixTQUFPO0FBQ1Q7OztBQ3JCZSwyQkFBMEIsU0FBUztBQUNoRCxTQUFPLFVBQVUsT0FBTyxFQUFFLGlCQUFpQixPQUFPO0FBQ3BEOzs7QUNGZSx3QkFBd0IsU0FBUztBQUM5QyxTQUFPLENBQUMsU0FBUyxNQUFNLElBQUksRUFBRSxRQUFRLFlBQVksT0FBTyxDQUFDLEtBQUs7QUFDaEU7OztBQ0ZlLDRCQUE0QixTQUFTO0FBRWxELFNBQVMsWUFBVSxPQUFPLElBQUksUUFBUSxnQkFDdEMsUUFBUSxhQUFhLE9BQU8sVUFBVTtBQUN4Qzs7O0FDRmUsdUJBQXVCLFNBQVM7QUFDN0MsTUFBSSxZQUFZLE9BQU8sTUFBTSxRQUFRO0FBQ25DLFdBQU87QUFBQSxFQUNUO0FBRUEsU0FHRSxRQUFRLGdCQUNSLFFBQVEsY0FDUixjQUFhLE9BQU8sSUFBSSxRQUFRLE9BQU8sU0FFdkMsbUJBQW1CLE9BQU87QUFHOUI7OztBQ1ZBLDZCQUE2QixTQUFTO0FBQ3BDLE1BQUksQ0FBQyxjQUFjLE9BQU8sS0FDMUIsa0JBQWlCLE9BQU8sRUFBRSxhQUFhLFNBQVM7QUFDOUMsV0FBTztBQUFBLEVBQ1Q7QUFFQSxTQUFPLFFBQVE7QUFDakI7QUFJQSw0QkFBNEIsU0FBUztBQUNuQyxNQUFJLFlBQVksV0FBVyxLQUFLLFlBQVksQ0FBQztBQUM3QyxNQUFJLE9BQU8sV0FBVyxLQUFLLFlBQVksQ0FBQztBQUV4QyxNQUFJLFFBQVEsY0FBYyxPQUFPLEdBQUc7QUFFbEMsUUFBSSxhQUFhLGtCQUFpQixPQUFPO0FBRXpDLFFBQUksV0FBVyxhQUFhLFNBQVM7QUFDbkMsYUFBTztBQUFBLElBQ1Q7QUFBQSxFQUNGO0FBRUEsTUFBSSxjQUFjLGNBQWMsT0FBTztBQUV2QyxNQUFJLGFBQWEsV0FBVyxHQUFHO0FBQzdCLGtCQUFjLFlBQVk7QUFBQSxFQUM1QjtBQUVBLFNBQU8sY0FBYyxXQUFXLEtBQUssQ0FBQyxRQUFRLE1BQU0sRUFBRSxRQUFRLFlBQVksV0FBVyxDQUFDLElBQUksR0FBRztBQUMzRixRQUFJLE1BQU0sa0JBQWlCLFdBQVc7QUFJdEMsUUFBSSxJQUFJLGNBQWMsVUFBVSxJQUFJLGdCQUFnQixVQUFVLElBQUksWUFBWSxXQUFXLENBQUMsYUFBYSxhQUFhLEVBQUUsUUFBUSxJQUFJLFVBQVUsTUFBTSxNQUFNLGFBQWEsSUFBSSxlQUFlLFlBQVksYUFBYSxJQUFJLFVBQVUsSUFBSSxXQUFXLFFBQVE7QUFDcFAsYUFBTztBQUFBLElBQ1QsT0FBTztBQUNMLG9CQUFjLFlBQVk7QUFBQSxJQUM1QjtBQUFBLEVBQ0Y7QUFFQSxTQUFPO0FBQ1Q7QUFJZSx5QkFBeUIsU0FBUztBQUMvQyxNQUFJLFVBQVMsVUFBVSxPQUFPO0FBQzlCLE1BQUksZUFBZSxvQkFBb0IsT0FBTztBQUU5QyxTQUFPLGdCQUFnQixlQUFlLFlBQVksS0FBSyxrQkFBaUIsWUFBWSxFQUFFLGFBQWEsVUFBVTtBQUMzRyxtQkFBZSxvQkFBb0IsWUFBWTtBQUFBLEVBQ2pEO0FBRUEsTUFBSSxnQkFBaUIsYUFBWSxZQUFZLE1BQU0sVUFBVSxZQUFZLFlBQVksTUFBTSxVQUFVLGtCQUFpQixZQUFZLEVBQUUsYUFBYSxXQUFXO0FBQzFKLFdBQU87QUFBQSxFQUNUO0FBRUEsU0FBTyxnQkFBZ0IsbUJBQW1CLE9BQU8sS0FBSztBQUN4RDs7O0FDcEVlLGtDQUFrQyxXQUFXO0FBQzFELFNBQU8sQ0FBQyxPQUFPLFFBQVEsRUFBRSxRQUFRLFNBQVMsS0FBSyxJQUFJLE1BQU07QUFDM0Q7OztBQ0RPLGdCQUFnQixNQUFLLE9BQU8sTUFBSztBQUN0QyxTQUFPLElBQVEsTUFBSyxJQUFRLE9BQU8sSUFBRyxDQUFDO0FBQ3pDO0FBQ08sd0JBQXdCLE1BQUssT0FBTyxNQUFLO0FBQzlDLE1BQUksSUFBSSxPQUFPLE1BQUssT0FBTyxJQUFHO0FBQzlCLFNBQU8sSUFBSSxPQUFNLE9BQU07QUFDekI7OztBQ1BlLDhCQUE4QjtBQUMzQyxTQUFPO0FBQUEsSUFDTCxLQUFLO0FBQUEsSUFDTCxPQUFPO0FBQUEsSUFDUCxRQUFRO0FBQUEsSUFDUixNQUFNO0FBQUEsRUFDUjtBQUNGOzs7QUNOZSw0QkFBNEIsZUFBZTtBQUN4RCxTQUFPLE9BQU8sT0FBTyxDQUFDLEdBQUcsbUJBQW1CLEdBQUcsYUFBYTtBQUM5RDs7O0FDSGUseUJBQXlCLE9BQU8sTUFBTTtBQUNuRCxTQUFPLEtBQUssT0FBTyxTQUFVLFNBQVMsS0FBSztBQUN6QyxZQUFRLE9BQU87QUFDZixXQUFPO0FBQUEsRUFDVCxHQUFHLENBQUMsQ0FBQztBQUNQOzs7QUNNQSxJQUFJLGtCQUFrQiwwQkFBeUIsU0FBUyxPQUFPO0FBQzdELFlBQVUsT0FBTyxZQUFZLGFBQWEsUUFBUSxPQUFPLE9BQU8sQ0FBQyxHQUFHLE1BQU0sT0FBTztBQUFBLElBQy9FLFdBQVcsTUFBTTtBQUFBLEVBQ25CLENBQUMsQ0FBQyxJQUFJO0FBQ04sU0FBTyxtQkFBbUIsT0FBTyxZQUFZLFdBQVcsVUFBVSxnQkFBZ0IsU0FBUyxjQUFjLENBQUM7QUFDNUc7QUFFQSxlQUFlLE1BQU07QUFDbkIsTUFBSTtBQUVKLE1BQUksUUFBUSxLQUFLLE9BQ2IsT0FBTyxLQUFLLE1BQ1osV0FBVSxLQUFLO0FBQ25CLE1BQUksZUFBZSxNQUFNLFNBQVM7QUFDbEMsTUFBSSxpQkFBZ0IsTUFBTSxjQUFjO0FBQ3hDLE1BQUksZ0JBQWdCLGlCQUFpQixNQUFNLFNBQVM7QUFDcEQsTUFBSSxPQUFPLHlCQUF5QixhQUFhO0FBQ2pELE1BQUksYUFBYSxDQUFDLE1BQU0sS0FBSyxFQUFFLFFBQVEsYUFBYSxLQUFLO0FBQ3pELE1BQUksTUFBTSxhQUFhLFdBQVc7QUFFbEMsTUFBSSxDQUFDLGdCQUFnQixDQUFDLGdCQUFlO0FBQ25DO0FBQUEsRUFDRjtBQUVBLE1BQUksZ0JBQWdCLGdCQUFnQixTQUFRLFNBQVMsS0FBSztBQUMxRCxNQUFJLFlBQVksY0FBYyxZQUFZO0FBQzFDLE1BQUksVUFBVSxTQUFTLE1BQU0sTUFBTTtBQUNuQyxNQUFJLFVBQVUsU0FBUyxNQUFNLFNBQVM7QUFDdEMsTUFBSSxVQUFVLE1BQU0sTUFBTSxVQUFVLE9BQU8sTUFBTSxNQUFNLFVBQVUsUUFBUSxlQUFjLFFBQVEsTUFBTSxNQUFNLE9BQU87QUFDbEgsTUFBSSxZQUFZLGVBQWMsUUFBUSxNQUFNLE1BQU0sVUFBVTtBQUM1RCxNQUFJLG9CQUFvQixnQkFBZ0IsWUFBWTtBQUNwRCxNQUFJLGFBQWEsb0JBQW9CLFNBQVMsTUFBTSxrQkFBa0IsZ0JBQWdCLElBQUksa0JBQWtCLGVBQWUsSUFBSTtBQUMvSCxNQUFJLG9CQUFvQixVQUFVLElBQUksWUFBWTtBQUdsRCxNQUFJLE9BQU0sY0FBYztBQUN4QixNQUFJLE9BQU0sYUFBYSxVQUFVLE9BQU8sY0FBYztBQUN0RCxNQUFJLFNBQVMsYUFBYSxJQUFJLFVBQVUsT0FBTyxJQUFJO0FBQ25ELE1BQUksVUFBUyxPQUFPLE1BQUssUUFBUSxJQUFHO0FBRXBDLE1BQUksV0FBVztBQUNmLFFBQU0sY0FBYyxRQUFTLHlCQUF3QixDQUFDLEdBQUcsc0JBQXNCLFlBQVksU0FBUSxzQkFBc0IsZUFBZSxVQUFTLFFBQVE7QUFDM0o7QUFFQSxpQkFBZ0IsT0FBTztBQUNyQixNQUFJLFFBQVEsTUFBTSxPQUNkLFdBQVUsTUFBTTtBQUNwQixNQUFJLG1CQUFtQixTQUFRLFNBQzNCLGVBQWUscUJBQXFCLFNBQVMsd0JBQXdCO0FBRXpFLE1BQUksZ0JBQWdCLE1BQU07QUFDeEI7QUFBQSxFQUNGO0FBR0EsTUFBSSxPQUFPLGlCQUFpQixVQUFVO0FBQ3BDLG1CQUFlLE1BQU0sU0FBUyxPQUFPLGNBQWMsWUFBWTtBQUUvRCxRQUFJLENBQUMsY0FBYztBQUNqQjtBQUFBLElBQ0Y7QUFBQSxFQUNGO0FBRUEsTUFBSSxNQUF1QztBQUN6QyxRQUFJLENBQUMsY0FBYyxZQUFZLEdBQUc7QUFDaEMsY0FBUSxNQUFNLENBQUMsdUVBQXVFLHVFQUF1RSxZQUFZLEVBQUUsS0FBSyxHQUFHLENBQUM7QUFBQSxJQUN0TDtBQUFBLEVBQ0Y7QUFFQSxNQUFJLENBQUMsU0FBUyxNQUFNLFNBQVMsUUFBUSxZQUFZLEdBQUc7QUFDbEQsUUFBSSxNQUF1QztBQUN6QyxjQUFRLE1BQU0sQ0FBQyx1RUFBdUUsVUFBVSxFQUFFLEtBQUssR0FBRyxDQUFDO0FBQUEsSUFDN0c7QUFFQTtBQUFBLEVBQ0Y7QUFFQSxRQUFNLFNBQVMsUUFBUTtBQUN6QjtBQUdBLElBQU8sZ0JBQVE7QUFBQSxFQUNiLE1BQU07QUFBQSxFQUNOLFNBQVM7QUFBQSxFQUNULE9BQU87QUFBQSxFQUNQLElBQUk7QUFBQSxFQUNKLFFBQVE7QUFBQSxFQUNSLFVBQVUsQ0FBQyxlQUFlO0FBQUEsRUFDMUIsa0JBQWtCLENBQUMsaUJBQWlCO0FBQ3RDOzs7QUNwR2Usc0JBQXNCLFdBQVc7QUFDOUMsU0FBTyxVQUFVLE1BQU0sR0FBRyxFQUFFO0FBQzlCOzs7QUNPQSxJQUFJLGFBQWE7QUFBQSxFQUNmLEtBQUs7QUFBQSxFQUNMLE9BQU87QUFBQSxFQUNQLFFBQVE7QUFBQSxFQUNSLE1BQU07QUFDUjtBQUlBLDJCQUEyQixNQUFNO0FBQy9CLE1BQUksSUFBSSxLQUFLLEdBQ1QsSUFBSSxLQUFLO0FBQ2IsTUFBSSxNQUFNO0FBQ1YsTUFBSSxNQUFNLElBQUksb0JBQW9CO0FBQ2xDLFNBQU87QUFBQSxJQUNMLEdBQUcsTUFBTSxJQUFJLEdBQUcsSUFBSSxPQUFPO0FBQUEsSUFDM0IsR0FBRyxNQUFNLElBQUksR0FBRyxJQUFJLE9BQU87QUFBQSxFQUM3QjtBQUNGO0FBRU8scUJBQXFCLE9BQU87QUFDakMsTUFBSTtBQUVKLE1BQUksVUFBUyxNQUFNLFFBQ2YsYUFBYSxNQUFNLFlBQ25CLFlBQVksTUFBTSxXQUNsQixZQUFZLE1BQU0sV0FDbEIsVUFBVSxNQUFNLFNBQ2hCLFdBQVcsTUFBTSxVQUNqQixrQkFBa0IsTUFBTSxpQkFDeEIsV0FBVyxNQUFNLFVBQ2pCLGVBQWUsTUFBTSxjQUNyQixVQUFVLE1BQU07QUFDcEIsTUFBSSxhQUFhLFFBQVEsR0FDckIsSUFBSSxlQUFlLFNBQVMsSUFBSSxZQUNoQyxhQUFhLFFBQVEsR0FDckIsSUFBSSxlQUFlLFNBQVMsSUFBSTtBQUVwQyxNQUFJLFFBQVEsT0FBTyxpQkFBaUIsYUFBYSxhQUFhO0FBQUEsSUFDNUQ7QUFBQSxJQUNBO0FBQUEsRUFDRixDQUFDLElBQUk7QUFBQSxJQUNIO0FBQUEsSUFDQTtBQUFBLEVBQ0Y7QUFFQSxNQUFJLE1BQU07QUFDVixNQUFJLE1BQU07QUFDVixNQUFJLE9BQU8sUUFBUSxlQUFlLEdBQUc7QUFDckMsTUFBSSxPQUFPLFFBQVEsZUFBZSxHQUFHO0FBQ3JDLE1BQUksUUFBUTtBQUNaLE1BQUksUUFBUTtBQUNaLE1BQUksTUFBTTtBQUVWLE1BQUksVUFBVTtBQUNaLFFBQUksZUFBZSxnQkFBZ0IsT0FBTTtBQUN6QyxRQUFJLGFBQWE7QUFDakIsUUFBSSxZQUFZO0FBRWhCLFFBQUksaUJBQWlCLFVBQVUsT0FBTSxHQUFHO0FBQ3RDLHFCQUFlLG1CQUFtQixPQUFNO0FBRXhDLFVBQUksa0JBQWlCLFlBQVksRUFBRSxhQUFhLFlBQVksYUFBYSxZQUFZO0FBQ25GLHFCQUFhO0FBQ2Isb0JBQVk7QUFBQSxNQUNkO0FBQUEsSUFDRjtBQUdBLG1CQUFlO0FBRWYsUUFBSSxjQUFjLE9BQVEsZUFBYyxRQUFRLGNBQWMsVUFBVSxjQUFjLEtBQUs7QUFDekYsY0FBUTtBQUNSLFVBQUksVUFBVSxXQUFXLGlCQUFpQixPQUFPLElBQUksaUJBQWlCLElBQUksZUFBZSxTQUN6RixhQUFhO0FBQ2IsV0FBSyxVQUFVLFdBQVc7QUFDMUIsV0FBSyxrQkFBa0IsSUFBSTtBQUFBLElBQzdCO0FBRUEsUUFBSSxjQUFjLFFBQVMsZUFBYyxPQUFPLGNBQWMsV0FBVyxjQUFjLEtBQUs7QUFDMUYsY0FBUTtBQUNSLFVBQUksVUFBVSxXQUFXLGlCQUFpQixPQUFPLElBQUksaUJBQWlCLElBQUksZUFBZSxRQUN6RixhQUFhO0FBQ2IsV0FBSyxVQUFVLFdBQVc7QUFDMUIsV0FBSyxrQkFBa0IsSUFBSTtBQUFBLElBQzdCO0FBQUEsRUFDRjtBQUVBLE1BQUksZUFBZSxPQUFPLE9BQU87QUFBQSxJQUMvQjtBQUFBLEVBQ0YsR0FBRyxZQUFZLFVBQVU7QUFFekIsTUFBSSxRQUFRLGlCQUFpQixPQUFPLGtCQUFrQjtBQUFBLElBQ3BEO0FBQUEsSUFDQTtBQUFBLEVBQ0YsQ0FBQyxJQUFJO0FBQUEsSUFDSDtBQUFBLElBQ0E7QUFBQSxFQUNGO0FBRUEsTUFBSSxNQUFNO0FBQ1YsTUFBSSxNQUFNO0FBRVYsTUFBSSxpQkFBaUI7QUFDbkIsUUFBSTtBQUVKLFdBQU8sT0FBTyxPQUFPLENBQUMsR0FBRyxjQUFlLGtCQUFpQixDQUFDLEdBQUcsZUFBZSxTQUFTLE9BQU8sTUFBTSxJQUFJLGVBQWUsU0FBUyxPQUFPLE1BQU0sSUFBSSxlQUFlLFlBQWEsS0FBSSxvQkFBb0IsTUFBTSxJQUFJLGVBQWUsSUFBSSxTQUFTLElBQUksUUFBUSxpQkFBaUIsSUFBSSxTQUFTLElBQUksVUFBVSxlQUFlO0FBQUEsRUFDbFQ7QUFFQSxTQUFPLE9BQU8sT0FBTyxDQUFDLEdBQUcsY0FBZSxtQkFBa0IsQ0FBQyxHQUFHLGdCQUFnQixTQUFTLE9BQU8sSUFBSSxPQUFPLElBQUksZ0JBQWdCLFNBQVMsT0FBTyxJQUFJLE9BQU8sSUFBSSxnQkFBZ0IsWUFBWSxJQUFJLGdCQUFnQjtBQUM5TTtBQUVBLHVCQUF1QixPQUFPO0FBQzVCLE1BQUksUUFBUSxNQUFNLE9BQ2QsV0FBVSxNQUFNO0FBQ3BCLE1BQUksd0JBQXdCLFNBQVEsaUJBQ2hDLGtCQUFrQiwwQkFBMEIsU0FBUyxPQUFPLHVCQUM1RCxvQkFBb0IsU0FBUSxVQUM1QixXQUFXLHNCQUFzQixTQUFTLE9BQU8sbUJBQ2pELHdCQUF3QixTQUFRLGNBQ2hDLGVBQWUsMEJBQTBCLFNBQVMsT0FBTztBQUU3RCxNQUFJLE1BQXVDO0FBQ3pDLFFBQUkscUJBQXFCLGtCQUFpQixNQUFNLFNBQVMsTUFBTSxFQUFFLHNCQUFzQjtBQUV2RixRQUFJLFlBQVksQ0FBQyxhQUFhLE9BQU8sU0FBUyxVQUFVLE1BQU0sRUFBRSxLQUFLLFNBQVUsVUFBVTtBQUN2RixhQUFPLG1CQUFtQixRQUFRLFFBQVEsS0FBSztBQUFBLElBQ2pELENBQUMsR0FBRztBQUNGLGNBQVEsS0FBSyxDQUFDLHFFQUFxRSxrRUFBa0UsUUFBUSxzRUFBc0UsbUVBQW1FLHNFQUFzRSw0Q0FBNEMsUUFBUSxzRUFBc0UscUVBQXFFLEVBQUUsS0FBSyxHQUFHLENBQUM7QUFBQSxJQUN4akI7QUFBQSxFQUNGO0FBRUEsTUFBSSxlQUFlO0FBQUEsSUFDakIsV0FBVyxpQkFBaUIsTUFBTSxTQUFTO0FBQUEsSUFDM0MsV0FBVyxhQUFhLE1BQU0sU0FBUztBQUFBLElBQ3ZDLFFBQVEsTUFBTSxTQUFTO0FBQUEsSUFDdkIsWUFBWSxNQUFNLE1BQU07QUFBQSxJQUN4QjtBQUFBLElBQ0EsU0FBUyxNQUFNLFFBQVEsYUFBYTtBQUFBLEVBQ3RDO0FBRUEsTUFBSSxNQUFNLGNBQWMsaUJBQWlCLE1BQU07QUFDN0MsVUFBTSxPQUFPLFNBQVMsT0FBTyxPQUFPLENBQUMsR0FBRyxNQUFNLE9BQU8sUUFBUSxZQUFZLE9BQU8sT0FBTyxDQUFDLEdBQUcsY0FBYztBQUFBLE1BQ3ZHLFNBQVMsTUFBTSxjQUFjO0FBQUEsTUFDN0IsVUFBVSxNQUFNLFFBQVE7QUFBQSxNQUN4QjtBQUFBLE1BQ0E7QUFBQSxJQUNGLENBQUMsQ0FBQyxDQUFDO0FBQUEsRUFDTDtBQUVBLE1BQUksTUFBTSxjQUFjLFNBQVMsTUFBTTtBQUNyQyxVQUFNLE9BQU8sUUFBUSxPQUFPLE9BQU8sQ0FBQyxHQUFHLE1BQU0sT0FBTyxPQUFPLFlBQVksT0FBTyxPQUFPLENBQUMsR0FBRyxjQUFjO0FBQUEsTUFDckcsU0FBUyxNQUFNLGNBQWM7QUFBQSxNQUM3QixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVjtBQUFBLElBQ0YsQ0FBQyxDQUFDLENBQUM7QUFBQSxFQUNMO0FBRUEsUUFBTSxXQUFXLFNBQVMsT0FBTyxPQUFPLENBQUMsR0FBRyxNQUFNLFdBQVcsUUFBUTtBQUFBLElBQ25FLHlCQUF5QixNQUFNO0FBQUEsRUFDakMsQ0FBQztBQUNIO0FBR0EsSUFBTyx3QkFBUTtBQUFBLEVBQ2IsTUFBTTtBQUFBLEVBQ04sU0FBUztBQUFBLEVBQ1QsT0FBTztBQUFBLEVBQ1AsSUFBSTtBQUFBLEVBQ0osTUFBTSxDQUFDO0FBQ1Q7OztBQ2xMQSxJQUFJLFVBQVU7QUFBQSxFQUNaLFNBQVM7QUFDWDtBQUVBLGlCQUFnQixNQUFNO0FBQ3BCLE1BQUksUUFBUSxLQUFLLE9BQ2IsV0FBVyxLQUFLLFVBQ2hCLFdBQVUsS0FBSztBQUNuQixNQUFJLGtCQUFrQixTQUFRLFFBQzFCLFNBQVMsb0JBQW9CLFNBQVMsT0FBTyxpQkFDN0Msa0JBQWtCLFNBQVEsUUFDMUIsU0FBUyxvQkFBb0IsU0FBUyxPQUFPO0FBQ2pELE1BQUksVUFBUyxVQUFVLE1BQU0sU0FBUyxNQUFNO0FBQzVDLE1BQUksZ0JBQWdCLENBQUMsRUFBRSxPQUFPLE1BQU0sY0FBYyxXQUFXLE1BQU0sY0FBYyxNQUFNO0FBRXZGLE1BQUksUUFBUTtBQUNWLGtCQUFjLFFBQVEsU0FBVSxjQUFjO0FBQzVDLG1CQUFhLGlCQUFpQixVQUFVLFNBQVMsUUFBUSxPQUFPO0FBQUEsSUFDbEUsQ0FBQztBQUFBLEVBQ0g7QUFFQSxNQUFJLFFBQVE7QUFDVixZQUFPLGlCQUFpQixVQUFVLFNBQVMsUUFBUSxPQUFPO0FBQUEsRUFDNUQ7QUFFQSxTQUFPLFdBQVk7QUFDakIsUUFBSSxRQUFRO0FBQ1Ysb0JBQWMsUUFBUSxTQUFVLGNBQWM7QUFDNUMscUJBQWEsb0JBQW9CLFVBQVUsU0FBUyxRQUFRLE9BQU87QUFBQSxNQUNyRSxDQUFDO0FBQUEsSUFDSDtBQUVBLFFBQUksUUFBUTtBQUNWLGNBQU8sb0JBQW9CLFVBQVUsU0FBUyxRQUFRLE9BQU87QUFBQSxJQUMvRDtBQUFBLEVBQ0Y7QUFDRjtBQUdBLElBQU8seUJBQVE7QUFBQSxFQUNiLE1BQU07QUFBQSxFQUNOLFNBQVM7QUFBQSxFQUNULE9BQU87QUFBQSxFQUNQLElBQUksY0FBYztBQUFBLEVBQUM7QUFBQSxFQUNuQixRQUFRO0FBQUEsRUFDUixNQUFNLENBQUM7QUFDVDs7O0FDaERBLElBQUksT0FBTztBQUFBLEVBQ1QsTUFBTTtBQUFBLEVBQ04sT0FBTztBQUFBLEVBQ1AsUUFBUTtBQUFBLEVBQ1IsS0FBSztBQUNQO0FBQ2UsOEJBQThCLFdBQVc7QUFDdEQsU0FBTyxVQUFVLFFBQVEsMEJBQTBCLFNBQVUsU0FBUztBQUNwRSxXQUFPLEtBQUs7QUFBQSxFQUNkLENBQUM7QUFDSDs7O0FDVkEsSUFBSSxRQUFPO0FBQUEsRUFDVCxPQUFPO0FBQUEsRUFDUCxLQUFLO0FBQ1A7QUFDZSx1Q0FBdUMsV0FBVztBQUMvRCxTQUFPLFVBQVUsUUFBUSxjQUFjLFNBQVUsU0FBUztBQUN4RCxXQUFPLE1BQUs7QUFBQSxFQUNkLENBQUM7QUFDSDs7O0FDUGUseUJBQXlCLE1BQU07QUFDNUMsTUFBSSxNQUFNLFVBQVUsSUFBSTtBQUN4QixNQUFJLGFBQWEsSUFBSTtBQUNyQixNQUFJLFlBQVksSUFBSTtBQUNwQixTQUFPO0FBQUEsSUFDTDtBQUFBLElBQ0E7QUFBQSxFQUNGO0FBQ0Y7OztBQ05lLDZCQUE2QixTQUFTO0FBUW5ELFNBQU8sc0JBQXNCLG1CQUFtQixPQUFPLENBQUMsRUFBRSxPQUFPLGdCQUFnQixPQUFPLEVBQUU7QUFDNUY7OztBQ1JlLHlCQUF5QixTQUFTLFVBQVU7QUFDekQsTUFBSSxNQUFNLFVBQVUsT0FBTztBQUMzQixNQUFJLE9BQU8sbUJBQW1CLE9BQU87QUFDckMsTUFBSSxpQkFBaUIsSUFBSTtBQUN6QixNQUFJLFFBQVEsS0FBSztBQUNqQixNQUFJLFNBQVMsS0FBSztBQUNsQixNQUFJLElBQUk7QUFDUixNQUFJLElBQUk7QUFFUixNQUFJLGdCQUFnQjtBQUNsQixZQUFRLGVBQWU7QUFDdkIsYUFBUyxlQUFlO0FBQ3hCLFFBQUksaUJBQWlCLGlCQUFpQjtBQUV0QyxRQUFJLGtCQUFrQixDQUFDLGtCQUFrQixhQUFhLFNBQVM7QUFDN0QsVUFBSSxlQUFlO0FBQ25CLFVBQUksZUFBZTtBQUFBLElBQ3JCO0FBQUEsRUFDRjtBQUVBLFNBQU87QUFBQSxJQUNMO0FBQUEsSUFDQTtBQUFBLElBQ0EsR0FBRyxJQUFJLG9CQUFvQixPQUFPO0FBQUEsSUFDbEM7QUFBQSxFQUNGO0FBQ0Y7OztBQ3ZCZSx5QkFBeUIsU0FBUztBQUMvQyxNQUFJO0FBRUosTUFBSSxPQUFPLG1CQUFtQixPQUFPO0FBQ3JDLE1BQUksWUFBWSxnQkFBZ0IsT0FBTztBQUN2QyxNQUFJLE9BQVEseUJBQXdCLFFBQVEsa0JBQWtCLE9BQU8sU0FBUyxzQkFBc0I7QUFDcEcsTUFBSSxRQUFRLElBQUksS0FBSyxhQUFhLEtBQUssYUFBYSxPQUFPLEtBQUssY0FBYyxHQUFHLE9BQU8sS0FBSyxjQUFjLENBQUM7QUFDNUcsTUFBSSxTQUFTLElBQUksS0FBSyxjQUFjLEtBQUssY0FBYyxPQUFPLEtBQUssZUFBZSxHQUFHLE9BQU8sS0FBSyxlQUFlLENBQUM7QUFDakgsTUFBSSxJQUFJLENBQUMsVUFBVSxhQUFhLG9CQUFvQixPQUFPO0FBQzNELE1BQUksSUFBSSxDQUFDLFVBQVU7QUFFbkIsTUFBSSxrQkFBaUIsUUFBUSxJQUFJLEVBQUUsY0FBYyxPQUFPO0FBQ3RELFNBQUssSUFBSSxLQUFLLGFBQWEsT0FBTyxLQUFLLGNBQWMsQ0FBQyxJQUFJO0FBQUEsRUFDNUQ7QUFFQSxTQUFPO0FBQUEsSUFDTDtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0Y7QUFDRjs7O0FDM0JlLHdCQUF3QixTQUFTO0FBRTlDLE1BQUksb0JBQW9CLGtCQUFpQixPQUFPLEdBQzVDLFdBQVcsa0JBQWtCLFVBQzdCLFlBQVksa0JBQWtCLFdBQzlCLFlBQVksa0JBQWtCO0FBRWxDLFNBQU8sNkJBQTZCLEtBQUssV0FBVyxZQUFZLFNBQVM7QUFDM0U7OztBQ0xlLHlCQUF5QixNQUFNO0FBQzVDLE1BQUksQ0FBQyxRQUFRLFFBQVEsV0FBVyxFQUFFLFFBQVEsWUFBWSxJQUFJLENBQUMsS0FBSyxHQUFHO0FBRWpFLFdBQU8sS0FBSyxjQUFjO0FBQUEsRUFDNUI7QUFFQSxNQUFJLGNBQWMsSUFBSSxLQUFLLGVBQWUsSUFBSSxHQUFHO0FBQy9DLFdBQU87QUFBQSxFQUNUO0FBRUEsU0FBTyxnQkFBZ0IsY0FBYyxJQUFJLENBQUM7QUFDNUM7OztBQ0plLDJCQUEyQixTQUFTLE1BQU07QUFDdkQsTUFBSTtBQUVKLE1BQUksU0FBUyxRQUFRO0FBQ25CLFdBQU8sQ0FBQztBQUFBLEVBQ1Y7QUFFQSxNQUFJLGVBQWUsZ0JBQWdCLE9BQU87QUFDMUMsTUFBSSxTQUFTLGlCQUFtQiwwQkFBd0IsUUFBUSxrQkFBa0IsT0FBTyxTQUFTLHNCQUFzQjtBQUN4SCxNQUFJLE1BQU0sVUFBVSxZQUFZO0FBQ2hDLE1BQUksU0FBUyxTQUFTLENBQUMsR0FBRyxFQUFFLE9BQU8sSUFBSSxrQkFBa0IsQ0FBQyxHQUFHLGVBQWUsWUFBWSxJQUFJLGVBQWUsQ0FBQyxDQUFDLElBQUk7QUFDakgsTUFBSSxjQUFjLEtBQUssT0FBTyxNQUFNO0FBQ3BDLFNBQU8sU0FBUyxjQUNoQixZQUFZLE9BQU8sa0JBQWtCLGNBQWMsTUFBTSxDQUFDLENBQUM7QUFDN0Q7OztBQ3pCZSwwQkFBMEIsTUFBTTtBQUM3QyxTQUFPLE9BQU8sT0FBTyxDQUFDLEdBQUcsTUFBTTtBQUFBLElBQzdCLE1BQU0sS0FBSztBQUFBLElBQ1gsS0FBSyxLQUFLO0FBQUEsSUFDVixPQUFPLEtBQUssSUFBSSxLQUFLO0FBQUEsSUFDckIsUUFBUSxLQUFLLElBQUksS0FBSztBQUFBLEVBQ3hCLENBQUM7QUFDSDs7O0FDUUEsb0NBQW9DLFNBQVMsVUFBVTtBQUNyRCxNQUFJLE9BQU8sc0JBQXNCLFNBQVMsT0FBTyxhQUFhLE9BQU87QUFDckUsT0FBSyxNQUFNLEtBQUssTUFBTSxRQUFRO0FBQzlCLE9BQUssT0FBTyxLQUFLLE9BQU8sUUFBUTtBQUNoQyxPQUFLLFNBQVMsS0FBSyxNQUFNLFFBQVE7QUFDakMsT0FBSyxRQUFRLEtBQUssT0FBTyxRQUFRO0FBQ2pDLE9BQUssUUFBUSxRQUFRO0FBQ3JCLE9BQUssU0FBUyxRQUFRO0FBQ3RCLE9BQUssSUFBSSxLQUFLO0FBQ2QsT0FBSyxJQUFJLEtBQUs7QUFDZCxTQUFPO0FBQ1Q7QUFFQSxvQ0FBb0MsU0FBUyxnQkFBZ0IsVUFBVTtBQUNyRSxTQUFPLG1CQUFtQixXQUFXLGlCQUFpQixnQkFBZ0IsU0FBUyxRQUFRLENBQUMsSUFBSSxVQUFVLGNBQWMsSUFBSSwyQkFBMkIsZ0JBQWdCLFFBQVEsSUFBSSxpQkFBaUIsZ0JBQWdCLG1CQUFtQixPQUFPLENBQUMsQ0FBQztBQUM5TztBQUtBLDRCQUE0QixTQUFTO0FBQ25DLE1BQUksbUJBQWtCLGtCQUFrQixjQUFjLE9BQU8sQ0FBQztBQUM5RCxNQUFJLG9CQUFvQixDQUFDLFlBQVksT0FBTyxFQUFFLFFBQVEsa0JBQWlCLE9BQU8sRUFBRSxRQUFRLEtBQUs7QUFDN0YsTUFBSSxpQkFBaUIscUJBQXFCLGNBQWMsT0FBTyxJQUFJLGdCQUFnQixPQUFPLElBQUk7QUFFOUYsTUFBSSxDQUFDLFVBQVUsY0FBYyxHQUFHO0FBQzlCLFdBQU8sQ0FBQztBQUFBLEVBQ1Y7QUFHQSxTQUFPLGlCQUFnQixPQUFPLFNBQVUsZ0JBQWdCO0FBQ3RELFdBQU8sVUFBVSxjQUFjLEtBQUssU0FBUyxnQkFBZ0IsY0FBYyxLQUFLLFlBQVksY0FBYyxNQUFNO0FBQUEsRUFDbEgsQ0FBQztBQUNIO0FBSWUseUJBQXlCLFNBQVMsVUFBVSxjQUFjLFVBQVU7QUFDakYsTUFBSSxzQkFBc0IsYUFBYSxvQkFBb0IsbUJBQW1CLE9BQU8sSUFBSSxDQUFDLEVBQUUsT0FBTyxRQUFRO0FBQzNHLE1BQUksbUJBQWtCLENBQUMsRUFBRSxPQUFPLHFCQUFxQixDQUFDLFlBQVksQ0FBQztBQUNuRSxNQUFJLHNCQUFzQixpQkFBZ0I7QUFDMUMsTUFBSSxlQUFlLGlCQUFnQixPQUFPLFNBQVUsU0FBUyxnQkFBZ0I7QUFDM0UsUUFBSSxPQUFPLDJCQUEyQixTQUFTLGdCQUFnQixRQUFRO0FBQ3ZFLFlBQVEsTUFBTSxJQUFJLEtBQUssS0FBSyxRQUFRLEdBQUc7QUFDdkMsWUFBUSxRQUFRLElBQUksS0FBSyxPQUFPLFFBQVEsS0FBSztBQUM3QyxZQUFRLFNBQVMsSUFBSSxLQUFLLFFBQVEsUUFBUSxNQUFNO0FBQ2hELFlBQVEsT0FBTyxJQUFJLEtBQUssTUFBTSxRQUFRLElBQUk7QUFDMUMsV0FBTztBQUFBLEVBQ1QsR0FBRywyQkFBMkIsU0FBUyxxQkFBcUIsUUFBUSxDQUFDO0FBQ3JFLGVBQWEsUUFBUSxhQUFhLFFBQVEsYUFBYTtBQUN2RCxlQUFhLFNBQVMsYUFBYSxTQUFTLGFBQWE7QUFDekQsZUFBYSxJQUFJLGFBQWE7QUFDOUIsZUFBYSxJQUFJLGFBQWE7QUFDOUIsU0FBTztBQUNUOzs7QUNqRWUsd0JBQXdCLE1BQU07QUFDM0MsTUFBSSxhQUFZLEtBQUssV0FDakIsVUFBVSxLQUFLLFNBQ2YsWUFBWSxLQUFLO0FBQ3JCLE1BQUksZ0JBQWdCLFlBQVksaUJBQWlCLFNBQVMsSUFBSTtBQUM5RCxNQUFJLFlBQVksWUFBWSxhQUFhLFNBQVMsSUFBSTtBQUN0RCxNQUFJLFVBQVUsV0FBVSxJQUFJLFdBQVUsUUFBUSxJQUFJLFFBQVEsUUFBUTtBQUNsRSxNQUFJLFVBQVUsV0FBVSxJQUFJLFdBQVUsU0FBUyxJQUFJLFFBQVEsU0FBUztBQUNwRSxNQUFJO0FBRUosVUFBUTtBQUFBLFNBQ0Q7QUFDSCxnQkFBVTtBQUFBLFFBQ1IsR0FBRztBQUFBLFFBQ0gsR0FBRyxXQUFVLElBQUksUUFBUTtBQUFBLE1BQzNCO0FBQ0E7QUFBQSxTQUVHO0FBQ0gsZ0JBQVU7QUFBQSxRQUNSLEdBQUc7QUFBQSxRQUNILEdBQUcsV0FBVSxJQUFJLFdBQVU7QUFBQSxNQUM3QjtBQUNBO0FBQUEsU0FFRztBQUNILGdCQUFVO0FBQUEsUUFDUixHQUFHLFdBQVUsSUFBSSxXQUFVO0FBQUEsUUFDM0IsR0FBRztBQUFBLE1BQ0w7QUFDQTtBQUFBLFNBRUc7QUFDSCxnQkFBVTtBQUFBLFFBQ1IsR0FBRyxXQUFVLElBQUksUUFBUTtBQUFBLFFBQ3pCLEdBQUc7QUFBQSxNQUNMO0FBQ0E7QUFBQTtBQUdBLGdCQUFVO0FBQUEsUUFDUixHQUFHLFdBQVU7QUFBQSxRQUNiLEdBQUcsV0FBVTtBQUFBLE1BQ2Y7QUFBQTtBQUdKLE1BQUksV0FBVyxnQkFBZ0IseUJBQXlCLGFBQWEsSUFBSTtBQUV6RSxNQUFJLFlBQVksTUFBTTtBQUNwQixRQUFJLE1BQU0sYUFBYSxNQUFNLFdBQVc7QUFFeEMsWUFBUTtBQUFBLFdBQ0Q7QUFDSCxnQkFBUSxZQUFZLFFBQVEsWUFBYSxZQUFVLE9BQU8sSUFBSSxRQUFRLE9BQU87QUFDN0U7QUFBQSxXQUVHO0FBQ0gsZ0JBQVEsWUFBWSxRQUFRLFlBQWEsWUFBVSxPQUFPLElBQUksUUFBUSxPQUFPO0FBQzdFO0FBQUE7QUFBQTtBQUFBLEVBSU47QUFFQSxTQUFPO0FBQ1Q7OztBQzNEZSx3QkFBd0IsT0FBTyxVQUFTO0FBQ3JELE1BQUksYUFBWSxRQUFRO0FBQ3RCLGVBQVUsQ0FBQztBQUFBLEVBQ2I7QUFFQSxNQUFJLFdBQVcsVUFDWCxxQkFBcUIsU0FBUyxXQUM5QixZQUFZLHVCQUF1QixTQUFTLE1BQU0sWUFBWSxvQkFDOUQsb0JBQW9CLFNBQVMsVUFDN0IsV0FBVyxzQkFBc0IsU0FBUyxNQUFNLFdBQVcsbUJBQzNELG9CQUFvQixTQUFTLFVBQzdCLFdBQVcsc0JBQXNCLFNBQVMsa0JBQWtCLG1CQUM1RCx3QkFBd0IsU0FBUyxjQUNqQyxlQUFlLDBCQUEwQixTQUFTLFdBQVcsdUJBQzdELHdCQUF3QixTQUFTLGdCQUNqQyxpQkFBaUIsMEJBQTBCLFNBQVMsU0FBUyx1QkFDN0QsdUJBQXVCLFNBQVMsYUFDaEMsY0FBYyx5QkFBeUIsU0FBUyxRQUFRLHNCQUN4RCxtQkFBbUIsU0FBUyxTQUM1QixVQUFVLHFCQUFxQixTQUFTLElBQUk7QUFDaEQsTUFBSSxnQkFBZ0IsbUJBQW1CLE9BQU8sWUFBWSxXQUFXLFVBQVUsZ0JBQWdCLFNBQVMsY0FBYyxDQUFDO0FBQ3ZILE1BQUksYUFBYSxtQkFBbUIsU0FBUyxZQUFZO0FBQ3pELE1BQUksYUFBYSxNQUFNLE1BQU07QUFDN0IsTUFBSSxVQUFVLE1BQU0sU0FBUyxjQUFjLGFBQWE7QUFDeEQsTUFBSSxxQkFBcUIsZ0JBQWdCLFVBQVUsT0FBTyxJQUFJLFVBQVUsUUFBUSxrQkFBa0IsbUJBQW1CLE1BQU0sU0FBUyxNQUFNLEdBQUcsVUFBVSxjQUFjLFFBQVE7QUFDN0ssTUFBSSxzQkFBc0Isc0JBQXNCLE1BQU0sU0FBUyxTQUFTO0FBQ3hFLE1BQUksaUJBQWdCLGVBQWU7QUFBQSxJQUNqQyxXQUFXO0FBQUEsSUFDWCxTQUFTO0FBQUEsSUFDVCxVQUFVO0FBQUEsSUFDVjtBQUFBLEVBQ0YsQ0FBQztBQUNELE1BQUksbUJBQW1CLGlCQUFpQixPQUFPLE9BQU8sQ0FBQyxHQUFHLFlBQVksY0FBYSxDQUFDO0FBQ3BGLE1BQUksb0JBQW9CLG1CQUFtQixTQUFTLG1CQUFtQjtBQUd2RSxNQUFJLGtCQUFrQjtBQUFBLElBQ3BCLEtBQUssbUJBQW1CLE1BQU0sa0JBQWtCLE1BQU0sY0FBYztBQUFBLElBQ3BFLFFBQVEsa0JBQWtCLFNBQVMsbUJBQW1CLFNBQVMsY0FBYztBQUFBLElBQzdFLE1BQU0sbUJBQW1CLE9BQU8sa0JBQWtCLE9BQU8sY0FBYztBQUFBLElBQ3ZFLE9BQU8sa0JBQWtCLFFBQVEsbUJBQW1CLFFBQVEsY0FBYztBQUFBLEVBQzVFO0FBQ0EsTUFBSSxhQUFhLE1BQU0sY0FBYztBQUVyQyxNQUFJLG1CQUFtQixVQUFVLFlBQVk7QUFDM0MsUUFBSSxVQUFTLFdBQVc7QUFDeEIsV0FBTyxLQUFLLGVBQWUsRUFBRSxRQUFRLFNBQVUsS0FBSztBQUNsRCxVQUFJLFdBQVcsQ0FBQyxPQUFPLE1BQU0sRUFBRSxRQUFRLEdBQUcsS0FBSyxJQUFJLElBQUk7QUFDdkQsVUFBSSxPQUFPLENBQUMsS0FBSyxNQUFNLEVBQUUsUUFBUSxHQUFHLEtBQUssSUFBSSxNQUFNO0FBQ25ELHNCQUFnQixRQUFRLFFBQU8sUUFBUTtBQUFBLElBQ3pDLENBQUM7QUFBQSxFQUNIO0FBRUEsU0FBTztBQUNUOzs7QUM1RGUsOEJBQThCLE9BQU8sVUFBUztBQUMzRCxNQUFJLGFBQVksUUFBUTtBQUN0QixlQUFVLENBQUM7QUFBQSxFQUNiO0FBRUEsTUFBSSxXQUFXLFVBQ1gsWUFBWSxTQUFTLFdBQ3JCLFdBQVcsU0FBUyxVQUNwQixlQUFlLFNBQVMsY0FDeEIsVUFBVSxTQUFTLFNBQ25CLGlCQUFpQixTQUFTLGdCQUMxQix3QkFBd0IsU0FBUyx1QkFDakMsd0JBQXdCLDBCQUEwQixTQUFTLGFBQWdCO0FBQy9FLE1BQUksWUFBWSxhQUFhLFNBQVM7QUFDdEMsTUFBSSxjQUFhLFlBQVksaUJBQWlCLHNCQUFzQixvQkFBb0IsT0FBTyxTQUFVLFlBQVc7QUFDbEgsV0FBTyxhQUFhLFVBQVMsTUFBTTtBQUFBLEVBQ3JDLENBQUMsSUFBSTtBQUNMLE1BQUksb0JBQW9CLFlBQVcsT0FBTyxTQUFVLFlBQVc7QUFDN0QsV0FBTyxzQkFBc0IsUUFBUSxVQUFTLEtBQUs7QUFBQSxFQUNyRCxDQUFDO0FBRUQsTUFBSSxrQkFBa0IsV0FBVyxHQUFHO0FBQ2xDLHdCQUFvQjtBQUVwQixRQUFJLE1BQXVDO0FBQ3pDLGNBQVEsTUFBTSxDQUFDLGdFQUFnRSxtRUFBbUUsOEJBQThCLCtEQUErRCwyQkFBMkIsRUFBRSxLQUFLLEdBQUcsQ0FBQztBQUFBLElBQ3ZSO0FBQUEsRUFDRjtBQUdBLE1BQUksWUFBWSxrQkFBa0IsT0FBTyxTQUFVLEtBQUssWUFBVztBQUNqRSxRQUFJLGNBQWEsZUFBZSxPQUFPO0FBQUEsTUFDckMsV0FBVztBQUFBLE1BQ1g7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0YsQ0FBQyxFQUFFLGlCQUFpQixVQUFTO0FBQzdCLFdBQU87QUFBQSxFQUNULEdBQUcsQ0FBQyxDQUFDO0FBQ0wsU0FBTyxPQUFPLEtBQUssU0FBUyxFQUFFLEtBQUssU0FBVSxHQUFHLEdBQUc7QUFDakQsV0FBTyxVQUFVLEtBQUssVUFBVTtBQUFBLEVBQ2xDLENBQUM7QUFDSDs7O0FDdENBLHVDQUF1QyxXQUFXO0FBQ2hELE1BQUksaUJBQWlCLFNBQVMsTUFBTSxNQUFNO0FBQ3hDLFdBQU8sQ0FBQztBQUFBLEVBQ1Y7QUFFQSxNQUFJLG9CQUFvQixxQkFBcUIsU0FBUztBQUN0RCxTQUFPLENBQUMsOEJBQThCLFNBQVMsR0FBRyxtQkFBbUIsOEJBQThCLGlCQUFpQixDQUFDO0FBQ3ZIO0FBRUEsY0FBYyxNQUFNO0FBQ2xCLE1BQUksUUFBUSxLQUFLLE9BQ2IsV0FBVSxLQUFLLFNBQ2YsT0FBTyxLQUFLO0FBRWhCLE1BQUksTUFBTSxjQUFjLE1BQU0sT0FBTztBQUNuQztBQUFBLEVBQ0Y7QUFFQSxNQUFJLG9CQUFvQixTQUFRLFVBQzVCLGdCQUFnQixzQkFBc0IsU0FBUyxPQUFPLG1CQUN0RCxtQkFBbUIsU0FBUSxTQUMzQixlQUFlLHFCQUFxQixTQUFTLE9BQU8sa0JBQ3BELDhCQUE4QixTQUFRLG9CQUN0QyxVQUFVLFNBQVEsU0FDbEIsV0FBVyxTQUFRLFVBQ25CLGVBQWUsU0FBUSxjQUN2QixjQUFjLFNBQVEsYUFDdEIsd0JBQXdCLFNBQVEsZ0JBQ2hDLGlCQUFpQiwwQkFBMEIsU0FBUyxPQUFPLHVCQUMzRCx3QkFBd0IsU0FBUTtBQUNwQyxNQUFJLHFCQUFxQixNQUFNLFFBQVE7QUFDdkMsTUFBSSxnQkFBZ0IsaUJBQWlCLGtCQUFrQjtBQUN2RCxNQUFJLGtCQUFrQixrQkFBa0I7QUFDeEMsTUFBSSxxQkFBcUIsK0JBQWdDLG9CQUFtQixDQUFDLGlCQUFpQixDQUFDLHFCQUFxQixrQkFBa0IsQ0FBQyxJQUFJLDhCQUE4QixrQkFBa0I7QUFDM0wsTUFBSSxjQUFhLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxrQkFBa0IsRUFBRSxPQUFPLFNBQVUsS0FBSyxZQUFXO0FBQ2hHLFdBQU8sSUFBSSxPQUFPLGlCQUFpQixVQUFTLE1BQU0sT0FBTyxxQkFBcUIsT0FBTztBQUFBLE1BQ25GLFdBQVc7QUFBQSxNQUNYO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0YsQ0FBQyxJQUFJLFVBQVM7QUFBQSxFQUNoQixHQUFHLENBQUMsQ0FBQztBQUNMLE1BQUksZ0JBQWdCLE1BQU0sTUFBTTtBQUNoQyxNQUFJLGFBQWEsTUFBTSxNQUFNO0FBQzdCLE1BQUksWUFBWSxvQkFBSSxJQUFJO0FBQ3hCLE1BQUkscUJBQXFCO0FBQ3pCLE1BQUksd0JBQXdCLFlBQVc7QUFFdkMsV0FBUyxJQUFJLEdBQUcsSUFBSSxZQUFXLFFBQVEsS0FBSztBQUMxQyxRQUFJLFlBQVksWUFBVztBQUUzQixRQUFJLGlCQUFpQixpQkFBaUIsU0FBUztBQUUvQyxRQUFJLG1CQUFtQixhQUFhLFNBQVMsTUFBTTtBQUNuRCxRQUFJLGFBQWEsQ0FBQyxLQUFLLE1BQU0sRUFBRSxRQUFRLGNBQWMsS0FBSztBQUMxRCxRQUFJLE1BQU0sYUFBYSxVQUFVO0FBQ2pDLFFBQUksV0FBVyxlQUFlLE9BQU87QUFBQSxNQUNuQztBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNGLENBQUM7QUFDRCxRQUFJLG9CQUFvQixhQUFhLG1CQUFtQixRQUFRLE9BQU8sbUJBQW1CLFNBQVM7QUFFbkcsUUFBSSxjQUFjLE9BQU8sV0FBVyxNQUFNO0FBQ3hDLDBCQUFvQixxQkFBcUIsaUJBQWlCO0FBQUEsSUFDNUQ7QUFFQSxRQUFJLG1CQUFtQixxQkFBcUIsaUJBQWlCO0FBQzdELFFBQUksU0FBUyxDQUFDO0FBRWQsUUFBSSxlQUFlO0FBQ2pCLGFBQU8sS0FBSyxTQUFTLG1CQUFtQixDQUFDO0FBQUEsSUFDM0M7QUFFQSxRQUFJLGNBQWM7QUFDaEIsYUFBTyxLQUFLLFNBQVMsc0JBQXNCLEdBQUcsU0FBUyxxQkFBcUIsQ0FBQztBQUFBLElBQy9FO0FBRUEsUUFBSSxPQUFPLE1BQU0sU0FBVSxPQUFPO0FBQ2hDLGFBQU87QUFBQSxJQUNULENBQUMsR0FBRztBQUNGLDhCQUF3QjtBQUN4QiwyQkFBcUI7QUFDckI7QUFBQSxJQUNGO0FBRUEsY0FBVSxJQUFJLFdBQVcsTUFBTTtBQUFBLEVBQ2pDO0FBRUEsTUFBSSxvQkFBb0I7QUFFdEIsUUFBSSxpQkFBaUIsaUJBQWlCLElBQUk7QUFFMUMsUUFBSSxRQUFRLGdCQUFlLEtBQUk7QUFDN0IsVUFBSSxtQkFBbUIsWUFBVyxLQUFLLFNBQVUsWUFBVztBQUMxRCxZQUFJLFVBQVMsVUFBVSxJQUFJLFVBQVM7QUFFcEMsWUFBSSxTQUFRO0FBQ1YsaUJBQU8sUUFBTyxNQUFNLEdBQUcsR0FBRSxFQUFFLE1BQU0sU0FBVSxPQUFPO0FBQ2hELG1CQUFPO0FBQUEsVUFDVCxDQUFDO0FBQUEsUUFDSDtBQUFBLE1BQ0YsQ0FBQztBQUVELFVBQUksa0JBQWtCO0FBQ3BCLGdDQUF3QjtBQUN4QixlQUFPO0FBQUEsTUFDVDtBQUFBLElBQ0Y7QUFFQSxhQUFTLEtBQUssZ0JBQWdCLEtBQUssR0FBRyxNQUFNO0FBQzFDLFVBQUksT0FBTyxNQUFNLEVBQUU7QUFFbkIsVUFBSSxTQUFTO0FBQVM7QUFBQSxJQUN4QjtBQUFBLEVBQ0Y7QUFFQSxNQUFJLE1BQU0sY0FBYyx1QkFBdUI7QUFDN0MsVUFBTSxjQUFjLE1BQU0sUUFBUTtBQUNsQyxVQUFNLFlBQVk7QUFDbEIsVUFBTSxRQUFRO0FBQUEsRUFDaEI7QUFDRjtBQUdBLElBQU8sZUFBUTtBQUFBLEVBQ2IsTUFBTTtBQUFBLEVBQ04sU0FBUztBQUFBLEVBQ1QsT0FBTztBQUFBLEVBQ1AsSUFBSTtBQUFBLEVBQ0osa0JBQWtCLENBQUMsUUFBUTtBQUFBLEVBQzNCLE1BQU07QUFBQSxJQUNKLE9BQU87QUFBQSxFQUNUO0FBQ0Y7OztBQy9JQSx3QkFBd0IsVUFBVSxNQUFNLGtCQUFrQjtBQUN4RCxNQUFJLHFCQUFxQixRQUFRO0FBQy9CLHVCQUFtQjtBQUFBLE1BQ2pCLEdBQUc7QUFBQSxNQUNILEdBQUc7QUFBQSxJQUNMO0FBQUEsRUFDRjtBQUVBLFNBQU87QUFBQSxJQUNMLEtBQUssU0FBUyxNQUFNLEtBQUssU0FBUyxpQkFBaUI7QUFBQSxJQUNuRCxPQUFPLFNBQVMsUUFBUSxLQUFLLFFBQVEsaUJBQWlCO0FBQUEsSUFDdEQsUUFBUSxTQUFTLFNBQVMsS0FBSyxTQUFTLGlCQUFpQjtBQUFBLElBQ3pELE1BQU0sU0FBUyxPQUFPLEtBQUssUUFBUSxpQkFBaUI7QUFBQSxFQUN0RDtBQUNGO0FBRUEsK0JBQStCLFVBQVU7QUFDdkMsU0FBTyxDQUFDLEtBQUssT0FBTyxRQUFRLElBQUksRUFBRSxLQUFLLFNBQVUsTUFBTTtBQUNyRCxXQUFPLFNBQVMsU0FBUztBQUFBLEVBQzNCLENBQUM7QUFDSDtBQUVBLGNBQWMsTUFBTTtBQUNsQixNQUFJLFFBQVEsS0FBSyxPQUNiLE9BQU8sS0FBSztBQUNoQixNQUFJLGdCQUFnQixNQUFNLE1BQU07QUFDaEMsTUFBSSxhQUFhLE1BQU0sTUFBTTtBQUM3QixNQUFJLG1CQUFtQixNQUFNLGNBQWM7QUFDM0MsTUFBSSxvQkFBb0IsZUFBZSxPQUFPO0FBQUEsSUFDNUMsZ0JBQWdCO0FBQUEsRUFDbEIsQ0FBQztBQUNELE1BQUksb0JBQW9CLGVBQWUsT0FBTztBQUFBLElBQzVDLGFBQWE7QUFBQSxFQUNmLENBQUM7QUFDRCxNQUFJLDJCQUEyQixlQUFlLG1CQUFtQixhQUFhO0FBQzlFLE1BQUksc0JBQXNCLGVBQWUsbUJBQW1CLFlBQVksZ0JBQWdCO0FBQ3hGLE1BQUksb0JBQW9CLHNCQUFzQix3QkFBd0I7QUFDdEUsTUFBSSxtQkFBbUIsc0JBQXNCLG1CQUFtQjtBQUNoRSxRQUFNLGNBQWMsUUFBUTtBQUFBLElBQzFCO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDRjtBQUNBLFFBQU0sV0FBVyxTQUFTLE9BQU8sT0FBTyxDQUFDLEdBQUcsTUFBTSxXQUFXLFFBQVE7QUFBQSxJQUNuRSxnQ0FBZ0M7QUFBQSxJQUNoQyx1QkFBdUI7QUFBQSxFQUN6QixDQUFDO0FBQ0g7QUFHQSxJQUFPLGVBQVE7QUFBQSxFQUNiLE1BQU07QUFBQSxFQUNOLFNBQVM7QUFBQSxFQUNULE9BQU87QUFBQSxFQUNQLGtCQUFrQixDQUFDLGlCQUFpQjtBQUFBLEVBQ3BDLElBQUk7QUFDTjs7O0FDekRPLGlDQUFpQyxXQUFXLE9BQU8sU0FBUTtBQUNoRSxNQUFJLGdCQUFnQixpQkFBaUIsU0FBUztBQUM5QyxNQUFJLGlCQUFpQixDQUFDLE1BQU0sR0FBRyxFQUFFLFFBQVEsYUFBYSxLQUFLLElBQUksS0FBSztBQUVwRSxNQUFJLE9BQU8sT0FBTyxZQUFXLGFBQWEsUUFBTyxPQUFPLE9BQU8sQ0FBQyxHQUFHLE9BQU87QUFBQSxJQUN4RTtBQUFBLEVBQ0YsQ0FBQyxDQUFDLElBQUksU0FDRixXQUFXLEtBQUssSUFDaEIsV0FBVyxLQUFLO0FBRXBCLGFBQVcsWUFBWTtBQUN2QixhQUFZLGFBQVksS0FBSztBQUM3QixTQUFPLENBQUMsTUFBTSxLQUFLLEVBQUUsUUFBUSxhQUFhLEtBQUssSUFBSTtBQUFBLElBQ2pELEdBQUc7QUFBQSxJQUNILEdBQUc7QUFBQSxFQUNMLElBQUk7QUFBQSxJQUNGLEdBQUc7QUFBQSxJQUNILEdBQUc7QUFBQSxFQUNMO0FBQ0Y7QUFFQSxnQkFBZ0IsT0FBTztBQUNyQixNQUFJLFFBQVEsTUFBTSxPQUNkLFdBQVUsTUFBTSxTQUNoQixPQUFPLE1BQU07QUFDakIsTUFBSSxrQkFBa0IsU0FBUSxRQUMxQixVQUFTLG9CQUFvQixTQUFTLENBQUMsR0FBRyxDQUFDLElBQUk7QUFDbkQsTUFBSSxPQUFPLFdBQVcsT0FBTyxTQUFVLEtBQUssV0FBVztBQUNyRCxRQUFJLGFBQWEsd0JBQXdCLFdBQVcsTUFBTSxPQUFPLE9BQU07QUFDdkUsV0FBTztBQUFBLEVBQ1QsR0FBRyxDQUFDLENBQUM7QUFDTCxNQUFJLHdCQUF3QixLQUFLLE1BQU0sWUFDbkMsSUFBSSxzQkFBc0IsR0FDMUIsSUFBSSxzQkFBc0I7QUFFOUIsTUFBSSxNQUFNLGNBQWMsaUJBQWlCLE1BQU07QUFDN0MsVUFBTSxjQUFjLGNBQWMsS0FBSztBQUN2QyxVQUFNLGNBQWMsY0FBYyxLQUFLO0FBQUEsRUFDekM7QUFFQSxRQUFNLGNBQWMsUUFBUTtBQUM5QjtBQUdBLElBQU8saUJBQVE7QUFBQSxFQUNiLE1BQU07QUFBQSxFQUNOLFNBQVM7QUFBQSxFQUNULE9BQU87QUFBQSxFQUNQLFVBQVUsQ0FBQyxlQUFlO0FBQUEsRUFDMUIsSUFBSTtBQUNOOzs7QUNuREEsdUJBQXVCLE1BQU07QUFDM0IsTUFBSSxRQUFRLEtBQUssT0FDYixPQUFPLEtBQUs7QUFLaEIsUUFBTSxjQUFjLFFBQVEsZUFBZTtBQUFBLElBQ3pDLFdBQVcsTUFBTSxNQUFNO0FBQUEsSUFDdkIsU0FBUyxNQUFNLE1BQU07QUFBQSxJQUNyQixVQUFVO0FBQUEsSUFDVixXQUFXLE1BQU07QUFBQSxFQUNuQixDQUFDO0FBQ0g7QUFHQSxJQUFPLHdCQUFRO0FBQUEsRUFDYixNQUFNO0FBQUEsRUFDTixTQUFTO0FBQUEsRUFDVCxPQUFPO0FBQUEsRUFDUCxJQUFJO0FBQUEsRUFDSixNQUFNLENBQUM7QUFDVDs7O0FDeEJlLG9CQUFvQixNQUFNO0FBQ3ZDLFNBQU8sU0FBUyxNQUFNLE1BQU07QUFDOUI7OztBQ1VBLHlCQUF5QixNQUFNO0FBQzdCLE1BQUksUUFBUSxLQUFLLE9BQ2IsV0FBVSxLQUFLLFNBQ2YsT0FBTyxLQUFLO0FBQ2hCLE1BQUksb0JBQW9CLFNBQVEsVUFDNUIsZ0JBQWdCLHNCQUFzQixTQUFTLE9BQU8sbUJBQ3RELG1CQUFtQixTQUFRLFNBQzNCLGVBQWUscUJBQXFCLFNBQVMsUUFBUSxrQkFDckQsV0FBVyxTQUFRLFVBQ25CLGVBQWUsU0FBUSxjQUN2QixjQUFjLFNBQVEsYUFDdEIsVUFBVSxTQUFRLFNBQ2xCLGtCQUFrQixTQUFRLFFBQzFCLFNBQVMsb0JBQW9CLFNBQVMsT0FBTyxpQkFDN0Msd0JBQXdCLFNBQVEsY0FDaEMsZUFBZSwwQkFBMEIsU0FBUyxJQUFJO0FBQzFELE1BQUksV0FBVyxlQUFlLE9BQU87QUFBQSxJQUNuQztBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0YsQ0FBQztBQUNELE1BQUksZ0JBQWdCLGlCQUFpQixNQUFNLFNBQVM7QUFDcEQsTUFBSSxZQUFZLGFBQWEsTUFBTSxTQUFTO0FBQzVDLE1BQUksa0JBQWtCLENBQUM7QUFDdkIsTUFBSSxXQUFXLHlCQUF5QixhQUFhO0FBQ3JELE1BQUksVUFBVSxXQUFXLFFBQVE7QUFDakMsTUFBSSxpQkFBZ0IsTUFBTSxjQUFjO0FBQ3hDLE1BQUksZ0JBQWdCLE1BQU0sTUFBTTtBQUNoQyxNQUFJLGFBQWEsTUFBTSxNQUFNO0FBQzdCLE1BQUksb0JBQW9CLE9BQU8saUJBQWlCLGFBQWEsYUFBYSxPQUFPLE9BQU8sQ0FBQyxHQUFHLE1BQU0sT0FBTztBQUFBLElBQ3ZHLFdBQVcsTUFBTTtBQUFBLEVBQ25CLENBQUMsQ0FBQyxJQUFJO0FBQ04sTUFBSSw4QkFBOEIsT0FBTyxzQkFBc0IsV0FBVztBQUFBLElBQ3hFLFVBQVU7QUFBQSxJQUNWLFNBQVM7QUFBQSxFQUNYLElBQUksT0FBTyxPQUFPO0FBQUEsSUFDaEIsVUFBVTtBQUFBLElBQ1YsU0FBUztBQUFBLEVBQ1gsR0FBRyxpQkFBaUI7QUFDcEIsTUFBSSxzQkFBc0IsTUFBTSxjQUFjLFNBQVMsTUFBTSxjQUFjLE9BQU8sTUFBTSxhQUFhO0FBQ3JHLE1BQUksT0FBTztBQUFBLElBQ1QsR0FBRztBQUFBLElBQ0gsR0FBRztBQUFBLEVBQ0w7QUFFQSxNQUFJLENBQUMsZ0JBQWU7QUFDbEI7QUFBQSxFQUNGO0FBRUEsTUFBSSxlQUFlO0FBQ2pCLFFBQUk7QUFFSixRQUFJLFdBQVcsYUFBYSxNQUFNLE1BQU07QUFDeEMsUUFBSSxVQUFVLGFBQWEsTUFBTSxTQUFTO0FBQzFDLFFBQUksTUFBTSxhQUFhLE1BQU0sV0FBVztBQUN4QyxRQUFJLFVBQVMsZUFBYztBQUMzQixRQUFJLE9BQU0sVUFBUyxTQUFTO0FBQzVCLFFBQUksT0FBTSxVQUFTLFNBQVM7QUFDNUIsUUFBSSxXQUFXLFNBQVMsQ0FBQyxXQUFXLE9BQU8sSUFBSTtBQUMvQyxRQUFJLFNBQVMsY0FBYyxRQUFRLGNBQWMsT0FBTyxXQUFXO0FBQ25FLFFBQUksU0FBUyxjQUFjLFFBQVEsQ0FBQyxXQUFXLE9BQU8sQ0FBQyxjQUFjO0FBR3JFLFFBQUksZUFBZSxNQUFNLFNBQVM7QUFDbEMsUUFBSSxZQUFZLFVBQVUsZUFBZSxjQUFjLFlBQVksSUFBSTtBQUFBLE1BQ3JFLE9BQU87QUFBQSxNQUNQLFFBQVE7QUFBQSxJQUNWO0FBQ0EsUUFBSSxxQkFBcUIsTUFBTSxjQUFjLHNCQUFzQixNQUFNLGNBQWMsb0JBQW9CLFVBQVUsbUJBQW1CO0FBQ3hJLFFBQUksa0JBQWtCLG1CQUFtQjtBQUN6QyxRQUFJLGtCQUFrQixtQkFBbUI7QUFNekMsUUFBSSxXQUFXLE9BQU8sR0FBRyxjQUFjLE1BQU0sVUFBVSxJQUFJO0FBQzNELFFBQUksWUFBWSxrQkFBa0IsY0FBYyxPQUFPLElBQUksV0FBVyxXQUFXLGtCQUFrQiw0QkFBNEIsV0FBVyxTQUFTLFdBQVcsa0JBQWtCLDRCQUE0QjtBQUM1TSxRQUFJLFlBQVksa0JBQWtCLENBQUMsY0FBYyxPQUFPLElBQUksV0FBVyxXQUFXLGtCQUFrQiw0QkFBNEIsV0FBVyxTQUFTLFdBQVcsa0JBQWtCLDRCQUE0QjtBQUM3TSxRQUFJLG9CQUFvQixNQUFNLFNBQVMsU0FBUyxnQkFBZ0IsTUFBTSxTQUFTLEtBQUs7QUFDcEYsUUFBSSxlQUFlLG9CQUFvQixhQUFhLE1BQU0sa0JBQWtCLGFBQWEsSUFBSSxrQkFBa0IsY0FBYyxJQUFJO0FBQ2pJLFFBQUksc0JBQXVCLHlCQUF3Qix1QkFBdUIsT0FBTyxTQUFTLG9CQUFvQixjQUFjLE9BQU8sd0JBQXdCO0FBQzNKLFFBQUksWUFBWSxVQUFTLFlBQVksc0JBQXNCO0FBQzNELFFBQUksWUFBWSxVQUFTLFlBQVk7QUFDckMsUUFBSSxrQkFBa0IsT0FBTyxTQUFTLElBQVEsTUFBSyxTQUFTLElBQUksTUFBSyxTQUFRLFNBQVMsSUFBUSxNQUFLLFNBQVMsSUFBSSxJQUFHO0FBQ25ILG1CQUFjLFlBQVk7QUFDMUIsU0FBSyxZQUFZLGtCQUFrQjtBQUFBLEVBQ3JDO0FBRUEsTUFBSSxjQUFjO0FBQ2hCLFFBQUk7QUFFSixRQUFJLFlBQVksYUFBYSxNQUFNLE1BQU07QUFFekMsUUFBSSxXQUFXLGFBQWEsTUFBTSxTQUFTO0FBRTNDLFFBQUksVUFBVSxlQUFjO0FBRTVCLFFBQUksT0FBTyxZQUFZLE1BQU0sV0FBVztBQUV4QyxRQUFJLE9BQU8sVUFBVSxTQUFTO0FBRTlCLFFBQUksT0FBTyxVQUFVLFNBQVM7QUFFOUIsUUFBSSxlQUFlLENBQUMsS0FBSyxJQUFJLEVBQUUsUUFBUSxhQUFhLE1BQU07QUFFMUQsUUFBSSx1QkFBd0IsMEJBQXlCLHVCQUF1QixPQUFPLFNBQVMsb0JBQW9CLGFBQWEsT0FBTyx5QkFBeUI7QUFFN0osUUFBSSxhQUFhLGVBQWUsT0FBTyxVQUFVLGNBQWMsUUFBUSxXQUFXLFFBQVEsdUJBQXVCLDRCQUE0QjtBQUU3SSxRQUFJLGFBQWEsZUFBZSxVQUFVLGNBQWMsUUFBUSxXQUFXLFFBQVEsdUJBQXVCLDRCQUE0QixVQUFVO0FBRWhKLFFBQUksbUJBQW1CLFVBQVUsZUFBZSxlQUFlLFlBQVksU0FBUyxVQUFVLElBQUksT0FBTyxTQUFTLGFBQWEsTUFBTSxTQUFTLFNBQVMsYUFBYSxJQUFJO0FBRXhLLG1CQUFjLFdBQVc7QUFDekIsU0FBSyxXQUFXLG1CQUFtQjtBQUFBLEVBQ3JDO0FBRUEsUUFBTSxjQUFjLFFBQVE7QUFDOUI7QUFHQSxJQUFPLDBCQUFRO0FBQUEsRUFDYixNQUFNO0FBQUEsRUFDTixTQUFTO0FBQUEsRUFDVCxPQUFPO0FBQUEsRUFDUCxJQUFJO0FBQUEsRUFDSixrQkFBa0IsQ0FBQyxRQUFRO0FBQzdCOzs7QUM3SWUsOEJBQThCLFNBQVM7QUFDcEQsU0FBTztBQUFBLElBQ0wsWUFBWSxRQUFRO0FBQUEsSUFDcEIsV0FBVyxRQUFRO0FBQUEsRUFDckI7QUFDRjs7O0FDRGUsdUJBQXVCLE1BQU07QUFDMUMsTUFBSSxTQUFTLFVBQVUsSUFBSSxLQUFLLENBQUMsY0FBYyxJQUFJLEdBQUc7QUFDcEQsV0FBTyxnQkFBZ0IsSUFBSTtBQUFBLEVBQzdCLE9BQU87QUFDTCxXQUFPLHFCQUFxQixJQUFJO0FBQUEsRUFDbEM7QUFDRjs7O0FDREEseUJBQXlCLFNBQVM7QUFDaEMsTUFBSSxPQUFPLFFBQVEsc0JBQXNCO0FBQ3pDLE1BQUksU0FBUyxNQUFNLEtBQUssS0FBSyxJQUFJLFFBQVEsZUFBZTtBQUN4RCxNQUFJLFNBQVMsTUFBTSxLQUFLLE1BQU0sSUFBSSxRQUFRLGdCQUFnQjtBQUMxRCxTQUFPLFdBQVcsS0FBSyxXQUFXO0FBQ3BDO0FBSWUsMEJBQTBCLHlCQUF5QixjQUFjLFNBQVM7QUFDdkYsTUFBSSxZQUFZLFFBQVE7QUFDdEIsY0FBVTtBQUFBLEVBQ1o7QUFFQSxNQUFJLDBCQUEwQixjQUFjLFlBQVk7QUFDeEQsTUFBSSx1QkFBdUIsY0FBYyxZQUFZLEtBQUssZ0JBQWdCLFlBQVk7QUFDdEYsTUFBSSxrQkFBa0IsbUJBQW1CLFlBQVk7QUFDckQsTUFBSSxPQUFPLHNCQUFzQix5QkFBeUIsc0JBQXNCLE9BQU87QUFDdkYsTUFBSSxTQUFTO0FBQUEsSUFDWCxZQUFZO0FBQUEsSUFDWixXQUFXO0FBQUEsRUFDYjtBQUNBLE1BQUksVUFBVTtBQUFBLElBQ1osR0FBRztBQUFBLElBQ0gsR0FBRztBQUFBLEVBQ0w7QUFFQSxNQUFJLDJCQUEyQixDQUFDLDJCQUEyQixDQUFDLFNBQVM7QUFDbkUsUUFBSSxZQUFZLFlBQVksTUFBTSxVQUNsQyxlQUFlLGVBQWUsR0FBRztBQUMvQixlQUFTLGNBQWMsWUFBWTtBQUFBLElBQ3JDO0FBRUEsUUFBSSxjQUFjLFlBQVksR0FBRztBQUMvQixnQkFBVSxzQkFBc0IsY0FBYyxJQUFJO0FBQ2xELGNBQVEsS0FBSyxhQUFhO0FBQzFCLGNBQVEsS0FBSyxhQUFhO0FBQUEsSUFDNUIsV0FBVyxpQkFBaUI7QUFDMUIsY0FBUSxJQUFJLG9CQUFvQixlQUFlO0FBQUEsSUFDakQ7QUFBQSxFQUNGO0FBRUEsU0FBTztBQUFBLElBQ0wsR0FBRyxLQUFLLE9BQU8sT0FBTyxhQUFhLFFBQVE7QUFBQSxJQUMzQyxHQUFHLEtBQUssTUFBTSxPQUFPLFlBQVksUUFBUTtBQUFBLElBQ3pDLE9BQU8sS0FBSztBQUFBLElBQ1osUUFBUSxLQUFLO0FBQUEsRUFDZjtBQUNGOzs7QUN2REEsZUFBZSxXQUFXO0FBQ3hCLE1BQUksTUFBTSxvQkFBSSxJQUFJO0FBQ2xCLE1BQUksVUFBVSxvQkFBSSxJQUFJO0FBQ3RCLE1BQUksU0FBUyxDQUFDO0FBQ2QsWUFBVSxRQUFRLFNBQVUsVUFBVTtBQUNwQyxRQUFJLElBQUksU0FBUyxNQUFNLFFBQVE7QUFBQSxFQUNqQyxDQUFDO0FBRUQsZ0JBQWMsVUFBVTtBQUN0QixZQUFRLElBQUksU0FBUyxJQUFJO0FBQ3pCLFFBQUksV0FBVyxDQUFDLEVBQUUsT0FBTyxTQUFTLFlBQVksQ0FBQyxHQUFHLFNBQVMsb0JBQW9CLENBQUMsQ0FBQztBQUNqRixhQUFTLFFBQVEsU0FBVSxLQUFLO0FBQzlCLFVBQUksQ0FBQyxRQUFRLElBQUksR0FBRyxHQUFHO0FBQ3JCLFlBQUksY0FBYyxJQUFJLElBQUksR0FBRztBQUU3QixZQUFJLGFBQWE7QUFDZixlQUFLLFdBQVc7QUFBQSxRQUNsQjtBQUFBLE1BQ0Y7QUFBQSxJQUNGLENBQUM7QUFDRCxXQUFPLEtBQUssUUFBUTtBQUFBLEVBQ3RCO0FBRUEsWUFBVSxRQUFRLFNBQVUsVUFBVTtBQUNwQyxRQUFJLENBQUMsUUFBUSxJQUFJLFNBQVMsSUFBSSxHQUFHO0FBRS9CLFdBQUssUUFBUTtBQUFBLElBQ2Y7QUFBQSxFQUNGLENBQUM7QUFDRCxTQUFPO0FBQ1Q7QUFFZSx3QkFBd0IsV0FBVztBQUVoRCxNQUFJLG1CQUFtQixNQUFNLFNBQVM7QUFFdEMsU0FBTyxlQUFlLE9BQU8sU0FBVSxLQUFLLE9BQU87QUFDakQsV0FBTyxJQUFJLE9BQU8saUJBQWlCLE9BQU8sU0FBVSxVQUFVO0FBQzVELGFBQU8sU0FBUyxVQUFVO0FBQUEsSUFDNUIsQ0FBQyxDQUFDO0FBQUEsRUFDSixHQUFHLENBQUMsQ0FBQztBQUNQOzs7QUMzQ2Usa0JBQWtCLEtBQUk7QUFDbkMsTUFBSTtBQUNKLFNBQU8sV0FBWTtBQUNqQixRQUFJLENBQUMsU0FBUztBQUNaLGdCQUFVLElBQUksUUFBUSxTQUFVLFNBQVM7QUFDdkMsZ0JBQVEsUUFBUSxFQUFFLEtBQUssV0FBWTtBQUNqQyxvQkFBVTtBQUNWLGtCQUFRLElBQUcsQ0FBQztBQUFBLFFBQ2QsQ0FBQztBQUFBLE1BQ0gsQ0FBQztBQUFBLElBQ0g7QUFFQSxXQUFPO0FBQUEsRUFDVDtBQUNGOzs7QUNkZSxnQkFBZ0IsS0FBSztBQUNsQyxXQUFTLE9BQU8sVUFBVSxRQUFRLE9BQU8sSUFBSSxNQUFNLE9BQU8sSUFBSSxPQUFPLElBQUksQ0FBQyxHQUFHLE9BQU8sR0FBRyxPQUFPLE1BQU0sUUFBUTtBQUMxRyxTQUFLLE9BQU8sS0FBSyxVQUFVO0FBQUEsRUFDN0I7QUFFQSxTQUFPLENBQUMsRUFBRSxPQUFPLElBQUksRUFBRSxPQUFPLFNBQVUsR0FBRyxHQUFHO0FBQzVDLFdBQU8sRUFBRSxRQUFRLE1BQU0sQ0FBQztBQUFBLEVBQzFCLEdBQUcsR0FBRztBQUNSOzs7QUNOQSxJQUFJLHlCQUF5QjtBQUM3QixJQUFJLDJCQUEyQjtBQUMvQixJQUFJLG1CQUFtQixDQUFDLFFBQVEsV0FBVyxTQUFTLE1BQU0sVUFBVSxZQUFZLFNBQVM7QUFDMUUsMkJBQTJCLFdBQVc7QUFDbkQsWUFBVSxRQUFRLFNBQVUsVUFBVTtBQUNwQyxLQUFDLEVBQUUsT0FBTyxPQUFPLEtBQUssUUFBUSxHQUFHLGdCQUFnQixFQUNoRCxPQUFPLFNBQVUsT0FBTyxPQUFPLE1BQU07QUFDcEMsYUFBTyxLQUFLLFFBQVEsS0FBSyxNQUFNO0FBQUEsSUFDakMsQ0FBQyxFQUFFLFFBQVEsU0FBVSxLQUFLO0FBQ3hCLGNBQVE7QUFBQSxhQUNEO0FBQ0gsY0FBSSxPQUFPLFNBQVMsU0FBUyxVQUFVO0FBQ3JDLG9CQUFRLE1BQU0sT0FBTyx3QkFBd0IsT0FBTyxTQUFTLElBQUksR0FBRyxVQUFVLFlBQVksTUFBTyxPQUFPLFNBQVMsSUFBSSxJQUFJLEdBQUksQ0FBQztBQUFBLFVBQ2hJO0FBRUE7QUFBQSxhQUVHO0FBQ0gsY0FBSSxPQUFPLFNBQVMsWUFBWSxXQUFXO0FBQ3pDLG9CQUFRLE1BQU0sT0FBTyx3QkFBd0IsU0FBUyxNQUFNLGFBQWEsYUFBYSxNQUFPLE9BQU8sU0FBUyxPQUFPLElBQUksR0FBSSxDQUFDO0FBQUEsVUFDL0g7QUFFQTtBQUFBLGFBRUc7QUFDSCxjQUFJLGVBQWUsUUFBUSxTQUFTLEtBQUssSUFBSSxHQUFHO0FBQzlDLG9CQUFRLE1BQU0sT0FBTyx3QkFBd0IsU0FBUyxNQUFNLFdBQVcsWUFBWSxlQUFlLEtBQUssSUFBSSxHQUFHLE1BQU8sT0FBTyxTQUFTLEtBQUssSUFBSSxHQUFJLENBQUM7QUFBQSxVQUNySjtBQUVBO0FBQUEsYUFFRztBQUNILGNBQUksT0FBTyxTQUFTLE9BQU8sWUFBWTtBQUNyQyxvQkFBUSxNQUFNLE9BQU8sd0JBQXdCLFNBQVMsTUFBTSxRQUFRLGNBQWMsTUFBTyxPQUFPLFNBQVMsRUFBRSxJQUFJLEdBQUksQ0FBQztBQUFBLFVBQ3RIO0FBRUE7QUFBQSxhQUVHO0FBQ0gsY0FBSSxTQUFTLFVBQVUsUUFBUSxPQUFPLFNBQVMsV0FBVyxZQUFZO0FBQ3BFLG9CQUFRLE1BQU0sT0FBTyx3QkFBd0IsU0FBUyxNQUFNLFlBQVksY0FBYyxNQUFPLE9BQU8sU0FBUyxFQUFFLElBQUksR0FBSSxDQUFDO0FBQUEsVUFDMUg7QUFFQTtBQUFBLGFBRUc7QUFDSCxjQUFJLFNBQVMsWUFBWSxRQUFRLENBQUMsTUFBTSxRQUFRLFNBQVMsUUFBUSxHQUFHO0FBQ2xFLG9CQUFRLE1BQU0sT0FBTyx3QkFBd0IsU0FBUyxNQUFNLGNBQWMsV0FBVyxNQUFPLE9BQU8sU0FBUyxRQUFRLElBQUksR0FBSSxDQUFDO0FBQUEsVUFDL0g7QUFFQTtBQUFBLGFBRUc7QUFDSCxjQUFJLENBQUMsTUFBTSxRQUFRLFNBQVMsZ0JBQWdCLEdBQUc7QUFDN0Msb0JBQVEsTUFBTSxPQUFPLHdCQUF3QixTQUFTLE1BQU0sc0JBQXNCLFdBQVcsTUFBTyxPQUFPLFNBQVMsZ0JBQWdCLElBQUksR0FBSSxDQUFDO0FBQUEsVUFDL0k7QUFFQTtBQUFBLGFBRUc7QUFBQSxhQUNBO0FBQ0g7QUFBQTtBQUdBLGtCQUFRLE1BQU0sNkRBQThELFNBQVMsT0FBTyxzQ0FBdUMsaUJBQWlCLElBQUksU0FBVSxHQUFHO0FBQ25LLG1CQUFPLE1BQU8sSUFBSTtBQUFBLFVBQ3BCLENBQUMsRUFBRSxLQUFLLElBQUksSUFBSSxZQUFhLE1BQU0saUJBQWtCO0FBQUE7QUFHekQsZUFBUyxZQUFZLFNBQVMsU0FBUyxRQUFRLFNBQVUsYUFBYTtBQUNwRSxZQUFJLFVBQVUsS0FBSyxTQUFVLEtBQUs7QUFDaEMsaUJBQU8sSUFBSSxTQUFTO0FBQUEsUUFDdEIsQ0FBQyxLQUFLLE1BQU07QUFDVixrQkFBUSxNQUFNLE9BQU8sMEJBQTBCLE9BQU8sU0FBUyxJQUFJLEdBQUcsYUFBYSxXQUFXLENBQUM7QUFBQSxRQUNqRztBQUFBLE1BQ0YsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUFBLEVBQ0gsQ0FBQztBQUNIOzs7QUNoRmUsa0JBQWtCLEtBQUssS0FBSTtBQUN4QyxNQUFJLGNBQWMsb0JBQUksSUFBSTtBQUMxQixTQUFPLElBQUksT0FBTyxTQUFVLE1BQU07QUFDaEMsUUFBSSxhQUFhLElBQUcsSUFBSTtBQUV4QixRQUFJLENBQUMsWUFBWSxJQUFJLFVBQVUsR0FBRztBQUNoQyxrQkFBWSxJQUFJLFVBQVU7QUFDMUIsYUFBTztBQUFBLElBQ1Q7QUFBQSxFQUNGLENBQUM7QUFDSDs7O0FDVmUscUJBQXFCLFdBQVc7QUFDN0MsTUFBSSxTQUFTLFVBQVUsT0FBTyxTQUFVLFNBQVEsU0FBUztBQUN2RCxRQUFJLFdBQVcsUUFBTyxRQUFRO0FBQzlCLFlBQU8sUUFBUSxRQUFRLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxVQUFVLFNBQVM7QUFBQSxNQUNyRSxTQUFTLE9BQU8sT0FBTyxDQUFDLEdBQUcsU0FBUyxTQUFTLFFBQVEsT0FBTztBQUFBLE1BQzVELE1BQU0sT0FBTyxPQUFPLENBQUMsR0FBRyxTQUFTLE1BQU0sUUFBUSxJQUFJO0FBQUEsSUFDckQsQ0FBQyxJQUFJO0FBQ0wsV0FBTztBQUFBLEVBQ1QsR0FBRyxDQUFDLENBQUM7QUFFTCxTQUFPLE9BQU8sS0FBSyxNQUFNLEVBQUUsSUFBSSxTQUFVLEtBQUs7QUFDNUMsV0FBTyxPQUFPO0FBQUEsRUFDaEIsQ0FBQztBQUNIOzs7QUNDQSxJQUFJLHdCQUF3QjtBQUM1QixJQUFJLHNCQUFzQjtBQUMxQixJQUFJLGtCQUFrQjtBQUFBLEVBQ3BCLFdBQVc7QUFBQSxFQUNYLFdBQVcsQ0FBQztBQUFBLEVBQ1osVUFBVTtBQUNaO0FBRUEsNEJBQTRCO0FBQzFCLFdBQVMsT0FBTyxVQUFVLFFBQVEsT0FBTyxJQUFJLE1BQU0sSUFBSSxHQUFHLE9BQU8sR0FBRyxPQUFPLE1BQU0sUUFBUTtBQUN2RixTQUFLLFFBQVEsVUFBVTtBQUFBLEVBQ3pCO0FBRUEsU0FBTyxDQUFDLEtBQUssS0FBSyxTQUFVLFNBQVM7QUFDbkMsV0FBTyxDQUFFLFlBQVcsT0FBTyxRQUFRLDBCQUEwQjtBQUFBLEVBQy9ELENBQUM7QUFDSDtBQUVPLHlCQUF5QixrQkFBa0I7QUFDaEQsTUFBSSxxQkFBcUIsUUFBUTtBQUMvQix1QkFBbUIsQ0FBQztBQUFBLEVBQ3RCO0FBRUEsTUFBSSxvQkFBb0Isa0JBQ3BCLHdCQUF3QixrQkFBa0Isa0JBQzFDLG9CQUFtQiwwQkFBMEIsU0FBUyxDQUFDLElBQUksdUJBQzNELHlCQUF5QixrQkFBa0IsZ0JBQzNDLGlCQUFpQiwyQkFBMkIsU0FBUyxrQkFBa0I7QUFDM0UsU0FBTyx1QkFBc0IsWUFBVyxTQUFRLFVBQVM7QUFDdkQsUUFBSSxhQUFZLFFBQVE7QUFDdEIsaUJBQVU7QUFBQSxJQUNaO0FBRUEsUUFBSSxRQUFRO0FBQUEsTUFDVixXQUFXO0FBQUEsTUFDWCxrQkFBa0IsQ0FBQztBQUFBLE1BQ25CLFNBQVMsT0FBTyxPQUFPLENBQUMsR0FBRyxpQkFBaUIsY0FBYztBQUFBLE1BQzFELGVBQWUsQ0FBQztBQUFBLE1BQ2hCLFVBQVU7QUFBQSxRQUNSLFdBQVc7QUFBQSxRQUNYLFFBQVE7QUFBQSxNQUNWO0FBQUEsTUFDQSxZQUFZLENBQUM7QUFBQSxNQUNiLFFBQVEsQ0FBQztBQUFBLElBQ1g7QUFDQSxRQUFJLG1CQUFtQixDQUFDO0FBQ3hCLFFBQUksY0FBYztBQUNsQixRQUFJLFdBQVc7QUFBQSxNQUNiO0FBQUEsTUFDQSxZQUFZLG9CQUFvQixrQkFBa0I7QUFDaEQsWUFBSSxXQUFVLE9BQU8scUJBQXFCLGFBQWEsaUJBQWlCLE1BQU0sT0FBTyxJQUFJO0FBQ3pGLCtCQUF1QjtBQUN2QixjQUFNLFVBQVUsT0FBTyxPQUFPLENBQUMsR0FBRyxnQkFBZ0IsTUFBTSxTQUFTLFFBQU87QUFDeEUsY0FBTSxnQkFBZ0I7QUFBQSxVQUNwQixXQUFXLFVBQVUsVUFBUyxJQUFJLGtCQUFrQixVQUFTLElBQUksV0FBVSxpQkFBaUIsa0JBQWtCLFdBQVUsY0FBYyxJQUFJLENBQUM7QUFBQSxVQUMzSSxRQUFRLGtCQUFrQixPQUFNO0FBQUEsUUFDbEM7QUFHQSxZQUFJLG1CQUFtQixlQUFlLFlBQVksQ0FBQyxFQUFFLE9BQU8sbUJBQWtCLE1BQU0sUUFBUSxTQUFTLENBQUMsQ0FBQztBQUV2RyxjQUFNLG1CQUFtQixpQkFBaUIsT0FBTyxTQUFVLEdBQUc7QUFDNUQsaUJBQU8sRUFBRTtBQUFBLFFBQ1gsQ0FBQztBQUdELFlBQUksTUFBdUM7QUFDekMsY0FBSSxZQUFZLFNBQVMsQ0FBQyxFQUFFLE9BQU8sa0JBQWtCLE1BQU0sUUFBUSxTQUFTLEdBQUcsU0FBVSxNQUFNO0FBQzdGLGdCQUFJLE9BQU8sS0FBSztBQUNoQixtQkFBTztBQUFBLFVBQ1QsQ0FBQztBQUNELDRCQUFrQixTQUFTO0FBRTNCLGNBQUksaUJBQWlCLE1BQU0sUUFBUSxTQUFTLE1BQU0sTUFBTTtBQUN0RCxnQkFBSSxlQUFlLE1BQU0saUJBQWlCLEtBQUssU0FBVSxPQUFPO0FBQzlELGtCQUFJLE9BQU8sTUFBTTtBQUNqQixxQkFBTyxTQUFTO0FBQUEsWUFDbEIsQ0FBQztBQUVELGdCQUFJLENBQUMsY0FBYztBQUNqQixzQkFBUSxNQUFNLENBQUMsNERBQTRELDhCQUE4QixFQUFFLEtBQUssR0FBRyxDQUFDO0FBQUEsWUFDdEg7QUFBQSxVQUNGO0FBRUEsY0FBSSxvQkFBb0Isa0JBQWlCLE9BQU0sR0FDM0MsWUFBWSxrQkFBa0IsV0FDOUIsY0FBYyxrQkFBa0IsYUFDaEMsZUFBZSxrQkFBa0IsY0FDakMsYUFBYSxrQkFBa0I7QUFJbkMsY0FBSSxDQUFDLFdBQVcsYUFBYSxjQUFjLFVBQVUsRUFBRSxLQUFLLFNBQVUsUUFBUTtBQUM1RSxtQkFBTyxXQUFXLE1BQU07QUFBQSxVQUMxQixDQUFDLEdBQUc7QUFDRixvQkFBUSxLQUFLLENBQUMsK0RBQStELDZEQUE2RCw4REFBOEQsNERBQTRELFlBQVksRUFBRSxLQUFLLEdBQUcsQ0FBQztBQUFBLFVBQzdSO0FBQUEsUUFDRjtBQUVBLDJCQUFtQjtBQUNuQixlQUFPLFNBQVMsT0FBTztBQUFBLE1BQ3pCO0FBQUEsTUFNQSxhQUFhLHVCQUF1QjtBQUNsQyxZQUFJLGFBQWE7QUFDZjtBQUFBLFFBQ0Y7QUFFQSxZQUFJLGtCQUFrQixNQUFNLFVBQ3hCLGFBQVksZ0JBQWdCLFdBQzVCLFVBQVMsZ0JBQWdCO0FBRzdCLFlBQUksQ0FBQyxpQkFBaUIsWUFBVyxPQUFNLEdBQUc7QUFDeEMsY0FBSSxNQUF1QztBQUN6QyxvQkFBUSxNQUFNLHFCQUFxQjtBQUFBLFVBQ3JDO0FBRUE7QUFBQSxRQUNGO0FBR0EsY0FBTSxRQUFRO0FBQUEsVUFDWixXQUFXLGlCQUFpQixZQUFXLGdCQUFnQixPQUFNLEdBQUcsTUFBTSxRQUFRLGFBQWEsT0FBTztBQUFBLFVBQ2xHLFFBQVEsY0FBYyxPQUFNO0FBQUEsUUFDOUI7QUFNQSxjQUFNLFFBQVE7QUFDZCxjQUFNLFlBQVksTUFBTSxRQUFRO0FBS2hDLGNBQU0saUJBQWlCLFFBQVEsU0FBVSxVQUFVO0FBQ2pELGlCQUFPLE1BQU0sY0FBYyxTQUFTLFFBQVEsT0FBTyxPQUFPLENBQUMsR0FBRyxTQUFTLElBQUk7QUFBQSxRQUM3RSxDQUFDO0FBQ0QsWUFBSSxrQkFBa0I7QUFFdEIsaUJBQVMsUUFBUSxHQUFHLFFBQVEsTUFBTSxpQkFBaUIsUUFBUSxTQUFTO0FBQ2xFLGNBQUksTUFBdUM7QUFDekMsK0JBQW1CO0FBRW5CLGdCQUFJLGtCQUFrQixLQUFLO0FBQ3pCLHNCQUFRLE1BQU0sbUJBQW1CO0FBQ2pDO0FBQUEsWUFDRjtBQUFBLFVBQ0Y7QUFFQSxjQUFJLE1BQU0sVUFBVSxNQUFNO0FBQ3hCLGtCQUFNLFFBQVE7QUFDZCxvQkFBUTtBQUNSO0FBQUEsVUFDRjtBQUVBLGNBQUksd0JBQXdCLE1BQU0saUJBQWlCLFFBQy9DLE1BQUssc0JBQXNCLElBQzNCLHlCQUF5QixzQkFBc0IsU0FDL0MsV0FBVywyQkFBMkIsU0FBUyxDQUFDLElBQUksd0JBQ3BELE9BQU8sc0JBQXNCO0FBRWpDLGNBQUksT0FBTyxRQUFPLFlBQVk7QUFDNUIsb0JBQVEsSUFBRztBQUFBLGNBQ1Q7QUFBQSxjQUNBLFNBQVM7QUFBQSxjQUNUO0FBQUEsY0FDQTtBQUFBLFlBQ0YsQ0FBQyxLQUFLO0FBQUEsVUFDUjtBQUFBLFFBQ0Y7QUFBQSxNQUNGO0FBQUEsTUFHQSxRQUFRLFNBQVMsV0FBWTtBQUMzQixlQUFPLElBQUksUUFBUSxTQUFVLFNBQVM7QUFDcEMsbUJBQVMsWUFBWTtBQUNyQixrQkFBUSxLQUFLO0FBQUEsUUFDZixDQUFDO0FBQUEsTUFDSCxDQUFDO0FBQUEsTUFDRCxTQUFTLG1CQUFtQjtBQUMxQiwrQkFBdUI7QUFDdkIsc0JBQWM7QUFBQSxNQUNoQjtBQUFBLElBQ0Y7QUFFQSxRQUFJLENBQUMsaUJBQWlCLFlBQVcsT0FBTSxHQUFHO0FBQ3hDLFVBQUksTUFBdUM7QUFDekMsZ0JBQVEsTUFBTSxxQkFBcUI7QUFBQSxNQUNyQztBQUVBLGFBQU87QUFBQSxJQUNUO0FBRUEsYUFBUyxXQUFXLFFBQU8sRUFBRSxLQUFLLFNBQVUsUUFBTztBQUNqRCxVQUFJLENBQUMsZUFBZSxTQUFRLGVBQWU7QUFDekMsaUJBQVEsY0FBYyxNQUFLO0FBQUEsTUFDN0I7QUFBQSxJQUNGLENBQUM7QUFNRCxrQ0FBOEI7QUFDNUIsWUFBTSxpQkFBaUIsUUFBUSxTQUFVLE9BQU87QUFDOUMsWUFBSSxPQUFPLE1BQU0sTUFDYixnQkFBZ0IsTUFBTSxTQUN0QixXQUFVLGtCQUFrQixTQUFTLENBQUMsSUFBSSxlQUMxQyxVQUFTLE1BQU07QUFFbkIsWUFBSSxPQUFPLFlBQVcsWUFBWTtBQUNoQyxjQUFJLFlBQVksUUFBTztBQUFBLFlBQ3JCO0FBQUEsWUFDQTtBQUFBLFlBQ0E7QUFBQSxZQUNBLFNBQVM7QUFBQSxVQUNYLENBQUM7QUFFRCxjQUFJLFNBQVMsbUJBQWtCO0FBQUEsVUFBQztBQUVoQywyQkFBaUIsS0FBSyxhQUFhLE1BQU07QUFBQSxRQUMzQztBQUFBLE1BQ0YsQ0FBQztBQUFBLElBQ0g7QUFFQSxzQ0FBa0M7QUFDaEMsdUJBQWlCLFFBQVEsU0FBVSxLQUFJO0FBQ3JDLGVBQU8sSUFBRztBQUFBLE1BQ1osQ0FBQztBQUNELHlCQUFtQixDQUFDO0FBQUEsSUFDdEI7QUFFQSxXQUFPO0FBQUEsRUFDVDtBQUNGOzs7QUNyUEEsSUFBSSxtQkFBbUIsQ0FBQyx3QkFBZ0IsdUJBQWUsdUJBQWUscUJBQWEsZ0JBQVEsY0FBTSx5QkFBaUIsZUFBTyxZQUFJO0FBQzdILElBQUksZUFBNEIsZ0NBQWdCO0FBQUEsRUFDOUM7QUFDRixDQUFDOzs7QXpEUkQsSUFBTSxhQUFhLENBQUMsT0FBZSxTQUF5QjtBQUN4RCxTQUFTLFNBQVEsT0FBUSxRQUFRO0FBQ3JDO0FBRUEsSUFBTSxVQUFOLE1BQWlCO0FBQUEsRUFLYixZQUNZLE9BQ0EsYUFDUixPQUNGO0FBSFU7QUFDQTtBQUlSLGdCQUFZLEdBQ1IsU0FDQSxvQkFDQSxLQUFLLGtCQUFrQixLQUFLLElBQUksQ0FDcEM7QUFDQSxnQkFBWSxHQUNSLGFBQ0Esb0JBQ0EsS0FBSyxzQkFBc0IsS0FBSyxJQUFJLENBQ3hDO0FBRUEsVUFBTSxTQUFTLENBQUMsR0FBRyxXQUFXLENBQUMsVUFBVTtBQUNyQyxVQUFJLENBQUMsTUFBTSxhQUFhO0FBQ3BCLGFBQUssZ0JBQWdCLEtBQUssZUFBZSxHQUFHLElBQUk7QUFDaEQsZUFBTztBQUFBLE1BQ1g7QUFBQSxJQUNKLENBQUM7QUFFRCxVQUFNLFNBQVMsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxVQUFVO0FBQ3ZDLFVBQUksQ0FBQyxNQUFNLGFBQWE7QUFDcEIsYUFBSyxnQkFBZ0IsS0FBSyxlQUFlLEdBQUcsSUFBSTtBQUNoRCxlQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0osQ0FBQztBQUVELFVBQU0sU0FBUyxDQUFDLEdBQUcsU0FBUyxDQUFDLFVBQVU7QUFDbkMsVUFBSSxDQUFDLE1BQU0sYUFBYTtBQUNwQixhQUFLLGdCQUFnQixLQUFLO0FBQzFCLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsa0JBQWtCLE9BQW1CLElBQTBCO0FBQzNELFVBQU0sZUFBZTtBQUVyQixVQUFNLE9BQU8sS0FBSyxZQUFZLFFBQVEsRUFBRTtBQUN4QyxTQUFLLGdCQUFnQixNQUFNLEtBQUs7QUFDaEMsU0FBSyxnQkFBZ0IsS0FBSztBQUFBLEVBQzlCO0FBQUEsRUFFQSxzQkFBc0IsUUFBb0IsSUFBMEI7QUFDaEUsVUFBTSxPQUFPLEtBQUssWUFBWSxRQUFRLEVBQUU7QUFDeEMsU0FBSyxnQkFBZ0IsTUFBTSxLQUFLO0FBQUEsRUFDcEM7QUFBQSxFQUVBLGVBQWUsUUFBYTtBQUN4QixTQUFLLFlBQVksTUFBTTtBQUN2QixVQUFNLGdCQUFrQyxDQUFDO0FBRXpDLFdBQU8sUUFBUSxDQUFDLFVBQVU7QUFDdEIsWUFBTSxlQUFlLEtBQUssWUFBWSxVQUFVLGlCQUFpQjtBQUNqRSxXQUFLLE1BQU0saUJBQWlCLE9BQU8sWUFBWTtBQUMvQyxvQkFBYyxLQUFLLFlBQVk7QUFBQSxJQUNuQyxDQUFDO0FBRUQsU0FBSyxTQUFTO0FBQ2QsU0FBSyxjQUFjO0FBQ25CLFNBQUssZ0JBQWdCLEdBQUcsS0FBSztBQUFBLEVBQ2pDO0FBQUEsRUFFQSxnQkFBZ0IsT0FBbUM7QUFDL0MsVUFBTSxlQUFlLEtBQUssT0FBTyxLQUFLO0FBQ3RDLFFBQUksY0FBYztBQUNkLFdBQUssTUFBTSxpQkFBaUIsY0FBYyxLQUFLO0FBQUEsSUFDbkQ7QUFBQSxFQUNKO0FBQUEsRUFFQSxnQkFBZ0IsZUFBdUIsZ0JBQXlCO0FBQzVELFVBQU0sa0JBQWtCLFdBQ3BCLGVBQ0EsS0FBSyxZQUFZLE1BQ3JCO0FBQ0EsVUFBTSx5QkFBeUIsS0FBSyxZQUFZLEtBQUs7QUFDckQsVUFBTSxxQkFBcUIsS0FBSyxZQUFZO0FBRTVDLHFFQUF3QixZQUFZO0FBQ3BDLDZEQUFvQixTQUFTO0FBRTdCLFNBQUssZUFBZTtBQUVwQixRQUFJLGdCQUFnQjtBQUNoQix5QkFBbUIsZUFBZSxLQUFLO0FBQUEsSUFDM0M7QUFBQSxFQUNKO0FBQ0o7QUFFTyxJQUFlLG1CQUFmLE1BQStEO0FBQUEsRUFRbEUsWUFBWSxTQUFpRDtBQUN6RCxTQUFLLFVBQVU7QUFDZixTQUFLLFFBQVEsSUFBSSx3QkFBTTtBQUV2QixTQUFLLFlBQVksVUFBVSxzQkFBc0I7QUFDakQsVUFBTSxhQUFhLEtBQUssVUFBVSxVQUFVLFlBQVk7QUFDeEQsU0FBSyxVQUFVLElBQUksUUFBUSxNQUFNLFlBQVksS0FBSyxLQUFLO0FBRXZELFNBQUssTUFBTSxTQUFTLENBQUMsR0FBRyxVQUFVLEtBQUssTUFBTSxLQUFLLElBQUksQ0FBQztBQUV2RCxTQUFLLFFBQVEsaUJBQWlCLFNBQVMsS0FBSyxlQUFlLEtBQUssSUFBSSxDQUFDO0FBQ3JFLFNBQUssUUFBUSxpQkFBaUIsU0FBUyxLQUFLLGVBQWUsS0FBSyxJQUFJLENBQUM7QUFDckUsU0FBSyxRQUFRLGlCQUFpQixRQUFRLEtBQUssTUFBTSxLQUFLLElBQUksQ0FBQztBQUMzRCxTQUFLLFVBQVUsR0FDWCxhQUNBLHlCQUNBLENBQUMsVUFBc0I7QUFDbkIsWUFBTSxlQUFlO0FBQUEsSUFDekIsQ0FDSjtBQUFBLEVBQ0o7QUFBQSxFQUVBLGlCQUF1QjtBQUNuQixVQUFNLFdBQVcsS0FBSyxRQUFRO0FBQzlCLFVBQU0sY0FBYyxLQUFLLGVBQWUsUUFBUTtBQUVoRCxRQUFJLENBQUMsYUFBYTtBQUNkLFdBQUssTUFBTTtBQUNYO0FBQUEsSUFDSjtBQUVBLFFBQUksWUFBWSxTQUFTLEdBQUc7QUFDeEIsV0FBSyxRQUFRLGVBQWUsV0FBVztBQUV2QyxXQUFLLEtBQVcsSUFBSyxJQUFJLGdCQUFnQixLQUFLLE9BQU87QUFBQSxJQUN6RCxPQUFPO0FBQ0gsV0FBSyxNQUFNO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQSxFQUVBLEtBQUssV0FBd0IsU0FBNEI7QUFFckQsSUFBTSxJQUFLLE9BQU8sVUFBVSxLQUFLLEtBQUs7QUFFdEMsY0FBVSxZQUFZLEtBQUssU0FBUztBQUNwQyxTQUFLLFNBQVMsYUFBYSxTQUFTLEtBQUssV0FBVztBQUFBLE1BQ2hELFdBQVc7QUFBQSxNQUNYLFdBQVc7QUFBQSxRQUNQO0FBQUEsVUFDSSxNQUFNO0FBQUEsVUFDTixTQUFTO0FBQUEsVUFDVCxJQUFJLENBQUMsRUFBRSxPQUFPLGVBQWU7QUFLekIsa0JBQU0sY0FBYyxHQUFHLE1BQU0sTUFBTSxVQUFVO0FBQzdDLGdCQUFJLE1BQU0sT0FBTyxPQUFPLFVBQVUsYUFBYTtBQUMzQztBQUFBLFlBQ0o7QUFDQSxrQkFBTSxPQUFPLE9BQU8sUUFBUTtBQUM1QixxQkFBUyxPQUFPO0FBQUEsVUFDcEI7QUFBQSxVQUNBLE9BQU87QUFBQSxVQUNQLFVBQVUsQ0FBQyxlQUFlO0FBQUEsUUFDOUI7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsUUFBYztBQUVWLElBQU0sSUFBSyxPQUFPLFNBQVMsS0FBSyxLQUFLO0FBRXJDLFNBQUssUUFBUSxlQUFlLENBQUMsQ0FBQztBQUM5QixRQUFJLEtBQUs7QUFBUSxXQUFLLE9BQU8sUUFBUTtBQUNyQyxTQUFLLFVBQVUsT0FBTztBQUFBLEVBQzFCO0FBS0o7OztBRDlMTyxJQUFNLGNBQU4sY0FBMEIsaUJBQXdCO0FBQUEsRUFDckQsWUFDVyxTQUNDLFFBQ0QsUUFDQSxhQUFxQixNQUM5QjtBQUNFLFVBQU0sT0FBTztBQUxOO0FBQ0M7QUFDRDtBQUNBO0FBR1AsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUVBLGVBQWUsV0FBNEI7QUFDdkMsVUFBTSxZQUFZLENBQUM7QUFDbkIsUUFBSTtBQUNBLGdCQUFVLEtBQUssR0FBRyx1QkFBdUIsS0FBSyxRQUFRLEtBQUssTUFBTSxDQUFDO0FBQUEsSUFDdEUsU0FBUyxPQUFQO0FBQUEsSUFFRjtBQUNBLFVBQU0sUUFBaUIsQ0FBQztBQUN4QixVQUFNLGtCQUFrQixVQUFVLFlBQVk7QUFFOUMsY0FBVSxRQUFRLENBQUMsU0FBd0I7QUFDdkMsVUFDSSxnQkFBZ0IsMkJBQ2hCLEtBQUssY0FBYyxLQUFLLGNBQ3hCLEtBQUssS0FBSyxZQUFZLEVBQUUsU0FBUyxlQUFlLEdBQ2xEO0FBQ0UsY0FBTSxLQUFLLElBQUk7QUFBQSxNQUNuQjtBQUFBLElBQ0osQ0FBQztBQUVELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxpQkFBaUIsTUFBYSxJQUF1QjtBQUNqRCxPQUFHLFFBQVEsS0FBSyxJQUFJO0FBQUEsRUFDeEI7QUFBQSxFQUVBLGlCQUFpQixNQUFtQjtBQUNoQyxTQUFLLFFBQVEsUUFBUSxLQUFLO0FBQzFCLFNBQUssUUFBUSxRQUFRLE9BQU87QUFDNUIsU0FBSyxNQUFNO0FBQUEsRUFDZjtBQUNKOzs7QUR6Q0EsSUFBOEIseUJBQTlCLGNBQTZELGNBQWE7QUFBQSxFQUl0RSxZQUFZLFFBQXNCLE9BQWMsTUFBaUI7QUFDN0QsVUFBTSxRQUFRLE9BQU8sSUFBSTtBQUFBLEVBQzdCO0FBQUEsRUFFQSxBQUFRLDRCQUE0QixXQUEyQixRQUFzQztBQUNqRyxVQUFNLDhCQUE4QixVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ2xGLGdDQUE0QixVQUFVLEVBQUUsTUFBTSxvQkFBb0IsS0FBSyxRQUFRLENBQUM7QUFDaEYsVUFBTSxRQUFRLElBQUksZ0NBQWMsMkJBQTJCO0FBQzNELFVBQU0sUUFBUSxTQUFTLFlBQVk7QUFDbkMsVUFBTSxRQUFRLFNBQVMsWUFBWTtBQUNuQyxRQUFJLFlBQ0EsTUFBTSxTQUNOLFFBQ0EsR0FDSjtBQUNBLFVBQU0sZUFBZSxLQUFLLE1BQU0sUUFBUTtBQUN4QyxVQUFNLFNBQVMsZ0JBQWdCLEVBQUU7QUFDakMsVUFBTSxlQUFlLHFCQUFxQjtBQUMxQyxVQUFNLFNBQVMsV0FBUyxLQUFLLE1BQU0sUUFBUSxxQkFBcUIsS0FBSztBQUNyRSxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsQUFBUSxrQkFBa0IsS0FBbUI7QUFDekMsUUFBSSxZQUFvQyxDQUFDO0FBQ3pDLGFBQVMsUUFBUSxLQUFLLE1BQU0sUUFBUSxZQUFZO0FBQzVDLFVBQUksUUFBUSxNQUFNO0FBQ2Qsa0JBQVUsUUFBUSxLQUFLLE1BQU0sUUFBUSxXQUFXO0FBQUEsTUFDcEQ7QUFBQztBQUFBLElBQ0w7QUFBQztBQUNELFNBQUssTUFBTSxRQUFRLGFBQWE7QUFBQSxFQUNwQztBQUFBLEVBRUEsQUFBUSwwQkFBMEIsaUJBQWlEO0FBQy9FLFVBQU0scUJBQXFCLGdCQUFnQixVQUFVO0FBQ3JELFVBQU0sYUFBYSxtQkFBbUIsVUFBVTtBQUNoRCxVQUFNLGlCQUFpQixXQUFXLFVBQVU7QUFDNUMsV0FBTyxLQUFLLEtBQUssTUFBTSxRQUFRLFVBQVUsRUFBRSxRQUFRLFNBQU87QUFDdEQsV0FBSyx1QkFBdUIsS0FBSyxLQUFLLHFCQUFxQixnQkFBZ0IsR0FBRyxDQUFDO0FBQUEsSUFDbkYsQ0FBQztBQUNELFNBQUssZ0JBQWdCLFlBQVksY0FBYztBQUMvQyxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsQUFBUSxxQkFBcUIsWUFBNEIsS0FBNEI7QUFDakYsVUFBTSxTQUFTLEtBQUssTUFBTSxRQUFRLGNBQWMsQ0FBQztBQUNqRCxVQUFNLGNBQWMsT0FBTztBQUMzQixVQUFNLGlCQUFpQixXQUFXLFVBQVUsRUFBRSxLQUFLLGtCQUFtQixDQUFDO0FBQ3ZFLFVBQU0sUUFBUSxJQUFJLGdDQUFjLGNBQWM7QUFDOUMsVUFBTSxRQUFRLFNBQVMsWUFBWTtBQUNuQyxTQUFLLHVCQUF1QixLQUFLLEtBQUs7QUFDdEMsVUFBTSxTQUFTLFdBQVc7QUFDMUIsVUFBTSxTQUFTLFdBQVM7QUFDcEIsV0FBSyxNQUFNLFFBQVEsV0FBVyxPQUFPO0FBQ3JDLHlCQUFtQixzQkFBc0IsS0FBSztBQUFBLElBQ2xELENBQUM7QUFDRCxVQUFNLG9CQUFvQixJQUFJLGtDQUFnQixjQUFjO0FBQzVELHNCQUFrQixRQUFRLE9BQU8sRUFDNUIsUUFBUSxDQUFDLFFBQW9CO0FBQzFCLFVBQUk7QUFDSixXQUFLLGtCQUFrQixHQUFHO0FBQzFCLGlCQUFXLFlBQVksY0FBYztBQUNyQyxXQUFLLHVCQUF1QixPQUFPLEtBQUs7QUFBQSxJQUM1QyxDQUFDO0FBQ0wsUUFBSSxPQUFPLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxFQUFFLElBQUk7QUFDM0MsWUFBTSxxQkFBcUIsSUFBSSxrQ0FBZ0IsY0FBYztBQUM3RCxxQ0FBUSxtQkFBbUIsVUFBVSxrQkFBa0I7QUFDdkQseUJBQW1CLFFBQVEsQ0FBQyxRQUFvQjtBQUM1QyxjQUFNLFlBQVksT0FBTztBQUN6QixjQUFNLGFBQWEsS0FBSyx1QkFBdUIsUUFBUSxLQUFLO0FBQzVELGNBQU0saUJBQWlCLGVBQWUsS0FBSyxLQUFLLHVCQUF1QixhQUFhLEtBQUssS0FBSyx1QkFBdUIsS0FBSztBQUMxSCxZQUFJLGdCQUFnQjtBQUNoQixnQkFBTSxhQUFhLGVBQWUsUUFBUTtBQUMxQyxnQkFBTSxXQUFXLE9BQU8sS0FBSyxNQUFNLEVBQUUsT0FBTyxPQUFLLE9BQU8sTUFBTSxVQUFVLEVBQUU7QUFDMUUsY0FBSSxVQUFVO0FBQ1YsMkJBQWUsU0FBUyxTQUFTO0FBQ2pDLG1CQUFPLFlBQVk7QUFDbkIsa0JBQU0sU0FBUyxVQUFVO0FBQ3pCLG1CQUFPLE9BQU87QUFBQSxVQUNsQjtBQUFDO0FBQUEsUUFDTDtBQUFDO0FBQUEsTUFDTCxDQUFDO0FBQUEsSUFDTDtBQUFDO0FBQ0QsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLEFBQU8sY0FBYyxPQUF3QjtBQUV6QyxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsQUFBTyxnQkFBd0I7QUFDM0IsWUFBUSxLQUFLLE1BQU0sUUFBUTtBQUFBLFdBQ2xCO0FBQ0QsZUFBTyxPQUFPLE9BQU8sS0FBSyxNQUFNLFFBQVEsVUFBVSxFQUFFLEtBQUssSUFBSTtBQUFBLFdBQzVEO0FBQ0QsZUFBTyxLQUFLLE1BQU0sUUFBUTtBQUFBLFdBQ3pCO0FBQ0QsZUFBTyxLQUFLLE1BQU0sUUFBUTtBQUFBO0FBRTFCLGVBQU87QUFBQTtBQUFBLEVBR25CO0FBQUEsRUFFQSxBQUFPLGVBQWUsU0FBYyxRQUFxQjtBQXJIN0Q7QUFzSFEsUUFBSSxTQUFtQixDQUFDO0FBQ3hCLFFBQUksTUFBTSxRQUFRLEtBQUssTUFBTSxPQUFPLEdBQUc7QUFDbkMsZUFBUyxLQUFLLE1BQU07QUFBQSxJQUN4QixXQUFXLENBQUMsS0FBSyxNQUFNLFFBQVEsWUFBWTtBQUN2QyxlQUFTLE9BQU8sT0FBTyxLQUFLLE1BQU0sT0FBTztBQUFBLElBQzdDLE9BQU87QUFDSCxjQUFRLEtBQUssTUFBTSxRQUFRO0FBQUEsYUFDbEI7QUFDRCxtQkFBUyxPQUFPLE9BQU8sS0FBSyxNQUFNLFFBQVEsVUFBVTtBQUNwRDtBQUFBLGFBQ0M7QUFDRCxtQkFBUyxLQUFLLE9BQU8sV0FBVyx5QkFDM0IsSUFBSSxLQUFLLE1BQU0sUUFBUSxrQkFBa0IsS0FBSyxDQUFDO0FBQ3BEO0FBQUEsYUFDQztBQUNEO0FBQ0ksa0JBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELGdCQUFJLE9BQU87QUFDUCx1QkFBUyxJQUFJLFNBQVMsTUFBTSxXQUFXLFVBQVUsS0FBSyxNQUFNLFFBQVEsbUJBQW1CLEVBQUUsT0FBTyxNQUFNO0FBQUEsWUFDMUcsT0FBTztBQUNILHVCQUFTLENBQUM7QUFBQSxZQUNkO0FBQUEsVUFDSjtBQUNBO0FBQUE7QUFFQSxtQkFBUyxDQUFDO0FBQ1Y7QUFBQTtBQUFBLElBRVo7QUFDQSxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsQUFBTyxrQkFBMkI7QUFDOUIsUUFBSSxRQUFRO0FBQ1osU0FBSyx1QkFBdUIsUUFBUSxXQUFTO0FBeEpyRDtBQXlKWSxVQUFJLFFBQVEsS0FBSyxNQUFNLFFBQVEsS0FBSyxLQUFLLGFBQU0sUUFBUSxrQkFBZCxtQkFBNkIsbUJBQWtCO0FBQ3BGLDJCQUFtQixtQkFDZixPQUNBLCtCQUNKO0FBQ0EsZ0JBQVE7QUFBQSxNQUNaO0FBQUM7QUFDRCxVQUFJLE1BQU0sUUFBUSxTQUFTLE1BQU0sYUFBTSxRQUFRLGtCQUFkLG1CQUE2QixtQkFBa0I7QUFDNUUsMkJBQW1CLG1CQUNmLE9BQ0EsdUJBQ0o7QUFDQSxnQkFBUTtBQUFBLE1BQ1o7QUFBQztBQUFBLElBQ0wsQ0FBQztBQUNELFdBQU8sQ0FBQztBQUFBLEVBQ1o7QUFBQSxFQUVBLEFBQVEsZ0JBQWdCLFlBQTRCLGdCQUFzQztBQUN0RixVQUFNLG1CQUFtQixXQUFXLFVBQVU7QUFDOUMsVUFBTSxXQUFXLGlCQUFpQixTQUFTLFFBQVE7QUFDbkQsYUFBUyxPQUFPO0FBQ2hCLGFBQVMsY0FBYztBQUN2QixhQUFTLGFBQWEsQ0FBTyxRQUFvQjtBQUM3QyxVQUFJO0FBRUosVUFBSSxlQUFlO0FBQ25CLGFBQU8sS0FBSyxLQUFLLE1BQU0sUUFBUSxVQUFVLEVBQUUsUUFBUSxTQUFPO0FBQ3RELFlBQUksU0FBUyxHQUFHLEtBQUssU0FBUyxHQUFHLEtBQUssY0FBYztBQUNoRCx5QkFBZSxTQUFTLEdBQUcsSUFBSTtBQUFBLFFBQ25DO0FBQUM7QUFBQSxNQUNMLENBQUM7QUFDRCxZQUFNLFNBQVMsYUFBYSxTQUFTO0FBQ3JDLFdBQUssTUFBTSxRQUFRLFdBQVcsVUFBVTtBQUN4QyxXQUFLLHFCQUFxQixnQkFBZ0IsTUFBTTtBQUFBLElBQ3BELEVBQUM7QUFDRCxlQUFXLFNBQVMsSUFBSTtBQUFBLEVBQzVCO0FBQUEsRUFFQSxBQUFRLGlDQUFpQyxpQkFBaUQ7QUFDdEYsVUFBTSxnQ0FBZ0MsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUNuRixrQ0FBOEIsU0FBUyxRQUFRLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUM1RSxrQ0FBOEIsU0FBUyxRQUFRLEVBQUUsTUFBTSx3RUFBd0UsS0FBSyxXQUFXLENBQUM7QUFDaEosVUFBTSw2QkFBNkIsOEJBQThCLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ3JHLFVBQU0sb0JBQW9CLElBQUksb0NBQWtCLDBCQUEwQjtBQUMxRSxzQkFBa0IsUUFBUSxTQUFTLFlBQVk7QUFDL0Msc0JBQWtCLFFBQVEsT0FBTztBQUNqQyxzQkFBa0IsUUFBUSxPQUFPO0FBQ2pDLHNCQUFrQixlQUFlLDJDQUEyQztBQUM1RSxzQkFBa0IsU0FBUyxLQUFLLE1BQU0sUUFBUSxxQkFBcUIsRUFBRTtBQUNyRSxzQkFBa0IsU0FBUyxDQUFDLFVBQVU7QUFDbEMsV0FBSyxNQUFNLFFBQVEsb0JBQW9CO0FBQUEsSUFDM0MsQ0FBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFRLDZCQUE2QixrQkFBZ0YsT0FBNkM7QUFDOUosV0FBTyxLQUFLLGdCQUFnQixFQUFFLFFBQVEsQ0FBQyxRQUE4QztBQUNqRixVQUFJLFFBQVEsT0FBTztBQUNmLHlCQUFpQixLQUFLLEtBQUs7QUFBQSxNQUMvQixPQUFPO0FBQ0gseUJBQWlCLEtBQUssS0FBSztBQUFBLE1BQy9CO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBTyx1QkFBdUIsV0FBMkIsUUFBc0IsVUFBa0M7QUFDN0csVUFBTSxzQkFBc0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUMxRSx3QkFBb0IsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLEtBQUssUUFBUSxDQUFDO0FBQzFFLHdCQUFvQixVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDL0MsVUFBTSxhQUFhLElBQUksb0NBQWtCLG1CQUFtQjtBQUc1RCxRQUFJLENBQUMsS0FBSyxNQUFNLFFBQVEsWUFBWTtBQUVoQyxVQUFJLE9BQU8sS0FBSyxNQUFNLFlBQVksWUFBWSxPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sRUFBRSxNQUFNLFNBQU8sQ0FBQyxNQUFNLFNBQVMsR0FBRyxDQUFDLENBQUMsR0FBRztBQUUvRyxjQUFNLGFBQXFDLENBQUM7QUFDNUMsZUFBTyxLQUFLLEtBQUssTUFBTSxPQUFPLEVBQUUsUUFBUSxDQUFDLFFBQWdCLFdBQVcsT0FBTyxLQUFLLE1BQU0sUUFBUSxJQUFJO0FBQ2xHLGFBQUssTUFBTSxVQUFVLENBQUM7QUFDdEIsYUFBSyxNQUFNLFFBQVEsYUFBYTtBQUFBLE1BQ3BDLE9BQU87QUFDSCxhQUFLLE1BQU0sVUFBVSxDQUFDO0FBQUEsTUFDMUI7QUFDQSxXQUFLLE1BQU0sUUFBUSxhQUFhO0FBQ2hDLFdBQUssTUFBTSxRQUFRLHFCQUFxQjtBQUN4QyxXQUFLLE1BQU0sUUFBUSxvQkFBb0I7QUFBQSxJQUMzQztBQUNBLFdBQU8sS0FBd0IsS0FBSSxFQUFFLFFBQVEsQ0FBQyxXQUFpRCxXQUFXLFVBQVUsUUFBUSxBQUFtQixZQUFZLE9BQU8sQ0FBQztBQUNuSyxlQUFXLFNBQVMsS0FBSyxNQUFNLFFBQVEsY0FBYyw2QkFBa0M7QUFFdkYsVUFBTSw4QkFBOEIsS0FBSyw0QkFBNEIsV0FBVyxNQUFNO0FBQ3RGLFVBQU0sOEJBQThCLEtBQUssMEJBQTBCLFNBQVM7QUFDNUUsVUFBTSw2QkFBNkIsS0FBSyxpQ0FBaUMsU0FBUztBQUVsRixVQUFNLG1CQUFpRjtBQUFBLE1BQ25GLGNBQWM7QUFBQSxNQUNkLHNCQUFzQjtBQUFBLE1BQ3RCLHFCQUFxQjtBQUFBLElBQ3pCO0FBRUEsZUFBVyxTQUFTLENBQUMsVUFBZ0Q7QUFDakUsV0FBSyxNQUFNLFFBQVEsYUFBYTtBQUNoQyxXQUFLLDZCQUE2QixrQkFBa0IsS0FBSztBQUFBLElBQzdELENBQUM7QUFFRCxTQUFLLDZCQUE2QixrQkFBa0IsS0FBSyxNQUFNLFFBQVEsVUFBVTtBQUFBLEVBQ3JGO0FBQUEsRUFFQSxBQUFPLGNBQ0gsSUFDQSxHQUNBLGdCQUNBLFFBQTJGLENBQUMsR0FDeEY7QUFDSixVQUFNLE1BQU07QUFDWixtQkFBZSxZQUFZLEdBQUcsR0FBRyxRQUFRLEVBQUUsS0FBSyxNQUFNLE9BQU8sS0FBSyxDQUFDO0FBQUEsRUFDdkU7QUFDSjs7O0FIdFFBLElBQXFCLGNBQXJCLGNBQXlDLHVCQUF1QjtBQUFBLEVBSTVELFlBQVksUUFBc0IsT0FBYztBQUM1QyxVQUFNLFFBQVEsT0FBTyxxQkFBZ0I7QUFIekMsa0NBQStDLENBQUM7QUFBQSxFQUloRDtBQUFBLEVBRUEsQUFBTyxlQUFlLE1BQWMsT0FBZSxNQUFhLFVBQWdFO0FBQzVILFVBQU0sUUFBUSxJQUFJLGtCQUFZLEtBQUssUUFBUSxNQUFNLE9BQU8sS0FBSyxLQUFLO0FBQ2xFLFVBQU0sUUFBUSxRQUFRLGNBQWM7QUFDcEMsVUFBTSxTQUFTLE1BQU0sTUFBTSxLQUFLO0FBQ2hDLFFBQUksWUFBWSxPQUFPLFFBQVEsR0FBRztBQUM5QixlQUFTLFFBQVEsQ0FBQyxTQUFTO0FBQ3ZCLGFBQUssU0FBUyxVQUFVLE1BQU07QUFDOUIsYUFBSyxRQUFRLFVBQVUsc0JBQWlCO0FBQ3hDLGFBQUssUUFBUSxNQUFNO0FBQ25CLGFBQUssV0FBVyxzQkFBc0I7QUFBQSxNQUMxQyxDQUFDO0FBQUEsSUFDTCxXQUFXLFlBQVksVUFBVSxRQUFRLEdBQUc7QUFDeEMsZUFBUyxRQUFRLEtBQUs7QUFBQSxRQUNsQixJQUFJLFVBQVU7QUFBQSxRQUNkLGFBQWEsbUJBQW1CO0FBQUEsUUFDaEM7QUFBQSxRQUNBLE1BQU0sVUFBVTtBQUFBLE1BQ3BCLENBQUM7QUFBQSxJQUNMLFdBQVcsWUFBWSxlQUFlLFFBQVEsR0FBRztBQUM3QyxlQUFTLFVBQVUsVUFBVSxzQkFBa0IsUUFBUSxVQUFVLGNBQWM7QUFBQSxJQUNuRjtBQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBTyx3QkFDSCxNQUNBLG1CQUNBLE9BQ0EsWUFDQSxPQUNBLFFBQ0EsV0FDSTtBQUNKLFVBQU0sYUFBYSxJQUFJLGtCQUFZLEtBQUssUUFBUSxNQUFNLFNBQVMsSUFBSSxLQUFLLE9BQU8sWUFBWSxPQUFPLFFBQVEsU0FBUztBQUNuSCxlQUFXLFFBQVEsUUFBUSxxQkFBcUIsbUJBQW1CO0FBQ25FLGVBQVcsS0FBSztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxBQUFPLGNBQ0gsSUFDQSxHQUNBLGdCQUNBLFFBQTJGLENBQUMsR0FDeEY7QUEzRFo7QUE0RFEsVUFBTSxNQUFNO0FBQ1osbUJBQWUsWUFBWSxHQUFHLEdBQUcsUUFBUSxFQUFFLEtBQUssTUFBTSxTQUFTLElBQUksS0FBSyxDQUFDO0FBRXpFLFVBQU0sU0FBUyxlQUFlLFNBQVMsT0FBTyxFQUFFLEtBQUssV0FBVyxDQUFDO0FBRWpFLFVBQU0saUJBQWlCLGVBQWUsU0FBUyxRQUFRO0FBQ3ZELG1DQUFRLGdCQUFnQixvQkFBb0I7QUFDNUMsVUFBTSxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsUUFBUSxPQUFPO0FBQzFFLFFBQUk7QUFDSixRQUFJLGdCQUFnQiwyQkFBUyxLQUFLLGFBQWEsTUFBTTtBQUNqRCxtQkFBYSxJQUFJLGtCQUFZLEtBQUssUUFBUSxNQUFNLEVBQUUsS0FBSyxNQUFNLE9BQU8sS0FBSyxLQUFLO0FBQUEsSUFDbEYsT0FBTztBQUNILFlBQU0sTUFBTSwwQ0FBMEM7QUFBQSxJQUMxRDtBQUVBLG1CQUFlLFVBQVUsTUFBTSxXQUFXLEtBQUs7QUFDL0MsUUFBSSxDQUFDLHNDQUFPLFlBQVAsbUJBQWdCLFdBQVU7QUFDM0IscUJBQWUsS0FBSztBQUNwQixhQUFPLEtBQUs7QUFDWixxQkFBZSxjQUFjLE1BQU07QUFDL0IsdUJBQWUsS0FBSztBQUNwQixlQUFPLEtBQUs7QUFBQSxNQUNoQjtBQUNBLHFCQUFlLGFBQWEsTUFBTTtBQUM5Qix1QkFBZSxLQUFLO0FBQ3BCLGVBQU8sS0FBSztBQUFBLE1BQ2hCO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0ErRHhGQSx3QkFBcUU7QUFVckUsSUFBcUIsYUFBckIsY0FBd0MsdUJBQXVCO0FBQUEsRUFJM0QsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLG1CQUFlO0FBSHhDLGtDQUErQyxDQUFDO0FBSTVDLFNBQUssa0JBQWtCO0FBQUEsRUFDM0I7QUFBQSxFQUVBLEFBQU8sdUJBQXVCLFdBQTJCLFFBQXNCLFVBQWtDO0FBQzdHLFVBQU0sMEJBQTBCLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDOUUsNEJBQXdCLFVBQVUsRUFBRSxLQUFLLFNBQVMsTUFBTSwrQkFBK0IsQ0FBQztBQUN4Riw0QkFBd0IsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQ25ELFVBQU0sbUJBQW1CLElBQUksa0NBQWdCLHVCQUF1QjtBQUNwRSxxQkFBaUIsU0FBUyxLQUFLLE1BQU0sUUFBUSxhQUFhLEtBQUs7QUFDL0QscUJBQWlCLFNBQVMsV0FBUyxLQUFLLE1BQU0sUUFBUSxZQUFZLEtBQUs7QUFDdkUsVUFBTSx1QkFBdUIsV0FBVyxRQUFRLFFBQVE7QUFBQSxFQUM1RDtBQUFBLEVBRUEsQUFBTyxXQUFXLFVBQTBCO0FBQ3hDLFFBQUk7QUFDSixVQUFNLFNBQVMsS0FBSyxlQUFlO0FBQ25DLFVBQU0sUUFBUSxDQUFDLFdBQVcsS0FBSztBQUMvQixRQUFJLE9BQU8sUUFBUSxLQUFLLE1BQU0sSUFBSTtBQUM5QixtQkFBYSxPQUFPLE1BQU07QUFBQSxJQUM5QixPQUFPO0FBQ0gsbUJBQWEsT0FBUSxRQUFPLFFBQVEsS0FBSyxJQUFJLEtBQUssT0FBTztBQUFBLElBQzdEO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLEFBQU8saUJBQTJCO0FBQzlCLFdBQU8sS0FBSyxNQUFNLFFBQVEsWUFBWSxDQUFDLElBQUksR0FBRyxNQUFNLGVBQWUsQ0FBQyxJQUFJLE1BQU0sZUFBZTtBQUFBLEVBQ2pHO0FBQUEsRUFFQSxBQUFRLHlCQUF5QixXQUFtQztBQTlDeEU7QUErQ1EsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsUUFBSSxlQUFtQztBQUN2QyxRQUFJLFNBQVMsTUFBTSxNQUFNLFdBQVcsU0FBUSxHQUFHO0FBQzNDLFdBQUssZUFBZSxFQUFFLFFBQVEsWUFBVTtBQUNwQyxjQUFNLFdBQVcsTUFBTSxTQUFTLE1BQU07QUFDdEMsWUFBSSxPQUFPLEtBQUssVUFBUyxNQUFNLEVBQUUsTUFBTSxPQUNsQyxDQUFDLFVBQVMsT0FBTyxNQUFNLENBQUMsU0FBUyxPQUFPLE1BQVEsVUFBUyxPQUFPLE9BQU8sU0FBUyxPQUFPLEVBQzVGLEdBQUc7QUFDQyx5QkFBZTtBQUFBLFFBQ25CO0FBQUEsTUFDSixDQUFDO0FBQUEsSUFDTDtBQUNBLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFPLGFBQWEsV0FBMkIsTUFBYSxXQUFtQixXQUE4QjtBQTlEakg7QUErRFEsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsUUFBSTtBQUNKLFFBQUksT0FBTztBQUNQLGNBQVEsTUFBTSxLQUFLLEtBQUssSUFBSSxFQUFFO0FBQUEsYUFDckI7QUFBVyxzQkFBWTtBQUFJO0FBQUEsYUFDM0I7QUFBTSxzQkFBWTtBQUFJO0FBQUEsYUFDdEI7QUFBTyxzQkFBWTtBQUFTO0FBQUEsYUFDNUI7QUFBRyxzQkFBWTtBQUFLO0FBQUE7QUFDaEIsc0JBQVksTUFBTSxLQUFLLEtBQUssSUFBSSxFQUFFO0FBQUE7QUFBQSxJQUVuRCxPQUFPO0FBQ0gsa0JBQVk7QUFBQSxJQUNoQjtBQUNBLGNBQVUsVUFBVSxFQUFFLE1BQU0sS0FBSyx5QkFBeUIsU0FBUyxLQUFLLFVBQVUsQ0FBQztBQUFBLEVBQ3ZGO0FBQUEsRUFFQSxBQUFhLEtBQUssTUFBYyxPQUFlLE1BQTRCO0FBQUE7QUFDdkUsVUFBSSxlQUFlLEtBQUsseUJBQXlCLEtBQUssS0FBSztBQUMzRCxZQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFZLFNBQVMsRUFBRSxPQUFPLEtBQUssV0FBVyxZQUFZLEVBQUUsU0FBUyxFQUFFLEVBQUUsQ0FBQyxHQUFHLElBQUk7QUFBQSxJQUN0SDtBQUFBO0FBQUEsRUFFQSxBQUFPLGVBQWUsTUFBYyxPQUFlLE1BQWEsVUFBZ0U7QUFFNUgsUUFBSSxlQUFlLEtBQUsseUJBQXlCLEtBQUssS0FBSztBQUMzRCxVQUFNLFdBQVcsVUFBVTtBQUMzQixVQUFNLFNBQVMsTUFBUztBQUFHLGtCQUFLLEtBQUssTUFBTSxPQUFPLElBQUk7QUFBQTtBQUN0RCxRQUFJLFdBQVcsT0FBTyxRQUFRLEdBQUc7QUFDN0IsZUFBUyxRQUFRLENBQUMsU0FBUztBQUN2QixhQUFLLFNBQVMsR0FBRyxVQUFVLHVCQUFrQixLQUFLLFdBQVcsWUFBWSxHQUFHO0FBQzVFLGFBQUssUUFBUSxRQUFRO0FBQ3JCLGFBQUssUUFBUSxNQUFNO0FBQ25CLGFBQUssV0FBVyxzQkFBc0I7QUFBQSxNQUMxQyxDQUFDO0FBQUEsSUFDTCxXQUFXLFdBQVcsVUFBVSxRQUFRLEdBQUc7QUFDdkMsZUFBUyxRQUFRLEtBQUs7QUFBQSxRQUNsQixJQUFJLEdBQUcsUUFBUSxnQkFBZ0IsS0FBSyxXQUFXLFlBQVk7QUFBQSxRQUMzRCxhQUFhLFlBQVksY0FBYyx1QkFBa0IsS0FBSyxXQUFXLFlBQVk7QUFBQSxRQUNyRjtBQUFBLFFBQ0EsTUFBTTtBQUFBLE1BQ1YsQ0FBQztBQUFBLElBQ0wsV0FBVyxXQUFXLGVBQWUsUUFBUSxHQUFHO0FBQzVDLGVBQVMsVUFBVSxVQUFVLFFBQVEsR0FBRyx1QkFBa0IsS0FBSyxXQUFXLFlBQVksR0FBRztBQUFBLElBQzdGO0FBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFPLHdCQUNILE1BQ0EsbUJBQ0EsT0FDQSxZQUNBLE9BQ0EsUUFDQSxXQUNJO0FBQ0osVUFBTSxhQUFhLElBQUksa0JBQVksS0FBSyxRQUFRLE1BQU0sU0FBUyxJQUFJLEtBQUssT0FBTyxZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQ25ILGVBQVcsUUFBUSxRQUFRLHFCQUFxQixtQkFBbUI7QUFDbkUsZUFBVyxLQUFLO0FBQUEsRUFDcEI7QUFBQSxFQUVBLEFBQU8sY0FDSCxJQUNBLEdBQ0EsZ0JBQ0EsUUFBd0YsQ0FBQyxHQUNyRjtBQS9IWjtBQWdJUSxVQUFNLE1BQU07QUFDWixtQkFBZSxZQUFZLEdBQUcsR0FBRyxRQUFRLEVBQUUsS0FBSyxNQUFNLE9BQU8sS0FBSyxDQUFDO0FBQ25FLFVBQU0sYUFBYSxLQUFLLFdBQVcsRUFBRSxLQUFLLE1BQU0sS0FBSztBQUNyRCxVQUFNLFNBQVMsZUFBZSxTQUFTLE9BQU8sRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUUvRCxVQUFNLFdBQVcsZUFBZSxTQUFTLFFBQVE7QUFDakQsbUNBQVEsVUFBVSxVQUFVLG9CQUFnQjtBQUM1QyxRQUFJLENBQUMsc0NBQU8sWUFBUCxtQkFBZ0IsV0FBVTtBQUMzQixlQUFTLEtBQUs7QUFDZCxhQUFPLEtBQUs7QUFDWixxQkFBZSxjQUFjLE1BQU07QUFDL0IsaUJBQVMsS0FBSztBQUNkLGVBQU8sS0FBSztBQUFBLE1BQ2hCO0FBQ0EscUJBQWUsYUFBYSxNQUFNO0FBQzlCLGlCQUFTLEtBQUs7QUFDZCxlQUFPLEtBQUs7QUFBQSxNQUNoQjtBQUFBLElBQ0o7QUFHQSxhQUFTLFVBQVUsQ0FBQyxNQUFNO0FBckpsQztBQXNKWSxpQkFBVyxjQUFjLEtBQUssUUFBUSxFQUFFLEtBQUssTUFBTSxLQUFLLE1BQU0sTUFBTSxVQUFVO0FBQzlFLFVBQUksQ0FBQyx1Q0FBTyxZQUFQLG9CQUFnQixXQUFVO0FBQzNCLGlCQUFTLEtBQUs7QUFDZCxlQUFPLEtBQUs7QUFBQSxNQUNoQjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0o7OztBQzVKQSx3QkFBb0Q7OztBQ0RwRCx3QkFBOEQ7OztBQ0M5RCx3QkFBZ0U7OztBQ0RoRSx3QkFBOEQ7QUFPOUQsSUFBcUIscUJBQXJCLGNBQWdELG9DQUF5QjtBQUFBLEVBSXJFLFlBQ1ksUUFDQSxNQUNBLE9BQ1Isb0JBQ1EsYUFBcUIsSUFDckIsUUFBaUIsT0FDakIsU0FBa0IsT0FDbEIsWUFBcUIsT0FDL0I7QUFwQk47QUFxQlEsVUFBTSxPQUFPLEdBQUc7QUFUUjtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdSLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsZ0JBQWhDLG1CQUE2QztBQUMzRCxRQUFJLE9BQU87QUFDUCxVQUFJLE1BQU0sTUFBTSxPQUFPLGtCQUFrQixHQUFHO0FBQ3hDLGNBQU0sUUFBTyxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixtQkFBbUIsSUFBSTtBQUNoRixZQUFJLGlCQUFnQjtBQUFPLGVBQUssZUFBZTtBQUFBLE1BQ25EO0FBQUEsSUFDSjtBQUNBLFNBQUssWUFBWSxTQUFTLGVBQWU7QUFBQSxFQUM3QztBQUFBLEVBRUEsV0FBb0I7QUFDaEIsVUFBTSxnQkFBZ0IsSUFBSSxTQUFTLEtBQUssS0FBSyxVQUFVLEtBQUssTUFBTSxRQUFRLGVBQWUsS0FBSyxTQUFVLEdBQVUsR0FBVTtBQUFFLGFBQU8sRUFBRSxXQUFXLEVBQUUsV0FBVyxLQUFLO0FBQUEsSUFBRTtBQUN0SyxRQUFJO0FBQ0EsWUFBTSxjQUFjLElBQUksYUFBYSxLQUFLLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSyxLQUFLO0FBQzdFLGFBQU8sWUFBWSxTQUFTLEtBQUssSUFBSSxFQUFFLEtBQUssYUFBYTtBQUFBLElBQzdELFNBQVMsT0FBUDtBQUNFLFdBQUssTUFBTTtBQUNYLFlBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUFBLEVBRUEsWUFBWSxNQUFxQjtBQUM3QixXQUFPLEtBQUs7QUFBQSxFQUNoQjtBQUFBLEVBRUEsaUJBQWlCLE9BQTBCLElBQWlCO0FBL0NoRTtBQWdEUSxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxRQUFJLFNBQVMsS0FBSyxNQUFNLFFBQVEsaUJBQWlCO0FBQzdDLFlBQU0sc0JBQXNCLEdBQUcsVUFBVSxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFDcEUsMEJBQW9CLFVBQVU7QUFBQSxRQUMxQixNQUFNLElBQUksU0FBUyxRQUFRLFVBQVUsS0FBSyxNQUFNLFFBQVEsaUJBQWlCLEVBQUUsTUFBTSxLQUFLLE1BQU0sS0FBSyxJQUFJLENBQUM7QUFBQSxNQUMxRyxDQUFDO0FBQ0QsWUFBTSxXQUFXLG9CQUFvQixVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDaEUsZUFBUyxRQUFRLE1BQU0sS0FBSyxJQUFJO0FBQUEsSUFDcEMsT0FBTztBQUNILFNBQUcsUUFBUSxNQUFNLEtBQUssUUFBUTtBQUFBLElBQ2xDO0FBQ0EsT0FBRyxTQUFTLGlCQUFpQjtBQUM3QixVQUFNLFNBQVMsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUMzRCxPQUFHLFlBQVksTUFBTTtBQUNyQixRQUFJLFlBQUssaUJBQUwsbUJBQW1CLFVBQVMsTUFBTSxLQUFLLE1BQU07QUFDN0MsU0FBRyxTQUFTLGVBQWU7QUFDM0IsWUFBTSxnQkFBZ0IsR0FBRyxVQUFVLEVBQUUsS0FBSyxpQkFBaUIsQ0FBQztBQUM1RCxxQ0FBUSxlQUFlLGNBQWM7QUFBQSxJQUN6QztBQUNBLFNBQUssUUFBUSxNQUFNO0FBQUEsRUFDdkI7QUFBQSxFQUVBLEFBQU0sYUFBYSxNQUE0QjtBQUFBO0FBdEVuRDtBQXVFUSxZQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxVQUFJLFFBQTRCO0FBQ2hDLFVBQUksU0FBUyxLQUFLLE1BQU0sUUFBUSxpQkFBaUI7QUFDN0MsZ0JBQVEsSUFBSSxTQUFTLFFBQVEsVUFBVSxLQUFLLE1BQU0sUUFBUSxpQkFBaUIsRUFBRSxNQUFNLEtBQUssS0FBSyxJQUFJLENBQUM7QUFBQSxNQUN0RztBQUNBLFlBQU0sUUFBUSxVQUFVLGtCQUFrQixLQUFLLFFBQVEsS0FBSyxNQUFNLEtBQUssVUFBVSxRQUFXLEtBQUs7QUFDakcsWUFBTSxXQUFXLEtBQUssUUFBUSxDQUFDLEVBQUUsTUFBTSxLQUFLLE1BQU0sTUFBTSxTQUFTLEVBQUUsTUFBYSxFQUFFLENBQUMsR0FBRyxLQUFLLE1BQU0sS0FBSyxZQUFZLEtBQUssUUFBUSxLQUFLLFNBQVM7QUFBQSxJQUNqSjtBQUFBO0FBQ0o7OztBRHJFQSxJQUFxQixZQUFyQixjQUF1QyxjQUFhO0FBQUEsRUFJaEQsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLGlCQUFjO0FBR3ZDLFNBQU8sV0FBVyxDQUFDLGdCQUFpQztBQUVoRCxZQUFNLGFBQWEsQ0FBQyxRQUErQjtBQUMvQyxZQUFJO0FBQ0EsaUJBQVEsSUFBSSxTQUFTLE1BQU0sV0FBVyxVQUFVLEtBQUssTUFBTSxRQUFRLGVBQWUsRUFBRyxLQUFLLElBQUksS0FBSywyQ0FBYSxJQUFJLENBQUM7QUFBQSxRQUN6SCxTQUFTLE9BQVA7QUFDRSxjQUFJLHlCQUFPLDBCQUEwQixLQUFLLE1BQU07QUFBQSxzQkFBOEIsR0FBSTtBQUFBLFFBQ3RGO0FBQUEsTUFDSjtBQUNBLFlBQU0sV0FBVyxLQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVE7QUFFakQsVUFBSSxLQUFLLE1BQU0sUUFBUSxpQkFBaUIsc0NBQVUsU0FBUyxxQkFBb0Isc0NBQVUsU0FBUyx5QkFBd0I7QUFDdEgsWUFBSTtBQUNBLGdCQUFNLFlBQVksV0FBVyxTQUFTLEdBQUcsRUFBRSxPQUFPLElBQUksQ0FBQyxNQUFXLEVBQUUsS0FBSyxJQUFJO0FBQzdFLGlCQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0saUJBQWlCLEVBQUUsT0FBTyxPQUFLLFVBQVUsU0FBUyxFQUFFLElBQUksQ0FBQztBQUFBLFFBQzFGLFNBQVMsT0FBUDtBQUNFLGdCQUFPO0FBQUEsUUFDWDtBQUFBLE1BQ0osT0FBTztBQUNILGVBQU8sS0FBSyxPQUFPLElBQUksTUFBTSxpQkFBaUI7QUFBQSxNQUNsRDtBQUFBLElBQ0o7QUFBQSxFQXZCQTtBQUFBLEVBeUJBLEFBQU8sZUFBZSxNQUFjLE9BQWUsTUFBYSxVQUFnRTtBQUM1SCxVQUFNLFFBQVEsSUFBSSxtQkFBZ0IsS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLEtBQUs7QUFDdEUsVUFBTSxRQUFRLFFBQVEsY0FBYztBQUNwQyxVQUFNLFNBQVMsTUFBTSxNQUFNLEtBQUs7QUFDaEMsUUFBSSxVQUFVLE9BQU8sUUFBUSxHQUFHO0FBQzVCLGVBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsYUFBSyxTQUFTLFVBQVUsTUFBTTtBQUM5QixhQUFLLFFBQVEsVUFBVSxrQkFBZTtBQUN0QyxhQUFLLFFBQVEsTUFBTTtBQUNuQixhQUFLLFdBQVcsc0JBQXNCO0FBQUEsTUFDMUMsQ0FBQztBQUFBLElBQ0wsV0FBVyxVQUFVLFVBQVUsUUFBUSxHQUFHO0FBQ3RDLGVBQVMsUUFBUSxLQUFLO0FBQUEsUUFDbEIsSUFBSSxVQUFVO0FBQUEsUUFDZCxhQUFhLG1CQUFtQjtBQUFBLFFBQ2hDO0FBQUEsUUFDQSxNQUFNLFVBQVU7QUFBQSxNQUNwQixDQUFDO0FBQUEsSUFDTCxXQUFXLFVBQVUsZUFBZSxRQUFRLEdBQUc7QUFDM0MsZUFBUyxVQUFVLFVBQVUsb0JBQWlCLFFBQVEsVUFBVSxjQUFjO0FBQUEsSUFDbEY7QUFBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQU8sd0JBQ0gsTUFDQSxtQkFDQSxPQUNBLFlBQ0EsT0FDQSxRQUNBLFdBQ0k7QUFDSixVQUFNLGFBQWEsSUFBSSxtQkFBZ0IsS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLE9BQU8sWUFBWSxPQUFPLFFBQVEsU0FBUztBQUNqSCxlQUFXLFFBQVEsUUFBUSxtQkFBbUIsbUJBQW1CO0FBQ2pFLGVBQVcsS0FBSztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxBQUFPLGFBQWEsV0FBMkIsTUFBYSxXQUFtQixXQUEyQjtBQTlFOUc7QUErRVEsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsUUFBSSxPQUFPO0FBQ1AsWUFBTSxRQUFRLE1BQU0sS0FBSyxLQUFLLElBQUksRUFBRTtBQUNwQyxVQUFJLE1BQU0sTUFBTSxPQUFPLEtBQUssR0FBRztBQUMzQixjQUFNLE9BQU8sVUFBVSxTQUFTLEtBQUssRUFBRSxNQUFNLE1BQU0sS0FBSyxNQUFNLEdBQUcsRUFBRSxLQUFLLEVBQUUsUUFBUSxXQUFXLElBQUksRUFBRSxDQUFDO0FBQ3BHLGFBQUssVUFBVSxNQUFNO0FBQ2pCLGVBQUssT0FBTyxJQUFJLFVBQVUsYUFBYSxNQUFNLE1BQU0sS0FBSyxNQUFNLElBQUk7QUFDbEUsb0JBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSixPQUFPO0FBQ0gsa0JBQVUsVUFBVSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQUEsTUFDdkM7QUFBQSxJQUNKO0FBQ0EsY0FBVSxVQUFVO0FBQUEsRUFDeEI7QUFBQSxFQUVBLEFBQU8sY0FDSCxJQUNBLEdBQ0EsZ0JBQ0EsUUFBMkYsQ0FBQyxHQUN4RjtBQXBHWjtBQXFHUSxVQUFNLE1BQU07QUFDWixtQkFBZSxZQUFZLEdBQUcsR0FBRyxRQUFRLEVBQUUsS0FBSyxNQUFNLE9BQU8sS0FBSyxDQUFDO0FBRW5FLFVBQU0sWUFBWSxlQUFlLFNBQVMsUUFBUTtBQUNsRCxtQ0FBUSxXQUFXLFVBQVUsa0JBQWU7QUFDNUMsVUFBTSxTQUFTLGVBQWUsU0FBUyxPQUFPLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFFL0QsVUFBTSxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsUUFBUSxPQUFPO0FBQzFFLFFBQUk7QUFDSixRQUFJLGdCQUFnQiwyQkFBUyxLQUFLLGFBQWEsTUFBTTtBQUNqRCxtQkFBYSxJQUFJLG1CQUFnQixLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sRUFBRSxLQUFLLE1BQU0sS0FBSztBQUFBLElBQ3RGLE9BQU87QUFDSCxZQUFNLE1BQU0sMENBQTBDO0FBQUEsSUFDMUQ7QUFDQSxjQUFVLFVBQVUsTUFBTTtBQUN0QixpQkFBVyxLQUFLO0FBQUEsSUFDcEI7QUFFQSxRQUFJLENBQUMsc0NBQU8sWUFBUCxtQkFBZ0IsYUFBWSxNQUFNO0FBQ25DLGdCQUFVLEtBQUs7QUFDZixhQUFPLEtBQUs7QUFDWixxQkFBZSxjQUFjLE1BQU07QUFDL0Isa0JBQVUsS0FBSztBQUNmLGVBQU8sS0FBSztBQUFBLE1BQ2hCO0FBQ0EscUJBQWUsYUFBYSxNQUFNO0FBQzlCLGtCQUFVLEtBQUs7QUFDZixlQUFPLEtBQUs7QUFBQSxNQUNoQjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFRLG9CQUFvQixXQUFpQztBQUN6RCxVQUFNLDRCQUE0QixVQUFVLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUN6RSw4QkFBMEIsU0FBUyxRQUFRLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNoRixVQUFNLHlCQUF5QiwwQkFBMEIsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDN0YsU0FBSyxnQkFBZ0IsSUFBSSxvQ0FBa0Isc0JBQXNCO0FBQ2pFLFNBQUssY0FBYyxRQUFRLE9BQU87QUFDbEMsU0FBSyxjQUFjLFFBQVEsT0FBTztBQUNsQyxTQUFLLGNBQWMsU0FBUyxLQUFLLE1BQU0sUUFBUSxpQkFBaUIsRUFBRTtBQUNsRSxTQUFLLGNBQWMsUUFBUSxTQUFTLFlBQVk7QUFDaEQsU0FBSyxjQUFjLFNBQVMsV0FBUztBQUNqQyxXQUFLLE1BQU0sUUFBUSxnQkFBZ0I7QUFDbkMseUJBQW1CLHNCQUFzQixLQUFLLGFBQWE7QUFBQSxJQUMvRCxDQUFDO0FBR0QsVUFBTSwrQkFBK0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDNUUsaUNBQTZCLFNBQVMsUUFBUSxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBQy9ELGlDQUE2QixTQUFTLFFBQVEsRUFBRSxNQUFNLG9IQUFvSCxLQUFLLFdBQVcsQ0FBQztBQUMzTCxpQ0FBNkIsU0FBUyxRQUFRO0FBQUEsTUFDMUMsTUFBTTtBQUFBLElBQ1YsQ0FBQztBQUNELFVBQU0sNEJBQTRCLDZCQUE2QixVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNuRyxVQUFNLGtCQUFrQixJQUFJLG9DQUFrQix5QkFBeUI7QUFDdkUsb0JBQWdCLFFBQVEsT0FBTztBQUMvQixvQkFBZ0IsUUFBUSxPQUFPO0FBQy9CLG9CQUFnQixRQUFRLFNBQVMsWUFBWTtBQUM3QyxvQkFBZ0IsU0FBUyxLQUFLLE1BQU0sUUFBUSxtQkFBbUIsRUFBRTtBQUNqRSxvQkFBZ0IsZUFBZSw4SkFFeUQ7QUFDeEYsb0JBQWdCLFNBQVMsV0FBUztBQUM5QixXQUFLLE1BQU0sUUFBUSxrQkFBa0I7QUFDckMseUJBQW1CLHNCQUFzQixlQUFlO0FBQUEsSUFDNUQsQ0FBQztBQUVELFVBQU0sNEJBQTRCLFVBQVUsVUFBVSxFQUFFLEtBQUssV0FBVyxDQUFDO0FBQ3pFLDhCQUEwQixTQUFTLFFBQVEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3BFLDhCQUEwQixTQUFTLFFBQVEsRUFBRSxNQUFNLGlIQUFpSCxLQUFLLFdBQVcsQ0FBQztBQUNyTCw4QkFBMEIsU0FBUyxRQUFRO0FBQUEsTUFDdkMsTUFBTTtBQUFBLElBQ1YsQ0FBQztBQUNELFVBQU0seUJBQXlCLDBCQUEwQixVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUM3RixVQUFNLGdCQUFnQixJQUFJLG9DQUFrQixzQkFBc0I7QUFDbEUsa0JBQWMsUUFBUSxPQUFPO0FBQzdCLGtCQUFjLFFBQVEsT0FBTztBQUM3QixrQkFBYyxRQUFRLFNBQVMsWUFBWTtBQUMzQyxrQkFBYyxTQUFTLEtBQUssTUFBTSxRQUFRLGlCQUFpQixFQUFFO0FBQzdELGtCQUFjLGVBQWUsZ01BRzhDO0FBQzNFLGtCQUFjLFNBQVMsV0FBUztBQUM1QixXQUFLLE1BQU0sUUFBUSxnQkFBZ0I7QUFDbkMseUJBQW1CLHNCQUFzQixhQUFhO0FBQUEsSUFDMUQsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQU8sdUJBQXVCLGlCQUFpQyxRQUFzQixVQUFrQztBQUNuSCxTQUFLLG9CQUFvQixlQUFlO0FBQUEsRUFDNUM7QUFBQSxFQUVBLEFBQU8sZ0JBQXdCO0FBQzNCLFdBQU8sS0FBSyxNQUFNLFFBQVEsaUJBQWlCO0FBQUEsRUFDL0M7QUFBQSxFQUVBLEFBQU8sa0JBQTJCO0FBQzlCLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFPLGNBQWMsT0FBcUI7QUFFdEMsV0FBTztBQUFBLEVBQ1g7QUFDSjs7O0FEck1BLElBQXFCLG9CQUFyQixjQUErQywrQkFBcUI7QUFBQSxFQU1oRSxZQUNZLFFBQ0EsTUFDQSxPQUNSLGdCQUNRLGFBQXFCLElBQ3JCLFFBQWlCLE9BQ2pCLFNBQWtCLE9BQ2xCLFlBQXFCLE9BQy9CO0FBeEJOO0FBeUJRLFVBQU0sT0FBTyxHQUFHO0FBVFI7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHUixRQUFJLGdCQUFnQjtBQUNoQixVQUFJLE1BQU0sUUFBUSxjQUFjLEdBQUc7QUFDL0IsY0FBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsWUFBSSxTQUFTLGVBQWUsS0FBSyxPQUFLLE1BQU0sTUFBTSxPQUFPLENBQUMsQ0FBQyxHQUFHO0FBQzFELGVBQUssa0JBQWtCLGVBQWUsSUFBSSxVQUFRO0FBQzlDLGdCQUFJLE1BQU0sTUFBTSxPQUFPLElBQUksR0FBRztBQUMxQixxQkFBTyxVQUFVLGtCQUFrQixLQUFLLFFBQVEsS0FBSyxNQUFNLEtBQUssSUFBSTtBQUFBLFlBQ3hFLE9BQU87QUFDSCxxQkFBTyxLQUFLLFNBQVM7QUFBQSxZQUN6QjtBQUFBLFVBQ0osQ0FBQztBQUFBLFFBQ0w7QUFDQSxhQUFLLGtCQUFrQixlQUFlLElBQUksVUFBUSxLQUFLLFNBQVMsQ0FBQztBQUFBLE1BQ3JFLFdBQ1MsT0FBUSxtQkFBb0IsWUFBWSxlQUFlLFNBQVMsRUFBRSxXQUFXLElBQUksR0FBRztBQUN6RixhQUFLLGtCQUFrQixlQUFlLE1BQU0sR0FBRyxFQUFFLElBQUksVUFBUSxLQUFLLEtBQUssQ0FBQztBQUFBLE1BQzVFLE9BQU87QUFDSCxZQUFJLE9BQU8sS0FBSyxjQUFjLEVBQUUsU0FBUyxNQUFNLEdBQUc7QUFDOUMsZUFBSyxrQkFBa0IsQ0FBQyxLQUFLLGVBQWUsS0FBSyxRQUFRLE9BQU8sRUFBRSxLQUFLO0FBQUEsUUFDM0UsV0FBVyxPQUFRLG1CQUFvQixVQUFVO0FBQzdDLGVBQUssa0JBQWtCLGVBQWUsU0FBUyxFQUFFLFFBQVEsY0FBYyxJQUFJLEVBQUUsTUFBTSxHQUFHLEVBQUUsSUFBSSxVQUFRLEtBQUssS0FBSyxDQUFDO0FBQUEsUUFDbkg7QUFBQSxNQUNKO0FBQUEsSUFDSixPQUFPO0FBQ0gsV0FBSyxrQkFBa0IsQ0FBQztBQUFBLElBQzVCO0FBQ0EsU0FBSyxZQUFZLFNBQVMsZUFBZTtBQUFBLEVBQzdDO0FBQUEsRUFFQSxBQUFNLFNBQVM7QUFBQTtBQUNYLG9EQUFNLGVBQU4sSUFBYTtBQUNiLFdBQUssWUFBWSxZQUFZLENBQU8sTUFBTTtBQUN0QyxZQUFJLEVBQUUsT0FBTyxXQUFXLEVBQUUsUUFBUTtBQUM5QixnQkFBTSxLQUFLLGNBQWM7QUFDekIsZUFBSyxNQUFNO0FBQUEsUUFDZjtBQUFBLE1BQ0o7QUFHQSxZQUFNLDhCQUE4QixLQUFLLFlBQVksVUFBVSxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFDMUYsWUFBTSxTQUFTLDRCQUE0QixVQUFVLEVBQUUsS0FBSyxRQUFRLENBQUM7QUFDckUsa0NBQTRCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUN2RCxrQ0FBNEIsS0FBSztBQUNqQyxXQUFLLFlBQVksS0FBSyxTQUFTLEVBQUUsUUFBUSwyQkFBMkI7QUFFcEUsWUFBTSxpQkFBaUIsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzVFLHFCQUFlLFlBQVksS0FBSyxPQUFPO0FBQ3ZDLFdBQUssWUFBWSxLQUFLLFNBQVMsRUFBRSxRQUFRLGNBQWM7QUFHdkQsWUFBTSxrQkFBa0IsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQzVFLHNCQUFnQixVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDM0MsWUFBTSxnQkFBZ0IsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLE9BQU8sQ0FBQztBQUMvRCxvQkFBYyxRQUFRLG1CQUFtQjtBQUV6QyxXQUFLLFlBQVksSUFBSSxrQ0FBZ0IsY0FBYztBQUNuRCxXQUFLLFVBQVUsUUFBUSxNQUFNO0FBQzdCLFdBQUssVUFBVSxRQUFRLE1BQVk7QUFDL0IsY0FBTSxLQUFLLHNCQUFzQjtBQUNqQyxlQUFPLFFBQVEsR0FBRyxLQUFLLFFBQVE7QUFBQSxnQkFBb0Q7QUFDbkYsYUFBSyxVQUFVLFNBQVMsS0FBSztBQUM3QixvQ0FBNEIsS0FBSztBQUFBLE1BQ3JDLEVBQUM7QUFDRCxXQUFLLFVBQVUsT0FBTztBQUN0QixXQUFLLFVBQVUsV0FBVyx1Q0FBdUM7QUFDakUsV0FBSyxVQUFVLFNBQVMsS0FBSztBQUU3QixXQUFLLGVBQWUsSUFBSSxrQ0FBZ0IsMkJBQTJCO0FBQ25FLFdBQUssYUFBYSxRQUFRLFlBQVk7QUFDdEMsV0FBSyxhQUFhLE9BQU87QUFDekIsV0FBSyxhQUFhLFFBQVEsTUFBWTtBQUNsQyxhQUFLLFFBQVEsUUFBUTtBQUVyQixhQUFLLGtCQUFrQjtBQUN2QixvQ0FBNEIsS0FBSztBQUNqQyxhQUFLLFVBQVUsU0FBUyxLQUFLO0FBQUEsTUFDakMsRUFBQztBQUVELFlBQU0sZ0JBQWdCLElBQUksa0NBQWdCLGVBQWU7QUFDekQsb0JBQWMsUUFBUSxXQUFXO0FBQ2pDLG9CQUFjLFFBQVEsTUFBWTtBQUM5QixjQUFNLEtBQUssY0FBYztBQUN6QixhQUFLLE1BQU07QUFBQSxNQUNmLEVBQUM7QUFFRCxZQUFNLGVBQWUsSUFBSSxrQ0FBZ0IsZUFBZTtBQUN4RCxtQkFBYSxRQUFRLE9BQU87QUFDNUIsbUJBQWEsUUFBUSxNQUFNO0FBQUUsYUFBSyxNQUFNO0FBQUEsTUFBRyxDQUFDO0FBRTVDLFlBQU0sY0FBYyxJQUFJLGtDQUFnQixlQUFlO0FBQ3ZELGtCQUFZLFFBQVEsT0FBTztBQUMzQixrQkFBWSxRQUFRLE1BQVk7QUFDNUIsY0FBTSxLQUFLLFlBQVk7QUFDdkIsYUFBSyxNQUFNO0FBQUEsTUFDZixFQUFDO0FBQ0Qsa0JBQVksU0FBUyxTQUFTLFFBQVE7QUFDdEMsV0FBSyxRQUFRLFlBQVksZUFBZTtBQUFBLElBQzVDO0FBQUE7QUFBQSxFQUVBLEFBQU0sd0JBQXVDO0FBQUE7QUE3SGpEO0FBOEhRLFlBQU0sV0FBVyxLQUFLLFFBQVE7QUFDOUIsWUFBTSxnQkFBZ0IsaUJBQUssT0FBTyxXQUFXLFlBQVksSUFBSSxLQUFLLEtBQUssSUFBSSxNQUFyRCxtQkFBd0QsS0FBSyxXQUFTLE1BQU0sU0FBUyxLQUFLLE1BQU0sVUFBaEcsbUJBQXVHO0FBQzdILFVBQUksZUFBZTtBQUNmLGNBQU0sWUFBWSxLQUFLLE9BQU8sV0FBVyxnQkFBZ0IsSUFBSSxhQUFhO0FBQzFFLGNBQU0scUJBQXFCLHVDQUFXLFdBQVcsS0FBSyxVQUFRLEtBQUssU0FBUyxLQUFLLE1BQU07QUFDdkYsWUFBSSxhQUFhLG9CQUFvQjtBQUVqQyxjQUFJO0FBQ0osY0FBSSxNQUFNLFFBQVEsbUJBQW1CLE9BQU8sR0FBRztBQUMzQyx5QkFBYSxDQUFDLEdBQUcsbUJBQW1CLFNBQVMsUUFBUTtBQUNyRCxrQkFBTSxVQUFVLGdCQUFnQixtQkFBbUIsTUFBTSxtQkFBbUIsTUFBTSxZQUFZLGtCQUFrQjtBQUFBLFVBQ3BILFdBQVcsbUJBQW1CLFFBQVEsZUFBZSwrQkFBb0M7QUFDckYseUJBQWEsbUJBQW1CLFFBQVE7QUFDeEMsdUJBQVcsR0FBRyxPQUFPLEtBQUssbUJBQW1CLFFBQVEsVUFBVSxFQUFFLFlBQVk7QUFDN0Usa0JBQU0sVUFBVSxnQkFBZ0IsbUJBQW1CLE1BQU0sbUJBQW1CLE1BQU0sWUFBWSxrQkFBa0I7QUFBQSxVQUNwSCxXQUFXLG1CQUFtQixRQUFRLGVBQWUsK0NBQTRDO0FBQzdGLGtCQUFNLGFBQWEsS0FBSyxPQUFPLElBQUksTUFBTSxzQkFBc0IsbUJBQW1CLFFBQVEsa0JBQWtCO0FBQzVHLGdCQUFJLHNCQUFzQiwyQkFBUyxXQUFXLGFBQWEsTUFBTTtBQUM3RCxvQkFBTSxTQUFTLE1BQU0sS0FBSyxPQUFPLElBQUksTUFBTSxLQUFLLFVBQVU7QUFDMUQsbUJBQUssT0FBTyxJQUFJLE1BQU0sT0FBTyxZQUFZLEdBQUc7QUFBQSxFQUFXLFVBQVU7QUFBQSxZQUNyRTtBQUFBLFVBQ0osT0FBTztBQUNILHlCQUFhLG1CQUFtQjtBQUNoQyx1QkFBVyxHQUFHLE9BQU8sS0FBSyxtQkFBbUIsT0FBTyxFQUFFLFNBQVMsT0FBTztBQUN0RSxrQkFBTSxVQUFVLGdCQUFnQixtQkFBbUIsTUFBTSxtQkFBbUIsTUFBTSxZQUFZLGtCQUFrQjtBQUFBLFVBQ3BIO0FBQUEsUUFDSjtBQUFBLE1BQ0osT0FBTztBQUNILGNBQU0sY0FBYyxLQUFLLE9BQU8sU0FBUyxhQUFhLEtBQUssV0FBUyxNQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDbEcsWUFBSSw0Q0FBYSxRQUFRLGdCQUFlLCtDQUE0QztBQUNoRixnQkFBTSxhQUFhLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLFlBQVksUUFBUSxrQkFBa0I7QUFDckcsY0FBSSxzQkFBc0IsMkJBQVMsV0FBVyxhQUFhLE1BQU07QUFDN0Qsa0JBQU0sU0FBUyxNQUFNLEtBQUssT0FBTyxJQUFJLE1BQU0sS0FBSyxVQUFVO0FBQzFELGlCQUFLLE9BQU8sSUFBSSxNQUFNLE9BQU8sWUFBWSxHQUFHO0FBQUEsRUFBVyxVQUFVO0FBQUEsVUFDckU7QUFBQSxRQUNKLFdBQVcsNENBQWEsUUFBUSxnQkFBZSwrQkFBb0M7QUFDL0UsZ0JBQU0sdUJBQXVCLEtBQUssT0FBTyxrQkFBa0IsS0FBSyxPQUFLLEVBQUUsTUFBTSxLQUFLLE1BQU0sRUFBRTtBQUMxRixjQUFJLHNCQUFzQjtBQUN0QixrQkFBTSxhQUFhLHFCQUFxQixRQUFRO0FBQ2hELHVCQUFXLEdBQUcsT0FBTyxLQUFLLFVBQVUsRUFBRSxTQUFTLE9BQU87QUFBQSxVQUMxRDtBQUNBLGVBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0I7QUFBQSxNQUNKO0FBQ0EsWUFBTSxLQUFLLE9BQU8sV0FBVyxVQUFVLFVBQVU7QUFDakQsV0FBSyxnQkFBZ0IsS0FBSyxRQUFRO0FBQUEsSUFDdEM7QUFBQTtBQUFBLEVBRUEsQUFBTSxnQkFBZ0I7QUFBQTtBQUNsQixZQUFNLFdBQVUsS0FBSztBQUNyQixZQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLFNBQVEsS0FBSyxJQUFJLEVBQUUsRUFBRSxDQUFDLEdBQUcsS0FBSyxNQUFNLEtBQUssWUFBWSxLQUFLLE9BQU8sS0FBSyxRQUFRLEtBQUssU0FBUztBQUN0SyxXQUFLLE1BQU07QUFBQSxJQUNmO0FBQUE7QUFBQSxFQUVBLEFBQU0sY0FBYztBQUFBO0FBQ2hCLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxNQUFNLE1BQU0sU0FBUyxFQUFFLE9BQU8sR0FBRyxFQUFFLENBQUMsR0FBRyxLQUFLLE1BQU0sS0FBSyxZQUFZLEtBQUssT0FBTyxLQUFLLFFBQVEsS0FBSyxTQUFTO0FBQUEsSUFDMUo7QUFBQTtBQUFBLEVBRUEsaUJBQWlCO0FBRWIsVUFBTSxVQUFVLEtBQUs7QUFDckIsVUFBTSxjQUFnQyxRQUFRO0FBQzlDLFVBQU0sU0FBbUIsUUFBUTtBQUNqQyxnQkFBWSxRQUFRLENBQUMsR0FBRyxNQUFNO0FBQzFCLFVBQUksS0FBSyxnQkFBZ0IsU0FBUyxPQUFPLEdBQUcsU0FBUyxDQUFDLEdBQUc7QUFDckQsVUFBRSxTQUFTLGVBQWU7QUFDMUIsWUFBSSxFQUFFLGlCQUFpQixpQkFBaUIsRUFBRSxVQUFVLEdBQUc7QUFDbkQsZ0JBQU0sZ0JBQWdCLEVBQUUsVUFBVSxFQUFFLEtBQUssaUJBQWlCLENBQUM7QUFDM0QseUNBQVEsZUFBZSxjQUFjO0FBQUEsUUFDekM7QUFBQSxNQUNKLE9BQU87QUFDSCxVQUFFLFlBQVksZUFBZTtBQUM3QixVQUFFLGlCQUFpQixpQkFBaUIsRUFBRSxRQUFRLFVBQVEsS0FBSyxPQUFPLENBQUM7QUFBQSxNQUN2RTtBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLGVBQWUsT0FBeUI7QUEzTTVDO0FBNE1RLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFFBQUk7QUFDSixRQUFJO0FBQU8sZUFBUyxNQUFNLEtBQUssS0FBSyxLQUFLLElBQUk7QUFDN0MsVUFBTSxlQUFlLElBQUksYUFBYSxLQUFLLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSyxLQUFLO0FBQzlFLFVBQU0sU0FBUyxhQUFhLGVBQWUsTUFBTSxFQUFFLE9BQU8sT0FBSyxFQUFFLFlBQVksRUFBRSxTQUFTLE1BQU0sWUFBWSxDQUFDLENBQUM7QUFDNUcsUUFBSSxLQUFLLFdBQVc7QUFDaEIsTUFBQyxPQUFPLEtBQUssT0FBSyxNQUFNLEtBQUssS0FBSyxLQUFLLE1BQU0sUUFBUSxjQUFjLCtDQUE2QyxDQUFDLFFBQzdHLEtBQUssVUFBVSxTQUFTLEtBQUssSUFDN0IsS0FBSyxVQUFVLFNBQVMsS0FBSztBQUFBLElBQ3JDO0FBQUM7QUFDRCxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsaUJBQWlCLE9BQWUsSUFBaUI7QUFDN0MsT0FBRyxRQUFRLEtBQUs7QUFDaEIsT0FBRyxTQUFTLGlCQUFpQjtBQUM3QixVQUFNLFNBQVMsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUMzRCxPQUFHLFlBQVksTUFBTTtBQUNyQixRQUFJLEtBQUssZ0JBQWdCLFNBQVMsTUFBTSxTQUFTLENBQUMsR0FBRztBQUNqRCxTQUFHLFNBQVMsZUFBZTtBQUMzQixZQUFNLGdCQUFnQixHQUFHLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQzVELHFDQUFRLGVBQWUsY0FBYztBQUFBLElBQ3pDO0FBQ0EsU0FBSyxRQUFRLE1BQU07QUFBQSxFQUN2QjtBQUFBLEVBRUEsaUJBQWlCLE9BQWUsS0FBdUM7QUFDbkUsUUFBSSxLQUFLLGdCQUFnQixTQUFTLE1BQU0sU0FBUyxDQUFDLEdBQUc7QUFDakQsV0FBSyxnQkFBZ0IsT0FBTyxNQUFNLFNBQVMsQ0FBQztBQUFBLElBQ2hELE9BQU87QUFDSCxXQUFLLGdCQUFnQixLQUFLLE1BQU0sU0FBUyxDQUFDO0FBQUEsSUFDOUM7QUFDQSxTQUFLLGVBQWU7QUFBQSxFQUN4QjtBQUFBLEVBRUEsbUJBQW1CLE1BQWMsS0FBaUM7QUFBQSxFQUVsRTtBQUVKOzs7QUQxT0EsSUFBcUIsYUFBckIsY0FBd0MsdUJBQXVCO0FBQUEsRUFJM0QsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLG1CQUFlO0FBSHhDLGtDQUErQyxDQUFDO0FBQUEsRUFJaEQ7QUFBQSxFQUVBLEFBQU8sZUFBZSxNQUFjLE9BQWUsTUFBYSxVQUFnRTtBQUM1SCxVQUFNLFFBQVEsSUFBSSxrQkFBaUIsS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLEtBQUs7QUFDdkUsVUFBTSxRQUFRLFFBQVEsZUFBZTtBQUNyQyxVQUFNLFNBQVMsTUFBTSxNQUFNLEtBQUs7QUFDaEMsUUFBSSxXQUFXLE9BQU8sUUFBUSxHQUFHO0FBQzdCLGVBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsYUFBSyxTQUFTLFdBQVcsT0FBTztBQUNoQyxhQUFLLFFBQVEsVUFBVSxvQkFBZ0I7QUFDdkMsYUFBSyxRQUFRLE1BQU07QUFDbkIsYUFBSyxXQUFXLHNCQUFzQjtBQUFBLE1BQzFDLENBQUM7QUFBQSxJQUNMLFdBQVcsV0FBVyxVQUFVLFFBQVEsR0FBRztBQUN2QyxlQUFTLFFBQVEsS0FBSztBQUFBLFFBQ2xCLElBQUksVUFBVTtBQUFBLFFBQ2QsYUFBYSxtQkFBbUI7QUFBQSxRQUNoQztBQUFBLFFBQ0EsTUFBTSxVQUFVO0FBQUEsTUFDcEIsQ0FBQztBQUFBLElBQ0wsV0FBVyxXQUFXLGVBQWUsUUFBUSxHQUFHO0FBQzVDLGVBQVMsVUFBVSxVQUFVLHNCQUFrQixRQUFRLFVBQVUsY0FBYztBQUFBLElBQ25GO0FBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFPLHdCQUNILE1BQ0EsbUJBQ0EsT0FDQSxZQUNBLE9BQ0EsUUFDQSxXQUNJO0FBQ0osVUFBTSxhQUFhLElBQUksa0JBQWlCLEtBQUssUUFBUSxNQUFNLEtBQUssT0FBTyxTQUFTLElBQUksWUFBWSxPQUFPLFFBQVEsU0FBUztBQUN4SCxlQUFXLFFBQVEsUUFBUSxzQkFBc0IsbUJBQW1CO0FBQ3BFLGVBQVcsS0FBSztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxBQUFPLGNBQ0gsSUFDQSxHQUNBLGdCQUNBLFFBQTJGLENBQUMsR0FDeEY7QUEzRFo7QUE2RFEsUUFBSSxlQUFlO0FBQ25CLFFBQUksZ0JBQTBCLENBQUM7QUFDL0IsUUFBSSxFQUFFLEtBQUssTUFBTSxPQUFPO0FBQ3BCLFVBQUksT0FBTyxLQUFLLEVBQUUsS0FBSyxNQUFNLEtBQUssRUFBRSxTQUFTLE1BQU0sR0FBRztBQUNsRCx3QkFBZ0IsQ0FBQyxLQUFLLEVBQUUsS0FBSyxNQUFNLE1BQU0sS0FBSyxRQUFRLE9BQU8sRUFBRSxLQUFLO0FBQUEsTUFDeEUsV0FBVyxNQUFNLFFBQVEsRUFBRSxLQUFLLE1BQU0sS0FBSyxHQUFHO0FBQzFDLFVBQUUsS0FBSyxNQUFNLE1BQU0sUUFBUSxDQUFDLFNBQWM7QUFDdEMsY0FBSSxPQUFPLEtBQUssSUFBSSxFQUFFLFNBQVMsTUFBTSxHQUFHO0FBQ3BDLDBCQUFjLEtBQUssS0FBSyxLQUFLLEtBQUssUUFBUSxPQUFPLEVBQUUsS0FBSztBQUFBLFVBQzVELE9BQU87QUFDSCwwQkFBYyxLQUFLLEtBQUssS0FBSyxDQUFDO0FBQUEsVUFDbEM7QUFBQSxRQUNKLENBQUM7QUFBQSxNQUNMLE9BQU87QUFDSCx3QkFBZ0IsU0FBRSxLQUFLLE1BQU0sVUFBYixtQkFBb0IsTUFBTSxLQUFLLElBQUksQ0FBQyxNQUFjLEVBQUUsS0FBSyxPQUFNLENBQUM7QUFBQSxNQUNwRjtBQUFBLElBQ0o7QUFFQSxVQUFNLE9BQU8sS0FBSyxPQUFPLElBQUksTUFBTSxzQkFBc0IsRUFBRSxRQUFRLE9BQU87QUFDMUUsUUFBSTtBQUNKLFFBQUksZ0JBQWdCLDJCQUFTLEtBQUssYUFBYSxNQUFNO0FBQ2pELG1CQUFhLElBQUksa0JBQWlCLEtBQUssUUFBUSxNQUFNLEtBQUssT0FBTyxFQUFFLEtBQUssTUFBTSxLQUFLO0FBQUEsSUFDdkYsT0FBTztBQUNILFlBQU0sTUFBTSwwQ0FBMEM7QUFBQSxJQUMxRDtBQUdBLFVBQU0sa0JBQWtCLGVBQWUsVUFBVSxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFHNUUsa0JBQWMsUUFBUSxPQUFLO0FBQ3ZCLFlBQU0saUJBQWlCLGdCQUFnQixVQUFVLEVBQUUsS0FBSyxpQkFBaUIsQ0FBQztBQUMxRSxZQUFNLGlCQUFpQixlQUFlLFNBQVMsUUFBUTtBQUN2RCxZQUFNLGFBQWEsZUFBZSxVQUFVLEVBQUUsS0FBSyxTQUFTLE1BQU0sRUFBRSxDQUFDO0FBQ3JFLHFDQUFRLGdCQUFnQixPQUFPO0FBQy9CLHFCQUFlLEtBQUs7QUFDcEIscUJBQWUsVUFBVSxNQUFZO0FBQ2pDLGNBQU0sa0JBQWtCLGNBQWMsT0FBTyxRQUFNLE9BQU8sQ0FBQyxFQUFFLEtBQUssSUFBSTtBQUN0RSxtQkFBVyxjQUFjLEtBQUssUUFBUSxFQUFFLEtBQUssTUFBTSxLQUFLLE1BQU0sTUFBTSxlQUFlO0FBQUEsTUFDdkY7QUFFQSxxQkFBZSxjQUFjLE1BQU07QUFDL0IsdUJBQWU7QUFDZixxQkFBYSxLQUFLO0FBQ2xCLHFCQUFhLEtBQUs7QUFDbEIsdUJBQWUsS0FBSztBQUNwQixtQkFBVyxTQUFTLFNBQVM7QUFBQSxNQUNqQztBQUNBLHFCQUFlLGFBQWEsTUFBTTtBQUM5Qix1QkFBZTtBQUNmLHVCQUFlLEtBQUs7QUFDcEIscUJBQWEsS0FBSztBQUNsQixxQkFBYSxLQUFLO0FBQ2xCLG1CQUFXLFlBQVksU0FBUztBQUFBLE1BQ3BDO0FBQUEsSUFFSixDQUFDO0FBR0QsVUFBTSxTQUFTLGdCQUFnQixTQUFTLFFBQVE7QUFDaEQsbUNBQVEsUUFBUSxXQUFXO0FBRTNCLFdBQU8sVUFBVSxNQUFNLFdBQVcsS0FBSztBQUd2QyxVQUFNLGVBQWUsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUNsRSxVQUFNLGVBQWUsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUVsRSxRQUFJLENBQUMsc0NBQU8sWUFBUCxtQkFBZ0IsV0FBVTtBQUMzQixhQUFPLEtBQUs7QUFDWixxQkFBZSxjQUFjLE1BQU07QUFDL0IsZUFBTyxLQUFLO0FBQ1oscUJBQWEsS0FBSztBQUNsQixZQUFJLENBQUM7QUFBYyx1QkFBYSxLQUFLO0FBQUEsTUFDekM7QUFDQSxxQkFBZSxhQUFhLE1BQU07QUFDOUIsZUFBTyxLQUFLO0FBQ1oscUJBQWEsS0FBSztBQUNsQixxQkFBYSxLQUFLO0FBQUEsTUFDdEI7QUFBQSxJQUNKO0FBR0EsUUFBSSxDQUFDLHNDQUFPLFlBQVAsbUJBQWdCLFdBQVU7QUFDM0IsbUJBQWEsS0FBSztBQUNsQixtQkFBYSxLQUFLO0FBQ2xCLGFBQU8sS0FBSztBQUFBLElBQ2hCLE9BQU87QUFDSCxtQkFBYSxLQUFLO0FBQ2xCLG1CQUFhLEtBQUs7QUFDbEIsYUFBTyxLQUFLO0FBQUEsSUFDaEI7QUFBQSxFQUNKO0FBQ0o7OztBSXpKQSx3QkFBNkU7OztBQ0Q3RSx3QkFBc0Q7QUFHdEQsd0JBQXVCOzs7QUNIaEIsSUFBSSxRQUFRO0FBQUEsRUFDZjtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQ0o7QUFDTyxJQUFJLFdBQVc7QUFBQSxFQUNsQixVQUFVLENBQUM7QUFBQSxFQUNYLFlBQVk7QUFBQSxFQUNaLHFCQUFxQjtBQUFBLEVBQ3JCLFdBQVc7QUFBQSxFQUNYLFVBQVU7QUFBQSxFQUNWLGVBQWU7QUFBQSxFQUNmLFNBQVMsT0FBTyxXQUFXLFlBQ3ZCLE9BQU8sVUFBVSxVQUFVLFFBQVEsTUFBTSxNQUFNO0FBQUEsRUFDbkQsZ0JBQWdCO0FBQUEsRUFDaEIscUJBQXFCO0FBQUEsRUFDckIsWUFBWTtBQUFBLEVBQ1osZUFBZTtBQUFBLEVBQ2YsYUFBYTtBQUFBLEVBQ2IsWUFBWTtBQUFBLEVBQ1osYUFBYTtBQUFBLEVBQ2IsZUFBZTtBQUFBLEVBQ2YsZ0JBQWdCO0FBQUEsRUFDaEIsU0FBUyxDQUFDO0FBQUEsRUFDVixlQUFlO0FBQUEsRUFDZixlQUFlO0FBQUEsRUFDZixZQUFZO0FBQUEsRUFDWixjQUFjLFNBQVUsS0FBSztBQUN6QixXQUFPLE9BQU8sWUFBWSxlQUFlLFFBQVEsS0FBSyxHQUFHO0FBQUEsRUFDN0Q7QUFBQSxFQUNBLFNBQVMsU0FBVSxXQUFXO0FBQzFCLFFBQUksT0FBTyxJQUFJLEtBQUssVUFBVSxRQUFRLENBQUM7QUFDdkMsU0FBSyxTQUFTLEdBQUcsR0FBRyxHQUFHLENBQUM7QUFDeEIsU0FBSyxRQUFRLEtBQUssUUFBUSxJQUFJLElBQU0sTUFBSyxPQUFPLElBQUksS0FBSyxDQUFFO0FBQzNELFFBQUksUUFBUSxJQUFJLEtBQUssS0FBSyxZQUFZLEdBQUcsR0FBRyxDQUFDO0FBQzdDLFdBQVEsSUFDSixLQUFLLE1BQVEsT0FBSyxRQUFRLElBQUksTUFBTSxRQUFRLEtBQUssUUFDN0MsSUFDRSxPQUFNLE9BQU8sSUFBSSxLQUFLLEtBQ3hCLENBQUM7QUFBQSxFQUNiO0FBQUEsRUFDQSxlQUFlO0FBQUEsRUFDZixzQkFBc0IsQ0FBQztBQUFBLEVBQ3ZCLFFBQVE7QUFBQSxFQUNSLFFBQVE7QUFBQSxFQUNSLGlCQUFpQjtBQUFBLEVBQ2pCLE1BQU07QUFBQSxFQUNOLG1CQUFtQjtBQUFBLEVBQ25CLFdBQVc7QUFBQSxFQUNYLFlBQVk7QUFBQSxFQUNaLEtBQUssSUFBSSxLQUFLO0FBQUEsRUFDZCxVQUFVLENBQUM7QUFBQSxFQUNYLFNBQVMsQ0FBQztBQUFBLEVBQ1YsYUFBYSxDQUFDO0FBQUEsRUFDZCxXQUFXLENBQUM7QUFBQSxFQUNaLFdBQVcsQ0FBQztBQUFBLEVBQ1osZUFBZSxDQUFDO0FBQUEsRUFDaEIsUUFBUSxDQUFDO0FBQUEsRUFDVCxlQUFlLENBQUM7QUFBQSxFQUNoQixTQUFTLENBQUM7QUFBQSxFQUNWLGVBQWUsQ0FBQztBQUFBLEVBQ2hCLGNBQWMsQ0FBQztBQUFBLEVBQ2YsdUJBQXVCLENBQUM7QUFBQSxFQUN4QixTQUFTLENBQUM7QUFBQSxFQUNWLFVBQVU7QUFBQSxFQUNWLGlCQUFpQjtBQUFBLEVBQ2pCLFdBQVc7QUFBQSxFQUNYLHVCQUF1QjtBQUFBLEVBQ3ZCLFlBQVk7QUFBQSxFQUNaLFFBQVE7QUFBQSxFQUNSLFdBQVc7QUFBQSxFQUNYLGFBQWE7QUFBQSxFQUNiLE1BQU07QUFDVjs7O0FDbEZPLElBQUksVUFBVTtBQUFBLEVBQ2pCLFVBQVU7QUFBQSxJQUNOLFdBQVcsQ0FBQyxPQUFPLE9BQU8sT0FBTyxPQUFPLE9BQU8sT0FBTyxLQUFLO0FBQUEsSUFDM0QsVUFBVTtBQUFBLE1BQ047QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBQ0EsUUFBUTtBQUFBLElBQ0osV0FBVztBQUFBLE1BQ1A7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBQ0EsYUFBYSxDQUFDLElBQUksSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksSUFBSSxFQUFFO0FBQUEsRUFDNUQsZ0JBQWdCO0FBQUEsRUFDaEIsU0FBUyxTQUFVLEtBQUs7QUFDcEIsUUFBSSxJQUFJLE1BQU07QUFDZCxRQUFJLElBQUksS0FBSyxJQUFJO0FBQ2IsYUFBTztBQUNYLFlBQVEsSUFBSTtBQUFBLFdBQ0g7QUFDRCxlQUFPO0FBQUEsV0FDTjtBQUNELGVBQU87QUFBQSxXQUNOO0FBQ0QsZUFBTztBQUFBO0FBRVAsZUFBTztBQUFBO0FBQUEsRUFFbkI7QUFBQSxFQUNBLGdCQUFnQjtBQUFBLEVBQ2hCLGtCQUFrQjtBQUFBLEVBQ2xCLGFBQWE7QUFBQSxFQUNiLGFBQWE7QUFBQSxFQUNiLE1BQU0sQ0FBQyxNQUFNLElBQUk7QUFBQSxFQUNqQixlQUFlO0FBQUEsRUFDZixnQkFBZ0I7QUFBQSxFQUNoQixlQUFlO0FBQUEsRUFDZixpQkFBaUI7QUFBQSxFQUNqQixXQUFXO0FBQ2Y7QUFDQSxJQUFPLGtCQUFROzs7QUN2RVIsSUFBSSxNQUFNLFNBQVUsUUFBUSxRQUFRO0FBQ3ZDLE1BQUksV0FBVyxRQUFRO0FBQUUsYUFBUztBQUFBLEVBQUc7QUFDckMsU0FBUSxTQUFRLFFBQVEsTUFBTSxTQUFTLEVBQUU7QUFDN0M7QUFDTyxJQUFJLE1BQU0sU0FBVSxNQUFNO0FBQUUsU0FBUSxTQUFTLE9BQU8sSUFBSTtBQUFJO0FBQzVELG1CQUFrQixLQUFJLE1BQU07QUFDL0IsTUFBSTtBQUNKLFNBQU8sV0FBWTtBQUNmLFFBQUksUUFBUTtBQUNaLFFBQUksT0FBTztBQUNYLGlCQUFhLENBQUM7QUFDZCxRQUFJLFdBQVcsV0FBWTtBQUFFLGFBQU8sSUFBRyxNQUFNLE9BQU8sSUFBSTtBQUFBLElBQUcsR0FBRyxJQUFJO0FBQUEsRUFDdEU7QUFDSjtBQUNPLElBQUksV0FBVyxTQUFVLEtBQUs7QUFDakMsU0FBTyxlQUFlLFFBQVEsTUFBTSxDQUFDLEdBQUc7QUFDNUM7OztBQ2hCTyxxQkFBcUIsTUFBTSxXQUFXLE1BQU07QUFDL0MsTUFBSSxTQUFTO0FBQ1QsV0FBTyxLQUFLLFVBQVUsSUFBSSxTQUFTO0FBQ3ZDLE9BQUssVUFBVSxPQUFPLFNBQVM7QUFDbkM7QUFDTyx1QkFBdUIsS0FBSyxXQUFXLFNBQVM7QUFDbkQsTUFBSSxJQUFJLE9BQU8sU0FBUyxjQUFjLEdBQUc7QUFDekMsY0FBWSxhQUFhO0FBQ3pCLFlBQVUsV0FBVztBQUNyQixJQUFFLFlBQVk7QUFDZCxNQUFJLFlBQVk7QUFDWixNQUFFLGNBQWM7QUFDcEIsU0FBTztBQUNYO0FBQ08sbUJBQW1CLE1BQU07QUFDNUIsU0FBTyxLQUFLO0FBQ1IsU0FBSyxZQUFZLEtBQUssVUFBVTtBQUN4QztBQUNPLG9CQUFvQixNQUFNLFdBQVc7QUFDeEMsTUFBSSxVQUFVLElBQUk7QUFDZCxXQUFPO0FBQUEsV0FDRixLQUFLO0FBQ1YsV0FBTyxXQUFXLEtBQUssWUFBWSxTQUFTO0FBQ2hELFNBQU87QUFDWDtBQUNPLDJCQUEyQixnQkFBZ0IsTUFBTTtBQUNwRCxNQUFJLFVBQVUsY0FBYyxPQUFPLGlCQUFpQixHQUFHLFdBQVcsY0FBYyxTQUFTLGNBQWMsY0FBYyxHQUFHLFVBQVUsY0FBYyxRQUFRLFNBQVMsR0FBRyxZQUFZLGNBQWMsUUFBUSxXQUFXO0FBQ2pOLE1BQUksVUFBVSxVQUFVLFFBQVEsVUFBVSxNQUFNLElBQUk7QUFDaEQsYUFBUyxPQUFPO0FBQUEsRUFDcEIsT0FDSztBQUNELGFBQVMsT0FBTztBQUNoQixhQUFTLFVBQVU7QUFBQSxFQUN2QjtBQUNBLE1BQUksU0FBUztBQUNULGFBQVMsT0FBTztBQUNaLGVBQVMsYUFBYSxLQUFLLEtBQUssSUFBSTtBQUM1QyxVQUFRLFlBQVksUUFBUTtBQUM1QixVQUFRLFlBQVksT0FBTztBQUMzQixVQUFRLFlBQVksU0FBUztBQUM3QixTQUFPO0FBQ1g7QUFDTyx3QkFBd0IsT0FBTztBQUNsQyxNQUFJO0FBQ0EsUUFBSSxPQUFPLE1BQU0saUJBQWlCLFlBQVk7QUFDMUMsVUFBSSxPQUFPLE1BQU0sYUFBYTtBQUM5QixhQUFPLEtBQUs7QUFBQSxJQUNoQjtBQUNBLFdBQU8sTUFBTTtBQUFBLEVBQ2pCLFNBQ08sT0FBUDtBQUNJLFdBQU8sTUFBTTtBQUFBLEVBQ2pCO0FBQ0o7OztBQ3BEQSxJQUFJLFlBQVksV0FBWTtBQUFFLFNBQU87QUFBVztBQUN6QyxJQUFJLGFBQWEsU0FBVSxhQUFhLFdBQVcsUUFBUTtBQUFFLFNBQU8sT0FBTyxPQUFPLFlBQVksY0FBYyxZQUFZO0FBQWM7QUFDdEksSUFBSSxZQUFZO0FBQUEsRUFDbkIsR0FBRztBQUFBLEVBQ0gsR0FBRyxTQUFVLFNBQVMsV0FBVyxRQUFRO0FBQ3JDLFlBQVEsU0FBUyxPQUFPLE9BQU8sU0FBUyxRQUFRLFNBQVMsQ0FBQztBQUFBLEVBQzlEO0FBQUEsRUFDQSxHQUFHLFNBQVUsU0FBUyxNQUFNO0FBQ3hCLFlBQVEsU0FBVSxTQUFRLFNBQVMsS0FBSyxLQUFLLEtBQUssS0FBSyxXQUFXLElBQUksQ0FBQztBQUFBLEVBQzNFO0FBQUEsRUFDQSxHQUFHLFNBQVUsU0FBUyxNQUFNO0FBQ3hCLFlBQVEsU0FBUyxXQUFXLElBQUksQ0FBQztBQUFBLEVBQ3JDO0FBQUEsRUFDQSxHQUFHLFNBQVUsU0FBUyxLQUFLO0FBQ3ZCLFlBQVEsUUFBUSxXQUFXLEdBQUcsQ0FBQztBQUFBLEVBQ25DO0FBQUEsRUFDQSxHQUFHLFNBQVUsU0FBUyxNQUFNLFFBQVE7QUFDaEMsWUFBUSxTQUFVLFFBQVEsU0FBUyxJQUFJLEtBQ25DLEtBQUssSUFBSSxJQUFJLE9BQU8sT0FBTyxLQUFLLElBQUksR0FBRyxFQUFFLEtBQUssSUFBSSxDQUFDLENBQUM7QUFBQSxFQUM1RDtBQUFBLEVBQ0EsR0FBRyxTQUFVLFNBQVMsWUFBWSxRQUFRO0FBQ3RDLFlBQVEsU0FBUyxPQUFPLE9BQU8sVUFBVSxRQUFRLFVBQVUsQ0FBQztBQUFBLEVBQ2hFO0FBQUEsRUFDQSxHQUFHLFNBQVUsU0FBUyxTQUFTO0FBQzNCLFlBQVEsV0FBVyxXQUFXLE9BQU8sQ0FBQztBQUFBLEVBQzFDO0FBQUEsRUFDQSxHQUFHLFNBQVUsR0FBRyxhQUFhO0FBQUUsV0FBTyxJQUFJLEtBQUssV0FBVyxXQUFXLElBQUksR0FBSTtBQUFBLEVBQUc7QUFBQSxFQUNoRixHQUFHLFNBQVUsU0FBUyxTQUFTLFFBQVE7QUFDbkMsUUFBSSxhQUFhLFNBQVMsT0FBTztBQUNqQyxRQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsWUFBWSxHQUFHLEdBQUcsSUFBSyxjQUFhLEtBQUssR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFDO0FBQ2xGLFNBQUssUUFBUSxLQUFLLFFBQVEsSUFBSSxLQUFLLE9BQU8sSUFBSSxPQUFPLGNBQWM7QUFDbkUsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUNBLEdBQUcsU0FBVSxTQUFTLE1BQU07QUFDeEIsWUFBUSxZQUFZLFdBQVcsSUFBSSxDQUFDO0FBQUEsRUFDeEM7QUFBQSxFQUNBLEdBQUcsU0FBVSxHQUFHLFNBQVM7QUFBRSxXQUFPLElBQUksS0FBSyxPQUFPO0FBQUEsRUFBRztBQUFBLEVBQ3JELEdBQUcsU0FBVSxTQUFTLEtBQUs7QUFDdkIsWUFBUSxRQUFRLFdBQVcsR0FBRyxDQUFDO0FBQUEsRUFDbkM7QUFBQSxFQUNBLEdBQUcsU0FBVSxTQUFTLE1BQU07QUFDeEIsWUFBUSxTQUFVLFNBQVEsU0FBUyxLQUFLLEtBQUssS0FBSyxLQUFLLFdBQVcsSUFBSSxDQUFDO0FBQUEsRUFDM0U7QUFBQSxFQUNBLEdBQUcsU0FBVSxTQUFTLFNBQVM7QUFDM0IsWUFBUSxXQUFXLFdBQVcsT0FBTyxDQUFDO0FBQUEsRUFDMUM7QUFBQSxFQUNBLEdBQUcsU0FBVSxTQUFTLEtBQUs7QUFDdkIsWUFBUSxRQUFRLFdBQVcsR0FBRyxDQUFDO0FBQUEsRUFDbkM7QUFBQSxFQUNBLEdBQUc7QUFBQSxFQUNILEdBQUcsU0FBVSxTQUFTLE9BQU87QUFDekIsWUFBUSxTQUFTLFdBQVcsS0FBSyxJQUFJLENBQUM7QUFBQSxFQUMxQztBQUFBLEVBQ0EsR0FBRyxTQUFVLFNBQVMsT0FBTztBQUN6QixZQUFRLFNBQVMsV0FBVyxLQUFLLElBQUksQ0FBQztBQUFBLEVBQzFDO0FBQUEsRUFDQSxHQUFHLFNBQVUsU0FBUyxTQUFTO0FBQzNCLFlBQVEsV0FBVyxXQUFXLE9BQU8sQ0FBQztBQUFBLEVBQzFDO0FBQUEsRUFDQSxHQUFHLFNBQVUsR0FBRyxpQkFBaUI7QUFDN0IsV0FBTyxJQUFJLEtBQUssV0FBVyxlQUFlLENBQUM7QUFBQSxFQUMvQztBQUFBLEVBQ0EsR0FBRztBQUFBLEVBQ0gsR0FBRyxTQUFVLFNBQVMsTUFBTTtBQUN4QixZQUFRLFlBQVksTUFBTyxXQUFXLElBQUksQ0FBQztBQUFBLEVBQy9DO0FBQ0o7QUFDTyxJQUFJLGFBQWE7QUFBQSxFQUNwQixHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQUEsRUFDSCxHQUFHO0FBQ1A7QUFDTyxJQUFJLFVBQVU7QUFBQSxFQUNqQixHQUFHLFNBQVUsTUFBTTtBQUFFLFdBQU8sS0FBSyxZQUFZO0FBQUEsRUFBRztBQUFBLEVBQ2hELEdBQUcsU0FBVSxNQUFNLFFBQVEsVUFBUztBQUNoQyxXQUFPLE9BQU8sU0FBUyxVQUFVLFFBQVEsRUFBRSxNQUFNLFFBQVEsUUFBTztBQUFBLEVBQ3BFO0FBQUEsRUFDQSxHQUFHLFNBQVUsTUFBTSxRQUFRLFVBQVM7QUFDaEMsV0FBTyxXQUFXLFFBQVEsRUFBRSxNQUFNLFFBQVEsUUFBTyxJQUFJLEdBQUcsT0FBTyxNQUFNO0FBQUEsRUFDekU7QUFBQSxFQUNBLEdBQUcsU0FBVSxNQUFNLFFBQVEsVUFBUztBQUNoQyxXQUFPLElBQUksUUFBUSxFQUFFLE1BQU0sUUFBUSxRQUFPLENBQUM7QUFBQSxFQUMvQztBQUFBLEVBQ0EsR0FBRyxTQUFVLE1BQU07QUFBRSxXQUFPLElBQUksS0FBSyxTQUFTLENBQUM7QUFBQSxFQUFHO0FBQUEsRUFDbEQsR0FBRyxTQUFVLE1BQU0sUUFBUTtBQUN2QixXQUFPLE9BQU8sWUFBWSxTQUNwQixLQUFLLFFBQVEsSUFBSSxPQUFPLFFBQVEsS0FBSyxRQUFRLENBQUMsSUFDOUMsS0FBSyxRQUFRO0FBQUEsRUFDdkI7QUFBQSxFQUNBLEdBQUcsU0FBVSxNQUFNLFFBQVE7QUFBRSxXQUFPLE9BQU8sS0FBSyxJQUFJLEtBQUssU0FBUyxJQUFJLEVBQUU7QUFBQSxFQUFJO0FBQUEsRUFDNUUsR0FBRyxTQUFVLE1BQU0sUUFBUTtBQUN2QixXQUFPLFdBQVcsS0FBSyxTQUFTLEdBQUcsTUFBTSxNQUFNO0FBQUEsRUFDbkQ7QUFBQSxFQUNBLEdBQUcsU0FBVSxNQUFNO0FBQUUsV0FBTyxJQUFJLEtBQUssV0FBVyxDQUFDO0FBQUEsRUFBRztBQUFBLEVBQ3BELEdBQUcsU0FBVSxNQUFNO0FBQUUsV0FBTyxLQUFLLFFBQVEsSUFBSTtBQUFBLEVBQU07QUFBQSxFQUNuRCxHQUFHLFNBQVUsTUFBTSxHQUFHLFVBQVM7QUFDM0IsV0FBTyxTQUFRLFFBQVEsSUFBSTtBQUFBLEVBQy9CO0FBQUEsRUFDQSxHQUFHLFNBQVUsTUFBTTtBQUFFLFdBQU8sSUFBSSxLQUFLLFlBQVksR0FBRyxDQUFDO0FBQUEsRUFBRztBQUFBLEVBQ3hELEdBQUcsU0FBVSxNQUFNO0FBQUUsV0FBTyxJQUFJLEtBQUssUUFBUSxDQUFDO0FBQUEsRUFBRztBQUFBLEVBQ2pELEdBQUcsU0FBVSxNQUFNO0FBQUUsV0FBUSxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssU0FBUyxJQUFJLEtBQUs7QUFBQSxFQUFLO0FBQUEsRUFDaEYsR0FBRyxTQUFVLE1BQU07QUFBRSxXQUFPLElBQUksS0FBSyxXQUFXLENBQUM7QUFBQSxFQUFHO0FBQUEsRUFDcEQsR0FBRyxTQUFVLE1BQU07QUFBRSxXQUFPLEtBQUssUUFBUTtBQUFBLEVBQUc7QUFBQSxFQUM1QyxHQUFHLFNBQVUsTUFBTSxRQUFRO0FBQ3ZCLFdBQU8sT0FBTyxTQUFTLFNBQVMsS0FBSyxPQUFPO0FBQUEsRUFDaEQ7QUFBQSxFQUNBLEdBQUcsU0FBVSxNQUFNO0FBQUUsV0FBTyxJQUFJLEtBQUssU0FBUyxJQUFJLENBQUM7QUFBQSxFQUFHO0FBQUEsRUFDdEQsR0FBRyxTQUFVLE1BQU07QUFBRSxXQUFPLEtBQUssU0FBUyxJQUFJO0FBQUEsRUFBRztBQUFBLEVBQ2pELEdBQUcsU0FBVSxNQUFNO0FBQUUsV0FBTyxLQUFLLFdBQVc7QUFBQSxFQUFHO0FBQUEsRUFDL0MsR0FBRyxTQUFVLE1BQU07QUFBRSxXQUFPLEtBQUssUUFBUTtBQUFBLEVBQUc7QUFBQSxFQUM1QyxHQUFHLFNBQVUsTUFBTTtBQUFFLFdBQU8sS0FBSyxPQUFPO0FBQUEsRUFBRztBQUFBLEVBQzNDLEdBQUcsU0FBVSxNQUFNO0FBQUUsV0FBTyxPQUFPLEtBQUssWUFBWSxDQUFDLEVBQUUsVUFBVSxDQUFDO0FBQUEsRUFBRztBQUN6RTs7O0FDbElPLElBQUksc0JBQXNCLFNBQVUsSUFBSTtBQUMzQyxNQUFJLEtBQUssR0FBRyxRQUFRLFNBQVMsT0FBTyxTQUFTLFdBQVcsSUFBSSxLQUFLLEdBQUcsTUFBTSxPQUFPLE9BQU8sU0FBUyxVQUFVLElBQUksS0FBSyxHQUFHLFVBQVUsV0FBVyxPQUFPLFNBQVMsUUFBUTtBQUNwSyxTQUFPLFNBQVUsU0FBUyxNQUFNLGdCQUFnQjtBQUM1QyxRQUFJLFNBQVMsa0JBQWtCO0FBQy9CLFFBQUksT0FBTyxlQUFlLFVBQWEsQ0FBQyxVQUFVO0FBQzlDLGFBQU8sT0FBTyxXQUFXLFNBQVMsTUFBTSxNQUFNO0FBQUEsSUFDbEQ7QUFDQSxXQUFPLEtBQ0YsTUFBTSxFQUFFLEVBQ1IsSUFBSSxTQUFVLEdBQUcsR0FBRyxLQUFLO0FBQzFCLGFBQU8sUUFBUSxNQUFNLElBQUksSUFBSSxPQUFPLE9BQzlCLFFBQVEsR0FBRyxTQUFTLFFBQVEsTUFBTSxJQUNsQyxNQUFNLE9BQ0YsSUFDQTtBQUFBLElBQ2QsQ0FBQyxFQUNJLEtBQUssRUFBRTtBQUFBLEVBQ2hCO0FBQ0o7QUFDTyxJQUFJLG1CQUFtQixTQUFVLElBQUk7QUFDeEMsTUFBSSxLQUFLLEdBQUcsUUFBUSxTQUFTLE9BQU8sU0FBUyxXQUFXLElBQUksS0FBSyxHQUFHLE1BQU0sT0FBTyxPQUFPLFNBQVMsVUFBVTtBQUMzRyxTQUFPLFNBQVUsTUFBTSxhQUFhLFVBQVUsY0FBYztBQUN4RCxRQUFJLFNBQVMsS0FBSyxDQUFDO0FBQ2YsYUFBTztBQUNYLFFBQUksU0FBUyxnQkFBZ0I7QUFDN0IsUUFBSTtBQUNKLFFBQUksV0FBVztBQUNmLFFBQUksZ0JBQWdCO0FBQ2hCLG1CQUFhLElBQUksS0FBSyxLQUFLLFFBQVEsQ0FBQztBQUFBLGFBQy9CLE9BQU8sU0FBUyxZQUNyQixLQUFLLFlBQVk7QUFDakIsbUJBQWEsSUFBSSxLQUFLLElBQUk7QUFBQSxhQUNyQixPQUFPLFNBQVMsVUFBVTtBQUMvQixVQUFJLFVBQVMsZUFBZ0IsV0FBVSxVQUFVO0FBQ2pELFVBQUksVUFBVSxPQUFPLElBQUksRUFBRSxLQUFLO0FBQ2hDLFVBQUksWUFBWSxTQUFTO0FBQ3JCLHFCQUFhLElBQUksS0FBSztBQUN0QixtQkFBVztBQUFBLE1BQ2YsV0FDUyxVQUFVLE9BQU8sV0FBVztBQUNqQyxxQkFBYSxPQUFPLFVBQVUsTUFBTSxPQUFNO0FBQUEsTUFDOUMsV0FDUyxLQUFLLEtBQUssT0FBTyxLQUN0QixPQUFPLEtBQUssT0FBTyxHQUFHO0FBQ3RCLHFCQUFhLElBQUksS0FBSyxJQUFJO0FBQUEsTUFDOUIsT0FDSztBQUNELFlBQUksVUFBVSxRQUFRLE1BQU0sQ0FBQztBQUM3QixpQkFBUyxJQUFJLEdBQUcsYUFBYSxHQUFHLFdBQVcsSUFBSSxJQUFJLFFBQU8sUUFBUSxLQUFLO0FBQ25FLGNBQUksUUFBUSxRQUFPO0FBQ25CLGNBQUksY0FBYyxVQUFVO0FBQzVCLGNBQUksVUFBVSxRQUFPLElBQUksT0FBTyxRQUFRO0FBQ3hDLGNBQUksV0FBVyxVQUFVLENBQUMsU0FBUztBQUMvQix3QkFBWSxXQUFXO0FBQ3ZCLGdCQUFJLFFBQVEsSUFBSSxPQUFPLFFBQVEsRUFBRSxLQUFLLElBQUk7QUFDMUMsZ0JBQUksU0FBVSxXQUFVLE9BQU87QUFDM0Isa0JBQUksVUFBVSxNQUFNLFNBQVMsV0FBVztBQUFBLGdCQUNwQyxJQUFJLFVBQVU7QUFBQSxnQkFDZCxLQUFLLE1BQU0sRUFBRTtBQUFBLGNBQ2pCLENBQUM7QUFBQSxZQUNMO0FBQUEsVUFDSixXQUNTLENBQUM7QUFDTix3QkFBWTtBQUFBLFFBQ3BCO0FBQ0EscUJBQ0ksQ0FBQyxVQUFVLENBQUMsT0FBTyxhQUNiLElBQUksS0FBSyxJQUFJLEtBQUssRUFBRSxZQUFZLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFDbkQsSUFBSSxLQUFLLElBQUksS0FBSyxFQUFFLFNBQVMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQ2xELFlBQUksUUFBUSxTQUFVLEtBQUk7QUFDdEIsY0FBSSxNQUFLLElBQUcsSUFBSSxNQUFNLElBQUc7QUFDekIsaUJBQVEsYUFBYSxJQUFHLFlBQVksS0FBSyxNQUFNLEtBQUs7QUFBQSxRQUN4RCxDQUFDO0FBQ0QscUJBQWEsVUFBVSxhQUFhO0FBQUEsTUFDeEM7QUFBQSxJQUNKO0FBQ0EsUUFBSSxDQUFFLHVCQUFzQixRQUFRLENBQUMsTUFBTSxXQUFXLFFBQVEsQ0FBQyxJQUFJO0FBQy9ELGFBQU8sYUFBYSxJQUFJLE1BQU0sNEJBQTRCLFFBQVEsQ0FBQztBQUNuRSxhQUFPO0FBQUEsSUFDWDtBQUNBLFFBQUksYUFBYTtBQUNiLGlCQUFXLFNBQVMsR0FBRyxHQUFHLEdBQUcsQ0FBQztBQUNsQyxXQUFPO0FBQUEsRUFDWDtBQUNKO0FBQ08sc0JBQXNCLE9BQU8sT0FBTyxVQUFVO0FBQ2pELE1BQUksYUFBYSxRQUFRO0FBQUUsZUFBVztBQUFBLEVBQU07QUFDNUMsTUFBSSxhQUFhLE9BQU87QUFDcEIsV0FBUSxJQUFJLEtBQUssTUFBTSxRQUFRLENBQUMsRUFBRSxTQUFTLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFDakQsSUFBSSxLQUFLLE1BQU0sUUFBUSxDQUFDLEVBQUUsU0FBUyxHQUFHLEdBQUcsR0FBRyxDQUFDO0FBQUEsRUFDckQ7QUFDQSxTQUFPLE1BQU0sUUFBUSxJQUFJLE1BQU0sUUFBUTtBQUMzQztBQU9PLElBQUksWUFBWSxTQUFVLElBQUksS0FBSyxLQUFLO0FBQzNDLFNBQU8sS0FBSyxLQUFLLElBQUksS0FBSyxHQUFHLEtBQUssS0FBSyxLQUFLLElBQUksS0FBSyxHQUFHO0FBQzVEO0FBQ08sSUFBSSxnQ0FBZ0MsU0FBVSxPQUFPLFNBQVMsU0FBUztBQUMxRSxTQUFPLFFBQVEsT0FBTyxVQUFVLEtBQUs7QUFDekM7QUFDTyxJQUFJLGVBQWUsU0FBVSxzQkFBc0I7QUFDdEQsTUFBSSxRQUFRLEtBQUssTUFBTSx1QkFBdUIsSUFBSSxHQUFHLFVBQVcsd0JBQXVCLFFBQVEsUUFBUTtBQUN2RyxTQUFPLENBQUMsT0FBTyxTQUFTLHVCQUF1QixRQUFRLE9BQU8sVUFBVSxFQUFFO0FBQzlFO0FBQ08sSUFBSSxXQUFXO0FBQUEsRUFDbEIsS0FBSztBQUNUO0FBQ08seUJBQXlCLFFBQVE7QUFDcEMsTUFBSSxRQUFRLE9BQU87QUFDbkIsTUFBSSxVQUFVLE9BQU87QUFDckIsTUFBSSxVQUFVLE9BQU87QUFDckIsTUFBSSxPQUFPLFlBQVksUUFBVztBQUM5QixRQUFJLFVBQVUsT0FBTyxRQUFRLFNBQVM7QUFDdEMsUUFBSSxhQUFhLE9BQU8sUUFBUSxXQUFXO0FBQzNDLFFBQUksYUFBYSxPQUFPLFFBQVEsV0FBVztBQUMzQyxRQUFJLFFBQVEsU0FBUztBQUNqQixjQUFRO0FBQUEsSUFDWjtBQUNBLFFBQUksVUFBVSxXQUFXLFVBQVUsWUFBWTtBQUMzQyxnQkFBVTtBQUFBLElBQ2Q7QUFDQSxRQUFJLFVBQVUsV0FBVyxZQUFZLGNBQWMsVUFBVTtBQUN6RCxnQkFBVSxPQUFPLFFBQVEsV0FBVztBQUFBLEVBQzVDO0FBQ0EsTUFBSSxPQUFPLFlBQVksUUFBVztBQUM5QixRQUFJLFFBQVEsT0FBTyxRQUFRLFNBQVM7QUFDcEMsUUFBSSxhQUFhLE9BQU8sUUFBUSxXQUFXO0FBQzNDLFlBQVEsS0FBSyxJQUFJLE9BQU8sS0FBSztBQUM3QixRQUFJLFVBQVU7QUFDVixnQkFBVSxLQUFLLElBQUksWUFBWSxPQUFPO0FBQzFDLFFBQUksVUFBVSxTQUFTLFlBQVk7QUFDL0IsZ0JBQVUsT0FBTyxRQUFRLFdBQVc7QUFBQSxFQUM1QztBQUNBLFNBQU8sRUFBRSxPQUFjLFNBQWtCLFFBQWlCO0FBQzlEOzs7QUM3SUEsSUFBSSxPQUFPLE9BQU8sV0FBVyxZQUFZO0FBQ3JDLFNBQU8sU0FBUyxTQUFVLFFBQVE7QUFDOUIsUUFBSSxPQUFPLENBQUM7QUFDWixhQUFTLEtBQUssR0FBRyxLQUFLLFVBQVUsUUFBUSxNQUFNO0FBQzFDLFdBQUssS0FBSyxLQUFLLFVBQVU7QUFBQSxJQUM3QjtBQUNBLFFBQUksQ0FBQyxRQUFRO0FBQ1QsWUFBTSxVQUFVLDRDQUE0QztBQUFBLElBQ2hFO0FBQ0EsUUFBSSxVQUFVLFNBQVUsU0FBUTtBQUM1QixVQUFJLFNBQVE7QUFDUixlQUFPLEtBQUssT0FBTSxFQUFFLFFBQVEsU0FBVSxLQUFLO0FBQUUsaUJBQVEsT0FBTyxPQUFPLFFBQU87QUFBQSxRQUFPLENBQUM7QUFBQSxNQUN0RjtBQUFBLElBQ0o7QUFDQSxhQUFTLEtBQUssR0FBRyxTQUFTLE1BQU0sS0FBSyxPQUFPLFFBQVEsTUFBTTtBQUN0RCxVQUFJLFNBQVMsT0FBTztBQUNwQixjQUFRLE1BQU07QUFBQSxJQUNsQjtBQUNBLFdBQU87QUFBQSxFQUNYO0FBQ0o7OztBQ3JCQSxJQUFJLFdBQXNDLFdBQVk7QUFDbEQsYUFBVyxPQUFPLFVBQVUsU0FBUyxHQUFHO0FBQ3BDLGFBQVMsR0FBRyxJQUFJLEdBQUcsSUFBSSxVQUFVLFFBQVEsSUFBSSxHQUFHLEtBQUs7QUFDakQsVUFBSSxVQUFVO0FBQ2QsZUFBUyxLQUFLO0FBQUcsWUFBSSxPQUFPLFVBQVUsZUFBZSxLQUFLLEdBQUcsQ0FBQztBQUMxRCxZQUFFLEtBQUssRUFBRTtBQUFBLElBQ2pCO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFDQSxTQUFPLFNBQVMsTUFBTSxNQUFNLFNBQVM7QUFDekM7QUFDQSxJQUFJLGlCQUFrRCxXQUFZO0FBQzlELFdBQVMsSUFBSSxHQUFHLElBQUksR0FBRyxLQUFLLFVBQVUsUUFBUSxJQUFJLElBQUk7QUFBSyxTQUFLLFVBQVUsR0FBRztBQUM3RSxXQUFTLElBQUksTUFBTSxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLElBQUk7QUFDekMsYUFBUyxJQUFJLFVBQVUsSUFBSSxJQUFJLEdBQUcsS0FBSyxFQUFFLFFBQVEsSUFBSSxJQUFJLEtBQUs7QUFDMUQsUUFBRSxLQUFLLEVBQUU7QUFDakIsU0FBTztBQUNYO0FBUUEsSUFBSSxzQkFBc0I7QUFDMUIsMkJBQTJCLFNBQVMsZ0JBQWdCO0FBQ2hELE1BQUksT0FBTztBQUFBLElBQ1AsUUFBUSxTQUFTLFNBQVMsQ0FBQyxHQUFHLFFBQWMsR0FBRyxVQUFVLGFBQWE7QUFBQSxJQUN0RSxNQUFNO0FBQUEsRUFDVjtBQUNBLE9BQUssWUFBWSxpQkFBaUIsRUFBRSxRQUFRLEtBQUssUUFBUSxNQUFNLEtBQUssS0FBSyxDQUFDO0FBQzFFLE9BQUssWUFBWSxDQUFDO0FBQ2xCLE9BQUssaUJBQWlCLENBQUM7QUFDdkIsT0FBSyxnQkFBZ0IsQ0FBQztBQUN0QixPQUFLLFFBQVE7QUFDYixPQUFLLG9CQUFvQjtBQUN6QixPQUFLLG9CQUFvQjtBQUN6QixPQUFLLGNBQWM7QUFDbkIsT0FBSyxhQUFhO0FBQ2xCLE9BQUssUUFBUTtBQUNiLE9BQUssUUFBUTtBQUNiLE9BQUssY0FBYztBQUNuQixPQUFLLGlCQUFpQjtBQUN0QixPQUFLLFlBQVk7QUFDakIsT0FBSyxVQUFVO0FBQ2YsT0FBSyxZQUFZO0FBQ2pCLE9BQUssYUFBYTtBQUNsQixPQUFLLGNBQWM7QUFDbkIsT0FBSyxPQUFPO0FBQ1osT0FBSyxTQUFTO0FBQ2QsT0FBSyxNQUFNO0FBQ1gsT0FBSyxVQUFVO0FBQ2YsT0FBSyxTQUFTO0FBQ2Qsa0NBQWdDO0FBQzVCLFNBQUssUUFBUTtBQUFBLE1BQ1QsZ0JBQWdCLFNBQVUsT0FBTyxJQUFJO0FBQ2pDLFlBQUksVUFBVSxRQUFRO0FBQUUsa0JBQVEsS0FBSztBQUFBLFFBQWM7QUFDbkQsWUFBSSxPQUFPLFFBQVE7QUFBRSxlQUFLLEtBQUs7QUFBQSxRQUFhO0FBQzVDLFlBQUksVUFBVSxLQUFPLE1BQUssTUFBTSxLQUFLLEtBQUssUUFBUSxLQUFNLEtBQUssUUFBUTtBQUNqRSxpQkFBTztBQUNYLGVBQU8sS0FBSyxLQUFLLFlBQVk7QUFBQSxNQUNqQztBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0Esa0JBQWdCO0FBQ1osU0FBSyxVQUFVLEtBQUssUUFBUTtBQUM1QixTQUFLLFNBQVM7QUFDZCxnQkFBWTtBQUNaLGdCQUFZO0FBQ1osZ0JBQVk7QUFDWixlQUFXO0FBQ1gseUJBQXFCO0FBQ3JCLFFBQUksQ0FBQyxLQUFLO0FBQ04sWUFBTTtBQUNWLGVBQVc7QUFDWCxRQUFJLEtBQUssY0FBYyxVQUFVLEtBQUssT0FBTyxZQUFZO0FBQ3JELFVBQUksS0FBSyxPQUFPLFlBQVk7QUFDeEIseUJBQWlCLEtBQUssT0FBTyxhQUFhLEtBQUssd0JBQXdCLE1BQVM7QUFBQSxNQUNwRjtBQUNBLGtCQUFZLEtBQUs7QUFBQSxJQUNyQjtBQUNBLHFCQUFpQjtBQUNqQixRQUFJLFdBQVcsaUNBQWlDLEtBQUssVUFBVSxTQUFTO0FBQ3hFLFFBQUksQ0FBQyxLQUFLLFlBQVksVUFBVTtBQUM1Qix1QkFBaUI7QUFBQSxJQUNyQjtBQUNBLGlCQUFhLFNBQVM7QUFBQSxFQUMxQjtBQUNBLHFDQUFtQztBQUMvQixRQUFJO0FBQ0osV0FBVSxPQUFLLEtBQUssdUJBQXVCLFFBQVEsT0FBTyxTQUFTLFNBQVMsR0FBRyxZQUFZLEdBQ3RGLGlCQUFpQixTQUFTO0FBQUEsRUFDbkM7QUFDQSwwQkFBd0IsS0FBSTtBQUN4QixXQUFPLElBQUcsS0FBSyxJQUFJO0FBQUEsRUFDdkI7QUFDQSw4QkFBNEI7QUFDeEIsUUFBSSxTQUFTLEtBQUs7QUFDbEIsUUFBSSxPQUFPLGdCQUFnQixTQUFTLE9BQU8sZUFBZSxHQUFHO0FBQ3pEO0FBQUEsSUFDSixXQUNTLE9BQU8sZUFBZSxNQUFNO0FBQ2pDLGFBQU8sc0JBQXNCLFdBQVk7QUFDckMsWUFBSSxLQUFLLHNCQUFzQixRQUFXO0FBQ3RDLGVBQUssa0JBQWtCLE1BQU0sYUFBYTtBQUMxQyxlQUFLLGtCQUFrQixNQUFNLFVBQVU7QUFBQSxRQUMzQztBQUNBLFlBQUksS0FBSyxrQkFBa0IsUUFBVztBQUNsQyxjQUFJLFlBQWEsTUFBSyxLQUFLLGNBQWMsS0FBSyxPQUFPO0FBQ3JELGVBQUssY0FBYyxNQUFNLFFBQVEsWUFBWTtBQUM3QyxlQUFLLGtCQUFrQixNQUFNLFFBQ3pCLFlBQ0ssTUFBSyxnQkFBZ0IsU0FDaEIsS0FBSyxZQUFZLGNBQ2pCLEtBQ047QUFDUixlQUFLLGtCQUFrQixNQUFNLGVBQWUsWUFBWTtBQUN4RCxlQUFLLGtCQUFrQixNQUFNLGVBQWUsU0FBUztBQUFBLFFBQ3pEO0FBQUEsTUFDSixDQUFDO0FBQUEsSUFDTDtBQUFBLEVBQ0o7QUFDQSxzQkFBb0IsR0FBRztBQUNuQixRQUFJLEtBQUssY0FBYyxXQUFXLEdBQUc7QUFDakMsVUFBSSxjQUFjLEtBQUssT0FBTyxZQUFZLFVBQ3RDLGFBQWEsSUFBSSxLQUFLLEdBQUcsS0FBSyxPQUFPLE9BQU8sS0FBSyxJQUMvQyxJQUFJLEtBQUssSUFDVCxJQUFJLEtBQUssS0FBSyxPQUFPLFFBQVEsUUFBUSxDQUFDO0FBQzVDLFVBQUksWUFBVyxnQkFBZ0IsS0FBSyxNQUFNO0FBQzFDLGtCQUFZLFNBQVMsVUFBUyxPQUFPLFVBQVMsU0FBUyxVQUFTLFNBQVMsWUFBWSxnQkFBZ0IsQ0FBQztBQUN0RyxXQUFLLGdCQUFnQixDQUFDLFdBQVc7QUFDakMsV0FBSyx3QkFBd0I7QUFBQSxJQUNqQztBQUNBLFFBQUksTUFBTSxVQUFhLEVBQUUsU0FBUyxRQUFRO0FBQ3RDLGtCQUFZLENBQUM7QUFBQSxJQUNqQjtBQUNBLFFBQUksWUFBWSxLQUFLLE9BQU87QUFDNUIsdUJBQW1CO0FBQ25CLGdCQUFZO0FBQ1osUUFBSSxLQUFLLE9BQU8sVUFBVSxXQUFXO0FBQ2pDLFdBQUssaUJBQWlCO0FBQUEsSUFDMUI7QUFBQSxFQUNKO0FBQ0EseUJBQXVCLE1BQU0sTUFBTTtBQUMvQixXQUFRLE9BQU8sS0FBTSxLQUFLLElBQUksU0FBUyxLQUFLLEtBQUssS0FBSyxFQUFFO0FBQUEsRUFDNUQ7QUFDQSx5QkFBdUIsTUFBTTtBQUN6QixZQUFRLE9BQU87QUFBQSxXQUNOO0FBQUEsV0FDQTtBQUNELGVBQU87QUFBQTtBQUVQLGVBQU8sT0FBTztBQUFBO0FBQUEsRUFFMUI7QUFDQSxnQ0FBOEI7QUFDMUIsUUFBSSxLQUFLLGdCQUFnQixVQUFhLEtBQUssa0JBQWtCO0FBQ3pEO0FBQ0osUUFBSSxRQUFTLFVBQVMsS0FBSyxZQUFZLE1BQU0sTUFBTSxFQUFFLEdBQUcsRUFBRSxLQUFLLEtBQUssSUFBSSxVQUFXLFVBQVMsS0FBSyxjQUFjLE9BQU8sRUFBRSxLQUFLLEtBQUssSUFBSSxVQUFVLEtBQUssa0JBQWtCLFNBQ2hLLFVBQVMsS0FBSyxjQUFjLE9BQU8sRUFBRSxLQUFLLEtBQUssS0FDaEQ7QUFDTixRQUFJLEtBQUssU0FBUyxRQUFXO0FBQ3pCLGNBQVEsY0FBYyxPQUFPLEtBQUssS0FBSyxXQUFXO0FBQUEsSUFDdEQ7QUFDQSxRQUFJLGdCQUFnQixLQUFLLE9BQU8sWUFBWSxVQUN2QyxLQUFLLE9BQU8sV0FDVCxLQUFLLGtCQUNMLEtBQUsseUJBQ0wsYUFBYSxLQUFLLHVCQUF1QixLQUFLLE9BQU8sU0FBUyxJQUFJLE1BQzlEO0FBQ1osUUFBSSxnQkFBZ0IsS0FBSyxPQUFPLFlBQVksVUFDdkMsS0FBSyxPQUFPLFdBQ1QsS0FBSyxrQkFDTCxLQUFLLHlCQUNMLGFBQWEsS0FBSyx1QkFBdUIsS0FBSyxPQUFPLFNBQVMsSUFBSSxNQUM5RDtBQUNaLFFBQUksS0FBSyxPQUFPLFlBQVksVUFDeEIsS0FBSyxPQUFPLFlBQVksVUFDeEIsS0FBSyxPQUFPLFVBQVUsS0FBSyxPQUFPLFNBQVM7QUFDM0MsVUFBSSxXQUFXLDhCQUE4QixLQUFLLE9BQU8sUUFBUSxTQUFTLEdBQUcsS0FBSyxPQUFPLFFBQVEsV0FBVyxHQUFHLEtBQUssT0FBTyxRQUFRLFdBQVcsQ0FBQztBQUMvSSxVQUFJLFdBQVcsOEJBQThCLEtBQUssT0FBTyxRQUFRLFNBQVMsR0FBRyxLQUFLLE9BQU8sUUFBUSxXQUFXLEdBQUcsS0FBSyxPQUFPLFFBQVEsV0FBVyxDQUFDO0FBQy9JLFVBQUksY0FBYyw4QkFBOEIsT0FBTyxTQUFTLE9BQU87QUFDdkUsVUFBSSxjQUFjLFlBQVksY0FBYyxVQUFVO0FBQ2xELFlBQUksU0FBUyxhQUFhLFFBQVE7QUFDbEMsZ0JBQVEsT0FBTztBQUNmLGtCQUFVLE9BQU87QUFDakIsa0JBQVUsT0FBTztBQUFBLE1BQ3JCO0FBQUEsSUFDSixPQUNLO0FBQ0QsVUFBSSxlQUFlO0FBQ2YsWUFBSSxVQUFVLEtBQUssT0FBTyxZQUFZLFNBQ2hDLEtBQUssT0FBTyxVQUNaLEtBQUssT0FBTztBQUNsQixnQkFBUSxLQUFLLElBQUksT0FBTyxRQUFRLFNBQVMsQ0FBQztBQUMxQyxZQUFJLFVBQVUsUUFBUSxTQUFTO0FBQzNCLG9CQUFVLEtBQUssSUFBSSxTQUFTLFFBQVEsV0FBVyxDQUFDO0FBQ3BELFlBQUksWUFBWSxRQUFRLFdBQVc7QUFDL0Isb0JBQVUsS0FBSyxJQUFJLFNBQVMsUUFBUSxXQUFXLENBQUM7QUFBQSxNQUN4RDtBQUNBLFVBQUksZUFBZTtBQUNmLFlBQUksVUFBVSxLQUFLLE9BQU8sWUFBWSxTQUNoQyxLQUFLLE9BQU8sVUFDWixLQUFLLE9BQU87QUFDbEIsZ0JBQVEsS0FBSyxJQUFJLE9BQU8sUUFBUSxTQUFTLENBQUM7QUFDMUMsWUFBSSxVQUFVLFFBQVEsU0FBUyxLQUFLLFVBQVUsUUFBUSxXQUFXO0FBQzdELG9CQUFVLFFBQVEsV0FBVztBQUNqQyxZQUFJLFlBQVksUUFBUSxXQUFXO0FBQy9CLG9CQUFVLEtBQUssSUFBSSxTQUFTLFFBQVEsV0FBVyxDQUFDO0FBQUEsTUFDeEQ7QUFBQSxJQUNKO0FBQ0EsYUFBUyxPQUFPLFNBQVMsT0FBTztBQUFBLEVBQ3BDO0FBQ0EsNEJBQTBCLFNBQVM7QUFDL0IsUUFBSSxPQUFPLFdBQVcsS0FBSztBQUMzQixRQUFJLFFBQVEsZ0JBQWdCLE1BQU07QUFDOUIsZUFBUyxLQUFLLFNBQVMsR0FBRyxLQUFLLFdBQVcsR0FBRyxLQUFLLFdBQVcsQ0FBQztBQUFBLElBQ2xFO0FBQUEsRUFDSjtBQUNBLG9CQUFrQixPQUFPLFNBQVMsU0FBUztBQUN2QyxRQUFJLEtBQUssMEJBQTBCLFFBQVc7QUFDMUMsV0FBSyxzQkFBc0IsU0FBUyxRQUFRLElBQUksU0FBUyxXQUFXLEdBQUcsQ0FBQztBQUFBLElBQzVFO0FBQ0EsUUFBSSxDQUFDLEtBQUssZUFBZSxDQUFDLEtBQUssaUJBQWlCLEtBQUs7QUFDakQ7QUFDSixTQUFLLFlBQVksUUFBUSxJQUFJLENBQUMsS0FBSyxPQUFPLFlBQ2xDLE1BQUssU0FBUyxLQUFNLEtBQUssSUFBSSxRQUFRLE9BQU8sQ0FBQyxJQUMvQyxLQUFLO0FBQ1gsU0FBSyxjQUFjLFFBQVEsSUFBSSxPQUFPO0FBQ3RDLFFBQUksS0FBSyxTQUFTO0FBQ2QsV0FBSyxLQUFLLGNBQWMsS0FBSyxLQUFLLEtBQUssSUFBSSxTQUFTLEVBQUU7QUFDMUQsUUFBSSxLQUFLLGtCQUFrQjtBQUN2QixXQUFLLGNBQWMsUUFBUSxJQUFJLE9BQU87QUFBQSxFQUM5QztBQUNBLHVCQUFxQixPQUFPO0FBQ3hCLFFBQUksY0FBYyxlQUFlLEtBQUs7QUFDdEMsUUFBSSxPQUFPLFNBQVMsWUFBWSxLQUFLLElBQUssT0FBTSxTQUFTO0FBQ3pELFFBQUksT0FBTyxNQUFPLEtBQ2IsTUFBTSxRQUFRLFdBQVcsQ0FBQyxRQUFRLEtBQUssS0FBSyxTQUFTLENBQUMsR0FBSTtBQUMzRCxpQkFBVyxJQUFJO0FBQUEsSUFDbkI7QUFBQSxFQUNKO0FBQ0EsZ0JBQWMsVUFBUyxPQUFPLFNBQVMsVUFBUztBQUM1QyxRQUFJLGlCQUFpQjtBQUNqQixhQUFPLE1BQU0sUUFBUSxTQUFVLElBQUk7QUFBRSxlQUFPLEtBQUssVUFBUyxJQUFJLFNBQVMsUUFBTztBQUFBLE1BQUcsQ0FBQztBQUN0RixRQUFJLG9CQUFtQjtBQUNuQixhQUFPLFNBQVEsUUFBUSxTQUFVLElBQUk7QUFBRSxlQUFPLEtBQUssSUFBSSxPQUFPLFNBQVMsUUFBTztBQUFBLE1BQUcsQ0FBQztBQUN0RixhQUFRLGlCQUFpQixPQUFPLFNBQVMsUUFBTztBQUNoRCxTQUFLLFVBQVUsS0FBSztBQUFBLE1BQ2hCLFFBQVEsV0FBWTtBQUFFLGVBQU8sU0FBUSxvQkFBb0IsT0FBTyxTQUFTLFFBQU87QUFBQSxNQUFHO0FBQUEsSUFDdkYsQ0FBQztBQUFBLEVBQ0w7QUFDQSwyQkFBeUI7QUFDckIsaUJBQWEsVUFBVTtBQUFBLEVBQzNCO0FBQ0Esd0JBQXNCO0FBQ2xCLFFBQUksS0FBSyxPQUFPLE1BQU07QUFDbEIsT0FBQyxRQUFRLFNBQVMsVUFBVSxPQUFPLEVBQUUsUUFBUSxTQUFVLEtBQUs7QUFDeEQsY0FBTSxVQUFVLFFBQVEsS0FBSyxLQUFLLFFBQVEsaUJBQWlCLFdBQVcsTUFBTSxHQUFHLEdBQUcsU0FBVSxJQUFJO0FBQzVGLGlCQUFPLEtBQUssSUFBSSxTQUFTLEtBQUssSUFBSTtBQUFBLFFBQ3RDLENBQUM7QUFBQSxNQUNMLENBQUM7QUFBQSxJQUNMO0FBQ0EsUUFBSSxLQUFLLFVBQVU7QUFDZixrQkFBWTtBQUNaO0FBQUEsSUFDSjtBQUNBLFFBQUksa0JBQWtCLFVBQVMsVUFBVSxFQUFFO0FBQzNDLFNBQUssbUJBQW1CLFVBQVMsZUFBZSxtQkFBbUI7QUFDbkUsUUFBSSxLQUFLLGlCQUFpQixDQUFDLG9CQUFvQixLQUFLLFVBQVUsU0FBUztBQUNuRSxXQUFLLEtBQUssZUFBZSxhQUFhLFNBQVUsR0FBRztBQUMvQyxZQUFJLEtBQUssT0FBTyxTQUFTO0FBQ3JCLHNCQUFZLGVBQWUsQ0FBQyxDQUFDO0FBQUEsTUFDckMsQ0FBQztBQUNMLFNBQUssS0FBSyxRQUFRLFdBQVcsU0FBUztBQUN0QyxRQUFJLEtBQUssc0JBQXNCLFFBQVc7QUFDdEMsV0FBSyxLQUFLLG1CQUFtQixXQUFXLFNBQVM7QUFBQSxJQUNyRDtBQUNBLFFBQUksQ0FBQyxLQUFLLE9BQU8sVUFBVSxDQUFDLEtBQUssT0FBTztBQUNwQyxXQUFLLFFBQVEsVUFBVSxlQUFlO0FBQzFDLFFBQUksT0FBTyxpQkFBaUI7QUFDeEIsV0FBSyxPQUFPLFVBQVUsY0FBYyxhQUFhO0FBQUE7QUFFakQsV0FBSyxPQUFPLFVBQVUsYUFBYSxhQUFhO0FBQ3BELFNBQUssT0FBTyxVQUFVLFNBQVMsZUFBZSxFQUFFLFNBQVMsS0FBSyxDQUFDO0FBQy9ELFFBQUksS0FBSyxPQUFPLGVBQWUsTUFBTTtBQUNqQyxXQUFLLEtBQUssUUFBUSxTQUFTLEtBQUssSUFBSTtBQUNwQyxXQUFLLEtBQUssUUFBUSxTQUFTLEtBQUssSUFBSTtBQUFBLElBQ3hDO0FBQ0EsUUFBSSxLQUFLLGtCQUFrQixRQUFXO0FBQ2xDLFdBQUssS0FBSyxVQUFVLFNBQVMsZUFBZTtBQUM1QyxXQUFLLEtBQUssVUFBVSxDQUFDLFNBQVMsV0FBVyxHQUFHLFdBQVc7QUFDdkQsV0FBSyxLQUFLLGVBQWUsU0FBUyxVQUFVO0FBQUEsSUFDaEQ7QUFDQSxRQUFJLEtBQUssa0JBQWtCLFVBQ3ZCLEtBQUssa0JBQWtCLFVBQ3ZCLEtBQUssZ0JBQWdCLFFBQVc7QUFDaEMsVUFBSSxVQUFVLFNBQVUsR0FBRztBQUN2QixlQUFPLGVBQWUsQ0FBQyxFQUFFLE9BQU87QUFBQSxNQUNwQztBQUNBLFdBQUssS0FBSyxlQUFlLENBQUMsV0FBVyxHQUFHLFVBQVU7QUFDbEQsV0FBSyxLQUFLLGVBQWUsUUFBUSxZQUFZLEVBQUUsU0FBUyxLQUFLLENBQUM7QUFDOUQsV0FBSyxLQUFLLGVBQWUsU0FBUyxhQUFhO0FBQy9DLFdBQUssQ0FBQyxLQUFLLGFBQWEsS0FBSyxhQUFhLEdBQUcsQ0FBQyxTQUFTLE9BQU8sR0FBRyxPQUFPO0FBQ3hFLFVBQUksS0FBSyxrQkFBa0I7QUFDdkIsYUFBSyxLQUFLLGVBQWUsU0FBUyxXQUFZO0FBQUUsaUJBQU8sS0FBSyxpQkFBaUIsS0FBSyxjQUFjLE9BQU87QUFBQSxRQUFHLENBQUM7QUFDL0csVUFBSSxLQUFLLFNBQVMsUUFBVztBQUN6QixhQUFLLEtBQUssTUFBTSxTQUFTLFNBQVUsR0FBRztBQUNsQyxxQkFBVyxDQUFDO0FBQUEsUUFDaEIsQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBQ0EsUUFBSSxLQUFLLE9BQU8sWUFBWTtBQUN4QixXQUFLLEtBQUssUUFBUSxRQUFRLE1BQU07QUFBQSxJQUNwQztBQUFBLEVBQ0o7QUFDQSxzQkFBb0IsVUFBVSxnQkFBZTtBQUN6QyxRQUFJLFNBQVMsYUFBYSxTQUNwQixLQUFLLFVBQVUsUUFBUSxJQUN2QixLQUFLLHlCQUNGLE1BQUssT0FBTyxXQUFXLEtBQUssT0FBTyxVQUFVLEtBQUssTUFDN0MsS0FBSyxPQUFPLFVBQ1osS0FBSyxPQUFPLFdBQVcsS0FBSyxPQUFPLFVBQVUsS0FBSyxNQUM5QyxLQUFLLE9BQU8sVUFDWixLQUFLO0FBQ3ZCLFFBQUksVUFBVSxLQUFLO0FBQ25CLFFBQUksV0FBVyxLQUFLO0FBQ3BCLFFBQUk7QUFDQSxVQUFJLFdBQVcsUUFBVztBQUN0QixhQUFLLGNBQWMsT0FBTyxZQUFZO0FBQ3RDLGFBQUssZUFBZSxPQUFPLFNBQVM7QUFBQSxNQUN4QztBQUFBLElBQ0osU0FDTyxHQUFQO0FBQ0ksUUFBRSxVQUFVLDRCQUE0QjtBQUN4QyxXQUFLLE9BQU8sYUFBYSxDQUFDO0FBQUEsSUFDOUI7QUFDQSxRQUFJLGtCQUFpQixLQUFLLGdCQUFnQixTQUFTO0FBQy9DLG1CQUFhLGNBQWM7QUFDM0IsdUJBQWlCO0FBQUEsSUFDckI7QUFDQSxRQUFJLGtCQUNDLE1BQUssZ0JBQWdCLFdBQVcsS0FBSyxpQkFBaUIsV0FBVztBQUNsRSxtQkFBYSxlQUFlO0FBQUEsSUFDaEM7QUFDQSxTQUFLLE9BQU87QUFBQSxFQUNoQjtBQUNBLHlCQUF1QixHQUFHO0FBQ3RCLFFBQUksY0FBYyxlQUFlLENBQUM7QUFDbEMsUUFBSSxDQUFDLFlBQVksVUFBVSxRQUFRLE9BQU87QUFDdEMsd0JBQWtCLEdBQUcsWUFBWSxVQUFVLFNBQVMsU0FBUyxJQUFJLElBQUksRUFBRTtBQUFBLEVBQy9FO0FBQ0EsNkJBQTJCLEdBQUcsT0FBTyxXQUFXO0FBQzVDLFFBQUksU0FBUyxLQUFLLGVBQWUsQ0FBQztBQUNsQyxRQUFJLFFBQVEsYUFDUCxVQUFVLE9BQU8sY0FBYyxPQUFPLFdBQVc7QUFDdEQsUUFBSSxRQUFRLFlBQVksV0FBVztBQUNuQyxVQUFNLFFBQVE7QUFDZCxhQUFTLE1BQU0sY0FBYyxLQUFLO0FBQUEsRUFDdEM7QUFDQSxtQkFBaUI7QUFDYixRQUFJLFdBQVcsT0FBTyxTQUFTLHVCQUF1QjtBQUN0RCxTQUFLLG9CQUFvQixjQUFjLE9BQU8sb0JBQW9CO0FBQ2xFLFNBQUssa0JBQWtCLFdBQVc7QUFDbEMsUUFBSSxDQUFDLEtBQUssT0FBTyxZQUFZO0FBQ3pCLGVBQVMsWUFBWSxjQUFjLENBQUM7QUFDcEMsV0FBSyxpQkFBaUIsY0FBYyxPQUFPLDBCQUEwQjtBQUNyRSxVQUFJLEtBQUssT0FBTyxhQUFhO0FBQ3pCLFlBQUksS0FBSyxXQUFXLEdBQUcsY0FBYyxHQUFHLGFBQWEsY0FBYyxHQUFHO0FBQ3RFLGFBQUssZUFBZSxZQUFZLFdBQVc7QUFDM0MsYUFBSyxjQUFjO0FBQ25CLGFBQUssY0FBYztBQUFBLE1BQ3ZCO0FBQ0EsV0FBSyxhQUFhLGNBQWMsT0FBTyxzQkFBc0I7QUFDN0QsV0FBSyxXQUFXLFlBQVksY0FBYyxDQUFDO0FBQzNDLFVBQUksQ0FBQyxLQUFLLGVBQWU7QUFDckIsYUFBSyxnQkFBZ0IsY0FBYyxPQUFPLGdCQUFnQjtBQUMxRCxhQUFLLGNBQWMsV0FBVztBQUFBLE1BQ2xDO0FBQ0EsZ0JBQVU7QUFDVixXQUFLLFdBQVcsWUFBWSxLQUFLLGFBQWE7QUFDOUMsV0FBSyxlQUFlLFlBQVksS0FBSyxVQUFVO0FBQy9DLGVBQVMsWUFBWSxLQUFLLGNBQWM7QUFBQSxJQUM1QztBQUNBLFFBQUksS0FBSyxPQUFPLFlBQVk7QUFDeEIsZUFBUyxZQUFZLFVBQVUsQ0FBQztBQUFBLElBQ3BDO0FBQ0EsZ0JBQVksS0FBSyxtQkFBbUIsYUFBYSxLQUFLLE9BQU8sU0FBUyxPQUFPO0FBQzdFLGdCQUFZLEtBQUssbUJBQW1CLFdBQVcsS0FBSyxPQUFPLFlBQVksSUFBSTtBQUMzRSxnQkFBWSxLQUFLLG1CQUFtQixjQUFjLEtBQUssT0FBTyxhQUFhLENBQUM7QUFDNUUsU0FBSyxrQkFBa0IsWUFBWSxRQUFRO0FBQzNDLFFBQUksZUFBZSxLQUFLLE9BQU8sYUFBYSxVQUN4QyxLQUFLLE9BQU8sU0FBUyxhQUFhO0FBQ3RDLFFBQUksS0FBSyxPQUFPLFVBQVUsS0FBSyxPQUFPLFFBQVE7QUFDMUMsV0FBSyxrQkFBa0IsVUFBVSxJQUFJLEtBQUssT0FBTyxTQUFTLFdBQVcsUUFBUTtBQUM3RSxVQUFJLEtBQUssT0FBTyxRQUFRO0FBQ3BCLFlBQUksQ0FBQyxnQkFBZ0IsS0FBSyxRQUFRO0FBQzlCLGVBQUssUUFBUSxXQUFXLGFBQWEsS0FBSyxtQkFBbUIsS0FBSyxPQUFPLFdBQVc7QUFBQSxpQkFDL0UsS0FBSyxPQUFPLGFBQWE7QUFDOUIsZUFBSyxPQUFPLFNBQVMsWUFBWSxLQUFLLGlCQUFpQjtBQUFBLE1BQy9EO0FBQ0EsVUFBSSxLQUFLLE9BQU8sUUFBUTtBQUNwQixZQUFJLFVBQVUsY0FBYyxPQUFPLG1CQUFtQjtBQUN0RCxZQUFJLEtBQUssUUFBUTtBQUNiLGVBQUssUUFBUSxXQUFXLGFBQWEsU0FBUyxLQUFLLE9BQU87QUFDOUQsZ0JBQVEsWUFBWSxLQUFLLE9BQU87QUFDaEMsWUFBSSxLQUFLO0FBQ0wsa0JBQVEsWUFBWSxLQUFLLFFBQVE7QUFDckMsZ0JBQVEsWUFBWSxLQUFLLGlCQUFpQjtBQUFBLE1BQzlDO0FBQUEsSUFDSjtBQUNBLFFBQUksQ0FBQyxLQUFLLE9BQU8sVUFBVSxDQUFDLEtBQUssT0FBTztBQUNwQyxNQUFDLE1BQUssT0FBTyxhQUFhLFNBQ3BCLEtBQUssT0FBTyxXQUNaLE9BQU8sU0FBUyxNQUFNLFlBQVksS0FBSyxpQkFBaUI7QUFBQSxFQUN0RTtBQUNBLHFCQUFtQixXQUFXLE1BQU0sWUFBWSxHQUFHO0FBQy9DLFFBQUksZ0JBQWdCLFVBQVUsTUFBTSxJQUFJLEdBQUcsYUFBYSxjQUFjLFFBQVEsV0FBVyxLQUFLLFFBQVEsRUFBRSxTQUFTLENBQUM7QUFDbEgsZUFBVyxVQUFVO0FBQ3JCLGVBQVcsS0FBSztBQUNoQixlQUFXLGFBQWEsY0FBYyxLQUFLLFdBQVcsTUFBTSxLQUFLLE9BQU8sY0FBYyxDQUFDO0FBQ3ZGLFFBQUksVUFBVSxRQUFRLFFBQVEsTUFBTSxNQUNoQyxhQUFhLE1BQU0sS0FBSyxHQUFHLE1BQU0sR0FBRztBQUNwQyxXQUFLLGdCQUFnQjtBQUNyQixpQkFBVyxVQUFVLElBQUksT0FBTztBQUNoQyxpQkFBVyxhQUFhLGdCQUFnQixNQUFNO0FBQUEsSUFDbEQ7QUFDQSxRQUFJLGVBQWU7QUFDZixpQkFBVyxXQUFXO0FBQ3RCLFVBQUksZUFBZSxJQUFJLEdBQUc7QUFDdEIsbUJBQVcsVUFBVSxJQUFJLFVBQVU7QUFDbkMsYUFBSyxtQkFBbUI7QUFDeEIsWUFBSSxLQUFLLE9BQU8sU0FBUyxTQUFTO0FBQzlCLHNCQUFZLFlBQVksY0FBYyxLQUFLLGNBQWMsTUFDckQsYUFBYSxNQUFNLEtBQUssY0FBYyxJQUFJLElBQUksTUFBTSxDQUFDO0FBQ3pELHNCQUFZLFlBQVksWUFBWSxLQUFLLGNBQWMsTUFDbkQsYUFBYSxNQUFNLEtBQUssY0FBYyxJQUFJLElBQUksTUFBTSxDQUFDO0FBQ3pELGNBQUksY0FBYztBQUNkLHVCQUFXLFVBQVUsSUFBSSxTQUFTO0FBQUEsUUFDMUM7QUFBQSxNQUNKO0FBQUEsSUFDSixPQUNLO0FBQ0QsaUJBQVcsVUFBVSxJQUFJLG9CQUFvQjtBQUFBLElBQ2pEO0FBQ0EsUUFBSSxLQUFLLE9BQU8sU0FBUyxTQUFTO0FBQzlCLFVBQUksY0FBYyxJQUFJLEtBQUssQ0FBQyxlQUFlLElBQUk7QUFDM0MsbUJBQVcsVUFBVSxJQUFJLFNBQVM7QUFBQSxJQUMxQztBQUNBLFFBQUksS0FBSyxlQUNMLEtBQUssT0FBTyxlQUFlLEtBQzNCLGNBQWMsa0JBQ2QsSUFBSSxNQUFNLEdBQUc7QUFDYixXQUFLLFlBQVksbUJBQW1CLGFBQWEsaUNBQWlDLEtBQUssT0FBTyxRQUFRLElBQUksSUFBSSxTQUFTO0FBQUEsSUFDM0g7QUFDQSxpQkFBYSxlQUFlLFVBQVU7QUFDdEMsV0FBTztBQUFBLEVBQ1g7QUFDQSwwQkFBd0IsWUFBWTtBQUNoQyxlQUFXLE1BQU07QUFDakIsUUFBSSxLQUFLLE9BQU8sU0FBUztBQUNyQixrQkFBWSxVQUFVO0FBQUEsRUFDOUI7QUFDQSxnQ0FBOEIsT0FBTztBQUNqQyxRQUFJLGFBQWEsUUFBUSxJQUFJLElBQUksS0FBSyxPQUFPLGFBQWE7QUFDMUQsUUFBSSxXQUFXLFFBQVEsSUFBSSxLQUFLLE9BQU8sYUFBYTtBQUNwRCxhQUFTLElBQUksWUFBWSxLQUFLLFVBQVUsS0FBSyxPQUFPO0FBQ2hELFVBQUksUUFBUSxLQUFLLGNBQWMsU0FBUztBQUN4QyxVQUFJLGFBQWEsUUFBUSxJQUFJLElBQUksTUFBTSxTQUFTLFNBQVM7QUFDekQsVUFBSSxXQUFXLFFBQVEsSUFBSSxNQUFNLFNBQVMsU0FBUztBQUNuRCxlQUFTLElBQUksWUFBWSxLQUFLLFVBQVUsS0FBSyxPQUFPO0FBQ2hELFlBQUksSUFBSSxNQUFNLFNBQVM7QUFDdkIsWUFBSSxFQUFFLFVBQVUsUUFBUSxRQUFRLE1BQU0sTUFBTSxVQUFVLEVBQUUsT0FBTztBQUMzRCxpQkFBTztBQUFBLE1BQ2Y7QUFBQSxJQUNKO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFDQSwrQkFBNkIsU0FBUyxPQUFPO0FBQ3pDLFFBQUksYUFBYSxRQUFRLFVBQVUsUUFBUSxPQUFPLE1BQU0sS0FDbEQsUUFBUSxRQUFRLFNBQVMsSUFDekIsS0FBSztBQUNYLFFBQUksV0FBVyxRQUFRLElBQUksS0FBSyxPQUFPLGFBQWE7QUFDcEQsUUFBSSxZQUFZLFFBQVEsSUFBSSxJQUFJO0FBQ2hDLGFBQVMsSUFBSSxhQUFhLEtBQUssY0FBYyxLQUFLLFVBQVUsS0FBSyxXQUFXO0FBQ3hFLFVBQUksUUFBUSxLQUFLLGNBQWMsU0FBUztBQUN4QyxVQUFJLGFBQWEsYUFBYSxLQUFLLGlCQUFpQixJQUM5QyxRQUFRLEtBQUssUUFDYixRQUFRLElBQ0osTUFBTSxTQUFTLFNBQVMsSUFDeEI7QUFDVixVQUFJLGVBQWUsTUFBTSxTQUFTO0FBQ2xDLGVBQVMsSUFBSSxZQUFZLEtBQUssS0FBSyxJQUFJLGdCQUFnQixLQUFNLFNBQVEsSUFBSSxlQUFlLEtBQUssS0FBSyxXQUFXO0FBQ3pHLFlBQUksSUFBSSxNQUFNLFNBQVM7QUFDdkIsWUFBSSxFQUFFLFVBQVUsUUFBUSxRQUFRLE1BQU0sTUFDbEMsVUFBVSxFQUFFLE9BQU8sS0FDbkIsS0FBSyxJQUFJLFFBQVEsS0FBSyxDQUFDLEtBQUssS0FBSyxJQUFJLEtBQUs7QUFDMUMsaUJBQU8sZUFBZSxDQUFDO0FBQUEsTUFDL0I7QUFBQSxJQUNKO0FBQ0EsU0FBSyxZQUFZLFNBQVM7QUFDMUIsZUFBVyxxQkFBcUIsU0FBUyxHQUFHLENBQUM7QUFDN0MsV0FBTztBQUFBLEVBQ1g7QUFDQSxzQkFBb0IsU0FBUyxTQUFRO0FBQ2pDLFFBQUksZ0JBQWdCLHdCQUF3QjtBQUM1QyxRQUFJLGFBQWEsU0FBUyxpQkFBaUIsU0FBUyxJQUFJO0FBQ3hELFFBQUksWUFBWSxZQUFZLFNBQ3RCLFVBQ0EsYUFDSSxnQkFDQSxLQUFLLHFCQUFxQixVQUFhLFNBQVMsS0FBSyxnQkFBZ0IsSUFDakUsS0FBSyxtQkFDTCxLQUFLLGtCQUFrQixVQUFhLFNBQVMsS0FBSyxhQUFhLElBQzNELEtBQUssZ0JBQ0wscUJBQXFCLFVBQVMsSUFBSSxJQUFJLEVBQUU7QUFDMUQsUUFBSSxjQUFjLFFBQVc7QUFDekIsV0FBSyxPQUFPLE1BQU07QUFBQSxJQUN0QixXQUNTLENBQUMsWUFBWTtBQUNsQixxQkFBZSxTQUFTO0FBQUEsSUFDNUIsT0FDSztBQUNELDBCQUFvQixXQUFXLE9BQU07QUFBQSxJQUN6QztBQUFBLEVBQ0o7QUFDQSwwQkFBd0IsTUFBTSxPQUFPO0FBQ2pDLFFBQUksZUFBZ0IsS0FBSSxLQUFLLE1BQU0sT0FBTyxDQUFDLEVBQUUsT0FBTyxJQUFJLEtBQUssS0FBSyxpQkFBaUIsS0FBSztBQUN4RixRQUFJLGdCQUFnQixLQUFLLE1BQU0sZUFBZ0IsU0FBUSxJQUFJLE1BQU0sSUFBSSxJQUFJO0FBQ3pFLFFBQUksY0FBYyxLQUFLLE1BQU0sZUFBZSxPQUFPLElBQUksR0FBRyxPQUFPLE9BQU8sU0FBUyx1QkFBdUIsR0FBRyxlQUFlLEtBQUssT0FBTyxhQUFhLEdBQUcsb0JBQW9CLGVBQWUsd0JBQXdCLGdCQUFnQixvQkFBb0IsZUFBZSx3QkFBd0I7QUFDNVIsUUFBSSxZQUFZLGdCQUFnQixJQUFJLGNBQWMsV0FBVztBQUM3RCxXQUFPLGFBQWEsZUFBZSxhQUFhLFlBQVk7QUFDeEQsV0FBSyxZQUFZLFVBQVUsbUJBQW1CLG1CQUFtQixJQUFJLEtBQUssTUFBTSxRQUFRLEdBQUcsU0FBUyxHQUFHLFdBQVcsUUFBUSxDQUFDO0FBQUEsSUFDL0g7QUFDQSxTQUFLLFlBQVksR0FBRyxhQUFhLGFBQWEsYUFBYSxZQUFZO0FBQ25FLFdBQUssWUFBWSxVQUFVLGlCQUFpQixJQUFJLEtBQUssTUFBTSxPQUFPLFNBQVMsR0FBRyxXQUFXLFFBQVEsQ0FBQztBQUFBLElBQ3RHO0FBQ0EsYUFBUyxTQUFTLGNBQWMsR0FBRyxVQUFVLEtBQUssZ0JBQzdDLE1BQUssT0FBTyxlQUFlLEtBQUssV0FBVyxNQUFNLElBQUksVUFBVSxZQUFZO0FBQzVFLFdBQUssWUFBWSxVQUFVLG1CQUFtQixtQkFBbUIsSUFBSSxLQUFLLE1BQU0sUUFBUSxHQUFHLFNBQVMsV0FBVyxHQUFHLFFBQVEsUUFBUSxDQUFDO0FBQUEsSUFDdkk7QUFDQSxRQUFJLGVBQWUsY0FBYyxPQUFPLGNBQWM7QUFDdEQsaUJBQWEsWUFBWSxJQUFJO0FBQzdCLFdBQU87QUFBQSxFQUNYO0FBQ0EsdUJBQXFCO0FBQ2pCLFFBQUksS0FBSyxrQkFBa0IsUUFBVztBQUNsQztBQUFBLElBQ0o7QUFDQSxjQUFVLEtBQUssYUFBYTtBQUM1QixRQUFJLEtBQUs7QUFDTCxnQkFBVSxLQUFLLFdBQVc7QUFDOUIsUUFBSSxPQUFPLFNBQVMsdUJBQXVCO0FBQzNDLGFBQVMsSUFBSSxHQUFHLElBQUksS0FBSyxPQUFPLFlBQVksS0FBSztBQUM3QyxVQUFJLElBQUksSUFBSSxLQUFLLEtBQUssYUFBYSxLQUFLLGNBQWMsQ0FBQztBQUN2RCxRQUFFLFNBQVMsS0FBSyxlQUFlLENBQUM7QUFDaEMsV0FBSyxZQUFZLGVBQWUsRUFBRSxZQUFZLEdBQUcsRUFBRSxTQUFTLENBQUMsQ0FBQztBQUFBLElBQ2xFO0FBQ0EsU0FBSyxjQUFjLFlBQVksSUFBSTtBQUNuQyxTQUFLLE9BQU8sS0FBSyxjQUFjO0FBQy9CLFFBQUksS0FBSyxPQUFPLFNBQVMsV0FBVyxLQUFLLGNBQWMsV0FBVyxHQUFHO0FBQ2pFLGtCQUFZO0FBQUEsSUFDaEI7QUFBQSxFQUNKO0FBQ0EsOEJBQTRCO0FBQ3hCLFFBQUksS0FBSyxPQUFPLGFBQWEsS0FDekIsS0FBSyxPQUFPLHNCQUFzQjtBQUNsQztBQUNKLFFBQUksbUJBQW1CLFNBQVUsUUFBTztBQUNwQyxVQUFJLEtBQUssT0FBTyxZQUFZLFVBQ3hCLEtBQUssZ0JBQWdCLEtBQUssT0FBTyxRQUFRLFlBQVksS0FDckQsU0FBUSxLQUFLLE9BQU8sUUFBUSxTQUFTLEdBQUc7QUFDeEMsZUFBTztBQUFBLE1BQ1g7QUFDQSxhQUFPLENBQUUsTUFBSyxPQUFPLFlBQVksVUFDN0IsS0FBSyxnQkFBZ0IsS0FBSyxPQUFPLFFBQVEsWUFBWSxLQUNyRCxTQUFRLEtBQUssT0FBTyxRQUFRLFNBQVM7QUFBQSxJQUM3QztBQUNBLFNBQUssd0JBQXdCLFdBQVc7QUFDeEMsU0FBSyx3QkFBd0IsWUFBWTtBQUN6QyxhQUFTLElBQUksR0FBRyxJQUFJLElBQUksS0FBSztBQUN6QixVQUFJLENBQUMsaUJBQWlCLENBQUM7QUFDbkI7QUFDSixVQUFJLFFBQVEsY0FBYyxVQUFVLCtCQUErQjtBQUNuRSxZQUFNLFFBQVEsSUFBSSxLQUFLLEtBQUssYUFBYSxDQUFDLEVBQUUsU0FBUyxFQUFFLFNBQVM7QUFDaEUsWUFBTSxjQUFjLFdBQVcsR0FBRyxLQUFLLE9BQU8sdUJBQXVCLEtBQUssSUFBSTtBQUM5RSxZQUFNLFdBQVc7QUFDakIsVUFBSSxLQUFLLGlCQUFpQixHQUFHO0FBQ3pCLGNBQU0sV0FBVztBQUFBLE1BQ3JCO0FBQ0EsV0FBSyx3QkFBd0IsWUFBWSxLQUFLO0FBQUEsSUFDbEQ7QUFBQSxFQUNKO0FBQ0Esd0JBQXNCO0FBQ2xCLFFBQUksWUFBWSxjQUFjLE9BQU8saUJBQWlCO0FBQ3RELFFBQUksbUJBQW1CLE9BQU8sU0FBUyx1QkFBdUI7QUFDOUQsUUFBSTtBQUNKLFFBQUksS0FBSyxPQUFPLGFBQWEsS0FDekIsS0FBSyxPQUFPLHNCQUFzQixVQUFVO0FBQzVDLHFCQUFlLGNBQWMsUUFBUSxXQUFXO0FBQUEsSUFDcEQsT0FDSztBQUNELFdBQUssMEJBQTBCLGNBQWMsVUFBVSxnQ0FBZ0M7QUFDdkYsV0FBSyx3QkFBd0IsYUFBYSxjQUFjLEtBQUssS0FBSyxjQUFjO0FBQ2hGLFdBQUssS0FBSyx5QkFBeUIsVUFBVSxTQUFVLEdBQUc7QUFDdEQsWUFBSSxTQUFTLGVBQWUsQ0FBQztBQUM3QixZQUFJLGdCQUFnQixTQUFTLE9BQU8sT0FBTyxFQUFFO0FBQzdDLGFBQUssWUFBWSxnQkFBZ0IsS0FBSyxZQUFZO0FBQ2xELHFCQUFhLGVBQWU7QUFBQSxNQUNoQyxDQUFDO0FBQ0QsdUJBQWlCO0FBQ2pCLHFCQUFlLEtBQUs7QUFBQSxJQUN4QjtBQUNBLFFBQUksWUFBWSxrQkFBa0IsWUFBWSxFQUFFLFVBQVUsS0FBSyxDQUFDO0FBQ2hFLFFBQUksY0FBYyxVQUFVLHFCQUFxQixPQUFPLEVBQUU7QUFDMUQsZ0JBQVksYUFBYSxjQUFjLEtBQUssS0FBSyxhQUFhO0FBQzlELFFBQUksS0FBSyxPQUFPLFNBQVM7QUFDckIsa0JBQVksYUFBYSxPQUFPLEtBQUssT0FBTyxRQUFRLFlBQVksRUFBRSxTQUFTLENBQUM7QUFBQSxJQUNoRjtBQUNBLFFBQUksS0FBSyxPQUFPLFNBQVM7QUFDckIsa0JBQVksYUFBYSxPQUFPLEtBQUssT0FBTyxRQUFRLFlBQVksRUFBRSxTQUFTLENBQUM7QUFDNUUsa0JBQVksV0FDUixDQUFDLENBQUMsS0FBSyxPQUFPLFdBQ1YsS0FBSyxPQUFPLFFBQVEsWUFBWSxNQUFNLEtBQUssT0FBTyxRQUFRLFlBQVk7QUFBQSxJQUNsRjtBQUNBLFFBQUksZUFBZSxjQUFjLE9BQU8seUJBQXlCO0FBQ2pFLGlCQUFhLFlBQVksWUFBWTtBQUNyQyxpQkFBYSxZQUFZLFNBQVM7QUFDbEMscUJBQWlCLFlBQVksWUFBWTtBQUN6QyxjQUFVLFlBQVksZ0JBQWdCO0FBQ3RDLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNBLHlCQUF1QjtBQUNuQixjQUFVLEtBQUssUUFBUTtBQUN2QixTQUFLLFNBQVMsWUFBWSxLQUFLLFlBQVk7QUFDM0MsUUFBSSxLQUFLLE9BQU8sWUFBWTtBQUN4QixXQUFLLGVBQWUsQ0FBQztBQUNyQixXQUFLLGdCQUFnQixDQUFDO0FBQUEsSUFDMUI7QUFDQSxhQUFTLElBQUksS0FBSyxPQUFPLFlBQVksT0FBTTtBQUN2QyxVQUFJLFFBQVEsV0FBVztBQUN2QixXQUFLLGFBQWEsS0FBSyxNQUFNLFdBQVc7QUFDeEMsV0FBSyxjQUFjLEtBQUssTUFBTSxZQUFZO0FBQzFDLFdBQUssU0FBUyxZQUFZLE1BQU0sU0FBUztBQUFBLElBQzdDO0FBQ0EsU0FBSyxTQUFTLFlBQVksS0FBSyxZQUFZO0FBQUEsRUFDL0M7QUFDQSwyQkFBeUI7QUFDckIsU0FBSyxXQUFXLGNBQWMsT0FBTyxrQkFBa0I7QUFDdkQsU0FBSyxlQUFlLENBQUM7QUFDckIsU0FBSyxnQkFBZ0IsQ0FBQztBQUN0QixTQUFLLGVBQWUsY0FBYyxRQUFRLHNCQUFzQjtBQUNoRSxTQUFLLGFBQWEsWUFBWSxLQUFLLE9BQU87QUFDMUMsU0FBSyxlQUFlLGNBQWMsUUFBUSxzQkFBc0I7QUFDaEUsU0FBSyxhQUFhLFlBQVksS0FBSyxPQUFPO0FBQzFDLGdCQUFZO0FBQ1osV0FBTyxlQUFlLE1BQU0sdUJBQXVCO0FBQUEsTUFDL0MsS0FBSyxXQUFZO0FBQUUsZUFBTyxLQUFLO0FBQUEsTUFBc0I7QUFBQSxNQUNyRCxLQUFLLFNBQVUsTUFBTTtBQUNqQixZQUFJLEtBQUsseUJBQXlCLE1BQU07QUFDcEMsc0JBQVksS0FBSyxjQUFjLHNCQUFzQixJQUFJO0FBQ3pELGVBQUssdUJBQXVCO0FBQUEsUUFDaEM7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBQ0QsV0FBTyxlQUFlLE1BQU0sdUJBQXVCO0FBQUEsTUFDL0MsS0FBSyxXQUFZO0FBQUUsZUFBTyxLQUFLO0FBQUEsTUFBc0I7QUFBQSxNQUNyRCxLQUFLLFNBQVUsTUFBTTtBQUNqQixZQUFJLEtBQUsseUJBQXlCLE1BQU07QUFDcEMsc0JBQVksS0FBSyxjQUFjLHNCQUFzQixJQUFJO0FBQ3pELGVBQUssdUJBQXVCO0FBQUEsUUFDaEM7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBQ0QsU0FBSyxxQkFBcUIsS0FBSyxhQUFhO0FBQzVDLGlDQUE2QjtBQUM3QixXQUFPLEtBQUs7QUFBQSxFQUNoQjtBQUNBLHVCQUFxQjtBQUNqQixTQUFLLGtCQUFrQixVQUFVLElBQUksU0FBUztBQUM5QyxRQUFJLEtBQUssT0FBTztBQUNaLFdBQUssa0JBQWtCLFVBQVUsSUFBSSxZQUFZO0FBQ3JELFFBQUksWUFBVyxnQkFBZ0IsS0FBSyxNQUFNO0FBQzFDLFNBQUssZ0JBQWdCLGNBQWMsT0FBTyxnQkFBZ0I7QUFDMUQsU0FBSyxjQUFjLFdBQVc7QUFDOUIsUUFBSSxZQUFZLGNBQWMsUUFBUSw0QkFBNEIsR0FBRztBQUNyRSxRQUFJLFlBQVksa0JBQWtCLGtCQUFrQjtBQUFBLE1BQ2hELGNBQWMsS0FBSyxLQUFLO0FBQUEsSUFDNUIsQ0FBQztBQUNELFNBQUssY0FBYyxVQUFVLHFCQUFxQixPQUFPLEVBQUU7QUFDM0QsUUFBSSxjQUFjLGtCQUFrQixvQkFBb0I7QUFBQSxNQUNwRCxjQUFjLEtBQUssS0FBSztBQUFBLElBQzVCLENBQUM7QUFDRCxTQUFLLGdCQUFnQixZQUFZLHFCQUFxQixPQUFPLEVBQUU7QUFDL0QsU0FBSyxZQUFZLFdBQVcsS0FBSyxjQUFjLFdBQVc7QUFDMUQsU0FBSyxZQUFZLFFBQVEsSUFBSSxLQUFLLHdCQUM1QixLQUFLLHNCQUFzQixTQUFTLElBQ3BDLEtBQUssT0FBTyxZQUNSLFVBQVMsUUFDVCxjQUFjLFVBQVMsS0FBSyxDQUFDO0FBQ3ZDLFNBQUssY0FBYyxRQUFRLElBQUksS0FBSyx3QkFDOUIsS0FBSyxzQkFBc0IsV0FBVyxJQUN0QyxVQUFTLE9BQU87QUFDdEIsU0FBSyxZQUFZLGFBQWEsUUFBUSxLQUFLLE9BQU8sY0FBYyxTQUFTLENBQUM7QUFDMUUsU0FBSyxjQUFjLGFBQWEsUUFBUSxLQUFLLE9BQU8sZ0JBQWdCLFNBQVMsQ0FBQztBQUM5RSxTQUFLLFlBQVksYUFBYSxPQUFPLEtBQUssT0FBTyxZQUFZLE1BQU0sR0FBRztBQUN0RSxTQUFLLFlBQVksYUFBYSxPQUFPLEtBQUssT0FBTyxZQUFZLE9BQU8sSUFBSTtBQUN4RSxTQUFLLFlBQVksYUFBYSxhQUFhLEdBQUc7QUFDOUMsU0FBSyxjQUFjLGFBQWEsT0FBTyxHQUFHO0FBQzFDLFNBQUssY0FBYyxhQUFhLE9BQU8sSUFBSTtBQUMzQyxTQUFLLGNBQWMsYUFBYSxhQUFhLEdBQUc7QUFDaEQsU0FBSyxjQUFjLFlBQVksU0FBUztBQUN4QyxTQUFLLGNBQWMsWUFBWSxTQUFTO0FBQ3hDLFNBQUssY0FBYyxZQUFZLFdBQVc7QUFDMUMsUUFBSSxLQUFLLE9BQU87QUFDWixXQUFLLGNBQWMsVUFBVSxJQUFJLFVBQVU7QUFDL0MsUUFBSSxLQUFLLE9BQU8sZUFBZTtBQUMzQixXQUFLLGNBQWMsVUFBVSxJQUFJLFlBQVk7QUFDN0MsVUFBSSxjQUFjLGtCQUFrQixrQkFBa0I7QUFDdEQsV0FBSyxnQkFBZ0IsWUFBWSxxQkFBcUIsT0FBTyxFQUFFO0FBQy9ELFdBQUssY0FBYyxRQUFRLElBQUksS0FBSyx3QkFDOUIsS0FBSyxzQkFBc0IsV0FBVyxJQUN0QyxVQUFTLE9BQU87QUFDdEIsV0FBSyxjQUFjLGFBQWEsUUFBUSxLQUFLLGNBQWMsYUFBYSxNQUFNLENBQUM7QUFDL0UsV0FBSyxjQUFjLGFBQWEsT0FBTyxHQUFHO0FBQzFDLFdBQUssY0FBYyxhQUFhLE9BQU8sSUFBSTtBQUMzQyxXQUFLLGNBQWMsYUFBYSxhQUFhLEdBQUc7QUFDaEQsV0FBSyxjQUFjLFlBQVksY0FBYyxRQUFRLDRCQUE0QixHQUFHLENBQUM7QUFDckYsV0FBSyxjQUFjLFlBQVksV0FBVztBQUFBLElBQzlDO0FBQ0EsUUFBSSxDQUFDLEtBQUssT0FBTyxXQUFXO0FBQ3hCLFdBQUssT0FBTyxjQUFjLFFBQVEsbUJBQW1CLEtBQUssS0FBSyxLQUFLLElBQUssTUFBSyx3QkFDeEUsS0FBSyxZQUFZLFFBQ2pCLEtBQUssT0FBTyxlQUFlLEVBQUUsRUFBRTtBQUNyQyxXQUFLLEtBQUssUUFBUSxLQUFLLEtBQUs7QUFDNUIsV0FBSyxLQUFLLFdBQVc7QUFDckIsV0FBSyxjQUFjLFlBQVksS0FBSyxJQUFJO0FBQUEsSUFDNUM7QUFDQSxXQUFPLEtBQUs7QUFBQSxFQUNoQjtBQUNBLDJCQUF5QjtBQUNyQixRQUFJLENBQUMsS0FBSztBQUNOLFdBQUssbUJBQW1CLGNBQWMsT0FBTyxvQkFBb0I7QUFBQTtBQUVqRSxnQkFBVSxLQUFLLGdCQUFnQjtBQUNuQyxhQUFTLElBQUksS0FBSyxPQUFPLFlBQVksT0FBTTtBQUN2QyxVQUFJLFlBQVksY0FBYyxPQUFPLDRCQUE0QjtBQUNqRSxXQUFLLGlCQUFpQixZQUFZLFNBQVM7QUFBQSxJQUMvQztBQUNBLG1CQUFlO0FBQ2YsV0FBTyxLQUFLO0FBQUEsRUFDaEI7QUFDQSw0QkFBMEI7QUFDdEIsUUFBSSxDQUFDLEtBQUssa0JBQWtCO0FBQ3hCO0FBQUEsSUFDSjtBQUNBLFFBQUksaUJBQWlCLEtBQUssS0FBSztBQUMvQixRQUFJLFdBQVcsZUFBZSxLQUFLLEtBQUssU0FBUyxTQUFTO0FBQzFELFFBQUksaUJBQWlCLEtBQUssaUJBQWlCLFNBQVMsUUFBUTtBQUN4RCxpQkFBVyxlQUFlLFNBQVMsT0FBTyxnQkFBZ0IsU0FBUyxNQUFNLEdBQUcsU0FBUyxPQUFPLEdBQUcsY0FBYyxDQUFDO0FBQUEsSUFDbEg7QUFDQSxhQUFTLElBQUksS0FBSyxPQUFPLFlBQVksT0FBTTtBQUN2QyxXQUFLLGlCQUFpQixTQUFTLEdBQUcsWUFBWSx1REFBdUQsU0FBUyxLQUFLLHlDQUF5QyxJQUFJO0FBQUEsSUFDcEs7QUFBQSxFQUNKO0FBQ0Esd0JBQXNCO0FBQ2xCLFNBQUssa0JBQWtCLFVBQVUsSUFBSSxVQUFVO0FBQy9DLFFBQUksY0FBYyxjQUFjLE9BQU8sdUJBQXVCO0FBQzlELGdCQUFZLFlBQVksY0FBYyxRQUFRLHFCQUFxQixLQUFLLEtBQUssZ0JBQWdCLENBQUM7QUFDOUYsUUFBSSxjQUFjLGNBQWMsT0FBTyxpQkFBaUI7QUFDeEQsZ0JBQVksWUFBWSxXQUFXO0FBQ25DLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0EsdUJBQXFCLE9BQU8sVUFBVTtBQUNsQyxRQUFJLGFBQWEsUUFBUTtBQUFFLGlCQUFXO0FBQUEsSUFBTTtBQUM1QyxRQUFJLFFBQVEsV0FBVyxRQUFRLFFBQVEsS0FBSztBQUM1QyxRQUFLLFFBQVEsS0FBSyxLQUFLLHdCQUF3QixRQUMxQyxRQUFRLEtBQUssS0FBSyx3QkFBd0I7QUFDM0M7QUFDSixTQUFLLGdCQUFnQjtBQUNyQixRQUFJLEtBQUssZUFBZSxLQUFLLEtBQUssZUFBZSxJQUFJO0FBQ2pELFdBQUssZUFBZSxLQUFLLGVBQWUsS0FBSyxJQUFJO0FBQ2pELFdBQUssZUFBZ0IsTUFBSyxlQUFlLE1BQU07QUFDL0MsbUJBQWEsY0FBYztBQUMzQix1QkFBaUI7QUFBQSxJQUNyQjtBQUNBLGNBQVU7QUFDVixpQkFBYSxlQUFlO0FBQzVCLGlDQUE2QjtBQUFBLEVBQ2pDO0FBQ0EsaUJBQWUsb0JBQW9CLFdBQVc7QUFDMUMsUUFBSSx1QkFBdUIsUUFBUTtBQUFFLDJCQUFxQjtBQUFBLElBQU07QUFDaEUsUUFBSSxjQUFjLFFBQVE7QUFBRSxrQkFBWTtBQUFBLElBQU07QUFDOUMsU0FBSyxNQUFNLFFBQVE7QUFDbkIsUUFBSSxLQUFLLGFBQWE7QUFDbEIsV0FBSyxTQUFTLFFBQVE7QUFDMUIsUUFBSSxLQUFLLGdCQUFnQjtBQUNyQixXQUFLLFlBQVksUUFBUTtBQUM3QixTQUFLLGdCQUFnQixDQUFDO0FBQ3RCLFNBQUssd0JBQXdCO0FBQzdCLFFBQUksY0FBYyxNQUFNO0FBQ3BCLFdBQUssY0FBYyxLQUFLLGFBQWEsWUFBWTtBQUNqRCxXQUFLLGVBQWUsS0FBSyxhQUFhLFNBQVM7QUFBQSxJQUNuRDtBQUNBLFFBQUksS0FBSyxPQUFPLGVBQWUsTUFBTTtBQUNqQyxVQUFJLEtBQUssZ0JBQWdCLEtBQUssTUFBTSxHQUFHLFFBQVEsR0FBRyxPQUFPLFVBQVUsR0FBRyxTQUFTLFVBQVUsR0FBRztBQUM1RixlQUFTLE9BQU8sU0FBUyxPQUFPO0FBQUEsSUFDcEM7QUFDQSxTQUFLLE9BQU87QUFDWixRQUFJO0FBQ0EsbUJBQWEsVUFBVTtBQUFBLEVBQy9CO0FBQ0EsbUJBQWlCO0FBQ2IsU0FBSyxTQUFTO0FBQ2QsUUFBSSxDQUFDLEtBQUssVUFBVTtBQUNoQixVQUFJLEtBQUssc0JBQXNCLFFBQVc7QUFDdEMsYUFBSyxrQkFBa0IsVUFBVSxPQUFPLE1BQU07QUFBQSxNQUNsRDtBQUNBLFVBQUksS0FBSyxXQUFXLFFBQVc7QUFDM0IsYUFBSyxPQUFPLFVBQVUsT0FBTyxRQUFRO0FBQUEsTUFDekM7QUFBQSxJQUNKO0FBQ0EsaUJBQWEsU0FBUztBQUFBLEVBQzFCO0FBQ0EscUJBQW1CO0FBQ2YsUUFBSSxLQUFLLFdBQVc7QUFDaEIsbUJBQWEsV0FBVztBQUM1QixhQUFTLElBQUksS0FBSyxVQUFVLFFBQVEsT0FBTTtBQUN0QyxXQUFLLFVBQVUsR0FBRyxPQUFPO0FBQUEsSUFDN0I7QUFDQSxTQUFLLFlBQVksQ0FBQztBQUNsQixRQUFJLEtBQUssYUFBYTtBQUNsQixVQUFJLEtBQUssWUFBWTtBQUNqQixhQUFLLFlBQVksV0FBVyxZQUFZLEtBQUssV0FBVztBQUM1RCxXQUFLLGNBQWM7QUFBQSxJQUN2QixXQUNTLEtBQUsscUJBQXFCLEtBQUssa0JBQWtCLFlBQVk7QUFDbEUsVUFBSSxLQUFLLE9BQU8sVUFBVSxLQUFLLGtCQUFrQixZQUFZO0FBQ3pELFlBQUksVUFBVSxLQUFLLGtCQUFrQjtBQUNyQyxnQkFBUSxhQUFhLFFBQVEsWUFBWSxRQUFRLFNBQVM7QUFDMUQsWUFBSSxRQUFRLFlBQVk7QUFDcEIsaUJBQU8sUUFBUTtBQUNYLG9CQUFRLFdBQVcsYUFBYSxRQUFRLFlBQVksT0FBTztBQUMvRCxrQkFBUSxXQUFXLFlBQVksT0FBTztBQUFBLFFBQzFDO0FBQUEsTUFDSjtBQUVJLGFBQUssa0JBQWtCLFdBQVcsWUFBWSxLQUFLLGlCQUFpQjtBQUFBLElBQzVFO0FBQ0EsUUFBSSxLQUFLLFVBQVU7QUFDZixXQUFLLE1BQU0sT0FBTztBQUNsQixVQUFJLEtBQUssU0FBUztBQUNkLGFBQUssU0FBUyxXQUFXLFlBQVksS0FBSyxRQUFRO0FBQ3RELGFBQU8sS0FBSztBQUFBLElBQ2hCO0FBQ0EsUUFBSSxLQUFLLE9BQU87QUFDWixXQUFLLE1BQU0sT0FBTyxLQUFLLE1BQU07QUFDN0IsV0FBSyxNQUFNLFVBQVUsT0FBTyxpQkFBaUI7QUFDN0MsV0FBSyxNQUFNLGdCQUFnQixVQUFVO0FBQUEsSUFDekM7QUFDQTtBQUFBLE1BQ0k7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSixFQUFFLFFBQVEsU0FBVSxHQUFHO0FBQ25CLFVBQUk7QUFDQSxlQUFPLEtBQUs7QUFBQSxNQUNoQixTQUNPLEdBQVA7QUFBQSxNQUFZO0FBQUEsSUFDaEIsQ0FBQztBQUFBLEVBQ0w7QUFDQSwwQkFBd0IsTUFBTTtBQUMxQixXQUFPLEtBQUssa0JBQWtCLFNBQVMsSUFBSTtBQUFBLEVBQy9DO0FBQ0EseUJBQXVCLEdBQUc7QUFDdEIsUUFBSSxLQUFLLFVBQVUsQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUNwQyxVQUFJLGdCQUFnQixlQUFlLENBQUM7QUFDcEMsVUFBSSxvQkFBb0IsZUFBZSxhQUFhO0FBQ3BELFVBQUksVUFBVSxrQkFBa0IsS0FBSyxTQUNqQyxrQkFBa0IsS0FBSyxZQUN2QixLQUFLLFFBQVEsU0FBUyxhQUFhLEtBQ2xDLEVBQUUsUUFDQyxFQUFFLEtBQUssV0FDTixFQUFDLEVBQUUsS0FBSyxRQUFRLEtBQUssS0FBSyxLQUN2QixDQUFDLEVBQUUsS0FBSyxRQUFRLEtBQUssUUFBUTtBQUN6QyxVQUFJLFlBQVksQ0FBQyxXQUNiLENBQUMscUJBQ0QsQ0FBQyxlQUFlLEVBQUUsYUFBYTtBQUNuQyxVQUFJLFlBQVksQ0FBQyxLQUFLLE9BQU8scUJBQXFCLEtBQUssU0FBVSxNQUFNO0FBQ25FLGVBQU8sS0FBSyxTQUFTLGFBQWE7QUFBQSxNQUN0QyxDQUFDO0FBQ0QsVUFBSSxhQUFhLFdBQVc7QUFDeEIsWUFBSSxLQUFLLE9BQU8sWUFBWTtBQUN4QixlQUFLLFFBQVEsS0FBSyxPQUFPLE9BQU8sT0FBTyxLQUFLLE9BQU8sV0FDN0MsS0FBSyxPQUFPLFlBQ1osS0FBSyxPQUFPLFVBQVU7QUFBQSxRQUNoQztBQUNBLFlBQUksS0FBSyxrQkFBa0IsVUFDdkIsS0FBSyxrQkFBa0IsVUFDdkIsS0FBSyxnQkFBZ0IsVUFDckIsS0FBSyxNQUFNLFVBQVUsTUFDckIsS0FBSyxNQUFNLFVBQVUsUUFBVztBQUNoQyxxQkFBVztBQUFBLFFBQ2Y7QUFDQSxhQUFLLE1BQU07QUFDWCxZQUFJLEtBQUssVUFDTCxLQUFLLE9BQU8sU0FBUyxXQUNyQixLQUFLLGNBQWMsV0FBVztBQUM5QixlQUFLLE1BQU0sS0FBSztBQUFBLE1BQ3hCO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDQSxzQkFBb0IsU0FBUztBQUN6QixRQUFJLENBQUMsV0FDQSxLQUFLLE9BQU8sV0FBVyxVQUFVLEtBQUssT0FBTyxRQUFRLFlBQVksS0FDakUsS0FBSyxPQUFPLFdBQVcsVUFBVSxLQUFLLE9BQU8sUUFBUSxZQUFZO0FBQ2xFO0FBQ0osUUFBSSxhQUFhLFNBQVMsWUFBWSxLQUFLLGdCQUFnQjtBQUMzRCxTQUFLLGNBQWMsY0FBYyxLQUFLO0FBQ3RDLFFBQUksS0FBSyxPQUFPLFdBQ1osS0FBSyxnQkFBZ0IsS0FBSyxPQUFPLFFBQVEsWUFBWSxHQUFHO0FBQ3hELFdBQUssZUFBZSxLQUFLLElBQUksS0FBSyxPQUFPLFFBQVEsU0FBUyxHQUFHLEtBQUssWUFBWTtBQUFBLElBQ2xGLFdBQ1MsS0FBSyxPQUFPLFdBQ2pCLEtBQUssZ0JBQWdCLEtBQUssT0FBTyxRQUFRLFlBQVksR0FBRztBQUN4RCxXQUFLLGVBQWUsS0FBSyxJQUFJLEtBQUssT0FBTyxRQUFRLFNBQVMsR0FBRyxLQUFLLFlBQVk7QUFBQSxJQUNsRjtBQUNBLFFBQUksV0FBVztBQUNYLFdBQUssT0FBTztBQUNaLG1CQUFhLGNBQWM7QUFDM0IsdUJBQWlCO0FBQUEsSUFDckI7QUFBQSxFQUNKO0FBQ0EscUJBQW1CLE1BQU0sVUFBVTtBQUMvQixRQUFJO0FBQ0osUUFBSSxhQUFhLFFBQVE7QUFBRSxpQkFBVztBQUFBLElBQU07QUFDNUMsUUFBSSxjQUFjLEtBQUssVUFBVSxNQUFNLFFBQVcsUUFBUTtBQUMxRCxRQUFLLEtBQUssT0FBTyxXQUNiLGVBQ0EsYUFBYSxhQUFhLEtBQUssT0FBTyxTQUFTLGFBQWEsU0FBWSxXQUFXLENBQUMsS0FBSyxjQUFjLElBQUksS0FDMUcsS0FBSyxPQUFPLFdBQ1QsZUFDQSxhQUFhLGFBQWEsS0FBSyxPQUFPLFNBQVMsYUFBYSxTQUFZLFdBQVcsQ0FBQyxLQUFLLGNBQWMsSUFBSTtBQUMvRyxhQUFPO0FBQ1gsUUFBSSxDQUFDLEtBQUssT0FBTyxVQUFVLEtBQUssT0FBTyxRQUFRLFdBQVc7QUFDdEQsYUFBTztBQUNYLFFBQUksZ0JBQWdCO0FBQ2hCLGFBQU87QUFDWCxRQUFJLE9BQU8sQ0FBQyxDQUFDLEtBQUssT0FBTyxRQUFRLFFBQVMsTUFBSyxLQUFLLE9BQU8sWUFBWSxRQUFRLE9BQU8sU0FBUyxLQUFLLEtBQUssT0FBTztBQUNoSCxhQUFTLElBQUksR0FBRyxJQUFJLFFBQVEsSUFBSSxNQUFNLFFBQVEsS0FBSztBQUMvQyxVQUFJLE1BQU07QUFDVixVQUFJLE9BQU8sTUFBTSxjQUNiLEVBQUUsV0FBVztBQUNiLGVBQU87QUFBQSxlQUNGLGFBQWEsUUFDbEIsZ0JBQWdCLFVBQ2hCLEVBQUUsUUFBUSxNQUFNLFlBQVksUUFBUTtBQUNwQyxlQUFPO0FBQUEsZUFDRixPQUFPLE1BQU0sVUFBVTtBQUM1QixZQUFJLFNBQVMsS0FBSyxVQUFVLEdBQUcsUUFBVyxJQUFJO0FBQzlDLGVBQU8sVUFBVSxPQUFPLFFBQVEsTUFBTSxZQUFZLFFBQVEsSUFDcEQsT0FDQSxDQUFDO0FBQUEsTUFDWCxXQUNTLE9BQU8sTUFBTSxZQUNsQixnQkFBZ0IsVUFDaEIsRUFBRSxRQUNGLEVBQUUsTUFDRixZQUFZLFFBQVEsS0FBSyxFQUFFLEtBQUssUUFBUSxLQUN4QyxZQUFZLFFBQVEsS0FBSyxFQUFFLEdBQUcsUUFBUTtBQUN0QyxlQUFPO0FBQUEsSUFDZjtBQUNBLFdBQU8sQ0FBQztBQUFBLEVBQ1o7QUFDQSxvQkFBa0IsTUFBTTtBQUNwQixRQUFJLEtBQUssa0JBQWtCO0FBQ3ZCLGFBQVEsS0FBSyxVQUFVLFFBQVEsUUFBUSxNQUFNLE1BQ3pDLEtBQUssVUFBVSxRQUFRLG9CQUFvQixNQUFNLE1BQ2pELEtBQUssY0FBYyxTQUFTLElBQUk7QUFDeEMsV0FBTztBQUFBLEVBQ1g7QUFDQSxrQkFBZ0IsR0FBRztBQUNmLFFBQUksVUFBVSxFQUFFLFdBQVcsS0FBSztBQUNoQyxRQUFJLGVBQWUsS0FBSyxPQUFPLE1BQU0sUUFBUSxNQUFNLFdBQVc7QUFDOUQsUUFBSSxXQUNBLGdCQUNBLENBQUUsR0FBRSxpQkFBaUIsZUFBZSxFQUFFLGFBQWEsSUFBSTtBQUN2RCxXQUFLLFFBQVEsS0FBSyxPQUFPLE9BQU8sTUFBTSxFQUFFLFdBQVcsS0FBSyxXQUNsRCxLQUFLLE9BQU8sWUFDWixLQUFLLE9BQU8sVUFBVTtBQUFBLElBQ2hDO0FBQUEsRUFDSjtBQUNBLHFCQUFtQixHQUFHO0FBQ2xCLFFBQUksY0FBYyxlQUFlLENBQUM7QUFDbEMsUUFBSSxVQUFVLEtBQUssT0FBTyxPQUNwQixRQUFRLFNBQVMsV0FBVyxJQUM1QixnQkFBZ0IsS0FBSztBQUMzQixRQUFJLGFBQWEsS0FBSyxPQUFPO0FBQzdCLFFBQUksZUFBZSxLQUFLLFVBQVcsRUFBQyxjQUFjLENBQUM7QUFDbkQsUUFBSSxxQkFBcUIsS0FBSyxPQUFPLFVBQVUsV0FBVyxDQUFDO0FBQzNELFFBQUksRUFBRSxZQUFZLE1BQU0sU0FBUztBQUM3QixVQUFJLFlBQVk7QUFDWixhQUFLLFFBQVEsS0FBSyxPQUFPLE9BQU8sTUFBTSxnQkFBZ0IsS0FBSyxXQUNyRCxLQUFLLE9BQU8sWUFDWixLQUFLLE9BQU8sVUFBVTtBQUM1QixhQUFLLE1BQU07QUFDWCxlQUFPLFlBQVksS0FBSztBQUFBLE1BQzVCLE9BQ0s7QUFDRCxhQUFLLEtBQUs7QUFBQSxNQUNkO0FBQUEsSUFDSixXQUNTLGVBQWUsV0FBVyxLQUMvQixnQkFDQSxvQkFBb0I7QUFDcEIsVUFBSSxZQUFZLENBQUMsQ0FBQyxLQUFLLGlCQUNuQixLQUFLLGNBQWMsU0FBUyxXQUFXO0FBQzNDLGNBQVEsRUFBRTtBQUFBLGFBQ0Q7QUFDRCxjQUFJLFdBQVc7QUFDWCxjQUFFLGVBQWU7QUFDakIsdUJBQVc7QUFDWCwwQkFBYztBQUFBLFVBQ2xCO0FBRUksdUJBQVcsQ0FBQztBQUNoQjtBQUFBLGFBQ0M7QUFDRCxZQUFFLGVBQWU7QUFDakIsd0JBQWM7QUFDZDtBQUFBLGFBQ0M7QUFBQSxhQUNBO0FBQ0QsY0FBSSxXQUFXLENBQUMsS0FBSyxPQUFPLFlBQVk7QUFDcEMsY0FBRSxlQUFlO0FBQ2pCLGlCQUFLLE1BQU07QUFBQSxVQUNmO0FBQ0E7QUFBQSxhQUNDO0FBQUEsYUFDQTtBQUNELGNBQUksQ0FBQyxhQUFhLENBQUMsU0FBUztBQUN4QixjQUFFLGVBQWU7QUFDakIsZ0JBQUksZ0JBQWdCLHdCQUF3QjtBQUM1QyxnQkFBSSxLQUFLLGtCQUFrQixVQUN0QixnQkFBZSxTQUNYLGlCQUFpQixTQUFTLGFBQWEsSUFBSztBQUNqRCxrQkFBSSxVQUFVLEVBQUUsWUFBWSxLQUFLLElBQUk7QUFDckMsa0JBQUksQ0FBQyxFQUFFO0FBQ0gsMkJBQVcsUUFBVyxPQUFPO0FBQUEsbUJBQzVCO0FBQ0Qsa0JBQUUsZ0JBQWdCO0FBQ2xCLDRCQUFZLE9BQU87QUFDbkIsMkJBQVcscUJBQXFCLENBQUMsR0FBRyxDQUFDO0FBQUEsY0FDekM7QUFBQSxZQUNKO0FBQUEsVUFDSixXQUNTLEtBQUs7QUFDVixpQkFBSyxZQUFZLE1BQU07QUFDM0I7QUFBQSxhQUNDO0FBQUEsYUFDQTtBQUNELFlBQUUsZUFBZTtBQUNqQixjQUFJLFFBQVEsRUFBRSxZQUFZLEtBQUssSUFBSTtBQUNuQyxjQUFLLEtBQUssaUJBQ04sWUFBWSxPQUFPLFVBQ25CLGdCQUFnQixLQUFLLFNBQ3JCLGdCQUFnQixLQUFLLFVBQVU7QUFDL0IsZ0JBQUksRUFBRSxTQUFTO0FBQ1gsZ0JBQUUsZ0JBQWdCO0FBQ2xCLHlCQUFXLEtBQUssY0FBYyxLQUFLO0FBQ25DLHlCQUFXLHFCQUFxQixDQUFDLEdBQUcsQ0FBQztBQUFBLFlBQ3pDLFdBQ1MsQ0FBQztBQUNOLHlCQUFXLFFBQVcsUUFBUSxDQUFDO0FBQUEsVUFDdkMsV0FDUyxnQkFBZ0IsS0FBSyxvQkFBb0I7QUFDOUMsdUJBQVcsS0FBSyxjQUFjLEtBQUs7QUFBQSxVQUN2QyxXQUNTLEtBQUssT0FBTyxZQUFZO0FBQzdCLGdCQUFJLENBQUMsYUFBYSxLQUFLO0FBQ25CLG1CQUFLLFlBQVksTUFBTTtBQUMzQix1QkFBVyxDQUFDO0FBQ1osaUJBQUssaUJBQWlCO0FBQUEsVUFDMUI7QUFDQTtBQUFBLGFBQ0M7QUFDRCxjQUFJLFdBQVc7QUFDWCxnQkFBSSxRQUFRO0FBQUEsY0FDUixLQUFLO0FBQUEsY0FDTCxLQUFLO0FBQUEsY0FDTCxLQUFLO0FBQUEsY0FDTCxLQUFLO0FBQUEsWUFDVCxFQUNLLE9BQU8sS0FBSyxjQUFjLEVBQzFCLE9BQU8sU0FBVSxHQUFHO0FBQUUscUJBQU87QUFBQSxZQUFHLENBQUM7QUFDdEMsZ0JBQUksSUFBSSxNQUFNLFFBQVEsV0FBVztBQUNqQyxnQkFBSSxNQUFNLElBQUk7QUFDVixrQkFBSSxTQUFTLE1BQU0sSUFBSyxHQUFFLFdBQVcsS0FBSztBQUMxQyxnQkFBRSxlQUFlO0FBQ2pCLGNBQUMsV0FBVSxLQUFLLFFBQVEsTUFBTTtBQUFBLFlBQ2xDO0FBQUEsVUFDSixXQUNTLENBQUMsS0FBSyxPQUFPLGNBQ2xCLEtBQUssaUJBQ0wsS0FBSyxjQUFjLFNBQVMsV0FBVyxLQUN2QyxFQUFFLFVBQVU7QUFDWixjQUFFLGVBQWU7QUFDakIsaUJBQUssT0FBTyxNQUFNO0FBQUEsVUFDdEI7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUFBLElBRVo7QUFDQSxRQUFJLEtBQUssU0FBUyxVQUFhLGdCQUFnQixLQUFLLE1BQU07QUFDdEQsY0FBUSxFQUFFO0FBQUEsYUFDRCxLQUFLLEtBQUssS0FBSyxHQUFHLE9BQU8sQ0FBQztBQUFBLGFBQzFCLEtBQUssS0FBSyxLQUFLLEdBQUcsT0FBTyxDQUFDLEVBQUUsWUFBWTtBQUN6QyxlQUFLLEtBQUssY0FBYyxLQUFLLEtBQUssS0FBSztBQUN2Qyw2QkFBbUI7QUFDbkIsc0JBQVk7QUFDWjtBQUFBLGFBQ0MsS0FBSyxLQUFLLEtBQUssR0FBRyxPQUFPLENBQUM7QUFBQSxhQUMxQixLQUFLLEtBQUssS0FBSyxHQUFHLE9BQU8sQ0FBQyxFQUFFLFlBQVk7QUFDekMsZUFBSyxLQUFLLGNBQWMsS0FBSyxLQUFLLEtBQUs7QUFDdkMsNkJBQW1CO0FBQ25CLHNCQUFZO0FBQ1o7QUFBQTtBQUFBLElBRVo7QUFDQSxRQUFJLFdBQVcsZUFBZSxXQUFXLEdBQUc7QUFDeEMsbUJBQWEsYUFBYSxDQUFDO0FBQUEsSUFDL0I7QUFBQSxFQUNKO0FBQ0EsdUJBQXFCLE1BQU0sV0FBVztBQUNsQyxRQUFJLGNBQWMsUUFBUTtBQUFFLGtCQUFZO0FBQUEsSUFBaUI7QUFDekQsUUFBSSxLQUFLLGNBQWMsV0FBVyxLQUM3QixRQUNJLEVBQUMsS0FBSyxVQUFVLFNBQVMsU0FBUyxLQUMvQixLQUFLLFVBQVUsU0FBUyxvQkFBb0I7QUFDcEQ7QUFDSixRQUFJLFlBQVksT0FDVixLQUFLLFFBQVEsUUFBUSxJQUNyQixLQUFLLEtBQUssa0JBQWtCLFFBQVEsUUFBUSxHQUFHLGNBQWMsS0FBSyxVQUFVLEtBQUssY0FBYyxJQUFJLFFBQVcsSUFBSSxFQUFFLFFBQVEsR0FBRyxpQkFBaUIsS0FBSyxJQUFJLFdBQVcsS0FBSyxjQUFjLEdBQUcsUUFBUSxDQUFDLEdBQUcsZUFBZSxLQUFLLElBQUksV0FBVyxLQUFLLGNBQWMsR0FBRyxRQUFRLENBQUM7QUFDOVEsUUFBSSxtQkFBbUI7QUFDdkIsUUFBSSxXQUFXLEdBQUcsV0FBVztBQUM3QixhQUFTLElBQUksZ0JBQWdCLElBQUksY0FBYyxLQUFLLFNBQVMsS0FBSztBQUM5RCxVQUFJLENBQUMsVUFBVSxJQUFJLEtBQUssQ0FBQyxHQUFHLElBQUksR0FBRztBQUMvQiwyQkFDSSxvQkFBcUIsSUFBSSxrQkFBa0IsSUFBSTtBQUNuRCxZQUFJLElBQUksZUFBZ0IsRUFBQyxZQUFZLElBQUk7QUFDckMscUJBQVc7QUFBQSxpQkFDTixJQUFJLGVBQWdCLEVBQUMsWUFBWSxJQUFJO0FBQzFDLHFCQUFXO0FBQUEsTUFDbkI7QUFBQSxJQUNKO0FBQ0EsUUFBSSxpQkFBaUIsTUFBTSxLQUFLLEtBQUssV0FBVyxpQkFBaUIsb0JBQW9CLEtBQUssT0FBTyxhQUFhLFVBQVUsU0FBUyxDQUFDO0FBQ2xJLG1CQUFlLFFBQVEsU0FBVSxTQUFTO0FBQ3RDLFVBQUksT0FBTyxRQUFRO0FBQ25CLFVBQUksWUFBWSxLQUFLLFFBQVE7QUFDN0IsVUFBSSxhQUFjLFdBQVcsS0FBSyxZQUFZLFlBQ3pDLFdBQVcsS0FBSyxZQUFZO0FBQ2pDLFVBQUksWUFBWTtBQUNaLGdCQUFRLFVBQVUsSUFBSSxZQUFZO0FBQ2xDLFNBQUMsV0FBVyxjQUFjLFVBQVUsRUFBRSxRQUFRLFNBQVUsR0FBRztBQUN2RCxrQkFBUSxVQUFVLE9BQU8sQ0FBQztBQUFBLFFBQzlCLENBQUM7QUFDRDtBQUFBLE1BQ0osV0FDUyxvQkFBb0IsQ0FBQztBQUMxQjtBQUNKLE9BQUMsY0FBYyxXQUFXLFlBQVksWUFBWSxFQUFFLFFBQVEsU0FBVSxHQUFHO0FBQ3JFLGdCQUFRLFVBQVUsT0FBTyxDQUFDO0FBQUEsTUFDOUIsQ0FBQztBQUNELFVBQUksU0FBUyxRQUFXO0FBQ3BCLGFBQUssVUFBVSxJQUFJLGFBQWEsS0FBSyxjQUFjLEdBQUcsUUFBUSxJQUN4RCxlQUNBLFVBQVU7QUFDaEIsWUFBSSxjQUFjLGFBQWEsY0FBYztBQUN6QyxrQkFBUSxVQUFVLElBQUksWUFBWTtBQUFBLGlCQUM3QixjQUFjLGFBQWEsY0FBYztBQUM5QyxrQkFBUSxVQUFVLElBQUksVUFBVTtBQUNwQyxZQUFJLGFBQWEsWUFDWixjQUFhLEtBQUssYUFBYSxhQUNoQyxVQUFVLFdBQVcsYUFBYSxTQUFTO0FBQzNDLGtCQUFRLFVBQVUsSUFBSSxTQUFTO0FBQUEsTUFDdkM7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNMO0FBQ0Esc0JBQW9CO0FBQ2hCLFFBQUksS0FBSyxVQUFVLENBQUMsS0FBSyxPQUFPLFVBQVUsQ0FBQyxLQUFLLE9BQU87QUFDbkQsdUJBQWlCO0FBQUEsRUFDekI7QUFDQSxnQkFBYyxHQUFHLGlCQUFpQjtBQUM5QixRQUFJLG9CQUFvQixRQUFRO0FBQUUsd0JBQWtCLEtBQUs7QUFBQSxJQUFrQjtBQUMzRSxRQUFJLEtBQUssYUFBYSxNQUFNO0FBQ3hCLFVBQUksR0FBRztBQUNILFVBQUUsZUFBZTtBQUNqQixZQUFJLGNBQWMsZUFBZSxDQUFDO0FBQ2xDLFlBQUksYUFBYTtBQUNiLHNCQUFZLEtBQUs7QUFBQSxRQUNyQjtBQUFBLE1BQ0o7QUFDQSxVQUFJLEtBQUssZ0JBQWdCLFFBQVc7QUFDaEMsYUFBSyxZQUFZLE1BQU07QUFDdkIsYUFBSyxZQUFZLE1BQU07QUFBQSxNQUMzQjtBQUNBLG1CQUFhLFFBQVE7QUFDckI7QUFBQSxJQUNKLFdBQ1MsS0FBSyxPQUFPLFlBQVksS0FBSyxPQUFPLFFBQVE7QUFDakQ7QUFBQSxJQUNKO0FBQ0EsUUFBSSxVQUFVLEtBQUs7QUFDbkIsU0FBSyxTQUFTO0FBQ2QsUUFBSSxDQUFDLFNBQVM7QUFDVixXQUFLLGtCQUFrQixVQUFVLElBQUksTUFBTTtBQUMzQyxXQUFLLE9BQU8sVUFBVSxJQUFJLFFBQVE7QUFDbEMsbUJBQWEsUUFBUTtBQUNyQix1QkFBaUIsZUFBZTtBQUFBLElBQ3BDO0FBQ0EsUUFBSSxLQUFLLE9BQU8sZUFBZSxRQUFRLEtBQUssT0FBTyxlQUFlLE1BQU07QUFDcEUsVUFBSSxLQUFLLE9BQU8sZUFBZSxTQUMxQixPQUFNLFVBQ0gsQ0FBQyxLQUFLLGNBQWMsU0FBUyxFQUFFLGFBQWEsSUFBSTtBQUNwRCxtQkFBVyxXQUFZO0FBQUUsaUJBQU8sS0FBSyxZQUFZLE9BQU87QUFBQSxRQUFHLEdBQUcsRUFBRTtBQUFBLE1BQ3BFO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDQSw0QkFBMEIsTUFBTTtBQUM1QixXQUFPLFNBQVUsTUFBTTtBQUNuQixVQUFJLFVBQVcsS0FBSyxPQUFPLE1BQU0sT0FBTyxVQUFVLEtBQUssVUFBVSxNQUFNLEtBQUssT0FBTyxVQUFVO0FBQzdGLFVBQUksaUJBQWlCLEtBQUssT0FBTyxNQUFPLFVBQVMsUUFBUSxRQUFRLFNBQVM7QUFDMUUsVUFBSSxZQUFZLFFBQVc7QUFDdkIsYUFBSyxTQUFTLFFBQVEsbUJBQW1CLG9CQUNyQyxRQUFRLFNBQVMsSUFBSSxLQUNqQixRQUFRLFdBQVcsSUFBSSxLQUN2QixRQUFRLFdBQVcsSUFBSTtBQUFBLE1BQ25DO0FBQ0EsVUFBSSxLQUFLLGVBQWU7QUFDcEIsYUFBSyxnQkFBZ0IsS0FBSyxjQUFjLE9BQU8sU0FBVSxHQUFHO0FBQUUsaUJBQU8sVUFBVSxDQUFDO0FBQUEsUUFBRyxDQUFDO0FBQ3BGLFlBQUksQ0FBQyxLQUFLLGNBQWMsVUFBVSxTQUFTO0FBQ3ZDLDJCQUFpQixPQUFPO0FBQzVCLG9CQUFZO0FBQUEsTUFDaEI7QUFDQSxVQUFJLEtBQUssZUFBZTtBQUNwQixlQUFPO0FBQ1AsWUFBSSxZQUFZO0FBQ1osZUFBSyxtQkFBbUIsUUFBUSxRQUFRLFlBQVksRUFBRSxTQUFTO0FBQUE7QUFFL0QsZUFBSyxtQkFBbUIsZ0JBQWdCLElBQUk7QUFDaEQsYUFBSyxtQkFBbUIsV0FDcEIsQ0FBQyxDQUFDLGtCQUNFLFlBQVksVUFDWixlQUFlLFlBQVksTUFBTSxRQUFRLFlBQVk7QUFBQSxNQUNqRTtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0EseUJBQXVCO0FBQ25CLFFBQUksV0FBVztBQUFBLE1BQ1g7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUNBLFFBQUksYUFBYSxTQUFTLFNBQVMsQ0FBQyxHQUFHLEtBQUssTUFBTSxLQUFLLFVBQVUsUUFBUSxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxjQUFjO0FBQ3pHLFFBQUksV0FBVSxDQUFDO0FBQ2YsU0FBSyxPQUFPLFlBQVksV0FBVztBQUNuQyxTQUFLLE9BQU8sYUFBYSxXQUFXO0FBQ3BDLFdBQU8sZUFBZSxLQUFLLFFBQVEsVUFBVTtBQUFBLE1BQ3pDLEtBQUssV0FBWTtBQUFFLGVBQU8sS0FBSyxPQUFPO0FBQUEsTUFBUztBQUFBLE1BQy9DLEtBQUssU0FBVSxPQUFPO0FBQ2xCLGFBQUssT0FBTyxVQUFVLGVBQWUsS0FBSztBQUFBLE1BQzlDO0FBQUEsSUFDSixDQUFDO0FBQ0QsV0FBTyxlQUFlLEtBQUssUUFBUSxXQUFXO0FBQUEsTUFDMUMsS0FBSyxXQUFZO0FBQUUsZUFBTyxLQUFLLE9BQU87QUFBQSxNQUFVO0FBQUEsTUFDaEQsS0FBSyxTQUFVLE9BQU87QUFDbEIsYUFBSyxPQUFPLFdBQVcsZUFBZSxLQUFLO0FBQUEsTUFDL0M7QUFBQSxJQUNKLENBQUM7QUFDRCxRQUFJLFdBQVcsV0FBVyxTQUFTO0FBQ25DLFFBQUksQ0FBQyxXQUFXLGNBQWUsWUFBVyxjQUFjLFdBQVc7QUFDL0QsVUFBSSxvQkFBb0IsVUFBVSxjQUFjLGNBQWMsU0FBZTtBQUM3RSxlQUFRLGFBQ0osV0FBVyxjQUFjLFdBQ25CLFFBQVMsWUFBVyxnQkFBZ0IsT0FBTyxNQUMzQyxvQkFBb0IsU0FBVSxZQUFXLGdCQUFnQixPQUFPO0FBQUEsSUFDOUU7QUFDQSxRQUFJLFdBQVcsWUFDVixZQUFXLGNBQWMsYUFDMUIsQ0FBQyxXQUFXLFdBQVc7QUFDdkIsVUFBSSxtQkFBbUIsVUFBVSxjQUFjLGFBQWEsU0FBZTtBQUMzRSxlQUFRLFlBQ0osV0FBVyxjQUFjLFdBQ25CLFFBQVMsWUFBVyxnQkFBZ0IsU0FBUyxRQUM3QyxtQkFBb0IsVUFBVSxZQUFXLGdCQUFnQixPQUFPLE1BQU07QUFBQSxJQUNwRjtBQUNBLFdBQU8sZUFBZSxLQUFLLFFBQVEsV0FBVztBQUFBLE1BQzFDLEtBQUssV0FBWTtBQUFFLGVBQU8sS0FBSyxPQUFPO0FBQUEsTUFBVTtBQUFBLE1BQ2hELEtBQUssaUJBQWlCLEtBQUs7QUFBQSxJQUMvQixDQUFDO0FBQ0QsV0FBTyxlQUFlLEtBQUssUUFBUSxXQUFXO0FBQUEsTUFDMUMsS0FBSyxXQUFZO0FBQUUsZUFBTyxLQUFLLE9BQU87QUFBQSxNQUFVO0FBQUEsTUFDaEQsS0FBSyxpQkFBaUIsS0FBSztBQUFBLElBQy9CLENBQUM7QUFDRCxRQUFJLG1CQUFtQixTQUFVLE1BQU07QUFBRSxhQUFPLFNBQVUsS0FBSztBQUMzRCxhQUFLLE9BQU8sU0FBUyxRQUFRLGFBQWEsY0FBYyxLQUFLLFVBQVUsS0FBSyxPQUFPO0FBQUEsTUFDdkY7QUFBQSxJQUFHO0FBQ0gsV0FBTyxlQUFlLEtBQUssUUFBUSxXQUFXO0FBQUEsTUFDMUMsS0FBSyxXQUFZO0FBQUUsZUFBTyxLQUFLLE9BQU87QUFBQSxNQUFVO0FBQUEsTUFDaEQsS0FBSyxpQkFBaUIsS0FBSztBQUFBLElBQy9CLENBQUM7QUFDRCxXQUFPLGVBQWUsS0FBSyxRQUFRLFdBQVc7QUFBQSxNQUMxQyxLQUFLLFdBQVk7QUFBRSxlQUFPLEtBQUssT0FBTztBQUFBLE1BQVU7QUFBQSxNQUNoRCxLQUFLLGlCQUFpQixLQUFLO0FBQUEsSUFDL0IsQ0FBQztBQUNELFFBQUksV0FBVyxTQUFTLFFBQVE7QUFDNUIsV0FBSyxPQUFPLGFBQWE7QUFDekIsV0FBSyxPQUFPLGFBQWE7QUFBQSxJQUM3QjtBQUNBLFdBQU8sT0FBTyxLQUFLLFFBQVEsVUFBUyxVQUFVO0FBQzlDLGFBQVMsSUFBSSxHQUFHLElBQUksU0FBUyxRQUFRO0FBQ2pDLFdBQUssT0FBTyxTQUFTLE1BQ2pCLEtBQUssT0FBTyxTQUFTLFFBQVEsUUFDekIsS0FBSyxPQUFPLFNBQVMsUUFBUTtBQUN6QyxVQUFNLE9BQU8sU0FBVSxNQUFNO0FBQUUsYUFBTyxLQUFLLE9BQU8sVUFBVTtBQUFBLElBQVcsQ0FBQyxFQUFFLFFBQVEsU0FBVSxNQUFNO0FBQzlGLFdBQUssT0FBTyxRQUFRLFNBQVMsS0FBSyxPQUFPLFNBQVMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxjQUFjO0FBQUEsSUFDNUUsQ0FBQztBQUNELFNBQUssV0FDRCxDQUFDLEtBQUssT0FBTyxpQkFDVCxDQUFDLEtBQUssT0FBTyxVQUNiLEtBQUssT0FBTyxTQUFTLFlBQ3JCLENBQUMsS0FBSyxPQUFPLFFBQVEsVUFDckIsQ0FBQyxLQUFLLE9BQU8sVUFDYixDQUFDLEtBQUssT0FBTyxlQUNiLGlFQUFpRSxLQUFLLFVBQVUsU0FBUztBQUNqRyxhQUFTLElBQUksR0FBRyxJQUFJLEtBQUssT0FBTyxRQUFRLFFBQVEsS0FBSztBQUNqRCxVQUFJLGFBQWEsS0FBSyxPQUFPLFFBQVEsR0FBRyxJQUFJLEtBQUssQ0FBQztBQUNsRCxlQUFTLE9BQU8sWUFBWTtBQUN4QixZQUFJLE1BQU0sUUFBUSxHQUFHLElBQUksSUFBSTtBQUN6QixlQUFLLE9BQU8sT0FBTyxTQUFTLFdBQVcsSUFBSSxFQUN0QyxJQUFJLGNBQWMsRUFDbEIsT0FBTyxLQUFLLE9BQU8sSUFBSTtBQUFBLFFBQ2hDLFdBQ1MsT0FBTyxXQUFXLFNBQVM7QUFDaEMsZUFBSyxPQUFPLE9BQU8sV0FBVztBQUFBLE1BQ3RDO0FBQUEsSUFDSjtBQUNBLFFBQUksQ0FBQyxXQUFXLGVBQWU7QUFDM0IsV0FBSyxPQUFPLGdCQUNSLGFBQWEsRUFBRSxZQUFZLE1BQU0sS0FBSyxPQUFPO0FBQUEsSUFDckQ7QUFDQSxpQkFBYSxlQUFlO0FBQUEsRUFDaEM7QUFDQSwwQkFBd0I7QUFDcEIsV0FBTyxLQUFLLE9BQU8sT0FDYixRQUFRLGNBQWMsY0FBYyxJQUNwQztBQUFBLEVBQ1Y7QUFDQSx5QkFBdUI7QUFDbkIsUUFBSSxPQUFPLEtBQUssT0FBTyxXQUFXLFlBQzlCLE9BQU8sVUFBVSxNQUFNLEtBQUssT0FBTyxZQUFZO0FBQy9DLFdBQUssT0FBTyxhQUFhLElBQUksTUFBTSwrQkFBK0IsS0FBSyxPQUFPLE1BQU0sQ0FBQztBQUN6RixTQUFLLE9BQU8sU0FBUyxTQUFTLENBQUMsR0FBRyxVQUFVLE1BQU0sT0FBTyxHQUFJLE9BQU8sS0FBSyxPQUFPLFdBQVcsV0FDckYsS0FBSyxPQUFPLFNBQ1osS0FBSyxPQUFPLFdBQVcsWUFDbkIsVUFBVSxNQUFNLEtBQUssT0FBTyxVQUM1QixNQUFVO0FBQ3BCLGVBQVcsSUFBSSxNQUFNLEtBQUssS0FBSyxTQUFTLFVBQVUsS0FBSyxHQUFHLElBQUk7QUFDOUQsZUFBVyxJQUFJLE1BQU0sS0FBSyxLQUFLLFNBQVMsU0FBUyxLQUFLLEdBQUcsSUFBSTtBQUM3RCxlQUFXLElBQUksTUFBTSxLQUFLLEtBQUssT0FBTyxVQUFVLEtBQUssR0FBRyxJQUFJO0FBQzVELGVBQVcsSUFBSSxNQUFNLEtBQUssS0FBSyxPQUFPLFNBQVMsS0FBSyxHQUFHLElBQUk7QUFDM0QsZUFBVyxJQUFJLE1BQU0sS0FBSyxLQUFLLEtBQUssS0FBSyxNQUFNLEtBQUssS0FBSyxLQUFLLEtBQUssTUFBTSxLQUFLLEtBQUssS0FBSyxHQUFHLFlBQVksSUFBSSxNQUFNLEtBQUssS0FBSyxLQUFLLEdBQUcsWUFBWSxJQUFJO0FBQ25KLFFBQUksYUFBYSxTQUFTLFNBQVMsQ0FBQyxHQUFHLGNBQWMsR0FBRyxLQUFLLE1BQU0sS0FBSyxVQUFVLFFBQVEsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3pHLFFBQUksV0FBVyxjQUFjLFVBQ3pCLFVBQVUsY0FBYyxjQUFjLFFBQVc7QUFDakQsV0FBSyxPQUFPLFlBQVksS0FBSyxLQUFLO0FBQUEsSUFDdEM7QUFDQSxTQUFLLGFBQWEsb0JBQW9CLElBQUk7QUFDMUMsU0FBSyxZQUFZLGlCQUFpQixFQUFFLFFBQVEsS0FBSyxRQUFRLE1BQU0sS0FBSyxLQUFLLENBQUM7QUFBQSxFQUM5RTtBQUNBLDRCQUEwQix1QkFBdUI7QUFDN0MsUUFBSSxPQUFPLEtBQUssT0FBTyxhQUFhLFlBQVk7QUFDNUMsYUFBTyxLQUFLLEtBQUssT0FBTyxTQUFTLE1BQU0scUJBQXFCO0FBQUEsSUFDaEU7QUFDQSxRQUFJLEtBQUssc0JBQXNCO0FBQzNCO0FBQ0osaUJBQWEsdUJBQXVCO0FBQ3BDLFFBQUksa0JBQWtCLHlCQUF5QixLQUFLO0FBQ3BELFFBQUksaUJBQWlCLE1BQU0sVUFBVSxPQUFPLEtBQUssS0FBSyxrQkFBa0IsVUFBVyxTQUFVLEtBQUssT0FBTztBQUFFLGFBQU8sTUFBTSxNQUFNO0FBQUEsSUFBYyxHQUFJLENBQUMsR0FBRyxnQkFBZ0IsS0FBSyxrQkFBa0IsYUFBYSxZQUFZLEtBQUssT0FBTyxTQUFTLE1BQU0sR0FBRyxHQUFHLG9CQUFvQixVQUFVLElBQUksc0JBQXNCLFVBQVUsU0FBUyxJQUFJLFVBQVUsS0FBSyxNQUFNLGNBQWMsZ0JBQWdCLHNCQUFzQixHQUFHLHFCQUFxQixPQUFPLGNBQWMsWUFBWSxRQUFRLFlBQVksc0JBQXNCLFdBQzNlLHNCQUFzQixXQUNuQixxQkFBcUIsa0JBQ3JCLFlBQVksTUFBTTtBQUMxQixRQUFJLE9BQU0sT0FBTyxjQUNiLFlBQVksTUFDWCxFQUFDLFlBQVksZ0JBQWdCLGVBQWUsSUFBSSxDQUFDLGlCQUFpQjtBQUN2RSxnQkFBWSxLQUFLLG1CQUFtQixZQUFZLENBQUMsU0FBUztBQUMxRCxnQkFBWSxLQUFLLG1CQUFtQixlQUFlLFNBQVM7QUFDNUQsUUFBSSxLQUFLLE9BQU87QUFDWjtBQUNKLFFBQUksUUFBTyxPQUFPLGNBQWMsWUFBWTtBQUM1QyxRQUFJLFdBQVc7QUFDZixRQUFJLFVBQVU7QUFDZCxRQUFJLHdCQUF3QixVQUFVO0FBQ2xDLGVBQVMsaUJBQWdCLFlBQVksU0FBUztBQUM5QyxpQkFBVztBQUFBLElBQ2YsV0FDUyx3QkFBd0IsU0FBUztBQUN0QyxlQUFRLGdCQUFnQixZQUFZO0FBQ3BDLGdCQUFVO0FBQUEsSUFDZDtBQUNBLGdCQUFZLEtBQUssbUJBQW1CLGFBQWEsQ0FBQyxZQUFZLENBQUMsT0FBTztBQUN0RSxnQkFBWSxLQUFLLG1CQUFtQixlQUFlLFFBQVE7QUFDM0QsZ0JBQVksS0FBSyxtQkFBbUIsY0FBYyxPQUFPO0FBQ3pELFFBQUksU0FBUSxPQUFPLFNBQVMsS0FBSyxjQUM1QixRQUFPLGNBQWMsWUFBWTtBQUN0QyxRQUFJLFlBQVksUUFBTyxnQkFBZ0IsT0FBTyxTQUFTLEtBQUs7QUFDNUQsUUFBSSxhQUFhLFNBQVEsZ0JBQWdCLE9BQU8sU0FBUyxLQUFLO0FBQzlELGdCQUFZLEtBQUssbUJBQW1CLGFBQWEsU0FBUztBQUMxRCxRQUFJLEtBQUssT0FBTztBQUNaO0FBQ0osU0FBSyxrQkFBa0IsTUFBTSxNQUFNLE9BQU07QUFDekMsUUFBSSxDQUFDLFdBQVc7QUFDWixXQUFLLGtCQUFrQixNQUFNLE9BQU8sUUFBTztBQUMzQyxXQUFLLGtCQUFrQixNQUFNLFFBQVE7QUFBQSxJQUN6QyxXQUNTLENBQUMsWUFBWTtBQUNsQixXQUFLLGtCQUFrQixNQUFNLE9BQU87QUFDcEMsV0FBSyxrQkFBa0IsTUFBTSxRQUFRLFNBQVE7QUFBQSxJQUNqRCxPQUNLO0FBQ0QsVUFBSSxNQUFNLHNCQUFzQjtBQUNoQyxVQUFJLFFBQVE7QUFDUjtBQUNKLFVBQUksWUFBWSxPQUFPLFNBQVMsS0FBSztBQUNyQyxVQUFJLGFBQWEsS0FBSyxJQUFJLEdBQUcsWUFBWSxJQUFJLGdCQUFnQixDQUFDO0FBQzlELFVBQUksZUFBZTtBQUNuQixVQUFJLGNBQWM7QUFDbEIsVUFBSSxjQUFjLElBQUksU0FBUztBQUMvQixVQUFJLGNBQWMsV0FBVyxZQUFZLE9BQU87QUFDaEQsa0JBQVksS0FBSyxtQkFBbUIsYUFBYSxLQUFLO0FBQ3RELGtCQUFZLEtBQUssbUJBQW1CLGNBQWMsSUFBSTtBQUN0RCxVQUFJLFdBQVcsZUFBZSxNQUFNLGNBQWMsYUFBYSxXQUFXO0FBQzFFLFdBQUssa0JBQWtCLE1BQU0sT0FBTyxhQUFhO0FBQ2pELFdBQUssa0JBQWtCLE1BQU0sUUFBUTtBQUFBLElBQ3pDO0FBQUEsRUFDSjtBQUNBLG1DQUFpQztBQUM3QixRQUFJLGdCQUFnQjtBQUNwQixhQUFTLElBQUksR0FBRyxJQUFJLFNBQVMsWUFBWSxRQUFRLEtBQUs7QUFDbEQsVUFBSSxRQUFRLFNBQVMsWUFBWTtBQUNqQyxVQUFJLENBQUMsTUFBTTtBQUNQO0FBQ0osVUFBSTtBQUNBLGNBQU07QUFBQSxNQUNWLFNBQ08sS0FBUDtBQUNJO0FBQUEsTUFDSjtBQUNBLHNCQUFnQjtBQUNoQjtBQUFBLElBQ0o7QUFDQSxXQUFPLGlCQUFpQixPQUFPLGdCQUFnQixpQkFBaUI7QUFBQSxFQUNwRTtBQUNBLDhCQUE0QjtBQUN4QixRQUFJLFFBQVEsU0FBUyxjQUFjLE9BQU87QUFDMUMsYUFBUyxLQUFLLFlBQVksS0FBSztBQUMvQixXQUFPLE1BQU07QUFBQSxFQUNqQjtBQUNBLG9CQUFrQjtBQUNkLFFBQUksS0FBSyxPQUFPLGNBQWMsS0FBSztBQUMvQjtBQUNKLHFCQUFpQjtBQUNqQixpQ0FBNkI7QUFDN0IsY0FBVTtBQUFBLEVBQ2Q7QUFDQSwyQkFBeUI7QUFDckIsU0FBSyxPQUFPLE1BQU07QUFDbEIsUUFBSSxPQUFPLFVBQVUsVUFBVSxRQUFRLE1BQU0sTUFBTSxNQUMvQyxVQUFVLHFCQUFxQixRQUFXO0FBQzFDLGlCQUFXLEtBQUssT0FBTyxDQUFDO0FBQUEsSUFDNUIsT0FDSztBQUNELFdBQUssTUFBTTtBQUFBLElBQ2Y7QUFBQSxFQUNKO0FBQ0Esc0JBQW9CLEdBQUc7QUFDbkIsTUFBRSxlQUFlO0FBQ2pCLE1BQUUsZ0JBQWdCO0FBQ2xCLFFBQUksZUFBZSxTQUFVLEtBQUs7QUFDOUIsYUFBTyxJQUFJLGFBQ1AsSUFBSSxVQUFVLFNBQVMsZUFBZSxLQUN0QyxDQUFDLElBQUksVUFBVSxTQUFTLG9CQUFvQixLQUM1QyxDQUFDLElBQUksVUFBVSxTQUFTLFlBQVk7QUFBQSxJQUM1QztBQUNBLFFBQUksSUFBSSxXQUFXLGVBQWUsQ0FBQyxHQUFHLFlBQVk7QUFDbEQsUUFBSSxNQUFNO0FBQ047QUFDSixRQUFJLFNBQVM7QUFDYixRQUFJLGVBQWdCLEtBQUssd0JBQXdCLElBQUksS0FBSyxPQUFPLFFBQVEsUUFBUSxDQUFDO0FBQ2xGLFFBQUksb0JBQXFCLGNBQWEsU0FBUyxJQUFJLEtBQUssZ0JBQ3BELGFBQWEsU0FBUyxJQUNsQixLQUFLLGVBQWUsS0FBSyxPQUFPLGFBQWEsTUFDakQsS0FBSyxPQUFPLFNBQVM7QUFDekIsU0FBSyxtQkFBbUI7QUFDeEIsUUFBSSxLQUFLLE9BQU8sU0FBUztBQUNyQixXQUFLLGdCQUFnQixDQUFDLFlBQVk7QUFBQSxhQUM3QixLQUFLLE9BQU8sU0FBUyxZQUFZO0FBQ3RDLFVBQUksZ0JBQWdCLGVBQWUsWUFBWTtBQUMvQyxVQUFJO0FBQ0EsYUFBSyxjQUFjLE9BQU8sU0FBUyxhQUFhLEdBQUcsQ0FBQztBQUFBO0FBRXBELGFBQUssY0FBYyxLQUFLLFlBQVk7QUFBQSxJQUM1QyxXQUNTLEtBQUssT0FBTyxTQUFTLFNBQVM7QUFDbkMsVUFBSSxLQUFLLGNBQWMsV0FBVyxHQUFHO0FBQ2pDLGFBQUssTUFBTSxPQUFPLEtBQUs7QUFBQSxNQUMzQjtBQUNBLFdBQUssd0JBQXdCO0FBQzdCLFdBQUssY0FBYyxLQUFLLFlBQVk7QUFDcEMsVUFBSSxhQUFhLGNBQWMsS0FBSyxjQUFjLElBQUksSUFBSSxNQUFNO0FBQzVELGFBQUssY0FBYyxLQUFLLFNBQVUsR0FBRyxHQUFHO0FBQUUsaUJBQU8sRUFBRSxRQUFRLElBQUksRUFBRSxRQUFRO0FBQUEsUUFBRyxDQUFDO0FBQUEsSUFDckY7QUFDQSx1QkFBbUI7QUFDbkIsUUFBSSxtQkFBbUI7QUFDbkIsVUFBSSxZQUFZLEtBQUssZ0JBQWdCLGFBQWEsWUFBWTtBQUM5RCxXQUFLLGNBQWMsYUFBYSxZQUFZO0FBQzVDLFdBQUssZUFBZSxhQUFhLFNBQVM7QUFDMUMsVUFBSSxXQUFXO0FBQ1gscUJBQWEsY0FBYztBQUMzQix5QkFBaUI7QUFBQSxNQUNyQjtBQUNBLG1CQUFhLGVBQWU7QUFBQSxJQUNoQztBQUNBLGlDQUE2QjtBQUM3QixjQUFVO0FBQ1YsZ0JBQVk7QUFDWixRQUFJLENBQUMscUJBQ0QsS0FBSyxPQUFPLFNBQVMsV0FDckIsS0FBSyxPQUFPLGVBQWU7QUFDM0IscUJBQWUsTUFBTTtBQUFBLGFBQ2hCLEtBQUsscUJBQXFCLFVBQy9CLEtBQUssZ0JBQWdCLFFBQVc7QUFDaEMsV0FBSyxvQkFBb0IsS0FBSyxpQkFBaUIsTUFBTTtBQUFBLElBQ3pEO0FBQ0EsUUFBSSxLQUFLLGdCQUFnQjtBQUNyQixXQUFLLGdCQUFnQixVQUFhLEtBQUssWUFBWSxNQUFNO0FBQzdELFFBQUksS0FBSyxPQUFPLGVBQWU7QUFDM0IsVUFBSSxTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksQ0FBQyxLQUFLLE9BQU87QUFDM0QsVUFBSSxRQUFRLEtBQUssT0FBTyxTQUFTLFdBQzdCLEtBQUssY0FBYyxXQUFXLEtBQzlCLENBQUMsS0FBSyxPQUFPO0FBQ2pCLFVBQUksVUFBVSxPQUFPO0FBQ2pCLHNCQUFjO0FBQUEsTUFDbEI7QUFBQSxJQUNKO0FBQ0Esa0JBQWM7QUFBQSxFQUNsQjtBQUNBLE1BQUksWUFBWTtBQUFBLElBQ1osUUFBUSxDQUFDLGFBQWEsY0FBYztBQUFBLElBQ3BDLFlBQVksQ0FBQyxhQUFhLGtCQUFrQixhQUFhO0FBQUEsSUFDekQsU0FBUyxDQUFDLFVBQVU7QUFBQSxJQUNwQixTQUFTLENBQUMsVUFBVTtBQUFBLElBQ3BCLGlCQUFpQixDQUFDLHFCQUFxQjtBQUFBLElBQ3ZDLFlBQVk7QUFBQSxNQUNSLFdBQVk7QUFDUixZQUFJLEtBQUssT0FBTyxlQUFlLE1BQU07QUFDakMsZUFBSyxLQUFLLFFBQVEsU0FBUyxLQUFLLElBQUk7QUFDcEMsZUFBSyxLQUFLLFFBQVEsU0FBUyxLQUFLLElBQUk7QUFBQSxRQUN4QyxPQUNLO0FBQ0QsZUFBSyxPQUFPLG9CQUFvQixTQUFTLEtBQUssSUFBSTtBQUNsRCxlQUFLLE9BQU8sb0JBQW9CLFNBQVMsS0FBSyxJQUFJO0FBQUEsUUFDdEQ7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDQSxlQUFhLFFBQVEsT0FBTztBQUN4QixRQUFJLFdBQVcsUUFBUSxPQUFPLFdBQVcsVUFBVTtBQUMvQyxhQUFPLE9BQU8sS0FBSyxRQUFRLE1BQU07QUFDakMsZUFBUyxPQUFPLFFBQVE7QUFDcEIsWUFBSSxVQUFVLFNBQVM7QUFDbkIsb0JBQVUsS0FBSyxRQUFRLFNBQVUsR0FBRztBQUFFLG1CQUFPLEVBQUU7QUFBQSxVQUFHLENBQUM7QUFBQSxNQUMzRDtBQUFBLElBQ0osT0FDSztBQUNELFdBQUssT0FBTyxVQUFVO0FBQ3RCLFVBQUksVUFBVSxZQUFZO0FBQ3RCLGtCQUFVLFFBQVEsUUFBUSxTQUFVLEdBQUc7QUFBRSxpQkFBTyxFQUFFO0FBQUEsUUFBRyxDQUFDO0FBQUEsZUFDakQsTUFBTSxRQUFRLE1BQU0sSUFBSTtBQUM3QixhQUFLLE9BQU8sVUFBVSxTQUFTLEtBQUs7QUFBQSxJQUM1QztBQUNBLFNBQUssT0FBTztBQUNaLGdCQUFZLElBQUk7QUFBQSxFQUNwQjtBQUNBLDJCQUF5QixXQUFXLFNBQVE7QUFDeEMsUUFBSSxRQUFRLENBQUM7QUFDYixRQUFJLHFCQUFxQjtBQUNyQixjQUFRLFVBQVUsSUFBSSxTQUFVLEdBQUc7QUFBRSxlQUFPLEtBQUssVUFBVSxHQUFHLE9BQU07QUFBQSxNQUFHLENBQUM7QUFBQSxhQUNuRSxxQkFBcUIsUUFBUSxPQUFPLGNBQWM7QUFDdkQsY0FBUSxDQUFDLEtBQUssVUFBVSxXQUFXLE9BQU0sQ0FBQztBQUFBLGFBQ3JDLE9BQU8sY0FBYyxVQUFVO0FBQ3BDLGNBQVEsS0FBSyxPQUFPO0FBQUEsYUFDWDtBQUFBLGFBQ0E7QUFDRCxrQkFBUSxDQUFDLEtBQUssVUFBVSxXQUFXLE9BQU0sQ0FBQztBQUMxQztBQUFBLGFBQ0M7QUFDRCxrQkFBUSxVQUNILE1BQU0sS0FBSyxPQUFPLFdBQVcsRUFDN0IsSUFBSSxTQUFVLE1BQU07QUFBRSxtQkFBTyxLQUFLLFVBQVUsTUFBTSxPQUFNO0FBQUEsVUFBRyxDQUFDO0FBQ2pFO0FBQUEsYUFDQztBQUNELGtCQUFRLFVBQ0gsTUFBTSxLQUFLLEtBQUssY0FBYyxFQUM5QixJQUFJLFNBQVUsTUFBTTtBQUFFLG1CQUFPLEtBQUssVUFBVSxNQUFNLE9BQU07QUFBQSxVQUFHLENBQUM7QUFDakU7QUFBQTtBQUVBO0FBQUE7QUFBQSxJQUVaO0FBRUksV0FBSyxPQUFPLGFBQWEsSUFBSSxNQUFNLDRCQUE0QixLQUFLLFVBQVUsU0FBUyxDQUFDLENBQUM7QUFDN0YsU0FBSyxnQkFBaUIsS0FBSyxPQUFPLHNCQUM1QixRQUNBLE1BQU0sT0FBTyxTQUFVLEdBQUc7QUFBRSxhQUFPLGFBQWEsUUFBUSxVQUFVLEdBQUcsS0FBSztBQUFBLElBQUcsQ0FBQztBQUNwRixRQUFJLEtBQUssT0FBTyxTQUFTO0FBQ3JCLFdBQUssY0FBYyxLQUFLLFNBQVUsR0FBRyxHQUFHO0FBQUUsZUFBTyxFQUFFLFFBQVEsSUFBSSxFQUFFLFFBQVE7QUFBQSxNQUFHLENBQUM7QUFBQSxFQUNyRjtBQUNBLG1CQUFpQixNQUFNLGdCQUFlLFNBQVE7QUFDMUMsUUFBSSxtQkFBa0IsUUFBUTtBQUFFLHVCQUFnQjtBQUFBLElBQU87QUFDdkQsUUFBSSxZQUFXLFFBQVE7QUFBRSxnQkFBUyxLQUFLLE9BQU87QUFBQSxJQUFZO0FBQzFELFFBQUssU0FBUyxLQUFLLENBQUMsUUFBVSxnQkFBZ0IsU0FBUyxLQUFLLFdBQVc7QUFDbkUsYUFBTyxLQUFLLE1BQU0sY0FBYTtBQUNuQyxvQkFBZ0IsTUFBTSxPQUFNO0FBQzVCLFNBQUssd0JBQ0QsS0FBSyxjQUFjLEtBQUssY0FBYyxTQUFTO0FBQ25ELFNBQUssT0FBTztBQUNaLGVBQVcsUUFBVyxjQUFhO0FBQ25DLHFCQUFpQjtBQUNqQixRQUFJLEtBQUssY0FBYyxXQUFXLEdBQUc7QUFDakMsV0FBSyxNQUFNLEtBQUs7QUFBQSxJQUNwQjtBQUNBLGdCQUFZLGNBQWE7QUFDekIsUUFBSTtBQUNBLG1CQUFhLFVBQVU7QUFBQSxFQUMvQjtBQUNBLDBCQUF3QixLQUFLO0FBQ3pCLFdBQU8sSUFDRixNQUFNLEVBQ04sSUFBSSxTQUFVLE1BQU07QUFDckIsVUFBSSxPQUFPLFNBQVMsWUFDaEIsT0FBTyxTQUFTLFlBQ2hCLGdCQUFnQixNQUFNO0FBQ3RCLGVBQU8sS0FBSyxVQUFVLE1BQU0sUUFBVyxJQUFJO0FBQUEsTUFDL0MsV0FDUyxRQUNMLE9BQU8sU0FBUyxZQUNoQixLQUFLLFFBQ0wsS0FBSztBQUNMLGVBQU87QUFBQSxVQUNILE1BQU0sS0FBSyxVQUFVLEtBQUssTUFBTSxNQUFTO0FBQUEsVUFDekMsSUFBSSxLQUFLLFVBQVUsS0FBSyxJQUFJLE1BQVM7QUFBQSxRQUN6QztBQUNKLGFBQU87QUFBQSxJQUNYLENBQUMsRUFDSSxPQUFPLFNBQVUsR0FBRztBQUFFLGFBQU87QUFBQSxJQUFHLENBQUM7QUFBQSxFQUMxQztBQUNBLHdCQUFzQjtBQUNsQixTQUFLLGdCQUFnQixDQUFDO0FBQ3RCLFNBQUssTUFBTSxLQUFLLFVBQVUsS0FBSyxPQUFPLEdBQUcsS0FBSyxJQUFJLEtBQUs7QUFDdkQsUUFBSSxnQkFBZ0IsS0FBSyxPQUFPLGVBQzFCLE9BQUssTUFBTSxhQUFhLFdBQ3RCLEtBQUssTUFBTSxhQUFhLGVBQ3hCLEtBQUssTUFBTSxlQUNYLEtBQUssTUFBTSxVQUFVLEtBQUssTUFBTSxjQUM5QixPQUNBLEtBQUssTUFBTTtBQUNyQixRQUFJO0FBQ0Esc0JBQWdCLGVBQWUsS0FBSyxPQUFPLFVBQVU7QUFDekQsU0FBSyxlQUNELEtBQUssY0FBYyxTQUFTLElBQ3RCLEtBQUssY0FBYyxLQUNuQixLQUFLLE9BQU8sV0FDVixLQUFLLE9BQU8sUUFBUSxRQUFRLElBQUksS0FBSyxJQUFJLFFBQVEsSUFDL0MsS0FBSyxPQUFPLFVBQ1osS0FBSyxPQUFPLFdBQ1YsS0FBSyxPQUFPLFFBQVEsUUFBUSxJQUFJLEtBQUssSUFBSSxRQUFRLElBQy9DLEtBQUssT0FBTyxVQUNaLEtBQUs7QUFDdkIsU0FBSyxjQUFjLEtBQUssYUFBYSxZQUFZO0FBQ2pELFNBQUssZUFBZSxLQUFLLGFBQWEsU0FBUztBQUMvQyxRQUFJLEtBQUssY0FBYyxTQUFTO0FBQzVCLFdBQUssd0JBQXdCLEtBQUssY0FBYztBQUNwRCxRQUFJLEtBQUssT0FBTyxZQUFZO0FBQ3hCLFdBQUssT0FBTyxVQUFVLEtBQUssVUFBVSxLQUFLLE9BQU8sU0FBUyxLQUFLO0FBQ25FLFFBQUksS0FBSyxPQUFPLFlBQVk7QUFDeEIsV0FBSyxPQUFPLFVBQVUsS0FBSyxVQUFVLEtBQUssT0FBTyxTQUFTLEtBQUs7QUFDbkUsU0FBSyxpQkFDRCxDQUFDLENBQUMsS0FBSyxPQUFPLFdBQ1QsTUFBSyxPQUFPLFFBQVEsU0FBUyxJQUFJLEtBQzlCLEtBQUssT0FBTyxRQUFRLFdBQVcsSUFBSSxLQUNuQyxLQUFLLE9BQU8sUUFBUSxXQUFXLElBQUk7QUFDL0MsU0FBSyxpQkFDRCxDQUFDLENBQUMsS0FBSyxPQUFPLFdBQ1QsTUFBSyxPQUFPLFFBQVEsU0FBUyxJQUFJLEtBQzlCLEtBQUssT0FBTyxRQUFRLFdBQVcsSUFBSSxLQUNuQyxLQUFLLE9BQU8sUUFBUSxXQUFXLElBQUk7QUFBQSxFQUNuRDtBQUNBLHlCQUF1QjtBQUNuQixTQUFLLFFBQVEsYUFBYTtBQUMxQixRQUFJLENBQUMsS0FBSyxPQUFPO0FBQ2IsV0FBSyxPQUFPLGFBQWEsSUFBSSxNQUFNLGlDQUFpQyxDQUFDO0FBQ3JFO0FBQUEsSUFDSjtBQUNBLFNBQUssTUFBTSxRQUFRLEtBQUssTUFBTTtBQUM5QixTQUFLLE1BQU0sT0FBTztBQUNsQixTQUFLLE1BQU0sVUFBVSxJQUFJLGlCQUFpQjtBQUMxQyxTQUFLLFNBQVMsS0FBSztBQUNuQixRQUFJLEtBQUssT0FBTyxVQUFVO0FBQ3RCLFdBQUssV0FBVyxjQUFjLEtBQUssTUFBTSxVQUFVLEtBQUssT0FBTyxhQUFhO0FBQzVFLFdBQUssU0FBUyxLQUFLO0FBQ25CLFdBQUssU0FBUyxjQUFjLEtBQUssTUFBTTtBQUN2QyxXQUFLLFNBQVMsV0FBVyxLQUFLLE1BQU07QUFDcEMsV0FBSyxTQUFTLFdBQVcsS0FBSyxNQUFNO0FBQ3BDLFdBQUssU0FBUyxXQUFXLEtBQUssTUFBTTtBQUNwQyxXQUFLLFNBQVMsT0FBTztBQUNyQixXQUFLLE1BQU0sYUFBYSxRQUFRLFFBQVE7QUFDeEMsVUFBSSxDQUFDLEtBQUssT0FBTyxVQUFVLEtBQUssTUFBTTtBQUNsQyxhQUFLLE1BQU0sV0FBVyxhQUFhLEtBQUssVUFBVSxLQUFLLE1BQU0sV0FBVztBQUFBLElBQ2hGO0FBQ0EsUUFBSSxDQUFDLEtBQUssT0FBTztBQUNiLFdBQUssT0FBTyxhQUFhLFlBQVksVUFBVTtBQUNuRCwwQkFBc0I7QUFBQSxFQUMxQjtBQUNBLG1DQUFpQztBQUM3QixTQUFLLG1CQUFtQixLQUFLLE9BQU8sbUJBQW1CLEtBQUs7QUFBQSxFQUNoRTtBQUNBLHlCQUF1QjtBQUNuQixRQUFJLFlBQVksS0FBSyxPQUFPLGFBQ3RCLEtBQUssT0FBTyxhQUNSLFNBQ0EsbUJBQ0o7QUFDTixTQUFLLGNBQWMsY0FBYyxTQUFTLEtBQUssTUFBTSxZQUFZLG1CQUFtQjtBQUNwRixTQUFLLFlBQVksV0FBVztBQUM1QixTQUFLLFlBQVksT0FBTztBQUN4QixTQUFLLFlBQVksV0FBVyxLQUFLLE1BQU07QUFDdkMsU0FBSyxZQUFZLFdBQVcsS0FBSyxNQUFNO0FBQ3ZDLFNBQUssWUFBWSxjQUFjLEtBQUssTUFBTTtBQUMxQyxTQUFLLGtCQUNELGNBQWMsbUJBQ1Isa0JBQ0EsY0FBYyxTQUNWLFVBQ0E7QUFDZCxRQUFJLEtBQUssY0FBYyxTQUFTLEdBQUc7QUFDL0IsV0FBSyxZQUFZLGVBQWUsS0FBSyxZQUFZLFFBQVEsS0FBSyxXQUFXLEtBQUssY0FBYyxJQUFJLEtBQUssZUFBZTtBQUFBLElBQ3hIO0FBQ0EsUUFBSSxLQUFLLE9BQU87QUFDWixXQUFLLFlBQVksTUFBTSxLQUFLLFdBQVcsS0FBSyxPQUFPLFNBQVMsT0FBTztBQUN2RSxRQUFJLEtBQUssT0FBTztBQUNaLFdBQUssWUFBWSxNQUFNLEtBQUssV0FBVyxLQUFLLE9BQU8sU0FBUyxPQUFPO0FBQ3ZFLFFBQUksS0FBSyxNQUFNLGFBQWEsTUFBTTtBQUM5QixXQUFLLFlBQVksT0FBTyxPQUFPLEtBQUssTUFBTSxhQUFhLE1BQU0sQ0FBQztBQUNsRSxTQUFLLE1BQU0sT0FBTztBQUNsQixRQUFJLEtBQUssYUFBYTtBQUNsQixXQUFLLFNBQVMsT0FBTztBQUN6QixRQUFJO0FBQ0EsVUFBSSxLQUFLLE1BQU07QUFDWCxhQUFLLE1BQU0sV0FBVyxhQUFhLEtBQUssYUFBYSxLQUFLLE1BQU0sV0FBVztBQUFBLElBQ25GLFNBQ08sSUFBUDtBQUFBLElBQWE7QUFDYixTQUFLLEtBQUssYUFBYSxVQUFVLFNBQVUsR0FBRztBQUMxQyxXQUFLLFFBQVEsZUFBZSxDQUFDLEVBQUUsT0FBTyxPQUFPLEtBQUssZUFBZTtBQUNqRSxtQkFBYSxVQUFVO0FBQ3ZCLG1CQUFhLFNBQVM7QUFBQSxJQUMxQixDQUFDO0FBQUEsRUFDTDtBQUNBLGtCQUFnQixHQUFHO0FBQ2YsUUFBSSxLQUFLLFdBQVc7QUFDaEIsYUFBTyxLQUFLLE1BQU07QUFDdEIsU0FBSyxLQUFLLENBQUM7QUFBQSxFQUNmO0FBQ0Esd0JBQXNCLE9BQU8sTUFBTTtBQUMvQixRQUFJLEtBQUssV0FBVztBQUNoQjtBQUNKLFFBQUksUUFBUSxLQUFLLE9BQU87QUFDeEIsUUFBSSxVQUFVLFVBQWEsTUFBTSxTQUFTLEdBQUc7QUFDekMsZUFBUyxJQUFJLEdBQUcsTUFBTSxNQUFNLElBQUksTUFBTSxRQUFRO0FBQzFDLGNBQU0sR0FBRyxLQUFLLGVBQWUsS0FBSyxNQUFNLE9BQU8sTUFBTSxJQUFJO0FBQUEsSUFDakU7QUFDQSxRQUFJLFVBQVUsWUFBWTtBQUN0QixXQUFLLE1BQU0sY0FBYyxZQUFZLFFBQVEsQ0FBQztBQUM5QyxXQUFLLE1BQU0sY0FBYyxZQUFZLE9BQU8sQ0FBQztBQUFBLElBQ2pEO0FBQUEsRUFDSjtBQUNBLHVCQUFxQixNQUFNO0FBQ3ZCLFFBQUksSUFBSSxTQUFTLFlBQVksT0FBTztBQUNwQyxNQUFFLFVBQVUsTUFBTSxNQUFNLElBQUk7QUFDNUIsV0FBTztBQUFBLEVBQ1g7QUFDQSwwQkFBd0IsTUFBTTtBQUMxQixhQUFTLElBQUksR0FBRyxJQUFJLEtBQUssY0FBYyxRQUFRLEtBQUs7QUFDaEQsVUFBSSxlQUFlLEtBQUssY0FBYztBQUN0QyxVQUFJLHdCQUF3QixRQUN4QixhQUFhLGNBQWMsSUFBSSxNQUFNO0FBQ3JDLGVBQU8sS0FBSztBQUFBLElBQ3BCO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFDQSx5QkFBdUIsTUFBTTtBQUN6QixRQUFJLEtBQUssT0FBTyxTQUFTLFdBQVcsS0FBSyxjQUFjLFNBQVM7QUFDNUQsYUFBTztBQUNYLFdBQVEsYUFBYSxNQUFNLEtBQUssY0FBYyxFQUFFLEtBQUssS0FDakQsYUFBYSxNQUFNLEtBQUssY0FBYyxFQUFFLEtBQUs7QUFBQSxFQUNyRDtBQUNBLDBDQUF3QztBQUNwQyxRQUFJLEtBQUssT0FBTyxjQUFjLEtBQUssWUFBWSxDQUFDLEtBQUs7QUFDakQ7QUFDSixTQUFLLGFBQWEsUUFBUSxTQUFVLGFBQWEsR0FBRztBQUNoRCxVQUFJLElBQUksSUFBSSxLQUFLLEtBQUssYUFBYSxLQUFLLGNBQWMsQ0FBQztBQUN2RCxRQUFFLFNBQVMsS0FBSyxlQUFlLENBQUM7QUFDaEMsVUFBSSxLQUFLLE9BQU8sYUFBYSxLQUN6QixLQUFLLE9BQU8sc0JBQXNCLFVBQVU7QUFDNUMsYUFBSyxjQUFjLEdBQUcsY0FDbEIsV0FBVyxFQUFFLFNBQVMsR0FBRyxLQUFLLE9BQU8sdUJBQXVCLEtBQUssSUFBSSxJQUFJO0FBQUEsTUFDakYsT0FDSztBQUNELGFBQUssd0JBQXdCLFFBQVEsRUFBRSxTQUFTLEVBQUUsU0FBUztBQUFBLE1BQy9EO0FBQ0Esa0JBQVksUUFBUSxFQUFFLFlBQVksRUFBRSxTQUFTO0FBQUEsSUFDakQsQ0FBQztBQUNELFNBQUssc0JBQ0QsS0FBSyxPQUFPLFlBQVksVUFDbkIsTUFBSyxnQkFBZ0IsS0FBSyxPQUFPLFFBQVEsWUFBWSxJQUNoRCxLQUFLLGdCQUFnQixLQUFLLE9BQU8sUUFBUSxTQUFTLElBQ2xELEtBQUssY0FBYyxLQUFLLE9BQU8sUUFBUSxZQUFZO0FBQ2pFLFNBQUssc0JBQ0QsS0FBSyxPQUFPLFlBQVksVUFDbkIsTUFBSyxnQkFBZ0IsS0FBSyxPQUFPLFFBQVEsWUFBWSxJQUNoRCxLQUFLLGVBQWUsSUFBSSxLQUFLLE9BQU8sUUFBUSxTQUFTLElBQ3JELEtBQUssY0FBYyxLQUFLLE9BQU8sUUFBUSxZQUFZO0FBQUEsRUFDckU7QUFDQSxzQkFBb0IsZ0JBQWdCO0FBQ2hDLFFBQUksVUFBUyxrQkFDUixNQUFLLE9BQU8sV0FBVyxLQUFLLE9BQU8sWUFBWSxLQUFLLE9BQU87QUFDaEUsV0FBTyxLQUFLLGNBQ1AsSUFBSSxTQUFVLE1BQU07QUFBRSxhQUFPLEtBQUssV0FBVyxNQUFNLE9BQU07QUFBQSxJQUFHLENBQUMsRUFDN0QsT0FBTyxTQUFVLEdBQUcsR0FBRyxLQUFLO0FBQzdCLGFBQU8sS0FBSyxPQUFPLFNBQVMsV0FDeEIsS0FBSyxPQUFPLGNBQ1osSUFBSSxRQUFRLENBQUMsTUFBTTtBQUFBLElBQzNCLENBQUMsRUFDSSxLQUFLLEtBQUssT0FBTyxTQUFTLFVBQ3pCLEtBQUssT0FBTyxjQUNaLEtBQUssS0FBSyxjQUFjO0FBQUEsRUFDbEM7QUFDQSx1QkFBcUIsZ0JBQWU7QUFDaEMsUUFBSSxtQkFBa0IsUUFBUTtBQUFFLHVCQUFnQjtBQUFBLElBQU07QUFDdEQsUUFBSSxLQUFLLGdCQUFnQixVQUFhLEtBQUssaUJBQWlCO0FBQ3hELFdBQUssWUFBWSxRQUNiLEtBQUssMEJBQTBCLFNBQ3pCLEtBQUssV0FBVyxLQUFLLHVCQUF1QixLQUFLLGVBQWUsSUFDaEU7QUFBQSxJQUNkO0FBQ0EsU0FBSyxNQUFNLFFBQVEsV0FBVyxLQUFLLE9BQU8sVUFBVTtBQUNwRCxRQUFJLEtBQUssYUFBYSxRQUFXO0FBQzdCLFdBQUssU0FBUyxRQUFRLFdBQVcsS0FBSyxPQUFPLFNBQVM7QUFBQSxJQUMxRDtBQUNBLFFBQUksbUJBQWtCO0FBQ2xCLG1CQUFhLGVBQWU7QUFBQSxFQUNwQztBQUNBLDJCQUF5QixHQUFHO0FBQ3hCLFFBQUksY0FBYyxlQUFlLENBQUM7QUFDbEMsUUFBSSxjQUFjLEtBQUssYUFBYSxTQUFTLFdBQVc7QUFDeEQsUUFBSSxjQUFjLEtBQUssYUFBYSxTQUFTLFdBQVc7QUFDeEQsUUFBSSxlQUFlLGFBQWE7QUFDNUIsa0JBQVksY0FBYyxLQUFLLENBQUM7QUFBQSxJQUNwQyxXQUNTLEtBQUssYUFBYSxRQUFRLFdBQVcsS0FBSyxHQUFHO0FBQ2xELGtCQUFZLE9BQU87QUFBQSxJQUN2QixXQUNTLFlBQVksVUFBVSxTQUFTLFNBQVMsR0FBRztBQUNoRCxXQUFLLFdBQVcsS0FBSyxjQUFjLENBQUM7QUFBQSxJQUN4QyxXQUNTLFlBQVksVUFBVSxTQUFTLFdBQVcsR0FBRztBQUNsRCxXQUFLLFdBQVcsS0FBSyxjQUFjLENBQUM7QUFBQSxJQUN4QztBQUFBLEVBQ0o7QUFDQSx1QkFBcUIsR0FBRztBQUNwQixNQUFFLGVBQWU7QUFDakIsUUFBSSxZQUFZLEVBQUUsU0FBUyxXQUFXLGNBQWMsZUFBZSxDQUFDLEdBQUcsUUFBUTtBQUMvRSxRQUFJLEtBQUssU0FBUyxVQUFhLGdCQUFnQixLQUFLLE1BQU07QUFDdEQsV0FBSyxLQUFLLGNBQ04sS0FBSyxLQUFLLEtBQUssSUFBSSxLQUFLLEtBQUssZ0JBQWdCLEtBQUssS0FBSyxLQUFLLEVBQUU7QUFBQSxJQUN0RTtBQUNBLFFBQUksT0FBTSxXQUFXLE1BQU0sYUFBYSxLQUFLLENBQUMsR0FBRyxPQUFNLFdBQVcsTUFBTSxhQUFhLEtBQUssQ0FBQyxHQUFHLE9BQU8sV0FBVyxNQUFNLGFBQWEsTUFBTSxDQUFDLEdBQUcsV0FBVyxTQUFTLE1BQU0sT0FBTyxFQUFFLEdBQUcsUUFBUSxFQUFFLFNBQ3hMLGFBQWEsRUFBRSxVQUFVLEtBQUssSUFBSSxLQUFNO0FBQzdDLFFBQUksV0FBVyxXQUFXLE9BQU87QUFDakMsUUFBSSxPQUFPLE1BQU0sVUFBVSxlQUFlLE1BQU0sTUFBTSxXQUFXLEdBQUc7QUFDaEUsVUFBSSxhQUFhLFVBQVUsS0FBSyxhQUFhLGVBQWUsVUFBVSxLQUFLO0FBQzNFLFVBQUksV0FBVyxNQUFLO0FBQ2hCLG1CQUNJLE9BQ0ksV0FDQSxJQUFJLENBQUMsVUFBVSxJQUNkLEtBQUksVUFBVSxLQUFLLElBQUksQ0FBQyxLQUFLLElBQUk7QUFDMUMsWUFBSTtBQUNBLDRCQUFrQixRQUFXLElBQUksS0FBSyxXQUFXO0FBQUEsTUFDekQsV0FDUyxXQUFXLE1BQUs7QUFDckIsbUJBQ0ksVUFBVSxLQUFLLGNBQWMsV0FBVyxPQUFNLElBQUksQ0FBQyxLQUFLLElBQUksSUFBSTtBQUNwRSxZQUFJO0FBQ0EsNEJBQWtCLFFBQVcsR0FBRyxLQUFLLFdBQVc7QUFBQSxNQUN4RDtBQUNBLFVBQUksS0FBSyxRQUNMLGNBQ0MsVUFBUyxJQUNKLFdBQVcsYUFBYSxLQUN4QixLQUFLLElBQUksV0FBVyxRQUFRLElBQUksT0FBTztBQUM3QyxhQUFLLEtBQUssY0FDTixLQUFLLEtBQUssS0FBSyxJQUFJLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxLQUFLLEtBQUssRUFBRTtBQUFBLE1BQ3RFO0FBQ0EsWUFBTSxRQUFRLElBQUksUUFBUTtBQUFBLElBQzlCO0FBQUEsRUFDSjtBQUNBLE9BQUs7QUFDTCxTQUFPO0FBQ1g7QUFDQSxvQkFBb0IsVUFBVSxRQUFRO0FBQ2xDLE1BQUksUUFBUSxNQUFNLFVBQVUsTUFDdkIsS0FBSyxRQUFRLEVBQ2IsT0FBTyxTQUFVLEdBQUc7QUFBRSxXQUFPLGFBQWE7QUFBQSxFQUFhLENBQUM7QUFDN0QsTUFBSSxZQUFZLENBQUM7QUFDakIsV0FBUyxJQUFJLEdBQUcsSUFBSSxNQUFNLFFBQVEsS0FBSztBQUNuQyxRQUFJLE9BQU8sTUFBTTtBQUNqQixRQUFJO0FBQ0EsVUFBSSxLQUFLLGFBQWEsY0FBYyxNQUFNO0FBQ3RDO0FBQ0osVUFBSSxLQUFLLGVBQWUsUUFBVztBQUMvQixhQUFLLFdBQVcsUUFBUTtBQUN4QixhQUFLLGFBQWE7QUFBQSxNQUN0QjtBQUNBLFdBQUssYUFBYSxrQkFBa0IsTUFBTSxVQUFVLENBQUMsQ0FBQztBQUN0RCxnQkFBVSxLQUFLLEtBQUssVUFBVTtBQUFBLElBQ2xDLFNBQ08sR0FBUDtBQUNJLGNBQVEsTUFBTSxDQUFDO0FBQUEsSUFDbkI7QUFBQSxFQUNKO0FBQ0EsU0FBTyxVQUFVLFdBQVcsSUFBSSxVQUFVLEtBQUs7QUFDbkQ7QUFDQSxJQUFJLE9BQU8sZ0JBQWdCLGVBQ3ZCLE9BQU8sbUJBQW1CLGVBQzFCLE9BQU8sYUFBYSxhQUFhO0FBQ2pDLGlCQUFlLFVBQVUsWUFBWSxTQUFTLFVBQVUsWUFBWSxTQUFVLFFBQVE7QUFDbEYsV0FBTyxXQUFXLE1BQU0sTUFBTTtBQUFBLEVBQ2xDO0FBQ0EsY0FBWSxVQUFVLFlBQVksU0FBVSxRQUFRO0FBQ2hELFdBQU8sV0FBVyxDQUFDLElBQUksR0FBRyxNQUFNO0FBQUEsRUFDcEM7QUFDSjtBQUNBLElBQUksWUFBWSxTQUFVLFVBQVUsUUFBUTtBQUN4QyxNQUFJLE9BQU8sYUFBYSxVQUFVO0FBQzlCLFdBQU8sV0FBVyxPQUFPLFNBQVMsaUJBQWlCLFFBQVEsR0FBRyxNQUFNO0FBQUEsRUFDeEUsV0FDUyxvQkFBb0IsTUFBTTtBQUMvQixXQUFPLFdBQVcsQ0FBQyxRQUFRLEdBQUcsTUFBTTtBQUFBLEVBQ3hDLE9BQ0s7QUFDRCxXQUFPLFdBQVcsVUFBVSxNQUFNO0FBQUEsRUFDdEM7QUFDSjtBQUNBLFVBQVUsZ0JBQWdCLENBQUM7QUFDM0IsVUFBVSxRQUFRO0FBQUEsRUFDZCxJQUFJLFNBQVMsQ0FBQyxHQUFHLGVBQU87QUFBQSxFQUN4QixTQUFTLFNBQVMsQ0FBQyxHQUFHLGVBQU87QUFDakM7QUFDQSxVQUFVLFdBQVcsU0FBVSxNQUFNO0FBQ2pDLFlBQVUsTUFBTSxVQUFVLFNBQVMsU0FBUyxDQUFDLEdBQUcsVUFBVSxNQUFNLE9BQU8sR0FBRyxJQUFJO0FBQ2xGO0FBQ0EsVUFBVSxjQUFjLFNBQVUsUUFBUTtBQUN0QyxZQUFVLGdCQUFnQixTQUFTLFNBQVMsQ0FBQyxHQUFHLFVBQVUsYUFBYSxHQUFHLE1BQU07QUFDcEY7QUFDQSxVQUFVLFlBQVksaUJBQWlCLENBQUMsQ0FBQztBQUN6QyxVQUFVLGFBQWEsb0JBQW9CLENBQUMsQ0FBQztBQUM3QyxVQUFVLGVBQWU7QUFDekIsSUFBSSxPQUFPLFdBQVcsZUFBZSxPQUFPLE9BQU8sT0FBTyxhQUFhO0FBQ25FLFNBQU8sR0FBRyxZQUFZLFNBQVUsUUFBUTtBQUNwQyxXQUFPLFdBQVcsTUFBTSxNQUFNO0FBQUEsRUFDbEM7QUFDSjtBQUNBLEtBQUssVUFBVSxVQUFVLFNBQVUsTUFBTTtBQUNyQyxTQUFPLElBQUksS0FBSyxLQUFLLFlBQVksR0FBRyxLQUFLLFNBQVMsR0FBRyxLQUFLLFFBQVEsSUFBSyxRQUFPLFNBQVMsV0FBVyxTQUFTLE1BQU0sRUFBRSxJQUFJLEtBQUs7QUFDaEk7QUFDQSxJQUFJLE9BQU8sV0FBVyxhQUFhO0FBQy9CLFNBQU8sWUFBWTtBQUN2QjtBQUNBLElBQU8sY0FBUTs7O0FSbC9EZixJQUFxQixZQUFyQixjQUF1QyxVQUFVO0FBQUEsRUFjN0MsWUFDVyxRQUNDLE1BQ0EsT0FDQSxjQUNBLGFBQXFCLElBQ3JCLFFBQWlCLE9BQ2pCLFNBQWtCLE9BQ2xCLFlBQXFCLE9BQy9CO0FBbENOO0FBbUNRLFVBQU0sTUFBTTtBQVRMO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFkWixTQUFRLG1CQUE0QjtBQWlCaEMsU0FBSyxlQUFlLGVBQWUsb0JBQWEsU0FBUyxFQUFFLFFBQVEsVUFBVSxFQUFFLEVBQUUsUUFBUSxVQUFVLEVBQUUsRUFBRSxNQUFNLEdBQUcsRUFBRSxNQUFNLE1BQXJGLG1CQUF3RixNQUFNLEtBQUssV0FBVSxLQUFLO0FBQ3JKLFNBQUssZUFBZSxjQUFHLGdCQUFnQixLQUFLLE1BQU0sUUFBUSx1QkFBdUIsT0FBTyxLQUFLO0FBQzdGLFNBQUssU0FBUyxLQUFLLE1BQU0sUUFBUSxjQUFjLEtBQUssTUFBTSxRQUFRO0FBQ2xFLFNBQUssUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsZ0JBQWhDLG1CQUE2QztBQUMxRCxRQUFJLEtBQUs7QUFBTyxXQUFLLGNBQWMsSUFBSSxhQUFhLEtBQUssTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLLEtBQUs7QUFDNUYsU0FBSyxRQUFRLEtBQUs7QUFBQSxFQUV0QjtBQUFBLEVBRUEsU0FBUztBQUNMLFVBQU0sT0FBTztBQUNiLFNBQUssWUFBWSxTQUFTLGVBQWU7QUFDekMsVUFBTSxpQkFBaUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzFFLFNBQUssWUFBWSxjQUFjO0FBQy9CLFNBQUssYUFBYSxLQUFLLFVBQVUsU0FBUyxPQUFPLEVBQUUsS0FBSyxjQUFjLENBQUM7QUFDdkUsU0FBSyxXQUFXLEtBQUs7QUFBQSxFQUN6QjtBQUFBLEVBRUEsQUFBYSxLQUFLLEdBQXlCO0FBQUE7QUFFdkMsVUFBSTtBQUVKLFVBQUksS0FBSyxPQUFPLElBQUksUUFBUSxlQUFlLElBQUksa0JBQWtCLEdBQUc7QUFFaEUsWUFBSTtBQUNBLGdCQUFNLFVBQVUsS0FBSyxPQUFPLElBQUksUUFBUSxRQUFRO0FBQ2hELHFCQUFXLFFBQVEsVUFBVSxLQUFLLEtBQUssRUFBRTtBQUFBLFFBQzdDLFNBQVMsT0FBUDtBQUNFLGtCQUFRLElBQUksS0FBSztBQUNqQixxQkFBVyw4QkFBTyxLQUFLLE9BQU8sS0FBSyxNQUFNO0FBQUEsUUFDN0M7QUFBQSxNQUNKLE9BQU87QUFDSCxtQkFBVyw4QkFBTyxLQUFLLE9BQU8sS0FBSyxNQUFNO0FBQUEsTUFDN0M7QUFDQSxVQUFJLFNBQVMsUUFBUSxHQUFHO0FBQ3BCLGNBQU0sV0FBVyxLQUFLLE9BQU8sSUFBSSxjQUFjLHFCQUFxQixLQUFLLE1BQU0sUUFBUSxZQUFZLEtBQUssU0FBUyxPQUFPLEtBQUssTUFBTSxHQUFHLEtBQUssS0FBSyxJQUFJO0FBQ3BKLGNBQU0saUJBQWlCLEtBQUssZUFBZSxLQUFLLEtBQUssTUFBTSxRQUFRLFlBQVksS0FBSyxTQUFTLE9BQU8sS0FBSyxNQUFNLElBQUksV0FBVyxNQUFNLFNBQVMsV0FBVyxTQUFTLFNBQVMsT0FBTyxLQUFLLE1BQU07QUFDNUwsY0FBTSxXQUFXLEtBQUssUUFBUSxDQUFDLEVBQUUsTUFBTSxLQUFLLE1BQU0sTUFBTSxTQUFTLEVBQUUsT0FBTyxlQUFlLEVBQUUsQ0FBQyxHQUFHLEtBQUssTUFBTSxLQUFLLFlBQVksS0FBSyxPQUFPLEtBQUssUUFBUSxLQUFLLFNBQVM7QUFDbEssWUFBSSxLQUFLLHFCQUFxQixLQUFLLG9CQUFvQixLQUFLLFdBQVc7QUFDbkUsZ0JBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxrQkFBbUIsTUFBTSxTQUFTLEVBQUUsT0FBTyxLQUFLLFVBQVcsRUFBRSxDQUFDLEdBQUcsS0FBSyxLQUFLLElBQUk7QUFDM0gsZUFBSyxNQUFNO0FBQUEsUUFDZjtBQUNBLGFBQUssTUFBTTtBQUFBLE1BQ2YsV0FBVyxDQUFDLEtBQUssT0FBTztBQUNwQixjQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLEdBQUcsRUFBRSxDQUFDLEdBQUcsS0FBSyxNQUFNLEtBQUssWUFBWSxLQUFLLE9BQU8sS0FBSyxRQUFRLEtBQUssU0FBUztBQUN0SixhQUFLLE1BQU07QUFBQSxNQUNmLE9BQU87QUFDSCxhQUFLLFdBQVcsS0FBSztBQUNyQixhQUFLLFdBQVcsUUFBUSw0QkFBNEI7QUFDcEQsYUFBSyxRQUFRLFFBQVEsU0FBUyxZQUFZO0FBQzFDO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFBQTtBQUFBLEVBRUEsQUFBUSxZQUFZLHFCQUFxQztBQUVyRCxTQUFLLGFBQWEsbUJBQW1CO0FBQ3JDLFNBQUssd0JBQXdCLG1CQUFtQjtBQUNoRCxTQUFLLGFBQWEsbUJBQW1CO0FBQUEsRUFDekM7QUFBQSxFQUVBLEFBQVEsd0JBQXdCLFdBQTJCO0FBQ3ZELFVBQU0sa0JBQWtCLElBQUksa0NBQWdCLFNBQVM7QUFDckQsVUFBTSxpQkFBaUIsTUFBTTtBQUN6QixzQkFBZ0IsUUFBUSxLQUFLLGVBQWUsU0FBUyxRQUFRO0FBQzdELHNCQUFnQixXQUFXLEtBQUssZUFDNUIsaUNBQ0EsOEJBQ0o7QUFBQSxJQUNKO0FBQ0EsbUJBQWU7QUFDZixvQkFBZ0IsUUFBUSxNQUFNO0FBQzFCLFdBQUssZUFBZSxDQUFDLEtBQUs7QUFDMUIscUJBQWU7QUFBQSxJQUNuQixDQUFDO0FBQUEsRUFFTDtBQUFBLEVBRUEsQUFBUSxhQUFhLFFBQXlCLE9BQXFCO0FBQy9ELFdBQU8sWUFBWSxDQUFDLENBQUMsS0FBSztBQUMxQixRQUFJLE9BQU87QUFDUCxhQUFPLFNBQVMsU0FBUyxVQUFVO0FBQUEsSUFDdkMsT0FBTztBQUNILGFBQU8sU0FBUyxZQUFZLFVBQVU7QUFBQSxJQUMxQztBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQVEsYUFBYSxXQUFpQztBQUVsRCxRQUFJLEtBQUs7QUFBYSxPQUFDLEtBQUssY0FBYyxLQUFLLG1CQUFtQixLQUFLLFNBQVMsSUFBSSxLQUFLLFlBQVksY0FBYyxLQUFLLElBQUk7QUFFNUgsU0FBSyxVQUFVLElBQUksZ0NBQWMsU0FBUztBQUMxQyxTQUFLLFFBQVEsUUFBUSxNQUFNO0FBRTNCLFNBQUssUUFBUSxlQUNULEtBQUssZUFDRCw4QkFBTyxLQUFLLGNBQWMsS0FBSyxNQUFNLFFBQVEsVUFBVSxFQUFFLE9BQU8sS0FBSyxNQUFNLFFBQVEsVUFBVSxJQUMzRixFQUFFO0FBQ1osU0FBSyxRQUFRLFNBQVMsV0FBUztBQUMzQixXQUFLLFFBQVEsUUFBUSxZQUFZLFlBQVk7QUFDN0MsV0FBSyxXQUFXLEtBQUs7QUFDckIsV0FBSyxXQUFXLFFBQVEsRUFBRTtBQUMxQixXQUFLLFFBQVE7QUFDYixXQUFLLGFBQWEsbUJBQW1CLEtBQUs7QUFBQSxJQUM5QyxDQUFDO0FBQ0QsVUFBTSxxQkFBcUIsSUFBSSxrQ0FBZ0IsU0FBUztBQUN4RCx1QkFBbUIsUUFBUSxVQUFVLGtCQUFlO0FBQ3BELHVCQUFtQixXQUFXLGtCQUFrQjtBQUNoRCxVQUFNLG9CQUFvQixJQUFJLGtDQUFnQixTQUFTO0FBQ3ZELHNCQUFrQixRQUFRLGNBQWM7QUFDeEMsc0JBQWtCLFdBQVcsU0FBUyxLQUFLLE1BQU0sUUFBUSxLQUFLLGdCQUFnQixlQUFlO0FBRTdGLFVBQU0sc0JBQXNCLFVBQVUsVUFBVTtBQUVoRCxVQUFNLGFBQWEsWUFBVSxxQkFBcUI7QUFBQSxNQUM5QyxRQUFRO0FBQUEsUUFDSixnQkFBZ0IsS0FBSyxPQUFPLFNBQVM7QUFBQSxNQUN6QztBQUFBLE1BQ0EsYUFBYSw4QkFBTyxLQUFLLElBQUksQ0FBQyxFQUFFLE9BQU8sWUFBWTtBQUFBLElBQ3ZELENBQUM7QUFDRCxlQUFXLE9BQU8sU0FBUyxLQUFLLENBQUMsVUFBVTtBQUN2QyxZQUFNLFVBQVUsOEJBQU8sTUFBTSxTQUFTLENBQUMsRUFBRSxPQUFPLEtBQUssTUFBTTtBQUMzRCxXQUFLLFFBQVEsU0FBUyxPQUFPO0FBQzdCLFdBQUssUUFBUTtBQUNiLFdBQUssYUFBYSxtQkFBbUIsS0FBSyxLQUFLO0FBQUEsSUFDbkQsQ0FBQztBQUVELHVCQUFtQixRQUFRLENBQUMsTUFBa0I7QUFDMUMsUUFBRSxlQUFlO0FBQ2pCLGlCQUFXLFFBQVEsV0FBVyxVQUFVLEtBQUssUUFBUSxTQUFTLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQztBQUM5RSxpQkFBVyxLQUFLO0FBQUEsSUFDcEIsQ0FBQztBQUVELHNCQUFrQixRQUFRLENBQU8sTUFBa0I7QUFDL0MsWUFBTSxnQkFBZ0IsS0FBSyxNQUFNLEtBQUssOEJBQU8sS0FBSyxjQUFjLEtBQUssTUFBTSxFQUFFLFlBQVksQ0FBQztBQUMxRixZQUFNLFVBQVUsY0FBYyxLQUFLLEtBQUssTUFBTSxTQUFTLEtBQUssZ0JBQWdCLE9BQU8sQ0FBQztBQUNwRixZQUFNLFdBQVcsOEJBQU8sUUFBUSxTQUFTLENBQUMsRUFBRSxPQUFPLEtBQUssTUFBTTtBQUM5RCxXQUFLLFFBQVEsU0FBUyxRQUFRO0FBQzlCLFdBQUssUUFBUTtBQUNiLFdBQUssbUJBQW1CO0FBQ3hCLFdBQUssYUFBYSxtQkFBbUIsS0FBSyxRQUFRLFNBQVMsQ0FBQztBQUFBLElBQ2hFLEVBQUM7QUFFRCxRQUFJLENBQUMsS0FBSyxPQUFPO0FBQ2Isd0JBQWtCLFNBQVMsS0FBSztBQUNoQyx3QkFBa0IsWUFBWSxJQUFJO0FBQUEsSUFDdEM7QUFBQSxFQUNKO0FBQ0o7OztBRDNLQSxJQUFxQixZQUFyQixjQUF1QyxjQUFhO0FBQUEsRUFLaEQsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLGlCQUFjO0FBSnZDLFNBQU8sb0JBQTRCO0FBSy9CLFNBQUssa0JBQWtCO0FBQUEsRUFDM0I7QUFBQSxFQUVBLEFBQU8sZUFBZSxNQUFjLE9BQWUsTUFBYSxVQUFnRTtBQXZCcEk7QUF3QlEsVUFBTSxRQUFRLElBQUksVUFBVSxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sS0FBSztBQUNoRSxVQUFNLFFBQVEsUUFBUSxvQkFBb0IsT0FBTztBQUNqRCxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxVQUFNLGVBQWUsVUFBVTtBQUMvQixVQUFNLGtCQUFrQixNQUFNLE1BQU0sS0FBSztBQUN6QyxVQUFNLElBQUksTUFBTSxLQUFLLEtBQUssSUFBSTtBQUM5QixVQUFNLGtCQUFrQixNQUFNLEtBQUssVUFBVSxPQUFPLEdBQUcsSUFBSTtBQUMzRCxVQUFNLGVBQTBCLElBQUksYUFBRyxLQUFLLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSyxLQUFLO0FBQy9FLFVBQU0sQ0FBQyxnQkFBNkUsYUFBYSxjQUFjLElBQUk7QUFDbkgsUUFBSSxVQUFVLE9BQU8sUUFBUSxHQUFHO0FBQzVCLGVBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsYUFBSyxTQUFTLFdBQVcsT0FBTztBQUNoQyxhQUFLLFFBQVEsWUFBWTtBQUN6QixhQUFLLFFBQVEsZUFBZTtBQUM1QixhQUFLLFdBQVcsc0JBQXNCO0FBQUEsTUFDMUMsQ0FBQztBQUNELFVBQUksS0FBSyxNQUFNLFFBQVEscUJBQXFCLEtBQUssTUFBTSxRQUFRLDBCQUEwQixPQUFPO0FBQzVGLGlCQUFTLFFBQVEsQ0FBQyxTQUFTO0FBQ3ZCLGVBQUssU0FBUyxVQUFVLFNBQVMsb0JBQW9CO0FBQ3JELGVBQUssUUFBUSxjQUFjO0FBQzNCLGVBQUssUUFBUSxlQUFlO0FBQzVCLGVBQUssV0FBVyxzQkFBc0I7QUFBQSxRQUMxQyxDQUFDO0FBQUEsTUFDTDtBQUFBLElBQ0osV0FBVyxVQUFVLFVBQVUsUUFBUSxHQUFHO0FBQ3RDLGVBQVMsUUFBUSxLQUFLO0FBQUEsUUFDbEIsSUFBSSxVQUFVO0FBQUEsUUFDZCxhQUFhLG1CQUFtQjtBQUFBLFFBQ2hDLFFBQVE7QUFBQSxRQUNSLE1BQU07QUFBQSxNQUNWLENBQUM7QUFDRCxVQUFJLEtBQUssTUFBTSxRQUFRLHFCQUFxQixLQUFLLE1BQU0sUUFBUSwwQkFBMEIsT0FBTztBQUM1RixpQkFBUyxRQUFRLEtBQUs7QUFBQSxVQUNsQixJQUFJLFVBQVU7QUFBQSxVQUNkLGFBQWEsa0JBQWtCLFlBQVk7QUFBQSxVQUMzQyxRQUFRO0FBQUEsVUFDUixNQUFNO0FBQUEsUUFDVixDQUFDO0FBQUEsTUFDTDtBQUFBLElBQ0osV0FBVyxVQUFVLGVBQWUsUUFBUSxHQUFHO0FBQzNDLGVBQVMsVUFBVSxnQkFBZ0IsaUJBQWlCLFNBQVMsaUJBQWlCLGNBQWM7QUFDNUYsZUFBUyxVQUFVLGNBQWMsaUJBQWlCLE9BQU8sYUFBYTtBQUFBLElBQzFFO0FBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFPLHdCQUNILE1BQ0EsbUJBQ0EsT0FDQSxZQUNBLE9BQ0EsUUFDQSxXQUNJO0FBQ0osVUFBTSxhQUFhLElBQUksVUFBVSxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sU0FBUyxJQUFJLFlBQVksT0FBTyxRQUFRLFNBQVM7QUFDakgsZUFBVyxRQUFRLFFBQVEsa0JBQWtCLG1CQUFtQjtBQUNoRSxlQUFXLEtBQUs7QUFBQSxFQUNwQjtBQUFBLEVBRUEsQUFBUSxvQkFBb0IsV0FBaUM7QUFDekQsUUFBSSxDQUFDLEtBQUssTUFBTSxRQUFRO0FBQVksV0FBSyxNQUFNLFFBQVEsYUFBYSxLQUFLO0FBQ3pFLFFBQUksQ0FBQyxLQUFLLE1BQU0sUUFBUTtBQUFxQixXQUFLLE1BQU0sUUFBUSxzQkFBc0I7QUFDdEYsVUFBTSxzQkFBc0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUMxRSx3QkFBb0IsU0FBUyxRQUFRLEVBQUUsTUFBTSxlQUFlLEtBQUssUUFBUSxDQUFDO0FBQzFFLFVBQU0sY0FBYyxvQkFBb0IsU0FBUyxRQUFRLEVBQUUsS0FBSyxZQUFZLENBQUM7QUFDN0Usd0JBQW9CLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUMvQyxVQUFNLGtCQUFrQixJQUFJLGdDQUFjLG1CQUFtQjtBQUM3RCxvQkFBZ0IsU0FBUyxLQUFLLE1BQU0sUUFBUSxVQUFVO0FBQ3RELGdCQUFZLFFBQVEsR0FBRyw4QkFBTyxFQUFFLE9BQU8sZ0JBQWdCLFNBQVMsQ0FBQyxHQUFHO0FBQ3BFLG9CQUFnQixTQUFTLENBQUMsVUFBa0I7QUFDeEMsV0FBSyxNQUFNLFFBQVEsYUFBYTtBQUNoQyxrQkFBWSxRQUFRLEdBQUcsOEJBQU8sRUFBRSxPQUFPLEtBQUssR0FBRztBQUFBLElBQ25ELENBQUM7QUFHRCxVQUFNLCtCQUErQixVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ25GLGlDQUE2QixTQUFTLFFBQVEsRUFBRSxNQUFNLDZCQUE2QixLQUFLLFFBQVEsQ0FBQztBQUNqRyxpQ0FBNkIsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQ3hELFVBQU0sc0JBQXNCLElBQUksa0NBQWdCLDRCQUE0QjtBQUM1RSx3QkFBb0IsU0FBUyxVQUFVLGdCQUFnQixLQUFLLE1BQU0sUUFBUSxtQkFBbUIsQ0FBQztBQUM5Rix3QkFBb0IsU0FBUyxDQUFDLFVBQW1CO0FBQzdDLFdBQUssTUFBTSxRQUFRLHNCQUFzQixNQUFNLFNBQVM7QUFBQSxJQUM1RCxDQUFDO0FBR0QsVUFBTSx3QkFBd0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUM1RSwwQkFBc0IsU0FBUyxRQUFRLEVBQUUsTUFBTSx3QkFBd0IsS0FBSyxRQUFRLENBQUM7QUFDckYsMEJBQXNCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUNqRCxVQUFNLG9CQUFvQixJQUFJLGdDQUFjLHFCQUFxQjtBQUNqRSxzQkFBa0IsU0FBUyxLQUFLLE1BQU0sUUFBUSxRQUFRO0FBQ3RELHNCQUFrQixTQUFTLENBQUMsVUFBa0I7QUFDMUMsV0FBSyxNQUFNLFFBQVEsV0FBVyxRQUFVLEVBQUMsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLENBQUMsTUFBTSxTQUFVLE1BQU07QUFBQSxJQUM1RixDQUFDO0FBR0QsVUFBTSw2QkFBNkIsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNqRiwrQkFBMkIsU0FBUyxRQUFRLEVBQUUsTUFBTSwyQkFBMkIsS0FBSyxRQUFRLENBQUM7QUFDN0YsK0JBQTJCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUN0RCxVQUFNLG9CQUFvQixJQUFJLGdDQUFjLDBCQUEwQjtBQUN0RSxzQkFBa0IsZUFBZSxvQkFBb0I7QUFDckQsc0JBQWtCLFNBQVMsS0FBSyxNQUFNLFFBQVEsaUJBQWlCO0FBQy9ELHNCQUFrQixTQUFTLENBQUMsVUFBa0I7QUFDMUMsVUFBSSxDQUFDLE9BQU87QUFDUixlQUFPLEtBQUssTUFBTSxRQUFRO0FBQUEsTUFDOUIsT0FBTztBQUNILGFBQUssTUFBTSxRQUFRLG9CQUFvQixNQUFNLFNBQVM7QUFBQSxNQUMxRDtBQUFBLElBQ0osQ0FBQztBQUdELFVBQU0sa0NBQWtDLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDdEYsb0NBQWdDLFNBQVMsUUFBUTtBQUFBLE1BQzdDLE1BQU07QUFBQSxNQUNOLEtBQUs7QUFBQSxJQUNULENBQUM7QUFDRCxvQ0FBZ0MsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQzNELFVBQU0seUJBQXlCLElBQUksZ0NBQWMsK0JBQStCO0FBQ2hGLDJCQUF1QixTQUFTLEtBQUssTUFBTSxRQUFRLHNCQUFzQjtBQUN6RSwyQkFBdUIsU0FBUyxDQUFDLFVBQWtCO0FBQy9DLFVBQUksQ0FBQyxPQUFPO0FBQ1IsZUFBTyxLQUFLLE1BQU0sUUFBUTtBQUFBLE1BQzlCLE9BQU87QUFDSCxhQUFLLE1BQU0sUUFBUSx5QkFBeUIsTUFBTSxTQUFTO0FBQUEsTUFDL0Q7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUVMO0FBQUEsRUFFQSxBQUFPLHVCQUF1QixXQUEyQixRQUFzQixVQUFrQztBQUM3RyxTQUFLLG9CQUFvQixTQUFTO0FBQUEsRUFDdEM7QUFBQSxFQUVBLEFBQWEsVUFBVSxJQUFTLEdBQVEsTUFBNEI7QUFBQTtBQUNoRSxZQUFNLEVBQUUsWUFBWSxxQkFBcUIsYUFBYSxLQUFLLE1BQU07QUFDakUsWUFBTSxlQUEwQixJQUFJLGFBQUcsS0FBSyxNQUFNLE1BQU0sS0FBSyxRQUFRLEtBQUssS0FBSztBQUMvRSxZQUFNLENBQUMsY0FBYyxtQkFBbUIsYUFBMEUsYUFBYSxjQUFjLElBQUk7QUFDakosWUFBTSxTQUFTLEVBQUUsS0FBSyxNQUFNO0FBRTVCLFlBQU0sbUJBQW1CLEdBQUcsTUFBTSxPQUFPLE1BQU0sSUFDM0MsT0FBTyxLQUFLLE1BQU0sR0FBRyxFQUFFLEtBQUssSUFDNUIsR0FBRyxNQUFNLE9BQU8sTUFBTSxJQUNsQiw4QkFBTyxPQUFPLFNBQVMsQ0FBQyxFQUFFLE9BQU8sVUFBVSxJQUMzQztBQUNSLFlBQU0sZ0JBQWdCLEdBQUcsS0FBSyw4QkFBTyxrQkFBa0IsVUFBVSxFQUFFLFlBQVksQ0FBQztBQUNoRixZQUFNLFVBQVUsY0FBYyxLQUFLLEdBQUcsU0FBUyxnQkFBZ0IsT0FBTyxDQUFDO0FBQ3ZFLFlBQU0sV0FBVyw4QkFBTyxRQUFRLFNBQVMsQ0FBQyxFQUFFLE9BQU8sVUFBVTtBQUM3RCxVQUFJLHFCQUFxQixXQUFXO0FBQ2hDLGNBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sa0JBQWtCLE1BQU0sU0FBUyxFQUFFLE9BQU8sVUFBVSxFQUFFLENBQUMsR0FBRyxLQUFLLElBQUk7QUFBQSxNQUM5RztBQUNBLFlBQU0sV0FBVyxLQUFLLE9BQU8sSUFBSSxjQUFjLHFCQUFxQixZQUFZLEtBQUssU0FBUyxPQUFPLFVBQVUsR0FBRyxLQUFLLElBQUk7QUFDM0gsWUFBTSxpQkFBaUIsVUFBVSxnQkFBZ0IsbUJBQW1CLElBQ2hFLEtBQUssWUFBWSxLQUFLLFdBQVcsV0FBVyxNQUFNLFNBQVMsV0FBVyxTQUN0RTtBQUNKLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxNQUFNLE1BQU0sU0FBUyxFQUFFLE9BQU8sZUFBZSxFQUFFLENBQUMsR0FBRyxJQUFJO0FBQUEsSUFFdkc7QUFBQTtBQUFBLEVBRUEsQUFBTyxjQUNILElBQ0EsR0FDQSxnQkFDQSxPQUNJO0FBMUxaO0FBMkxRLFVBQU0sYUFBYSxHQUFHLEdBQUcsUUFBUSxFQUFFLEtBQUssTUFBTSxPQUFPLEtBQUs7QUFDMUQsVUFBTSxVQUFVLGVBQWUsU0FBUyxRQUFRO0FBQ2hELG1DQUFRLFNBQVMsVUFBVSxrQkFBZTtBQUUxQyxVQUFNLFNBQVMsZUFBZSxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDM0QsUUFBSSxLQUFLLE1BQU0sUUFBUSxxQkFBcUIsS0FBSyxNQUFNLFFBQVEsd0JBQXdCO0FBQ25GLFdBQUssV0FBVyxlQUFlLFNBQVMsUUFBUTtBQUNoRCxxQ0FBUSxLQUFLLFVBQVUsY0FBYztBQUNyQyxhQUFPLFFBQVEsU0FBUyxVQUFVO0FBQUEsSUFFdEMsT0FBTztBQUNILGFBQU8sUUFBUSxTQUFTLFVBQVU7QUFBQSxJQUN0QztBQUVBLFVBQU0sT0FBTyxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixFQUFFLEtBQUssSUFBSTtBQUNwRSxRQUFJO0FBQ0osUUFBSSxnQkFBZ0IsMkJBQVMsS0FBSyxhQUFhLE1BQU07QUFDakQsVUFBSSxFQUFFLEtBQUssTUFBTSxTQUFTLEVBQUUsS0FBSyxNQUFNLE1BQU0sZUFBZSxNQUFNLEdBQUc7QUFDakUsY0FBTSxXQUFXLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsS0FBSyxNQUFNLEtBQUs7QUFDL0UsWUFBSSxvQkFBb0IsMkJBQVMsU0FBUyxhQUFhLE1BQU07QUFDekQsdUJBQWEsSUFBSSxVQUFVLEtBQUssUUFBUSxNQUFNLEtBQUssT0FBTyxTQUFTLElBQUk7QUFBQSxRQUMzRSxPQUFPO0FBQ0gsdUJBQWEsSUFBSSxVQUFVLEtBQUssUUFBUSxNQUFNLEtBQUssT0FBTyxFQUFFLEtBQUssTUFBTSxNQUFNLEtBQUssTUFBTSxHQUFHLEVBQUUsS0FBSyxFQUFFLFFBQVEsT0FBTyxFQUFFLENBQUM7QUFBQSxRQUMxSDtBQUFBLE1BQ0osV0FBVyxFQUFFLEtBQUssTUFBTSxPQUFPO0FBQzNCLHFCQUFhLElBQUksVUFBVSxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sRUFBRSxLQUFLLE1BQU0sS0FBSztBQUFBLE1BQ2hGLE9BQU87QUFDSCxxQkFBYSxJQUFJLFVBQVUsS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLEVBQUU7QUFBQSxNQUNoRTtBQUNBLFVBQUksS0FBSztBQUFVLGFBQUssU0FBUyxVQUFVLE1BQU07QUFBRSxlQUFLLFVBQVUsSUFBSSxHQUFHLElBQUk7QUFBQSxRQUFFO0FBQUEsSUFDbkYsT0FBTztBQUNILFlBQU0sTUFBTSwwQ0FBMEM7QUFBQSxJQUMxRDtBQUNBLGVBQVcsVUFBVSxNQUFNO0FBQUUsaUJBQVcsVUFBVSxZQUFZO0FBQUEsSUFBSTtBQUNsRSxZQUFRLFVBQVUsTUFBTTtBQUFFLGlCQUFXLEtBQUs7QUFBQSxJQUFFO0FBRTVDLFFBQUksQ0FBQyxzQ0FBTyxZQUFQLG1CQUFnQixXQUFVO0FBQzNCLGNBQVEsS0FBSztBQUNiLFVBQUksS0FBSztBQUFVLGFBQUssU0FBUyxLQUFLO0FBQ3RDLGFBQU8sS0FBSztBQUNaLHFCQUFlLGNBQWMsTUFBTTtBQUMvQixnQkFBUSxLQUFLO0FBQ2IsWUFBSSxLQUFLO0FBQVUsZUFBSyxTQUFTLEtBQUs7QUFDdEMsZUFBTyxLQUFLO0FBQUEsTUFDaEI7QUFDQSxxQkFBZSxhQUFhLE1BQU07QUFDOUIsZ0JBQVEsS0FBSztBQUNiLFlBQUksS0FBSztBQUFVLGVBQUssU0FBUyxLQUFLO0FBQ3RDLGVBQU8sS0FBSztBQUFBLE1BQ2hCO0FBQUEsSUFDSjtBQUdBLG1CQUFlLFlBQVksVUFBVTtBQUNyQyxtQkFBZSxZQUFZLE9BQU87QUFDbEMsUUFBSSxLQUFLO0FBQVUscUJBQWUsWUFBWSxLQUFLLFFBQVE7QUFDM0QsbUJBQWUsWUFBWSxNQUFNO0FBQUEsRUFDckM7QUFBQSxFQUVBLEFBQU8sZ0JBQXdCO0FBQzNCLFdBQU8sS0FBSyxNQUFNLFFBQVE7QUFBQSxFQUM5QjtBQUFBLEVBRUEsQUFBTyxrQkFBMkI7QUFDOUIsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLEFBQU8sYUFBYSxXQUEyQixNQUFhLFdBQW1CLFdBQTJCO0FBOVA5RztBQStQUSxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxRQUFJLE9BQU87QUFDUCxZQUFNLFFBQVEsTUFBTSxLQUFLLEtBQUssSUFBSSxFQUFFO0FBQ3BDLFVBQUksTUFBTSxNQUFNLE9BQU8sS0FBSyxHQUFHO0FBQzNCLGtCQUFVLFVBQVUsRUFBRSxNQUFNLDhCQUFPLE1BQU0sU0FBUyxDQUFDLEVBQUUsT0FBTyxLQUFLLE1BQU0sUUFBUSxVQUFVLEVBQUUsQ0FBQztBQUFBLE1BQ2hHLFdBQVcsTUFBTSxNQUFNLE9BQU8sS0FBSyxHQUFHO0FBQ2xDLGNBQU0sT0FBTyxVQUFVLFNBQVMsS0FBSyxFQUFFLE1BQU0sTUFBTSxLQUFLLE1BQU0sR0FBRyxFQUFFLEtBQUssRUFBRSxRQUFRLFdBQVcsSUFBSSxFQUFFLENBQUM7QUFDcEcsYUFBSyxVQUFVLE1BQU07QUFDakIsZUFBSyxPQUFPLElBQUksVUFBVSxhQUFhLE1BQU0sTUFBTSxLQUFLLE1BQU0sSUFBSTtBQUNsRSxvQkFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKLE9BQU87QUFDSCxrQkFBVSxVQUFVLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFBQSxNQUN2QztBQUFBLElBQ0o7QUFDQSxjQUFVLFVBQVUsQ0FBQyxDQUFDO0FBQUEsRUFDMUI7QUFBQSxFQUVBLEFBQU8sY0FBYyxPQUF3QjtBQWpSakQ7QUFrUlEsUUFBSSxDQUFDLE9BQU87QUFDUixhQUFPO0FBQUEsSUFDWCxPQUFPO0FBQ0gsVUFBSSxPQUFRLFNBQVUsVUFBVTtBQUM1QixlQUFPLDhCQUNILFlBQU0sUUFBUSxVQUFVLEVBQUUsRUFBRSxRQUFRLFVBQVUsRUFBRSxFQUFFLE1BQU0sR0FBRyxFQUFFLE1BQU0sTUFBbkUsbUJBQXNFLE1BQU0sS0FBSyxRQUNqRixLQUFLLE1BQU0sUUFBUSxVQUN2QixFQUFFLFFBQVE7QUFBQSxNQUNkLE9BQU87QUFDSCxlQUFPLDhCQUNGLFlBQ0ksS0FBSyxRQUFRLFVBQVUsRUFBRSxFQUFFLFFBQVEsVUFBVSxFQUFFLEVBQUUsTUFBTSxHQUFHLEVBQUUsTUFBTSxNQUR0RSxtQkFDeUUsTUFBTSxLQUFLLFFBQ3JGLEtBQUssTUFBTSxRQUFRLFVBQ3ZCLEVBQUUsUUFBUTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBTyxjQUFjLE1BQTBFO0FBcFNuRztBQXFTUSxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxRQUFJLE9BQU87QUFDUCxZQUFNLFdBQVcsS0FBSyxNQUFNLFFBQVE7QUFDcEMsWUFBTSxxQkFBcUIsS0FBSyxNQUFNLFFBQVE7QUFDOUMsWUFBTSxRQUFRLFdBQUssT0FBTyxXQUFXLFlBQVksSUFBSSxLQUFLLElBQUksTUFBaEQsbUJBQW1ELEtBQUssV0FBUyxNQUFNLFNBQVM7QUFDOUYsVUFBSSxPQUFPO0FBRVAsY0FBTSxlQUEyQixJQUFJLGFBQUcsTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLO0FBQ3RFLGNBQU0sV0FBVSxhQUFhLGVBQWU7QUFDNUMsY0FBTSxlQUFlLE1BQU0sS0FBSyxLQUFLLElBQUksRUFBRSxNQUFNO0FBQ2pELFlBQUksY0FBYztBQUVkLGdCQUFNLHFCQUFxQixTQUN0QixPQUFPLE9BQUssTUFBTSxTQUFTLENBQUMsTUFBTSxJQUFJLEVBQ3RDLEtBQUssT0FBSyxnQkFBZ0IsTUFBTSxTQUFTLENBQUMsR0FBRyxZQUFZLENBQUM7QUFDL0QsY0FBSSxvQkFBb0I7QUFFcEIsa0JBQU0sWUFBWSxhQUFhLFdBQVcsa0JBQWtCO0FBQzVELG1CQUFPLENBQUMsb0JBQW9CLE9BQU8sU0FBUztBQUFBLFVBQ2hEO0FBQUEsUUFDSjtBQUVBLGVBQU8sQ0FBQyxTQUFRLElBQUksT0FBTyxTQUFRLE1BQU0sU0FBUSxFQUFFO0FBQUEsTUFDdkQsV0FBVyxZQUFZLE1BQU0sU0FBUyxRQUFRLEdBQUc7QUFFN0MsZUFBTyxDQUFDLFVBQVUsUUFBVyxNQUFTO0FBQUEsTUFDMUM7QUFBQSxJQUNKO0FBRUEsV0FBTyxDQUFDLFFBQVcsUUFBVyxNQUFTO0FBQUEsRUFDM0M7QUFDSjs7O0FVblVBLHdCQUFnRTs7O0FDRGhFLHdCQUErRTtBQU8vRSxJQUFxQiwwQkFBckIsY0FBcUQsb0NBQXlCO0FBQUEsRUFJMUUsWUFDWSxRQUNBLE1BQ0EsT0FDUixvQkFDUSxhQUFxQixJQUNyQixRQUFpQixPQUNqQixTQUFrQixPQUNsQixZQUFxQixPQUMvQjtBQXBCTjtBQXFCUSxVQUFNLE9BQU8sR0FBRztBQVRSO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBVlosU0FBUSxnQkFBeUIsQ0FBQztBQWE5QixVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGdCQUFoQyxtQkFBNkM7QUFDM0QsUUFBSSxPQUFPO0FBQ1AsWUFBTSxpQkFBNkIsTUFBTSxRQUFRLGtCQUFrQixJQUFJLHFCQUFxQixDQUFDLGtCQUFrQjtBQUMvRyxxQkFBZSxRQUFRLFdBQVM7QUFDNUIsWUFBSSxNQUFNLE1BQU0sT0FBTyxLQUFLLEdBQUc7QUFDM0IsZ0JBQU0sUUFBTyxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixNQUFNLElBQUk7QUFDbkUsY0FBSSxpQkFBZ0I7QUFBTyxpQkFBSyxjQUFjLEtBQUssS0FBSTtBQUFBLFFBQzNEO0FBQUEsTUFDSixDQUFDO0FBQUEsSUFDTDtBQUNBLFNBQUssWUFBWSxTQUFTLGVBQWU7QUFBQSxFQUM3QztBQUFBLEVBRUEsU0FBUztBQUNMLFVBQU0sT0FBTztBQUNiLFNBQUssWUFBWSxZQUFZLENBQU8sTUFBTTtBQUN0QyxVQUFJLEVBQUUsT0FBTyxXQUFXLEVBQUUsUUFBUTtBQUM5QixVQUFFLGVBQWU7QUFDakIsY0FBTSxLQUFLLGNBQWM7QUFDekIsYUFBSyxNQUFNO0FBQUEsTUFDZjtBQUFBLElBQ0o7QUFDQSxVQUFNLGtCQUFrQixLQUFLLFlBQVksVUFBVSxFQUFFLEtBQUssaUJBQWlCLENBQUM7QUFDNUUsb0JBQWdCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUMzQyxVQUFNLGdCQUFnQixnQkFBZ0IsVUFBVSxFQUFFLEtBQUssT0FBTyxDQUFDO0FBQy9ELGtCQUFjLFFBQVEsbUJBQW1CO0FBRXpDLFVBQU0sZ0JBQWdCLElBQUksa0NBQWdCLGVBQWU7QUFDekQsa0JBQWMsUUFBUSxXQUFXO0FBQ2pDLGtCQUFjLFFBQVEsTUFBWTtBQUM5QixZQUFNLEtBQUssY0FBYztBQUN6QixXQUFLLE1BQU07QUFBQSxJQUNmLEVBQUM7QUFFRCxVQUFNLGVBQWUsSUFBSSxrQ0FBZ0IsZUFBZTtBQUN4RCxpQkFBYSxRQUFRLE9BQU87QUFDNUIsaUJBQWEsUUFBUSxNQUFNO0FBQUUsV0FBSyxNQUFNO0FBQUEsSUFBRyxDQUFDO0FBRTVDLFVBQU0sY0FBYyxJQUFJLGtDQUFnQixlQUFlO0FBQ3ZELGdCQUFZLFFBQVEsT0FBTztBQUMzQixnQkFBWSxRQUFRLE1BQVk7QUFDNUIsWUFBTSxLQUFLLFlBQVk7QUFDdkIsV0FBSyxNQUFNO0FBQUEsSUFDZixFQUFDO0FBQ0QsZ0JBQVksU0FBUyxTQUFTLFFBQVE7QUFFdEMsU0FBSyxRQUFRLFlBQVksZUFBZTtBQUFBLEVBQzVDO0FBQUEsRUFFQSxXQUFvQjtBQUNoQixVQUFNLGdCQUFnQixJQUFJLFNBQVMsS0FBSyxLQUFLLFVBQVUsS0FBSyxNQUFNLFFBQVEsZUFBZSxLQUFLLFNBQVUsR0FBVSxHQUFVO0FBQUUsYUFBTyxFQUFFLFdBQVcsRUFBRSxXQUFXLEtBQUs7QUFBQSxJQUFFO0FBQ3RLLFFBQUk7QUFDQSxZQUFNLGNBQWMsSUFBSSxhQUFhLEtBQUssTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLLEtBQUs7QUFDN0UsYUFBTyxZQUFZLFNBQVMsS0FBSyxJQUFJLEVBQUUsS0FBSyxhQUFhO0FBQUEsSUFDN0QsU0FBUyxPQUFQO0FBQ0UsV0FBSyxNQUFNO0FBQ1gsWUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUEsRUFFQSxZQUFZLE1BQXFCO0FBQzdCLFdBQU8sS0FBSztBQUFBLEVBQ2hCO0FBQUEsRUFFQSxBQUFNLGdCQUFnQjtBQUFBO0FBQ2xCLFlBQU0sU0FBUyxLQUFLLGNBQWMsSUFBSSxVQUFRO0FBdkZ0RDtBQXdGWSxjQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxZQUFJLFFBQTRCO0FBQ2hDLFlBQUksU0FBUyxLQUFLLE1BQU0sUUFBUSxpQkFBaUI7QUFDN0Msa0JBQVEsSUFBSSxTQUFTLFFBQVEsVUFBVSxLQUFLLE1BQU0sUUFBUSxpQkFBaUIsRUFBRSxNQUFNLEtBQUssS0FBSyxJQUFJLENBQUM7QUFBQSxRQUN0RztBQUNBLGVBQU8sY0FBRyxrQkFBa0IsS0FBSyxRQUFRLEtBQUssTUFBTSxLQUFLLFVBQVUsUUFBVyxLQUFLO0FBQUEsTUFDdkYsQ0FBQztBQUNELFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxNQUFNLE1BQU0sU0FBUyxFQUFFLE9BQU8sT0FBTyxLQUFLLElBQUksRUFBRSxFQUFFLENBQUMsR0FBRyxLQUFLLE1BQU0sS0FBSyxZQUFZLEtBQUssT0FBTyxLQUFLLFFBQVEsS0FBSyxTQUFTO0FBQUEsSUFDeks7QUFBQTtBQUFBLEVBRUEsQUFBTSxjQUFjO0FBQUE7QUFDaEIsWUFBTSxXQUFXLEtBQUssUUFBUSxDQUFDLEVBQUUsTUFBTSxLQUFLLE1BQU0sTUFBTSxTQUFTLEVBQUUsT0FBTyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEtBQUssSUFBSTtBQUFBLElBQ2hHO0FBQUE7QUFBQSxFQUVBLGlCQUFpQixPQUEwQixJQUFpQjtBQXRHaEU7QUF1R1EsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsUUFBSSxTQUFTLEtBQUssTUFBTSxRQUFRLGlCQUFpQjtBQUM3QyxZQUFNLHNCQUFzQixHQUFHLFVBQVUsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQ3BFLDBCQUFvQixVQUFVO0FBQUEsUUFDMUIsTUFBTSxJQUFJLFNBQVMsUUFBUSxVQUFVLEtBQUssTUFBTSxRQUFRLGlCQUFpQixFQUFFLE1BQU0sS0FBSyxNQUFNLEtBQUssSUFBSSxDQUFDO0FBQUEsTUFDMUcsQ0FBQztBQUNELFlBQU0sV0FBVyxvQkFBb0IsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQ2hFLGVBQVMsUUFBUSxNQUFNLEtBQUssSUFBSTtBQUFBLElBQ3BDLE9BQU87QUFDSCxTQUFHLFFBQVEsTUFBTSxLQUFLLFFBQVE7QUFBQSxJQUNsQztBQUNBLE9BQUcsU0FBUyxpQkFBaUI7QUFDN0IsVUFBTSxTQUFTLEtBQUssWUFBWSxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDM0QsT0FBRyxZQUFZLE1BQU07QUFFckIsUUFBSSxLQUFLLGNBQWMsS0FBSyxVQUFRLEtBQUssU0FBUyxNQUFNLEtBQUssSUFBSSxHQUFHO0FBQ2hFLFNBQUcsU0FBUyxlQUFlO0FBQzNCLFlBQU0sZ0JBQWdCLEdBQUcsVUFBVSxFQUFFLEtBQUssaUJBQWlCLENBQUM7QUFDNUQscUNBQVEsZUFBZSxjQUFjO0FBQUEsSUFDekM7QUFBQSxFQUNKO0FBQUEsRUFFQSxpQkFBaUI7QUFFYixVQUFNLFVBQVUsS0FBSztBQUNyQixVQUFNLGNBQWdDLFFBQVE7QUFDOUMsVUFBTSxTQUE4QixRQUFRO0FBRTVDLGdCQUFZLFFBQVEsQ0FBQyxHQUFHLE1BQU07QUFDMUIsVUFBSSxLQUFLLGNBQWMsS0FBSyxVQUFRLEtBQUssU0FBUyxPQUFPLEdBQUcsS0FBSyxJQUFJLEdBQUc7QUFDcEUsVUFBRSxTQUFTLGVBQWU7QUFDMUIsWUFBSSxFQUFFLGlCQUFpQixpQkFBaUIsRUFBRSxVQUFVLEdBQUc7QUFDbkQsZ0JBQU0sZ0JBQWdCLEVBQUUsVUFBVSxFQUFFLEtBQUssaUJBQWlCLENBQUM7QUFDM0QseUNBQVEsZUFBZSxjQUFjO0FBQUEsUUFDekM7QUFBQSxNQUNKLE9BQU87QUFDSCxVQUFFLFlBQVksZUFBZTtBQUM3QixVQUFFLGlCQUFpQixpQkFBaUIsRUFBRSxRQUFRLFVBQVEsS0FBSyxPQUFPLENBQUM7QUFBQSxNQUN2RTtBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLGlCQUFpQixPQUEwQixLQUF1QztBQUM5RSxRQUFJLEtBQUssY0FBYyxTQUFTLE1BQU0sSUFBSSxHQUFHO0FBQ3pDLFdBQUssY0FBYyxPQUFPLE1BQU0sSUFBSTtBQUFBLElBQ3hDLE9BQU87QUFDSCxXQUFLLGNBQWMsS0FBSyxNQUFNLElBQUk7QUFBQSxJQUN0QztBQUNBLFNBQUssZUFBZTtBQUFBLEVBQ3hCO0FBQUEsRUFFQSxBQUFNLGFBQWEsTUFBNEI7QUFBQTtBQUFBLElBQUU7QUFBQTtBQUVyRDs7O0FEbEpBLElBQXFCLGlCQUFyQixjQUE0QyxjQUFhO0FBQUEsRUFJckQsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLDJCQUFtQjtBQWdCNUMsU0FBUSxXQUFXLENBQUMsZ0JBQWlDO0FBRWpELFlBQU0sYUFBYSxDQUFDLFFBQStCO0FBQy9DLFlBQUk7QUFDQSxpQkFBUSxJQUFJLFNBQVMsTUFBTSxXQUFXLFVBQVUsS0FBSyxNQUFNLFFBQVEsZUFBZSxFQUFHLEtBQUssSUFBSSxLQUFLLDJDQUFhLElBQUksQ0FBQztBQUFBLFFBQ3pILFNBQVMsT0FBUDtBQUNFLGNBQUkseUJBQU8sMEJBQTBCLEtBQUssTUFBTTtBQUFBLHNCQUE4QixHQUFJO0FBQUEsUUFDdEY7QUFBQSxNQUNKO0FBQ0EsWUFBTSxXQUFXLEtBQUssT0FBTyxJQUFJLFFBQVEsUUFBUTtBQUVqRCxVQUFJLEtBQUssTUFBTSxRQUFRLGlCQUFpQixzQ0FBVSxTQUFTLHFCQUFvQixzQ0FBVSxTQUFTLHlCQUF3QjtBQUN0SCxZQUFJO0FBQ0EsZ0JBQU0sWUFBWSxXQUFXLFNBQVMsR0FBRyxFQUFFLE9BQU8sSUFBSSxDQUFDLE1BQVcsRUFBRSxLQUFLLElBQUk7QUFDN0UsaUJBQU8sS0FBSyxPQUFPLElBQUksTUFBTSxpQkFBaUIsRUFBRSxPQUFPLE9BQUssVUFBVSxTQUFTLEVBQUUsSUFBSSxDQUFDO0FBQUEsUUFDMUYsU0FBUyxPQUFQO0FBQ0UsZ0JBQU87QUFBQSxRQUNYO0FBQUEsTUFDSixPQUFPO0FBQ0gsZUFBTyxLQUFLLE9BQU8sSUFBSSxNQUFNLGlCQUFpQjtBQUFBLE1BQ2xEO0FBQUEsSUFDSjtBQUFBLEVBcENBO0FBQUEsRUFFQSxPQUFPLGtCQUFrQixRQUFzQixNQUFhLE1BQXNCO0FBQzlFLFVBQU0sV0FBVyxPQUFPLElBQUksY0FBYyxxQkFBcUIsTUFBTSxLQUFLLElBQUk7QUFDOUUsUUFBSSxVQUFVO0FBQ1YsYUFBTyxPQUFPLElBQUksWUFBWSxxQkFDMUIsVUFDQSxLQUFLLE1BQ0wsUUFDQSxTQUFTLFFBQ2I7QUFBQSxJQUNKO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQXlCQSxBQUFPLGVBQWUsTUFBYyxPQUFZLE1BQWEsVUFBZ0U7QUFDekgsVUFBTSxRQUFRLElBQUksd0JBQWUsS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLEtBQUs7QUFDckUsVUFBTSxTQUFTLE1BQU0sTUFBTSxLQUFLO0FBQ2hDLFFBQUksZUFBZSxPQUFPLFFBQVEsR0FBRztBQUNqQyxlQUFTLFFBQVEsQ0FBQyxTQUFTO0FBQ3ZCLGFBQUssU0FBUyxVQUFVLE1BQU07QUFDOUIsYUFBSyxRQUFRLFVBQVUsa0JBQWU7QUFDdEMsYUFBSyxRQUFRLE1BQU07QUFDbkIsYUFBSyxXQUFXLHNCQUFzQjtBQUFBLE1BQzFDLENBQUM7QUFBQSxJQUNMLFdBQVcsZUFBZSxVQUFVLFFBQVEsR0FBRztBQUMzQyxlQUFTLFFBQVEsS0FBSztBQUFBLFFBQ2xCLElBQUksVUFBVTtBQUFBLFFBQ2QsYUFBYSxtQkFBbUI7QUFBQSxRQUNoQztBQUFBLFFBQ0EsTUFBTSxVQUFVO0FBQUEsTUFDcEIsQ0FBQztBQUFBLElBQ0wsV0FBVyxlQUFlLGVBQWUsUUFBUSxHQUFHO0FBQ2hELGVBQVMsVUFBVSxVQUFVLG9CQUFpQixRQUFRLFVBQVUsY0FBYztBQUFBLElBQ2xGO0FBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFPLHdCQUNILE1BQ0EsbUJBQ0EsT0FDQSxZQUNBLE9BQ0EsUUFDQSxXQUNPO0FBQ1AsVUFBTSxhQUFhLElBQUksd0JBQWUsS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLE9BQU8sWUFBWSxPQUFPLFFBQVEsU0FBUztBQUNoSCxlQUFXLFFBQVEsUUFBUSxtQkFBbUIsbUJBQW1CO0FBQ2pFLGVBQVcsS0FBSztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxBQUFPLGNBQ0gsSUFDQSxHQUNBLGdCQUNBLFFBQTJGLENBQUMsR0FDeEY7QUEvRlo7QUFnR1EsVUFBTSxNQUFNO0FBQ1osbUJBQWUsWUFBWSxHQUFHLEdBQUcsUUFBUSxFQUFFLEtBQUssTUFBTSxPQUFPLEtBQUssQ0FBQztBQUVuRSxVQUFNLFlBQVksZUFBZSxTQUFTLFFBQVE7QUFDbEQsbUNBQVEsV0FBVyxVQUFVLGtCQUFlO0FBQzVDLFVBQU0sU0FBUyxlQUFlLFNBQVMsT0FBTyxFQUFFLEtBQUssU0FBUyxDQUFDO0FBRS9ELFVBQU0sT0FBTyxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixFQUFFLFFBQVEsT0FBTztBQUMxRSxRQUFJO0FBQ0osUUFBSSxnQkFBZ0IsMkJBQVMsS0FBSyxhQUFhLE1BQU07QUFDakQsbUJBQWEsSUFBSSx3QkFBZSxLQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sRUFBRSxLQUFLLE1BQU0sS0FBSztBQUFBLElBQ3JGLE9BQU87QUFDSCxZQUFNLE1BQU0sMENBQTBDO0FBQUEsSUFDMUQ7QUFDQSxjQUFVLFVBQVUsTUFBTTtBQUN0QixpQkFBVyxLQUFLO0FBQUEsSUFDcEI7QUFFQSxRQUFJLENBQUMsc0NBQU8sWUFBUCxtQkFBZ0IsV0FBVTtBQUMzQixnQkFBVSxLQUFLO0FBQ2YsYUFBTyxLQUFLO0FBQ1oscUJBQWUsY0FBYyxNQUFNO0FBQy9CLGtCQUFVLEtBQUs7QUFDZixlQUFPLEtBQUs7QUFBQSxNQUNoQjtBQUNBLHFCQUFlLGFBQWEsTUFBTTtBQUM5QixrQkFBVSxLQUFLO0FBQ2YsZUFBTyxLQUFLO0FBQUEsTUFDaEI7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBUSxvQkFBb0IsV0FBaUM7QUFDekQsVUFBTSw0QkFBNEIsVUFBVSxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDekUsOEJBQTBCLFNBQVMsUUFBUSxFQUFFLE1BQU0sNkJBQTZCLEtBQUssZUFBZSxDQUFDO0FBQ3JHLFVBQU0seUJBQXlCLDBCQUEwQixVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUM3RixTQUFLLGdCQUFnQixJQUFJLG9DQUFrQixzQkFBc0I7QUFDakUsU0FBSyxjQUFjLFFBQVEsT0FBTztBQUNsQyxTQUFLLGNBQWMsUUFBUSxPQUFPO0FBQ2xDLFNBQUssY0FBYyxTQUFTLEtBQUssTUFBTSxRQUFRLGlCQUFpQixFQUFFO0FBQ2xFLFNBQUssY0FBYyxRQUFRLFNBQVMsWUFBWTtBQUNoRCxTQUFLLGNBQWMsU0FBUyxXQUFTO0FBQ2pDLFdBQUssTUFBTSxRQUFRLGdCQUFnQjtBQUNuQyx5QkFBbUIsc0JBQXNCLEtBQUssYUFBYTtBQUFBLElBQy9ELENBQUM7QUFHRCxVQUFNLCtCQUErQixVQUFVLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUM1RSxpQ0FBNkIsU0FBUyxRQUFRLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFDL0QsaUNBQTZCLFNBQVMsUUFBUSxFQUFFLE1BQU0sb0hBQW9ILEtBQUssV0FBVyxDQUFDO0FBQzNMLGlDQUE2QixTQUFTLFFBQVE7QUFBQSxNQUMxQyxNQUFNO0FBQUEsSUFDVixDQUFDO0FBQ0QsVUFBTSw0QkFBNEIsNkJBQTZCLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ25HLFVBQU0sa0JBQWtCLElBQUksb0NBQWtCLHlCQUF5QjtBQUN2RSxvQkFBZ0IsUUFBUSxPQUFPO0FBQy9CLG9CQUFnQixRQUFRLE9BQU87QUFDL0Isb0JBQWdCLFFBQVEsU0FBUyxZQUFZO0FBQzdDLG9CQUFnQixTQUFTLEtBQUssTUFBTSxRQUFRLG1CQUFtQixFQUFFO0FBQ2pFLG9CQUFnQixlQUFlLDhKQUV5RDtBQUN4RixvQkFBZ0IsU0FBUyxXQUFTO0FBQzlCLFdBQUssTUFBTSxRQUFRLGtCQUFrQjtBQUNyQyx5QkFBbUIsc0JBQXNCLGVBQWU7QUFBQSxJQUM1RCxDQUFDO0FBRUQsVUFBTSw0QkFBNEIsVUFBVSxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDekUsOEJBQTBCLFNBQVMsUUFBUSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDcEUsOEJBQTBCLFNBQVMsUUFBUSxFQUFFLE1BQU0saUhBQWlILEtBQUssV0FBVyxDQUFDO0FBQ3JMLDhCQUEwQixTQUFTLFFBQVE7QUFBQSxNQUN2QyxNQUFNO0FBQUEsSUFDVixDQUFDO0FBQ0QsVUFBTSx5QkFBeUIsMEJBQTBCLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzdGLFVBQU0sZ0JBQWdCLElBQUksb0NBQWtCLHNCQUFzQjtBQUNsRSxrQkFBYyxRQUFRLE9BQU87QUFDN0Isa0JBQWMsUUFBUSxPQUFPO0FBQzdCLGtCQUFjLFFBQVEsU0FBUyxZQUFZO0FBQzNDLGtCQUFjLFNBQVMsS0FBSyxNQUFNLFFBQVEsaUJBQWlCLEVBQUU7QUFDN0Qsa0JBQWMsZUFBZSxnTUFHOEM7QUFDM0Usa0JBQWMsU0FBUyxXQUFTO0FBQzVCLFdBQUssTUFBTSxRQUFRLGdCQUFnQjtBQUNuQyx5QkFBbUIsc0JBQXNCLGFBQWE7QUFBQSxJQUMxRCxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBTyx1QkFBdUIsaUJBQWlDLFFBQXNCLFVBQWtDO0FBQ25ILFNBQUssb0JBQW9CLGVBQWU7QUFBQSxFQUM1QztBQUFBLEVBRUEsQUFBTyxnQkFBd0I7QUFDM0IsV0FBTyxLQUFLLE1BQU0sUUFBUSxpQkFBaUI7QUFBQSxFQUMvQztBQUFBLEVBRUEsQUFBTyxrQkFBMkI7QUFDOUIsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLEFBQU8sY0FBYyxPQUFnRTtBQUVqRixXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsQUFBTyxhQUFhLFdBQTJCLE1BQWEsV0FBbUIsU0FBeUI7QUExTTVHO0FBMk1RLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFFBQUksT0FBTztBQUNQLFlBQU0sVUFBVSxNQUFNLEtBQUssS0FBSyxJQUFJLEVBQUU7QUFDdEMsWUFBTSxTQUFTLE1BQU0sUUFBUSxPQUFPLElBQUksVUFBVSxDQUFDLE9BQU87QUFDMUQsYUFBTyxRQUFRLENBQUMsT0FBTyxNQUFNO0FBQ3pCLFlBQUksTUFBTSxNQUFNLE9BQU8sS0FBSyxHQUFHO0FBQzNCLGdCQUFNLE9BQU8sVUFBVSxTQUFTLEtBQUssRUFBRSxNQUFNLE1BQU0sS0FBSyxNQUFNLEdBQUcsRUFBRSxLQUFLLEVBQUUsUUFBUSxXQUFXLElBQUksRUFBRSxDQUFDO0FBQ3BHLGVBQUssVUFBVSxNQUFNO0FBQ2pCLGlCQUFLLE9BQU8sSUFBSSxVQUFVLGFBQWEsTUFBTSxNQUFNLEtBQUssTUFBTSxJQUFJO0FBQ2xFLG9CQUFRO0FBQUEsVUFDWjtBQUFBLFFBQ0osT0FBTztBQUNILG9CQUFVLFVBQVUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUFBLFFBQ3ZDO0FBQ0EsWUFBSSxJQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3ZCLG9CQUFVLFNBQVMsUUFBUSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQUEsUUFDOUM7QUFBQSxNQUNKLENBQUM7QUFBQSxJQUNMO0FBQ0EsY0FBVSxVQUFVO0FBQUEsRUFDeEI7QUFDSjs7O0FFL05BLHdCQUFrRzs7O0FDQWxHLHdCQUE4Qjs7O0FDQTlCLHdCQUFzQjtBQUd0QixtQkFBZ0MsUUFBc0IsZ0JBQWdDLFdBQXNDO0FBQUE7QUFKNUg7QUFLSSxRQUFJO0FBQ0osUUFBSSwwQkFBMEIseUJBQU87QUFDakMsYUFBTztBQUFBLElBQ1gsT0FBTztBQUNILFlBQU0sUUFBUSxPQUFPLElBQUksTUFBTSxzQkFBc0IsY0FBYztBQUNuRSxVQUFJLGlCQUFpQiwyQkFBUyxNQUFNLGFBQWEsTUFBTTtBQUNuRCxlQUFPO0FBQUEsTUFDWCxPQUFPO0FBQ0gsY0FBTSxNQUFNLDBDQUEwQztBQUFBLE1BQzFEO0FBQUEsSUFDSjtBQUNBLFVBQU0sVUFBVyxPQUFNLE9BQU8sSUFBSSxNQUFNLEtBQUssSUFBSSxHQUFHLE1BQU0sSUFBSTtBQUM5RCxVQUFNLGNBQWMsYUFBTyxJQUFJLGNBQWMsYUFBYSxJQUFJLE1BQTFDLG1CQUE2QztBQUNqRSxVQUFNLEVBQUUsVUFBVSxFQUFFLGVBQU8sZ0JBQVUsY0FBYyxjQUFjLEVBQUUsVUFBVSxFQUFFLE9BQU8sUUFBVyxLQUFLLE9BQVUsRUFBRTtBQUNsSCxVQUFNLFNBQW1CLENBQUM7QUFDMUIsWUFBUSxJQUFJLENBQUMsTUFBTSxNQUFNO0FBQ3JCLFVBQUksVUFBUyxRQUFPLEtBQUssT0FBTSxRQUFRLEtBQUssS0FBSSxNQUFNO0FBQ2xELGNBQU0sUUFBUSxJQUFJLE9BQU8sR0FBRyxrQkFBa0IsR0FBRztBQUNqRCxjQUFNLElBQUksS0FBSyxNQUFNLEtBQUs7QUFDMUIsWUFBSSxLQUFLLEVBQUUsU0FBUztBQUFHLGlCQUFPLEtBQUssRUFBRSxFQUFFO0FBQUEsTUFDM0MsT0FBTztBQUNILGNBQU0saUJBQWdCLElBQUksT0FBTyxJQUFJLGlCQUFpQixTQUFTLHVCQUF1QixHQUFHO0FBQ3pGLGNBQU0sS0FBSyxXQUFXLElBQUksRUFBRSxNQUFNLGNBQWE7QUFDL0MsWUFBSSx5QkFBSSxRQUFRO0FBQUUsaUJBQU8sS0FBSyxXQUFXLEdBQUcsT0FBTyxNQUFNLENBQUM7QUFBQSxRQUFFO0FBQUM7QUFDN0QsY0FBTSwyQkFBMEIsSUFBSSxPQUFPLE1BQU0saUJBQWlCLFNBQVMsMkJBQTJCLElBQUk7QUFDMUcsY0FBTSxNQUFNLFdBQVcsSUFBSSxFQUFFLFNBQVMsd0JBQXVCO0FBQzdELFlBQUksT0FBTyxJQUFJLEtBQUs7QUFDcEIsZUFBTyxDQUFDLEtBQUssTUFBTTtBQUNmLGNBQUksS0FBSyxNQUFNLFFBQVE7QUFBRSxtQkFBTyxLQUFLLFdBQVcsS0FBSyxNQUFNLE9BQU8sTUFBTSxDQUFDO0FBQUEsVUFBRTtBQUMzRSxpQkFBTyxJQUFJLEtBQUs7QUFBQSxRQUNwQjtBQUNBLGNBQU0sc0JBQXFCLElBQUksT0FBTyxNQUFNLGlCQUFpQixTQUFTLDJCQUEyQixJQUFJO0FBQ3JHLGNBQU0sTUFBTSxXQUFXLElBQUksRUFBRSxTQUFTLG1CQUFrQjtBQUN4RCxlQUFPLElBQUksS0FBSztBQUNoQixlQUFPLENBQUMsS0FBSyxNQUFNO0FBQ2YsY0FBSSxLQUFLLE1BQU0sUUFBUTtBQUFFLG1CQUFPLEtBQUssV0FBVyxLQUFLLE1BQU0sT0FBTyxNQUFNLENBQUM7QUFBQSxVQUFFO0FBQzNFLGlCQUFPLElBQUksS0FBSztBQUFBLFFBQ3BCO0FBQUEsTUFDSjtBQUFBLElBQ0osQ0FBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUE7OztBRHZDTyxnQ0FBZ0MsR0FBVyxHQUFXO0FBQ3pELFFBQU0sV0FBVyxFQUFFLE1BQU0sR0FBRyxFQUFFLElBQUksT0FBSyxFQUFFLEtBQUssQ0FBQztBQUMvQyxRQUFNLFdBQVcsRUFBRSxNQUFNLEdBQUcsRUFBRSxJQUFJLE9BQUssRUFBRSxLQUFLLENBQUM7QUFDL0MsU0FBTyxTQUFTLE1BQU0sVUFBUSxTQUFTLFNBQVMsSUFBSSxDQUFDLEtBQUssU0FBUyxNQUFNLFVBQVEsU0FBUyxTQUFTLElBQUksQ0FBQztBQUM1RztBQUVBLDBCQUFnQyxRQUFzQixNQUFhLFdBQW1CO0FBQUE7QUFidEY7QUFjSSxVQUFNLFdBQVksWUFBTSxVQUFVLFFBQVEsTUFBTSxTQUFTLE1BQXZDLG1CQUE0QztBQUM5RCxVQUFNLFFBQVEsSUFBSSxPQUFPLG1CQUFvQix1Q0FBd0M7QUFDckYsVUFBTSxLQUFLLFNBQVMsTUFBTSxLQUFLO0FBQy9CLFdBQU8sMEJBQUksV0FBVSxZQUFZLDBCQUFJLFVBQVMsR0FBRyxPQUFPLFNBQVM7QUFBQSxFQUNyRTtBQUFBO0FBRUEsdUJBQ0ksUUFDQSxTQUFpQixJQUNqQixnQkFDQSxpQkFBMEIsT0FDYjtBQUFBO0FBekJqQjtBQTBCSSxVQUFNLFNBQVEsS0FBSyxJQUFJO0FBRXZCLFVBQU0sSUFBSSxPQUFPO0FBQ2pCLFFBQUksa0JBQTRCLENBQUM7QUFDakMsVUFBTSxXQUEwQyxDQUFDO0FBQ2pELFVBQU0sZ0JBQTBCLENBQUM7QUFDakMsYUFBUyxNQUFNLEVBQUUsZ0JBQWdCLEtBQUssR0FBRztBQUNyQyxZQUFNLGFBQWEsV0FBQyxtRUFBa0U7QUFDdEYsWUFBTSxFQUFFLFVBQVUsZUFBZSxjQUFjLFVBQUcsTUFBTSxVQUFVLE1BQW5CLG1CQUFzQixXQUFVLENBQUM7QUFDaEYsWUFBTSxRQUFRLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixRQUFRO0FBQzdELFlBQU0sUUFBUSxhQUFPLElBQUksUUFBUSxRQUFRLGFBQTNCLG1CQUFxQztBQUNuRCxZQUFNLFNBQVMsU0FBUyxNQUFNLEtBQUssTUFBTSxJQUFJO0FBQzdDLFVBQUksU0FBUyxRQUFRO0FBQ2pCLGlCQUFTLFlBQVksU0FBUyxhQUFhLENBQUM7QUFDNUMsWUFBSSxXQUFXO0FBQ2YsY0FBTSxRQUFRLEVBQUUsZ0JBQWdCLElBQUksRUFBRTtBQUN0QyxjQUFNLFFBQVEsUUFBRSxZQUFZLElBQUksUUFBUSxNQUExQixtQkFBNkIsS0FBSyxZQUFTLE9BQU0sUUFBUTtBQUN2RSxZQUFJLE9BQU87QUFDUCxnQkFBTSxhQUFhLE1BQU0sUUFBUTtBQUNqQyxjQUFJLENBQUMsRUFBRSw4QkFBOEIsSUFBSSxFQUFFO0FBQUcsY0FBRSw4QkFBOEIsSUFBSSxJQUFJLFVBQVU7QUFDaEcsa0JBQVE7QUFBQSxpQkFDQztBQUFBLGlCQUNBO0FBQ0Q7QUFDSSxzQkFBTSxpQkFBaUIsK0JBQU8sSUFBSSxDQUFDLFlBQWdCO0FBQy9DLHlCQUFPLGNBQWEsa0JBQWtCLFFBQVEsT0FBTyxRQUFPLEtBQUssSUFBSTtBQUFBLGdCQUN6RTtBQUNBLDJCQUFZLG1CQUFrQixDQUFDLEdBQUcsS0FBSyxJQUFJO0FBQUEsY0FDL0M7QUFDQTtBQUFBLGlCQUNDO0FBQUEsaUJBQ0E7QUFDRDtBQUNJLHNCQUFNLG9CQUFvQixJQUFJLFNBQVMsUUFBUSxVQUFVLE1BQU0sUUFBUSxvQkFBb0I7QUFDM0Ysc0JBQU0saUJBQWlCLCtCQUFPLElBQUksQ0FBQyxZQUFnQjtBQUMvQyxzQkFBSTtBQUNBLDJCQUFPLGtCQUFrQixPQUFNO0FBQUEsa0JBQ25DLFNBQVEsR0FBTjtBQUNFLHdCQUFJLENBQUMsZ0JBQWdCLFNBQVMsTUFBTSxJQUFJO0FBQUcsc0NBQWdCLEtBQUssTUFBTSxJQUFJO0FBQzFFLDJCQUFPO0FBQUEsa0JBQ1g7QUFBQSxnQkFDSjtBQUNBLDJCQUFZLG1CQUFrQixDQUFDLEdBQUcsS0FBSyxJQUFJO0FBQUEsY0FDL0M7QUFDQTtBQUFBLGlCQUNDO0FBQ0Q7QUFDSSxzQkFBTSw0QkFBNEIsTUFBTSxRQUFRO0FBRWhELHNCQUFNLHNCQUFzQixJQUFJLFNBQVMsU0FDckMsMEJBQ0ssUUFBUSxnQ0FBZ0MsTUFBTSxRQUFRLG1CQUFtQixDQUFDO0FBQ25GLG9CQUFJO0FBQ0EsNkJBQVcsb0JBQW9CLEtBQUssRUFBRSxTQUFTO0FBQUEsZ0JBQ25ELFNBQVEsR0FBTjtBQUNFLHNCQUFJLENBQUMsZ0JBQWdCLFNBQVMsTUFBTSxJQUFJO0FBQUcsb0NBQWdCLEtBQUssTUFBTSxJQUFJO0FBQzFFLDZCQUFXO0FBQUEsZ0JBQ2Y7QUFBQSxjQUNKO0FBQ0E7QUFBQSxpQkFDQztBQUNEO0FBQ0ksc0JBQU0sa0JBQWtCLE1BQU0sUUFBUTtBQUN0QyxzQkFBTSxzQkFBc0IsSUFBSSxTQUFTLFNBQ3JDLEFBQU8sMkJBQTJCLGlCQUM3QixRQUFRLGdDQUFnQyxNQUFNLFFBQVEsbUJBQW1CLENBQUM7QUFDbkYsb0JBQUk7QUFDQSw2QkFBVyxvQkFBb0IsS0FBSyxFQUFFLFNBQVM7QUFBQSxnQkFDbkQsU0FBUSxHQUFOO0FBQ0Usc0JBQUksQ0FBQyxnQkFBZ0IsU0FBUyxNQUFNLElBQUk7QUFBRyxvQ0FBZ0IsS0FBSyxNQUFNLElBQUk7QUFDMUUsNkJBQVc7QUFBQSxnQkFDZjtBQUFBLGNBQ0o7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUdSLGdCQUFNLGVBQWUsRUFBRSx5QkFBeUIsSUFBSSxFQUFFLEtBQUssT0FBTSxpQkFBaUIsUUFBUSxPQUFPLE1BQU0sSUFBSSxNQUFLO0FBQ2hILGdCQUFNLHVCQUNGLE1BQU0sUUFBUSxjQUNkLE1BQU0sUUFBUSxlQUFlLFVBQzdCLGtCQUVJLGtEQUFnQixLQUFLLFVBQVMsTUFBTSxRQUNwQyxrREFBZ0IsZUFBYyxNQUFNO0FBRTVDLGdCQUFNLGtCQUFtQixDQUFDLGdCQUFnQixhQUFhLE1BQU8sQ0FBQyx1QkFBdUIsY0FBYyxRQUFRO0FBQzVHLGdCQUFNLG1CQUFtQixlQUFlLEVBQUUsOEJBQThCLElBQUksRUFBRTtBQUM5RSxjQUFJLHNCQUFzQjtBQUN0QixjQUFFLHlCQUF5QixJQUFJLElBQUksUUFBUTtBQUMzQyxjQUFFLDhCQUE4QixJQUFJLElBQUksVUFBVTtBQUFBLFVBQ3REO0FBQ0EsY0FBSSx3QkFBeUIsb0JBQW1CLG1CQUFtQjtBQUMvRCxrQkFBTSxzQkFBc0IsT0FBTyxXQUFXLDhCQUE4QixJQUFJLEVBQUUsS0FBSztBQUN2RixxQkFBUyxVQUFVLEtBQUssRUFBRSxNQUFNLFdBQVcsU0FBUyxFQUFFLE9BQU8sVUFBVSxvQkFBb0Isb0JBQW9CLEVBQUUsQ0FBQztBQUNsSCwwQkFBYyxLQUFLLEdBQUcsYUFBYSxXQUFXO0FBQUEsVUFHbEQsV0FBVyxXQUFXLGNBQWM7QUFDaEMsbUJBQU8sV0FBVyxjQUFjO0FBQUEsVUFDcEM7QUFDQSxjQUFJLENBQUMsbUJBQW1CLENBQUMsa0JBQWtCO0FBQ3ZDLGNBQUUsdUJBQXVCLElBQUksR0FBRyxhQUFhLGFBQWEseUJBQXNCO0FBQUEsVUFDcEY7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFDQSxXQUFPLFFBQVEsUUFBUSxFQUFFLFFBQVEsQ0FBTyxPQUF3QixlQUF4QixLQUF3QixXQUF4QixDQUFDLFVBQVUsVUFBYTtBQUM1RCxVQUFJLFFBQVE7QUFBUSxjQUFNLFdBQVcsUUFBUSxTQUFTLFFBQVE7QUFBQSxJQUNsRSxFQUFDO0FBQ0Qsa0JBQWMsUUFBUSxXQUFTLEVBQUUsdUJBQXVCLElBQUksT0FBTyx5QkFBc0IsQ0FBQztBQUMxRixRQUFJLGdCQUFnQjtBQUFRLFVBQUkseUJBQU87QUFBQSxFQUE0RCxnQkFBZ0IsS0FBSyxLQUFLLEdBQUc7QUFBQSxFQUVwSTtBQUFBOzs7QUQ5SEEsSUFBcUIsY0FBckIsY0FBeUMsY0FBYTtBQUFBLEVBRWxELFlBQVksUUFBc0IsT0FBYztBQUM1QyxVQUFNLFFBQVEsT0FBTyxxQkFBZ0I7QUFDckMsU0FBSyxrQkFBa0I7QUFBQSxFQUMzQjtBQUFBLEVBRUEsZUFBZSxNQUFjLE9BQWUsTUFBYSxVQUFnRTtBQUNySCxRQUFJLENBQUMsS0FBSyxNQUFNLFFBQVEsY0FBYyxLQUFLLE1BQU0sUUFBUSxlQUFlLFFBQVc7QUFDL0UsWUFBTSxJQUFJLEtBQUssT0FBTztBQUN0QixZQUFNLEtBQUssR0FBRyxLQUFLLFNBQVMsS0FBSyxNQUFNO0FBQ3ZDLFVBQUk7QUFDSixlQUFTLEVBQUUsdUJBQXVCLElBQUksRUFBRSxLQUFLO0FBRzdDLFVBQ0ksRUFBRSw4QkFBOEIsSUFBSSxHQUFHLEtBQUssa0JBQWtCLEtBQUssTUFBTSxtQkFBbUIsS0FBSyxNQUFNLE1BQU0sTUFDN0csS0FBSyxNQUFNLFFBQVE7QUFDckIsaUJBQVM7QUFDWCxZQUFNLE9BQU8sV0FBVywwQkFBaUIsZ0JBQWdCO0FBQ3pELFlBQU0sU0FBUyxNQUFNO0FBQUUsc0JBQWMsS0FBSyxRQUFRLGtCQUFrQixFQUFFLE1BQVksV0FBVyxLQUFLLE1BQU0sS0FBSyxDQUFDO0FBQUEsTUFBRTtBQUNoSCxVQUFJLFlBQVksT0FBTyxRQUFRLEtBQUssV0FBVyx5QkFBZ0I7QUFDM0QsaUJBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsZUFBSyxTQUFTLFdBQVcsT0FBTztBQUNoQyxlQUFLLFFBQVEsSUFBSTtBQUNqQixlQUFLLFFBQVEsTUFBTTtBQUNuQixlQUFLLFdBQVcsc0JBQXNCO0FBQUEsUUFDMUMsQ0FBQztBQUFBLE1BQ0wsV0FBVyxZQUFZLFVBQVUsUUFBUSxLQUFLLFdBQVcseUJBQWdCO0FBQ3JFLGlCQUFTLFFBQVEsS0FBSztBQUFBLFVBQ2xCLElBQUksVUFBVTtBQUFBLFVBQ2QsYUFBYSxtQkFBbUI7QUFBQSxVQUNoQztBQUFBLFVBQ0E7QUFBQSxRQUNKLENBQUM7QUFBQSxNQUVMLFdBQVcsWUFBWSxlQUFlLFFBQVEsS0FBSyxXQUFXLHlCQUFnQjtBQUMxRSxpQkFBUyxVQUFVLE1BQU0sUUFBUSxVQUFVLGNBQWM7QUFBQSxNQUM3RCxXQUFXLFlBQVksZUFBZSxRQUFRLEtBQUssV0FBVywyQkFBaUI7QUFDM0UsaUJBQVMsVUFBVSxNQUFNLE1BQU07QUFBQSxRQUFFLEdBQUcsR0FBRyxvQkFBb0I7QUFBQSxNQUMvRDtBQUFBLElBQ0osV0FBVyxZQUFZLGVBQWUsUUFBUSxHQUFHO0FBQzdDLGVBQVMsVUFBVSxjQUFjLE1BQU07QUFBQSxNQUFFLEdBQUcsR0FBRyx3QkFBd0IsVUFBVTtBQUFBLElBQ3JGO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBTSx3QkFDRixNQUNBLG1CQUNBLE9BQ0EsWUFDQSxPQUNBLFFBQ0EsV0FDYTtBQUFBO0FBQ2IsWUFBTSxXQUFXLEtBQUssUUFBUSxDQUFDLEVBQUUsTUFBTSxLQUFLLE1BQU0sTUFBTSxTQUFTLEVBQUUsT0FBTyxHQUFHLEVBQUUsQ0FBQyxHQUFHLE1BQU0sWUFBWSxPQUFPLFFBQVEsU0FBUztBQUFBLElBQ2pJO0FBQUE7QUFBQSxFQUVBLGNBQWMsSUFBUyxHQUFRLGdCQUE2QixPQUFzSTtBQXhFdE07QUF5RVEsVUFBTSxPQUFPLEVBQUU7QUFDZixVQUFNLFlBQVksS0FBSyxNQUFNO0FBQzdCLFVBQU0sZ0JBQWdCLGtCQUFLLE9BQU8sV0FBVyxZQUFZLElBQUksS0FBSyxJQUFJLE1BQWhELG1CQUFtRCxLQUFLLE9BQUssRUFBRSxTQUFTLGVBQXhFLG1CQUFvRixrQkFBaUI7QUFDM0gsVUFBTSxhQUFhLEdBQUcsR0FBRyxRQUFRLEtBQUssT0FBTyxXQUFXLHlCQUF5QixJQUFJLEdBQUcsS0FBSyxrQkFBa0IsbUJBQW1CLFdBQVcsR0FBRyxLQUFLO0FBQ3JKLG1CQUFlLFlBQVksVUFBVTtBQUFBLEVBQ3pDO0FBQUEsRUFFQSxBQUFRLHFDQUFxQyxrQkFBZ0YsT0FBaUM7QUFDMUoscUJBQWlCLFFBQVEsaUJBQWU7QUFqRmhEO0FBa0ZZLFVBQUksWUFBWSxHQUFHLFNBQVMsS0FBSyxHQUFHO0FBQ2hDLDBCQUFZLE9BQVosbUJBQWdCO0FBQUEsTUFDcEIsT0FBTztBQUNILDBCQUFZLE9BQVosbUJBQWdCO0FBQUEsTUFDcEI7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFPLGFBQWEsV0FBMkIsTUFBYSxXQUFtQixZQUFZLE1BQU07QUFBQSxFQUFFLEdBQVM7QUExRmhIO0FBMkZRLFVBQU0sZ0JBQWdCLGtCQUFLLE9BQU8sV0FBVyxZQUFZLElBQUksS0FBSyxJQUFJLE1BQWhELG1CQUFtRCxLQUFLLE9BQUssRUFBRSxTQUFTLGVBQXhFLG1CQUFvRixrQkFBaUI7QUFDM0gsY0FBVSxVQUFVLEVBQUUsTUFBTSxLQUFLLE9BQU8sV0FBVyx5QkFBeUIsSUFBSSxHQUFHLEtBQUssa0JBQWtCLG1CQUFtQixXQUFXLEVBQUUsQ0FBQztBQUFBLEVBQy9JO0FBQUEsRUFFQSxBQUFRLHNDQUFzQyx3QkFBd0MsT0FBaUM7QUFDbkgsS0FBQyx3Q0FBNEIsU0FBUyxHQUFHLDBDQUE2QixTQUFTLENBQUMsRUFBRSxTQUFTLEtBQUssSUFDNUYsdUJBQXVCLEtBQUssSUFBSSx1QkFBdUIsS0FBSztBQUFBLEVBQ3BFO0FBQUEsRUFFQSxBQUFRLHNCQUFzQixXQUFpQztBQUUzRCxVQUFNLHlCQUF5QixVQUFVLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUN0RSxVQUFNLHNCQUFzQix1QkFBdUIsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDdkYsd0JBQW9CLFNBQVMsUUFBUSxFQUFFLE1BQU0sMkJBQTJCLEtBQUssUUFBUSxDQUFDO0FBQ3RGLHdCQUFvQixVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDL0MsVUFBTSxhQUFhLElBQUksa0NBQWdCLG1CQUFtQjtBQUMxRCwyQkFBdUIsU0FBUyxRQUFRLEVBQUUsTUFBTSx5REFBeUQsS0FBSyxtQkFBbUIsQ0FBQztBQUVsSSxRQUFJLEtBQUssTUFBTSxRQUFRLGVBQWU7QUFBVyxXQUFLLE1BQU0sUUFBUSxhQUFhO0FBQ2pGLGVBQVcsU0FBUyxLQUFLLE1BQU0sUUFBUSxVQUFVO0FBQ2pELGVBQVcsU0FBUyxXQUFTO0FBQ3pCLFdBQUssTUFBTSxRQUFRLGFBQWE7QUFBQSxJQUNwQyxDQUFDO0FBSUQsVUFBTSw0QkFBNEIsVUFBVSxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDekUsOEJBQTBCLFNBQVMsUUFBUSxFQUFFLE1BQU0sc0RBQXNELEtBQUssUUFBUSxDQUFDO0FBQ3ZILDhCQUEwQixTQUFTLFFBQVEsRUFBRSxNQUFNLGdEQUFnRCxLQUFLLFdBQVcsQ0FBQztBQUNwSCxVQUFNLHlCQUF5QiwwQkFBMEIsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDN0YsVUFBTSxnQkFBZ0IsSUFBSSxvQ0FBa0Isc0JBQXNCO0FBQ2xFLGtCQUFjLFFBQVEsU0FBUyxZQUFZO0FBQzNDLGtCQUFjLFFBQVEsT0FBTztBQUM3QixrQkFBYyxRQUFRLE9BQU87QUFDN0Isa0JBQWMsU0FBUyxLQUFLLE1BQU0sUUFBUSxpQkFBaUIsRUFBRTtBQUM3RCxrQkFBYyxlQUFlLDhCQUE4QjtBQUUzRCxrQkFBYyxTQUFTLFdBQVM7QUFDNUIsV0FBSyxNQUFNLFFBQVEsZ0JBQWdCO0FBQ25DLHlCQUFtQixzQkFBc0IsYUFBYTtBQUFBLElBQzFELENBQUM7QUFFRCxVQUFNLDBCQUEwQixVQUFVLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUN2RSxVQUFNLHVCQUF1Qix3QkFBd0IsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDekYseUJBQXFCLFNBQVMsUUFBUSxFQUFFLE1BQU0sNkJBQTZCLEtBQUssUUFBUSxDQUFDO0FBQ3pGLFVBQU0sa0JBQWtCLElBQUksZ0NBQWMsb0JBQW9CO0FBQzlELG9CQUFnQixRQUFRLFNBQVMsWUFBWTtBQUM3QyxvQkFBZ0IsUUFBUSxTQUFTLFlBQVk7QUFDN0MsNEJBQXdCLFNBQVMsUUFBUSxFQUFFLE1BQU0seUZBQXlGLEtBQUssV0FBVyxDQUFDO0FBQzNKLG9CQUFnQixTQUFTLEtBQUssTUFBTSxRQUFRLG1CQUFtQixFQUFFO0FBQ2pFLG9CQUFnQixTQUFTLFdBQVM7QUFDOUIsV0FBSyxNQUFNLFFBQVEsa0JBQWtCO0FBQ3JDLHlCQUFtQixzQkFBc0IsZUFBZTtBQUFBLElBQzVELENBQUM7QUFHRCxVQUFNLHNCQUFzQixVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzFFLFNBQUssTUFBTSxRQUFRLGFBQWEsS0FBSyxNQUFNLFFBQVEsY0FBYztBQUNqRSx3QkFBb0IsU0FBUyxRQUFRLEVBQUUsTUFBTSxrQkFBa0IsS0FBSyxRQUFRLENBQUM7QUFDN0Usd0JBQW9CLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUMvQyxVQUFNLGlCQUFpQixJQUFJLG9DQUFrQixtQkFBbUI7QUFDaEUsV0FBTyxLQUFZLElBQUksRUFBRSxRQUFRLENBQUMsZUFBeUM7QUFDdkUscUJBQWUsVUFBVSxZQUFZLEFBQU8sWUFBWSxXQUFXO0FBQUEsSUFDdkUsQ0FBQztBQUNELG1CQUFlLFNBQVMsS0FBSyxNQUFNLFFBQVEsVUFBVTtBQUVyRCxVQUFNLHlCQUF5QixVQUFVLFVBQVU7QUFDbkQsMkJBQXVCLFNBQVMsS0FBSztBQUFBLE1BQ2pDLE1BQ0k7QUFBQSxNQUdKLEtBQUs7QUFBQSxJQUNULENBQUM7QUFHRCxVQUFNLDBCQUEwQixVQUFVLFVBQVU7QUFDcEQsVUFBTSx1Q0FBdUMsd0JBQXdCLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUNsRyxVQUFNLG9DQUFvQyxxQ0FBcUMsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDbkgsU0FBSyxNQUFNLFFBQVEsNkJBQTZCLEtBQUssTUFBTSxRQUFRLDhCQUE4QixBQUFPLFFBQVE7QUFDaEgsc0NBQWtDLFNBQVMsUUFBUSxFQUFFLE1BQU0sQUFBTyxZQUFZLG9CQUFvQixLQUFLLFFBQVEsQ0FBQztBQUNoSCxzQ0FBa0MsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQzdELFVBQU0sK0JBQStCLElBQUksb0NBQWtCLGlDQUFpQztBQUM1RixXQUFPLEtBQVksa0JBQWtCLEVBQUUsUUFBUSxDQUFDLHFCQUE0RDtBQUN4RyxtQ0FBNkIsVUFBVSxrQkFBaUIsQUFBTyxtQkFBbUIsaUJBQWdCO0FBQUEsSUFDdEcsQ0FBQztBQUNELFVBQU0scUNBQXFDLHFDQUFxQyxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDN0csVUFBTSxrQkFBa0IsS0FBSyxNQUFNLFFBQVE7QUFDM0MsdUNBQW1DLFFBQVEsQUFBTyxzQ0FBc0MsaUJBQWlCLFFBQVEsMkJBQTJCLEtBQUssTUFBTSxRQUFRLG1CQUFtQixDQUFDO0FBRW5MLGlDQUE2QixTQUFTLEtBQUssTUFBTSxRQUFRLDBCQUEwQjtBQUNuRixpQ0FBNkIsU0FBUyxDQUFDLFVBQWtEO0FBQ3JGLFdBQUssTUFBTSxRQUFRLDZCQUE2QjtBQUNoRCx5Q0FBbUMsUUFBUSxBQUFPLHNDQUFzQyxPQUFPLFFBQVEsMkJBQTJCLEtBQUssTUFBTSxRQUFRLG1CQUFtQixDQUFDO0FBQUEsSUFDN0ssQ0FBQztBQUVELFVBQU0sa0NBQWtDLHdCQUF3QixVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDN0YsU0FBSyxNQUFNLFFBQVEsc0JBQXNCLEtBQUssTUFBTSxRQUFRO0FBQzVELFVBQU0sK0JBQStCLGdDQUFnQyxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUN6RyxpQ0FBNkIsU0FBUyxRQUFRLEVBQUUsTUFBTSx5QkFBeUIsS0FBSyxRQUFRLENBQUM7QUFDN0YsVUFBTSxzQkFBc0IsSUFBSSxnQ0FBYyw0QkFBNEI7QUFDMUUsd0JBQW9CLFFBQVEsU0FBUyxZQUFZO0FBQ2pELHdCQUFvQixRQUFRLFNBQVMsWUFBWTtBQUNqRCxvQ0FBZ0MsU0FBUyxRQUFRLEVBQUUsTUFBTSxtRkFBbUYsS0FBSyxXQUFXLENBQUM7QUFFN0osd0JBQW9CLFNBQVMsS0FBSyxNQUFNLFFBQVEsbUJBQW1CO0FBQ25FLHdCQUFvQixTQUFTLFdBQVM7QUFDbEMsV0FBSyxNQUFNLFFBQVEsc0JBQXNCO0FBQUEsSUFDN0MsQ0FBQztBQUdELFVBQU0sc0NBQXNDLFVBQVUsVUFBVSxFQUFFLEtBQUssV0FBVyxDQUFDO0FBQ25GLFNBQUssTUFBTSxRQUFRLHFCQUFxQixLQUFLLE1BQU0sUUFBUSxzQkFBc0IsQUFBTyxRQUFRO0FBQ2hHLHdDQUFvQyxTQUFTLFFBQVEsRUFBRSxNQUFNLEFBQU8sWUFBWSxZQUFZLEtBQUssUUFBUSxDQUFDO0FBQzFHLHdDQUFvQyxTQUFTLFFBQVEsRUFBRSxNQUFNLEFBQU8sZUFBZSxXQUFXLENBQUM7QUFDL0YsVUFBTSxtQ0FBbUMsb0NBQW9DLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ2pILFVBQU0sMEJBQTBCLElBQUksb0NBQWtCLGdDQUFnQztBQUN0Riw0QkFBd0IsUUFBUSxTQUFTLFlBQVk7QUFDckQsNEJBQXdCLGVBQWUsQUFBTyxPQUFPLFVBQVU7QUFDL0QsNEJBQXdCLFNBQVMsS0FBSyxNQUFNLFFBQVEsa0JBQWtCO0FBQ3RFLDRCQUF3QixRQUFRLE9BQU87QUFDdkMsNEJBQXdCLFFBQVEsT0FBTztBQUN2Qyw0QkFBd0IsU0FBUyxXQUFTO0FBQ3RDLFdBQUssTUFBTSxRQUFRLHFCQUFxQjtBQUFBLElBQzVDLENBQUM7QUFHRCxVQUFNLHdDQUF3QyxVQUFVLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUNyRixTQUFLLE1BQU0sUUFBUSw0QkFBNEIsS0FBSyxNQUFNLFFBQVEsNkJBQTZCLEFBQU8sUUFBUTtBQUM5RywwQ0FBc0MsU0FBUyxRQUFRLEVBQUUsTUFBTSxBQUFPLFlBQVksbUJBQW1CLEtBQUssUUFBUSxDQUFDO0FBQ25ILDBDQUFzQyxTQUFTLFFBQVEsRUFBRSxNQUFNLEFBQU8sZUFBZSxrQkFBa0IsQ0FBQztBQUN4RyxVQUFNLHFDQUFxQyxzQ0FBc0MsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDckgsVUFBTSw0QkFBNEIsSUFBSSxvQ0FBa0Isa0NBQWtDO0FBQzFGLDhCQUEwQixRQUFRLFNBQVMsWUFBWTtBQUN2RCw4QkFBMEIsZUFBZSxBQUFPLE9BQU8saUJBQWlCO0FBQ3hFLDhCQUEwQixTQUFTLEtBQUssTUFBTSxRQUFRLHlCQUF5QjtBQUMvRSw4QkFBMEIsUUFBUSxPQUFPO0FBQ3pDLDhCQUEwQixRQUFRLE9BQU87QUFDekMsOEJBQTBCLFNBQVMsV0FBUztBQUN4QyxXQUFLLE1BQU0sUUFBUSw0QkFBNEI7QUFBQSxJQUNuRCxDQUFDO0FBRUQsVUFBTSxtQkFBaUY7QUFBQSxNQUNuRixDQUFDLENBQUMsYUFBYSxpQkFBaUIsR0FBRyxNQUFTO0FBQUEsTUFDNUMsQ0FBQyxDQUFDLG9CQUFvQixHQUFHLHVCQUF1QjtBQUFBLE1BQ2hELENBQUMsQ0FBQyxjQUFjLGtCQUFrQixHQUFHLG1DQUFtQztBQUFBLE1BQ3hFLENBQUMsQ0FBQyxtQkFBbUIsR0FBRyxxQ0FBcUM7QUFBQSxJQUNqRTtBQUVBLFNBQUsscUNBQXFDLGtCQUFrQixlQUFlLFNBQVMsQ0FBNkI7QUFDakgsU0FBSyxzQ0FBc0Msd0JBQXdCLGVBQWUsU0FBUyxDQUE2QjtBQUV4SCxtQkFBZSxTQUFTLENBQUMsVUFBb0M7QUFDekQsV0FBSyxNQUFNLFFBQVEsYUFBYTtBQUNoQyxXQUFLLHFDQUFxQyxrQkFBa0IsS0FBSztBQUNqRSxXQUFLLHNDQUFzQyx3QkFBd0IsS0FBSztBQUFBLElBQzVFLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFPLHVCQUF1QixXQUEyQixRQUFzQixVQUFrQztBQUM3RyxTQUFLLHNCQUFzQixTQUFTO0FBQUEsRUFDeEM7QUFBQSxFQUVBLGdCQUF3QjtBQUNwQixVQUFNLG1CQUFtQixBQUFPLGlCQUFpQixLQUFLLE1BQU0sUUFBUTtBQUNwRSxRQUFJLGFBQXFCO0FBQ3pCLFFBQUksS0FBSyxNQUFNLFFBQVEsZUFBZSwrQ0FBZ0M7QUFDbEUsbUJBQWEsSUFBSSxLQUFLLE1BQU0sUUFBUSw2QkFDN0IsS0FBSyxNQUFNLFFBQVEsK0JBQStCLDRCQUFxQyxNQUFNLEtBQUssTUFBTSxRQUFRLHNCQUFzQjtBQUFBLElBQ2pKO0FBQ0EsV0FBTyxtQkFBbUI7QUFBQSxFQUM5QjtBQUFBLEVBRUEsa0JBQTJCO0FBQ3ZCLFdBQU87QUFBQSxFQUNYO0FBQ0o7OztBRzFRQSx3QkFBZ0U7OztBQ0FoRSx3QkFBOEI7QUFRdkIsdUNBQ0gsUUFDSTtBQVhSO0FBWUksUUFBTSxJQUFJLE9BQU87QUFDakIsV0FBUyxNQUFNLEVBQUUsMEJBQTBCLEtBQUssR0FBRztBQUMvQyxVQUFNLGFBQWEsV0FBQyxzRUFBcUU7QUFDekYsVUFBTSxFQUFFLFVBQVUsZUFBZSxjQUFjLFVBQUcsTUFBTSxVQUFVLE1BQW5CLG1CQUFzQixXQUFVLENBQUM7QUFDaEYsVUFBTSwrQ0FBK0MsUUFBRSxZQUNsRCxJQUFJLFFBQVEsTUFEb0MsbUJBQ2pDLEtBQUssV0FDaEIsTUFBTSxTQUFTLGFBRVgsT0FBTSxrQkFBa0IsVUFBYSxrQkFBa0IsaUJBQ3ZELE1BQU0sa0JBQWtCO0FBR3JDLFVBQU0sU0FBUyxFQUFFLEdBQUcsSUFBSSxLQUFLLFFBQVE7QUFDckMsUUFBSSxXQUFXLFVBQWEsT0FBTyxlQUFlLFVBQWEsQ0FBQyw4Q0FBOEM7QUFDMUcsUUFBRSwwQkFBMEIsT0FBTyxFQUFFO0FBQUEsSUFDekM7QUFBQSxFQUNKO0FBQ0o7QUFFQSx3QkFDSSxRQUNBLGdCQUNBLGlCQUEwQixPQUNiO0FBQUE7QUFFYixVQUFNLFNBQVEsS0FBSyxJQUFJO0FBRXZCLFVBQU0sSUFBSSxPQUFPO0FBQ2pCLFFBQUksa0JBQTRCLENBQUM7QUFFakMsVUFBTSxxQkFBeUMsb0JBQUksSUFBSTtBQUN2RCxLQUFDLEdBQUcsRUFBRSxpQ0FBaUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxVQUFVLFlBQVk7QUFDckUsYUFBTyxPQUFPLFdBQVMsTUFBTSxTQUFTLHVCQUFpQixFQUFFLFFBQVEsV0FBUztBQUN0RSwyQkFBbUIsSUFBSSxHQUFHLHlCQUF5QixNQUFNLGlCQUFpQixtQkFBbUIsTUFBTSxRQUFRLEtBQUs7QUFBQSxNQUNwSCxDQUFDO0FBQUEsSUFDTCxDQUFDO0FBRUQsS0FBQyxHQUFHLGtCQUFrQixFQUFFLFFBQVEsQ0FBTyxPQUFnQixlQUFoQixLQUFnQixXQUFoQixDQUFDLElBQUksUUFBVztBQWpEM0Q7QUFrRFEsWUFBTSxhQUFhLFdBQUMsc0VBQXFFO0FBQ3pGLFlBQU0sRUFBRSxVQUFVLGVBQWUsY0FBYyxVQUFHLE1BQU0sVUFBVSxNQUFuQixtQkFBc0IsV0FBVSxDQUFDO0FBQ2hGLFlBQU0sZUFDRixrQkFDQSxrREFBZ0IsS0FBSyxVQUFTLFlBQVksa0RBQWdCLGVBQWMsYUFDeEUsTUFBTSxRQUFRLGVBQWU7QUFDakMsWUFBTSxTQUFTLEVBQUUsR0FBRyxJQUFJLEtBQUssUUFBUTtBQUNyQyxZQUFNLGlCQUFpQixVQUFVLE9BQU8sTUFBTTtBQUU5QyxZQUFNLGVBQWUsaUJBQWlCLGVBQWUsU0FBUyxJQUFJO0FBQ2xFLFFBQUUsMEJBQTBCLElBQUksSUFBSSxZQUFZO0FBQ2hELFVBQUk7QUFDQSxjQUFNLFdBQVksSUFBSSxTQUFTLGVBQWUsVUFBVSxNQUFNLFFBQVEsU0FBUyxFQUFHLFFBQVEsRUFBRSxHQUFHLEdBQUcsRUFBRSxTQUFTO0FBQzdHLGNBQU0sa0JBQW1CLENBQUMsZ0JBQWdCLGFBQWEsTUFBTyxDQUFDLHVCQUF1QixjQUFjLFFBQVEsS0FBSyxpQkFBaUI7QUFDbEksWUFBSSxDQUFDLGlCQUFpQjtBQUNsQixZQUFFLHdCQUF3QixJQUFJLEdBQUcsYUFBYSxhQUFhLHlCQUFlO0FBQzFFO0FBQUEsUUFDSixPQUFPO0FBQ0gsY0FBSSxDQUFDLGNBQWM7QUFDZixjQUFFLHdCQUF3QixJQUFJLEdBQUcsYUFBYSxNQUFNLFFBQVEsdUJBQWM7QUFBQSxVQUM5RSxPQUFPO0FBQ0gsa0JBQU0sV0FBVyxRQUFRLENBQUMsRUFBRSxNQUFNLE1BQU0sTUFBTSxTQUFTLEVBQUUsT0FBTyxTQUFTLEVBQUUsQ0FBQyxHQUFHLFFBQVE7QUFDdkYsY0FBRSwwQkFBMEIsSUFBSSxJQUFJLFFBQVE7QUFDNUMsY0FBRSx3QkFBd0IsSUFBSSxHQUFHLGFBQWEsTUFBTSxRQUFRLHlCQUFlO0FBQUEsVUFDL0U7QUFBQSxRQUNKO0FBQUEsTUFDSixTQUFRLEdBQU47QUFDRSxZQUFJLGdCQUFnQixTQUFTLE1BQU0sSUFBSTtBQUFHLDBCQUFnQixLQUFLLE1BQU0sSUFBSTtBQUFBLE1BQzdFO0FBQUEsSUFDSixFQUFDO0FBQ0QsUUFBSSxnQkFBZ0I7QUFBUSxVQUFJLHlCQUFPO0FBQUEsRUFBNEQsZ0JBQWdCLEtBQUssS0FBSyxHQUFHO0FBR2hJLGtDQUE4QixNQUFNO0FBQUEsRUFDeEM7QUFBQTs7O0FEdkVBLElBQXFCLGVBQXJCLGNBQTBDLGNBQWE7QUFBQSxFQUVuRCxZQUFZLFFBQXNCLE9BQWM7QUFDNUMsVUFBTSxRQUFRLE9BQU8sdUJBQWlCO0FBQ3RDLFNBQUssa0JBQWtCO0FBQUEsRUFDM0I7QUFBQSxFQUVBLGVBQWUsTUFBYyxPQUFlLE1BQWEsVUFBZ0U7QUFDckgsVUFBTSxJQUFJLEtBQUssT0FBTztBQUN0QixVQUFNLEtBQUssR0FBRyxLQUFLLFNBQVMsS0FBSyxNQUFNO0FBQ3ZDLFFBQUk7QUFDSixhQUFTLEVBQUUsd0JBQXdCLElBQUksRUFBRSxLQUFLO0FBQzlDLFVBQU0sT0FBTyxXQUFXLDBCQUFpQixnQkFBZ0I7QUFDekQsVUFBTSxTQUFTLE1BQU07QUFBRSxxQkFBZSxLQUFLLFFBQVEsRUFBRSxNQUFZLFdBQVcsS0FBSyxNQUFNLEtBQUssQ0FBQztBQUFBLElBQUU7QUFDL0YsUUFBSSxhQUFhLE9BQU8sUUFBUSxLQUFLLFdBQVcseUJBQWdCO0FBQzVELGVBQVMsUUFBUSxDQUFDLFNBQVM7QUFDdkIsYUFBSyxTQUFTLFdBQVcsT0FBTztBQUNoQyxhQUFLLFFBQVEsSUFBSTtBQUNqQixhQUFLLFFBQVEsTUFBTTtBQUNuQixhQUFLLFdBQVcsc0JBQXNCO0FBQUEsTUFDMUMsQ0FBQztBQUFBLElBQ0wsV0FBVyxhQUFhLFVBQVUsUUFBUSxLQUFLLFdBQVcseUJBQWdCO0FBQ3RFLGVBQVMsUUFBUSxLQUFLO0FBQUEsUUFDbEIsSUFBSSxVQUFVO0FBQUEsUUFDZCxhQUFhLG1CQUFtQjtBQUFBLFFBQ2hDO0FBQUEsUUFDQTtBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0wsV0FBVyxhQUFhLGVBQWUsUUFBUSxLQUFLLFdBQVcseUJBQWdCO0FBQzNFLGVBQVMsVUFBVSxNQUFNLFFBQVEsVUFBVSxjQUFjO0FBQUEsSUFDN0QsV0FBVyxhQUFhLGVBQWUsUUFBUSxLQUFLLFdBQVcsMkJBQWlCO0FBQzVFLGVBQVMsVUFBVSxNQUFNLE1BQU07QUFBQSxNQUFFLEdBQUcsR0FBRyxvQkFBb0I7QUFBQSxJQUMvRDtBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQU0sd0JBQ0YsTUFDQSxtQkFDQSxPQUNBLFlBQ0EsT0FDQSxRQUNBLFdBQ2E7QUFBQTtBQUNiLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxNQUFNLE1BQU0sU0FBUyxFQUFFLE9BQU8sR0FBRyxFQUFFLENBQUMsR0FBRyxNQUFNLFlBQVksT0FBTyxRQUFRLFNBQVM7QUFBQSxJQUNqSTtBQUFBO0FBQUEsRUFFQSxjQUFjLElBQVMsR0FBUSxnQkFBNkIsT0FBc0k7QUFDOUwsVUFBTSxhQUFhLEdBQUcsR0FBRyxRQUFRLEVBQUUsS0FBSyxNQUFNLE9BQU8sS0FBSztBQUMxRCxtQkFBZSxZQUFZLFVBQVU7QUFBQSxFQUN6QztBQUFBLEVBRUEsQUFBTyxhQUFhLFdBQTJCLE1BQWEsV0FBbUIsWUFBWSxNQUFNO0FBQUEsRUFBRSxHQUFTO0FBakVoSDtBQWtFUSxVQUFNLGdCQUFnQixrQkFBSyxPQUFPLFdBQVcsWUFBWSxJQUFJLEtBQUssSUFBSSxNQUFoRCxtQkFBbUQsS0FBSyxPQUFLLEVBQUUsU0FBUyxlQUF4RSxtQkFBb0Ysa0JBQWlCO0FBQzNILGNBQVUsVUFBVSxFQUFFLE1BQU0sS0FBSyxPQUFPLFdBQVcsMEJBQTBCLElBQUksR0FBRyxLQUFLLHFCQUFxQixtQkFBbUIsV0FBVyxFQUFFLENBQUM7QUFBQSxFQUNuSjtBQUFBLEVBRUEsQUFBUSx1QkFBdUIsV0FBaUM7QUFDNUQsVUFBTSx5QkFBeUIsVUFBVSxVQUFVLEVBQUUsS0FBSyxXQUFXLENBQUM7QUFDdEUsVUFBTSxzQkFBc0IsdUJBQXVCLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ3ZGLHdCQUFvQixTQUFTLFFBQVEsRUFBRSxNQUFNLDJCQUEyQixLQUFLLFFBQVEsQ0FBQztBQUN0Rix3QkFBb0IsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQy9DLFVBQU0sYUFBYSxJQUFJLGtDQUFnQixtQkFBbUI7QUFDMUQsMkJBQXVCLFNBQVMsUUFBUSxFQUFFLE1BQU0seURBQXlELEtBQUssbUJBQW1CLENBQUM7QUFFbEksUUFBSSxLQUFLLE1BQU0sUUFBUSxlQUFlO0FBQVcsV0FBSyxNQUFNLFFBQVEsYUFBYTtBQUNqRixlQUFXLFNBQVMsS0FBSyxNQUFNLFFBQVEsVUFBVTtBQUNqRCxlQUFXLFNBQVMsV0FBUztBQUN6QixXQUFLLE1BQU0sUUFBUSxhQUFhO0FBQUEsSUFDcEMsQ0FBQztBQUVELFVBQU0sc0JBQXNCLFVBQVUsVUFBVSxFQUFFLEtBQUssV0FBVyxDQUFDO0FBQ25FLHdCQUFvQixTQUFTLFFBQVEsRUFBRSxNQUFNLHNCQUFzQixLQUFLLFFBQVEsQ0FBQztBQUNqRix3QkFBb0IsU0FBUyxRQUFRLEVBQUUsTUFBTSw4Q0FBOEMsS0FBSyxXQUFXLENBQUM7QUFDNUcsVUFBTSxtQkFBbUIsb0JBQW9CLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ2pGLFVBQU0sVUFBVSxJQUFJLG9DQUFrQixnQkFBZ0I7QUFDdEQsWUFBUSxRQUFRLFNBQVMsWUFBWTtBQUNyQyxZQUFRLFFBQVEsT0FBTztBQUN2QixZQUFRLFFBQVEsT0FBTztBQUN2QixZQUFRLFNBQVMsS0FBSyxNQUFNLFFBQVEsV0FBVyxFQUFFO0FBQ2pELFlBQVEsZUFBZSw2Q0FBNkM7QUFFcEUsWUFBUSxTQUFTLFdBQVM7QUFDdEIsV0FBSyxNQUFNLFFBQVEsVUFBVTtBQUM3Qix5QkFBbUIsc0JBQXNCLE9BQU87QUFBQSxJQUNwRCxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBTyx1QkFBdUIsaUJBQWlDLFFBQXNCLFVBQWtDO0FBQ25ILFNBQUssdUJBQXVCLGVBQWU7QUFBQSxFQUMvQztBQUFBLEVBRUEsZ0JBQXdCO0FBQ3BCLFdBQU8sS0FBSyxNQUFNLFFBQVE7QUFBQSxFQUM5QjtBQUFBLEVBRUEsa0JBQTJCO0FBQ3ZCLFdBQU87QUFBQSxFQUNYO0FBQ0o7OztBRTdHQSx3QkFBK0g7QUFLL0gsSUFBOEIsMEJBQTlCLGNBQTZELGNBQWE7QUFBQSxFQVd0RSxZQUFZLFFBQXNCLE9BQWMsTUFBaUI7QUFDN0QsVUFBTSxRQUFRLE9BQU8sSUFBSTtBQVQ3QixTQUFVLGlCQUFpQixDQUFDLEtBQUssS0FBSyxLQUFLLEtBQUssS0FBSyxHQUFHO0FBQ3hELFNBQVUsUUFBUTtBQUFBLE1BQ2QsQ0FBQyxPQUFPLFlBQVk7QUFBQSxNQUNwQixDQUFDLFNBQVMsZUFBZTtBQUFBLE1BQ3pCLENBQUMsVUFBVSxjQUFjO0FBQUEsTUFDekIsQ0FBQyxRQUFRLGNBQWM7QUFBQSxJQUMzQjtBQU1BLFNBQU8sdUJBQXVCLENBQUMsV0FBMkIsV0FBcUIsVUFBa0I7QUFDN0YsZ0JBQVUsZ0JBQWdCLEdBQUcsQ0FBQyxDQUFDO0FBQy9CLGdCQUFVLFNBQVMsUUFBUSxFQUFFLE1BQU0sT0FBTyxLQUFLLFFBQVEsQ0FBQztBQUN4RCxnQkFBVSxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDckMsWUFBTSw0QkFBNEIsQ0FBQyxZQUEyQixVQUFrQjtBQUM1RSxZQUFJLFVBQVUsU0FBUyxLQUFLLEdBQUc7QUFDM0IscUJBQVUsU0FBUyxRQUFRO0FBQzNCLHlDQUFRLFlBQVcsT0FBTztBQUFBLFFBQzlCLE9BQU87QUFDSCxxQkFBVSxZQUFZLFFBQVE7QUFDOUIseUNBQVEsWUFBVyxNQUFNO0FBQUEsUUFDN0I7QUFBQztBQUFBLE1BQ0w7QUFFQSxXQUFLLGVBQWUsUUFBUSxXQUFTO0FBQ2pDLGNBQU0saUJBQWlCLFVBQVUsVUFBVSxFQUFFLEtBQUssb0JBQW9CLFFBQVEsQ0FBQztBQUMvRSxrQ0FBMEIsZ0JBQWdCLEtBQUs7QUFDL0MsdUJBQWUsY0FBYyxNQUFNO0FBQy9CLHlCQUFlLFFBQVEsU0FBUyxjQUFjO0FBQUEsUUFDbEQ7QUFDQSx1QkFBZSxhQUFhLE1BQU07QUFDOUIseUJBQWUsZ0JBQWdCLE9BQU87QUFBQSxRQUMxQztBQUNBLHVCQUFlLFVBQVUsTUFBTTtBQUMzQixnQkFBTSxTQUFTO0FBQ2YsY0FBSSxPQUFPLFNBQVMsS0FBSyxHQUFHO0FBQ3hCLG1CQUFPLE9BQU8sS0FBSztBQUFBLFVBQ3ZCLE9BQU87QUFDSCxtQkFBTyxLQUFLLEtBQUs7QUFBQSxVQUNyQjtBQUFDO0FBQ0Qsb0NBQTBCLGdCQUFnQixLQUFLO0FBQUEsUUFFbkQ7QUFBQSxNQUNKLENBQUM7QUFFRCxZQUFNLGtCQUFrQixNQUFNO0FBQzFCLGNBQU0saUJBQTJCLGFBQWEsVUFBVSxPQUFPLENBQUMsVUFBa0IsQ0FBQyxLQUFLLGVBQWUsU0FBUyxLQUFLLENBQUMsS0FBSyxDQUFDO0FBQzVILHVCQUFlLFFBQVEsV0FBUztBQUM1QixnQkFBTSxpQkFBaUIsVUFBVSxVQUFVLEVBQUUsS0FBSyxhQUFhLENBQUM7QUFDaEUseUJBQWUsUUFBUSxTQUFTLHFCQUFxQixpQkFBaUIsT0FBTztBQUM3RSx5QkFBZSxjQUFjLE1BQU07QUFDL0IsMkJBQWUsUUFBUSxTQUFTLHFCQUFxQixxQkFBcUI7QUFBQSxVQUM5RTtBQUNBLHlCQUFlLGFBQWEsTUFBTTtBQUM5QiwyQkFBZSxRQUFRLFNBQVMscUJBQXFCLGlCQUFpQixPQUFPO0FBQUEsVUFDakY7QUFDQSx5Q0FBUSxnQkFBZ0IsT0FBTztBQUMvQix5QkFBZSxVQUFVLE1BQU07QUFDM0IsWUFBQyxVQUF1QixPQUFPLEtBQUs7QUFDcEMsc0JBQVUsWUFBWSxjQUFjO0FBQUEsVUFDeEM7QUFBQSxRQUNKLENBQUM7QUFBQSxNQUNMO0FBQ0Esc0JBQWdCO0FBRWhCLFlBQU0sMEJBQTBCLFVBQVUsVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDaEYsWUFBTSxpQkFBaUIsSUFBSSxpQ0FBZSx1QkFBdUI7QUFDakUscUJBQWUsU0FBUyxXQUFTO0FBQzdCLGtCQUFVLEtBQUssS0FBSztBQUNwQixhQUFLLHFCQUFxQixXQUFXLFdBQVcsS0FBSztBQUFBLE1BQ3pELENBQUM7QUFBQSxJQUNMO0FBRUEsU0FBTyx5QkFBeUIsQ0FBQyxXQUEyQixVQUFvQixVQUFrQjtBQUM5RixnQkFBVSxVQUFVLEVBQUUsS0FBSyxTQUFTLE1BQU0sTUFBTSxDQUFDO0FBQ2pELGdCQUFVLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUNyQyxXQUFLLE1BQU0sUUFBUSxDQUFDLENBQUMsTUFBTSxjQUFjO0FBQ3JDLG1CQUFZLFlBQXFDLEtBQUssTUFBTSxJQUFJLFdBQVEsTUFBSyxFQUFFO0FBQy9FLGNBQU0sb0JBQW9CLFVBQVUsVUFBVSxFQUFFLEtBQUssWUFBWSxDQUFDO0FBQ2xFLGNBQU0sb0JBQW9CLGtCQUFrQixVQUFVLEVBQUUsS0FBSyxZQUFZLENBQUM7QUFDMUUsdUNBQVEsbUJBQW1CLFFBQVE7QUFDbkMsY0FBTSx1QkFBdUIsSUFBSSxrQ0FBZ0IsaUJBQWlCO0FBQ2xFLDZCQUFxQixTQUFTLFNBQVMsU0FBUyxJQUFJLENBQUM7QUFDckQsNkJBQXFCLFNBQVMsV0FBUyxRQUFRLFNBQVMsS0FBSyxJQUFJLElBQUksU0FBUyxPQUFPLElBQUksQ0FBQztBQUFBLE1BQzlGLENBQUM7QUFBQSxJQUVMO0FBRUEsU0FBTyx1QkFBdUIsQ0FBQyxXQUEyQixRQUFrQixVQUFrQjtBQUMxRixnQkFBVSxnQkFBZ0IsR0FBRyxDQUFDLENBQUM7QUFDL0IsZ0JBQVUsVUFBVSxFQUFFLEtBQUssU0FBUyxNQUFNLE1BQU0sQ0FBQztBQUNqRCxNQUFDLE9BQW9CLFFBQVEsV0FBUztBQUNsQyxjQUFNLGlCQUFpQixVQUFVLFVBQVUsRUFBRSxLQUFLLGFBQWEsTUFBTSxNQUFNLENBQUM7QUFDNUUsWUFBSSxrQ0FBZ0IsY0FBYyxFQUM3QixRQUFRLFVBQVUsRUFDbEIsU0FBUyxhQUFhLEVBQ3RCLFFBQVEsTUFBTTtBQUNYLGlCQUFPLE9BQU8sS0FBSztBQUNuQixvQkFBVSxZQUFZLGNBQWM7QUFBQSxRQUN4QyxDQUFDO0FBQUEsTUFDVCxDQUFDO0FBQUEsSUFDTDtBQUVBLFNBQU8seUJBQXlCLENBQzVCLHdCQUNBLG9CQUNBLG1CQUNBLFFBQ0EsVUFDQztBQUNELHdCQUFrQixVQUFVLEVBQUUsS0FBSyxTQUFTLE1BQU0sTUFBTSxDQUFDO0FBQ3pELHdCQUFrQixVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDN0MsWUFBTSxhQUFhLElBQUksZ0NBQWMsaUJBQWlCO0FBQ3RELFlBQU0sZ0JBQWdCLElBQUksa0NBQWdCLGlCQUFpQjtBQUMzRCxpQkFBVyxTQUFTLFdBQVMsUUFBUSxjQUFjLE9BQU8sSUFBSSxjQUFjLFVBQVUsQ0FBQztBQUN2RixvQkFBYyxRQUFRLGFBQWE7QUFDbkMsb0JBQWMsUUFBUSxNQUFNO0FBQ3hCLGVBQU8sS0FBSyxXQUFXLFNBQVMsQ0FBQztBQUNqQyxhQUFLLHFCQUFxQix3QkFBd0IsUUFBUSxrQkFBa0I7QUFDNUUsbUJBQVcsU0FBUyxFQUFFO0FBQ3RCLHNCQUFjLFVBQVU7QUFBQSxNQUM1QixDQUFDO0FBQUEsSUFDTDtBQUVBLFNBQU8sNEJBQTRCLENBQUMsY0FBOEI7QUFDOUQsZ0JBQVUsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLEtBQUssUUFBUSxDQUFDO0FBQ2hFLFlBQU0sa0JBQWtCLElBQUksZ0NBQWMsU0FBUztBQUNuRCxzQkFBZ0IsUUFBUSxTQUFTLFlBQVk7QUFDN0Msc0JBQWdCLFFBQVEsU0FBUyxZQUFZO0FBQzdDLFVBQUksWUFDQSxnQkFBZ0IsU0FDaEIsS0FBSyxRQUNMLEtBQ0EsUUFDSjtBQUNBLFlBQU0sYUFBYSxLQUFLLE1BQU0sUUFBUTtBQUN0QyxzQkFBZ0IsU0FBUyxjQUFjLEVBQUU7QUFDekMsc0JBQWdCLGVBQWUseUJBQXlCO0FBQ3hELHNCQUFnQixTQUFTLFdBQVM7QUFDOUIsMkJBQW1CLHNCQUFzQixlQUFlO0FBQ3hELGFBQUssTUFBTSxRQUFRLGFBQWE7QUFBQSxNQUNwQyxDQUFDO0FBQ0QsV0FBSyxrQkFBa0I7QUFBQSxJQUMzQjtBQUVBLFNBQU8sMkJBQTJCLENBQUMsV0FBMkIsVUFBa0I7QUFDNUUsZ0JBQVUsVUFBVSxFQUFFLE1BQU0sT0FBTyxLQUFLLFFBQVEsQ0FBQztBQUNqRCxnQkFBVSxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDckMsWUFBTSxxQkFBcUIsSUFBSSxvQ0FBa0IsU0FBUztBQUMxRDtBQUFBLFFBQ0ksQ0FBQyxZQUFZLFVBQVU7QUFBQSxRQUN2QixDQUFDLFlBQVksVUFBVTtBQUFBLFFBQ3ZCLENBQUMsYUFBYSxZQUFZO0FBQUEsTUFDOUIsRUFBRSxRQUFRLENBQUMsQ0FBQyxXQUFXLFdBQVcsbUJBQW1CLFVBQVUsV0FBVyxLQUFLLENBQUM7QUFDaEYseUJBQW1CLFNBQVMsS0FBSyxNQUFNLFFBQVEsYUFBYSxVQUFVO0FBQ3RFLHlCQUFtQixTQUFTLFdBQVMsS0FBSyxNQUFNLFFBQVEsWUFBWSxLQUFLO0FBQUEsSUFDN0U7QUFFQSxTQUFPLHlCQUF5QixDQUFDLFdBQTJCLFVBQWtCO0FBQzFFLGdCQUFVLFNBQVMsUUFBUSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzFDLGdCQUFVLFNBQVMsUUFBUSxFQUFFLE1BQU0sdUVBQXVFLEtBQUssV0FBVyxDQUFDO0FBQzNILFlBQU0sNEJBQTRCLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDaEYsWUFBTSxtQkFBbUIsSUFBSSxvQ0FBa0IseUJBQXlCO0FBQ3hFLHVCQUFpQixRQUFRLFNBQVMsWUFBWTtBQUM5Qyx1QkFBaUIsUUFBUSxPQUFPO0FBQ2hDLHVCQUFpQixRQUFRLE9BQU87QUFDaEMsdUJBQWlCLGVBQWUsMEJBQTBCO0FBQzFELHVCQUFpQixTQUFTLEtBQUssTUFBTSxRQUFRLG9CQUFvQixFQUFFO0FBQ25FLHVCQUFpQixTQUFTLENBQUMsVUFBVTtBQUNqQyxhQUFLLE1BQU0sUUFBUSxtQkFBbUI7QUFBQSxNQUMxQyxDQUFDO0FBQUEsSUFDTDtBQUFBLEVBbktBO0FBb0tKOzs7QUM5S0EsSUFBcUIsY0FBckIsY0FBeUMsd0JBQXlCO0FBQUEsRUFJOUQsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLHFCQUFnQjtBQUFBLEVBQ3pDO0FBQUEsRUFFQSxBQUFPLGFBQWEsV0FBMkIsTUFBYSxXQUFtQixTQUEyQjtBQW5COUc7QUFvQlEsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsUUFBSSxPQUFPO0FBQ1AsWUFBTSxVQUFVLE1BQU0sS0FBSyxLQUFLLElBQUksRUFBRTtBQUN0QyxZQUFNLFNBQVMsTUFBTSxRQUFRLE9BQU8sSUFBSSxVQUFVLENBQUMsT0FBTztBQUMxRCxhQUFPLFFBQVEsQ0FBQyxPQUFPLE1BQU07QUFDekIsWUFBSSxNQUFNLE1BQU0sT0FBTyxLQUFLLEdBQUc7QUFDM0IsZ0JBQU0sT0FBTyxVQUFVLFNBQVMsS0FBSyxFQUFFLE1BQU0sTUFBTSxLQUFLLE1BQU0sR0FBRyxFQUFFLEtBQUssRUFBRSxRQUFRLFdBQVcsSUFBSSxFQUFFLENBQUM7QUFDcEcsZUFBSyxVQUFVLE1BQU07QUFDakIsaUJBQUssT0FBTyxJQUFJLFVBQVUsYUFBYSxNQUFNLE1BQU0sS0FBSyxNQUFNLElBQUk7QUFDbEUsb0JBQVE7QUFBQSxVQUNaO0FBQUEsUUFDSixPQUFPO0FBQ0gsb0JBQVUsVUFBVSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQUEsUUFDdkM7QUFDQSxZQUFJLElBQUksT0FBTyxTQUFTLEdBQUc7QUFDdkIsb0JBQVUsU0FBUyxRQUFRLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFBQSxRQUM5QztBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0w7QUFDQSxjQUFVLFVBQVU7QUFBQSxFQUN4QjtBQUFBLEVBRUEsZUFBZSxNQUFjLE9BQWUsTUFBYSxVQUFnRTtBQUFBLEVBRXpIO0FBQUEsRUFFQSxBQUFNLHdCQUF3QixNQUFhLG1CQUEyQixPQUFnQixZQUFxQixPQUFpQixRQUFrQixXQUFvQztBQUFBO0FBQzlLLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sS0FBSyxNQUFNLE1BQU0sU0FBUyxFQUFFLE9BQU8sR0FBRyxFQUFFLENBQUMsR0FBRyxNQUFNLFlBQVksT0FBTyxRQUFRLFNBQVM7QUFBQSxJQUNqSTtBQUFBO0FBQUEsRUFFQSxjQUFjLElBQVMsR0FBUSxnQkFBNkIsT0FBcUk7QUFDN0wsVUFBTSxhQUFhLEdBQUcsR0FBRyxRQUFRLEVBQUUsS0FBSyxNQUFNLE9BQU8sS0FBSztBQUMxRCxtQkFBZSxZQUFZLFVBQVU7QUFBQSxFQUN6QztBQUFBLEVBRUEsdUJBQXVCLFdBQTJCLFFBQXNCLFVBQWtDO0FBSXRHLFVBQU0sV0FBVSxLQUFLLE1BQU07QUFDM0IsYUFBUSxZQUFhLFNBQVEsYUFBdUQ7QUFDcEYsYUFBUSxhQUFjLFNBQVEsY0FBdUMsQ0FBQztBQUN0RSxhQUFRLGFBQWMsU0FBUSxjQUF1QyxDQUFDO0FBQ3RFLGFBQVEsZ0JBQWlCLFNBQVEsaUJBQTBDLENBQUM7QUFDNUUsYUFBUSxjQUFlLFNBQVEsZUFBd0MsQ0FBQztBQUN4RSxhQUFRLGFBQWMsU0FBUSxjQUF1QyxDQUFDO0FBR3RFLFVBQU0sc0JBQXNCLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDMUUsY0FBVSxTQUFTLElBQUk7QUFDdkIsVUFBTSxxQkFBcUIsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUN6RSxVQUFNLHNCQUFzQixVQUFVLFVBQVUsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ2pGLFVBQU0seUJBQXlCLFVBQVUsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDbkYsY0FBVSxVQUFVLEVBQUUsS0FBSyxZQUFZLE1BQU0sdURBQXVELENBQUM7QUFDckcsVUFBTSx1QkFBdUIsVUFBVSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNqRixjQUFVLFVBQVUsRUFBRSxLQUFLLFlBQVksTUFBTSx1REFBdUQsQ0FBQztBQUNyRyxVQUFNLHNCQUFzQixVQUFVLFVBQVUsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ2pGLFVBQU0sd0JBQXdCLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDNUUsY0FBVSxTQUFTLElBQUk7QUFDdkIsVUFBTSxzQkFBc0IsVUFBVSxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUNqRixVQUFNLCtCQUErQixVQUFVLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUc1RSxTQUFLLDBCQUEwQixtQkFBbUI7QUFDbEQsU0FBSyx5QkFBeUIsb0JBQW9CLGdEQUFnRDtBQUNsRyxTQUFLLHVCQUF1Qiw4QkFBOEIsZ0JBQWdCO0FBQzFFLFNBQUsscUJBQXFCLHFCQUFxQixTQUFRLFlBQVksdUJBQXVCO0FBQzFGLFNBQUsscUJBQXFCLHFCQUFxQixTQUFRLFlBQVksdUJBQXVCO0FBQzFGLFNBQUssdUJBQXVCLHdCQUF3QixTQUFRLGVBQWUsMEJBQTBCO0FBQ3JHLFNBQUssdUJBQXVCLHNCQUFzQixTQUFRLGFBQWEsd0JBQXdCO0FBQy9GLFNBQUsscUJBQXFCLHFCQUFxQixTQUFRLFlBQVkseUJBQXlCO0FBQzVGLFNBQUssdUJBQXVCLHFCQUFxQiwyQkFBMkIsdUJBQXVCLFNBQVEsWUFBWSwrQkFBK0I7QUFBQSxFQUMxSjtBQUFBLEVBRUEsZ0JBQXdCO0FBQ3BCLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxrQkFBMkI7QUFsRy9CO0FBbUdRLFFBQUksUUFBUTtBQUNaLFFBQUksQ0FBRSxZQUFLLE1BQU0sUUFBUSxlQUFuQixtQkFBMEMsU0FBUyxhQUFZO0FBQ2pFLGNBQVE7QUFDUix5QkFBbUIsbUJBQ2YsS0FBSyxpQkFDTCwyQkFDSjtBQUFBLElBQ0o7QUFDQSxXQUFPLENBQUM7QUFBQSxFQUNaO0FBQ0o7OztBQ2xHQSxJQUFxQixtQkFBckIsY0FBOEMsd0JBQXlCO0FBQUEsRUFJbkUsWUFBWSxRQUFzQixPQUFjO0FBQzVDLFVBQU0sUUFBUSxPQUFPLCtCQUFxQjtBQUFBLEVBQzlDO0FBQUEsRUFFQSxlQUFlLE1BQWMsT0FBZSxNQUFhLFVBQWdFO0FBQUEsRUFFekg7QUFBQSxFQUVBLEFBQU0sd0JBQXdCLE1BQWEsbUJBQTJCLE9BQWdCLFlBQXFCLE9BQWlCLFFBQWtCLFdBQW9DO0FBQUE7QUFDOUssWUFBTSxXQUFXLEtBQUssUUFBUSxDQUFDLEVBQUUsTUFBTSxLQUFLLE1BQU0sTUFBTSxTQUFTLEVBQUUsT0FBTyxHQUFHLEVBQUUsQ0FBQyxHQUFHLE1BQU0sWUFBWSxPQUFPLFFBQVEsU0FBUztBQUFBLElBQ2pJO0FBQUE7QUFBQSxFQUVBLGNBQWMsSUFBUyxHQUFRLGdCQUE2QixPQUFxSTtBQUM3TCxVQUFNLGFBQWEsR0FBRyxHQUFHLFFBQVEsRUFBRSxLQUFLLE1BQU0sT0FBTyxLQUFLO0FBQzFELG1CQUFlLFlBQVksVUFBVTtBQUFBLEVBQ3pDO0FBQUEsRUFFQSx1QkFBdUIsV0FBMkIsUUFBc0IsVUFBa0M7QUFHdEcsVUFBTSxXQUFVLEtBQUssTUFBTTtBQUMzQixhQUFRLGNBQWUsU0FBUSxlQUF3QyxDQUFDO0FBQ3hFLGFBQVEsY0FBZSxTQUFRLGVBQXdDLENBQUM7QUFHeEUsVUFBTSxzQkFBc0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUMxRSxjQUFVLFNBQVMsSUFBSTtBQUN2QixVQUFNLHVCQUF1QixVQUFVLFVBQVUsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ2xGLFVBQU0sdUJBQXVCLFVBQVUsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDbEYsVUFBTSxvQkFBb0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUd4RSxTQUFLLDBCQUEwQixtQkFBbUI7QUFDbEQsU0FBSyxxQkFBcUIsc0JBQXNCLFNBQVEsYUFBYSx5QkFBeUI7QUFDOUYsU0FBSyxxQkFBcUIsc0JBQXNCLFNBQVEsYUFBYSwwQkFBMEI7QUFDL0YsU0FBSyx1QkFBdUIsc0JBQXNCLDRCQUE0QixtQkFBbUIsU0FBUSxhQUFhLCtCQUErQjtBQUFBLEVBQ3pKO0FBQUEsRUFFQSxnQkFBd0I7QUFDcEIsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLGtCQUEyQjtBQXpEL0I7QUEwRFEsUUFBSSxRQUFRO0FBQ1osUUFBSSxDQUFFLFlBQUssTUFBTSxRQUFRLGVBQW5CLG1CQUEwQyxTQUFTLGFBQVk7QUFDakUsY0FBUTtBQUNSLHlCQUFtQixtQkFDZixLQUFLLGlCQUNMLDJCQUNKO0FBQUEsSUFDSjtBQUNBLFdBQU8sQ0FBQztBQUFBLEVBQ1o7QUFDSjs7O0FDekRBLElBQXFCLHVCQUFyQixjQUFrRCx3QkFBeUI7QUFBQSxFQUl2RSxZQUFZLFFBQXNCLE9BQWM7QUFDNUMsVUFBTSxRQUFRLE9BQU8sdUNBQXlCO0FBQUEsRUFDbEQ7QUFBQSxFQUVBLGVBQWUsTUFBYyxPQUFlLE1BQWEsVUFBZ0U7QUFBQSxFQUV6SDtBQUFBLEVBRUEsQUFBTSx3QkFBd0IsTUFBYSxtQkFBMkIsT0FBZ0IsWUFBcUIsT0FBaUIsUUFBa0IsV0FBb0M7QUFBQTtBQUM5SyxZQUFNLFdBQVcsS0FBSyxRQUFRLENBQUMsRUFBRSxNQUFNLEtBQUssTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLEdBQUcsRUFBRSxDQUFDLEdBQUcsTUFBTSxZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQUEsSUFDakk7QUFBQTtBQUFBLEVBRUEsY0FBYyxJQUFTLEdBQVEsZ0JBQTZCLE9BQXFJO0FBQzdMLFVBQU0sYUFBYSxHQUFHLEdBQUcsUUFBUSxFQUFFLEtBQUssTUFBTSxPQUFPLEtBQUs7QUFDMUQsbUJBQWUsWUFBWSxVQUFVO0FBQUEsRUFDekM7QUFBQSxFQUVBLHVCQUF1QixXQUEyQixRQUFzQixVQUFrQztBQUl0RyxVQUFNLFdBQVUsS0FBSyxNQUFNO0FBQzNCLGFBQVEsY0FBZSxTQUFRLGVBQXdDLENBQUM7QUFDeEUsYUFBUSxhQUFjLFNBQVEsY0FBdUMsQ0FBQztBQUN0RSxhQUFRLGFBQWMsU0FBUSxjQUF1QyxDQUFDO0FBQ3RFLGFBQVEsZ0JBQWlCLFNBQVEsaUJBQTBDLENBQUM7QUFDNUUsYUFBUSxjQUFlLFNBQVEsZUFBd0MsQ0FBQztBQUN4RSxhQUFRLGNBQWUsU0FBUSxlQUF3QyxDQUFDO0FBQ3hFLGFBQVEsYUFBYyxTQUFRLGNBQXVDLENBQUM7QUFDdEUsYUFBUSxZQUFhLFNBQVEsYUFBdUQ7QUFHcEYsVUFBTSxzQkFBc0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUMxRSxVQUFNLHVCQUF1QixVQUFVLFVBQVUsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ2xGLFVBQU0sdUJBQXVCLFVBQVUsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDbEYsVUFBTSx5QkFBeUIsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUM3RSxjQUFVLFNBQVMsSUFBSTtBQUN2QixVQUFNLHFCQUFxQixVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ3pFLFVBQU0sc0JBQXNCLFVBQVUsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDakYsVUFBTSx5QkFBeUIsVUFBVSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNuRixjQUFVLFVBQVUsRUFBRSxLQUFLLFlBQVksTUFBTSx1REFBdUQsQ0FBQztBQUNyRyxVQUFNLHVCQUF1QixVQUFVLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ2pGLGNBQVUsVUFBVSxFQUFFLEtBQUssWUFBWSxNQUFNLHVEQUF1RCxDQUFDO0FBQ3JHLFVBQU0sc0JBQXNCLFVBQVUsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDakYsVUFBTSx3QkFBd0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUM1RSxjQUFVLFNBQVMsSUFBSTtBQUN2QixVQUFNLHNCQUFzQixVQUFVLFVBQVUsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ2pGLFVBQU0sK0JBQStCLFVBQVUsVUFBVSxFQUFFLEtBQUssV0FBVyxDQUFDO0FBRzVFLFVBQU0sbUJBQW1CO0FBQ3pCLFVBQU0sa0JBQWtCO0FBRXhCLFNBQUssMEJBQTBCLG1CQUFtQjtBQUNsRCxTQUFLLHlCQUF5QixvQkFBb0IsaURBQWlEO0FBQ25HLFNBQUssdUJBQXVCLDhCQUE4QiwwQ0FBMEM7QUFDcEcsU0FBSyxxQkFBcUIsc0JBQXNCLFNBQVEsYUFBYSx5QkFBeUI7QUFDOUYsU0FBSyxxQkFBcUIscUJBQXFCLFNBQVEsWUFBWSwwQ0FBMEM7QUFDN0csU0FBSyxxQkFBcUIscUJBQXFCLFNBQVEsWUFBWSxnQ0FBZ0M7QUFDbkcsU0FBSyxxQkFBcUIsc0JBQXNCLFNBQVEsYUFBYSxnQkFBZ0I7QUFDckYsU0FBSyxxQkFBcUIscUJBQXFCLFNBQVEsWUFBWSxlQUFlO0FBQ2xGLFNBQUssdUJBQXVCLHdCQUF3QixTQUFRLGVBQWUsa0NBQWtDO0FBQzdHLFNBQUssdUJBQXVCLHNCQUFzQixTQUFRLGFBQWEsZ0NBQWdDO0FBQ3ZHLFNBQUssdUJBQXVCLHNCQUFzQixrQkFBa0Isd0JBQXdCLFNBQVEsYUFBYSwrQkFBK0I7QUFDaEosU0FBSyx1QkFBdUIscUJBQXFCLGlCQUFpQix1QkFBdUIsU0FBUSxZQUFZLCtCQUErQjtBQUFBLEVBQ2hKO0FBQUEsRUFFQSxnQkFBd0I7QUFDcEIsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLGtCQUEyQjtBQXRGL0I7QUF1RlEsUUFBSSxRQUFRO0FBQ1osUUFBSSxDQUFFLFlBQUssTUFBTSxRQUFRLGVBQW5CLG1CQUEwQyxTQUFTLGFBQVk7QUFDakUsY0FBUTtBQUNSLHlCQUFtQixtQkFDZixLQUFLLGlCQUNMLDJCQUNKO0FBQUEsSUFDSjtBQUNBLFdBQU8sQ0FBQztBQUFBLEVBQ1o7QUFDSjs7O0FDbEZBLElBQU0sV0FBVztBQUFBLEVBQ2I7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQ0o7QUFFQSxJQUFPLG1CQUFROzs7QUNiUixJQUFNLHdCQUFtRTtBQUFBLEVBQzVFLFNBQVM7QUFBQSxFQUNULFVBQVU7QUFBQSxFQUNWLFNBQVM7QUFBQSxFQUNULFNBQVM7QUFBQSxFQUNULFdBQVc7QUFBQSxFQUNYLFVBQVU7QUFBQSxFQUNWLFFBQVE7QUFBQSxFQUNSLGFBQWE7QUFBQSxFQUNiLFFBQVE7QUFBQSxFQUNSLFVBQVU7QUFBQSxFQUNWLFdBQVc7QUFBQSxFQUNYLFVBQVU7QUFBQSxFQUNWLGVBQWU7QUFBQSxFQUNmLG1CQUFtQjtBQUN2QjtBQUVPLElBQU0sb0JBQTREO0FBQUEsRUFDckUsU0FBUztBQUFBLEVBQ1QsVUFBVTtBQUFBLEVBQ1YsU0FBUztBQUFBLEVBQ1QsU0FBUztBQUFBLEVBQ1QsV0FBVztBQUFBLEVBQ1gsVUFBVTtBQUFBLEVBQ1YsUUFBUTtBQUFBLEVBQ1IsYUFBYTtBQUFBLEVBQ2IsUUFBUTtBQUFBLEVBQ1IsVUFBVTtBQUFBLEVBQ1YsV0FBVztBQUFBLEVBQ1gsVUFBVTtBQUFBLEVBQ1YsZUFBZTtBQUFBLEVBQ2YsbUJBQW1CO0FBQ3ZCO0FBRU8sSUFBTSxtQkFBMkQ7QUFBQSxFQUNwRSxTQUFTO0FBQUEsRUFDVCxVQUFVO0FBQUEsRUFDVixTQUFTO0FBQUEsRUFDVCxTQUFTO0FBQUEsRUFDVCxXQUFXO0FBQUEsRUFDWCxVQUFVO0FBQUEsRUFDVixRQUFRO0FBQUEsRUFDUixhQUFhO0FBQUEsRUFDYixRQUFRO0FBQUEsRUFDUixVQUFVO0FBQUEsRUFDVixXQUFXO0FBQUEsRUFDWCxVQUFVO0FBQUEsRUFDVixlQUFlO0FBQUEsRUFDZixtQkFBbUI7QUFDdkI7QUFFTyxJQUFNLGVBQW9EO0FBQUEsRUFDN0QsU0FBUyxpQkFBUztBQUFBLEVBQ2xCLFVBQVUsaUJBQVM7QUFBQSxFQUNuQixTQUFTLGlCQUFTO0FBQUEsRUFDbEIsU0FBUyxpQkFBUztBQUFBLEVBQ2xCLFdBQVcsaUJBQVM7QUFBQSxFQUNwQixVQUFVLGlCQUFTO0FBQUEsRUFDbkIsUUFBUSxpQkFBUztBQUFBLEVBQ2pCLGFBQWEsaUJBQVM7QUFBQSxFQUN0QixRQUFRLGlCQUFTO0FBQUEsRUFDakIsVUFBVSxpQkFBUztBQUFBLEVBQ25CLFdBQVcsaUJBQVM7QUFBQSxFQUNwQixVQUFVLGlCQUFTO0FBQUEsRUFDbkIsZUFBZSxpQkFBUztBQUFBLEVBQ3hCLG1CQUFtQixpQkFBUztBQUNoQztBQUVPLElBQU0sWUFBb0Q7QUFBQSxFQUM3RCxTQUFTO0FBQUEsRUFDVCxVQUFVO0FBQUEsRUFDVixTQUFTO0FBQUEsRUFDVCxTQUFTO0FBQUEsRUFDVCxXQUFXO0FBQUEsRUFDWCxVQUFVO0FBQUEsRUFDVixRQUFRO0FBQUEsRUFDUixhQUFhO0FBQUEsRUFDYixRQUFRO0FBQUEsRUFDUixVQUFVO0FBQUEsRUFDVixXQUFXO0FBQUEsRUFDWCxVQUFVO0FBQUEsRUFDVixlQUFlO0FBQUEsRUFDZixtQkFBbUI7QUFDdkI7QUFFTyxJQUFNLDRCQUFvRTtBQUFBLEVBQzdFLFNBQVM7QUFBQSxFQUNULFVBQVU7QUFBQSxFQUNWLFNBQVM7QUFBQSxFQUNULFNBQVM7QUFBQSxFQUNULFdBQVc7QUFBQSxFQUNYLFVBQVU7QUFBQSxFQUNWLFFBQVE7QUFBQSxFQUNSLGFBQWE7QUFBQSxFQUNiLFFBQVE7QUFBQSxFQUNSLFVBQVU7QUFBQSxFQUNWLFdBQVc7QUFBQSxFQUNYLFVBQVU7QUFBQSxFQUNWLGVBQWU7QUFBQSxFQUNmLG1CQUFtQjtBQUN2QjtBQUVPLElBQU0sYUFBYTtBQUFBLEVBQ3RCO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUNKO0FBR08sSUFBTSwwQkFBMEIsQ0FBQyxRQUFRLFlBQVksWUFBWSxTQUFTOzs7QTlHekhqRixJQUFNLDBCQUFOLGNBQXNDLHdCQUFNO0FBQUEsRUFnQnhDLFlBQ1ksUUFDQSxXQUNBLE1BQ1Y7QUFDRSxVQUFNLE9BQU8sR0FBRztBQUpSO0FBQ0E7QUFDQTtBQUdSLFNBQUssZUFBZSxJQUFJLGNBQU07QUFDOUIsUUFBSSxLQUFLLE1BQU07QUFDWCxXQUFLLFFBQVEsS0FBTSxTQUFTO0FBQzVCLG9CQUFNLGFBQWEsS0FBSyxjQUFjLEtBQUssS0FBSztBQUFBLElBQ3BELE9BQU87QUFDSCxXQUFLLFFBQVEsSUFBSSxjQUFNO0FBQUEsSUFDM0I7QUFDQSxTQUFLLGVBQWUsSUFBSSxhQUFhLEtBQUssTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLLEtBQUs7QUFFN0UsU0FBSyxhQUFhLEtBQUssTUFBTSxZQUFZO0FBQ3pDLFNBQUssVUFBVSxLQUFLLE1BQU0sV0FBVztBQUFBLE1BQ2pDLElBQUksS0FBSyxRQUFRLFdBQVcsS0FBSyxNQUFNLGlCQUFpQixrQkFBa0IsS0FBSyxNQUFNLFNBQVM7QUFBQSxNQUM5RixNQUFNO0FBQUEsTUFDTixPQUFPLEtBQUssUUFBUSxVQUFVLEtBQUssTUFBTSxlQUFlO0FBQUEsTUFDeEQsUUFBUTtBQUFBLElBQ1o7QUFBQSxFQUNKO0FBQUEsRUFFQSxTQUFTO0FBQ0wsU0FBSyxZQUFZLFNBQVMsZUFBZTtBQUV6QyxTQUFLLFFBQVEsUUFBUSxLQUFLLE9BQU8sVUFBVSxLQUFLLEtBQUssU0FBUyw4QkFBOEIsS0FBSyxVQUFVLE1BQU07QUFHakgsU0FBSyx3QkFBd0I7QUFDN0IsU0FBSyxZQUFZO0FBQ2pCLFNBQUssVUFBVSxTQUFTLElBQUk7QUFHNUIsU0FBSyxzQkFBc0I7QUFHM0IsU0FBSyxzQ0FBc0M7QUFHM0MsVUFBTSxzQkFBc0IsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQy9FLFNBQUssVUFBVSxTQUFTLElBQUk7QUFHNUIsU0FBSyx3QkFBd0IsS0FBSyxVQUFVLFVBQVU7QUFHdEQsVUFBTSxTQUFTLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxpQkFBaUIsQ0FBQztBQUNqRSxXQUFPLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUNsQyxTQUFLLGNBQWMsTUFBTTtBQUN6QixRQUFJLEtBQUs7QUFBTSxXQUFLLGlCQUFpQixNQUFNO0FBQzNDLFNBQUssZ0JBQWdCLE1BQU07QUFHM0IsU0FBSyx5QkFBeUIsbUJBQW1CO0FBQ2pELFNBQUssYUFBYSx1QkFBdUIsS0FBSyx1QkFBdUIsS0FBSyxRQUFRLGtDQUEwQztBQUFBLEVBRWhJO0FBQUEsRUFFQSwwQkFBZ0M7QUFDNUIsVUFBTSxZQUFZLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNyRSxjQUFVLFVBQVUsRUFBRSxLQUFLLFNBQVMsTUFBTSxlQUFlLENBQUM7QUFDMUQsVUFBTSxRQUFRLElBQUksZ0NBQWMsU0FBUztBQUN6QyxVQUFNLFFBQVEsU0FBUyxZQUFZO0FBQ25DLFVBQU0sUUFBUSxTQUFTLFlBQVk7QUFDbkMsU0FBSyxPQUFPLE1BQU0sU0FBUyxLQUFLLE1BQU0sSUFBSSxJQUFJLE1BQU0sZUFBZSxtQkFBbUI7QUFDdEYsVUFBTSxRQUFRLE1BQU07QUFDcEIsVUFBTSxTQUFTLFdBQVM7QUFDcEIsV0FBSyxNQUFNLE9BQU87QUFDbEIsV0FBSyxRQUFRLEtBQUssV0FBVyxLQUFLLE1BQU0saUJBQWlCLGtCQUFrQjtBQUMzRSxXQUFLLFFBQVEsUUFBUSxVQUFVO0FBQy9CLFdBQUssU0FBUyxRQUFRLElBQUksUUFBUTtBQUNsQyx5QkFBbUIsc0JBQXNCLEtBQUs7QUFBQSxJQUNsRCxDQUFDO0FBQ0QsU0FBSyxZQUFZO0FBQUEsRUFDckI7QUFBQSxFQUVBLEFBQVEsd0NBQThDO0FBQ2xELFNBQUssa0NBQWtDLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUUxRixTQUFLLGdDQUFnQyxVQUFVLEVBQUUsTUFBTSxpQ0FBaUMsS0FBSyxRQUFRLENBQUM7QUFDdEcsU0FBSyxnQ0FBZ0MsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBRWhFLFVBQU0seUJBQXlCLElBQUksb0NBQWtCLEtBQUssK0JBQStCO0FBQ3pGLFVBQU0sV0FBa0MsQ0FBQztBQUN6QyxhQUFRLGFBQWE7QUFDckIsYUFBUSxZQUFZO0FBQ3BCLGFBQVEsZUFBZSxtQkFBbUIsS0FBSyxPQUFPLFNBQVM7QUFDL0QsMkJBQXVCLFdBQVcsUUFBTztBQUN6QyxZQUFRLEtBQUssTUFBTTtBQUFBLFdBQ1Y7QUFBMEIsK0JBQXVCLFNBQVMsU0FBUztBQUFHO0FBQUEsV0FDdEU7QUFBeUIsK0JBQXVCLFNBQVMsUUFBUTtBQUFHO0FBQUEsV0FDcEU7QUFBVywrQkFBdUIsU0FBUyxXQUFXO0FBQUc7QUFBQTtBQUdsRSwyQkFBdUIsU0FBUyxXQUFTO0FBQ3JDLGNBQVE7QUFBQSxhQUNDO0FBQVcsZUFBSyx5QkFBeUI7QUFBMEI7QUFBQSxhQUNuRTtBQUFVLGVBQUsseUJBQXlCO0FBQXlCO0FBQUEsYUFDakU7QUFBYSxlQUFLLHlCQUF5QjtBQUFXO0FBQUE7QUFDbEQsZUFBSyx5QkFBeUI7QUFBQTtBQUFBLElBRS9DLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSx3QkFBOEI7QUFDMUIsVUFBTSxtQkFBbUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBRzVFLHFCQUFpQixVQUFVLEVBQUUsTUFBTSxpQ0FBaUMsS0FBSyxRQUFRLENBQUM7QUFDbEYscUJBQWlCLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUU1QyxVQUFNLG9CQUFvQixJQUFJLGtDQUFnQixnQkFBZ0I7QUFDOUQsc0JBQWtCLFNBQVMsS0FBSyxVQUFVO0FBRzFDLFVBQU0sZ0JBQWdCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUN6RSxTQUFLLGFBQWEsY0FBYyxLQUFLLElBQUksY0FBYyxLQUFLO0FBRzVELGtCQUFjLFVBQVUsRUFBRSxNQUFNLGFBQWEsS0FBSyxRQUFRLENBQUM7QUFDM0QsU0FBSyxXQUFXLElBQUksZ0NBQWMsYUFBYTtBQUMvQyxTQUFLLFNBQVMsUUFBUSxTQUFTLFlBQVk7QUFDM0MsU0FBSyxTQUFTLFFBQVEsU0FBUyxZQUFZO0FBQzNDLFVBQU0sY0FBYyxjQUFjLFVBQVUsRUFBRSxLQUFLLGVBQWUsQ0FBQztBQUNuRSxTQUFLLFNBQVMsU0FBUyxLQUFLLFFBQVEsSUFBSTtBQUN4QyxtQ0FBUSxhQUFhLEtBQUssUUFBUSxJQUFJO0FBQ3RDLFNBQUssU0FBUyxTQUFTLFdBQVM7QUFDNUIsV0FBSyxRQUFRLE9BQU87QUFDcEIscUNBQVEsYUFBYSxLQUFLO0FBQUEsSUFDOUIsQ0FBQztBQUVELHNCQUFrQixTQUFTLFdBQVM7QUFDaEMsV0FBSyxhQUFhO0FBQ2xCLFdBQUssYUFBYSxjQUFjLEtBQUssSUFBSSxjQUFjLEtBQUs7QUFBQSxJQUNoRSxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsY0FBb0I7QUFFaEIsVUFBTSxZQUFZLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNyRSxVQUFNLG1CQUFtQixVQUFVLFVBQVU7QUFDN0MsVUFBTSxXQUFXLGlCQUFpQixTQUFTLEtBQUs7QUFDaEQsU0FBSyxXQUFXLFNBQVMsU0FBUyxRQUFRO0FBQzFDLFNBQUssU0FBUyxRQUFRLElBQUksS0FBSyxNQUFNLE9BQU87QUFDNUMsYUFBUyxPQUFPLDRCQUE0QixLQUFLLE9BQU8sU0FBUyxvQkFBb0IsS0FBSyxVQUFVLE1BQU07QUFBQSxFQUU5RztBQUFBLEVBRUEseUJBQXlCLFdBQWlDO0FBR3RELFVBQU0sNkJBQTZCLFVBQVUsVUFBVSxFQUFFLEtBQUssUUFBUSxDQUFDO0FBQ3ZFLCtCQUEyQixRQUFRLGFBQWE7QUFDaEQsY0FBVSxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDckMsVUFBTSxhQUFhLElBQUksb0NBQWtCLFNBQVM7QUFDbEQsV0FBTyxLQUFLLGdCQUFnQixFQUFFLFFBQVEsQ0FBQyxRQUFnQyxXQUFXLFVBQVUsS0FBSyxpQkFBaUIsSUFBSSxDQUFDO0FBQ3ZILFFBQUksS0FBSyxNQUFNLE1BQU07QUFDakIsaUJBQVcsU0FBUyxLQUFLLE1BQU0sSUFBSTtBQUNuQyxVQUFJLENBQUMscUJBQWlCLHVCQUFrQixtQkFBZSxFQUFFLFNBQVMsS0FBSyxNQUFNLElBQUksR0FBRztBQUNoRixhQUFLLGdDQUFnQyxLQUFLO0FBQUEsTUFDOUMsT0FBTztBQUNILGFBQUssZ0NBQWdDLEtBQUs7QUFBQSxNQUM5QztBQUFBLElBQ0o7QUFDQSxlQUFXLFNBQVMsQ0FBQyxjQUFzQztBQUN2RCxXQUFLLFFBQVEsSUFBSSxjQUFNO0FBQ3ZCLG9CQUFNLGFBQWEsS0FBSyxPQUFPLEtBQUssWUFBWTtBQUNoRCxXQUFLLE1BQU0sT0FBTyxLQUFLLFVBQVUsU0FBUztBQUMxQyxXQUFLLE1BQU0sT0FBTyxzQkFBc0I7QUFDeEMsVUFBSSxLQUFLLE1BQU0sU0FBUyxLQUFLLGFBQWEsUUFDdEMsQ0FBQyxDQUFDLEtBQUssTUFBTSxNQUFNLEtBQUssYUFBYSxJQUFJLEVBQUUsTUFBTSxlQUM3QyxDQUFDLHFCQUFpQix1QkFBa0IsbUJBQWUsRUFBRSxTQUFTLFNBQVMsQ0FDM0UsR0FDRjtBQUNFLGFBQUssTUFBTSxVQUFVLENBQUM7QUFBQSxNQUMxQjtBQUNBLFVBQUksQ0FBQyxxQkFBaUIsdUJBQWtCLG1CQUFlLEVBQUUsU0FBUyxLQUFLLE1BQU0sSUFBSSxHQUFHO0FBQ2hGLGFBQUssZ0NBQWdDLEtBQUs7QUFBQSxNQUM5QyxPQUFPO0FBQ0gsYUFBSyxnQ0FBZ0MsS0FBSztBQUFBLE1BQzlDO0FBQ0EsYUFBTyxLQUFLLHNCQUFzQixZQUFZO0FBQzFDLGFBQUssc0JBQXNCLFlBQVksS0FBSyxzQkFBc0IsVUFBVTtBQUFBLE1BQ2hGO0FBQ0EsV0FBSyxlQUFlLElBQUksYUFBYSxLQUFLLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSyxLQUFLO0FBQzdFLFdBQUssYUFBYSx1QkFBdUIsS0FBSyx1QkFBdUIsS0FBSyxRQUFRLGtDQUEwQztBQUFBLElBQ2hJLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLGlCQUEwQjtBQUM5QixXQUFPLEtBQUssYUFBYSxhQUNyQixLQUFLLFdBQ0wsS0FBSyxTQUNULEtBQ0ksS0FBSyxhQUFhLGdCQUFnQjtBQUFBLEVBQzFDO0FBQUEsRUFFQSxBQUFRLGNBQWMsV0FBaUM7QUFDbkQsVUFBTSxhQUFhLElBQUksa0NBQWdCLFNBQVM7QUFDaEQsZUFBVyxXQUFXLE1BQU07QUFDNUIsZUFBVyxRQUFRLFdBQVc7QUFDOUIsZUFBVyxRQUFRLE1BQVk7QUFDM0IsVUFBSSxRQUFRLENBQUMsS0FBSyxlQUFlO0FBQ2pDLFVBQUksT0FBTztBQUNQLFlBQUkseUJBQU8sMkJBQTJCO0FBQ3RDO0FBQUEsTUFDSjtBQUFDO0FBQ0QsVUFBSSxLQUFLLFlBQVk7QUFDakIsYUFBSyxNQUFNLFVBQVUsS0FBSztBQUFBLE1BQzlCLE9BQU87QUFDSCxlQUFPLEtBQUssTUFBTTtBQUFBLE1BQ3RCO0FBQ0EsVUFBSSxLQUFLLHdCQUF3QjtBQUM3QixhQUFLLE1BQU0sVUFBVSxLQUFLO0FBQUEsTUFDOUIsT0FBTztBQUNILGVBQU8sS0FBSyxNQUFNO0FBQUEsTUFDdEI7QUFDQSxZQUFNLEtBQUssVUFBVSxnQkFDakIsS0FBSyxNQUFNLE1BQ1gsS0FBSyxNQUFNLE1BQ1gsS0FBSyxNQUFNLFNBQ1gsS0FBSyxNQUNMLEtBQUssTUFBTSxTQUNYLEtBQUssTUFBTSxPQUNmO0FBQ0EsV0FBSyxNQUFNO0FBQUEsSUFDZixFQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxpQkFBaUIsV0FBaUM7QUFDdEQsVUFBTSxlQUFlLElBQUksa0NBQWdCLFNBQVM7QUFDbEQsaUJBQWEsUUFBUSxPQUFPO0FBQzVCLGlCQUFhLFFBQVEsTUFBTTtBQW5RbkM7QUFvUVksWUFBTSxlQUFlLElBQUksd0JBQU0sS0FBSyxPQUFPLEdBQUc7QUFDOUMsbUJBQWEsWUFBWSxTQUFTLGVBQWU7QUFDakQsbUJBQWEsUUFBUSxRQUFRLGdCQUFnQjtBQUM3QyxtQkFBYSxVQUFVLFVBQVUsRUFBRSxRQUFRLGdDQUFnQyxXQUFLLFNBQUwsbUJBQVcsdUJBQXVCLEtBQUssVUFBVSxPQUFPO0FBQ25JLFlBQU0sZ0JBQWdCLGFBQWEsVUFBVSxVQUFVLEVBQUUsS0FBSyxpQkFBaUIsQ0FBQztBQUNoRixvQkFBYyxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDekMsWUFBTSxnQkFBZ0IsSUFBSSxrQ0FBZ0IsYUFBYTtBQUN2RCxvQkFBYyxXQUFXO0FBQ3pCLG9CQUFjLFFBQVEsV0FBVztBQUNqQyxvQkFBYyxRQUFRLE1BQU07QUFDeEIsWUFBSSxLQUFLO0FBQU0sZUFBSyxVQUFVLGdCQUFnQixLQUFLLElBQUk7QUFDdkQscUJBQWEsTUFBTTtBQUNuQixhQUFLLE1BQU07QUFBQSxNQUNmLENBQUM7QUFDRCxZQUFNLGdCQUFnQixJQUFJLGtDQUFnQixhQUFhO0FBQ3ZELG9CQUFjLFFBQVEsT0FBTztBQUM3QixvQkFBYyxRQUFRLE1BQU0sS0FBSyxNQUFNLENBQUM7QUFDeEMsbUJBQWEsS0FBSztBQUFBLElBQ3RCLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLGdCQUFnQixXQUFpQztBQUNyRCxVQUFNLGVBQWUsSUFBSSxrQ0FBZ0IsU0FBUztBQUNsRCxpQkFBYSxRQUFRLE9BQU87QUFDNUIsaUJBQWEsUUFBUSxNQUFNLEtBQUssTUFBTSxDQUFDO0FBQUEsRUFDM0M7QUFDSjs7O0ErRzlSQSx3QkFBcUQ7QUFRckQsSUFBcUIscUJBQXJCLGNBQWdELCtCQUFtQjtBQUFBLEVBTS9ELFlBQ1ksUUFDQSxNQUNBLFVBQ1Y7QUFDRSxVQUFNLE9BQU8sR0FBRztBQUpSO0FBQ0E7QUFDQTtBQVBaLFNBQVEsZ0JBQXlCO0FBQ2pDLFNBQVEsZUFBd0I7QUFDaEMsU0FBUSx3QkFBaUM7QUFRckMsU0FBSyxXQUFXO0FBQ2hCLFNBQUssWUFBWSxTQUFTLGVBQWU7QUFDekMsU0FBSyxrQkFBa0IsU0FBUyxVQUFVO0FBQUEsRUFDOUM7QUFBQSxFQUVBLFNBQWU7QUFDWCxVQUFNLE9BQU87QUFDYixVQUFNLGlCQUFpQixLQUFLLFlBQVksVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDNUUsbUJBQWUsWUFBWSxLQUFLLE9BQU87QUFDdkMsU0FBSyxZQUFZLEtBQUssU0FBUyxFQUFFLFFBQVEsY0FBYztBQUV2RCxVQUFNLG1CQUFtQixJQUFJLGtDQUFnQixjQUFjO0FBQzNELHFCQUFpQixRQUFRLE1BQU07QUFDL0IscUJBQWlCLFFBQVEsTUFBTTtBQUMzQixVQUFJLEtBQUssZUFBZTtBQUNwQix5QkFBaUIsVUFBVTtBQUMzQixhQUFLLGdCQUFnQjtBQUFBLE1BQ3pCLE9BQU87QUFDSCx5QkFBaUIsT0FBTztBQUN4QixhQUFLLGdCQUFnQjtBQUFBLE1BQ3pCO0FBQUEsSUFDSixDQUFDO0FBQ0QscUJBQWlCLFlBQVksS0FBSyxxQkFBcUI7QUFDdkQscUJBQWlCLFdBQVcsK0JBQStCO0FBSTNELFVBQU0sc0JBQXNCLElBQUksa0NBQWdCLGNBQWM7QUFDOUQsd0JBQW9CLFFBQVEsZ0JBQWdCO0FBQzVDLHdCQUFvQixRQUFRLE1BQU07QUFDOUIsVUFBSSxLQUFLLGNBQWM7QUFDbkIsNEJBQW9CLFVBQVU7QUFDOUIsYUFBSyxlQUFlO0FBQUEsTUFDeEIsT0FBTztBQUNILDRCQUFvQixPQUFPO0FBQzNCLGFBQUssZUFBZTtBQUFBLE1BQ3hCO0FBQUEsSUFDSixDQUFDO0FBQ0Qsd0JBQW9CLFlBQVksS0FBSyxxQkFBcUI7QUFDMUQsd0JBQW9CLFdBQVcsa0NBQWtDO0FBS2pFLFVBQU0sMkJBQTJCLElBQUksa0NBQWdCLGNBQWM7QUFDbkUsNkJBQXlCLFFBQVEsVUFBVTtBQUMzQyw2QkFBeUIsUUFBUSxNQUFNO0FBQ25DLFdBQUssU0FBUyxJQUFJLE9BQU8sT0FBTyxLQUFLO0FBQ3JDLFdBQUssTUFBTTtBQUFBLElBQ2YsQ0FBQztBQUNELDZCQUF5QixXQUFXLDhDQUE4QztBQUFBLEVBQ3RGO0FBQUEsRUFFQSxBQUFNLGVBQWUsT0FBZ0M7QUFBQTtBQUNqRCxZQUFNLFVBQVUsTUFBTSxLQUFLLE9BQU8sSUFBSSxNQUFNLEtBQUssS0FBSyxJQUFJO0FBQzFELFlBQU0sY0FBc0IsQ0FBQztBQUFBLFFBQ3pCLFlBQVk7QUFBQSxRQUNaLFVBQVU7QUFBQSxNQUNkLENBQUM7QUFDRCxjQUFRLE1BQU0sSUFBSSxFQUNiLFFBQVEsQ0FBQyxhQUFhLE1BQU07QUFDekIsWUFBSSxZQUFZLFlBQVksRUFBRSxTQUFTLE1BQU0sWUFBWSxDQUFDLEdBQUc7QUFDekQsc0JBQVksS0FBSztBQUFBLFlBQ2IsWUFBWTtBQUFBLFlBQ1osVUFBVSxZQUFZLFVBQVUsR0FBRyxFQUFFLElBQUssYUFBWSxTQUFTLEtBQUssS0FBSztBQUFBLFVBQzdFLENBQUM7QUFBQSxRQUNMO0FBQUEsTUFDSixDQUFDO0FBRUwsYUFBTztBQUFBLElBQ1g7QUFBQTtBQUFBLEVBRUEsaUJBQWlCLE9BQWEsSUFBaUI7QUFDM0MsT0FBRyxTQUFTLE1BQU07QUFDbEIsVUFBTSxZQUFZLEdBQUcsVUFBVSxFQUFFLEtBQUssT0FBTyxDQUFDO0FBQzlDLGNBQVUsVUFBVSxFQUFFLE1BQU0sR0FBRyxNQUFNLGFBQWEsS0FBSyxLQUFLLGFBQWEsQ0FBQztBQUMxRSxjQUFVLFVBQVUsRUFBRSxNQUFNLE1BQU0sVUFBVSxLQUFLLFdBQVcsQ0FBQztBQUFBLEVBQ2pFO0FBQUEsRUFFQSxtQkFBbUIsTUFBWSxLQUFpQztBQUM1RCxVQUFNLFFBQVEsS0FBSyxjQUFjLEtBQUssUUFBUTtBQUM5QyxTQUFLLFNBQVMsS0FBSyxjQUFjLEtBQUssSUFBSSxLQUFLLFlBQzNDLE9BQ0EsS0FBSyxlQUNMLEtBQUssWUFBWTtBQUFBLEVBQ3pCO0FBQ0o7OztBQ3BHQSw2QkFDSSxRQUNBLGdCQUNBLFlBQ0EsUUFBaUIsT0FDakIsU0FBa0IsT0FDbEIsWUFBcUIsT0FDckIsZUFDYTtBQUFBO0FBZGpCO0FBZUksVUFBTSxPQUFPLHNCQUFzQixRQUFRLGNBQWM7QUFDekQsVUFBTSxRQUFRLGFBQU8sSUFBSSxRQUFRLFFBQVEsYUFBM0IsbUJBQXFDO0FBQ25ELFFBQUksT0FBTztBQUNQLFlBQU0sSUFBSSxPQUFPO0FBQ2pCLFlBQU0sS0FBSyxPQUFPO0FBQ2xCLFlBQU0sU0FBUyxFQUFFLFlBQVksSUFBSSxLQUFLLElBQUk7QUFDMUMsWUFBTSxxQkFBcUIsWUFBWSxNQUFNLEtBQUssS0FBSyxJQUFJLENBQUM7QUFDNUQsWUFBTSxzQkFBc0IsZ0JBQWdCLGNBQU8sV0FBVyxrQkFBa0IsSUFBSSxhQUFhLE1BQXJELG1CQUF3RCxPQUFPLFdBQVMsTUFBTSxrQkFBa0IsbUJBQWtCLFNBQVk7QUFDMUssWUFBTSxpQkFBZ0MsQ0FBQztBQUN2Qyx1Q0FBUSxPQUFPLFdBQVMsQ0FBQyxtQkFBbUIsU0FBUyxNQUFNLElBQUksR0FDMUQsT0FBTyxXQUFTLHNCQUFzQixvQkFBb0IsSUFBSSxRQUFLLEdBQUUsSUFBSSxFQUFFLFNBQVMsTUFBTSxJQUFJLElBQUksTUFDbEcsUUFBUSxDQUFNLFVBQVM7QUFDcEIsdUJBQWUsS0FBSyxFQUFFLE1BQU0sTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQUEsTUFDcEU7QUFDSixVQUFJLGVBQWU7QUFBUSxjQUFNLFdBQVcsUUFBUSxnQkFBZ0IsTUFBTSxZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQUEsSUFDbEg7QUFBQSxFQUNKO0FBQUE7OztBQzlCQSx3QkFBeUM7OztBQ0F6Qyx3QkFBa0Q7OztBQ0FsRCx3QkFBa0Q7OztBQ0VsRCwwQ0FBdUQsUUFBc0IsV0FBc0IsTUFBNkI7QUFBQTtBQUM1SCxVQUFNLE9BQU8sVUFBVSxhQUFhO0FBQ3BDLFFBQUksTUFBTTtBQUNOLFlBQU0sVUFBVyxPQUFNLE9BQU8sSUFBSSxNQUFNLEtBQUssSUFBSSxHQUFHLE1BQU0sSUFBSTtBQUM5RCxZQUFNLGFBQWEsUUFBUSxJQUFJLENBQUMsTUFBTSxNQUFNO0FBQ3hDLFlBQUksQ0FBQyxLQUFLLFdBQVcsSUFBSTtBQUFHLGlCQUFPO0FBQUEsTUFDdkMsQ0FBQztBQUNELFlBQU0sT0FBTyxJQUFJLE1BQU0sT0FBTyxNQUFNLFdBQVcsS0FBSyxJQUFJLENBQUM7QUFBQSxJQUM3RDtBQUFBLEVBQ0o7QUFBQTs7O0FDUkEsSUFBTSxxQkFBTixNQUF5QjtBQUFBLEVBRXJCLFlBQ1csUUFDQSxNQUNBLE9BQWtCLHFCQUNsQixXQUEwQyxDQUFDLEdBQzNDLGVBQ0EsU0FDQSxTQUNUO0FBUFM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNQO0FBQUEsRUFFSixBQUFPLFdBQVc7QUFoQnRCO0FBaUJRLFFBQUksV0FBa0MsQ0FBQztBQUN2QyxRQUFJLE1BQU0sUUFBUSxLQUFLLE9BQU8sR0FBRztBQUM3QixpQkFBSyxZQUFMLG1CQUFjLFFBQVEsQ0FBQyxRQUFRLFVBQVU7QUFDckMsaUJBQVEsU0FBUztBQUFBLE1BQ3JCO0FBQUEsSUFDSixPQUFPO0FBQ0gsaUJBQVUsS0FBSztBQUFBLElBQ25CO0FBQ0EsV0FBTyxJQUFJLGNBQU0sS0FBSyxNQUFNLFVBQVMsS0FBSyxNQUFNLEtBQUssTUFBTSxLQUFLLGVBQWUsS0FBSyxTQUFTLEtBQUssT0FBTztBQUFBLEVBQzdHO0FBQUEsRUFFQSxBQUFPLGlCQUFpQixRQUFzQjtBQUMxQyxVQUFNLFFBQVEsS0FBSyxTQUFTO0FBQzVCLFVBQU0sVUFBVSxJQUFJLGFBQWEsTUFBTSxNQUFNLFFBQVEsS0FBSztBQUMxRCxXQUFPLFFBQVEsY0FBYztBQUFBLEVBQ2pDO0FBQ0o7OztBQy9CQSx3QkFBb0M7OztBQ0Y3QixJQUFNLGFBQWEsQ0FBQyxNQUFjO0FBQ3JDLFNBQU8sS0FBSyxFQUFFLEdBQUcsWUFBWSxJQUFJLEVBQUUsTUFBTSxDQUFDO0FBQzlDOzs7QURRQSxJQUFNLFVBQTZFO0FBQUEsRUFDL0UsU0FBUyxFQUFFLE1BQU0sU0FBUyxTQUFTLENBQUMsVUFBZSxHQUFHLFNBQVMsS0FBSztBQUFBLEVBQ3BFLGNBQWMsRUFBRSxNQUFNLGNBQWMsU0FBUyxDQUFDLFVBQW1CLE1BQU0sU0FBUyxFQUFFO0FBQUEsRUFDbEYsUUFBUSxFQUFFLE1BQU0sUUFBUSxTQUFTLENBQUMsVUFBZSxHQUFHLFNBQVMsS0FBSztBQUFBLEVBQ2xFLFlBQVksRUFBRSxNQUFNLFlBQVksU0FBUyxDQUFDLFdBQXFCLE9BQU8sS0FBSyxJQUFJLEVBQUU7QUFBQSxFQUNqRixZQUFZLEVBQUUsTUFBTSxZQUFZLFNBQVMsQ0FBQyxXQUFpQyxPQUFPLElBQUksVUFBUSxLQUFLLElBQUksRUFBRSxLQUFLLElBQUksRUFBRTtBQUFBLEVBQ3BILFVBQVUsRUFBRSxNQUFNLFdBQVcsU0FBUyxDQUFDLFVBQXFCLEdBQUcsZ0NBQU8sU0FBUSxLQUFLO0FBQ3ZGO0FBV08sSUFBTSxtQkFBTixNQUF1QjtBQUFBLEVBRTFCLFlBQ1csT0FDQSxNQUNBLFFBQ0EsVUFDQSxVQUNBLGFBQXNCLE9BQy9CO0FBTlM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUEsRUFHWDtBQUNKO0FBU08sSUFBTSwwQkFBTixjQUFzQywrQkFBcUI7QUFBQSxFQUU5RCxZQUNZLFFBQ0EsTUFDVjtBQUNFLFVBQU0sT0FBTyxHQUFHO0FBSFI7QUFDQTtBQUFBLEVBR1o7QUFBQSxFQUVBLGVBQWUsT0FBNkM7QUFDeEQsV0FBTyxDQUFDLEdBQUcsS0FBSyxPQUFPLFdBQVcsZ0JBQWdCLEtBQUssQ0FBQyxFQUNuRCxPQUFPLG1CQUFjO0FBNURsQztBQTREcUMsY0FBQyxZQUFLLE9BQU8sV0FBVyxpQkFDNUMsSUFBSSxLQUFLLEtBQUssSUFBSSxNQURHLG1CQUNBLElBQUksZUFBYSxVQUFVLE1BQ2hELFNBQVM7QUFBQSxLQUNkLEVBQ0MsT0FBTyxtQkFBaUIsY0FBYyxrQkFBa0IsRUFBRSxTQUFTLE1BQU0sWUFBWSxDQUFDLENBQUMsRUFDdkYsS0FBSztBQUFBLEVBQ2Q7QUFBQSxFQUVBLGlCQUFpQixPQUFlLElBQWlCO0FBQzdDLE9BQUcsUUFBUSxLQUFLO0FBQUEsRUFDcEI7QUFBQSxFQUVBLG1CQUFtQixNQUFjLEtBQWlDO0FBQzlELFNBQUssc0JBQXNCLElBQUk7QUFBQSxFQUNuQztBQUFBLEVBRUEsQUFBTSxzQkFBc0IsT0FBZTtBQUFBO0FBQ3ZDLFlBQU0saUJBQWlCLEtBQUssT0FBTyxTQUFTO0FBQzVDLFlBQU0scUJBQXFCLEtBQUssT0FBTyxXQUFXLGlCQUFpQixJQUFJLEtBQUssS0FBSyxJQUFJO0FBQ3JGLFlBQU0sV0FBVyxxQkFBcUIsQ0FBQyxHQUFHLG1CQUFtQixJQUFJLFFBQU0sR0FBRyxJQUFJLEdBQUcsS0FBSyxFQUFFLEtBQUssSUFBSSxJQUFJO0FBQ3JHLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sZ0JBQWdCLFNBQVMsRUFBRSxPQUFPLFNBQVMsRUFBRSxDQUFDLEdBQUcsS0FBSyxJQUFJO0FBQUEsSUFDckc7QUFBQTtBQUNKO0FBRUEsSUFBTSxtQkFBTixNQUF1QjtBQUFBLEVBRW5CLFlBQW1CLFVBQXFCO0FBQXJCO0FBQUEsRUFBdUI7QUFBQSxFQUUxQyxBQUFPLE1BQU07QUFDVCxVQUFNLHlCQUF5QixLQUFLLFNBQVMsT0FBTyxJQUFJLE1BQU0saUJBQWlCLEVBQUUsT0FBTyxVQUFRO0FBQzVGLFlBQU0sUUFBUSxLQUFLLFNBQVMsT0FBTyxJQUFJLGNBQWMsYUFBYSxJQUFJO0FBQ3RFLFlBQU0saUJBQWlCLEtBQUssU0FBUyxPQUFPLFNBQVM7QUFDckQsYUFBTyxnQ0FBTyxnQkFDUCxPQUFPLEtBQUssTUFBTSxXQUFXLEVBQUUsU0FBUyxjQUFjLEtBQ3RELE1BQU0sWUFBWSxtQkFBbUIsS0FBSyxTQUFTO0FBQUEsSUFDOUQsQ0FBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFPLElBQUksTUFBYztBQUNyQixVQUFNLGdCQUFnQixLQUFLLElBQUksRUFBRSxPQUFPLFVBQVEsS0FBSyxLQUFLLFFBQVEsT0FBTyxFQUFFLEVBQUUsU0FBUyxJQUFJLENBQUM7QUFDM0YsUUFBSSxjQUFjLFNBQVMsR0FBRztBQUMxQixZQUFNLFFBQVEsSUFBSSxNQUFNLDJCQUEyQjtBQUNuRCxZQUFNO0FBQUEsSUFDVjtBQUNBLFFBQUksY0FBYyxVQUFVLEdBQUc7QUFDM0IsWUFBTSxRQUFRLElBQUksTUFBTSxxQkFBcUI7QUFDN0MsWUFBTTtBQUFBLElBQ1Y7QUFDQSxXQUFPLGNBQWM7QUFBQSxFQUV6QjtBQUFBLEVBRUEsQUFBTyxRQUFRLE1BQWM7QUFDekIsVUFBTSxnQkFBZ0IsS0FBSyxJQUFJLEVBQUUsT0FBTyxVQUFRLEtBQUssUUFBUSxJQUFJO0FBQ2pFLFFBQUksY0FBYyxTQUFTLEdBQUc7QUFDMUIsWUFBTSxRQUFRLElBQUksTUFBTSwyQkFBMkI7QUFDbkQsWUFBTTtBQUFBLElBQ1Y7QUFDQSxRQUFJLGNBQWMsVUFBVSxHQUFHO0FBQzNCLFlBQU0sUUFBUSxJQUFJLE1BQU0scUJBQXFCO0FBQzdDLFlBQU07QUFBQSxJQUNWO0FBQ0EsV0FBTyxjQUFjO0FBQUEsRUFFekI7QUFDSjtBQUVBLElBQU0sWUFBTixNQUFnQjtBQUFBLEVBQ1osWUFBbUIsUUFBNkIsTUFBYztBQUEzQztBQUE2QjtBQUM1QyxTQUFLLFVBQVUsSUFBSSxpQkFBaUIsSUFBSTtBQUN4QyxTQUFLLGFBQWEsQ0FBQztBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxBQUFPLHNCQUF3QztBQXRJbkQ7QUF1SVEsVUFBTTtBQUFBLE1BQ0YsU0FBUztBQUFBLE1BQ1QsT0FBTztBQUFBLE1BQ1AsVUFBVTtBQUFBLE1BQ1YsWUFBWTtBQUFBLE1BQ1osVUFBVTtBQUFBLE1BQ1YsTUFBTTtBQUFBLFFBQ04sWUFBSyxPQUFPLElBQUksY0FBYyxhQUFhLEtBQUssYUFBYSxDQUFDLE1BQTlELG1CQUFpRSxnQkFBc0MsQ0FBQztBQUM1RyxVQUFNLFFBQVEsS0FBSyxPQUFPO0FBQzFCLFVBQU0sU0FBUyxLQUFLLE9BQU8sV0FBVyxnQkFBZ0IsSUFBSSxPQUFPO0FBQ2pFLFVBQU0sZ0JBQWdCLFVBQVUsaUNBQWlDLFNBQVM7QUFFMUUsVUFBTSxXQUFpQyxDQUFDO0FBQ3hDLGdCQUFNLHFCQUFxQixJQUFJLEtBQUssYUFBYSxFQUFFLFFBQVEsTUFBM0QsbUJBQThELFFBQVEsa0JBQWdCO0FBcEo5RjtBQXFKWSxtQkFBTSxnQkFBZ0IsSUFBSSxZQUFZLE1BQXRDLG9CQUF5QyxXQUFXLFFBQVEsVUFBUTtBQUNoRSxZQUFJLGNBQWMsU0FBUyxLQUFLLElBQUksS0FBSyxDQUFDLFNBQVMsSUFBSSxXQUFRLE1BQUssSUFBSSxFQUFFLFNBQVMsS0FBSyxJQUFJO0FBQUcsbUJBQVMsS0FBSyxJQUFJO0FBQUEsTUFDckg7QUFBQSxJQUNKO0FBQ0EsVUFBTSxRQUFRLE9BQVEsV0FBWSxXQUFXLFNBQVMsS0FBSyxPQUFPLFNBQVM7QUFDM0UsVUFBTSxhQUFhLGNBQWEsZ0JBQWdCLFdBQVc7QUFDM0QsVUFBTSxXQUFXLFVBQVUsMkJBQTJCLFNBQVM7QUFDL0QsVUFBTSxPQUFPLE9BQVEsVUFBVyxXQUFXLFFBQVEsS0FBSyxPQUFPLFNBQVM7QUFDeEUsV0FBTyxJQUFJLGlCQUFpQixPQUFPLE1BQU0sUUFBUSxVQUFVLFVBQVUsVUFBVTtBQUFBLEVBQ25GO0FBQUEsRUFFQSxBQUFPLGtCQUEyQjtBQWhLdEM7QUFpS1EsUUFBSTtBQUNBLFlBQU0sZ0JBQWdCLEtBQUssYUFBYTtBQUN4QyxZQUFNLGFBQWEsaUJBQUssT0FBTyxJQUFJLGNBQWMsYUFBYSxhQUFhLE1BQXhELG1CQUEyRCxnQkFBM0QsbUJBQXdFO0FBQzNGLGFBQU8sQ0FBQyxDQUFDO0FBQUEsSUFDYixTQUFTLE9BQVA7QUFDRSxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQU8sZUFBc0I7QUFDekIsVUFBTSxpQkFBaUIsS0FBSyxPQUFPLFNBQVM7QUFDNUMsVUFBTSxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEdBQUcsaUJBQWlCLEtBQUssU0FBUztBQUMzRixRQUFJLGdCQUFnQiwyQkFBUyxLQUFLLGFBQWEsTUFBTTtBQUNqRCxhQUFPO0FBQUEsSUFDWCxPQUFPO0FBQ0gsWUFBTSxRQUFRLElBQUksTUFDZCxrQkFBa0IsS0FBSyxnQkFBZ0Isb0NBQW9DLEtBQUssT0FBTyxTQUFTLG1CQUFtQixLQUFLLDZCQUM1SDtBQUNBLFlBQU07QUFBQSxJQUNWO0FBQUEsRUFDSjtBQUFBLEVBRUEsVUFBOEI7QUFDMUIsVUFBTSxVQUFVLENBQUMsS0FBSyxNQUFNLEdBQUcsS0FBSyxPQUFPLFdBQVcscUJBQXFCLElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxDQUFDO0FBQy9GLFFBQUk7QUFDSixZQUFRLEtBQUssQ0FBQyxlQUFlLE1BQU07QUExTDNDO0FBMkxZLFlBQU0sWUFBWSxLQUFLLE9BQU8sV0FBVyxnQkFBZ0IsSUFBSSxhQUFhO0FBQzFFLFVBQUksV0FBVztBQUNYLGNBQU0sT0FBTyxVQUFVLGFBQWE7QUFDcEMsY0FBTSxRQUFRLGlCQUFLLE9BQU8sSUFBSSxjQUFjLGFBQWEsSUFBSSxNQUEvQyxtQkFBa0QsZ0JBQWxELG1CQUErRDtBQUM3RSxZQUFJLE9BQU87QUFDUCxpQkFBTztBQUNQLGlCQUFPO0FBQUEsUUFDWDtBQUFDO0FBQUEsTUFDTDtBQUFBLElBQ0osQ0FBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxPQUFPLHVCQUF1QixRQUFzQixXQUFzQixVQUEyQztBQXhNekg7QUF5TVEsVUFBTSxPQUFPLFVBQVUsYUFBYTtBQUNwQyxRQUFJLGFBQXdDLENBQUM7QUFDN0MsVUFBTSxRQUFRLGFBQU8sSUFBSSxRQUFRLFFBQVEsZ0JBQTNCLG1CQUF3QztBQUV0RCxRQUFJLE9BQU87QUFDUCxZQUFNLFNBQVMsTUFBTSxLQUFLLEtBQUssSUFBSTtBQUNuQyxVQUFJO0FBQ0Esb0JBQVksTUFBTSxFQUFFLFFBQVEsU0FBTztBQUMvQixjQUFJLFFBQVEsVUFBVSxDQUFDLE9BQU8sS0FBSyxPQUFPLEtBQUssZUFBZSxDQUFDLENBQUMsRUFBRSxTQUFTLEdBQUcsR0FBRztBQUM3RSxrQkFBTSxPQUFPLE9BQU8sT0FBTyxTQUFTLFdBQzlCLEtBQUssVUFBVSxPQUFPLElBQUksSUFDMUIsT0FBTztBQUNiLGdCQUFJO0FBQ0Esb0JBQU0sRUFBRSxNQUFNLG1CQUFTLFNBQVMsWUFBWSxLQUFLLE1BQU0sSUFBSTtBQUMzRCxvQkFBTSxZQUFZLHNCQUFzQixXQUFXLElBQUk7QUFDdkQsb0JBQU0sT0FBTyxJQUFJLG1CQUFtQixLQUFLLE1BQU0sS0FBSyxXQUFXLFVBQVMsVUFBVSxNQUFNLFNBQVMsT0FBTztBQUN4Ryx5QkFBVyxLQUFLLElBQUk7QUFBQSxZQUN4QixTQUFTLEdBQVA7QUFBQSxZQUVGO0FBQUEsVUFDSjtBQUFBLFFBQ0osQ0FBQztBQUFBLE1BQ0wsU0FBUyxPQUFQO0FBQ0UsY0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBQ0EsUUFBSSxVQUFVO0FBQ1YsYUFBTyxXQUFXLE9BQU8sVUFBUSxDQUFDLFNBQVMsU0FBUyxLQUFLLElBQUksQ0FBQztBQUFBLElBQ2xFLE9BQU87QUFDSCxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQSxFQUVBLE9BQU8saUNBQWlDLGdCQUF5RDtBQUM3RixRQUFJLE1BQU0sUUFBUSxjQUFjLEdBQUc7QUFDL0IsYUFBTztBQUFBLElBQ1gsV0FBVyxnQkFBZ0I7QUFDdkIsYUFBTyxlQUFlLE1BQU0sR0FBRztBQUFBLElBQ25DLE9BQU87QUFDSCxhQUFPLENBQUM7QUFBQSxJQUNaO0FBQUEsRUFDSjtBQUFBLEVBRUEsT0FBTywyQkFBMkIsV0FBb0Q7QUFDbEYsUUFBSSxNQUFNLFFBQVEsU0FBUyxHQUFHO0FBQzFCLGFBQU87QUFBQSxJQUNYLFdBQVcsV0FBVztBQUNsQixhQUFPLFVBQVUsTUFBTSxHQUFHO0FBQUEsSUFDOUIsT0FBTztBQUNILGFBQU8sQ0FBQztBQUFBLElBQ1o7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFPLGdCQUFzQjtBQTlQakM7QUErUFEsUUFBSTtBQUNBLFlBQU0sT0FBTyxLQUFLLGFBQWE7QUFDL0IsWUFBTSxZQUFZLEtBQUssT0FBTyxXQUFXLHFCQUFxQixJQUFJLEtBQUssSUFBSTtBQUMzRSxZQUFNLGtCQUFrQixpQkFBSyxPQUFPLElBQUksY0FBYyxhQUFhLElBQUksTUFBL0MsbUJBQWtELGdCQUFsRCxtQkFBK0Q7QUFDdkYsVUFBSSxpQkFBaUIsVUFBVSxpQ0FBaUMsZUFBZTtBQUUvRSxZQUFNLHNCQUF5RCxvQkFBSSxJQUFJO0FBQ3ZFLDBCQUFvQixJQUFJLEtBQUssTUFBTSxVQUFVLHVCQUF1QixLQUFLLFFBQVEsTUFBTSxjQUFjLENBQUM7QUFFdEcsNkNBQVcsUUFBUSxrQkFBZ0I7QUF4US9DO0FBeVFnQixjQUFNLGVBQWUsS0FBSyxPQUFPLElBQUksTUFBTSxzQkFBc0IsR0FBRyxLQUFLLE9BQU8sU0FBUyxpQkFBaUIsaUJBQWlCO0FBQzNILGNBQU0sV0FBVyxJQUFJLFVBQVUsS0FBSyxRQUFRLFlBQVk7QUFDeEQsNEJBQW9CLElBQUksY0FBYyxVQUFVLHVCQUF1QixLQUFLLFFBQVEsVUFBVSxjQUFjLENBQUM7QUFDN0csWUFBSSx3QkFBd0IsMkJBQVMsYUFBYSxjQUFjLE1BQU07QUFDbEUsZ0JBQU0sbUJBQWtCLG1CQUFLLE9BQU8sSUFBSSxjQUFjLGFBQWEsWUFBWSxNQUF2RCxvQkFBMEQsZ0JBQTFELG9CQUF1RTtBQUMvRix5QkFBZSxLQUFLLEdBQUcsVUFBVSxpQ0FBaUMsZ0JBQWUsQ0FBQztBQUFBLFFBQ3RGO0FBQUEsTUFDSjtBQUNBLGlCQUFXLENBQUMsZUFBZSx3QkFBd0IscUJBQXFCO0FBQ3BFLGFBQUssV0FBVyxLQUFLLEdBQUcsb0JBQW9CLE9BQU8sVUFBUSxDQUFDLEtBQUssV0FBVyxJQUFJLFdBQVMsTUFBTSxJQUFJLEVBQUUsU0FBUyxLQUFLLElBQUksQ0FBQyxDQUFDO0FBQUEsTUFDN0g7QUFBQSxJQUNKLFNBQVMsT0FBUDtBQUNFLFlBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBTyxhQUFxQjtBQXpSaEM7QUEwUlEsVUFBTSxpQkFBaUIsaUJBQUssT0FBTyxJQUFJLGNBQWMsYUFBYSxLQUFLLGFBQWEsQ0FBQyxNQUE5RCxtQkFBaUUsZ0JBQWpFLG1CQUE4RTtBQUNyRyxXQUFPLGtCQUFrQixDQUFDLE1BQU0sY0FBYyxJQUFJLGlCQUFpQjtBQUFBLEVBQ3ZFO0FBQUEsRUFFQSxBQUFhLGNBQWMsWUFBNkM7QUFBQTtBQUNwRSxZQUFNLE9BQU8sS0FBSyxhQUFhLEVBQUU7QUFDakMsWUFBTSxVQUF5QixDQUFDO0FBQ2hDLGFBQU8sS0FBSyxPQUFPLEVBQUUsUUFBUSxDQUFPLFFBQThCO0FBQzlELGNBQU0sRUFBRSxNQUFNLFlBQVksUUFBUTtBQUNsQyxnQkFBUSxLQUFLLEVBQUUsTUFBWSxTQUFTLEVBQUUsT0FBTyxRQUFRLFdBQVcsSUFBOEIsRUFBRSxFQUFFLENBQUM7QUFBQSxNQUN2RyxFQUFDO0FBRUQsY0FBUSxLQUFLLEVBQUUsTUFBTSxXQUFXLFNBQVMsRUFBRSxPQUFPLEdBQUcsS0FBSyxXQUFXLElBQUksSUFBSSxFQUFFLENBQUM7QUFDaEYsWUFBTSxXQUFXLEtBQUssUUFBUSxTQUFTLElBQUk7QUFBQSxJQUMvQztBQUFBO0FBQUEsRUFFQSxBQUFhLGdCQUNULFNBQ0EsU0FDQSxZQUNBLE1BQ0EsWUFDQSxZQUNhO0FBQUE7QUFDYixZQUFNLFlBQVksT0FBTyxLQUFLLE9BQU8sV0FBVyxnQkFBZ0IsSUFBSSxLQUFLLGFBQWEsSUFBSztBQUMzRixZQUFNLE9BQU8sVUFBVSxhQUFhO0FBQ3BDLFVBQUksU0FBUyxNQUFNLEtBQUssT0FBTyxJQUFJLE1BQU0sS0FBSyxJQUFJO0FBQ2xELFVBQUksTUFBTTtBQUNOLFlBQUksYUFBdUIsQ0FBQztBQUM1QixlQUFPLE1BQU0sSUFBSSxFQUFFLFFBQVEsVUFBUTtBQUMvQixjQUFJLEtBQUssV0FBVyxLQUFLLElBQUksR0FBRztBQUM1QixnQkFBSSxXQUFnQyxDQUFDO0FBQ3JDLHFCQUFTLFVBQVU7QUFDbkIsZ0JBQUk7QUFBWSx1QkFBUyxhQUFhO0FBQ3RDLGdCQUFJO0FBQVksdUJBQVMsYUFBYTtBQUN0QyxnQkFBSTtBQUFZLHVCQUFTLGFBQWE7QUFDdEMsdUJBQVcsS0FBSyxHQUFHLGFBQWEsS0FBSyxVQUFVLFFBQVEsR0FBRztBQUFBLFVBQzlELE9BQU87QUFDSCx1QkFBVyxLQUFLLElBQUk7QUFBQSxVQUN4QjtBQUFBLFFBQ0osQ0FBQztBQUNELGNBQU0sS0FBSyxPQUFPLElBQUksTUFBTSxPQUFPLE1BQU0sV0FBVyxLQUFLLElBQUksQ0FBQztBQUFBLE1BQ2xFLE9BQU87QUFDSCxZQUFJLFdBQWdDLENBQUM7QUFDckMsaUJBQVMsVUFBVTtBQUNuQixZQUFJO0FBQVksbUJBQVMsYUFBYTtBQUN0QyxZQUFJO0FBQVksbUJBQVMsYUFBYTtBQUN0QyxZQUFJO0FBQVksbUJBQVMsYUFBYTtBQUN0QyxrQkFBVztBQUFBLEVBQUssYUFBYSxLQUFLLFVBQVUsUUFBUTtBQUNwRCxjQUFNLEtBQUssT0FBTyxJQUFJLE1BQU0sT0FBTyxNQUFNLE1BQU07QUFBQSxNQUNuRDtBQUFBLElBQ0o7QUFBQTtBQUFBLEVBRUEsQUFBYSxnQkFBZ0IsTUFBeUM7QUFBQTtBQUNsRSxZQUFNLE9BQU8sS0FBSyxhQUFhO0FBQy9CLFlBQU0sU0FBUyxNQUFNLEtBQUssT0FBTyxJQUFJLE1BQU0sS0FBSyxJQUFJO0FBQ3BELFVBQUksYUFBdUIsQ0FBQztBQUM1QixhQUFPLE1BQU0sSUFBSSxFQUFFLFFBQVEsVUFBUTtBQUMvQixZQUFJLENBQUMsS0FBSyxXQUFXLEtBQUssSUFBSSxHQUFHO0FBQzdCLHFCQUFXLEtBQUssSUFBSTtBQUFBLFFBQ3hCO0FBQUEsTUFDSixDQUFDO0FBQ0QsWUFBTSxLQUFLLE9BQU8sSUFBSSxNQUFNLE9BQU8sTUFBTSxXQUFXLEtBQUssSUFBSSxDQUFDO0FBQUEsSUFDbEU7QUFBQTtBQUFBLEVBRUEsT0FBTyxnQkFBZ0IsUUFBc0IsTUFBYyxnQkFBeUIsT0FBa0I7QUFDbEcsVUFBTSxZQUFZLElBQUksVUFBVSxRQUFRLElBQUk7QUFDNUMsY0FBVSxVQUFVLFVBQVUsb0JBQW9CO0FBQ2xELGNBQVUsY0FBYztBQUN4QixXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsT0FBTyx5QkFBeUIsUUFBc0IsTUFBa0M7QUFsVzVGO0FBbVdRLFVBQU0scUJBQXFCLElBQUksT0FBTyxHQUFHLE9BQU8sU0FBUyx1Q0FBdUM7QUFDaEcsV0FBTyxpQkFBSyxNQUFNLGtCQUFrQixNQUE3QixtQkFBZ0MsV0FBaEMsbUJBQXdDO0FBQUEsRUFDbkQ7QUFDSjs7O0FIOVZBLElBQU0sd0JBQU4sTUFBNEI7QUFBQSxFQUd4QixZQUNZLFdBQ0EsV0FDRCxvQkFDUCxRQUNGO0FBSlU7QUFDQTtBQUNEO0FBR1AsU0FBSyxTQUFTO0FBQ2QsU0FBSyxhQUFhO0FBQUEsRUFDdEI7QUFBQSxFQUVBLEFBQVEsZUFBcUI7QUFFekIsVUFBTSxxQkFBcUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQzdFLHVCQUFtQixTQUFTLFFBQVEsRUFBRSxNQUFNLEtBQUssbUJBQW1CLE1BQU0sS0FBSyxRQUFRLENBQUM7QUFDeEYsVUFBTSxnQkFBZ0IsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQ3hFLFVBQU0sT0FBTyxjQUFjLFVBQVUsRUFBRSxLQUFLLFFBQVEsa0JBQWtCLEtBQUssbUJBQW1CLFFBQVEsQ0FBQztBQUN2RyxTQUFLLFFBQVEsS0FBSyxtQkFBbUIsSUFBSTtBQUN6QyxVQUFNLHdCQUF3QixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDbkYsU0FBSyxjQUFjLHFCQUFxQjtBQUN4QyxTQUFLLGdCQUFnQixxQkFBcUI7QUFDMUMsVUFBTSx3QkFBd0IsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQ25GLDBCQUFzQixTQUFTLFFBQVEsRUFBRSxLQUFLLGVBQWUsTUFBTSxHQUFHLEtBQUssbUJBQW1CLGlCQUFpQixLQUFLLE1BQU0sSUFBSSxDQUFDO0FBQUEsRUFDbkk7QUFBQSxFQUVBLEFBQVEsY0FBYyxXQUE4QjtBQUNoRCxVQUFNLE1BQU0sSUFBSSxrQ0FBZ0IsU0FBUztBQUN6QyxRQUFJLFFBQVEsUUFBUTtBQUNwQixRQUFJLFdBQVcsTUFBTTtBQUNyQixRQUFJLFFBQVEsTUFBTTtBQUNkLFVBQUksUUFBUSxJQUFJLHdCQUNaLEtBQUssUUFDTCxLQUFLLFdBQ0wsS0FBSyxrQkFDVDtBQUNBLFlBQU0sS0FBSztBQUFBLElBQ2YsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQVEsZ0JBQWdCLFdBQThCO0FBQ2xELFVBQU0sTUFBTSxJQUFJLGtDQUFnQixTQUFTO0FBQ3pDLFFBQUksUUFBUSxPQUFPO0FBQ25CLFFBQUksV0FBVyxRQUFRO0FBQ3ZCLFFBQUksU0FBUyxNQUFNO0FBQ25CLFFBQUksUUFBUSxNQUFNO0FBRWQsdUNBQWlDLEtBQUssUUFBUSxLQUFLLFdBQVcsS0FBSyxtQkFBbUIsSUFBSTtBQUFBLElBQzlGLENBQUM7QUFBQSxFQUNMO0FBQ0o7QUFFTyxJQUFNLHNCQUFOLE1BQTBCO0FBQUEsRUFJN0IsWUFDSSxRQUNRLGVBQ0EsV0FDVjtBQUZVO0FBQ0E7QUFFUixTQUFLLFNBQVM7QUFDZCxTQUFLLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLFlBQVksQ0FBQztBQUNsRSxTQUFLLGNBQWM7QUFBQSxFQUN2QjtBQUFBLEVBRUEsQUFBUSxhQUFtQjtBQUN2QixVQUFNLFNBQVMsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLFNBQVMsQ0FBQztBQUN6RCxVQUFNLGVBQWUsT0FBTyxVQUFVLEVBQUUsS0FBSyxPQUFPLENBQUM7QUFDckQsVUFBTSxTQUFTLGFBQWEsU0FBUyxRQUFRO0FBQzdDLG1DQUFRLFFBQVEsV0FBVztBQUMzQixXQUFPLFVBQVUsTUFBWTtBQUN6QixZQUFNLDBCQUEwQixJQUFJLHdCQUF3QixLQUFLLFFBQVEsVUFBVSxnQkFBZ0IsS0FBSyxRQUFRLEtBQUssVUFBVSxJQUFJLENBQUM7QUFDcEksOEJBQXdCLEtBQUs7QUFBQSxJQUNqQztBQUFBLEVBQ0o7QUFBQSxFQUVBLGdCQUFzQjtBQUNsQixTQUFLLFVBQVUsZ0JBQWdCO0FBQy9CLFVBQU0sa0JBQWtCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxtQkFBbUIsQ0FBQztBQUM1RSxVQUFNLGFBQWEsVUFBVSx1QkFBdUIsS0FBSyxRQUFRLEtBQUssU0FBUztBQUMvRSxlQUFXLFFBQVEsZUFBYTtBQUU1QixVQUFJLHNCQUFzQixpQkFBaUIsS0FBSyxXQUFXLFdBQVcsS0FBSyxNQUFNO0FBQUEsSUFDckYsQ0FBQztBQUNELFNBQUssV0FBVztBQUFBLEVBQ3BCO0FBQ0o7OztBSy9GQSx3QkFBeUc7QUFJekcsSUFBTSxxQkFBTixjQUFpQywrQkFBcUI7QUFBQSxFQUVsRCxZQUFvQixNQUE2QjtBQUM3QyxVQUFNLEtBQUssT0FBTyxHQUFHO0FBREw7QUFBQSxFQUVwQjtBQUFBLEVBRUEsZUFBZSxPQUF5QjtBQUNwQyxVQUFNLG1CQUFtQixDQUFDLEdBQUcsS0FBSyxLQUFLLE9BQU8sV0FBVyxnQkFBZ0IsS0FBSyxDQUFDO0FBQy9FLFVBQU0sY0FBYyxLQUFLLEtBQUssVUFBVTtBQUN4QyxXQUFPLGlCQUNGLEtBQUssRUFDTCxPQUFPLFVBQVEsU0FBUyxlQUFlLEtBQUssWUFBWSxFQUFFLFNBQVMsTUFBTSxZQUFZLENBQUMsQ0FBQztBQUFBLEVBQ2hHO0FBQUEsRUFFQSxtQkFBbUIsTUFBYyxLQUFpQztBQUM5RCxVQUFNLFdBQVUsS0FBSyxLQUFLLFVBQVUsb0JBQW9CO0FBQ3hELFVBQU0sU0FBUyxLQUFLLEtBQUssT0FBTyxXQUFXLGdCQUFnQixJQUFJLElBQUk7QUFDbkUsUUFBSSxRQUFRO0FBQ1IsZUFBUSxTQUFTO0FBQ2pCLFdBQUssS0FBSyxVQUFVLGNBQWMsUUFBTztBQUFBLElBQzdDO0FBQUEsRUFDSjtBQUFBLEVBRUEsaUJBQWlCLE9BQWUsSUFBaUI7QUFDN0MsT0FBRyxRQUFRLEtBQUs7QUFBQSxFQUNwQjtBQUNKO0FBR0EsSUFBTSxrQkFBTixjQUE4QiwrQkFBcUI7QUFBQSxFQUUvQyxZQUFvQixNQUE2QjtBQUM3QyxVQUFNLEtBQUssT0FBTyxHQUFHO0FBREw7QUFBQSxFQUVwQjtBQUFBLEVBRUEsZUFBZSxPQUF5QjtBQUVwQyxVQUFNLE9BQU8sT0FBTyxLQUFLLEtBQUssS0FBSyxPQUFPLElBQUksY0FBYyxRQUFRLENBQUM7QUFDckUsV0FBTyxLQUFLLE9BQU8sT0FBSyxFQUFFLFlBQVksRUFBRSxTQUFTLE1BQU0sWUFBWSxDQUFDLENBQUM7QUFBQSxFQUN6RTtBQUFBLEVBRUEsbUJBQW1CLE1BQWMsS0FBaUM7QUFDOUQsVUFBTSxXQUFVLEtBQUssS0FBSyxVQUFVLG9CQUFvQjtBQUN4RCxVQUFNLFdBQVcsU0FBUSxZQUFZLENBQUM7QUFDdEMsYUFBUyxLQUFLLEtBQUssUUFBUSxVQUFVLElBQUksQ0FBQztBQUMxQyxhQUFRLFdBQVc7QUFDbkIsU0FBSyxLQUFLLFVBQVUsY0FBYyxRQUFPO0FBQUEsRUFFN0M7QUFBQSxFQUVBLGlCQUFpQixPQUFlLElBQWlCO0FBQzdDLE9BQUcsUUFBUSxLQUFLO0FBQUEsRUFDcEI7QUFDSjtBQUVBLElBQU0sb0JBQU4sY0FBZ0MsK0JBQXFCO0FBQUEsRUFFakQsWUFBb0IsTUFBNkI7QUFDN0MsVUFBTSxLQUFLLE9BQU8sR0FBRztBQURMO0FBQUEsRUFFcEI7QUFBQSxFQUVBLGVBQWUsT0FBeUI7QUFDcEMsVUFBTSxnQkFBZ0IsS0FBSyxLQUFLLFVBQVU7QUFDMUMsVUFBTSxrQkFBa0IsS0FBSyxLQUFLLE9BQU8sV0FBVyxrQkFBa0IsSUFBSSxhQUFhLEtBQUssQ0FBQztBQUM3RixVQUFNLGlCQUFpQixLQUFLLEtBQUssVUFBVSxvQkFBb0IsRUFBRTtBQUNqRSxXQUFPLGdCQUNGLE9BQU8sU0FBSTtBQXZFeEI7QUF3RWdCLGlCQUFJLGtCQUFrQixpQkFDbkIsV0FBSSxrQkFBSixtQkFBbUIsY0FBYyxTQUFTLE1BQU0sWUFBWSxPQUM1RCxDQUFDLGtEQUFnQixJQUFJLFVBQVEsS0FBSyxNQUFNLFNBQVMsSUFBSTtBQUFBLEtBQzVELEVBQ0MsSUFBSSxTQUFPLElBQUksSUFBSTtBQUFBLEVBQzVCO0FBQUEsRUFFQSxtQkFBbUIsTUFBYyxLQUFpQztBQUM5RCxVQUFNLFdBQVUsS0FBSyxLQUFLLFVBQVUsb0JBQW9CO0FBQ3hELFVBQU0saUJBQWlCLFNBQVEsWUFBWSxDQUFDO0FBQzVDLFVBQU0sZ0JBQWdCLEtBQUssS0FBSyxVQUFVLFdBQVcsS0FBSyxXQUFTLE1BQU0sU0FBUyxJQUFJO0FBQ3RGLFFBQUksZUFBZTtBQUNmLHFCQUFlLEtBQUssYUFBYTtBQUNqQyxlQUFRLFdBQVc7QUFDbkIsV0FBSyxLQUFLLFVBQVUsY0FBYyxRQUFPO0FBQUEsSUFDN0M7QUFBQSxFQUNKO0FBQUEsRUFFQSxpQkFBaUIsT0FBZSxJQUFpQjtBQUM3QyxPQUFHLFFBQVEsS0FBSztBQUFBLEVBQ3BCO0FBQ0o7QUFFQSxJQUFNLG1CQUFOLE1BQXVCO0FBQUEsRUFHbkIsWUFDWSxXQUNBLE9BQ0EsYUFDQSxzQkFDVjtBQUpVO0FBQ0E7QUFDQTtBQUNBO0FBRVIsU0FBSyxhQUFhO0FBQUEsRUFDdEI7QUFBQSxFQUVBLEFBQVEsZUFBcUI7QUFFekIsU0FBSyxVQUFVLFVBQVUsRUFBRSxNQUFNLEtBQUssT0FBTyxLQUFLLFFBQVEsQ0FBQztBQUMzRCxVQUFNLHNCQUFzQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssY0FBYyxDQUFDO0FBQzNFLFVBQU0sYUFBYSxJQUFJLGtDQUFnQixtQkFBbUIsRUFDckQsUUFBUSxhQUFhLEVBQ3JCLFNBQVMsZ0JBQWdCO0FBQzlCLFVBQU0sU0FBUyxLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQ3pELFNBQUsscUJBQXFCLE1BQU07QUFDaEMsVUFBTSxVQUFVLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxlQUFlLENBQUM7QUFDaEUsWUFBUSxZQUFZLEtBQUs7QUFDekIsWUFBUSxLQUFLO0FBQ2IsZUFBVyxTQUFTLGNBQWMsTUFBTSxRQUFRLEtBQUs7QUFDckQsZUFBVyxTQUFTLGFBQWEsTUFBTSxRQUFRLEtBQUs7QUFBQSxFQUN4RDtBQUNKO0FBRU8sSUFBTSx3QkFBTixNQUE0QjtBQUFBLEVBTS9CLFlBQ0ksUUFDUSxlQUNELFdBQ1Q7QUFGVTtBQUNEO0FBRVAsU0FBSyxTQUFTO0FBQ2QsU0FBSyxZQUFZLEtBQUssY0FBYyxVQUFVLEVBQUUsS0FBSyxjQUFjLENBQUM7QUFDcEUsU0FBSyxjQUFjO0FBQUEsRUFDdkI7QUFBQSxFQUVBLEFBQU8sZ0JBQXNCO0FBQ3pCLFNBQUssbUJBQW1CLEtBQUssVUFBVSxvQkFBb0I7QUFDM0QsU0FBSyxVQUFVLGdCQUFnQjtBQUMvQixVQUFNLG9CQUFvQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDaEYsUUFBSSxpQkFDQSxtQkFDQSx3QkFDQSxzREFDQSxDQUFDLFdBQTJCLEtBQUssb0JBQW9CLE1BQU0sQ0FDL0Q7QUFDQSxRQUFJLGlCQUNBLG1CQUNBLGdCQUNBLGtCQUFrQixLQUFLLE9BQU8sU0FBUyxvR0FFdkMsQ0FBQyxXQUEyQixLQUFLLHlCQUF5QixNQUFNLENBQ3BFO0FBQ0EsUUFBSSxpQkFDQSxtQkFDQSxlQUNBLGtFQUNBLENBQUMsV0FBMkIsS0FBSyxtQkFBbUIsTUFBTSxDQUM5RDtBQUNBLFFBQUksaUJBQ0EsbUJBQ0EsYUFDQSw4QkFBOEIsS0FBSyxPQUFPLFNBQVMsdUJBQ25ELENBQUMsV0FBMkIsS0FBSyx1QkFBdUIsTUFBTSxDQUNsRTtBQUNBLFFBQUksaUJBQ0EsbUJBQ0Esb0JBQ0EsNkNBQ0EsQ0FBQyxXQUEyQixLQUFLLHFCQUFxQixNQUFNLENBQ2hFO0FBQ0EsUUFBSSxpQkFDQSxtQkFDQSxtQkFDQSx3REFDQSxDQUFDLFdBQTJCLEtBQUssdUJBQXVCLE1BQU0sQ0FDbEU7QUFDQSxTQUFLLGFBQWE7QUFDbEIsU0FBSyxRQUFRLFlBQVksUUFBUTtBQUFBLEVBQ3JDO0FBQUEsRUFFQSxBQUFRLGVBQXFCO0FBQ3pCLFVBQU0sU0FBUyxLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQ3pELFVBQU0sZUFBZSxPQUFPLFVBQVUsRUFBRSxLQUFLLE9BQU8sQ0FBQztBQUNyRCxTQUFLLFVBQVUsYUFBYSxTQUFTLFFBQVE7QUFDN0MsbUNBQVEsS0FBSyxTQUFTLE1BQU07QUFDNUIsU0FBSyxRQUFRLFVBQVUsTUFBWTtBQUMvQixZQUFNLEtBQUssVUFBVSxjQUFjLEtBQUssZ0JBQWdCO0FBQUEsSUFDNUQ7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFRLG9CQUFvQixRQUE4QjtBQUN0RCxVQUFNLFFBQVEsSUFBSSxnQ0FBYyxNQUFNO0FBQ3RDLFVBQU0sU0FBUyxHQUFHLEtBQUssaUJBQWlCLE9BQU87QUFDL0MsVUFBTSxTQUFTLENBQUMsVUFBVTtBQUN0QixXQUFLLFFBQVEsU0FBUyxRQUFRO0FBQzlCLFdBQUssaUJBQWlCLFFBQVEsU0FBUyxLQUFLLEtBQUssS0FBSyxpQkFBaUI7QUFBQSxJQUMzRSxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSx5QkFBeUIsUUFBOEI7QUFDM0QsVUFBTSxVQUFVLElBQUksa0NBQWdCLE1BQU07QUFDMUMsWUFBUSxTQUFTLEtBQUssaUJBQWlCLFVBQVU7QUFDakQsWUFBUSxTQUFTLENBQUMsVUFBVTtBQUN4QixXQUFLLFFBQVEsU0FBUyxRQUFRO0FBQzlCLFdBQUssaUJBQWlCLGFBQWE7QUFBQSxJQUN2QyxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxtQkFBbUIsUUFBOEI7QUFDckQsVUFBTSx1QkFBdUIsT0FBTyxVQUFVLEVBQUUsS0FBSyxlQUFlLENBQUM7QUFDckUsVUFBTSxRQUFRLElBQUksZ0NBQWMsb0JBQW9CO0FBQ3BELFVBQU0sZ0JBQWdCLHFCQUFxQixVQUFVLENBQUMsQ0FBQztBQUN2RCxVQUFNLFNBQVMsS0FBSyxpQkFBaUIsSUFBSTtBQUN6QyxtQ0FBUSxlQUFlLEtBQUssaUJBQWlCLElBQUk7QUFDakQsVUFBTSxTQUFTLENBQUMsVUFBVTtBQUN0QixXQUFLLFFBQVEsU0FBUyxRQUFRO0FBQzlCLFdBQUssaUJBQWlCLE9BQU87QUFDN0IscUNBQVEsZUFBZSxLQUFLLGlCQUFpQixJQUFJO0FBQUEsSUFDckQsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQVEsdUJBQXVCLFFBQThCO0FBbE9qRTtBQW1PUSxVQUFNLGdCQUFnQixPQUFPLFVBQVUsRUFBRSxLQUFLLFFBQVEsQ0FBQztBQUN2RCxlQUFLLGlCQUFpQixhQUF0QixtQkFBZ0MsUUFBUSxhQUFXO0FBQy9DLFlBQU0sZUFBZSxjQUFjLFVBQVUsRUFBRSxLQUFLLGFBQWEsTUFBTSxRQUFRLENBQUM7QUFDaEYsVUFBSSxrQ0FBZ0IsWUFBWSxFQUMzQixRQUFRLFVBQVUsRUFDbEIsU0FBUyxhQUFhLEVBQ3RCLFFBQVEsTUFBWTtBQXpPckM7QUEwT29CLG9CQUFLLGlCQUFpQixhQUF0QixvQkFBZ0MsT0FBTztBQUN2QyxjQUFNLEtBQUssVUFBVSxjQUFjLEtBQUssZ0JBQWdCO0FBQUEsTUFDNUQsRUFBQztBQUFBLElBQ1Q7QUFDQSxVQUFNLFlBQVksY0FBYyxTQUFTLFVBQVUsRUFBRSxLQUFLLFdBQVcsQ0FBQztBQUN0RSxtQ0FBUSxXQUFXLGFBQWE7QUFDaEMsY0FBVSxVQUFVLE1BQU07QUFDdEIsVUFBSSxnQkFBZ0IsSUFBSSxFQUFFLEtBQUs7QUFBQSxJQUNuQztBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQVEsdUJBQXVCLFFBQThCO0FBclBqRTtBQXNQUSxVQUFNLGtCQUFrQixPQUFPLFVBQVUsRUFBRSxLQUFLLFFBQVEsQ0FBQztBQUN6RCxlQUFLLGlCQUFpQixhQUF0QixtQkFBZ0MsUUFBUSxXQUFTO0FBQzdDLFlBQU0sZ0JBQWdCLGdCQUFnQixVQUFVLEVBQUUsS0FBSyxhQUFhLE1BQU0sTUFBTSxLQUFLLENBQUM7QUFDdEYsVUFBSSxrQ0FBZ0IsYUFBYSxFQUM1QixRQUFRLFVBQVUsRUFDbEIsU0FBUyxhQUFhLEVBQ3RCLFFBQVEsTUFBWTtBQTVQckM7QUE2UG9CLGNBQU0saUJBQWlCLFlBQUssaUJBQWlCLGFBQXRCLG9CQUFnQyxPQUFPLFVBQVEsS0FBSyxTQUFTLE1BQU07QUFDMUYsYUFBSyxpQkFBaUIsV0FBVztBQUNqQyxjQUFNLEtBQUssVUFBVSxjQUFjLEtBQUssZ0JBQWdCO0FBQUEsTUFDNUQsRUFBQztBQUFBLElBQ1Q7QUFDQSxVQUFNLGNBQWMsZ0JBQWdCLFNBQVMsVUFBVSxFQUFFLEtBQUssT0FBTyxDQUFDO0FBQ3RFLG1DQUFRLGFBQWEsYUFBYTtBQUNsQyxnQkFBWSxVQUFVLE1BQU07QUFDeEIsVUFBSSxrQkFBa0IsSUFBSSxFQUFFLEtBQUs7QUFBQSxJQUNyQztBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQVEscUJBQXFCLFFBQThCO0FBelEvRDtBQTBRUSxVQUFNLHlCQUF5QixPQUFPLFVBQVUsRUFBRSxLQUFLLFFBQVEsQ0FBQztBQUNoRSxVQUFNLHNCQUFzQix1QkFBdUIsVUFBVSxFQUFFLEtBQUssT0FBTyxDQUFDO0FBQzVFLFVBQU0sU0FBUyxLQUFLLGlCQUFpQjtBQUNyQyxRQUFJLFFBQVE7QUFDUixZQUFNLE9BQU8sS0FBSyxVQUFVLGFBQWEsRUFBRTtBQUMzQyxZQUFNLFlBQVksS0FBSztBQUN2Qix5Q0FBaUIsZUFBZSxLQUFLLE9BQU8sVUFBVSxxQkFBcUIsTUFBTSxTQUFTO0FBQzFGLGdDQUFvQixjQUFjLGlCQUFpQixNQUFuRCxtQkFBc0QsaUJBQWlCLFNBQVMsQ0FBQyxNQUFNO0FBalJuRztBQWtSZ0IsYUFBSyxPQUFPLElBQUksVUFBVSxhQUV0QixTQUFFLE9BQU8sUUFBUSxXQUFXLEVBQUUsTUFBTSxHQUFHLEVBQUUsS0FBSyxNQUE5QyxvQkFBaUQsUUFBUSxXQUFXLE9BQ3BFLE1BRUEsS0FDSjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQ0EsMkJBQXVCLFVBQVUsRUFBRSxLQUFLLGNBQWMsQ0FBQztBQUN2RCxRQUFJLFFBQVE7QUFDUixZQUFNLGtCQUFrQix1QkFBdUIsU0FBUyxVQUFVLEVBQUUsS0FBSyxPQUFPLENBQUM7QUFDakYscUNBQVEsaUJBQWlCLE9BQU87QUFDaEMsc0JBQWdCLFVBQVUsTUFBWTtBQUNsQyxlQUFRLEtBQUssaUJBQWlCO0FBQzlCLGNBQU0sS0FBSyxVQUFVLGNBQWMsS0FBSyxnQkFBZ0I7QUFBQSxNQUM1RDtBQUFBLElBQ0o7QUFDQSxVQUFNLGtCQUFrQix1QkFBdUIsU0FBUyxVQUFVLEVBQUUsS0FBSyxtQkFBbUIsQ0FBQztBQUM3RixtQ0FBUSxpQkFBaUIsTUFBTTtBQUMvQixvQkFBZ0IsVUFBVSxNQUFNO0FBQzVCLFVBQUksbUJBQW1CLElBQUksRUFBRSxLQUFLO0FBQUEsSUFDdEM7QUFBQSxFQUNKO0FBQ0o7OztBQ3pTQSx3QkFBK0M7QUFJL0MsSUFBTSxvQkFBb0I7QUFBQSxFQUN0QixPQUFPO0FBQUEsRUFDUCxRQUFRO0FBQ1o7QUFFTyxJQUFNLHFCQUFOLE1BQXlCO0FBQUEsRUFhNUIsWUFDSSxRQUNRLFdBQ0EsZUFDQSxXQUNWO0FBSFU7QUFDQTtBQUNBO0FBWlosU0FBUSxVQUF5QyxDQUFDO0FBQ2xELFNBQVEsVUFBOEcsQ0FBQztBQUd2SCxTQUFRLGFBQXFCO0FBVXpCLFNBQUssU0FBUztBQUNkLFNBQUssWUFBWSxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssV0FBVyxDQUFDO0FBQ2pFLFNBQUssUUFBUSxLQUFLLFVBQVUsb0JBQW9CLEVBQUU7QUFDbEQsU0FBSyxhQUFhO0FBQUEsRUFDdEI7QUFBQSxFQUVBLEFBQVEsZUFBcUI7QUFDekIsVUFBTSxTQUFTLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxVQUFVLENBQUM7QUFDMUQsVUFBTSxpQkFBaUIsT0FBTyxVQUFVLEVBQUUsS0FBSyxRQUFRLENBQUM7QUFDeEQsU0FBSyxzQkFBc0IsT0FBTyxVQUFVLEVBQUUsS0FBSyxhQUFhLENBQUM7QUFDakUsVUFBTSxrQkFBa0IsT0FBTyxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDMUQsVUFBTSxpQkFBaUIsT0FBTyxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDekQsU0FBSyxrQkFBa0IsY0FBYztBQUNyQyxTQUFLLHVCQUF1QixLQUFLLG1CQUFtQjtBQUNwRCxTQUFLLDJCQUEyQixlQUFlO0FBQy9DLFNBQUssb0JBQW9CLGNBQWM7QUFDdkMsU0FBSyxrQkFBa0IsY0FBYztBQUFBLEVBQ3pDO0FBQUEsRUFFQSxBQUFPLFNBQWU7QUFDbEIsU0FBSyxXQUFXO0FBQ2hCLFNBQUsseUJBQXlCLEtBQUssbUJBQW1CO0FBQ3RELFNBQUssY0FBYyxVQUFVO0FBQUEsRUFDakM7QUFBQSxFQUVBLEFBQU8sYUFBbUI7QUF0RDlCO0FBdURRLFFBQUksS0FBSyxnQkFBZ0I7QUFDckIsV0FBSyxlQUFlLE9BQU87QUFBQSxJQUMvQjtBQUFDO0FBQ0QsU0FBSyxpQkFBaUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxNQUFNLEVBQUUsSUFBSSxtQkFBbUIsS0FBSyxNQUFNLEtBQUssSUFBSSxJQUFJLEdBQUksSUFBSSxFQUFFLENBQUM7QUFDbkgsU0FBSyxlQUFlLFdBQVcsQ0FBQyxNQUFNO0FBM0Q5QztBQTREWSxZQUFNLFFBQVEsS0FBSztBQUNuQixZQUFNLFlBQVksS0FBSyxlQUFlLGlCQUFpQiw2QkFBNkI7QUFDcEYsWUFBTSxnQkFBZ0IsaUJBQVUsT0FBVixvQkFBYyxjQUFjO0FBQ2xELFVBQUksYUFBYSxlQUFlO0FBQzVCLFlBQUksQ0FBQyxLQUFLO0FBQWdCLGVBQUssaUJBQWlCLFdBQVcsaUJBQWlCLFVBQVUsRUFBRSxFQUFFLEtBQUs7QUFDL0YsWUFBSSxDQUFDLEtBQUs7QUFBZSxlQUFLLGdCQUFnQixXQUFXLGlCQUFpQixhQUFhLEVBQUUsS0FBSztBQUM5RixjQUFNLFdBQVksRUFBRSxPQUEwQjtBQUM5QyxZQUFJLE9BQU8sV0FBVyxvQkFBb0IsRUFBRSxTQUFTO0FBQ2pELGNBQUksYUFBYSxHQUFHO0FBQ2hCLGtCQUFNLFNBQVMsVUFBVTtBQUN6QixrQkFBTSxpQkFBaUIsNkJBQTZCLEVBQUUsUUFBUSxDQUFDLFNBQXNCO0FBQ2pGLGNBQUMsS0FBSyxjQUFjLGVBQWUsRUFBa0IsTUFBTSxXQUFXLEdBQUcsS0FBSyxJQUMxRSxJQUFJLEtBQUssZUFDVCxLQUFLLGlCQUFpQixLQUFLLGdCQUFnQixRQUMvQztBQUFBLFlBQ0osQ0FBQztBQUFBLFVBQ0wsT0FBTztBQUNILGlCQUFLLGVBQWUsWUFBWSxVQUFVO0FBQzFDLGtCQUFNLGlCQUFpQiw2QkFBNkIsRUFBRSxRQUFRLENBQUMsU0FBc0I7QUFDakYsY0FBQyxLQUFLLGNBQWMsZUFBZSxFQUFrQixNQUFNLFdBQVc7QUFBQSxZQUMxRSxDQUFDO0FBQUEsVUFDTDtBQUFBLFFBRUo7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFFBQUksT0FBTztBQUNQLFlBQU0sVUFBVSxLQUFLLG1CQUFtQixHQUFHLEtBQUssZ0JBQWdCLEtBQUssUUFBUSxLQUFLLFVBQVUsYUFBYSxFQUFFLElBQUk7QUFBQSxJQUNuSDtBQUVBLFNBQUssb0JBQW9CO0FBQUEsRUFDN0I7QUFBQSxFQUVBLEFBQVEsc0JBQTRCO0FBQ2hDLFNBQUssVUFBVSxpQkFBaUIsaUJBQWlCLEVBQzVDLFFBQVEsQ0FBQyxTQUEwQjtBQUNoQyxXQUFLLGlCQUFpQixTQUFTLE1BQUc7QUFsR2xEO0FBa0dxRCxvQkFBSyxPQUFPLElBQUksVUFBVSxhQUUzRCxXQUFLLFFBQVEsV0FBVyxFQUFFLE1BQU0sR0FBRyxFQUFFLEtBQUssTUFBMUMsbUJBQTZDLFFBQVEsV0FBVyxPQUNoRSxLQUFLLFVBQVUsYUFBYSxFQUFFLE1BQzlCLEtBQ0o7QUFBQSxPQUFDO0FBQUEsSUFDTCxDQUFDO0FBQUEsRUFDVDtBQUFBLEVBRUEsQUFBUSx5QkFBeUIsV0FBaUM7QUEzR3RFO0FBNEdRLGNBQVUsZ0JBQWdCO0FBRTFCLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFFBQUksT0FBTztBQUNQLFlBQU0sU0FBVSxJQUFJLFNBQVMsTUFBTSxXQUFXLFVBQVUsS0FBSyxlQUFlLEdBQUcsRUFBRyxLQUFLLEVBQUU7QUFDekYsWUFBTSxRQUFRLE9BQU87QUFDckIsZUFBUyxJQUFJLEdBQUcsS0FBSyxLQUFLLE1BQU0sUUFBUSxLQUFLLEtBQUssR0FBRyxLQUFLO0FBQ3RELFlBQUksSUFBSSxLQUFLLFFBQVEsT0FBTztBQUN4QixnQkFBTSxpQkFBaUIsVUFBVSxVQUFVO0FBQUEsWUFDdkMsS0FBSyxTQUFTLE1BQU0sS0FBSyxhQUFhLEtBQUssUUFBUSxXQUFXO0FBQUEsWUFDOUQsTUFBTSxHQUFHLElBQUksS0FBSyxRQUFRLE9BQU8sS0FBSyxJQUFLLEtBQUksS0FBSyxLQUFLLE9BQU8sS0FBSztBQUFBLFVBQ3pFLENBQUM7QUFDRCx5QkFBZSxVQUFVLE1BQU07QUFDM0IsaUJBQUssYUFBYSxJQUFJLEtBQUs7QUFDM0IsaUJBQUssT0FBTztBQUFBLFVBQ2hCO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBUSx1QkFBdUIsV0FBaUM7QUFDNUQsU0FBSyx5QkFBeUIsU0FBUztBQUFBLEVBQzNDO0FBQUEsRUFFQSxBQUFRLGtCQUFrQixXQUFpQztBQUN2RCxjQUFVLGdCQUFnQjtBQUMxQixjQUFVLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixLQUFLLFFBQVEsQ0FBQztBQUNoRSxVQUFNLGFBQWEsSUFBSSxnQ0FBYyxTQUFTO0FBQzlDLGVBQVcsU0FBUyxHQUFHLEtBQUssT0FBTztBQUNuQyxlQUFXLFNBQVMsQ0FBQyxVQUFVO0FBQzNCLFdBQUssUUFBUSxTQUFTLEtBQUssS0FBSyxLQUFLO0FBQ3JDLFdBQUssY0FBYyxPQUFPO0FBQUEsSUFDOUIsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQVEsZUFBZSxNQUFjLFdBQWlDO0FBQ2xFLFVBQU0sVUFBVSxHQUFHLFNBQVM7QUFDNUIsVUFBTSxrQkFBa0IsR0FBRyxTQUFTLGtCQUFrQjtBQUN0RCxVQUFNLEVBQUUsS0FBSyxXQUFXLEtBQUssUUFBUTtBQUNyQyxVQUFNLEVBQUUsS0FBSyxXQUFXLEtBQUssUUFBUTtBQUNyQyxRQUFJLFFBQVE7QUFDUixVQUFJLFNBQVMsWUFBWSxRQUFRO0FBQ2pDLFdBQUssUUFBUSxTQUFTLFNBQVM7QUFBQSxJQUNuQyxPQUFPO0FBQ0gsVUFBSSxTQUFTLFFBQVE7QUFDckIsYUFBTyxTQUFTLFlBQVksUUFBUTtBQUNwQyxXQUFLLFFBQVEsU0FBUyxTQUFTO0FBQy9CLFdBQUssUUFBUSxpQkFBaUIsU0FBUztBQUFBLElBQzNDO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBUSxhQUFhLE1BQWMsV0FBMkIsV0FBaUM7QUFDM0YsVUFBTSxNQUFNLElBQUksa0NBQWdCLFNBQVM7QUFDekMsUUFBSSxRQUFRLGNBQWMsUUFBUSxlQUFlLGNBQWM7QUFDL0QsU0FBSyxRQUFRLEdBQUcsU0FBUyxlQUFlLEVBQUUsS0FBVSxRQUFRLE9BQU8sTUFBWSxVQUFxQjtBQUNwRyxRQUFJLFFBQVEsTUFBTTtBQUNkLFdBQUssZUFBZSxNQUFNLFNBQVM7QUFDbkMsV0FBSyxPQUFPO0FBQUEsSUFDaEIsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQVEsK0JBQStCLE1BQWMsT0FBZSxXQUFpQztBQUNqRyxVQUFNLDRCQUE0QixVQUFVLFVBQVUsRUFBRSxLQUFLLGVBQWUsQ0FBQztBQUM3RSxTQUFLLGFBQWEsTUFBTSxPQUFPLHlCQUF5QjtBQUN4RCxTQUFLLGFBQWEsTUFBTSxRQUFRLHlCQUF5QjtBQUN6RCw4QkFBMEIsVUFBVSxFQUFFLE1BQU0sT0FBTyxLQUFLLGFBQWEsQ0FBQztBQUFBLEVBQzFFO0FBQUEsRUFFQSxBQUFRLHFCQUFxQixNQUFjLFdBQWlDO0FBQ3hFLFVBQU0sdUJBQXVCLFVBQVUsVUFBVSxFQUFFLEtBQUssZUFBZSxDQUFDO0FBQ3hFLFVBQU0sU0FBUyxJQUFJLGdDQUFjLG9CQUFvQjtBQUNyRCxXQUFPLFNBQVMsRUFBRTtBQUNsQixXQUFPLFNBQVMsTUFBTSxLQUFLLGNBQWMsT0FBTyxDQUFDO0FBQ2pELFNBQUssUUFBUSxRQUFRO0FBQUEsRUFDekI7QUFBQSxFQUVBLEFBQVEsMkJBQTJCLFdBQWlDO0FBQ2hFLFVBQU0saUJBQWlCLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDckUsU0FBSywrQkFBK0IsUUFBUSxhQUFhLGNBQWM7QUFDdkUsU0FBSyxxQkFBcUIsUUFBUSxjQUFjO0FBQ2hELFVBQU0sU0FBUyxLQUFLLE9BQU8sV0FBVyxrQkFBa0IsSUFBSSxLQUFLLFVBQVUsSUFBSSxLQUFLLENBQUM7QUFDckYsV0FBTyxRQUFRLFdBQVM7QUFDcEIsWUFBTSxrQkFBaUIsVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNyRSxXQUFLLCtCQUErQixNQUFNLE1BQU0sTUFBTSxNQUFNLGVBQWM7QUFDMUUsV0FBSyxxQkFBcUIsTUFBTSxNQUFNLGVBQWM7QUFBQSxJQUN4RCxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxvQkFBb0IsV0FBaUM7QUFDekQsVUFBTSxlQUFlLFVBQVUsVUFBVSxFQUFFLEtBQUssT0FBTyxDQUFDO0FBQ3hELFNBQUssZ0JBQWdCLElBQUksa0NBQWdCLFlBQVk7QUFDckQsU0FBSyxjQUFjLFFBQVEsYUFBYTtBQUN4QyxTQUFLLGNBQWMsUUFBUSxNQUFNO0FBQzdCLFdBQUssT0FBTztBQUFBLElBQ2hCLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLGtCQUFrQixXQUFpQztBQUN2RCxVQUFNLGVBQWUsVUFBVSxVQUFVLEVBQUUsS0FBSyxPQUFPLENBQUM7QUFDeEQsVUFBTSxpQkFBaUIsSUFBSSxrQ0FBZ0IsWUFBWTtBQUN2RCxtQkFBZSxRQUFRLFFBQVE7QUFDL0IsbUJBQWUsUUFBUSxNQUFNO0FBQ3pCLGFBQU8sT0FBTyxLQUFLLE9BQU8sRUFBRSxRQUFRLFlBQVUsT0FBTyxTQUFTLEVBQUUsQ0FBQztBQUNqRSxXQUFLLGNBQWMsT0FBTztBQUFBLElBQzlCLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLG1CQUEyQjtBQUMvQixXQUFPLE9BQU8sUUFBUSxLQUFLLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQyxXQUFXLFdBQVc7QUFDNUQsWUFBTSxRQUFRLGNBQWMsU0FBUyxnQkFBZ0IsTUFBTTtBQUMzRCxVQUFJLE1BQU0sU0FBUyxHQUFHO0FBQ2xCLGVBQU8sb0JBQW9CLFlBQVksNENBQTRDLE1BQU0sU0FBUztBQUFBO0FBQUEsTUFDdEcsT0FBTztBQUNILGVBQU87QUFBQSxNQUNYO0FBQUEsSUFDSixDQUFDLEVBQUUsS0FBSyxFQUFFO0FBQUEsRUFDZDtBQUFBLEVBRUEsQUFBUSxtQkFBMkI7QUFDL0IsV0FBTyxPQUFPLFFBQVEsS0FBSyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUMsYUFBYSxFQUFFLEtBQUssUUFBUSxXQUFXLFlBQVk7QUFDekYsWUFBTSxXQUFXLFNBQVMsU0FBUyxnQkFBZ0IsTUFBTTtBQUN6RCxVQUFJLFFBQVE7QUFDUixlQUFPLGtCQUFrQixjQUFjO0FBQUE7QUFBQSxNQUMzQyxPQUFPO0FBQ0gsZUFBTztBQUFBLE1BQ1g7QUFBQSxJQUNKLENBQUMsRUFBRSxLQUFLLEVBQUU7QUFBQSxFQUNkO0FBQUEsRUFFQSxBQUFRLGlCQUF5QjtBQTlPckM7QUErT1EsVUFBTSx3QkFBa0MsQ0FBQztBQUN6QyxTQUFLLE9BQU8sV0FBVyx3QkFBd0IsUUFBUSxDQUFDLEtBQUssUUFBUTtBQUNqRSxVQUFJLEtBQUssVUFBVSxTQUFTLElBQUksTUFBTTtBQUNsQyw4QkFBc0IsS0FBSyxNQUFNLEdBQUc7QUFBQSxNQUN4QztBQUFBLElBQ0osQ0FBQztBQUVELFFBQUksVUFBVTtBQUNkLFVBQU0saUJBQWlCLEtBQUssT0FBTyxTQUFTO0FBQzVDLFVBQU0saUJBQWlCLEtBQUssT0FBTyxTQUFTO0FBQzVDLFVBQU0sa0JBQWtCLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSwwQkFBaEMsbUJBQXVELFNBQVM7QUFDeEYsZUFBVztBQUFBO0FBQ1gsZUFBVztBQUFBO0FBQUE7QUFBQTtBQUFBLHlCQUVNLHdDQUF3Qyx5QkFBeUIsS0FBSyxVQUFVO0FBQUE7QUFBQSxtQ0FDdEUsMkJBQTJCLDhCQUE4QixLQUFLLFVBQVU7QUFBQTtBQUFBLGdEQUMzRCxLQUFLLFVBQVUscUJBQXFCO0FBQUE7QUFBQTtBQUFBO0FBQUEsVUFFMUUsQ0FBQyxDQUFDLGlCQUFpQix1Q0FBdUMsaUJBQWlCLFNBQVM7QUFBQSxVQUNwRixrQkFBa0IsdUNBQXVDLGtCQUFrQixTQUFTO0FBQUE7QUFBQTtBQUV0RixlQUFXLEtBQUssaUJBQWlCO0FBQ2pDLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFRLHFCQUE2QjtBQUNqQyxVQUFNLFNBQVMsS0FBSyxPQUFPLFdBQVcsa0JBQWtCLElBQUksS0FBSyxVQUFVLElBQUksS0FBSyxDQUFDO0FBQ3JGLFFBQUksT0FBTztBQUVYLFlBQVEsT0FBTyxJQUFJLFdBQVMsSUFBSSxNQUFNLE9BQU8sRUFBRSxLQUFLLEdBQUc7QUFDdkQsWUFBUTtBQUFBO0FBQ1IsWUFBUSxLQUFLLGVBQWU7QUFDNUIsWUFBUSxLQUFLLGlCQUFpQjtBQUM5QixZQUFRLGNBQWMsS0FBSyxlQUFlLEtBQUssYUFBYSxLQUFLO0FBQUE7QUFDakUsWUFBUTtBQUNSLFlBQVEsT0FBTyxJQUFJLFdBQVMscUJBQXFCLE1BQU0sMERBQTBELEVBQUUsS0FBSyxLQUFLO0FBQzdILFlBQVE7QUFDUixZQUFRO0FBQ1IsV0FBTztBQUFBLEVBRVg7QUFDSjs7O0FQaFJPLElBQU0sc0JBQXNCO0FBR25DLElBQU0sYUFBTixNQUFpQjtBQUFBLEVBSWIsWUFDWSxNQUNELElBQ0MsTUFDRCxhQUNDLE1BQ1Y7QUFMVTtBQUNEO0FBQ0M7QUFDRDtBQUNDO0FBRVIsU0FBSyxnQkFBZ0IsS0FBSyxLQUFLLFVBQVUsRUFBRSxLQUFLLGdCQUFnQixNQUFNLEVBQUUsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQ3ZGLFNBQUssY0FBYyxTQUFTLE1BQU0sRUFBRSxNQUFNLEtBQUssS0FBSyxDQUFDO0FBQ3JELFNBQUssY0FBYyxVQUFVLE1BQU07QUFDL0IsV0FBSyxLQUFLLGtCQUFrQixLQUFLLEVBQUU7QUFBQSxJQUN2QztBQUFBLEVBQ0o7QUFBQSxFQUVBLGlCQUF1QjtBQUNuQixTQUFLLGNBQWMsWUFBWSxRQUFRO0FBQ3ZDLFNBQUssWUFBWSxLQUFLO0FBQUEsRUFDMUI7QUFBQSxFQUVBLGVBQXFCO0FBQ2pCLFNBQUssY0FBYyxTQUFTLFFBQVE7QUFDcEMsU0FBSyxZQUFZLEtBQUs7QUFBQSxFQUMxQjtBQUNKO0FBRU8sSUFBTSxnQkFBTixjQUE0QiwyQkFBUztBQUFBLEVBVXhDLFlBQ1csTUFDQyxRQUNBLFdBQ0QsTUFDQSxXQUNUO0FBQ0UsVUFBTSxJQUFJO0FBTkg7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQVpYLFNBQVEsY0FBNEIsQ0FBQztBQUVyQyxTQUFRLFFBQTBCLENBQUM7QUFhL0IsU0FBSyxZQUFZLFNBQVMsZUFBZTtBQUN6QyxTQUFLLFlBQVksU0FBUyxnQkFBZ0I7QUFDMUMsU0FBSyxVQUFVLFNBQVMsd0JBQXdCO0FBQ2hELFNBQUssYUFBYTtBQUNsQixTQUFLLE9BQU87QUFDWixTQUFLLFdBQVcsTUFBTTtBQUVsQixXQUFLLE9BQU8sSUFBSSxhQUFhLGVBQWUsc0JBQXNCLE9BQU8sS0FBSyxVQUFVLElBQUk7QUFDNUYsV0FBSyxPQUFPLFlBQVksS0FBSyxTQUFTO0FBQ3RDLFdBQUssT0FBTztBQUFBLElBQ2hCO0FBQ0EsU0FBSyxZQUFZO0FBQUEsRUFDckI7QUFBQSxFQUVBLGtCQUFrQixJQUFZO0FBQzFCLElBQUMsQ0FBQyxHQUFHLEtBQUssY0FBYyxRQUFRLEVBQXVCLFFBQVEsVUFBUSxLQUFLLEtBQUssQ0FBQztBQUNsRixTQUFLLFlBQVksUUFBUSxZQUFVLE9BQU8sT0FBTyxLQUFLLE9BQU8sYUFBYSxJQUFJLE9BQU8sZUFBZSxDQUFDO0FBQUEsRUFDekc7QUFBQSxFQUVBLGNBQW9CO0FBQ2hCLFNBQUssT0FBTyxLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssVUFBVSxDQUFDO0FBQ3ZELFNBQUssZ0JBQWdCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxpQkFBaUIsQ0FBQztBQUN2RSxTQUFLLGtCQUFrQjtBQUN2QixTQUFLLGdCQUFnQjtBQUNyQixTQUFLLGVBQWU7QUFDcEIsU0FBSyxVQUFVO0FBQ2YsU0FBSyxrQkFBa0IsYUFBYTtBQUFBLEVBQ3hDO0FBQUEsRUFFQSxZQUFrQjtBQUNkLFNBQUssWUFBWSxLQUFLLElBQUksV0FBVyxLQUFLLE1BQU0sZUFBZSxjQUFjLEtBQUssVUFBVSxXQUFXLElBQUksQ0FBQztBQUM1RyxTQUFLLFlBQVksS0FBSyxJQUFJLFdBQVcsS0FBSyxNQUFNLGdCQUFnQixvQkFBb0IsS0FBSyxXQUFXLFdBQVcsSUFBSSxDQUFDO0FBQ3BILFNBQUssWUFBWSxLQUFLLElBQUksV0FBVyxLQUFLLE1BQU0sa0JBQWtCLHNCQUFzQixLQUFLLGFBQWEsV0FBVyxJQUFJLENBQUM7QUFBQSxFQUM5SDtBQUFBLEVBRUEsb0JBQTBCO0FBRXRCLFNBQUssZUFBZSxJQUFJLHNCQUFzQixLQUFLLFFBQVEsS0FBSyxlQUFlLEtBQUssU0FBUztBQUM3RixTQUFLLE1BQU0sS0FBSyxLQUFLLGFBQWEsU0FBUztBQUFBLEVBQy9DO0FBQUEsRUFFQSxrQkFBd0I7QUFDcEIsU0FBSyxhQUFhLElBQUksb0JBQW9CLEtBQUssUUFBUSxLQUFLLGVBQWUsS0FBSyxTQUFTO0FBQ3pGLFNBQUssTUFBTSxLQUFLLEtBQUssV0FBVyxTQUFTO0FBQUEsRUFDN0M7QUFBQSxFQUVBLGlCQUF1QjtBQUNuQixTQUFLLFlBQVksSUFBSSxtQkFBbUIsS0FBSyxRQUFRLEtBQUssV0FBVyxLQUFLLGVBQWUsS0FBSyxTQUFTO0FBQ3ZHLFNBQUssTUFBTSxLQUFLLEtBQUssVUFBVSxTQUFTO0FBQUEsRUFDNUM7QUFBQSxFQUVBLGlCQUF5QjtBQUNyQixXQUFPLEtBQUssUUFBUTtBQUFBLEVBQ3hCO0FBQUEsRUFFQSxjQUFzQjtBQUNsQixXQUFPLEtBQUssWUFBWSxzQkFBc0IsT0FBTyxLQUFLLFVBQVUsT0FBTztBQUFBLEVBQy9FO0FBQUEsRUFFQSxtQkFBeUI7QUFDckIsU0FBSyxVQUFVLGNBQWM7QUFDN0IsU0FBSyxXQUFXLGNBQWM7QUFBQSxFQUNsQztBQUFBLEVBRUEscUJBQTJCO0FBQ3ZCLFNBQUssYUFBYSxjQUFjO0FBQUEsRUFDcEM7QUFBQSxFQUVBLEFBQWdCLFNBQXdCO0FBQUE7QUE5SDVDO0FBK0hRLFdBQUssT0FBTyxZQUFLLGNBQUwsbUJBQWdCLGNBQWE7QUFDekMsV0FBSyxVQUFVLFdBQVc7QUFBQSxJQUM5QjtBQUFBO0FBQ0o7OztBUWpJQSx3QkFBNkI7QUFJdEIsSUFBTSx1QkFBTixjQUFtQywrQkFBcUI7QUFBQSxFQUUzRCxZQUNZLFFBQ0Esa0JBQ0Esb0JBQ1Y7QUFDRSxVQUFNLE9BQU8sR0FBRztBQUpSO0FBQ0E7QUFDQTtBQUdSLFNBQUssWUFBWSxTQUFTLGVBQWU7QUFBQSxFQUM3QztBQUFBLEVBRUEsZUFBZSxPQUF5QjtBQUNwQyxVQUFNLFFBQVEsS0FBSyxPQUFPO0FBQzFCLFVBQU0sU0FBbUIsQ0FBQyxHQUFHLG9CQUFJLElBQzdCLENBQUMsR0FBRyxNQUFNLGdCQUFnQixLQUFLLEdBQUcsR0FBRyxNQUFNLHdCQUF3QixLQUFLLENBQUMsQ0FDN0UsQ0FBQyxFQUNJLE9BQU8sVUFBUSxLQUFLLFlBQVksRUFBRSxTQUFTLE1BQU0sWUFBWSxDQUFDLENBQUMsRUFDL0QsS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLGNBQWMsQ0FBQyxDQUFDO0FBQ3RDLFFBQUksS0FBSyxtQkFBbUIsUUFBUTtBQUNoQyxhQUFPLE9BQU8sT0FBTyxXQUFTLEtBQUssbUJBQW1CLFNBQVMsS0FBSyxDQUFDO0FBQUEsSUFDekUsT0FBTztBQUNILGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUFBLEVBRUEsaUJBQWlCLE9BQWUsSUFBaUI7QUFDN0MsT0FBRyxRQUFRLEtBQUs7QUFDaEIsT0FBRyxTQUFTLGlCQUFpQjtBQUFBLEVBQ2pDO0FBQUEsRUFFQSxBQUFNLG1CQUFtQixNQUFjLEtBQWlDO0FBQUE7QUFuQzVFO0FBb0NRLFlBQU0sUUFBUSxLQUFLLE9BQU87QUFDMUIsWUFBTSxZQUFZLE1BQU0sZ0JBQWdCLElBQUksSUFBSSxLQUFLLE1BQU0sd0JBQXdCLElBQUksSUFBSTtBQUMzRixZQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxVQUFJLGFBQWEsT0FBTztBQUNwQixhQUFLLGlCQUFpQixPQUFPO0FBQzdCLGFBQUssaUJBQWlCLFlBQVk7QUFDbEMsYUFBSyxpQkFBaUIsb0JBQW9CLHNCQUFzQixPQUFPLFVBQVU7QUFDakYsYUFBSyxpQkFBaUIsa0JBQWtCO0FBQUEsTUFDNUM7QUFDQSxXQUFLLE1BQU07QUFBQSxJQUNmO0FBQUE7QUFDSjs7O0FUekNPLElBQU0sbUJBQU4sY0FBK0IsNEJBQVU7QUFBQSxFQUs1QyxZQUNXLFFBQ0EsV0FDVDtBQUNFLFVBQU07QUFIQztBQUNBO0FBR1AsUUFBSSxDQUFDLEtBQUssV0FBVztBQUNqQixXQUFLLG9CQUFvQjtBQUFBLElBQzdCLE9BQU87QUFDSCxXQUFLLG9CQUFvQixzQkFBc0IsT0FBTyxLQUFLLFVBQVU7QUFBQSxJQUN6RTtBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQU0sU0FBd0I7QUFBQTtBQUUxQixVQUFJLEtBQUssV0FBVztBQUNoQixhQUFLLE9BQU8sS0FBSyxVQUFVO0FBQzNCLGFBQUssb0JBQW9CLHNCQUFzQixPQUFPLEtBQUssVUFBVTtBQUNyRSxjQUFNLEtBQUssa0JBQWtCO0FBQUEsTUFDakMsT0FBTztBQUNILGNBQU0scUJBQXFCLEtBQUssZ0NBQWdDO0FBQ2hFLFlBQUksbUJBQW1CLFdBQVcsR0FBRztBQUNqQyxnQkFBTSxRQUFRLEtBQUssT0FBTztBQUMxQixnQkFBTSxnQkFBZ0IsbUJBQW1CO0FBQ3pDLGdCQUFNLFlBQVksTUFBTSxnQkFBZ0IsSUFBSSxhQUFhLEtBQUssTUFBTSx3QkFBd0IsSUFBSSxhQUFhO0FBQzdHLGNBQUksV0FBVztBQUNYLGlCQUFLLE9BQU8sVUFBVTtBQUN0QixpQkFBSyxZQUFZO0FBQ2pCLGlCQUFLLG9CQUFvQixzQkFBc0IsT0FBTyxVQUFVO0FBQ2hFLGtCQUFNLEtBQUssa0JBQWtCO0FBQUEsVUFDakMsT0FBTztBQUNILGlCQUFLLE9BQU8sWUFBWSxJQUFJO0FBQzVCLGlCQUFLLE9BQU87QUFBQSxVQUNoQjtBQUFBLFFBQ0osT0FBTztBQUNILGdCQUFNLGNBQWMsSUFBSSxxQkFBcUIsS0FBSyxRQUFRLE1BQU0sa0JBQWtCO0FBQ2xGLHNCQUFZLFVBQVUsTUFBTTtBQUN4QixnQkFBSSxDQUFDLEtBQUssV0FBVztBQUNqQixtQkFBSyxPQUFPLFlBQVksSUFBSTtBQUM1QixtQkFBSyxPQUFPO0FBQUEsWUFDaEI7QUFBQSxVQUNKO0FBQ0Esc0JBQVksS0FBSztBQUFBLFFBQ3JCO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFBQTtBQUFBLEVBRUEsV0FBaUI7QUFDYixTQUFLLE9BQU8sSUFBSSxVQUFVLG1CQUFtQixLQUFLLGlCQUFpQjtBQUVuRSxTQUFLLE9BQU8sSUFBSSxhQUFhLGVBQWUsS0FBSyxpQkFBaUI7QUFBQSxFQUN0RTtBQUFBLEVBRUEsQUFBYSxvQkFBbUM7QUFBQTtBQUM1QyxVQUFJLEtBQUssV0FBVztBQUNoQixjQUFNLFlBQVksS0FBSztBQUN2QixhQUFLLE9BQU8sSUFBSSxVQUFVLG1CQUFtQixLQUFLLGlCQUFpQjtBQUVuRSxhQUFLLE9BQU8sYUFBYSxLQUFLLG1CQUMxQixDQUFDLFNBQXdCO0FBQ3JCLGdCQUFNLGdCQUFnQixJQUFJLGNBQWMsTUFBTSxLQUFLLFFBQVEsTUFBTSxLQUFLLE1BQU0sU0FBUztBQUNyRixlQUFLLGdCQUFnQjtBQUNyQixpQkFBTztBQUFBLFFBQ1gsQ0FDSjtBQUdBLGNBQU0sS0FBSyxPQUFPLElBQUksVUFBVSxRQUFRLE9BQU8sVUFBVSxFQUFFLGFBQWE7QUFBQSxVQUNwRSxNQUFNLEtBQUs7QUFBQSxVQUNYLFFBQVE7QUFBQSxRQUNaLENBQUM7QUFDRCxhQUFLLE9BQU8sSUFBSSxVQUFVLFdBQ3RCLEtBQUssT0FBTyxJQUFJLFVBQVUsZ0JBQWdCLEtBQUssaUJBQWlCLEVBQUUsS0FBSyxDQUMzRTtBQUVBLGFBQUssY0FBYyxLQUFLLE9BQU8sSUFBSSxVQUFVLEdBQUcsK0JBQStCLE1BQU07QUFyRmpHO0FBc0ZnQixnQkFBTSxPQUFPLFdBQUssT0FBTyxJQUFJLFVBQVUsZ0JBQWdCLEtBQUssaUJBQWlCLEVBQUUsT0FBbEUsbUJBQXNFO0FBQ25GLGNBQUksTUFBTTtBQUNOLGlCQUFLLGlCQUFpQjtBQUN0QixpQkFBSyxtQkFBbUI7QUFBQSxVQUM1QjtBQUFBLFFBQ0osQ0FBQyxDQUFDO0FBQUEsTUFDTjtBQUFBLElBQ0o7QUFBQTtBQUFBLEVBRUEsQUFBUSxrQ0FBNEM7QUEvRnhEO0FBZ0dRLFVBQU0sUUFBUSxLQUFLLE9BQU87QUFDMUIsVUFBTSxpQkFBaUIsV0FBSyxPQUFPLElBQUksVUFBVSxjQUFjLE1BQXhDLG1CQUEyQztBQUNsRSxVQUFNLHFCQUFxQixDQUFDO0FBQzVCLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFFBQUksa0JBQWtCLGVBQWUsU0FBUyxLQUFLLEtBQUssT0FBTztBQUMzRCx5QkFBbUIsS0FBSyxHQUFJLGFBQU0sS0FBSyxjQUFjLEVBQUUsVUFBM0IsbUJBQWtDLE9BQU8sQ0FBQyxRQUFnQixDQUFDLEdBQUcsTUFBTSx3QkFBd0IsS0FBSyxDQUFDLEVBQUUsU0FBUyxHQUFHLE9BQU0sQ0FBQyxDQUFFO0FBQ3JKLHlCQUFtQixLQUFLLEdBQUksTUFBTSxzQkFBc0IsSUFBSSxjQUFjLEtBQUssQ0FBQyxDQUFFO0FBQUEsSUFDdEY7QUFDQSxXQUFPLENBQUMsR0FBRyxJQUFJLElBQUksa0JBQWtCLENBQUM7QUFBQSxFQUMxQztBQUNKOzs7QWxIN0ZPLElBQU0sZUFBTixNQUFtQjtBQUFBLEVBRXRCLFlBQW1CLFdBQTJCO0FBQTNCO0FBQUEsRUFBNkI7QUFBQSxFQUVoRCxBQUFPLFVBQVUsTUFBYyxTQUEwQixTQUFrQixXQUFvQjtBQUMzRixVQUFNLHVCQUF1QixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDeEYsVUFBTSxjQUFjLElBQUksa0NBQWdCLG9CQUFvQjtBQUM1RCxnQkFBWSxRQUFRLElBQUk7QUFDeEIsUUFBSTtBQUFXLGtCQUFZLFNBQVMsU0FBUyxTQUFTO0FBQ3RELGdCQUFZLFFBQVEsTUFBTSxRQUFRLENBQUM7QUFDbkMsUUFBSTtBQUFTLGtCQUFZLFdBQVcsT0FBTztBQUFBLEVBQy9DO0FBQ0o7QUFFTyxJQUFNLGNBQU4sY0FBMEIsd0JBQU07QUFBQSxFQVFuQyxZQUNXLFFBQ0MsTUFDVjtBQXRDTjtBQXVDUSxVQUFNLE9BQU8sR0FBRztBQUhUO0FBQ0M7QUFOWixTQUFPLGtCQUFvQyxDQUFDO0FBRTVDLFNBQVEsZ0JBQXlCO0FBTzdCLFNBQUssUUFBUSxhQUFPLElBQUksUUFBUSxRQUFRLGFBQTNCLG1CQUFxQztBQUNsRCxTQUFLLFVBQVU7QUFDZixTQUFLLFlBQVksU0FBUyxlQUFlO0FBQ3pDLFNBQUssWUFBWSxTQUFTLG1CQUFtQjtBQUFBLEVBQ2pEO0FBQUEsRUFHQSxTQUFTO0FBQ0wsU0FBSyxRQUFRLFFBQVEsYUFBYSxLQUFLLEtBQUssWUFBWSxLQUFLLEtBQUssV0FBVztBQUM3RSxTQUFLLHFCQUFxQjtBQUFBLEVBQzlCO0FBQUEsRUFHQSxZQUFrQjtBQUNkLFNBQUssU0FBUyxLQUFLLE9BQU8sV0FBVyxZQUFZLElBQUksS0FBSyxLQUFLLElBQUksS0FBSyxDQUFDO0FBQUEsRUFDN0U7QUFBQSxFQUdBLG9CQUFvQixXQUEyQixPQUFjLE9BQXlDO0FBQ2xHLFVBQU0sZUFBZSxJQUFJLGFBQUcsTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLO0FBQzFELFVBQU0sbUJBQW1CLFVBQVUsVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDMUUsVUFBTSxxQkFBcUIsaUJBQWlCLFVBQVUsRUFBRSxNQUFNLEdBQUcsTUFBTSxRQUFRLEtBQUssd0JBQXdCLENBQUM7QUFDN0csVUFBTSx1QkFBdUIsVUFBVSxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUNsRix5QkFBcUIsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDL0QsVUFBTSxZQUFZLE1BQU0sZ0JBQWdCLEtBQUssT0FBTyxXQUFXLGdCQUFnQixJQUFJLE1BQU0sYUFBYSxJQUFJO0FBQzFHLFFBQUksV0FBVztBQUNYLHlCQUFtQixTQUFTLG1CQUFtQixVQUFVLEtBQUssUUFBUSxLQUFLLEtBQUssRUFBRSxRQUFRLEtBQUssR0FBRyxHQUFHO0FBQUEsSUFDekc7QUFDQSxVQUFNLHdCQUF3QixxQkFBcUIsVUFBVSxFQUFFLEtBQUssMkJBQTJCLENBQUM7QUFDaEcsVUFBTSxrQkFBa0IsSUFBSSxrQ0FBZ0IscUJBQXFCO0FBQ2pFLG9CQUFnQixRQUFRLE1BQU07QUFDOUIsb0JBQWdCLFdBQVcsR0FBRyxNQUFNLGdCQUFnQixNQUFNLGdCQUFnQixRQUFRLHFCQUFxQixNQUFNLGVBQWU7QUFDNUgsb0JBQWdCLFFBQVEsTUFBTTtBQUMxQixZQUFNLGFBQWEsTUFBTSxnQkFBZ0IsS0FBSyxPQUFPLFdBQVcsZ0JBQWdCLElBQUksTUFBTSxhQUFhLElBQUk7QUFDM0csWUFBTSxxQkFBcUIseUNBQVksV0FBVyxLQUFLLFVBQVEsS0FBSyxTQUFTLE1BQU07QUFDbkYsVUFBSSxzQkFBc0IsWUFBWTtBQUNsQyxjQUFNLDBCQUEwQixJQUFJLHdCQUF3QixLQUFLLFFBQVEsWUFBWSxrQkFBa0I7QUFDdkcsZ0NBQXdCLEtBQUs7QUFBQSxNQUNqQztBQUFBLElBQ0osQ0FBQztBQUNELFVBQU0scUJBQXFCLHFCQUFxQixVQUFVLEVBQUUsS0FBSyxhQUFhLENBQUM7QUFDL0UsdUJBQW1CLFVBQVUsRUFBRSxNQUFNLE1BQU0sTUFBTSxLQUFLLG1CQUFtQixBQUFVLDBCQUEwQixNQUFNLFFBQVEsQ0FBQztBQUM1SCxVQUFNLG9CQUFvQixVQUFVLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQzVFLFVBQU0sc0JBQXNCLGtCQUFrQixVQUFVO0FBQUEsTUFDcEQsS0FBSyxVQUFVLFVBQWEsVUFBVSxPQUFPLDJCQUEyQjtBQUFBLElBQzVFLENBQUM7QUFDRCxRQUFJLFVBQVUsTUFBTTtBQUNoQiwwQkFBb0IsUUFBUSxNQUFNLFNBQVMsd0JBQTZCLGVBQWUsU0FBUztBQUFBLElBQ3BHLFdBQVcsVUFBVSxRQUFXO0FBQzVCLFdBQUssZ0JBQWdCO0FBQ3JCLDBCQUFvQixRQUFRLFdBQVc7QUFBQSxJQUMzQyxPQUFPO0FBQ0gsbUJBQWEsYUFBYSxxQkFBcUIsS0FBSyxNQUFNLE1BQU0sTUFBTSxNQUFNO0FBQUUsYUFBSyxNQUFNO0FBQUEsTUFBRSxDQUFDO0FBQUEsSUFDaEc7QUFDQSxVQUFNLHNCQUFzQixVQUFVLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ2hGLHdCQUFvQixVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUM3RCxVQUFNLGVBQWUsSUFBSSxhQUFhLG1CQUFtQjtBQUN6RCxRQUFJLFVBQVUsUUFBVztBQUNyQixtQkFBYSxlQUFlLE1BQU0sTUFBTSxPQUFPLEtBQUssTUFBTSxZQUFZO0FBQUEsSUFDMUUsT0FBTztBQUNILFlBQU0sb0JBQW9CLG9CQUFvQixVQUFVLEVBQUUsS0FBSywwQkFBMEIsQ0FBQztBQUMxRixZQUFNLFdBQVcsSUFBSSxrQ0FBZ0IsaUJBQWlCO0FBQ3RELGVBQVMsUUFBUSxXQUFXO0FBQzVCLGVBQVMsV0FBVyxzQkFBc0I7QUFDMUMsZUFBUyxRQUFRLE1BQU07QUFDbkIsWUFBSSxtQkFDQSxLQUFLLFFBQ0wsS0FBSyxNQUNMLENBQ0ksWUFDQSxPQUNBLFFBQ0EsY0FDQyxjQUFhLGVBQ2QsS0FBSyxRQUNMLEtBQUssTUFDTCxNQUFNLE1BQ04sSUFDQSxZQUNBLE9BQ0EsUUFDQSxTQUNKLENBQ0osRUFBRSxLQUFLO0FBQUEsTUFDWCxDQUFDO0FBQUEsSUFDTDtBQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEseUNBQXlDLFdBQTRCO0FBaEl6RTtBQWlJUSxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxRQUFJLE9BQU87QUFDUCxZQUFNLFNBQVMsTUFBTSxLQUFLLEtBQUssS0FBSyxJQUFJO0FBQ3hDLFVBQUksUUFBUTtBQUNSLGNBQU0sUUFBUSxJQUFJLG1CQUNkLEtBQUssUUFDTCxLQUFLLE1BQ0wsQ0FDSSxZQUNBLE9BQ0EsUUFDQSxjQUNDLG9CQUNELEtBQUssUUFDTCxPQUFPLEtBQUssTUFDWixZQUNBLE9BQ0EsUUFDQSxXQUNBLFVBQVUsSUFDZCxDQUNKO0FBQ0EsY0FBTSxLQUFLO0FBQUEsTUFDZjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUEsRUFFQSwwQkFBMEIsV0FBK0I7QUE1SjdEO0FBNkpRLFVBQU0scUJBQStCLENBQUM7QUFDdEMsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsUUFBSSxPQUFPO0FBQ1AsWUFBTSxTQUFTLE1BQU0sS0FBSyxLQUFLLEtBQUssSUFBSTtBQUN4QyxVQUFJLFFBQVE7QUFDUiwyQkFBbUIsS0FBSyxHQUFHLFlBQVksTUFBTSxDQUFDO0FBQUEsTUFDbEQ7QUFBQSxJQUNKO0FBQUM7QUFFRCxVQUFNLGdCQUFnQixhQUFhLEtBQUssT0FDcEMsQ0FBQyxZQUFLLE9BQU8sV0FBVyxrQkFBa0IsSUFBSSxVQUFVLElBQUksTUFBM0QsbUJBQThELElBQUksT0FBSyxFQUFFLE1BQU0sTUFBTSxlQUFhLG1CQUFtQixTQUFTLFNBQVMsTUFDeEk7QUFDSixXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsc0JBQXNCLFdBQWlDO0FBQ25ELFVBQU0sY0FBYyxLQUFLLE9BQU8sV0FBVyxpQkFBaUIsSUFBSSxLQUFLLEtBQUssSUFBSSxLQUFLLENBQUM7QUFDcEYsZ0JBQVksUUFBUSxlQUFhO0FBQzdCLFlBQU0sNEJBQTRCLFVBQVUsVUFBVSxFQUFFLEtBQUssdUNBQXVDLENBQUM7QUFDckcsWUFBTSxhQUFhLEtBQUssT0FBTyxXQUFXLHFCQUFxQixJQUFJLFVBQVUsSUFBSSxLQUFLLENBQUM7QUFDdkYsWUFBTSxZQUFZLENBQUMsR0FBRyxVQUFVLEVBQUUsUUFBUTtBQUMxQyxnQkFBVSxLQUFLLFVBQVUsSUFBSTtBQUM3QixnQkFBVSxRQUFRLENBQUMsZUFBZSxNQUFNO0FBQ3BDLGNBQU0sYUFBYSxLQUFLLE9BQU8sV0FBVyxnQkFBZ0IsSUFBSSxhQUFhO0FBQzNFLFlBQUksWUFBWTtBQUNaLGdCQUFNLDRCQUE0QiwwQkFBMEIsVUFBVSxFQUFFLEtBQUssOEJBQThCLENBQUM7QUFDNUcsZ0JBQU0seUJBQXlCLDBCQUEwQixVQUFVLEVBQUUsS0FBSyxRQUFRLE1BQU0sV0FBVyxLQUFLLENBQUM7QUFDekcsaUNBQXVCLFFBQVEsTUFBTSxjQUFjLFdBQVcsS0FBSyxRQUFRLEtBQUssS0FBSyxFQUFFLFFBQVEsS0FBSyxHQUFHLEdBQUc7QUFFMUcsY0FBSSxLQUFLLDBCQUEwQixVQUFVLEdBQUc7QUFDNUMsa0JBQU0sa0NBQWtDLElBQUksa0NBQWdCLHlCQUF5QjtBQUNyRiw0Q0FBZ0MsUUFBUSxjQUFjO0FBQ3RELDRDQUFnQyxXQUFXLDZCQUE2QixXQUFXLE1BQU07QUFDekYsNENBQWdDLFFBQVEsTUFBTTtBQUMxQyxtQkFBSyx5Q0FBeUMsVUFBVTtBQUFBLFlBQzVELENBQUM7QUFBQSxVQUNMO0FBRUEsZ0JBQU0sMkJBQTJCLElBQUksa0NBQWdCLHlCQUF5QjtBQUM5RSxtQ0FBeUIsUUFBUSxhQUFhO0FBQzlDLG1DQUF5QixXQUFXLDJCQUEyQixXQUFXLE1BQU07QUFDaEYsbUNBQXlCLFFBQVEsTUFBTTtBQUNuQyxrQkFBTSwwQkFBMEIsSUFBSSx3QkFBd0IsS0FBSyxRQUFRLFVBQVU7QUFDbkYsb0NBQXdCLEtBQUs7QUFBQSxVQUNqQyxDQUFDO0FBQ0QsY0FBSSxJQUFJLFVBQVUsU0FBUyxHQUFHO0FBQzFCLHNDQUEwQixVQUFVLEVBQUUsTUFBTSxLQUFLLEtBQUssWUFBWSxDQUFDO0FBQUEsVUFDdkU7QUFFQSxnQkFBTSw0QkFBNEIsS0FBSyxZQUFZLGlCQUFpQiw0QkFBNEIsY0FBYyxRQUFRLEtBQUssS0FBSyxFQUFFLFFBQVEsS0FBSyxHQUFHLEtBQUs7QUFDdkosb0NBQTBCLFFBQVEsd0JBQXNCO0FBQ3BELFlBQUMsbUJBQXNDLGNBQWMsTUFBTTtBQUN2RCwrRUFBd0IsU0FBUztBQUFBLFlBQ3JDO0FBQ0EsWUFBQyxtQkFBc0MsYUFBYSxNQUFNO0FBQ3RELCtFQUF3QixZQUFZO0FBQUEsWUFDeEM7QUFBQSxVQUNKLENBQUM7QUFDRCxpQ0FBdUIsY0FBYyxNQUFNO0FBQ3ZDLGlCQUFLLFlBQ0EsaUJBQWlCLDBDQUEwQyxjQUFjLFFBQVEsS0FBSyxLQUFLLEVBQUUsUUFBUSxLQUFLLEdBQUcsR0FBRyxFQUNoSCxRQUFRLFVBQVE7QUFBRSxtQkFBSyxTQUFTLFFBQVE7QUFBQSxZQUFFLENBQUM7QUFBQSxVQUNwRDtBQUNBLGlDQUF1QixhQUFhLE1BQU07QUFDdEMsaUJBQUssWUFDQSxpQkFBaUIsMENBQTBDLGNBQWMsUUFBUSxLQUFLLEtBQUssRUFBRSxRQUFRLEtBQUssR0FBRyxHQUFHLEVBQ2hILFFBQVEsVUFBUTtBQUFFLG1CQUFLLFlBQVksUUFBUTtBQUFBLFlBQUUsQ0FBQztBQUFBLFVBQ3ZEO0FBQ0EsaUNBQXVCLFVBQVUsTUFBTTtBQUNuQyxrQkFBTSxxQkFBcUIsSUFBSSxpQkFBaUIsS0FBSyxRQUFRLFVBQVU7QUFDdkUsaUJBQUssT0FBTyxTQUFTLGtCQUFrQjtBQUN2QyxpQkFBSyxNQUFNO0FBQUEsVUFDZjtBQUFBLFFBQ0o7QUFBQSxNQUNKLENBQUM7QUFBQSxJQUNMLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSx1QkFBNkI7QUFDekIsU0FBSyxnQkFBZ0I7QUFDckIsU0FBSyxVQUFVLGdCQUFnQjtBQUMvQixTQUFLLFVBQVUsU0FBUyxJQUFJO0FBQzVCLFVBQU0sa0JBQWtCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNqRixTQUFLLE9BQU8sUUFBUSxXQUFTO0FBQ3pCLFlBQU0sUUFBUSxLQUFLLFFBQVEsS0FBSyxNQUFNLEtBQUssS0FBSyxLQUFLLElBQUksRUFBRSxNQUFNLFFBQVE7QUFDekUsV0FBSyxvQkFBb0IsaUJBQWlCLE9BQU8sS0FBSztBQUFBLElBQzFELENBQUM7QUFDRCxRQUFJLEtBQUssZUFBZTtBQUNwQixZQUFNLCtCQUErQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDMUYsbUNBQTZCLFVBQVUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3hFLFlBQU0seUJBQXlCLElBQUksa0NBQWdCLDRCQUE0QjtBQUMvRSw2QkFBdUIsUUFBUSxjQUFjO0FBQzdDLDZCQUF1QixRQUFRLE1BQU07QUF6UGpEO0FBMFBnQixjQUFNLFNBQVMsV0FBSyxVQUFMLG1CQUFZLEtBQUssS0FBSyxLQUFLO0FBQzFDLFlBQUksUUFBUTtBQUNSLGNBQUksbUJBQ0EsS0FBSyxRQUNMLEtBQUssTUFDTCxDQUNJLFlBQ0EsT0FDQSxRQUNBLGNBQ0Msb0JBQ0QsS0FBSyxRQUNMLE9BQU8sS0FBSyxNQUNaLFlBQ0EsT0FDQSxRQUNBLFNBQ0osQ0FDSixFQUFFLEtBQUs7QUFBQSxRQUNYO0FBQUEsTUFDSixDQUFDO0FBQUEsSUFDTDtBQUNBLFNBQUssVUFBVSxTQUFTLElBQUk7QUFDNUIsVUFBTSw2QkFBNkIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQ3ZGLFNBQUssc0JBQXNCLDBCQUEwQjtBQUFBLEVBQ3pEO0FBQ0o7QUFFQSxJQUFxQixzQkFBckIsY0FBaUQsNEJBQVU7QUFBQSxFQUl2RCxZQUNXLFFBQ0EsY0FDQSxVQUNBLE1BQ1Q7QUFDRSxVQUFNO0FBTEM7QUFDQTtBQUNBO0FBQ0E7QUFHUCxTQUFLLGNBQWMsSUFBSSxZQUFZLEtBQUssUUFBUSxJQUFJO0FBQ3BELFNBQUssWUFBWSxVQUFVLE1BQU07QUFDN0IsV0FBSyxPQUFPLFlBQVksSUFBSTtBQUM1QixXQUFLLE9BQU87QUFBQSxJQUNoQjtBQUFBLEVBQ0o7QUFBQSxFQUVBLFNBQWU7QUFDWCxTQUFLLE9BQU8sY0FBYyxLQUFLLE9BQU8sSUFBSSxjQUFjLEdBQUcsNEJBQTRCLE1BQU07QUFDekYsV0FBSyxZQUFZLFVBQVU7QUFDM0IsV0FBSyxZQUFZLHFCQUFxQjtBQUFBLElBQzFDLENBQUMsQ0FBQztBQUNGLFNBQUssWUFBWSxLQUFLO0FBQUEsRUFDMUI7QUFDSjs7O0E0SC9TQSx3QkFBNEQ7QUFTNUQsSUFBcUIsMkJBQXJCLGNBQXNELG9DQUEwQjtBQUFBLEVBRzVFLFlBQVksTUFBVTtBQUNsQixVQUFNLElBQUc7QUFIYixTQUFPLFVBQW9CLENBQUM7QUFJeEIsU0FBSyxZQUFZLFNBQVMsZUFBZTtBQUFBLEVBQzdDO0FBQUEsRUFFQSxXQUFxQjtBQUNqQixXQUFPLEtBQUs7QUFBQSxFQUNoQjtBQUFBLEVBRUEsWUFBWSxNQUFzQjtBQUM5QixXQUFPLEtBQUs7QUFBQSxFQUNoQjtBQUFBLEVBRUEsYUFBYSxNQUFjLEtBQXVDO0FBQzlELFNBQUssT0FBTztBQUFBLEVBQ2hCO0FBQUEsRUFFQSxpQkFBaUIsTUFBMEIsSUFBdUI7QUFDOUQsT0FBRyxTQUFTLGlCQUFpQjtBQUM3QixVQUFNLGdCQUFnQixHQUFHLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQzVELFNBQUssS0FBSyxPQUFPLCtCQUFRLGVBQWUsS0FBSyxLQUFLLElBQUksSUFBSSwrQkFBUSxlQUFlLFFBQVE7QUFDekYsVUFBTSxjQUFjLEdBQUcsVUFBVTtBQUNqQyxnQkFBWSxZQUFZLEtBQUssS0FBSztBQUFBLEVBQ3RDO0FBQ0o7OztBQ25DQSx3QkFBb0M7QUFXcEMsZ0JBQWdCLFVBQW9GO0FBQ2hHLFNBQVEsU0FBa0IsWUFBWTtBQUMxQztBQUVBLDhCQUE4QixVQUFvRztBQUM5SCxTQUFRLGFBQXdCO0FBQ3BDO0FBRUEsbUJBQW1CLFVBQXdHO0FBQ3ZILFNBQVEsU0FBc0MsYUFBYTtBQUMvRDtBQUVBLElBQXFCLHVCQUFyQixNQUEwQztBQUFBLEVBS3RDLFlBQ1ksUUFDQSxNQUNBLFVBQ0EsVUFDVjtBQUpVO0FBQ0E7QUFDQTtBQUNBO0FBRVIsU0FBSyxZQUFZLEtBQUssT0FBTyxXQUFXLGdCQUFnQixJQUFJLEtBQUssS0FBSyxJQUFJO0FBQUEsRUFDOUU7QUFBQSxFQUVBLEFBQU8sc0JBQXNCLGtCQUEyQixNQUFZO0FBdEN4RTtBQXVDUSxVQUFNLG1CQUFtQixNQUFZO0FBQ2pDLFlBQU0sV0FBVyxLQUFLLFFBQVEsQ0FBQyxFQUFFLE1BQU0sY0FBYyxTQUFTLEVBQUUsT0FBTyxPQUFPLEVBQUUsQ0FBQyxHQUFHLEtBQUssSUFBSTtBQUFBLElBQ2pHO0FBQ0EsVUFBTSwrQkFBK0IsTUFBTTtBQUN2QyxZQUFNLHFCQUFxQixJQUFJLGlCQUFpQixLQUFLLFFBQVEsU0FBUztBQUN0RSxXQUFLLE9BQU8sU0FBUyxrQkFBa0I7QUFBQSxJQUMzQztBQUNBLFFBQUksT0FBTyxLQUFLLFFBQVEsR0FBRztBQUFFLFdBQUssU0FBUyxhQUFhO0FBQUEsSUFBRztBQUFDO0FBQzVELFVBQU0sWUFBWSxLQUFLO0FBQ3ZCLFVBQU0scUJBQStCLENBQUM7QUFDdEMsUUFBSSx5QkFBeUIsTUFBTTtBQUFFLFVBQUkseUJBQU8sK0RBQStEO0FBQUEsSUFBRTtBQUNqSCxRQUFJLEtBQUssVUFBVTtBQUNmLFlBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFVBQUksT0FBTztBQUNQLGNBQU0sU0FBUyxNQUFNLEtBQUssS0FBSyxTQUFTLElBQUk7QUFDNUMsWUFBSSxRQUFRO0FBQ1IsNkJBQW1CLEtBQUssR0FBRyxZQUFZLE1BQU0sQ0FBQztBQUM5QyxnQkFBTSxRQUFRLElBQUksbUJBQ2QsS0FBSyxRQUNMLEtBQUssVUFDTCxDQUNJLFlBQ0EsT0FDQSxRQUNBLGNBQ0Msb0JBQ0QsS0FBSyxRQUNMLE9BQU8sS0FBSyxNQUNaLFlBQ0EsT0FDQSxRQUNBLFdBQ0EsdUNBQVcsSUFDZixDQUNKO0FBQ0EsbUNBQXlCLE1BQU07QUFDM0Isa0JBQU0sS0FBSztBQUFBLFVBQ2Y7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUFDO0FBQUEsSUFDTDtBQUVBLFVBQU0sZ0JBQWdCLGFBQWEsS0FBSyxXQUNwQyxDQUFDLFlBQUssT0FBTyxXQUFXLGtCQUFrQixJQUFJLFVBQVUsSUFBSSxNQUEzRCxtQkFBOEQsSUFBSSxPQUFLLEVBQUUsTUFBTSxNQUFNLGVBQWEsbUJBQW1CLFNBQVMsU0FBUyxNQUN4STtBQUNKLFFBQUkscUJBQXFCLEtBQUssUUFBUSxLQUFLLFdBQVc7QUFDbEQsWUFBTSxRQUFRLElBQUksd0JBQXdCLEtBQUssUUFBUSxTQUFTO0FBQ2hFLFlBQU0sS0FBSztBQUFBLElBQ2YsV0FBVyxVQUFVLEtBQUssUUFBUSxHQUFHO0FBQ2pDLFVBQUksV0FBVztBQUNYLGFBQUssU0FBUyxRQUFRLEtBQUs7QUFBQSxVQUN2QixJQUFJLDBCQUEwQixVQUFVLEtBQUssUUFBUSxLQUFLLEdBQUc7QUFBQSxVQUM3RCxhQUFhLFdBQVcsVUFBVTtBQUFBLFVBQ2xDLFFBQVE7QUFBQSxVQUNSLE1BQU07QUFBQSxRQUNWLENBQUM7QUFBQSxNQUNMO0FBQ0EsVUFBSSxhQUFhLENBQUMsVUFBVSxnQkFBZ0IsR0FBRztBQUMzQyxhQUFLLFNBQVMsUUFBUSxLQUFLO0FBQUEsVUFDdkIsSUFBSTtBQUFBLFVBQ0osYUFBYSxnQkFBZ0IsVUFBVTtBQUFBLFVBQ3ZDLFFBQVE7QUFBQSxVQUNSLE1BQU07QUFBQSxRQUNWLENBQUM7QUFBQSxNQUNMO0FBQ0EsVUFBSSxhQUFhLGlCQUFpQixLQUFLLFVBQVU7QUFDN0MsYUFBSyxTQUFTLFFBQVEsS0FBSztBQUFBLFVBQ3ZCLElBQUksNkJBQTZCLFVBQVUsS0FBSyxRQUFRLEtBQUssR0FBRztBQUFBLFVBQ2hFLGFBQWEsdUNBQXVDLFVBQVU7QUFBQSxVQUM5RCxRQUFRO0FBQUEsVUFDUixNQUFNO0FBQUEsUUFDVixDQUFDO0FBQUEsTUFDTDtBQUNBLFdBQUssa0JBQWtCO0FBR3ZCLFVBQUk7QUFBaUIsYUFBSyxTQUFTLEtBQUs7QUFBQSxJQUM1QyxXQUFXLE9BQU8sS0FBSyxRQUFRLEdBQUc7QUFDOUIsVUFBSSxXQUFXO0FBQ1gsYUFBSyxTQUFTLFFBQVEsQ0FBQyxTQUFTO0FBQzVCLGVBQUssU0FBUyxXQUFXLFVBQVUsaUJBQWlCO0FBQ3BELGVBQUssUUFBUSw0QkFBNEI7QUFDekMsZUFBSyxRQUFRLGtCQUFrQjtBQUMvQixlQUFLLFdBQVcsMkJBQTJCLFVBQVUsdUJBQXVCO0FBQUEsUUFDaEYsQ0FBQztBQUFBLE1BQ0w7QUFDQSxVQUFJLGFBQWEsQ0FBQyxVQUFVLGdCQUFnQixHQUFHO0FBQzNDLGFBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUM1QixlQUFLLFNBQVMsT0FBTyxVQUFVLGVBQWU7QUFDOUMsZUFBSyxRQUFRLE1BQU07QUFDbkIsZUFBSyxRQUFRLGdCQUFnQjtBQUM3QixlQUFLLFdBQVcsMkJBQTJCLFVBQVUsdUJBQXVCO0FBQUEsUUFDaEYsQ0FBQztBQUFBLE1BQ0w7QUFDQSxVQUFJLGFBQWEsaUJBQWlCLEtBQUssVUFBVTtBQUM3QyxhQUFLLFNBQVMsUUFBUSxDQUFDLFNBQVM7QUFDNUIsZUFBSyxTQUFTLDhCQUE4QixVQUFVLE1BQU07QUFDNUQsZUFBSyxRQUFRLGNBQWM7QUFDM0IsZUFBSyxRQUFRLHNCQUFzQjtBQUNuQyxlQUFLLFdBQVcsMkJBQTJCLFVBQVUsdUJBQXVCO0FBQUEsUUFDaEYsQ0FBQztBQUFBLE1BQ0w7QUFDQSxXQUFLLGtCQUFrQjtBQUFBLElBQzNCLE9BQU87QUFDSCxXQUFLO0FBQUEsSUFDVDtBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQVEsb0JBQTBCO0FBbkp0QztBQW9KUSxlQUFLLGNBQUwsbUJBQWdCLFdBQVcsUUFBUSxDQUFDLFNBQTZCO0FBQzdELFlBQU0sU0FBUSxJQUFJLHdCQUF3QixLQUFLLFFBQVEsS0FBSyxXQUFZLElBQUk7QUFDNUUsVUFBSSxPQUFPLEtBQUssUUFBUSxHQUFHO0FBQ3ZCLGFBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUM1QixlQUFLLFNBQVMsR0FBRyxLQUFLLFVBQVcsVUFBVSxLQUFLLE1BQU07QUFDdEQsZUFBSyxRQUFRLFFBQVE7QUFDckIsZUFBSyxRQUFRLE1BQU07QUFDZixtQkFBTSxLQUFLO0FBQUEsVUFDZixDQUFDO0FBQ0QsZUFBSyxXQUFXLDJCQUEyQixLQUFLLFVBQVcsdUJBQXVCO0FBQUEsUUFDdEYsQ0FBQztBQUFBLE1BQ0wsV0FBVyxVQUFVLEtBQUssUUFBUSxHQUFHO0FBQ2pDLGFBQUssU0FBUyxRQUFRLEtBQUs7QUFBQSxVQUN2QixJQUFJLFVBQVUsS0FBSztBQUFBLFVBQ25CLGFBQWEsU0FBUyxLQUFLO0FBQUEsVUFDM0IsUUFBUSxNQUFNLE9BQU0sS0FBSztBQUFBLFVBQ3pCLE1BQU07QUFBQSxRQUNWLENBQUM7QUFBQSxNQUNMO0FBQUEsSUFDSjtBQUNBLFVBQU0sUUFBUSxJQUFJLHdCQUF3QixLQUFLLFFBQVEsS0FBSyxTQUFVO0FBQ3RFLFVBQU0sU0FBUyxNQUFNLE1BQU0sS0FBSztBQUNoQyxRQUFJLE9BQU8sS0FBSyxRQUFRLEtBQUssS0FBSyxXQUFXO0FBQ3pDLFdBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUM1QixhQUFLLFNBQVMsZUFBZTtBQUM3QixhQUFLLFFBQVEsYUFBYTtBQUMxQixhQUFLLFFBQVEsTUFBTTtBQUNuQixhQUFLLFdBQVcsMkJBQTJCLEtBQUssVUFBVyx1QkFBdUI7QUFBQSxNQUN0RixDQUFDO0FBQUEsSUFDTCxXQUFXLFVBQVUsS0FBSyxRQUFRLEtBQUssS0FBSyxXQUFXO0FBQ25ELFdBQUssU0FBUyxRQUFRLEtBQUs7QUFBQSxRQUN2QixJQUFJO0FBQUEsUUFDSixhQUFhLG9DQUFvQyxLQUFLLFVBQVU7QUFBQSxRQUNoRTtBQUFBLFFBQ0EsTUFBTTtBQUFBLE1BQ1YsQ0FBQztBQUFBLElBQ0w7QUFBQSxFQUNKO0FBRUo7OztBQzFMQSx3QkFBMEM7OztBQ0ExQyx3QkFBdUU7OztBQ0N2RSx5QkFBc0MsSUFBc0IsSUFBbUY7QUFBQSw2Q0FBekcsUUFBc0IsTUFBYyxhQUFzQixPQUFPLFdBQXFCLENBQUMsR0FBa0I7QUFDM0ksVUFBTSxpQkFBaUIsT0FBTyxTQUFTO0FBQ3ZDLFFBQUksZ0JBQWdCO0FBQ2hCLFVBQUk7QUFDQSxjQUFNLFVBQVUsYUFBYTtBQUFBO0FBQUEsRUFBMEIsU0FBUyxTQUFTLGdCQUFnQixTQUFTLEtBQUssSUFBSSxJQUFJLFFBQVE7QUFBQSxJQUFZO0FBQ25JLGNBQU0sT0FBTyxJQUFJLE1BQU0sT0FBTyxHQUFHLGlCQUFpQixXQUFXLE9BQU87QUFBQSxNQUN4RSxTQUFTLE9BQVA7QUFDRSxjQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7OztBRFBBLElBQXFCLHVCQUFyQixjQUFrRCx3QkFBTTtBQUFBLEVBRXBELFlBQ1ksUUFDVjtBQUNFLFVBQU0sT0FBTyxHQUFHO0FBRlI7QUFHUixTQUFLLFlBQVksU0FBUyxlQUFlO0FBQUEsRUFDN0M7QUFBQSxFQUVBLFNBQWU7QUFDWCxTQUFLLFFBQVEsUUFBUSxxQkFBcUI7QUFDMUMsU0FBSyxzQkFBc0I7QUFBQSxFQUMvQjtBQUFBLEVBRUEsd0JBQThCO0FBQzFCLFVBQU0sa0JBQWtCLEtBQUssT0FBTyxTQUFTO0FBQzdDLFVBQU0saUJBQWlCLEtBQUssT0FBTyxTQUFTO0FBQzVDLFVBQU0sZ0JBQWdCLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUV6RSxrQkFBYyxVQUFVLEVBQUUsTUFBTSxHQUFHLHVCQUF1QixLQUFLLFFBQVEsQ0FBQztBQUN4RSxVQUFNLFlBQVksSUFBSSxnQ0FBYyxhQUFhO0FBQ2pELGNBQVUsUUFBUSxTQUFTLFlBQVk7QUFDdkMsY0FBVSxRQUFRLFNBQVMsWUFBWTtBQUN2QyxVQUFNLHFCQUFxQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssZUFBZSxNQUFNLFFBQVEscUNBQXFDLENBQUM7QUFFOUgsVUFBTSxzQkFBc0IsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQy9FLHdCQUFvQixVQUFVLEVBQUUsS0FBSyxTQUFTLE1BQU0sWUFBWSxnREFBZ0QsQ0FBQztBQUNqSCx3QkFBb0IsVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQy9DLFVBQU0sb0JBQW9CLElBQUksa0NBQWdCLG1CQUFtQjtBQUNqRSxzQkFBa0IsU0FBUyxLQUFLO0FBQ2hDLHNCQUFrQixTQUFTLFdBQVM7QUFDaEMsVUFBSSxPQUFPO0FBQUUsMEJBQWtCLEtBQUs7QUFBQSxNQUFHLE9BQU87QUFBRSwwQkFBa0IsS0FBSztBQUFBLE1BQUc7QUFBQSxJQUM5RSxDQUFDO0FBRUQsVUFBTSxvQkFBb0IsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzdFLHNCQUFrQixVQUFVLEVBQUUsS0FBSyxTQUFTLE1BQU0scUJBQXFCLENBQUM7QUFDeEUsVUFBTSxnQkFBZ0IsSUFBSSxnQ0FBYyxpQkFBaUI7QUFDekQsa0JBQWMsUUFBUSxTQUFTLFlBQVk7QUFDM0Msa0JBQWMsUUFBUSxTQUFTLFlBQVk7QUFDM0Msa0JBQWMsZUFBZSwyREFBMkQ7QUFDeEYsc0JBQWtCLEtBQUs7QUFFdkIsVUFBTSxtQkFBbUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQzNFLHFCQUFpQixVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDNUMsVUFBTSxVQUFVLElBQUksa0NBQWdCLGdCQUFnQjtBQUNwRCxZQUFRLFlBQVksSUFBSTtBQUN4QixZQUFRLFFBQVEsYUFBYTtBQUU3Qix1QkFBbUIsS0FBSztBQUN4QixjQUFVLFNBQVMsQ0FBTSxVQUFTO0FBQzlCLHlCQUFtQixLQUFLO0FBQ3hCLGNBQVEsWUFBWSxLQUFLO0FBQ3pCLGNBQVEsT0FBTztBQUNmLFVBQUksTUFBTSxLQUFLLE9BQU8sSUFBSSxNQUFNLFFBQVEsT0FBTyxHQUFHLGtCQUFrQixVQUFVLEdBQUc7QUFDN0UsMkJBQW1CLEtBQUs7QUFDeEIsZ0JBQVEsWUFBWSxJQUFJO0FBQ3hCLGdCQUFRLFVBQVU7QUFBQSxNQUN0QixPQUNLO0FBQ0QsZ0JBQVEsWUFBWSxLQUFLO0FBQ3pCLGdCQUFRLE9BQU87QUFBQSxNQUNuQjtBQUFBLElBQ0osRUFBQztBQUNELFlBQVEsUUFBUSxNQUFNO0FBQ2xCLHNCQUNJLEtBQUssUUFDTCxVQUFVLFNBQVMsR0FDbkIsa0JBQWtCLFNBQVMsR0FDM0IsY0FBYyxTQUFTLEVBQUUsTUFBTSxHQUFHLEVBQUUsSUFBSSxPQUFLLEVBQUUsS0FBSyxDQUFDLENBQ3pEO0FBQ0EsV0FBSyxNQUFNO0FBQUEsSUFDZixDQUFDO0FBQUEsRUFDTDtBQUNKOzs7QUQ1REEsaUJBQWdCLFVBQThHO0FBQzdILFNBQVEsU0FBa0IsWUFBWTtBQUN2QztBQUVBLCtCQUE4QixVQUE4SDtBQUMzSixTQUFRLGFBQXdCO0FBQ2pDO0FBRUEsb0JBQW1CLFVBQWtJO0FBQ3BKLFNBQVEsU0FBc0MsYUFBYTtBQUM1RDtBQUVBLElBQXFCLGNBQXJCLE1BQWlDO0FBQUEsRUFPaEMsWUFDUyxRQUNBLE1BQ0EsVUFDQSxnQkFDUDtBQUpPO0FBQ0E7QUFDQTtBQUNBO0FBTlQsMkJBQXlDLENBQUM7QUFRekMsU0FBSyxPQUFPO0FBQ1osU0FBSyxXQUFXO0FBQ2hCLFNBQUssYUFBYSxDQUFDO0FBQ25CLFNBQUssaUJBQWlCLGlCQUFpQixDQUFDLEtBQUssT0FBTyxTQUFTLGdCQUFnQixHQUFHLGNBQWMsSUFBSSxDQUFDLEtBQUssT0FBTyxTQUFTLGNBQWM7QUFDdEksU0FBSyxtQkFBbUI7QUFDeEIsU0FBSyxnQkFBZ0I7QUFBQSxFQUN0QjtBQUFBLEVBRUEsQUFBUSxrQkFBd0I7QUFuRGpDO0FBb0RFLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsZ0JBQWhDLG1CQUE2QztBQUUzRCxRQUFJLE9BQU87QUFDVixZQUFNLFNBQVMsTUFBTSxLQUFLLEtBQUssS0FBSyxJQUFJO0FBQ3hDLFVBQUk7QUFDSCxvQkFBWSxNQUFNLEVBQUUsUUFBUSxTQUFPLEtBQUssYUFBYSxLQUFLLE9BQU8sSUFBSSxDQUFDO0FBQUEsTUFDdkUsU0FBUyxPQUFQO0FBQ0QsY0FBTztBQUFBLE1BQ1I7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBLEVBRUEsQUFBUSxhQUFhLEtBQWEsT0FBa0I7QUFDbkQsVUFBTSxpQkFBaUIsS0FBSyxlQUFnQixPQUFPLE9BQUssTUFBTSxLQUFLLE9BQU8sU0FBUyxjQUFjO0FBQ2pHLFFBQUksZUFBZSxTQUFTLEdBQUc7QUFDOUIsVUFDQyxLQUFLLGVBQWdCLFNBQVMsR0FBRyxLQUVqQyxDQUFDLEtBQUssT0FBTyxTQUFTLHNCQUFzQixTQUFTLEdBQUcsR0FDdkQ7QUFDRCxhQUFLLFdBQVcsT0FBTztBQUFBLE1BQ3hCO0FBQUEsSUFDRCxXQUFXLENBQUMsS0FBSyxPQUFPLFNBQVMsc0JBQXNCLFNBQVMsR0FBRyxHQUFHO0FBQ3JFLFdBQUssV0FBVyxPQUFPO0FBQUEsSUFDeEI7QUFBQSxFQUNEO0FBQUEsRUFFQSxBQUFRLHFCQUEyQjtBQUNsQyxVQUFNLFFBQVEsS0FBSyxPQUFPO0FBQzFCLFVBQU0sU0FBUyxNQUFNLFlBQVksSUFBSSxLQUFLLEtBQUssSUFBSTtBQUNuRCxxQ0FBUSxRQUFRLFdBQVMsS0FBSyxnQkFBZ0IsTUFBTSxRQUFRO0FBQUEsRUFDN0Q7QUFBQSxFQUVBLEFBQU8sd0JBQXdCLFdBQXlCO0FBQ3ZELFVBQU0sUUFBUSxLQUFLLGdCQUFnQjtBQUNuQyxRQUFJLE9BQU87QUFDVixZQUFNLGVBQWUsSUFBSSxhQUFhLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSztBQUNwRSxjQUFRLGFBQWE7QUFBQSxhQUNmO0FBQ0osVUFBQyxhQUE4QixPQUFPLE1BQU0sTUFBTSxLQUFLLFdBQVcsTUFBTSxPQUFPLEtBQUssSUFBSTtBQUN4RjtBQUFBLGFBQ0k7QUFDSixVQUFDLGFBQTRCLEtBQUssTUFBTSxNQUFNLEtBQUssV0FBVyxNQUFNLE9BQU8sS0FBSyxJQUFJO0FBQ3BGO0FBQUE7QUFFQSx1QkFBYSx3QkFBd0IsS0FBSyxNQUFNLE1BQU0sTUFBTSxLQUFLLFdBQVcsTUFBTSxLQUFLO0FBQ3ZGO0FBQUE7QUFBQSxJQUdILE9BQU87QUFDTixZQUFNLGVBQWUsSUFBSSxjQUFNLFNBQVM7QUFDeEMsbUJBQWEsT0FBTztBQUNwQixVQUFJLGNBQWMsS0FBSyxPQUFPLFNBQVMsZ0JBQWdCO0FBQ3RELGFBQUssMkJBQTJCLGNBQWMsS0FBSyxXQUFXLFVBQVU7QUFBQSxNQUN6RSxXQUFXLEtBQUssYUFBYSx5QkFBeUI7QUFDckQsY0FBTSxlQUFlLElBQUksaUJBQVMsTUFBTSxLQUFLLFFBQVEsWUFBWTtBQUNqRSxRQUFDLGFBQW1CLHdCQUF3QixLQUFLLE1BQU0sV0FBVyxLQUFLLFdBQVcsVUFBVTtBQUFBLE1BQzdGO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLEFBQU8sc0JBQXNCLGtCQUEyQixNQUFZO0FBakhyRTtBQWtIRSxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxVQUFNLFdBQVcsS0FBSztBQUN0QixRQUFJLFFBQU8sUUFBUSxHQUFHO0FBQUUsZUFBUyxhQUFhO0FBQUEsSUFBRztBQUFDO0FBQ2xELFFBQUksc0JBQXFCLFFBQVEsR0FBRztBQUNuQyxXQUFLLGdDQUFnQztBQUFBLElBQ3RDLFdBQVcsV0FBVSxRQUFRLEdBQUc7QUFDL0IsV0FBSyx5QkFBeUI7QUFDOUIsV0FBSyxrQkFBa0I7QUFDdkIsV0FBSyxnQ0FBZ0M7QUFDckMsV0FBSyw0QkFBNEI7QUFDakMsV0FBSyxvQ0FBb0M7QUFDekMsVUFBSSxPQUFPO0FBQ1YsY0FBTSxxQkFBcUIsWUFBWSxNQUFNLEtBQUssS0FBSyxLQUFLLElBQUksQ0FBQztBQUNqRSxZQUFJLENBQUMsQ0FBQyxHQUFHLEtBQUssT0FBTyxXQUFXLFlBQVksSUFBSSxLQUFLLEtBQUssSUFBSSxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksV0FBUyxNQUFNLElBQUksRUFBRSxNQUFNLGVBQWEsbUJBQW1CLFNBQVMsU0FBUyxDQUFDLEdBQUc7QUFDM0osZUFBSyw2QkFBNkI7QUFBQSxRQUNuQztBQUFBLE1BQ0Q7QUFDQSxZQUFNLGNBQWMsS0FBSyxPQUFPLFdBQVcsaUJBQWlCLElBQUksS0FBSyxLQUFLLElBQUksS0FBSyxDQUFDO0FBQ3BGLGtCQUFZLFFBQVEsZUFBYTtBQUNoQyxjQUFNLDJCQUEyQixJQUFJLHlCQUF5QixLQUFLLE9BQU8sR0FBRztBQUM3RSxjQUFNLGNBQWMsSUFBSSxxQkFBcUIsS0FBSyxRQUFRLFVBQVUsYUFBYSxHQUFHLDBCQUEwQixLQUFLLElBQUk7QUFDdkgsb0JBQVksc0JBQXNCLEtBQUs7QUFDdkMsaUJBQVMsUUFBUSxLQUFLO0FBQUEsVUFDckIsSUFBSTtBQUFBLFVBQ0osYUFBYSxtQkFBbUIsVUFBVTtBQUFBLFVBQzFDLFFBQVEsTUFBTTtBQUFFLHFDQUF5QixLQUFLO0FBQUEsVUFBRTtBQUFBLFVBQ2hELE1BQU07QUFBQSxRQUNQLENBQUM7QUFBQSxNQUNGLENBQUM7QUFDRCxXQUFLLHlCQUF5QjtBQUM5QixXQUFLLHNCQUFzQjtBQUMzQixVQUFJO0FBQWlCLGlCQUFTLEtBQUs7QUFBQSxJQUNwQyxXQUFXLFFBQU8sUUFBUSxHQUFHO0FBQzVCLFdBQUsseUJBQXlCO0FBQzlCLFdBQUssa0JBQWtCO0FBQ3ZCLFdBQUssNEJBQTRCO0FBQ2pDLFdBQUssZ0NBQWdDO0FBQ3JDLFdBQUssb0NBQW9DO0FBQ3pDLFVBQUksT0FBTztBQUNWLGNBQU0scUJBQXFCLFlBQVksTUFBTSxLQUFLLEtBQUssS0FBSyxJQUFJLENBQUM7QUFDakUsWUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLE9BQU8sV0FBVyxZQUFZLElBQUksS0FBSyxLQUFLLElBQUksS0FBSyxDQUFDLENBQUMsRUFBRSxJQUFJLFdBQVMsTUFBTSxJQUFJLEVBQUUsTUFBTSxlQUFhLG1CQUFtQixTQUFTLFNBQVMsQ0FBQyxHQUFHO0FBQzNKLGVBQUssNkJBQTZCO0FBQUEsUUFDbkM7QUFBQSxNQUNEO0FBQ0EsWUFBTSxjQUFjLEtBQUssT0FBTyxXQUFXLGlCQUFpQixJQUFJLEtBQUssS0FBSyxJQUFJLEtBQUssQ0FBQztBQUNwRixrQkFBWSxRQUFRLGVBQWE7QUFDaEMsY0FBTSx1QkFBdUIsSUFBSSxxQkFBcUIsS0FBSyxRQUFRLFVBQVUsYUFBYSxHQUFHLFVBQVUsS0FBSyxJQUFJO0FBQ2hILDZCQUFxQixzQkFBc0IsS0FBSztBQUFBLE1BQ2pELENBQUM7QUFDRCxXQUFLLHlCQUF5QjtBQUM5QixXQUFLLHNCQUFzQjtBQUFBLElBQzVCO0FBQUEsRUFDRDtBQUFBLEVBRUEsQUFBUSwyQkFBMkIsT0FBYyxPQUFxQjtBQUNyRSxVQUFNLFFBQVEsSUFBSSxXQUFXLEtBQUssUUFBUSxLQUFLLE1BQU0sT0FBTyxLQUFLO0FBQ2pFLFVBQU0sUUFBUSxRQUFRLHFCQUFxQixNQUFNLE9BQU87QUFDeEQsUUFBSSxRQUFPLEtBQUssUUFBUSxHQUFHO0FBQzFCLFdBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUMvQixhQUFLLFNBQVMsVUFBVSxNQUFNLE1BQU07QUFDcEMsYUFBSyxRQUFRLFFBQVE7QUFDckIsYUFBSyxRQUFRLE1BQU0sTUFBTSxLQUFLLENBQUM7QUFDL0IsYUFBSyxXQUFXLGVBQWU7QUFBQSxNQUNoQyxDQUFDO0FBQUEsSUFDRixXQUFXLFdBQVUsS0FBSyxRQUFRLEdBQUc7QUFDcEMsV0FBSyxTQUFTLFFBQVEsS0FBSztBQUFBLFFBQzFCLElBQUksVUFBVSxNQUFNO0FBQUEsUUFDcEIsYUFBYSxtQkFBbUIsTUFBTTtBQUFBLFFBQ3RDLFFBQVEsTUFBTSxNQUFNLEtBQUs7QUFBQSxRQUN6QixNQUFNLFVBQVU7QUFBQSxNQUNqQixDQUFDO0FBQUEsSUFDRjtBQUFDO0FBQUEsRUFDRjtBQUFBLEVBR0EsQUFBUSwyQkFBaUM7QUE3TDFDO0FBOExFLFVBQU0sb0JBQW9CLFdBQUssT0FBTyxXQUFXLHNCQUFzQixJQUFJLEtBQUssS0FBSyxJQUFJLE1BQS9ELG1CQUFrRTtBQUM1RixRQUFJLG1CQUFtQjtBQUN0QixZQUFNLFlBQVksS0FBSyxPQUFPLFdBQVcsZ0JBQWdCLElBQUksaUJBQWlCO0FBQzlFLFVBQUksV0FBVztBQUNkLGNBQU0sT0FBTyxVQUFVLFFBQVEsS0FBSztBQUNwQyxjQUFNLHNCQUFzQixJQUFJLG9CQUFvQixLQUFLLFFBQVEsS0FBSyxNQUFNO0FBQUEsUUFBRSxHQUFHLEtBQUssSUFBSTtBQUMxRixjQUFNLFNBQVMsTUFBTSxLQUFLLE9BQU8sU0FBUyxtQkFBbUI7QUFDN0QsWUFBSSxRQUFPLEtBQUssUUFBUSxHQUFHO0FBQzFCLGVBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUMvQixpQkFBSyxTQUFTLG1CQUFtQjtBQUNqQyxpQkFBSyxRQUFRLElBQUk7QUFDakIsaUJBQUssUUFBUSxNQUFNO0FBQ25CLGlCQUFLLFdBQVcsZUFBZTtBQUFBLFVBQ2hDLENBQUM7QUFBQSxRQUNGLFdBQVcsV0FBVSxLQUFLLFFBQVEsR0FBRztBQUNwQyxlQUFLLFNBQVMsUUFBUSxLQUFLO0FBQUEsWUFDMUIsSUFBSTtBQUFBLFlBQ0osYUFBYTtBQUFBLFlBQ2I7QUFBQSxZQUNBO0FBQUEsVUFDRCxDQUFDO0FBQUEsUUFDRjtBQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0Q7QUFBQSxFQUVEO0FBQUEsRUFFQSxBQUFRLG9CQUEwQjtBQUNqQyxXQUFPLEtBQUssS0FBSyxVQUFVLEVBQUUsUUFBUSxDQUFDLFFBQWdCO0FBQ3JELFlBQU0sUUFBUSxLQUFLLFdBQVc7QUFDOUIsWUFBTSxRQUFRLEtBQUssZ0JBQWdCO0FBRW5DLFVBQUksT0FBTztBQUNWLGNBQU0sZUFBZSxJQUFJLGFBQWEsTUFBTSxNQUFNLEtBQUssUUFBUSxLQUFLO0FBQ3BFLHFCQUFhLGVBQWUsS0FBSyxPQUFPLEtBQUssTUFBTSxLQUFLLFFBQVE7QUFBQSxNQUNqRSxXQUFXLFFBQVEsVUFBVyxZQUFVLEtBQUssUUFBUSxLQUFLLFFBQU8sS0FBSyxRQUFRLElBQUk7QUFDakYsY0FBTSxlQUFlLElBQUksY0FBTSxHQUFHO0FBQ2xDLHFCQUFhLE9BQU87QUFDcEIsWUFBSSxRQUFRLEtBQUssT0FBTyxTQUFTLGdCQUFnQjtBQUNoRCxlQUFLLDJCQUEyQixjQUFjLEtBQUs7QUFBQSxRQUNwRCxPQUFPO0FBQ04sZ0JBQU0sZUFBZSxJQUFJLGlCQUFTLE1BQU0sS0FBSyxRQUFRLFlBQVk7QUFDakUsdUJBQWEsZUFBZSxLQUFLLFNBQVMsSUFBSSxLQUFLLE1BQU0sS0FBSyxRQUFRO0FBQUEsUUFDdkU7QUFBQSxNQUNEO0FBQUEsSUFFRCxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRUEsQUFBUSw4QkFBb0M7QUFDM0MsVUFBTSxRQUFRLElBQUksbUJBQ2pCLEtBQUssUUFDTCxLQUFLLE1BQ0wsQ0FDQyxZQUNBLE9BQ0EsUUFDQSxjQUNJLGNBQUUsZUFDTixLQUFLLFFBQ0wsS0FBSyxNQUNMLFFBQ0EsSUFDQSxZQUNBLE9BQ0EsUUFDQSxTQUNELENBQ0Q7QUFDQSxRQUFJLFFBQU8sS0FBSyxRQUFRLEdBQUc7QUFDMUIsV0FBSyxTQUFTLFFBQVEsQ0FBQyxTQUFTO0FBQy9CLGFBQUssUUFBUSxPQUFPO0FBQ3BCLGFBQUssU0FBUyx5QkFBeUI7QUFDdkMsYUFBSyxRQUFRLENBQUMsUUFBb0I7QUFDakMsZ0JBQU0sS0FBSztBQUFBLFFBQ1osQ0FBQztBQUNELGFBQUssV0FBVyxlQUFlO0FBQUEsTUFDaEMsQ0FBQztBQUFBLElBQ0YsV0FBVyxXQUFVLEtBQUssUUFBUSxHQUFHO0FBQ3BDLFdBQUssU0FBUyxRQUFRLEtBQUs7QUFBQSxRQUMxQixJQUFJO0FBQUEsUUFDSixhQUFhO0FBQUEsUUFDYixRQUFRLE1BQU0sTUFBTSxLQUFLO0FBQUEsUUFDekIsTUFBTTtBQUFBLE1BQ1AsQ0FBQztBQUFBLElBQ0Y7QUFBQztBQUFBLEVBQ0Y7QUFBQSxFQUVBLEFBQVEsK0JBQXFDO0FBdFI5QztBQXVSRSxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxRQUFJLE9BQU87QUFDVixZQUFNLFNBQVMsTUFBTSxLQUFLLEtBQUssS0FBSyxJQUFJO0FBQ3hDLFlBQU0sUUFBUSxJQUFJLG1CQUNqQixLQUFLLFFBQ0wsS0FBSyxNQUNMLENBQ0MsWUFDQSxPQUNBLFFBQ0EsY0FDSSxvQkFDSixLQUFLLFFBQ0wsT0FBTyxLQUFLLE1BQ1osWUFDQSxPQUNBLFFBQ0EsU0FDRCxDQUNEO0FBQ0EsVUFBSSxRQUFPLEtBQUssUUFBUSxHQUFHO0FBQzFCLGFBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUMvQixlQUFLLFFBQVEsY0FBYztBQUMzQixlQUFLLFNBQVMsa0NBQWtDO0FBQ2hELGVBQUssUUFBUSxDQUFDLFFBQW9CO0FBQ2pDLGtCQUFNLEtBQUs7QUFBQSxVQUNaLENBQUM7QUFDRCxlQUFLLFdBQVcsZUFBZTtBQUFBLFFBQ2hDLENBQUM7QUFBQSxNQUNGLFdBQVcsV0FBVSxLQUFLLFFBQVEsR0FBRztBQUNwQyxhQUFLLFNBQVMsUUFBUSxLQUFLO0FBQUEsVUFDMUIsSUFBSTtBQUFBLFVBQ0osYUFBYTtBQUFBLFVBQ2IsUUFBUSxNQUFNLE1BQU0sS0FBSztBQUFBLFVBQ3pCLE1BQU07QUFBQSxRQUNQLENBQUM7QUFBQSxNQUNGO0FBQUM7QUFBQSxJQUNGO0FBQUEsRUFDRDtBQUFBLEVBRUEsQUFBUSxzQ0FBNEM7QUEvVHJEO0FBZ1VFLFFBQUksV0FBSyxPQUFPLElBQUksY0FBYyxTQUFTLEtBQUssS0FBSyxJQUFJLE1BQXJELG1CQUF3RCxhQUFhO0FBQ3hFLFVBQUksUUFBTyxLQUFLLFFBQVEsR0FBRztBQUMxQixhQUFLLFNBQVMsUUFBUSxDQUFDLFNBQVM7QUFDL0IsZUFBSyxRQUFRLEtBQUs7QUFDbEIsZUFBSyxTQUFTLDBCQUEwQjtBQUN4QyxlQUFLLFFBQVEsQ0FBTyxRQUFvQjtBQUN2QywwQkFBRSxlQUFlLEtBQUssUUFBUSxLQUFLLE1BQU0sUUFBVyxJQUFJLElBQUksT0FBTyxPQUFPLEtBQUs7QUFBQSxVQUNoRixFQUFDO0FBQ0QsZUFBSyxXQUFXLGVBQWU7QUFBQSxRQUNoQyxDQUFDO0FBQUEsTUFDRixXQUFXLFdBQVUsS0FBSyxRQUFRLEdBQUc7QUFDcEMsYUFBSyxTQUFTLFFBQVEsS0FBSztBQUFBLFVBQzFCLElBQUk7QUFBQSxVQUNKLGFBQWE7QUFBQSxVQUNiLFFBQVEsTUFBTSxjQUFFLGVBQ2YsS0FBSyxRQUFRLEtBQUssTUFBTSxRQUFXLElBQUksSUFBSSxPQUFPLE9BQU8sS0FBSztBQUFBLFVBQy9ELE1BQU07QUFBQSxRQUNQLENBQUM7QUFBQSxNQUNGO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLEFBQVEsa0NBQXdDO0FBdFZqRDtBQXVWRSxVQUFNLGNBQWMsS0FBSyxPQUFPLElBQUksVUFBVSxvQkFBb0IsOEJBQVk7QUFDOUUsVUFBTSxvQkFBb0IsMkNBQWEsT0FBTyxZQUFZO0FBQzFELFFBQUksc0JBQXNCLFVBQWEsS0FBSyxLQUFLLFFBQVEsNENBQWEsS0FBSyxPQUFNO0FBQ2hGLFlBQU0sY0FBYyxXQUFLLE9BQU8sSUFBSSxjQUFjLGFBQWEsS0FBSyxJQUFJLE1BQXBELG1CQUF1RDtBQUMzRSxVQUFJLGFBQWE7QUFDakIsVUFBSSxhQUFhO0FBQ2hCLGNBQU0sRUFBRSxVQUFVLEVBQUUsZUFBTyxnQkFBVTtBQUNyQyxZQUFJLHFCQUFxQixPQUFNLFFBQVEsb0JBQW9CLEtBQUk7QUFBTSx1QkFBYTtBQUFBLE1BQ25GO0FBQ0EsVUFBSSxRQUFPLEtBQUssUUFBUSxHQUFHO0FBQzFCLGFBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUMvQixlQUFLLFFBQVEsS0FBSztBQUNsQixlQUFLLFNBQVMscUJBQXFCO0FBQ25DLGVBQUssUUFBUSxDQUFDLFFBQW9CO0FBQ2pDLDBCQUFFLGVBQ0QsS0FBSyxRQUFRLEtBQUssTUFBTSxRQUFXLElBQUksWUFBWSxPQUFPLE9BQU8sS0FBSztBQUFBLFVBQ3hFLENBQUM7QUFDRCxlQUFLLFdBQVcsZUFBZTtBQUFBLFFBQ2hDLENBQUM7QUFBQSxNQUNGLFdBQVcsc0JBQXFCLEtBQUssUUFBUSxHQUFHO0FBQy9DLHNCQUFFLGVBQ0QsS0FBSyxRQUFRLEtBQUssTUFBTSxRQUFXLElBQUksWUFBWSxPQUFPLE9BQU8sS0FBSztBQUFBLE1BQ3hFLFdBQVcsV0FBVSxLQUFLLFFBQVEsR0FBRztBQUNwQyxhQUFLLFNBQVMsUUFBUSxLQUFLO0FBQUEsVUFDMUIsSUFBSTtBQUFBLFVBQ0osYUFBYTtBQUFBLFVBQ2IsUUFBUSxNQUFNLGNBQUUsZUFDZixLQUFLLFFBQVEsS0FBSyxNQUFNLFFBQVcsSUFBSSxZQUFZLE9BQU8sT0FBTyxLQUFLO0FBQUEsVUFDdkUsTUFBTTtBQUFBLFFBQ1AsQ0FBQztBQUFBLE1BQ0Y7QUFBQztBQUFBLElBQ0Y7QUFBQSxFQUNEO0FBQUEsRUFFQSxBQUFRLDJCQUFpQztBQUN4QyxVQUFNLFFBQVEsSUFBSSx3QkFBd0IsS0FBSyxRQUFRLEtBQUssSUFBSTtBQUNoRSxVQUFNLFNBQVMsTUFBTSxNQUFNLEtBQUs7QUFDaEMsUUFBSSxRQUFPLEtBQUssUUFBUSxHQUFHO0FBQzFCLFdBQUssU0FBUyxRQUFRLENBQUMsU0FBUztBQUMvQixhQUFLLFFBQVEsYUFBYTtBQUMxQixhQUFLLFNBQVMsT0FBTyxLQUFLLE9BQU8sU0FBUyxxQkFBcUIsS0FBSyxLQUFLLFVBQVU7QUFDbkYsYUFBSyxRQUFRLE1BQU07QUFDbkIsYUFBSyxXQUFXLHlCQUF5QjtBQUFBLE1BQzFDLENBQUM7QUFBQSxJQUNGLFdBQVcsV0FBVSxLQUFLLFFBQVEsR0FBRztBQUNwQyxXQUFLLFNBQVMsUUFBUSxLQUFLO0FBQUEsUUFDMUIsSUFBSTtBQUFBLFFBQ0osYUFBYSxPQUFPLEtBQUssT0FBTyxTQUFTLHFCQUFxQixLQUFLLEtBQUs7QUFBQSxRQUN4RTtBQUFBLFFBQ0EsTUFBTTtBQUFBLE1BQ1AsQ0FBQztBQUFBLElBQ0Y7QUFBQztBQUFBLEVBQ0Y7QUFBQSxFQUVBLEFBQVEsd0JBQThCO0FBQ3JDLFVBQU0sUUFBUSxJQUFJLHFCQUFxQixLQUFLLE1BQU07QUFDbEQsVUFBTSxTQUFTLE1BQU0sTUFBTSxLQUFLO0FBQ2hDLFFBQUksS0FBSyxPQUFPLFNBQVMsZ0JBQWdCO0FBQ3hDLFVBQUksUUFBTyxLQUFLLFFBQVEsR0FBRztBQUMxQixhQUFLLFNBQVMsUUFBUSxDQUFDLFNBQVM7QUFDL0IsZUFBSyxRQUFRLGFBQWE7QUFDMUIsZUFBSyxTQUFTLGFBQWEsS0FBSyxPQUFPLFNBQVMsZ0JBQWdCO0FBQ2hFLGVBQUssUUFBUSxNQUFNO0FBQ25CLGVBQUssV0FBVyx5QkFBeUI7QUFBQSxRQUMxQyxDQUFDO0FBQUEsTUFDRixXQUFXLFdBQVUsS0FBSyxRQUFRLEdBQUc7QUFDcEMsYUFBSyxTQUFTLFFBQVEsS0FBSztBQUFBLFVBQzFCLElBQUk7QUFBQSxVQUNKLGFBQWEsYUFBYSxLQUFLLE9BQU8sU0FBUztBQUFBLFVBQy9DO0FBQUEsVUFDQSxNQUFNO0FBQUEsUUFDUCxDQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQ0Q7OztBL0gvWUEsc0NBQXNDLFFBQXNCO0FBQ3hELFFBQU0saUJBQWlCLE9BQU8sU0FBUztBQUN2QyxTQUFPLFdBQVc7QUFBQSxJQUNkLElBQUk7QUFBQSxJQUNKLE1BQU07QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLGVBQWUsQ0FBQyxhQUFzQjtBQUNsQyxZQUFNLE9BQU8sT0FBTyxJQUFJLFVBQVUsb0JBQW9CLDhCQUFZO0FBQ2xFLFlBQU0sY0FBYyxDQUFDLENBQUUsbUJBQWtCLENBQUMsQ0FBRSw4QkFBTSxTQUFTLEtBQUssS0FBSyxLQUFLLFdBQVcsY0FBYztBQUNuRyxVQUFJLFVBQVU7QUFDVixlQUFPO0FBQUEsTUFDWDtBQUNBLFVBQUksYUFBYTtBQUNiLGNBQU0sMkJBQTJCLElBQUkseUJBQXlCLE9BQU8sR0FBRztBQUN4RSxjQUFNLGNBQWMsSUFBSSxxQkFBcUIsUUFBUSxLQUFNLE1BQU0sd0JBQXdCO0FBQ3pGLG9CQUFZLHNCQUFzQjtBQUFBLE1BQ3RDO0FBQUEsSUFDSjtBQUFBLEVBQ0osQ0FBQztBQUNMO0FBRUEscUNBQXFDLFFBQXNCO0FBQ3ZELFFBQU0saUJBQWlCLE9BQU8sU0FBUztBQUN2QyxTQUFPLFdBQVc7QUFBQSxJQUNkLElBQUk7QUFBQSxJQUNKLE1BQU07QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLGVBQWUsQ0FBQyxhQUFzQjtBQUNsQyxZQUFNLE9BQU8sT0FBTyxJQUFJLFVBQVUsb0JBQW9CLDhCQUFZO0FBQ2xFLFlBQU0sY0FBYyxDQUFDLENBQUUsbUJBQWtCLENBQUMsQ0FBRSw4QkFBTSxTQUFTLEtBQUssS0FBSyxLQUFLLFdBQVcsY0FBYztBQUNuRyxVQUFJLFVBQVU7QUFDVixlQUFPO0FBQUEsTUFDWDtBQUNBLFVBQUksYUFBYTtBQUNiLFlBQUk7QUFDQSxnQkFBTSxnQkFBZ0IsVUFBVSx5QkFBeUIsUUFBUSxLQUFNLEtBQUssSUFBSTtBQUNoRixjQUFJLGVBQWU7QUFDZixrQkFBTSwwQkFBMEIsSUFBSSx3QkFBd0IsUUFBUSxVQUFVLGdCQUFnQixRQUFRLGFBQWEsQ0FBQztBQUNwSCxvQ0FBd0IsS0FBSztBQUFBLFVBQ2pDO0FBQUEsUUFDSixTQUFTLE9BQVA7QUFDRSxjQUFJLHlCQUFPLGlDQUFpQztBQUFBLFFBQ2hEO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFBQSxFQUNKLENBQUM7QUFDTDtBQUVBLHlDQUF5QyxRQUFzQjtBQUMzRCxRQUFNLGlCQUFpQixPQUFPLFNBQVM7QUFDdkMsU0FBTyxXQUFXO0FBQUEsSUFDZCxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixNQUFNO0FBQUEsSUFDTixlQUFlLENBQUMsYUFBc0I7QUFDbEMsWUFBTSxPQUFPLE9BQU8sSUFBSSxVQUFVLG9CQUFvQiw4QkFBWTtBQUNsRSxZQUFNLFNBQVMsQ0FBQyxDQUFFLCtCQUFNLFNBQVMsRUFBQyxrQkFBa0IsQ0FBQyxLQUFLLEtBQUssS0FBSyxXQUFXLGNBQWM7QUFDN0YsVUFBSSxVQUFVO0FBQ1YsZUFBTztBQUFBLE1BQ1g7QUFDQSxVQUFJLFFBQVE7QUFDUixjQUFNLGNBQWMsSUFBSSxZQUFZLFFBQVEsS0FBTSxNQUFNLG9CQUFvQjtBQUM1RSxvQkFBWSxzQkFBc0I7QUFBQSxNQUN0QztBQUFBLElBQ0o7QUFBQSxFQUNKLENBQUM7QUFDTDtBQUVBLGdDQUFnQyxRQUFzQjtBQUNsRCxRQUFNLGlCQUFpQixPQUFPLFNBQVM7QUFDdkMsU0FBTyxXQUFXO0FBQUEsSUFDZCxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixNQUFNO0FBQUEsSUFDTixlQUFlLENBQUMsYUFBc0I7QUFDbEMsWUFBTSxPQUFPLE9BQU8sSUFBSSxVQUFVLG9CQUFvQiw4QkFBWTtBQUNsRSxZQUFNLFNBQVMsQ0FBQyxDQUFFLCtCQUFNLFNBQVMsRUFBQyxrQkFBa0IsQ0FBQyxLQUFLLEtBQUssS0FBSyxXQUFXLGNBQWM7QUFDN0YsVUFBSSxVQUFVO0FBQ1YsZUFBTztBQUFBLE1BQ1g7QUFDQSxVQUFJLFFBQVE7QUFDUixjQUFNLDJCQUEyQixJQUFJLHlCQUF5QixPQUFPLEdBQUc7QUFDeEUsY0FBTSxjQUFjLElBQUksWUFBWSxRQUFRLEtBQU0sTUFBTSx3QkFBd0I7QUFDaEYsb0JBQVksc0JBQXNCO0FBQUEsTUFDdEM7QUFBQSxJQUNKO0FBQUEsRUFDSixDQUFDO0FBQ0w7QUFFQSx1Q0FBdUMsUUFBc0I7QUFDekQsUUFBTSxpQkFBaUIsT0FBTyxTQUFTO0FBQ3ZDLFNBQU8sV0FBVztBQUFBLElBQ2QsSUFBSTtBQUFBLElBQ0osTUFBTTtBQUFBLElBQ04sTUFBTTtBQUFBLElBQ04sZUFBZSxDQUFDLGFBQXNCO0FBbEg5QztBQW1IWSxZQUFNLE9BQU8sT0FBTyxJQUFJLFVBQVUsb0JBQW9CLDhCQUFZO0FBQ2xFLFlBQU0sU0FBUyw2QkFBTTtBQUNyQixZQUFNLFNBQVMsQ0FBQyxDQUFFLCtCQUFNLFNBQVMsRUFBQyxrQkFBa0IsQ0FBQyxLQUFLLEtBQUssS0FBSyxXQUFXLGNBQWM7QUFDN0YsVUFBSSxVQUFVO0FBQ1YsZUFBTyxVQUFVLFdBQVc7QUFBQSxNQUNoQztBQUNBLFVBQUksVUFBVSxXQUFXLFFBQVc7QUFDaEMsY0FBTSxjQUFjLElBQUksWUFBWSxRQUFRLEtBQU0sTUFBTSx1QkFBdUI7QUFDL0UsY0FBTSxjQUFjLGFBQU8sSUFBSSxjQUFjLGFBQWEsS0FBTSxJQUFJLE1BQWhELG1CQUFtRDtBQUN2RSxZQUFJLGVBQWUsVUFDWixPQUFPLFVBQVUsRUFBRSxPQUFPLFlBQVksU0FBUyxNQUFNLFFBQ3JELE9BQU8sVUFBVSxFQUFFLE9BQU8sWUFBWSxTQUFTLElBQUksTUFBTTtBQUM1RCxnQkFBTSxZQUFZLHFCQUFxQixPQUFPLFFBQVEsT0FBTyxVQUFVLEVBQUUsSUFBSSxDQUFDO0FBQzlFLGNBQUk7QUFBVyx3QkFBWSx3QkFBd0IsU0FBUztBQUFBLFFBQ2hFLFdBQVcsUUFBUTtBQUNmLGdCQUFNLEVBQUUsV0FBVyxXQUFXLGNBQWMsT0FBTyxRQUFRLE9BQU8sVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEtBQUssV0FDdEYsT0FBTyxVQUFVLEVBQUUsTUFBTSxNQUFNLFFBQVEsTUFBTSxVQUMxQyxPQUFPLFVBQVUsRUFBRSxNQUFNLE1BQU0sS0FBSyxLQUFLLENBQUM7QUFDakQsY0FBSTtBQUFXLHdCQUFZLHdCQUF3QixTQUFTO0FBQUEsUUFDaEU7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUFBLEVBQ0osQ0FBQztBQUNMO0FBRUEsb0NBQW9DLFFBQXNCO0FBQ3RELFFBQU0saUJBQWlCLE9BQU8sU0FBUztBQUN2QyxTQUFPLFdBQVc7QUFBQSxJQUNkLElBQUk7QUFBQSxJQUNKLE1BQU07QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLGVBQWUsQ0FBQyxhQUFzQjtBQWxKOUM7QUFtSlksWUFBTSxPQUFPLE9BQU8sSUFBSSxVQUFVLG9CQUFvQiw4QkFBWTtBQUNsRSxZQUFNLFNBQVMsQ0FBQyxDQUFFLCtCQUFNLFNBQVMsRUFBQyxrQkFBa0IsQ0FBQyxLQUFLLEtBQUssS0FBSyxXQUFXLGNBQWM7QUFDN0YsVUFBSSxVQUFVO0FBQ1YsZUFBTztBQUFBLE1BQ1g7QUFDQSxZQUFNLFFBQVEsYUFBTyxJQUFJLFFBQVEsUUFBUSxhQUEzQixtQkFBcUM7QUFDbkQsVUFBSSxTQUFTLFFBQVE7QUFDakIsY0FBTSxPQUFPLEtBQUs7QUFDbEIsY0FBTSxxQkFBcUIsWUFBWSxNQUFNLEtBQUssS0FBSyxJQUFJLENBQUM7QUFDNUQsWUFBSSxDQUFDLENBQUMsR0FBRyxPQUFPLFdBQVcsWUFBWSxJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksV0FBUyxNQUFNLElBQUksRUFBRSxNQUFNLGVBQWEsbUJBQW1CLFNBQVMsU0FBUyxDQUFDLEdBQUc7QUFDOUksY0FBSSxtQkFDQSxRQUNBLE1BQ0EsQ0FDSSxZQUNBLE9BQ0EsUUFDQSxjQUNDLG9CQUNELFFBQ0EsS0FBSyxNQUNMLFlBQ0EsT0FDQSxRQUNBLFNBQ0osQ0FDSixFQUFFLEtBQUs7QUFBQSxRQUNYO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFBQSxFQUNKLENBQUM7QUFDTDtBQUVBLG1DQUFtQyxRQUFzQjtBQUNyRCxRQUFNLGlCQUFpQixPQUFPLFNBQVM7QUFDdkMsU0FBTyxXQUFXO0FBQUEsSUFDZCxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixNQUFNO0FBQUEsSUFDTixlQUFlLENBQUMsYUFBc0I7QUFDbEMsWUFBTSxPQUFPLE9BQU8sSUFBSSxVQUFVLG9CQUFvQiw4QkFBWTtBQUNsRSxZQUFNLFNBQVMsQ0FBQyxDQUFFLCtCQUFNLFNBQVMsRUFBQyxrQkFBa0IsQ0FBQyxLQUFLLEtBQUssS0FBSyxXQUFXLGNBQWM7QUFDN0YsVUFBSSxVQUFVO0FBQ1YsZUFBTztBQUFBLE1BQ1g7QUFDQSxVQUFJLFFBQVE7QUFDUixjQUFNLE9BQU8sS0FBSztBQUNsQixZQUFJLFVBQVUsZ0JBQWdCLDJCQUFTLEtBQUssY0FBYyxNQUFNO0FBQzVELGdCQUFNLHNCQUFzQixJQUFJLG9CQUFvQixRQUFRLEtBQUssTUFBTTtBQUFBLFVBQUUsR0FBRyxJQUFJO0FBQ2hGLGlCQUFPLFNBQVMsbUJBQW1CO0FBQUEsUUFDdkM7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUFBLEVBQ0osQ0FBQztBQUNMO0FBRUEsK0JBQStCLFFBQTRCO0FBQ3ZELFFBQU0sU0FBa0IsQ0FBQztBQUN6QixTQUFPLFNBQVMsYUFBYSxRQUFRLE9BQUs7QUFBRSxRQUFJLEVBQUU7QUFBUyxhQUFPLEtBQUssQ0FBQztBQUFBLEVBQUUsQ0FBQztBQUMzRSxHQUFDLEdBQUcsT0FBTyxXQUFXLGlCQUFpQixFQUFFLFFBQVEsQ0FBQyxDQUFDLGVBQWUsYUFBYTtBQUMzRSxZQUFRLFFBQVEsV0FBUztBQUFFLFVBQUksTUFBTSxTQUFTO0FBQUUsZUFBTyxLQUFLLEtBQUs7QUFBQSxNQUFFO0FBQUEsSUFBRSxDQUFDO0FBQUEsRUFDMUUsQ0FBQztBQUNELFNBQU8sUUFBUSxXQUFTO0FBQ3BCLFFBQUksTUFBTSxTQUFTO0FBQ2YsWUFBTSxVQUFVLE1BQU07QUFDdEIsYUFBTyxXQUFXO0FBQUEsUUFDZCxJQUFJLFFBQVE7QUFBQSxRQUNaLE1BQU0sUUFBUTtBQUFBLFFBQ2QsTUFBTSxRQUFRO0FBQUEsUUFDZCxlQUFlLENBQUMsYUFBc0I7QUF4TnREO0FBeU5vQixnQkFBTSxPQUFPLE9BQU8sSUFBSSxVQUFVLG9CQUFvQiw4QkFBWTtBQUNsRSxnQkFBTSxLQUFLLFFBQVEsR0FBRyxNQUFNLFdBQUMsZ0RBQStDO0FBQzVFLGNBQUksVUFBVTtBQUNWLGtCQUFNLGNBQWMsOEJBQU0sUUFBTyxPQUFPLFdBQVcsaUJBQWlCLElBQUksNkJBQU0sS0FBSyxJQUFJLElBQUk7QUFDM0YsbUJBQU8sOEJBQU0sU0FFTCxnQkFBZSxZQUFZLEtBQUssZUFBVTtBQS9OMUU7QUErTjZFLCtCQUFVLFNBQVMsaUNBQUksV0FBSixvQkFBWTtBQUFBLGFBQWEsS0FDekYsQ0FBQyxlQUFlLGdDQUFJLFdBQUosbUJBQVksbUJBQWtCO0FBQUEsVUFFMUQ7QUFDQSxjQUFJLDBCQUFJLFdBQVUsOEJBQU0sT0FBTTtBQUMxQixrQkFBTSxZQUFZLEdBQUcsT0FBTztBQUM1QixnQkFBSSxtQkFDQSxRQUNBLEtBQUssTUFDTCxDQUNJLFlBQ0EsT0FDQSxRQUNBLGNBQ0MsY0FBRSxlQUNILFFBQ0EsS0FBSyxNQUNMLFdBQ0EsSUFDQSxZQUNBLE9BQ0EsUUFDQSxTQUNKLENBQ0osRUFBRSxLQUFLO0FBQUEsVUFDWDtBQUFBLFFBRUo7QUFBQSxNQUNKLENBQUM7QUFBQSxJQUNMO0FBQUEsRUFDSixDQUFDO0FBQ0w7QUFFQSxzQ0FBc0MsUUFBc0I7QUFDeEQsU0FBTyxXQUFXO0FBQUEsSUFDZCxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixNQUFNO0FBQUEsSUFDTixlQUFlLENBQUMsYUFBc0I7QUFyUTlDO0FBc1FZLFVBQUksVUFBVTtBQUNWLGVBQU87QUFBQSxNQUNYO0FBQ0EsWUFBTSxpQkFBaUIsYUFBTyxJQUFJLFVBQVUsY0FBYyxNQUFuQyxtQkFBc0M7QUFDN0QsWUFBTSxZQUFZLGlCQUFpQixPQUFPLFdBQVcsZ0JBQWdCLElBQUksY0FBYyxJQUFJO0FBQzNGLFlBQU0scUJBQXFCLElBQUksaUJBQWlCLFFBQVEsU0FBUztBQUNqRSxhQUFPLFNBQVMsa0JBQWtCO0FBQUEsSUFDdEM7QUFBQSxFQUNKLENBQUM7QUFDTDtBQUdBLHFDQUFxQyxRQUFzQjtBQUN2RCxTQUFPLFdBQVc7QUFBQSxJQUNkLElBQUk7QUFBQSxJQUNKLE1BQU07QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLGVBQWUsQ0FBQyxhQUFzQjtBQUNsQyxVQUFJO0FBQVUsZUFBTztBQUNyQixhQUFPLFdBQVcsVUFBVSxXQUFXLElBQUk7QUFBQSxJQUMvQztBQUFBLEVBQ0osQ0FBQztBQUNMO0FBRUEscUNBQXFDLFFBQXNCO0FBQ3ZELFFBQU0saUJBQWlCLE9BQU8sU0FBUztBQUN2QyxTQUFPLFdBQVc7QUFBQSxJQUNkLElBQUk7QUFBQSxJQUNKLE1BQU07QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLGVBQWUsQ0FBQyxhQUFzQjtBQXBTOUM7QUFxU1ksWUFBTSxPQUFPLE9BQU8sSUFBSSxVQUFVLG9CQUFvQiw4QkFBWTtBQUNsRSxZQUFNLFNBQVMsQ0FBQyxDQUFFLCtCQUFNLFNBQVMsRUFBQyxrQkFBa0IsQ0FBQyxLQUFLLEtBQUssS0FBSyxXQUFXLGNBQWM7QUFDN0YsVUFBSSxVQUFVO0FBQ1YsZUFBTztBQUFBLE1BQ1g7QUFDQSxVQUFJLFFBQVE7QUFDUixjQUFNLE9BQU8sS0FBSztBQUNsQixZQUFJLFVBQVUsZ0JBQWdCLDJCQUFTLEtBQUssY0FBYyxNQUFNO0FBQzVELGdCQUFNLGVBQWUsYUFBTyxXQUFXLFlBQVksSUFBSSxLQUFLLElBQUksTUFBM0MsbUJBQThDLE9BQU8sV0FBUyxNQUFNLFNBQVM7QUFDbEcsdURBQWMsUUFBUSxDQUFPLFVBQVU7QUFDbkMsa0JBQU0sY0FBYyxRQUFRLGtCQUFrQixFQUFFLE1BQVksV0FBVyxNQUFNLEtBQUssQ0FBQztBQUFBLFVBQ3ZGO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFDSixDQUFDO0FBQ0w7QUFFQSxzQ0FBc0MsUUFBc0I7QUFDeEQsUUFBTSxpQkFBaUIsT0FBTyxTQUFTO0FBQ3ZDLFNBQU8sV0FBVztBQUFBLElBQ2QsSUFBSTtBQUFBLElBQ0osTUFBTTtBQUFBLElBQ04sTUFBTTtBQUFBLElBQ04sZUFBZSxDQUFDLGFBQXNCO0FBN1Q5QztBQThUWSxZQUFNLE9BQU8sT0FBTyxJQUFJLFVBQVUsb0JBQW9CLDhCQUFZO0FBQ2xFLFlBQU0sU0FBUyxDQUFDLENBQUUsK0JBQU0sU0FBUyxFQUFDLGtCQUFrQixDQUFDLEtBQUssS0FBSyxLQUFLLFdBQVcsY0FBYztBQUM3RixVQUFJLFVBQVU7QUFDVixlQUFPO0FBQUEsTUFDWDtBQUNBLFVBQUksUUFBUTtBQUNSLGNBQU0sT0FBTyxLQUFLO0FBQ2xCLFlBQUksVUFBVSxnQkFBZ0IsMkJBQVMsS0FBSyxjQUFjLE1BQU07QUFDNUQsZ0JBQU0sZ0JBQWdCLGFBQU8sV0FBVyxZQUFZLElBQUksS0FBSyxJQUFJLE1BQTNDLG1CQUE4QyxPQUFPLFdBQVMsTUFBTSxTQUFTO0FBQ25HLHlEQUFlLFFBQVEsQ0FBTyxVQUFVO0FBQ3BDLGtCQUFNLGVBQWUsUUFBUSxFQUFFLE1BQVksV0FBVyxNQUFNLEtBQUssQ0FBQztBQUFBLFVBQ3RFO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFDSixDQUFDO0FBQ0w7QUFHTyxxQkFBcUIsUUFBc0IsTUFBK0I7QUFDN0UsUUFBTSxpQkFBaUIsT0FBTyxTQUFTO0FBQ3ZDLE1BQUksUUFBUSxnQkFBZ0IsNEJBQVU7QUFDbEMsVUFBTSxPQUFPLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixLQUFLLEtBQUssSUFBSTtBQUNsRSxRQUFJLGdCQUFnQiwyQkFBUyxLQUFLLGNBQWMsTUFBTTtBQUNsRCxVQUFJLGtCQUFrQixLQUFLLEtBQUssV0FBVyxjQUFjLEdBQUc7QUFDeEQscUNBQTZCLE1BQU07QUFDbkMsb0NBQTRCLE1BQU07QUFBQSxNQUN0QyxPQUFPO0FBQ0gsK0JBQXVCLE1BQU07QUFDN0Isd0NBQWdDLE1BQU07QUFDdEMsc0NBQThCLE1BQU07QUFDcEMsbUNBQTJCLE1BQU07QUFDakMsa0NBQTBCLE1BQU07QUFDaEMsOEJBQXNCLE1BQU07QUFDNUIsb0NBQTRCLE1BQU07QUFDbEMscUNBQTZCLE1BQU07QUFBQSxNQUN2QztBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0EsK0JBQTZCLE1BQU07QUFDbkMsOEJBQTRCLE1BQU07QUFDdEM7OztBa0l0V0Esd0JBQW1GO0FBT25GLElBQXFCLGNBQXJCLGNBQXlDLDRCQUFVO0FBQUEsRUFFbEQsWUFBb0IsUUFBc0I7QUFDekMsVUFBTTtBQURhO0FBQUEsRUFFcEI7QUFBQSxFQUVBLFNBQWU7QUFDZCxTQUFLLE9BQU8sY0FDWCxLQUFLLE9BQU8sSUFBSSxVQUFVLEdBQUcsYUFBYSxDQUFDLE1BQU0sY0FBYyxXQUFXO0FBQ3pFLFlBQU0sT0FBTyxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixhQUFhLElBQUk7QUFDMUUsV0FBSyxhQUFhLE1BQU0sSUFBSTtBQUFBLElBQzdCLENBQUMsQ0FDRjtBQUVBLFNBQUssT0FBTyxjQUNYLEtBQUssT0FBTyxJQUFJLFVBQVUsR0FBRyxlQUFlLENBQUMsTUFBTSxRQUFRLFNBQVM7QUF2QnZFO0FBd0JJLFlBQU0sT0FBTyxLQUFLLE9BQU8sSUFBSSxVQUFVLGNBQWM7QUFDckQsWUFBTSxpQkFBMkIsQ0FBQztBQUNsQyxZQUFNLGNBQWMsS0FBSyxRQUFRLFlBQUssT0FBTyxJQUFJLGNBQWMsYUFBYSxLQUFLLElBQUksTUFBcEQsbUJBQXVEO0FBQ3hGLFVBQUksZUFDQSxPQUFPLFVBQVUsRUFBRSxPQUFPLFlBQVksU0FBUyxNQUFNLFFBQ3JELE9BQU8sVUFBVSxFQUFFLE9BQU8sWUFBWSxTQUFTLElBQUksTUFDckQ7QUFDRCxjQUFNLFlBQVkscUJBQXFCLE9BQU8sUUFBUSxPQUFPLFVBQVUsRUFBRSxJQUFJLENBQUM7QUFDOUUsWUFBSTtBQUFXLHlCQUFlLEtBQUssU0FBUztBQUFBLE1BQzdDLE9BQU87QUFDTixzQkFBYyxPQUFPLFFBQVEsT0FBTyxVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsUUFBUSxXQUFTO0FBQ3ZFLGNBQUksT0FBTyxVQUFVLEVBQUUsTUFBTSxNQUFNLFFBQVEsTUFBTSxVQUFVLE9BQU8sVUFBVSxFQUFFLE1BQU0sTUFBTSxPQUFPO0FBQ2hHLDJCQUFlLEtBQUssTUFBTSxTQUFTO0FBQUEsVUFDcEM7QUFBQSxRQUNELENBQUM7QUFBQSxNQUNGO0FBQ0EsVUFBSSxlQUFlLFFBQVE7QUFDMUIsYUFBSyxhQUFhLE1BQU0sTUFBTSxjQUFjO0FBQUEsTUFDN0MsT0FBTztBQUNOLGFBQUssYUFBYSxNQUFNLElBQUk7QUFBQSxNQUM3QjtBQUFBLElBRUQsQ0FBQyxDQUNGO0FBQUEsRUFDRDtBQUFBLEVBRUEsQUFBUSxhQUFhLE1BQW9DLE1BQVksZ0JBQWlDO0FBQ3JHLFVBQU0saUJBQWlCLEtBQUssT0FBTyxTQUFTO0FBQzVDLFFBQUksZ0JBQWdCLDJCQUFTLEtBQUssY0FBYyxNQUFNO0FBQ3JELFVBQUksQ0FBQywyQkFBUyxZQUFZLHlDQUFrQixRQUFRLEdBQUc7QUFDdEQsWUFBSSxrQkFBa0IsS0FBSyxLQUFLLFdBQVcsY0FBYyxHQUFHO0FBQzNELGdCQUFNLGdCQUFnQixVQUFVLHlCQUF5QixLQUFLLFFBQVEsS0FBSyxJQUFJO0FBRS9FLGVBQUssa0JBQWtCLDJCQUEyQixrQ0FBa0MsRUFBRSxPQUFPLGlCQUFpQixNQUFNLFNBQVMsQ0FBQztBQUFBLFFBQy9ILE9BQU87QUFFTixlQUFLLGtCQUFrQiwrQkFBK0IsRUFBRSxPQUFPLGlCQUFpQixNQUFNLFNBQVMsQ0FBQztBQUVoRyxlQUFLLGtCQUFrQix3QkFBd0IsRUFBRSxPQUFPLGlCQUFpQixNQUFNLFNBQVMsQ0FBQztBQUN6RixnQkFBTSxjQUFjLEtBQUssT0FBTyxXQUFXLGlCQUFpQixJQUFJLEtBQUssSUFBSSxLQUFLLENBQUM7QUFDL0Usc0JBQVksUUFBUSxlQUFhO0FBRWhDLGlCQUFLLGtCQUFrQiwyQkFBMkIsVUFBVSx5QkFBeUIsRUFBRSxPQUFPLFVBQVUsVUFBVSxlQUFlLE1BQU0sU0FBUyxDQUFDO0FBQUEsVUFDbEosQ0FBQztBQUFBLFFBQ0Y7QUFBQSxNQUNEO0FBQ0EsVUFBSSxLQUFLLE9BQU8sU0FBUyw0QkFBNEI7QUFFcEQsWUFBSSxrQkFBa0IsS0FBSyxLQUFLLFdBQVcsY0FBYyxHQUFHO0FBQzNELGdCQUFNLHVCQUF1QixJQUFJLHFCQUFxQixLQUFLLFFBQVEsTUFBTSxJQUFJO0FBQzdFLCtCQUFxQixzQkFBc0I7QUFBQSxRQUM1QyxPQUFPO0FBQ04sZ0JBQU0sY0FBYyxJQUFJLFlBQVksS0FBSyxRQUFRLE1BQU0sTUFBTSxjQUFjO0FBQzNFLHNCQUFZLHNCQUFzQjtBQUFBLFFBQ25DO0FBQUM7QUFBQSxNQUNGLE9BQU87QUFDTixhQUFLLFFBQVEsQ0FBQyxTQUFTO0FBQ3RCLGVBQUssUUFBUSxNQUFNO0FBQ25CLGVBQUssU0FBUyxlQUFlO0FBQzdCLGVBQUssUUFBUSxNQUFNO0FBQ2xCLGtCQUFNLDJCQUEyQixJQUFJLHlCQUF5QixLQUFLLE9BQU8sR0FBRztBQUM3RSxrQkFBTSxjQUFjLElBQUksWUFBWSxLQUFLLFFBQVEsTUFBTSx3QkFBd0I7QUFDL0Usd0JBQVksc0JBQXNCO0FBQUEsVUFDbkMsQ0FBQztBQUFBLFFBQ0YsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNEO0FBQUM7QUFBQSxFQUNGO0FBQ0Q7OztBQzNGQSx3QkFBMkM7OztBQ0QzQyx3QkFBd0c7QUFLakcsOEJBQThCLE1BQW1CO0FBQ3BELFNBQU8sT0FBTyxLQUFLLFVBQVUsRUFBRSxRQUFRLFVBQVE7QUFDM0MsUUFBSSxLQUFLLEtBQUssU0FBUyxnQkFBZ0IsR0FBRztBQUN0QyxXQUFLLGdCQUFnQixLQUFLLElBQUk7QUFDOUIsWUFBTSxLQUFLLEtBQUs7QUFDaEIsVUFBSSx5QkFBSSxTQUFTLG1CQUFtQjtBQUNoQyxXQUFHLE9BQU87QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0osQ0FBQztBQUNMO0FBRUEsbUNBQW1DLFFBQXNCLE1BQW1CLFVBQWtCLGNBQTZCLGVBQXdCO0FBakJuSjtBQWtCSSxNQUFJLEtBQUssVUFBVSxTQUFTLDZCQUE2QjtBQUFHO0FBQzVELFVBQVE7QUFBQSxTQUNDO0FBQW1CLFVBQUksQ0FBQyxPQUFPLFNBQVM7QUFBYTtBQUFRO0FBQUEsU0FDN0Q7QUFBYSxVQUFJLENBQUMsT0FBTyxTQUFTO0FBQWlCO0FBQVE7QUFBQSxTQUMzRDtBQUFXLFVBQUksQ0FBQyxPQUFPLFNBQVM7QUFBZTtBQUFRO0FBQUEsU0FDdkQ7QUFBaUIsVUFBSSxDQUFDLE9BQU8sU0FBUztBQUFvQjtBQUFRO0FBQUEsU0FDbEU7QUFBWSxVQUFJLENBQUMsT0FBTyxTQUFTO0FBQWlCO0FBQVE7QUFBQSxTQUMxRDtBQUFVLFVBQUksQ0FBQyxPQUFPLFNBQVM7QUFBYztBQUFRO0FBQUE7QUFDakQ7QUFBQTtBQUdiLGFBQVcsS0FBSyxLQUFLLFlBQVk7QUFDN0IsUUFBSSxFQUFFLEtBQUssU0FBUyxnQkFBZ0IsS0FBTSxFQUFFLFNBQVMsZUFBZ0I7QUFDakUsV0FBSyxnQkFBZ0IsRUFBRSxJQUFJO0FBQzNCLFlBQU0sS0FBSyxLQUFLO0FBQ2hCLFVBQUkseUJBQUksU0FBUyxtQkFBbUI7QUFDaEMsV0FBRyxPQUFPO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0EsUUFBTSxrQkFBa0IsT0FBTyxTQUFTO0FBQ3hDLFFBQU0sWUFBWSxPQUFPLFdBQVcsZ0JBQWdCLElBQUksV0FBVyxLQUFLO0FBQ3hFLE1BQUksbUJBQW1CLFdBQVc7QUFFOUIsVUFBTSxPQUFPO0FBQ2IsU0FBSyxhQUFhLGtCQUFrQixVQUFVLElBQUk7QUFDbEQsVUFBTSxLQUFLLEtBQUs7QUFDaEIsUUFBSSxDQUFDLDBCQUFJLFNBQVMsb0JBQW1CO0FBQ2pDLFlBQU0sa0JBQWtCLE9BQU8sSUFBSSxVQUFVLFlBQVksU0FBUyxLQUFLLEVBQUUsS0FBSywrQkFBK0IsQ0FBQztBQUM5RyxVQUFJLGlCQUFpQjtBQUNqQix1Q0FBUSxpQkFBaUIsSUFBSTtBQUM3QixtQkFBSyxrQkFBTCxtQkFBb0IsYUFBYSxpQkFBaUIsS0FBSztBQUN2RCx3QkFBZ0IsVUFBVSxDQUFDLFVBQVU7QUFDakMsaUJBQU8sU0FBUyxJQUFJLGlCQUFpQixRQUFRLFNBQVMsQ0FBQztBQUN2RCxnQkFBTSxnQkFBZ0I7QUFBQSxRQUMxQjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFFSixXQUNTLGVBQWU7QUFDcEIsVUFBTSxhQUFZLE9BQU8sV0FBVyxnQkFBZ0IsSUFBSSxhQUFhO0FBQ3JFLFFBQUksWUFBVztBQUNYLFlBQU0sT0FBTyxXQUFVLFFBQVE7QUFDL0IsV0FBSyxhQUFhLGtCQUFrQixhQUFhO0FBQ2pELFlBQU0sS0FBSyxLQUFLO0FBQ2hCLFVBQUksQ0FBQywwQkFBSSxTQUFTLG9CQUFtQjtBQUNqQyxjQUFNLGtCQUFrQixPQUFPLElBQUksVUFBVSxZQUFZLFNBQVMsS0FBSyxFQUFFLEtBQUssK0JBQStCLENBQUM7QUFDOUcsWUFBSSxpQkFBaUI7QUFDakIseUNBQVEsaUJBQWlCLFFBQVEsT0FBTyxTQUFTLFVBQVU7QUFDM0QscUJBQUssa0JBQUwsbUJBQW9CLGFBQWEsaUJBQWlCLEtBQUs7QUFDdkQsMEJBQWdCLFVBQVUsQ0FBQyxVQUFVO0FBQ2pDLGtCQUFNLE9BQU8sT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEdBQUcsYUFBYTtBQUNwRSxnQkFBSSxnQkFBZ0IsMkJBQVMsS0FBSyxjQUFjLE1BQU07QUFDbEQsb0JBQU0sc0JBQXNCLElBQUksb0JBQW9CLFFBQVEsS0FBSyxNQUFNO0FBQUEsY0FBRSxHQUFHLElBQUk7QUFDaEYscUJBQU8sU0FBUyxtQkFBbUI7QUFBQSxZQUN2QztBQUNBLGtCQUFNLGdCQUFnQjtBQUFBLFVBQzFCO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNKO0FBRUEsMENBQTBDLE1BQVUsUUFBc0IsTUFBbUIsY0FBNkIsUUFBZ0I7QUFuRjFJO0FBb0ZJLFFBQU0sV0FBVyxXQUFLLGFBQWEsTUFBTSxNQUF4QixtQkFBMkIsTUFBTSxLQUFLO0FBQ3ZELFFBQU0sT0FBTyxZQUFZLEtBQUksY0FBYyxxQkFBcUIsVUFBVSxNQUFNO0FBRWhGLE1BQUksTUFBTTtBQUNOLFVBQU0sZ0JBQWdCLGFBQU8sV0FBVyxzQkFBc0IsSUFBSSxLQUFLLElBQUksTUFBckQsbUJBQXdEO0FBQzlFLDhCQUEwQixRQUFRLE1BQU0sS0FBSyxLQUFLLFFBQVEsV0FBVyxJQUFJLEdBQUcsY0FBYyxhQUFhO0FBQUEsRUFDM0c7QUFDSjtBQUVPLGtDQUFrQyxNQUFVLFFBQXNCLE1BQW1CLGNBQTZCLFlBQW9CLFdBQW9CO0FBN0ZqSztBQThGSSxRQUFNLFdBQVcsYUFBYSxLQUFLO0FBQ25DLFFBQU0sT0FBTyxZQUFZLEtBQUksY0FBYyxxQkFBcUIsbUNBQVksUUFBUSxHQUFHLFVBQVU7QUFDakcsTUFBSSxNQUFNO0FBQ04sVUFBTSxnQkFBZ0IsYUFBTyxXQUFXLHNCQUFzQixJQUFJLEtBQUssSUFBSSxNQUFyRCxtQkFBd0Q7QUFDOUUsOEJBQTBCLFFBQVEsTUFBTSxLQUFLLEtBQUssUUFBUSxXQUFXLElBQUksR0FBRyxjQUFjLGFBQWE7QUFBQSxFQUMzRztBQUNKO0FBR08sdUJBQXVCLE1BQVUsUUFBc0IsSUFBaUIsS0FBbUM7QUFDOUcsUUFBTSxRQUFRLEdBQUcsaUJBQWlCLGlCQUFpQjtBQUNuRCxRQUFNLFNBQVMsSUFBSSxXQUFXLFFBQVEsV0FBVyxJQUFJO0FBQ3JELFFBQU0sUUFBUSxDQUFDLFNBQXNCO0FBQ2pDLHFDQUFpQyxNQUFLLFFBQVEsTUFBTSxtQkFBbUIsTUFBTTtBQUFBLEVBQ2pGLENBQUM7QUFDTDtBQUVPLDRCQUE0QixNQUFVLFFBQXNCO0FBQy9ELFFBQU0sV0FBVyxPQUFPO0FBQ3hCLE9BQUksVUFBVSxrQkFBa0IsQ0FBQyxTQUFTO0FBQ3RDLFFBQUksS0FBSyxnQkFBZ0Isa0NBQWdCLEtBQUssS0FBSyxNQUFNO0FBQ3JELFlBQU0sT0FBYyxLQUFLLEtBQUs7QUFDOUIsWUFBTSxhQUFhLEtBQUksY0FBYyxhQUFhLElBQUk7QUFDdEQsWUFBTSxXQUFXLEtBQUssS0FBSyxRQUFRLFdBQVcsSUFBSTtBQUVsRCxZQUFNLFlBQXlCLEtBQUs7QUFDcEMsVUFBSSxTQUFTLGlCQUFpQjtBQUUxQixpQ0FBeUIsTUFBSyxRQUFRLFdBQVcsYUFBYSxRQUFRO0FBQUEsTUFDMUUsT0FDSztBQUNELDZCQUFxQixTQUFTO0FBQUEsTUFDbEM7QUFHQSxVQUFJLDBDQUFZLFVBQVMsU0FBUyxhQUFhO0FBQzNDLG1CQUFXLE1BQU0sUUFBUSxDQUFDLFNBQW9CO0FBbEk5RDtBQW1Jb0IsZ0JBQU0sT0FBTyxLQUFJLGNBQWMscUJBQXFCLEtBQUssTUFBTSxRQUFRO0FBQ3ZFLGNBQUksTUFBTTtBQUNOLGtCQUFNLGdCQUFnQixhQUFPLFdBQVcsc0JBQXNCLElBQUksS0FBSyxJQUFJLE1BQXJELG1CQUF3RDtBQUU5RSxrQkFBTSxnQkFBZ0IsS0FBSyxLQUFLLFlBQVksaUJBQWlCLHlCQUF5QixLQUFLLFFBQVE7QUFDbkcsMEJBQWMsUUFBUSxDQUFDLGlCQUE4QiwwQkFBMEIsUUFBUSxjQUFjLEtBQUssS0FBSyxRQUFRLFdBQVcsSUFBSSxHQUFHLG1CQUFtQixhQUFhLENBQUM7QUFBQSxVQUM5SztBQUFBLFFBQ0osQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBQUEsRUFDSixDQUFDO0FBQ0w7OztBRDNJQSxvQkFBcUI7OztBRUhyQix3QkFBbUU7QUFDbkUsa0JBQTBGO0FBQzFGLG1CQUFnQztBQUNoQyxzQkFBMkI7QUFDM0IsdUJBQW1DO0FBSzVCLDJCQUEyQixRQUFzQjtBQUlwRCxRQUFNLHFCQUFxQix1QkFBVztBQUFBLElBS2xDLFlBQVksZUFBbUMsT0FBZ0IsVUFBa0I7QUFDN0UsWUFBTTtBQUNOLFdBQUssZ0JBQWdCO0FBQ3JCLFdBQUssUUFBUTtBQUNiLFdBQUssV0FBVztBQUFBLElBQ3BCO0FBQUEsSUFFQSxRQUFRO0FBQ0osVUFBSSxrQkFBa0IsU0FBUyxjQUFjLE1BQU07QUFFbkQsVUFBSSxLQUFLLGVBQWU7QUFDcEIsd0JBQWdCLFFBQVEsa0JBQWtCLEtBQUssYUFBYTtBQUM1RCx3QkFBZ0IsU0FBUyxnQkFBZ0I7QUFDekMsd0JBQWdCLFNBQVMsZUFBZTtBQUN4QyxZQUFJLFlBQVksT0FBTyxXQUFXLGdCQUFnQixJQUFJLEtBQUssYUFBYTtBQUN4RSxjQUFNLGlCQUFpQixPQUFPLFNBQVM7QUFDdkMsWUFBSSxrQkFBa0IsS0FBSyxTQUFTLFNBQVMsY0FBYyxHQUFHO0FBQzFELGdCQUFNLE9BQU87QUFDYixzQkFBWSxPQUFPLFdBQVcsZ0JBQWdCLElBQUksS0FBSyxXQUFXLEtBQUs7QUFDdkUsY0FBSSxXQUFXO0FBQ1gsMkNBQVEsaUJBQWlCLFFBQVEsU0FBUyxVQUFVO0FBQ3BELDRCQUFnQixVQUFVLENBQUMsVUFBVTtBQUNqQyxxQkFBTyxTQUFTLElBQUksaUJBQWlCLFFBQVEsU0FBUyxDQUFDO0FBQ3ZELG9CQUFNLGdCQUFnQjtBQUFBLFlBQzFCO0FBQUEsVUFDSjtBQUFBLFFBQ0osV0FBVyxXQUFXO0FBRWxCLGdCQUFNLE9BQU8sVUFBVSxRQUFRO0FBQy9CLHlDQUFRLGlCQUFpQixRQUFRLFNBQVMsVUFBVTtBQUNwRCwwQkFBZ0IsVUFBVSxDQUFDLFVBQVU7QUFDakMsa0JBQU0sT0FBTyxPQUFPLElBQUksTUFBTSxzQkFBc0IsR0FBRyxLQUFLLGFBQWE7QUFDekUsZ0JBQUksZ0JBQWdCLDJCQUFTLEtBQUssY0FBYyxNQUFNO0FBQ2xELG9CQUFNLHNCQUFzQixJQUFJLG9CQUFvQixRQUFRLEtBQUssTUFBTTtBQUFBLGNBQUUsR0FBRyxJQUFJO0FBQ2hGLHFCQUFPLFNBQVMsbUJBQW1CO0FBQUEsWUFDdkM7QUFDQSxrQkFBTSxnQkFBZ0I7QUFBQSxVQUMxQjtBQUFBLFFBQ0o7QUFBQSxNQUNKO0FBR0EsYUFBTztBQUFBLElBQ1g7QUFBQSxJQUVBLGNBQWM7QUFDVixhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFFQSxRQUFNLFdBQVcsT0FBTztBQUN4QixRQUFNLGFBQWEsdUJBQVcsVUFDMUIsTUFBTTtBQUFBLElBR0YsWUFBWSxNQUFrQjtBQUMxQixXQUFLLGNBQWMsS0FBSyxpQkFBaUIsSUFBSTtBQUFBLElBQ2pEO0FBQUEsSUFFQSxPQUFPLFFBQW9CO0FBQ3ZCLFVBQUksT0FBTyxjQUFjLE9BQU8saUJBQWlCO0FBQzdDLGFBQUssY0FBYyxLQUFLLGlCQUFpQixPQUFPLElBQUk7QUFBQSxNQUN4RDtBQUFBLElBQ0o7QUFBQSxJQUVBLFVBQVU7QUFBQSxJQUNWO0FBQUEsSUFFQSxpQkFBaUIsTUFBa0I7QUFDL0IsVUFBSSxVQUFVLElBQUksNkJBQTRCO0FBQzlDLFVBQUksQ0FBQyxTQUFTLGNBQWM7QUFDeEIsZUFBTyxRQUFRLE9BQU87QUFBQSxNQUMxQjtBQUNBLFlBQU0sU0FBUyxLQUFLLE1BQU0sTUFBTSxpQ0FBZTtBQUMvQyxVQUFJLGlCQUFpQixDQUFDO0FBQ3RCLFVBQUksZ0JBQW1DO0FBQ3ZDLFVBQUkscUJBQW9DO0FBRXhDLFVBQUksY0FBNkI7QUFDakMsVUFBSSxZQUEyQjtBQUMvQixlQUFTLEVBQUUsTUFBTSxRQUFRLEtBQUssZUFBZTtBQUN6Qyx3Q0FBVyxLQUFLLEtBQUssRUFBRSxRQUFRO0FBQUEsVUFDM0I7QUFBQSxVQUNBO0FBQUEsVUFDQSxPQUFPLENBQUMsU0FBUztBQXRHekM7QUF5RzRCLGtCQUFNLGFBQWEsS0FBSyxLQUFLLEtBQUssbUNBQWtCO0FBQ3BELGdCQUFJLFlBQVk7QUFDWixvQkFBTSxRQUFRLElBQUksSUFBSSxXQUFXLE1BQU0sR0FBRyxDQUFDO0FBQzNDLG9CQUFNLFNBQVMsTUFBTSxJQUFJLG1CQUFtQjtBQUM1QyxvQkFBTSxVQUFVLE1BQU0sSUFBSSxZQUFZO0FBQ3RDLG9CQUFNLFNBQVMsTUFBTSxJQUFJLGlCQUFpQjtBQUcxQyxvQkFBTSxXQUFXLE1BQU0sSUFBSSxNQUFNO0FBRWpDLG9CQUFNLFVBQVUsTUFBTSxJQUFJLEtBQUs7QUFDL0Isb0JBQU0saUJBQWlCLE1BQU0sSUFBSSxpQkFBaUI7QUFFbEQsa0JBQUksWUFBWSxDQUFDLGdCQUFnQjtBQUc3Qiw4QkFBYyxLQUFLO0FBQ25CLDRCQUFZLEtBQUs7QUFBQSxjQUNyQjtBQUVBLGtCQUFJLENBQUMsVUFBVSxDQUFDLFNBQVM7QUFDckIsb0JBQUksaUJBQWlCLG9CQUFvQjtBQUNyQywwQkFBUSxJQUFJLG9CQUFvQixvQkFBb0IsYUFBYTtBQUNqRSxrQ0FBZ0I7QUFDaEIsdUNBQXFCO0FBQUEsZ0JBQ3pCO0FBQUEsY0FDSjtBQUNBLGtCQUFJLFVBQVUsQ0FBQyxXQUFXLENBQUMsVUFBVSxTQUFTO0FBQzFDLG9CQUFJLFdBQVcsS0FBSyxNQUFNLElBQUksWUFBWSxLQUFLLE1BQU0sS0FBSyxFQUFFO0FBQzVELDJCQUFXLFNBQVMsTUFBTSxHQUFHLEVBQUU7QUFDL0Isb0JBQUksT0FBTyxPQUFPLElBQUksY0FBYyxxQkFBcUIsVUFBVSxPQUFPLEtBQUssUUFBUTtBQUN2RixvQkFBSSxXQUFXLENBQUMsTUFBTTtBQUNsQixzQkFBSTtBQUNBLDJCQUFPLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixtQkFBbUIsUUFBUSxDQUFDO0FBQUEsa0JBQzlFLFNBQ08sR0FBUDtBQUFBLGtCQUFZO0FBQUEsZ0JBQ2hCO0FBQ0Esb0JBQUksTUFBTTtBQUNOLHdCQUFNLGdCQUFnQixhQUFPLFdBQVcsc0JBQXNCLElBQUksS0FBSyxJQUFJLE1BQXJELG1CQUF3RDtBQUM5RSxzQkFBSSxlQUFlO0FBQ2YsMEJBQU0sYUFBYSxFQUFFLGtCQUFrQixjQUFjO0FBQ3JELHdCQUFJLE9BQU8sdUJBQVcsS0FBSztBQUFBLHNCQUN2QjtBQUFBLHNCQUNBLE9BQU87QUFBQSxvQkFDWCxDQUFDO0FBTUQsb0NBQWdCLHVCQUFXLE9BQU87QUFBQSxzQkFDOUIsUUFBUSxJQUFJLGFBQWEsZUFBZSxNQUFNLEtBQUssS0FBSyxRQUFRLFdBQVcsSUFBSSxDQUFDO0FBQUEsb0JBQ3BGLENBQUM7QUFFRCx3QkFBSSxXQUFXLGVBQWUsV0FBVztBQUVyQywwQkFBSSxRQUFPLHVCQUFXLEtBQUs7QUFBQSx3QkFDdkI7QUFBQSx3QkFDQSxPQUFPO0FBQUEsc0JBQ1gsQ0FBQztBQUVELDhCQUFRLElBQUksYUFBYSxXQUFXLEtBQUk7QUFDeEMsMEJBQUksZUFBZTtBQUNmLGdDQUFRLElBQUksV0FBVyxXQUFXLGFBQWE7QUFDL0Msd0NBQWdCO0FBQ2hCLDZDQUFxQjtBQUNyQixzQ0FBYztBQUNkLG9DQUFZO0FBQUEsc0JBQ2hCO0FBQUEsb0JBQ0o7QUFPQSw0QkFBUSxJQUFJLEtBQUssTUFBTSxLQUFLLElBQUksSUFBSTtBQUNwQyxxQ0FBaUI7QUFDakIseUNBQXFCLEtBQUs7QUFBQSxrQkFDOUI7QUFBQSxnQkFDSjtBQUFBLGNBQ0osV0FBVyxVQUFVLFNBQVM7QUFDMUIsb0JBQUksT0FBTyx1QkFBVyxLQUFLO0FBQUEsa0JBQ3ZCLFlBQVk7QUFBQSxrQkFDWixPQUFPO0FBQUEsZ0JBQ1gsQ0FBQztBQUNELHdCQUFRLElBQUksS0FBSyxNQUFNLEtBQUssSUFBSSxJQUFJO0FBQ3BDLG9CQUFJLGVBQWU7QUFDZiwwQkFBUSxJQUFJLEtBQUssSUFBSSxLQUFLLElBQUksYUFBYTtBQUMzQyxrQ0FBZ0I7QUFDaEIsdUNBQXFCO0FBQUEsZ0JBQ3pCO0FBQUEsY0FDSjtBQUFBLFlBQ0o7QUFBQSxVQUNKO0FBQUEsUUFDSixDQUFDO0FBQUEsTUFFTDtBQUNBLGFBQU8sUUFBUSxPQUFPO0FBQUEsSUFDMUI7QUFBQSxFQUNKLEdBQ0E7QUFBQSxJQUNJLGFBQWEsT0FBSyxFQUFFO0FBQUEsRUFDeEIsQ0FDSjtBQUNBLFNBQU87QUFDWDs7O0FGN01BLElBQXFCLGNBQXJCLGNBQXlDLDRCQUFVO0FBQUEsRUFLL0MsWUFDVyxRQUNBLGNBQ0EsVUFFVDtBQUNFLFVBQU07QUFMQztBQUNBO0FBQ0E7QUFMWCxTQUFRLGlCQUFxQyxDQUFDO0FBQUEsRUFTOUM7QUFBQSxFQUVBLFNBQWU7QUFDWCxTQUFLLE9BQU8sOEJBQThCLENBQUMsSUFBSSxRQUFRO0FBQ25ELG9CQUFjLEtBQUssT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLEdBQUc7QUFBQSxJQUN2RCxDQUFDO0FBR0QsVUFBTSxNQUFNLG1CQUFLLE9BQU8sa0JBQWtCLEtBQUssTUFBTSxDQUFDO0FBQ3RELFNBQUssT0FBTyx3QkFBd0IsR0FBRztBQUV2QyxTQUFLLE9BQU8sOEJBQThCLENBQUMsSUFBSSxRQUFRO0FBQ25ELG9CQUFjLEtBQUssT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLEdBQUc7QUFBQSxJQUN2RCxDQUFDO0FBR0QsVUFBTSxTQUFTLEtBQUs7QUFDcEIsVUFBTSxjQUFjLENBQUMsVUFBaUI7QUFDbEMseUJBQW1CLE9BQU8sS0FBSyxNQUFNO0FBQ3JDLFdBQUssVUFBVSxRQUFRLENBQUMsQ0FBQyxVQUFVLE1BQU0sZUFBZ0M7QUFDckUsY0FBTSxTQUFTLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixJQUFJO0FBQ3hELGVBQU8sUUFBUSxDQUFDLFNBQWM7QUFDMUIsZUFBSyxnQkFBZ0IsS0FBSyxLQUFLLGFBQWEsV0FBVyxJQUFJO0FBQUEsUUFDL0QsQ0FBQztBQUFBLE1BQ0wsQ0FBQztBQUFBLElBQ0w7QUFFQSxTQUFLLFlBQVksQ0FBQztBQUVsQixTQUFLLE9BQU8sSUFBSSxVQUFVLGNBQWMsTUFBTTtBQUMxQyxXQUFLLGtCQUFrQjtBQUN2QixXQUFLLG1CQUFtQixRQUFRO0FBQ2hDLHlCQUFtQixLQUFLLE9BQU8sS0FBSyxLQUFLLE1BQU07QUFBQSxJQUNuRCxDQUFDO0FBR0QsU0FBSyxjQUFjLEtBQUssT0FBTyxJQUFJLGNBQWMsR0FBRyxXQUFXLGdDQUFTLGFBQWEsS0FBSyxJQUFJLENBQUMsQ0FBQztBQUVoRyxTQUFLLGNBQWMsS0FBSyxPQUFPLElBQUksVUFBVSxHQUFHLGlCQUFpQixnQ0FBUyxhQUFhLElBQUksSUFBSSxDQUFDLENBQUM7QUFDakcsU0FBSyxjQUFjLEtBQUssT0FBTyxJQUFJLFVBQVUsR0FBRyxlQUFlLENBQUMsU0FBUSxRQUFRLEtBQUssbUJBQW1CLFFBQU8sYUFBYSxFQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQ3BJLFNBQUssY0FBYyxLQUFLLE9BQU8sSUFBSSxVQUFVLEdBQUcsaUJBQWlCLE1BQU0sS0FBSyxrQkFBa0IsQ0FBQyxDQUFDO0FBQ2hHLFNBQUssY0FBYyxLQUFLLE9BQU8sSUFBSSxVQUFVLEdBQUcseUJBQXlCLE1BQU0sS0FBSyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQUEsRUFDMUc7QUFBQSxFQUVBLEFBQVEsb0JBQW9CO0FBOURoQztBQWdFUSxTQUFLLFVBQVUsUUFBUSxDQUFDLENBQUMsVUFBVSxVQUFVO0FBQ3pDLGVBQVMsV0FBVztBQUFBLElBQ3hCLENBQUM7QUFDRCxTQUFLLFlBQVksQ0FBQztBQUdsQixTQUFLLGlCQUFpQixZQUFZLG9CQUFvQixJQUFJO0FBQzFELFNBQUssaUJBQWlCLGlCQUFpQixvQkFBb0IsSUFBSTtBQUMvRCxTQUFLLGlCQUFpQixVQUFVLG9CQUFvQixJQUFJO0FBQ3hELFNBQUssaUJBQWlCLGFBQWEsVUFBVTtBQUM3QyxTQUFLLGlCQUFpQixZQUFZLGdCQUFnQjtBQUNsRCxTQUFLLGlCQUFpQixXQUFXLGlCQUFpQjtBQUNsRCxTQUFLLGlCQUFpQixrQkFBa0IsZ0JBQWdCO0FBQ3hELFNBQUssaUJBQWlCLFdBQVcsMkJBQTJCLElBQUk7QUFDaEUsU0FBSyxpQkFBaUIsaUJBQWlCLDJCQUEyQixJQUFJO0FBQ3RFLFNBQUssaUJBQWlCLGdCQUFnQiwyQkFBMkIsSUFBSTtBQUdyRSxRQUFJLHlDQUFLLE9BQU8sUUFBWixtQkFBaUIsb0JBQWpCLG1CQUFrQyxZQUFsQyxtQkFBMkMsYUFBM0MsbUJBQXFELGFBQXJELG1CQUErRCxZQUEvRCxtQkFBd0Usb0JBQW9CO0FBQzVGLFdBQUssaUJBQWlCLFlBQVksb0JBQW9CLElBQUk7QUFBQSxJQUM5RDtBQUFBLEVBQ0o7QUFBQSxFQUVBLEFBQVEsbUJBQW1CLEtBQWU7QUF2RjlDO0FBd0ZRLFVBQU0sU0FBUztBQUFBLE1BQ1gsU0FBUztBQUFBLE1BQ1QsV0FBVztBQUFBLE1BQ1gsWUFBWTtBQUFBLElBQ2hCO0FBRUEsU0FBSyxlQUFlLEtBQUssSUFBSSxpQkFBaUIsYUFBVztBQUNyRCxjQUFRLFFBQVEsQ0FBQyxhQUFhO0FBQzFCLFlBQUksU0FBUyxTQUFTLGFBQWE7QUFDL0IsbUJBQVMsV0FBVyxRQUFRLE9BQUs7QUFDN0IsZ0JBQUksZUFBZSxLQUVkLEdBQUUsVUFBVSxTQUFTLGlCQUFpQixLQUFLLEtBQUssT0FBTyxTQUFTLHVCQUUxRCxFQUFFLFVBQVUsU0FBUyxzQkFBc0IsS0FBSyxLQUFLLE9BQU8sU0FBUyxrQkFBa0I7QUFDOUYsa0JBQUksV0FBVztBQUVmLGtCQUFJLEVBQUUsVUFBVSxTQUFTLHNCQUFzQixHQUFHO0FBQzlDLDJCQUFXO0FBQUEsY0FDZjtBQUNBLG1CQUFLLGdCQUFnQixHQUFrQixVQUFVLElBQUk7QUFDckQsbUJBQUssZ0JBQWdCLE1BQU0sR0FBa0IsUUFBUTtBQUFBLFlBQ3pEO0FBQUEsVUFDSixDQUFDO0FBQUEsUUFDTDtBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0wsQ0FBQyxDQUFDO0FBQ0YsZUFBSyxlQUFlLEtBQUssTUFBekIsbUJBQTRCLFFBQVEsSUFBSSxNQUFNO0FBQUEsRUFDbEQ7QUFBQSxFQUVBLEFBQVEsaUJBQWlCLGNBQXNCLFVBQWtCLGdCQUFnQixPQUFPO0FBQ3BGLFVBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixZQUFZO0FBQ3JFLFFBQUksT0FBTyxTQUFTLEdBQUc7QUFDbkIsZUFBUyxJQUFJLEdBQUcsSUFBSSxPQUFPLFFBQVEsS0FBSztBQUNwQyxjQUFNLFlBQVksT0FBTyxHQUFHLEtBQUs7QUFDakMsWUFBSSxlQUFlO0FBQ2YsZUFBSyx1QkFBdUIsZUFBZSxHQUFHLFdBQVcsUUFBUTtBQUFBLFFBQ3JFLE9BQ0s7QUFDRCxlQUFLLGdCQUFnQixlQUFlLEdBQUcsV0FBVyxRQUFRO0FBQUEsUUFDOUQ7QUFBQSxNQUNKO0FBQUEsSUFDSixXQUNTLE9BQU8sU0FBUztBQUFHO0FBQUEsU0FDdkI7QUFDRCxZQUFNLFlBQVksT0FBTyxHQUFHLEtBQUs7QUFDakMsV0FBSyxnQkFBZ0IsV0FBVyxVQUFVLFlBQVk7QUFDdEQsVUFBSSxlQUFlO0FBQ2YsYUFBSyx1QkFBdUIsY0FBYyxXQUFXLFFBQVE7QUFBQSxNQUNqRSxPQUNLO0FBQ0QsYUFBSyxnQkFBZ0IsY0FBYyxXQUFXLFFBQVE7QUFBQSxNQUMxRDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFRLGdCQUFnQixXQUF3QixVQUFrQixjQUE2QjtBQWhKbkc7QUFpSlEsVUFBTSxRQUFRLFVBQVUsUUFBUSxRQUFRO0FBQ3hDLGFBQVMsSUFBSSxHQUFHLElBQUksTUFBTSxRQUFRLEVBQUUsR0FBRztBQUNuQyxZQUFNLEtBQUssTUFBTTtBQUNqQixZQUFNLG1CQUFtQixlQUFHLGtCQUFILG1CQUFrQixRQUFRLGlCQUExQixtQkFBd0MsU0FBUztBQUMxRSxVQUFJLENBQUMsa0JBQWtCO0FBQ25CLGlDQUF5QixLQUFLLE9BQU8sS0FBSyxLQUFLLFFBQVEsSUFBSSxjQUFjLEVBQUU7QUFBQSxNQUMvRTtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFRLG9CQUFvQixXQUF3QixVQUFrQjtBQUNsRSxVQUFNLFFBQVEsVUFBVSxRQUFRLFFBQVE7QUFDeEMsYUFBUyxJQUFJLEdBQUcsSUFBSSxNQUFNLFFBQVEsRUFBRSxHQUFHO0FBQ25DLFlBQU0sS0FBSyxNQUFNO0FBQ2pCLDJCQUFxQixFQUFFO0FBQUEsSUFDM0I7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFRLGdCQUFnQixVQUF5QixXQUF3QixVQUFrQjtBQUN2RixRQUFJLFdBQVcsSUFBSSxpQkFBaUIsQ0FBQyxTQUFTLE1BQU07QUFDaEQsV0FBSyxnQkFBZ0IsV0FBVyxVQUFVLFFBQVE7QUFBQSxJQUN0RCxDQUFDO0FBQ0QsYUFBUyxRQUFRLFdBQVcsRUFBRSxTQUFTLE1BQU0sV0FBVyxNQUFNLFlBQVksTUFBTSxDQUFDO0FBQ2pGLFFBQUksVUFBVTtBQUNWLFdBQUssVUFBVSxLQUFLLENBQUMsVUFBVSxVQUFVLFFBQVEsQ0FBQztBQUFBLElBQ3REO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBUSx1QkFBdUIsVUFBa0IsV0FBd0IsVUFBa0IsV0FBVyxtQkFBbUIsZUFBZSxhQUFhO0FBR2pKLFFBQUksV0FBVyxJQUFJLGlCQUFpQixDQUFDLFNBQVMsTUFBTTtBQUNoRCxjQUFRLFFBQVEsQ0FBQyxhQUFhO0FBQzFCLFlBQUksU0FBUyxTQUFTLGFBQWE7QUFDL0IsbUJBQVMsV0FBVyxRQUFRLENBQUMsTUFBTTtBQUMvQixnQkFBSSxlQUFlLEdBQUc7QUFFbEIsa0JBQUksRUFBRSxVQUFVLFlBQVksT0FBTyxFQUFFLFVBQVUsYUFBYSxjQUFjLEVBQUUsVUFBVSxTQUFTLFlBQVksR0FBRztBQUMxRyxzQkFBTSxXQUFZLEVBQWtCLHVCQUF1QixRQUFRO0FBQ25FLHlCQUFTLElBQUksR0FBRyxJQUFJLFNBQVMsUUFBUSxFQUFFLEdBQUc7QUFDdEMsd0JBQU0sT0FBTyxTQUFTO0FBQ3RCLDJDQUF5QixLQUFLLE9BQU8sS0FBSyxLQUFLLFFBQVEsTUFBTSxVQUFVLEVBQUU7QUFBQSxnQkFDN0U7QUFBQSxjQUNKO0FBQUEsWUFDSjtBQUFBLFVBQ0osQ0FBQztBQUFBLFFBQ0w7QUFBQSxNQUNKLENBQUM7QUFBQSxJQUNMLENBQUM7QUFDRCxhQUFTLFFBQVEsV0FBVyxFQUFFLFNBQVMsTUFBTSxXQUFXLE1BQU0sWUFBWSxNQUFNLENBQUM7QUFDakYsU0FBSyxVQUFVLEtBQUssQ0FBQyxVQUFVLFVBQVUsUUFBUSxDQUFDO0FBQUEsRUFDdEQ7QUFBQSxFQUVBLGtCQUFrQjtBQUNkLFNBQUssb0JBQW9CO0FBQ3pCLFNBQUssbUJBQW1CLFFBQVE7QUFDaEMsU0FBSyxrQkFBa0I7QUFDdkIsdUJBQW1CLEtBQUssT0FBTyxLQUFLLEtBQUssTUFBTTtBQUFBLEVBQ25EO0FBQUEsRUFFQSxBQUFRLHNCQUFzQjtBQUMxQixTQUFLLFVBQVUsUUFBUSxDQUFDLENBQUMsVUFBVSxNQUFNLGVBQWU7QUFDcEQsZUFBUyxXQUFXO0FBQ3BCLFlBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixJQUFJO0FBQzdELGFBQU8sUUFBUSxVQUFRO0FBQ25CLGFBQUssb0JBQW9CLEtBQUssS0FBSyxhQUFhLFNBQVM7QUFBQSxNQUM3RCxDQUFDO0FBQUEsSUFDTCxDQUFDO0FBQ0QsZUFBVyxZQUFZLEtBQUssZ0JBQWdCO0FBQ3hDLGVBQVMsV0FBVztBQUFBLElBQ3hCO0FBQUEsRUFDSjtBQUFBLEVBRUEsV0FBaUI7QUFDYixTQUFLLG9CQUFvQjtBQUFBLEVBQzdCO0FBQ0o7OztBRzdOQSx3QkFBeUM7OztBQ0F6Qyx3QkFBOEI7QUFFOUIsSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBRWpCLFlBQ1csT0FBZSxJQUNmLEtBQWEsSUFDYixRQUFnQixJQUNoQixnQkFBd0IsSUFDakM7QUFKUztBQUNBO0FBQ0E7QUFDQTtBQUFBLEVBQ1A7QUFBQSxFQUdKLEFBQU8sV0FBVyxLQUFpQztBQUMvQyxRQUFJO0FBQ0EsYUFBUSxJQUFJLFNBQVMsTUFBTSxVQUFVLEtBQUssT0FBTyxFQUFHLEdBQUc7QUFBQSxJQUMzRCxTQUFTLE9BQVA7QUFDRSxVQUFJLHlCQUFPLG9CQUFvQixLQUFLLDRCQUE0QjtBQUNoRSxhQUFPLENBQUM7QUFBQSxJQUNaO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBTyxVQUFVLE1BQXNCO0FBRW5DLFVBQU0sV0FBVyxJQUFJLFFBQVEsUUFBUTtBQUVyQyxRQUFJLEtBQUssU0FBUyxzQ0FBVSxTQUFTLHFCQUFvQixzQ0FBVSxTQUFTLHlCQUF3QjtBQUNoRyxVQUFJO0FBQ0EsY0FBTSxZQUFZLEtBQUssV0FBVyxTQUFTLEdBQUcsRUFBRSxPQUFPLElBQUksQ0FBQyxNQUFXLEVBQUUsS0FBSyxJQUFJO0FBQ2xGLGVBQU8sVUFBVSxTQUFTLEtBQUssSUFBSTtBQUFBLE1BQ3ZDLFNBQVMsT0FBUDtBQUNFLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFDSixPQUFPO0FBQ0gsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUEsRUFFQSxPQUFPLGFBQWEsUUFBd0IsUUFBd0I7QUFDaEUsV0FBTyxLQUFLLE9BQU87QUFDbkIsV0FBTyxPQUFPLE9BQU87QUFDckIsV0FBTyxRQUFRLE9BQU87QUFDdEIsV0FBTyxnQkFBZ0IsT0FBTztBQUFBLEVBQ2xDO0FBQ0o7QUFFQSxJQUFPLHlCQUFROzs7QUN6Q1Isd0JBQXdCLFFBQXNCLFNBQWlCLElBQVU7QUFKaEY7QUFLSSxRQUFNLElBQUksT0FBTztBQUVqQixRQUFNLHFCQUF5QyxvQkFBSSxJQUFJO0FBQ3ZELEdBQUMsR0FBRyxFQUFFLGFBQWEsRUFBRSxRQUFRLENBQUMsQ0FBQyxZQUFZLFdBQVc7QUFDbEQsVUFBTSxzQkFBdUIsSUFBSSxTQUFTLE1BQU0sVUFBVSxNQUFNLFFBQVEsZUFBZSxFQUFHLEVBQUUsR0FBRyxHQUFHLEVBQUU7QUFDcEcsdUJBQW1CLElBQUksWUFBWSxtQkFBbUI7QUFBQSxFQUUxRCxDQUFDO0FBRUQsR0FBQyxHQUFHLEVBQUUsaUNBQWlDLEVBQUUsUUFBUSxDQUFDLENBQUMsVUFBVSxZQUFZO0FBQ3JFLFdBQU8sT0FBTyxXQUFTLE1BQU0sU0FBUyxxQkFBZ0IsRUFBRSxRQUFRLGlCQUFlO0FBRzNFLFlBQU0sc0JBQXNCLG1CQUFtQixJQUFJLEdBQUcsWUFBWSxpQkFBaUIsbUJBQW1CLFlBQVksTUFBTSxLQUFLLENBQUM7QUFFOUgsWUFBTSxxQkFBcUIsb0JBQW9CLE9BQU8sWUFBVTtBQUM1RCxjQUFNLGNBQWMsT0FBTyxZQUFZLFFBQVE7QUFDL0MsWUFBSSxNQUFNLFFBQVEsV0FBVyxHQUFHO0FBQzVCLGlCQUFPLFlBQVksT0FBTyxPQUFLLEVBQUUsR0FBRyxJQUFJLE1BQU0sT0FBTyxDQUFDLENBQUMsRUFBRSxJQUFJLE9BQUssRUFBRSxJQUFJLEVBQUUsU0FBUyxRQUFRO0FBQUEsUUFDL0YsT0FBTztBQUNILGlCQUFPLDRDQUFhLFVBQVM7QUFBQSxRQUNqQztBQUFBLE1BQ0osQ0FBQztBQUVELFlBQU0sbUJBQW1CLEdBQUcsc0JBQXNCLFlBQVksaUJBQWlCLG1CQUFtQixZQUFZO0FBQzlHLFlBQU0sMkJBQTJCLEVBQUUsZ0JBQWdCLElBQUksZ0JBQWdCO0FBQ3ZFLFFBQUUsZ0JBQWdCLElBQUksa0JBQWtCLGtCQUFrQjtBQUUxRCxVQUFJLENBQUUsR0FBRSx1QkFBdUIsSUFBSSxHQUFHLGFBQWEsWUFBWSxNQUFNLE1BQU07QUFBaUIsVUFBRSw4QkFBOEIsSUFBSSxrQkFBbUIsNkJBQTRCLG9CQUFvQixNQUFNO0FBRXpNLFFBQUUsdUJBQXVCLElBQUksR0FBRyxhQUFhLFlBQVksUUFBUSx1QkFBYztBQUFBLElBQ25GLENBQUM7QUFBQSxFQUNMLENBQUM7QUFFRCxXQUFTLE1BQU0sRUFBRSxnQkFBZ0IsS0FBSyxHQUFHO0FBQ3JDLFVBQU0sYUFBYSxXQUFDLG1FQUFrRTtBQUN0RixVQUFNLEVBQUUsVUFBVSxlQUFlLGNBQWMsVUFBRyxNQUFNLFVBQVUsTUFBbkIsbUJBQXNCLFdBQVUsQ0FBQztBQUNoRixVQUFNLDRDQUE0QyxRQUFFLFlBQy9DLElBQUksUUFBUSxNQURpQyxtQkFDOUIsS0FBSyxXQUNoQixNQUFNLFNBQVMsYUFFWCxPQUFNLGtCQUFrQixVQUFhLGtCQUFrQixpQkFDdkQsTUFBTSxrQkFBa0I7QUFHckMsVUFBTSxTQUFTLEVBQUUsR0FBRyxJQUFJLEtBQUssUUFBUTtBQUNyQyxRQUFJLFdBQVcsVUFBYSxPQUFPLGVBQWUsVUFBYSxDQUFDLDJDQUEyQztBQUN2RyxRQUFFLGdCQUFnQixPQUFPLEVBQUU7QUFDM0IsUUFBRSx5QkFBeUIsT0FBTyxFQUFFO0FBQ3BDLFFBQUUsOEJBQThCLE9BQU8sRUFBRTtBQUN6QyxRQUFFLDhCQUE4QixPQUFPLEVBQUU7QUFDekMsUUFBRSx1QkFBdUIsT0FBTyxHQUFHLGFBQWEsV0FBVztBQUFBLElBQy9EO0FBQUEsRUFDSjtBQUNKOzs7QUMxREEsd0JBQThCO0FBTzlCLHNCQUNJLFFBQ0EsZ0JBQ2E7QUFBQTtBQVhqQjtBQVlJLFVBQU0sU0FBUSxLQUFLLElBQUk7QUFFdkIsVUFBTSxJQUFJLE9BQU87QUFDakIsVUFBTSxRQUFRLGFBQU8sSUFBSSxRQUFRLFFBQVEsYUFBM0IsbUJBQXFDO0FBQ25ELFVBQU0sV0FBVyxpQkFBaUIsQ0FBQyxlQUFlLE1BQU0sSUFBSSxPQUFPLElBQUksTUFBTSxTQUFTLEVBQUUsT0FBTyxPQUFLLEVBQUUsY0FBYyxRQUFRO0FBRTVILFVBQU0sZ0JBQWdCLENBQUMsTUFBc0IsVUFBb0M7QUFDN0UsWUFBTSxFQUFFLEdBQUcsSUFBSSxHQUFHLElBQUksT0FBTyxJQUFJLFFBQVEsT0FBTztBQUNoRCxZQUFNLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSSxPQUFPLElBQUksUUFBUSxPQUFPO0FBQ2hELGFBQU8sTUFBTSxNQUFNLE1BQU0sTUFBTyxLQUFLLE1BQVEsS0FBSyxNQUFRLEtBQUssTUFBUSxLQUFLO0FBQUEsSUFDaEY7QUFFQSxVQUFNLGdCQUFnQixDQUNsQixXQUNBLE9BQ0EsU0FDbUI7QUFDbkIsY0FBUTtBQUFBLGFBQ0M7QUFDRCxpQkFBTyxNQUFNLE9BQU8sVUFBUSxLQUFLLFdBQVcsS0FBSyxFQUFFO0FBQUEsYUFDbEQ7QUFDRCxpQkFBTyxNQUFNLE9BQU8sVUFBUSxLQUFLLGFBQWEsS0FBSyxFQUFFO0FBQUEsYUFDcEQ7QUFDRCxpQkFBTyxNQUFNLE9BQU8sVUFBUSxLQUFLLGFBQWEsS0FBSyxNQUFNLEtBQUssV0FBVyxLQUFLLEVBQUU7QUFBQTtBQUVoRixpQkFBTyxDQUFDO0FBQUE7QUFBQSxJQUVwQjtBQUVBLFVBQU0sYUFBYSxDQUNmLFdBQ0EsTUFDQSxPQUNBLGdCQUNrQztBQUNsQyxjQUFRO0FBQUEsYUFDQztBQUNELGlCQUFPLE1BQU0sS0FBSyxVQUFRLEtBQUssT0FBTyxZQUFZLE1BQU0sS0FBSyxPQUFPLEtBQUssUUFBUTtBQUFBLGFBQ2hGO0FBQ0QsaUJBQU8sTUFBTSxLQUFLLFVBQVEsS0FBSyxPQUFPLFlBQVksTUFBTSxLQUFLLE9BQU8sS0FBSyxNQUFNO0FBQUEsYUFDOUU7QUFDRCxpQkFBTyxNQUFNLEtBQUssVUFBUSxLQUFLLE9BQU8sWUFBWSxNQUFPLE1BQUssT0FBTyxLQUFLLFVBQVUsS0FBSyxPQUFPLEtBQUssU0FBUztBQUFBO0FBRTlHLGlCQUFPO0FBQUE7QUFBQSxJQUVuQjtBQUVBLFVBQU0sMkJBQTJCLENBQzdCLE9BQ0EsZ0JBQ0EsT0FDQSxPQUNBLE1BQ0Esa0JBQ0M7QUFDRCxZQUFNLEVBQUUsWUFBWSxZQUFZLGVBQWUsYUFBYSxZQUFZLGtCQUFrQixjQUFjLE1BQU07QUFFOUcsWUFBTSxnQkFBc0MsbUJBQ3hDLElBQUksU0FBUyxNQUFNLFdBQVcsVUFBVSxrQkFBa0IsRUFBRSxPQUFPLE1BQU0sS0FBSyxjQUFjLENBQUMsSUFDN0Y7QUFDSixZQUFNLGdCQUFnQixjQUFjLFdBQVcsT0FBTyxJQUFJO0FBQzFELFlBQU0sWUFBWSxjQUFjLE9BQU8sVUFDbkMsQ0FBQyxjQUNFLFdBQVcsV0FBVyxLQUN0QixXQUFXLFNBQVMsS0FBSyxLQUFLLENBQ3JDLEVBRUssT0FBTyxVQUNKLENBQUMsY0FDRSxXQUFXLFdBQVcsS0FDdEIsQ0FBQyxLQUFLLFNBQVMsV0FBVyxTQUFTLEdBQUcsS0FDdEMsV0FBVyxTQUFTLEtBQUssS0FBSyxDQUNyQyxFQUVDLE9BQU8sVUFDSixDQUFDLGlCQUNFLGNBQWMsV0FBVyxLQUN6QixjQUFjLFNBQVMsS0FBSyxRQUFRLENBQzNDLEVBRUMsT0FBTyxVQUNKLENBQUMsZUFDRSxZQUFZLFdBQVcsS0FDdkIsWUFBWSxTQUFTLEtBQUssTUFBTSxDQUN2QyxFQUVDLElBQUksVUFBUSxXQUFXLFdBQVcsTUFBTSxPQUFPLElBQUksQ0FBQyxFQUVwRCxPQUFPLFdBQVEsQ0FBQyxDQUFDLFNBQVEsTUFBSyxTQUFTLE1BQU0sRUFFN0MsT0FBTyxDQUFDLFVBQ0wsQ0FBQyxjQUNFLFdBQVcsV0FBVyxLQUN0QixDQUFDLE1BQUssU0FBUyxXQUFXLFNBQVMsR0FBRyxLQUN0QyxXQUFXLFNBQVMsTUFBSyxLQUFLLENBQ3JDLEVBRUMsT0FBTyxDQUFDLFVBQXlCO0FBQzlCLGVBQU8sa0JBQWtCLFVBQWEsY0FBYyxJQUFJLENBQUMsT0FBVyxHQUFFLEtBQUssSUFBSSxFQUFFLFNBQVMsTUFBSyxJQUFJO0FBQUEsTUFDdkcsQ0FBQztBQUVMLFlBQU0sa0JBQWtCLENBQUMsR0FBRyxJQUFJLElBQUksVUFBVSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssTUFBTSxJQUFJLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQztBQUN4RixvQkFBYyxJQUNWLE1BQU0sTUFDTjtBQUFBLFFBQ0ksR0FBSSxjQUFjLElBQUksTUFBTSxJQUFJLEtBQUssQ0FBQztBQUFBLFFBQ3RDLEdBQUksZ0JBQ0MsT0FDRyxVQUFLO0FBeEg3QjtBQXdIZ0Msa0JBQUMsc0JBQ0osSUFBSSxNQUFNLElBQUksTUFEVixvQkFDYSxJQUFJLFdBQVEsTUFBSyxJQUNsQyxTQUFTLEtBQUs7QUFBQSxTQUN2QjtBQUFBLE1BRVIsQ0FDSjtBQUFBLElBQ0o7QUFFQSxVQUFNLHVCQUF1QixDQUFDLE9BQWMsY0FBaUMsU0FBeUI7QUFDbEcsWUFBTSxFQUFFLGFBQWEsZ0JBQWdCLE1BQU07QUFDM0MsWUFBTSxhQUFhLGFBQ2QsT0FBTyxXQUNKLENBQUMsZUFDRSxZQUFZLFdBQVcsS0FDdkIsQ0FBQyxNQUFNLFNBQVMsWUFBWSxTQUFTLEdBQUcsS0FDeEMsWUFBWSxTQUFTLE1BQU0sS0FBSyxDQUN2QyxFQUNDLE9BQU8sV0FDSixDQUFDLGVBQ0UsWUFBWSxXQUFXLEtBQ3ZCLFlBQVksU0FBUyxNQUFNLEtBQUssQ0FDdkMsRUFFQyxPQUFPLFdBQVMsY0FBYyxNQUFNLEtBQUssQ0FBQztBQUMvQyxhQUFPO0FBQUEsSUFDWDtBQUVBLFVBQU0sNEJBQTRCLENBQzlCLE9BQ0EsY0FDQSxNQUNBLDBCQUNDO0FBQ0QsWUFBTSxhQUFhLHFCQUFxQixPQUFPLGNBQWMsSUFBSTtBQUNqRSw0QkFBc0IsSUFDbEIsTUFBTSxNQUNOO0FBQUEsUUFDSSxHQUFJLHNCQUFzQixJQUFJLE1BQU0sSUFBSSxLQUFLLENBQUM7QUFBQSxRQUM5QyxHQUFJLFdBQ0MsT0FDRyxXQUFNO0FBaks5QjtBQWlLaUMsa0JBQUMsOEJBQ0wsSUFBSSxNQUFNLElBQUksTUFEVCxvQkFDWSxJQUFJLFlBQVMsT0FBTSxJQUNwQyxTQUFTLE1BQU07QUFBQSxTQUN4QjtBQUFBLE1BRVIsQ0FDSjtBQUFBLElBQ0o7QUFFQSxhQUFTLFFBQVEsQ0FBTSxXQUFVO0FBQzdCLFlBQU0scUJBQXFCLE9BQU8sV0FBVyxnQkFBZ0IsSUFBSSxPQUFPLElBQUksS0FBSyxDQUFDO0FBQ2xGLFlBQU0sb0JBQThCLENBQUM7QUFDckMsVUFBSSxFQUFFLE9BQU8sVUFBc0IsRUFBRSxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRTtBQUMxRCxZQUFNLGFBQWEsTUFBTSxPQUFPLElBQUksTUFBTSxLQUFLLE1BQU07QUFDckQsVUFBSSxZQUFZO0FBQ1osWUFBSTtBQUNBLGdCQUFNLGdCQUFnQixLQUFLLE1BQU0sVUFBVTtBQUMzQyxrQkFBUSxjQUFjO0FBQ3RCLGtCQUFRLGNBQWM7QUFBQSxRQUMxQixTQUFTLE9BQVA7QUFDRSxrQkFBUSxJQUFJLEtBQUs7QUFDakIsY0FBSSx5QkFBTyxpQkFBaUIsT0FBTyxNQUFNO0FBQUEsUUFDN0M7QUFBQSxNQUNKO0FBQ0EsWUFBTSxlQUFrQyxNQUFNLE9BQU8sVUFBUSxLQUFLLFNBQVMsT0FBTztBQUNsRixZQUFNLGVBSUQsb0JBQUksSUFBSTtBQUNiLFlBQU0sUUFBUSxDQUFNLFNBQVE7QUFDeEIsWUFBSSxLQUFLLFNBQVMsVUFBVSxPQUFPO0FBRS9CLGdCQUFNLEVBQUUsc0JBQXNCLHVCQUF1QiwrQkFDakQsYUFBYSxJQUFJLEtBQUssSUFBSSxLQUMxQjtBQUFBLFlBQ0ksdUJBQXVCLG9CQUFJLElBQStCO0FBQUEsWUFDMUQsc0JBQXNCLG9CQUFJLElBQThCO0FBQUEsWUFDeEQsNEJBQTRCLG9CQUFJLElBQThCO0FBQUEsVUFDbEU7QUFFSixnQkFBTSxpQkFBaUIsS0FBSztBQUM1QixjQUFJLENBQUMsa0JBQWtCLFNBQVMsY0FBYztBQUFHLDhCQUFrQixLQUFLLGNBQWM7QUFDdEYsZ0JBQU0sY0FBYSxFQUFFLFlBQVksSUFBSSxjQUFjO0FBQ25ELGdCQUFNLGNBQWMsMkNBQVksT0FBTyxXQUNuQyxNQUFNLFNBQVMseUJBQ1osTUFBTSxRQUFRLGVBQWUsT0FBTztBQUUzQyxnQkFBTSxlQUFlLDJDQUFZLE9BQU8sV0FDcEMsTUFBTSxTQUFTLG1DQUNaLE1BQU0sUUFBUSxlQUFlLE9BQU87QUFFM0MsZ0JBQU0sb0JBQW9CLDJDQUFZLE9BQU8sV0FDekMsTUFBTSxTQUFTLDJDQUNaLE1BQU0sUUFBUSxlQUFlLE9BQU87QUFHM0MscURBQWEsUUFBUSxXQUFTO0FBQzFCLHFDQUF5QixPQUFPLGdCQUFnQixPQUFPLE9BQU8sTUFBTSxvQkFBb0I7QUFBQSxVQUM1RjtBQUNBLHVEQUFjLFFBQVEsV0FBUztBQUMzQixzQ0FBMEIsT0FBTyxjQUFjLE1BQU0scUJBQXFCO0FBQUEsVUFDOUU7QUFDQSxpRUFBbUIsUUFBUSxXQUFTO0FBRWhDLGtCQUFNLGFBQWEscUJBQXFCLE9BQU8sY0FBYyxJQUFJO0FBRWpFLHVCQUFXLFFBQVEsV0FBUTtBQUN2Qix1Q0FBeUIsT0FBTyxnQkFBZ0IsT0FBTyxPQUFPLE9BQU0sMEJBQTBCO0FBQUEsWUFDbEcsQ0FBQztBQUNELGdCQUFJLFdBQVcsV0FBVyxHQUFHO0FBQ3pCLHlDQUEyQixJQUN2QixNQUFNLE1BQ04sQ0FBQyxHQUFJLDJCQUEyQixJQUFJLE1BQU0sSUFBSSxLQUFLLENBQUMsQ0FBRSxDQUMxRDtBQUFBLFlBQ0o7QUFBQSxVQUVKO0FBQ0EsdUJBQWEsSUFBSSxLQUFLLE1BQU07QUFBQSxZQUN4QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsVUFDSixDQUFDO0FBQUEsUUFDTDtBQUFBLE1BQ0osRUFBQztBQUVELG1CQUFhLFFBQVEsQ0FBTyxJQUE2RSxPQUFhLGVBQTFGLElBQTZFLEtBQWEsV0FBMUYsRUFBRSxzQkFBc0IsdUJBQXVCLDhCQUE4QixVQUFhO0FBQ2xILGNBQU0sT0FBTyxJQUFJLE1BQU0sc0JBQXNCLFFBQVE7QUFDckQsWUFBSSxRQUFRLGdCQUFnQix5QkFBTztBQUMvQixnQkFBTSxVQUF5QixDQUFDO0FBQ2hDLCtCQUFxQixRQUFRLENBQUMsV0FBVyxTQUFTO0FBQzlDLGtCQUFNLFNBQVMsVUFBVSxJQUFJLENBQUMsU0FBeUIsY0FBYSxrQkFBa0IsUUFBUSxNQUFNLEtBQUssTUFBTSxLQUFLLE9BQU8sQ0FBQztBQUM1SCxvQkFBUSxLQUFLLEVBQUUsTUFBWSxTQUFTLEVBQUUsT0FBTyxTQUFTLENBQUMsR0FBSSxJQUFJLElBQUksTUFBTSxDQUFFLEVBQUUsS0FBSyxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7QUFBQSxVQUNuRyxDQUFDO0FBQ0QsZ0NBQXNCLFFBQVEsQ0FBQyxZQUFZLFNBQVM7QUFDaEQsa0JBQU0sU0FBUyxXQUFXLElBQUksQ0FBQyxVQUEyQixNQUFNLEtBQUs7QUFDckUsb0JBQVEsS0FBSyxFQUFFLE1BQVksU0FBUyxFQUFFLE9BQU8sU0FBUyxDQUFDLEdBQUksSUFBSSxJQUFJLE9BQU8sT0FBTyxPQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBRSxFQUFFLEtBQUssR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDO0FBQUEsVUFDcEgsQ0FBQztBQUNELHFDQUEyQixRQUFRLENBQUMsV0FBVyxTQUFTO0FBQ3BELGtCQUFNLFNBQVMsVUFBVSxJQUFJLENBQUMsU0FBeUIsY0FBYSxrQkFBa0IsUUFBUSxNQUFNLEtBQUssTUFBTSxLQUFLLE9BQU8sQ0FBQztBQUM1SCxvQkFBUSxLQUFLLEVBQUUsTUFBWSxTQUFTLEVBQUUsT0FBTyxTQUFTLENBQUMsR0FBSSxJQUFJLElBQUksTUFBTSxDQUFFLEVBQUUsS0FBSyxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7QUFBQSxVQUNuRyxDQUFDO0FBQ0QsY0FBSSxRQUFRO0FBQVEsa0JBQU0sV0FBVyxRQUFRLFNBQVMsSUFBSTtBQUFBLFFBQzlEO0FBQUEsTUFDSixFQUFDO0FBR0QseUJBQW1CLE9BQU8sUUFBSyxDQUFDLGtCQUFrQixTQUFTLEVBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBTSxhQUFZO0FBNVFqRztBQTZRWSxjQUFNLGFBQWEsSUFBSSxNQUFNLHNCQUFzQixRQUFRO0FBQzNELFlBQUksY0FBYyxzQkFBc0IseUJBQU87QUFDM0MsZ0JBQU0sVUFBeUIsQ0FBQztBQUVoQyxnQkFBTSxlQUFlLFNBQUUsWUFBWSxJQUFJLFFBQVEsTUFBMUIsb0JBQTZCLE9BQU8sV0FDckQsTUFBTSxTQUFTLHlCQUNaLE1BQU0sUUFBUSxlQUFlLE9BQU87QUFFM0MsdURBQWMsUUFBUSxXQUFTO0FBQUUsb0JBQVEsS0FBSyxFQUFFLE1BQU0sTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQUEsVUFBRTtBQUU1RixnQkFBTSxvQkFBb0IsUUFBRSxZQUFZLElBQUksUUFBUSxNQUExQixtQkFBNkIsT0FBTyxXQUMxRCxNQUFNLFNBQVMsbUNBQ1osTUFBTSxRQUFRLGVBQWUsT0FBTztBQUUzQyxpRUFBbUIsUUFBUSxXQUFTO0FBQUUsb0JBQVEsS0FBSyxFQUFFLE1BQU0sTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQUEsVUFBRTtBQUVqRyxnQkFBTSx5QkFBeUIsUUFBRSxZQUFZLElBQUksUUFBUSxNQUExQixtQkFBNkIsT0FBTyxXQUMvRCxNQUFNLFNBQVMsMkNBQ1osTUFBTSxRQUFRLGVBQWUsT0FBTztBQUUzQywyRUFBd0IsUUFBUSxXQUFTO0FBQUUsb0JBQVEsS0FBSyxFQUFFLE1BQU0sTUFBTSxNQUFNLFNBQVMsRUFBRSxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQUEsVUFBRTtBQUN0RyxjQUFJLFFBQVE7QUFBUSxrQkFBTSxXQUFXLFFBQVEsU0FBUyxVQUFVO0FBQUEsUUFDcEU7QUFBQSxNQUNKLEVBQUM7QUFDRCxhQUFPLFdBQVcsZ0JBQWdCLElBQUksT0FBTyxNQUFNLGlCQUFpQjtBQUFBLElBQ3hFLEVBQUM7QUFBQSxFQUNMO0FBQUE7OztBSHhSQSxJQUFxQixhQUFyQixjQUF3Qyw0QkFBVTtBQUFBLEVBa0M5QyxZQUFvQixRQUE2QixjQUE2QixVQUFzQjtBQUNoRyxVQUFNO0FBRFU7QUFBNkI7QUFBNkI7QUFOOUUsU0FBTyxjQUF1QjtBQUM5QixTQUFPLFVBQW1CO0FBRTFCLFNBQU8sb0JBQTZCO0FBS2hDLFNBQUssV0FBVztBQUNoQixTQUFLLGtCQUFrQixvQkFBSSxJQUFJO0FBQy9CLFNBQUssMkJBQTJCLG9CQUFJLElBQUk7QUFDeEMsU0FBSyx5QkFBeUIsb0JBQUksSUFBSTtBQUN0QyxTQUFLLDBCQUEwQixvQkFBSSxJQUFJO0FBQ3ZDLFNBQUssZ0NBQWdDLG9CQUFJLElBQUk7QUFDN0MsU0FBSyxnQ0FBZ0Msb0JBQUksSUFBSTtBQUM3QyxTQUFLLDRCQUE0QixvQkFBSSxJQUFJO0FBQ3pDLFNBQUssa0JBQWtCLG9CQUFJLElBQUk7QUFDL0IsU0FBSyxLQUFLLEtBQUssT0FBTyxJQUFJLFFBQVEsUUFBUTtBQUMxQyxTQUFLLGlCQUFpQixPQUFPLFNBQVM7QUFBQSxFQUMxQztBQUFBLEVBRUEsQUFBTSxTQUF3QjtBQUFBO0FBaEVsQztBQWtFUSxXQUFLLFdBQVcsS0FBSyxJQUFJO0FBQ3pCLFlBQU8sT0FBWTtBQUFBLE1BQUUsSUFBRztBQUV4QixVQUFJLFdBQUssT0FBTCxtQkFBUyxJQUFJLE1BQU0sYUFBYTtBQUNoQyxhQUFLLEtBQUssS0FBSyxPQUFPLElBQUksUUFBUSxRQUFRO0FBQzFDLGFBQUssZUFBZSxLQUFLLEdBQUcsSUFBSSxNQUFNO0FBQ3RDLGFBQUssVUFBVTtBQUNmLGNBQU0sS0FBSyxVQUFVLGlCQUFpQixLQUFLO0FBQUEsTUFDL0M7QUFFQSxXQUFLLGNBQ0QsS0FBSyxPQUFPLElBQUksY0FBYyxHQUFHLHdCQUF3QixNQUFZO0FBQ2pFLGFBQUssS0FBSyxLQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVE7QUFDMUMsYUFBSyxVQUFVO0FBQ2YsY0FBTSxLQUFLLFVBQVUsWUFBWSxLQUFLO0FBQ3RDLGFBQUssZUFBZSxLQUFLLEdBQUcsSUFBSSxNQUFNO0FBQUEsTUFDMUMsRUFBQyxDQUNMO0FBRUEsV0FBSyxjQUNELEtBQUssT0FBTyxJQUFJLGNBQWMsR0FBRyxZQUFZLE1BQVk7QUF0RnJFO0FBd0ZnQixZQUFJLEtBQUssT0FBTyxJQUFJLGNBQWMsd0JBQXdCLEdBQUc7QUFDekQsZUFBSyxjQUFjO0FBQ25CLGdCQUFNLEtBQUssVUFBVSxrQkFBa0IsT0FBTyxJQUFJO0FBQ2xELGVBQUssZUFBZSxhQUFLLE9BQUwsb0JBQVMsSUFBSSxNQUFNLGFBQVk7QUFBQSxRQUN2RDtBQUFBLE1BQ0osRUFBQyxDQUNMO0FBRUEsV0FBSyxjQUNELEtBQUssT0FBTyxJQUFJLE1BQU0sR0FBRyxVQUFVLENBQU8sU0FBUztBQUUvQyxZQUFJLGdCQUFnQiwyQkFBUyxLQUFLLGNBQWMsVUFBVTtBQUN0RCxnQkFBTSxhQUFhLEtBQUssUUFBUSxFQUFFLFFBQVEsS0FBSyxDQUFDO0FBQUEsUUFDcEQ7QUFBQSxNQUNKLEVBQUMsQ0FDTDtBQUVBLFdBQUssY0FDRCxLQUFLLE9BQU8sSUFBSSxjQUFjLEdBQUcsNEJBQTRCLENBQU8sSUFBUyxTQUFnQjtBQTFHekc7QUE2R2dCLFlBQUksT0FBTyxZQUlKLEtBQUssT0FBTyxJQUFJLGNBQWMsVUFBVSxLQUFLLE1BQU0sU0FBUyxLQUFLLFlBQ2pFLGFBQUssT0FBTCxvQkFBUyxJQUFJLE1BQU0sY0FBYSxLQUFLLGdCQUNyQyxLQUFLLGVBQ0wsS0FBSyxTQUNWO0FBRUUsd0NBQThCLEtBQUssTUFBTTtBQUN6QyxlQUFLLHFDQUFxQyxJQUFJO0FBQzlDLGNBQUksS0FBSyxrQkFBa0IsS0FBSyxLQUFLLFdBQVcsS0FBSyxjQUFjLEdBQUc7QUFDbEUsa0JBQU0sS0FBSyxVQUFVLG1CQUFtQjtBQUN4QyxrQkFBTSxnQkFBZ0IsV0FBSyxnQkFBZ0IsSUFBSSxLQUFLLElBQUksTUFBbEMsbUJBQXFDO0FBQzNELGtCQUFNLGVBQWdCLGlCQUFpQixZQUFLLGtCQUFrQixJQUFJLGFBQWEsTUFBeEMsbUJBQTJDLE9BQU8sV0FBUyxNQUFNLFNBQVMsMkJBQXNCLENBQUM7QUFDeEkseUJBQWEsUUFBUSxDQUFNLFVBQVM7QUFDaEMsb0JBQU0sYUFBYSxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixNQUFNLFFBQVEsVUFBVTtBQUN2RixrQkFBSSxzQkFBc0IsMkJBQVMsV0FBVyxjQUFjLFVBQVU7QUFDbEUsc0JBQU0sYUFBYSxLQUFLLFFBQVEsRUFBRSxRQUFRLFdBQVcsQ0FBQztBQUFBLGNBQzFEO0FBQUEsWUFDSixFQUFDO0FBQUEsVUFDTCxPQUFPO0FBQ0gsa0JBQU0sS0FBSyxlQUFlLEtBQUs7QUFDL0IsaUJBQUssZUFBZSxLQUFLO0FBQ3pCLGtCQUFNLGdCQUFnQixVQUFVLHlCQUF5QixLQUFLLFFBQVEsS0FBSyxJQUFJO0FBQy9FLGtCQUFNLEtBQUssY0FBYyxlQUFlLE9BQU8sS0FBSztBQUFBLFVBQ3hEO0FBQ0EsZUFBSyxlQUFlLEtBQUssR0FBRyxJQUFJLE1BQU07QUFBQSxRQUMxQztBQUFBLE1BQ0osRUFBQyxDQUNMO0FBQ0EsV0FBSyxPQUFPLElBQUksVUFBVSxRQUFRLHVCQUF1QjtBQUFBLElBQzdEO0FBQUE7QUFBQSxFQUdBLEFBQVEsYUFBYTtBQUNqQixTQUFLLGNBQWMsb0JBQUksSUFBSTtBQUMzQixTQUFLLGdDQUFnQyxvQkFBSSxJQUFJO0FBQzdDLFNBQUssb0NBQW9DLG9CQUFJLElBQUk7QUFDakQsU0FBSyxvQkFBb0Isb0JBQUksSUFBSTtBQUNqQyxTQUFLLDRCQUE0QixDQUFDO0FBQ2xDLFNBQUssc0JBQXNCLG9CQUFJLElBQUk7QUFDbkMsU0FBSyxrQ0FBa0Msb0JBQUksSUFBSTtBQUMvQyxTQUFLLGtDQUFrQyxvQkFBSSxJQUFJO0FBQy9DLFNBQUssa0JBQWtCLG9CQUFJLElBQUk7QUFDL0IsU0FBSyxrQkFBa0Isb0JBQUksSUFBSTtBQUMvQixTQUFLLHVCQUF1QixvQkFBSSxJQUFJO0FBQ3BDLFNBQUssMkJBQTJCLG9CQUFJLElBQUk7QUFDeEMsU0FBSywwQkFBMEIsb0JBQUksSUFBSTtBQUN2QyxTQUFLLG1CQUFtQixvQkFBSSxJQUFJO0FBQ2hDLFNBQUssd0JBQXdCLG9CQUFJLElBQUk7QUFDckMsU0FBSyxnQkFBZ0Isb0JBQUksSUFBSTtBQUFBLEVBQ2pDO0FBQUEsRUFFQSxBQUFNLFVBQVUsT0FBZSxtQkFBbUIsT0FBTyxrQkFBa0IsT0FBc0I7QUFBQTtBQUU3RixVQUFJLFNBQVEsS0FBSyxJQUFJLEdBQUcsT0FBTyxLQUFLLElBQUk7QUFDeEMsV0FBSyxXQUFXO0FBQ2hCLFdBQUssd0JBQXdCO0FBQzdCLFdBQUssbUJBQW1CO0FBQ3hCLFdBQUssZUFBZTtBQUNwQixXQUFLLGlCQUFpQjtBQUN0QixXQUFLLDZCQUE2QjtBQUNsQyxXQUFLLHdCQUF3QjtBQUM3QixXQUFLLDRCQUE0QjtBQUNqQyxXQUFLLGVBQWU7QUFDcEIsV0FBSyxxQ0FBcUM7QUFDMUMsWUFBTSxLQUFLLGlCQUFpQjtBQUM1QixZQUFNLEtBQUssNEJBQTRCO0FBQ3ZDLFdBQUssZUFBZSxlQUFlO0FBQ25DLFlBQU0sS0FBSyxjQUFjLGNBQWMsaUJBQWlCLGdCQUFnQjtBQUN4RSxVQUFJLG9CQUFvQixDQUFDLEtBQUs7QUFBbUIsY0FBTSxLQUFLLGVBQWUsZ0JBQWdCO0FBQzNGLFdBQUssb0JBQW9CO0FBQ3pCLFdBQUssT0FBTyxJQUFJLFVBQVUsUUFBUSw2QkFBNkI7QUFBQSxJQUVuRTtBQUFBO0FBQUEsRUFFQSxlQUFlLGlCQUFnQztBQUMzQyxRQUFJLENBQUM7QUFBaUIscUJBQWUsS0FBSyxNQUFNO0FBQUEsRUFDcEQ7QUFBQSxFQUVBLEFBQU0sbUJBQWtDO0FBQUE7QUFDcEMsWUFBTSxXQUFXLEtBQUssT0FBTyxJQUFJLE1BQU0sU0FBUyxFQUFFLE9BQU8sT0FBSyxFQUFFLGNBQWMsUUFBUTtBQUN0RixlQUFTLFFBQVEsQ0FBTSxXQUFVO0FBQzdCLGNBQU0sb0JBQThCLENBQUM7QUFDckMsWUFBSSxFQUFFLE9BQU8sVUFBc0IsRUFBRSxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRTtBQUMxRCxjQUFNLGFBQWEsTUFBTSxLQUFLLE9BQU8sSUFBSSxNQUFNLEtBQUssTUFBTTtBQUMxRCxZQUFJLFlBQVk7QUFDWixjQUFJO0FBQ0Esa0JBQU0sZ0JBQWdCLEtBQUssTUFBTSxVQUFVO0FBQzNDLG9CQUFRLGNBQWM7QUFDdEIsb0JBQVEsY0FBYztBQUFBLFVBQzFCLFNBQVMsT0FBUDtBQUNFLG9CQUFRLElBQUksS0FBSztBQUNqQixnQkFBSSx5QkFBTyxpQkFBaUIsT0FBTyxNQUFNO0FBQUEsVUFDN0M7QUFBQSxRQUNKO0FBQ0EsdUNBQU8sUUFBUSxDQUFNLFNBQVE7QUFDekIsY0FBSSxLQUFLLFNBQVMsUUFBUTtBQUN0QixrQkFBTSxpQkFBaUIsS0FBSztBQUM1QixnQkFBSSxDQUFDLGtCQUFrQixTQUFTLGNBQWM7QUFBRyxnQ0FBa0IsS0FBSyxjQUFjO0FBQUEsVUFDMUY7QUFBQSxRQUNKO0FBQ0EsYUFBSyxnQkFBZ0IsSUFBSSxPQUFPLE1BQU0saUJBQWlCO0FBQUEsTUFDM0QsRUFBQztBQUFBLElBQ0w7QUFBQTtBQUFBLEVBRUEsQUFBTSxjQUFjLFNBQWlCLElBQUksaUJBQTBCLGtCQUEwQztBQUFBO0FBQ3pHLFVBQUksQ0FBQyxpQkFBaUI7QUFDbEIsWUFBSSxrQkFBa0I7QUFDbEIsZ0JBQU0sY0FBYyxLQUFLLFFBQVEsUUFBUSxRQUFXLElBQUk7QUFBQSxRQUM1RCxPQUFPO0FBQ0gsZ0JBQU0sY0FBYyxLQUFLLFFBQVEsTUFBTTtBQUFBLFFBQzNDO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFBQTtBQUFBLEVBRUEsQUFBTSxlQUFlLGtCQUEwQztBQUFBO0FBQzNELFlBQU0sZUFBZSxLQUFLLFFBQVEsUUFBVyxnQkFBZ0I7QUFBQSxJQUNqRTtBQUFBO0FBQUEsRUFFQSxBQUFNLDhCQUE2QztBQUFBO0FBQy9DLFdBQUssZ0JBQWdCLFFBQVEsQ0FBQyxjQUFjO0FBQ3hDLGtCQUFVLFdBQVcsUUFBUSxDQUFNLFNBQVE7QUFDdkMsY0FBSSxPQUFPLEtBQUssWUFBWSxZQUFZLENBQUMsQ0FBRSxLQUFLLFFBQWdDLHVCQUF1QjtBQUNuRyxpQkFBSyx5QkFBeUIsSUFDekIsS0FBSyxRQUFnQyxvQkFDdEMsTUFBTSxhQUFhLHNCQUNmLEtBQUssUUFDSixLQUFLLFFBQWdDLGtCQUMxQyxDQUNKO0FBQUEsVUFDSjtBQUFBLFFBQ0osRUFBQztBQUFBLE1BQ0wsQ0FBQztBQUNELFdBQUssT0FBTyxTQUFTLGFBQWEsUUFBUSxDQUFNLFlBQVc7QUFDdkQsWUFBSSxRQUFRLFFBQVEsb0JBQW9CO0FBQ3BDLGVBQUsseUJBQXlCLElBQzFCLFFBQVEsUUFBUSxvQkFDaEIsTUFBTSxhQUFhLHNCQUNmLEtBQUssUUFDTCxRQUFRLFFBQVEsa0JBQ3BCLENBQ0o7QUFBQSxRQUNKO0FBQUEsTUFDSixFQUFDO0FBQUEsSUFDTDtBQUFBO0FBQUEsRUFFQSwwQkFBZ0M7QUFDNUIsVUFBTSxpQkFBaUIsS0FBSyxPQUFPLFNBQVM7QUFFNUMsUUFBSSxnQkFBZ0I7QUFDaEIsV0FBSyxPQUFPLElBQUksTUFBTSxpQkFBaUIsRUFDbEMsT0FBTyxPQUFLLEVBQUUsS0FBSyxTQUFTLGNBQWMsQ0FBQyxFQUMzQyxRQUFRLE9BQUs7QUF4UTlCO0FBeVFvQixjQUFNLGdCQUFnQixVQUFVLHlCQUF5QixLQUFLLFFBQVEsRUFBRSxJQUFJO0FBQzVFLFlBQUksZUFBZTtBQUNmLGdCQUFNLFNBQVMsaUJBQUssT0FBTyxJQUFJLGNBQWMsYUFBYSxDQUFDLE1BQTVDLG1CQUErQyxnQkFBL0MsbUJBQTREO0FBQzNFLGNBQUksUUFBUTtBQUNSLGtCQUFNLGFBQWEsS0FBSyxPQUFPLElBQUksTUFBTSxzQkFBc0IsR0FBRyxpQkFBaUIsV0FBVztBQUM5RixnQkFBSSxZQUFZO0FBQ1osbUJBQUsscUJBQXFCLElBQUksZUFBZSxDQUFDLE1BQU0sQ0FBQztBQUFBLFlBQ3pELE9BQU87QUFDSCxtQkFBSyxxQkFBcUIsSUFBSSxlQUFlLENBQUMsQ0FBQztBQUFBLFlBQ25EO0FBQUEsVUFDSixPQUFPO0FBQ0gsaUJBQUsscUJBQXFCLElBQUksZUFBZSxDQUFDLENBQUM7QUFBQSxVQUNuRDtBQUFBLFFBQ0o7QUFBQSxNQUNKLENBQUM7QUFBQSxJQUNUO0FBRUEsS0FBQyxHQUFHLEtBQUssb0JBQW9CLEVBQUUsUUFBUSxDQUFDLENBQUMsZUFBZSxlQUFlO0FBQ25FLFVBQUksVUFBVSxTQUFTLEdBQUc7QUFDdEIsYUFBSyx3QkFBd0IsYUFBYTtBQUFBLE1BQzlDO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUFBLEVBR0Esd0JBQXdCLGVBQXVCO0FBbFNuRDtBQW1TUSxVQUFNLFlBQVksS0FBSyxxQkFBcUIsSUFBSSxhQUFhO0FBQzdELFFBQUksYUFBYSxVQUFVLFFBQVE7QUFDL0IsWUFBTSxlQUFlLFVBQVUsS0FBSztBQUNwQyxZQUFNLHFCQUFxQixXQUFLLHFCQUFxQixJQUFJLFlBQWEsTUFBM0MsbUJBQStDO0FBQzFFLFVBQUksc0JBQXNCLHVCQUF1QixlQUFlO0FBQzVELGFBQUsscUJBQXFCLElBQUksZUFBZSxDQUFDLEdBQUcsV0FBVyxrQkFBa0IsQ0FBQztBQUMvRSxhQUFLLHdCQUF3QixhQUFhO0FBQUEsTUFDOUM7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEscUJBQTJCO0FBQ3ZCLFVBQU0sa0JBQWtCLEtBQUssT0FBTyxTQUFTO0FBQzdDLFFBQUksQ0FBQyxpQkFBaUI7QUFDbEIsV0FBSyw0QkFBNEIsQ0FBQztBQUFBLElBQ3RDLE9BQU87QUFDSCxVQUFJO0FBQ0EsYUFBSyw0QkFBNEIsVUFDNUIsZ0JBQ0csS0FBSyxRQUNMLGVBQWUsRUFDbEIsV0FBVyxJQUFJLFVBQVEsS0FBSyxTQUFTLENBQUM7QUFBQSxNQUMvQyxTQUFTLE9BQVA7QUFBQSxNQUFnQjtBQUFBLElBQ3RCO0FBQUEsRUFDSjtBQUFBLEVBRUEsaUJBQXVCO0FBQ25CLFVBQU0saUJBQWlCLEtBQUs7QUFDNUIsUUFBSSxnQkFBZ0I7QUFDaEIsV0FBSyxPQUFPLElBQUksTUFBTSxpQkFBaUIsRUFDbEMsT0FBTyxPQUFLLEVBQUUsS0FBSyxTQUFTLGNBQWMsQ0FBQyxFQUMzQyxRQUFRLE9BQUs7QUFsVTlCO0FBbVVvQixjQUFNLGdCQUFnQixVQUFVLHlCQUF5QixLQUFLLFFBQVEsRUFBRSxJQUFJO0FBQzVFLFlBQUksZUFBZTtBQUNmLGNBQUk7QUFDQSxrQkFBTSxZQUFZLFVBQVUsZ0JBQWdCLEtBQUssUUFBUSxhQUFhO0FBQ3RFLGlCQUFLLGtCQUFrQixJQUNuQixlQUNBLFVBQVUsV0FBVyxJQUFJLFVBQVEsS0FBSyxTQUFTLENBQUMsQ0FDcEQ7QUFDQSxpQkFBSyxnQkFBZ0IsSUFBSSxFQUFFLE1BQU0sU0FBUztBQUMxQyxpQkFBSyxnQkFBZ0IsSUFBSSxVQUFVLE1BQU0sU0FBUztBQUNsRCxrQkFBTSxRQUFRLEtBQUssT0FBTyxJQUFJLGNBQWMsYUFBYSxDQUFDO0FBQzFELGdCQUFJLHFDQUFPLGdCQUFQLG1CQUFvQixZQUFZO0FBQ2hDLGtCQUFJLHFDQUFPLGdCQUFQLG1CQUFvQixVQUFVO0FBQzlCLHNCQUFNLFlBQVkscUNBQU8sZ0JBQVAsbUJBQW9CO0FBQ3RDLHNCQUFNLFdBQVcsTUFBTSxRQUFRLFNBQVMsSUFBSSxDQUFDLEdBQUcsU0FBUyxJQUFJLFVBQVUsTUFBTSxHQUFHLEVBQUUsSUFBSSxPQUFLLEVBQUUsS0FBSyxDQUFDO0FBQ25HLHlCQUFTLFFBQVEsU0FBTztBQUNwQixzQkFBSSxDQUFDLElBQUksU0FBUyxHQUFHLEdBQUc7QUFDcEIseUJBQUssd0JBQXdCLElBQUksS0FBSyxTQUFTO0FBQUEsa0JBQ25EO0FBQUEsZ0JBQ0osQ0FBQztBQUFBLGNBQ0wsV0FBVyxDQUFDLGNBQWMsU0FBUyxHQUFHLEdBQUc7QUFDckMscUJBQUssd0JBQXdCLElBQUksZUFBZSxTQUFTO0FBQUEsY0FDN0Q7QUFBQSxZQUNKO0FBQUEsVUFDSixTQUFTLE9BQVA7QUFBQSxVQUVGO0FBQUEsUUFDSjtBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ1Q7QUFBQSxFQUNKO0FBQUEsRUFFQSxtQkFBeUI7QUFDckIsU0FBSyxPQUFPLFNBQVMsYUFBYSxPQUFPLFdBQVMsTUFBTSxTQUFTLHFCQUFnQixFQUFFLFFBQVEsV0FBUztBQUNoRyxXQUFLLGNBQWMsSUFBSSxpQkFBaUIsTUFBTSxRQUFRLEtBQUs7QUFBQSxJQUMvRCxDQUFDO0FBQ0QsS0FBQyxHQUFHLEtBQUssaUJBQWlCLEVBQUUsUUFBUSxDQUFDLENBQUMsZUFBZSxZQUFZO0FBQzdELGFBQU8sT0FBTyxXQUFTLE1BQU0sU0FBUyxxQkFBZ0IsRUFBRSxRQUFRLFdBQVM7QUFDckUsYUFBSyxjQUFjLElBQUksR0FBRyxtQkFBbUIsTUFBTSxRQUFRLEtBQUs7QUFBQSxNQUNwRSxDQUFDO0FBQUEsSUFDTCxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsK0JBQXFDO0FBQ2pDLFFBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyx1QkFBdUIsRUFBRTtBQUFRO0FBRS9DLFVBQU0sYUFBYSxDQUFDLEdBQUcsS0FBSyx3QkFBd0IsS0FBSyxDQUFDO0FBQzFELFVBQU0sMEJBQTBCLFdBQVcsSUFBSSxPQUFLLElBQUksR0FBRyxFQUFFLEtBQUssTUFBTTtBQUN4RSxTQUFLLEdBQUcsSUFBSSxNQUFNLHVCQUF1QixFQUFFLFFBQVEsQ0FBQyxXQUFnQjtBQUNoRSxhQUFPLEtBQUssS0FBSyxRQUFRLENBQUMsU0FBaUI7QUFDdkMsY0FBTSxNQUFNLEtBQUssUUFBUSxPQUFPLEVBQUU7QUFDbEMsY0FBTSxZQUFZLEtBQUssd0JBQXdCLElBQUksR0FBRztBQUN0RCxjQUFNLFdBQVcsT0FBTyxLQUFLO0FBQzdCLFlBQUksV0FBVztBQUNYLGVBQUssaUJBQWlCLElBQUksVUFBVSxDQUFDLEdBQUcsb0JBQUksSUFBSSxDQUFDLEdBQUksS0FBSyxpQkFBaUIsSUFBSSxRQUFRLEtBQUssQ0FBQyxHQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDN0csZUFBSyxzQkFBc0IsSUFBSSxPQUFPLEtBQUssTUFBTSxDQUFDLEdBQUcsb0JBQUksSUFBSSxDQUFDLEdBQUksS0FBSyxzQkFBc0IsSUFBSSxRQUFRLEtBQUssQ0FBQyxHQUFJLFVBQVUsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUVwSSxnQkFBTSwrQkFBK0IsS0FBSyxrQkFBa0IsSUFBSSxVQUFVLElBQUk7QUFDOUUsZ0JBQU0sZ0JBQWdCLEtBQUssb0JBQW9CLElBQUksUUFBUTtBQUUzRCxjQUFJLDhCQUE4QjtBQUM5QixrQkFBTSxZQUFZLENBQUMsR0FBRyw0QkFBNEI7QUFDbEQsa0JBQU0sd0JBQXdCLGdEQUFlLE9BQU8sV0FBTTtBQWpZbEY7QUFrWTRCLHNCQUFDLFVBQVUsSUFBSSxPQUFLLEVBQUUsSUFBSSxFQUFFLFNBQVMsTUFBTSxJQUFJLEtBQy9DLENBQUMsdUJBQVUsWUFBVixtQkFBbUIsYUFBbkIsbUJBQTZCLElBQUksVUFBUSxLQUFLLE1BQU0sU0FBUyxNQUFNO0FBQUEsbUJBQ25FLENBQUM7QUFDTixzQkFBVSxLQUFLLEdBQUcscUJBQXFCO0FBQ3ZDLGlCQUFLLG9CQUFvQixJQUFJLFVBQVUsU0FBUztBQUFBLFVBQ3BEO0FBQUEsUUFDSjtBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0wsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLDBCQUFnQztBQTdZcEM7QUE4WVEsVUFBTSxRQUFRLFdBQUssT0FBTyxJQUFJLFFBQVEsUUFBUSxhQUFoQyxtQkFBMEM7QUFDeEQsU0FBSyxPQUFPLFNBQVMsaUJBQWlCLFFBQVEsVUFBUTtBQUNsRCxZQUFNLE1BQU0sSUFBSSx1QkFBZSxLQUFLLE1BQU0sS0FBSyxJQUFJLEtBQUssT0FBTyxLQUFLLGFBQWE7QUFDakYsVUFBSSxXQUFXLEtBQUssRUFBRSxRQUFRLENBQUMsV0FBZ0I7QUFDM0MsY0FBTSxZQUFZLEtBQUssZ0JBQWdCLElBQUksSUFBSSxhQUFhO0FBQzVELFlBQUksV0FBVztBQUNYLGdCQUFNLElBQUksT0FBTztBQUNqQixlQUFLLGlCQUFpQixJQUFJLEVBQUUsTUFBTSxDQUFDLEdBQUcsb0JBQUksSUFBSSxDQUFDLEdBQUksS0FBSyxpQkFBaUIsSUFBSSxFQUFFLElBQUksS0FBSyxDQUFDLEdBQUksU0FBUyxDQUFDLENBQUMsQ0FBQztBQUN6RyxlQUFLLHNCQUFzQixJQUFJLEVBQUUsTUFBTSxDQUFDLEdBQUcsb0JBQUksSUFBSSxDQUFDLEdBQUksS0FBSyxzQkFBc0IsSUFBSSxFQUFFLElBQUksS0FBSyxDQUFDLEdBQUksVUFBVSxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQUEsUUFDNUg7QUFDQSxjQUFNLGlDQUFpQyxLQUFLLGtCQUFrQixJQUFJLElBQUksYUFBYTtBQUNuRixZQUFJO0FBQWdDLGVBQUssZ0NBQWdDLElBQUksT0FBTyxLQUFLLE1BQU0sOEJBQThCO0FBQUEsTUFDakksQ0FBQztBQUFBLElBQ0wsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLDhCQUFvQztBQUNoQyxTQUFLLE9BQU8sSUFBSSxNQUFNLGlCQUFpQixFQUNsQyxPQUFPLE9BQUssQ0FBQyxLQUFLLGtCQUNaLENBQUMsRUFBRSxLQUFLLFNBQVMsS0FBSyxjQUFjLENBQzNDLEVBQ0MsUUFBUSxPQUFLO0FBbmExQjtBQW9hZ0IsWUFBTSx1QkFBdUIsQ0FBQztBQUM5QixZQUFNLG1CQUFzQyxpQkFBSyxPQUFPLElBQUksY0FBYyxhQUFhLENBQUMsTUFBNUMsbUJBQStDLGdCQUEvQyxtQkFBNkQsS0FBSyxPQUFPLFNBQVM7QUFDOUgsVUFBSSxrQkFBa0I7QUFDbEIsY0FBTSxRQUFRLGdCQUFnQixJQUMxQixxQkFBcUIsS0FBSyxHQUFHLGdCQUFnQixJQUM3QyxxQkFBcUIsS0FBSyxHQUFHLGlCQUFpQixNQUFNLEdBQUcsRUFBRSxJQUFJLFNBQU8sSUFBSSxLQUFLLENBQUMsQ0FBQztBQUNuRiw2QkFBcUIsUUFBUSx1QkFBcUI7QUFDOUMsZ0JBQU0sWUFBWSxLQUFLLGdCQUFnQixJQUFJLGlCQUFpQjtBQUM1RCxjQUFJLFdBQVc7QUFDWCxpQkFBSyxpQkFBaUIsSUFBSSxFQUFFLE1BQU0sQ0FBQyxHQUFHLG9CQUFJLElBQUksQ0FBQyxHQUFJLEtBQUssaUJBQWlCLElBQUksRUFBRSxJQUFJLEtBQUssQ0FBQyxHQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDekcsaUJBQUssc0JBQXNCLElBQUksRUFBRSxNQUFNLENBQUMsR0FBRyxvQkFBSSxJQUFJLENBQUMsR0FBSSxLQUFLLHNCQUFzQixJQUFJLEVBQUUsSUFBSSxLQUFLLENBQUMsR0FBSSxVQUFVLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDeEgsa0JBQU0sNEJBQTRCLEtBQUssa0JBQWtCLElBQUksaUJBQWlCO0FBQzlFLGtCQUFNLGdCQUFnQixLQUFLLGdDQUFnQyxJQUFJLEVBQUUsSUFBSTtBQUNyRSxnQkFBSSwyQkFBMkI7QUFDM0Isb0JBQU0sWUFBWSxDQUFDLEdBQUcseUJBQXlCO0FBQy9DLG9CQUFNLHdCQUF3QixnREFBZSxPQUFPLFdBQU07QUFuYjFGO0FBb2JvQyx3QkFBQyxVQUFVLElBQUksUUFBSyxHQUFFLElBQUksRUFBRSxTQUFTLE1BQU0sSUFBSSxLQUMvQyxDQUFDLHlCQUFVLFlBQVYsb0JBQW1CLGFBQW5CLG9CQUE2QixJQUFJLFVBQVEsS0FBSyxNQUFNLFNBQVMsTUFBTTtBQUFBLHFCQUNuRSxDQUFDO0FBQ04sd0JBQVUsS0FBSyxHQUFHLHFCQUFxQjtBQUN2QyxtQkFBSyxnQ0FBZ0MsSUFBSSxFQUFFLE1BQU0sU0FBUztBQUFBLFlBQzlELE9BQU87QUFBRSxtQkFBSyxnQ0FBZ0MsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQUEsWUFBRztBQUFBLFVBQ25FLE9BQU87QUFBRSxpQkFBSyxnQ0FBZ0MsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQUEsVUFBRztBQUFBLFFBQ25FLENBQUM7QUFBQSxNQUNMLE9BQU87QUFBRSxhQUFLLGdDQUFnQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFBQSxNQUFHO0FBQUEsSUFDbkUsQ0FBQztBQUFBLEVBQ1Q7QUFBQSxFQUVBLGtCQUFrQixPQUF1QjtBQUNyQyxXQUFPLENBQUMsdUJBQWtCLHVCQUFpQixFQUFFLFNBQVMsTUFBTSxJQUFJO0FBQUEsRUFDcEU7QUFBQSxFQUVBLGlCQUF1QjtBQVNuQixTQUFLLE9BQU8sSUFBSSxNQUFNLGlCQUFpQixFQUNsQyxPQUFPLE9BQUssQ0FBQyxLQUFLLGtCQUFrQixDQUFDLEVBQUUsS0FBSyxTQUFTLEtBQUssY0FBYyxDQUFDLEVBQ3pFLFFBQVEsT0FBSztBQUNWLFlBQU0saUNBQWlDLEtBQUssZ0NBQWdDLElBQUksRUFBRSxJQUFJO0FBQ3RGLFlBQU0sc0JBQXNCLEtBQUssZ0NBQWdDLElBQUksRUFBRSxJQUFJO0FBQzNFLFlBQU0sb0JBQW9CLEtBQUssb0JBQW9CLElBQUksRUFBRSxJQUFJO0FBQzdELFVBQ0ksa0ZBQWdDLFdBQ2hDLDREQUFxQixXQUNyQix3REFBbUIsU0FDckI7QUFDRSxjQUFNLGNBQXVCLGtDQUFrQyxDQUFDO0FBQ2hFLG9CQUFZLEtBQUssR0FBSSxzQkFBcUIsQ0FBQyxHQUFHLE9BQU8sV0FBUyxDQUFDLFlBQVksSUFBSSxRQUFLLEdBQUUsSUFBSSxFQUFFLFNBQVMsTUFBTSxJQUFJLENBQUMsQ0FBQztBQUNqSCxvQkFBWSxLQUFLLEdBQUksd0JBQXVCLENBQUMsR0FBRyxPQUFPLFdBQVMsQ0FBQyxZQUFZLElBQUksUUFBSyxHQUFFLElBQUksRUFBRSxTQUFTLE1BQU0sSUFBSSxDQUFDLENBQUM7QUFDbkgsYUFBSyxZQUFZLElBQUksRUFBRSxNQUFNLFdBQVc7QUFDeEMsY0FBTSwrQkFBd0MsWUFBWSxPQUFPLFFBQUssS0FBSyxrQkFBa0IsRUFBQyxDQUFDO0FBQy9GLHFDQUE2QixLQUFLLEdBQUksc0JBQXFCLENBQUMsR0FBRyxPQUFPLFdBQVMsQ0FBQyw2QkFBNkIsSUFBSSxRQUFLLEdBQUUsSUFBSSxFQUFFLFNBQVMsTUFBTSxJQUFJLEtBQUssS0FBSyxrQkFBa0IsS0FBSyxDQUFDLENBQUM7QUFDcEwscUNBQTZCLEtBQUssR0FBSSx3QkFBdUIsQ0FBQyxHQUFHLE9BQU8sV0FBUyxDQUFDLDZCQUE2QixJQUFJLFFBQUssR0FBRSxJQUFJLEVBQUUsU0FBUyxNQUFNLElBQUksS0FBSyxLQUFLLGtCQUFrQixLQUFLLENBQUMsQ0FBQztBQUN0TCxZQUFJLDZCQUE2QjtBQUFRLGVBQUssOEJBQThCLElBQUksRUFBRSxNQUFNLDRCQUE0QjtBQUFBLE1BQ3hILFdBQVcsS0FBSywwQkFBMEIsUUFBUTtBQUM5QyxhQUFLLFlBQVksSUFBSSxFQUFFLE1BQU0sS0FBSyx5QkFBeUI7QUFDM0QsY0FBTSwrQkFBK0IsS0FBSywwQkFBMEIsT0FBTyxRQUFLLEtBQUssa0JBQWtCLEVBQUMsQ0FBQztBQUN6RyxZQUFJLDZCQUE2QjtBQUFRLGVBQUssOEJBQThCLElBQUksRUFBRSxNQUFNLEtBQUssMEJBQTBCLE9BQU8sUUFBSyxLQUFLLGtCQUFrQixFQUFDLENBQUMsQ0FBQztBQUM3SixhQUFLLGlCQUFpQixJQUFJLEVBQUUsTUFBTSxDQUFDLEtBQUssZ0JBQWdCLElBQUksS0FBSyxPQUFPLFNBQVMsZUFBZ0IsQ0FBRSxDQUFDO0FBQ3BHLGFBQUssc0JBQXNCLElBQUksRUFBRSxNQUFNLENBQUMsS0FBSyxPQUFPLFNBQVMsZUFBZ0IsQ0FBQztBQUFBLE1BQ2xGLE9BQU87QUFDSCxjQUFNLFNBQVMsS0FBSyxPQUFPLFNBQVMsYUFBYSxJQUFJLFVBQVE7QUFDekQsZ0JBQU0sV0FBVyxJQUFJLGNBQU07QUFDM0IsaUJBQU8sT0FBTyxPQUFPLFVBQVUsSUFBSTtBQUFBLFFBQ3ZDLENBQUM7QUFDRCxhQUFLLFlBQVksSUFBSSxFQUFFLE1BQU0sTUFBTTtBQUNuQyxjQUFNLCtCQUErQixPQUFPLE9BQU8sUUFBSyxLQUFLLGtCQUFrQixFQUFDLENBQUM7QUFDakYsWUFBSSw2QkFBNkI7QUFBUSxlQUFLLDhCQUE4QixJQUFJLEVBQUUsTUFBTSxPQUFPLE9BQU8sUUFBSyxLQUFLLGtCQUFrQixFQUFDLENBQUMsQ0FBQztBQUFBLE1BQ3pJO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDVDtBQUFBLEVBRUEscUNBQXFDLE1BQW9CO0FBQ3JELFFBQUk7QUFDSixRQUFJLE1BQU07QUFDTixvQkFBYSxDQUFDLENBQUMsS0FBSyxNQUFNLEtBQUssOEJBQThCLElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFBQSxJQUN0RixPQUFPO0FBQ0gsb0JBQWEsQ0FBQyxHQUFHLEtBQUssNkJBQTZCO0FBQUEsSUFDdkQ7QUFDQSxnQkFBVyxRQUFRLENBQUMsQ0FBQyxVQUFVLFlBQVk7QUFDdkMsWUFBTSxTQUFTLEtBQUssR0FBRyxJQUFJLEtBQUssUUFBUTtBQUN4QyxZQUFNLGlCQUEwQixDQUFDO0FBQ2pDLGFBQU8sT0FBTyxPQUFLLENBQUMsdUJBQWtCLHVCQUFpQixFQUNsRCxTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsUUFBUSxXQUFTO0FBQ2hDLFlBQUksVUFBVSxPQUFPLE1BQU0sVUFBVSxRQUFXO0FBQUUseUJBQWUsS0FBSyxLQUFLO0FBQUEsUUFBRTtBQUFBLE1BQ2pGLENBQUM7QUFDTCxVQUFJLGVBQWUsUUFBUTtBQUN2QixhQUFLLGtDQUFrQyxJQUFJLFVBQVUsY0FBYztBQUFBLE1BQ3ZFLE9BQU87QUFDSCxhQUFLLGtDQUFrQyxPQUFPLFFBQVE7QUFBQSxNQUMxRDtBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFDSjs7O0FJdmdCQSx3QkFBaUM7OztBQ0dqQyxJQUFJO0FBQ0osSUFBTSxRQUFRLElBQUksV0FBVyxFQUFFO0FBQ2hCLGVBQWU7QUFFNUIsTUFBSSxDQUFDLGlCQUFpQjtBQUVwQixzQkFBa0IsT0FBTyxXQUFXLGVBQWUsT0FBTyxtQkFBbUIsT0FBTyxnQkFBZ0IsS0FBSyxNQUFNO0FBRS9HLFFBQUksQ0FBQyxpQkFBaUI7QUFDcEIsWUFBTSxJQUFJLE1BQU0sMEdBQTBHO0FBQUEsSUFDNUg7QUFBQSxFQUNGO0FBRUEsU0FBTyxnQkFBZ0IsS0FBSztBQUM5Qjs7O0FDWEEsSUFBTSxZQUFZLENBQUM7QUFFbkIsU0FBUyxJQUFJLEdBQUcsSUFBSSxLQUFLLEVBQUUsR0FBRztBQUM1QixZQUFVLEtBQU0sS0FBSSxLQUFPLFNBQVMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQ2xEO0FBRU8seUJBQXlCLEtBQUssVUFBUyxHQUFHO0FBRy9DLFNBQVEsV0FBVSxJQUFJLFVBQVMsTUFBTSxVQUFVLElBQUksVUFBUyxNQUFNLFVBQVUsSUFBSSxVQUFTLE1BQU0sVUFBVSxJQUFJLFVBQVMsTUFBTSxNQUFNLFVBQVUsSUFBSSxVQUFTLE1BQU0sVUFBVSxJQUFJLFVBQVMsTUFBTSxNQUFNLFVBQVUsSUFBSSxVQUFTLE1BQU0sVUFBVSxJQUFJLFVBQVMsTUFBTSxNQUFNLFVBQVUsSUFBSSxVQUFTLE1BQU0sVUFBVSxJQUFJLFVBQVMsTUFBTSxNQUFNLFVBQVUsSUFBSSxVQUFTLE9BQU8sVUFBVSxJQUFJLFVBQVMsT0FBTyxVQUFVLElBQUksVUFBUyxPQUFPLFVBQVUsSUFBSSxVQUFTLE9BQU8sVUFBVSxJQUFJLFVBQVMsT0FBTyxVQUFVLElBQUksVUFBUyxNQUFNLFlBQVk7QUFDbmdCOzs7QUNoQkEsSUFBTSxhQUFhLE9BQU8sV0FBVyxlQUFlLE9BQU8sY0FBYyxPQUFPLFdBQVcsS0FBSyxNQUFNO0FBQ3RHLElBQU8saUJBQVE7QUFBQSxFQUNiO0FBQ0Y7OztBQ0NBLFlBQVksVUFBUyxLQUFLLFNBQVE7QUFDaEMsTUFBSSxlQUFPLGNBQWMsQ0FBQyxPQUFPLENBQUMsVUFBUztBQUN6QyxXQUFPLGVBQU8sV0FBVztBQUFBLEVBQzNCO0FBRUEsYUFBVSxZQUFXLENBQUM7QUFDdEIsUUFBTSxPQUFPLFNBQVEsVUFBVyxVQUFRLE9BQU8sS0FBSztBQUVwRCxPQUFLLEtBQUssS0FBSyxLQUFLLEtBQU87QUFDM0IsT0FBSyxLQUFLLEtBQUssS0FBSyxLQUFPO0FBRTNCLE1BQUksS0FBSztBQUNQLGNBQVMsV0FBVTtBQUVuQixhQUFTLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzNCLFVBQUksVUFBUyxLQUFLLEtBQUs7QUFBQSxJQUN6QjtBQUVBLFdBQU87QUFBQSxFQUNUO0FBRUEsU0FBTyxnQkFBZ0IsSUFBSTtBQUM3QjtBQUVBLElBQU8sYUFBUTs7O0FKdkJSLElBQU0sT0FBTixNQUFXO0FBQUEsRUFJZCxZQUFtQixLQUFlO0FBQWY7QUFDZixTQUFLLFNBQVM7QUFDZCxTQUFLLEtBQUssV0FBTztBQUFBLEVBQ3JCO0FBQ0o7QUFFQSxJQUFxQixrQkFBckIsY0FBNkMsNEJBQVU7QUFBQSxFQUtuRCxZQUFvQixRQUE2QixjQUE2QixVQUFzQjtBQUNoRyxVQUFNO0FBRFU7QUFBNkI7QUFBNkI7QUFGOUUsU0FBTyxPQUFnQjtBQUluQixTQUFLLFFBQVEsb0JBQUksSUFBSTtBQUFBLEVBQ3pCO0FBQUEsRUFFQSxBQUFNLFNBQXdCO0FBQUE7QUFDMUIsV0FBSyxPQUFPLGNBQWMsS0FBSyxPQUFPLElBQUksY0FBYyxHQUFHLFlBQVksTUFBWTtBQUUvRSxhQUFLLE9BQU87QUFDWixjQUFNLEtBQUssWUFBWTtBQUFBLE1BQzNCLEVBQUMsQ0FBQztBQUNGLFdBQUssT0FBTyxjQUNSLEtBQUssT0FBTyxJQUFJLE1BQU0sR0FBRyxVQUFVLENBQU8sU0FBUztBQUMvQyxZQUFJLGdCQUFnQiwyQkFBUyxLQUFLLGNBQWMsVUFBVTtBQUN0RCxlQUFLLE9BQU87QUFDWixnQkFBTSxLQUFLLFlBQVk7QUFBQSxRQUMzQjtBQUFBLE1BQ0osRUFBQyxDQUNMO0FBQUEsSUFDSjtBQUFBO0FBQUEsRUFHQSxBQUFhLFNBQVMsS0FBZTtBQUFBO0FBQ2pDLFlBQU0sT0FBTyxJQUFJLEtBQUssR0FBRTtBQUN4QixXQUFLLE1BQU0sSUFBSSxLQUFLLElBQUksSUFBSTtBQUM1QixVQUFJLENBQUMsS0FBSztBQUFNLGNBQU0sS0FBSyxZQUFZO0FBQUEsSUFDM0M7QUFBQTtBQUFBLEVBRUEsQUFBYSxjQUFjO0FBQUE7QUFDdkIsWUFBTSxDQUFDLG9CQUFvQixvQkFBb0IsQ0FBQyxHQUFHLEtBQUssS0FBSyxFQUFFLE1BQU0sQ0FBQyxRQUFXLE1BQVM7QUFDMUYsVUFBSSxvQkFBb0IsQ0FBQyxLQUFLLE9BQU8sSUFBSSxjQUFjLHFCQUFxQjtBQUN4RSxhQUFLLE9BQU87QUFDWix5QkFBaUIsU0FBUztBQUMxQixjQUFNLGlCQUFpQixHQUFHO0FBQzFCLHlCQUFpQixTQUFTO0FBQzFCLGFBQUssTUFBTSxPQUFPLGtCQUFrQjtBQUtwQyxZQUFJLENBQUMsS0FBSyxPQUFPLElBQUksY0FBYztBQUFxQixnQkFBTSxLQUFLLFlBQVk7QUFBQSxNQUNuRixXQUFXLEtBQUssT0FBTyxJQUFJLGNBQWMscUJBQXFCO0FBQUEsTUFFOUQsT0FBTztBQUFBLE1BRVA7QUFBQSxJQUNKO0FBQUE7QUFDSjs7O0FLbEVBLHdCQUFvQztBQVlwQyxJQUFNLG1CQUFpRztBQUFBLEVBQ25HLFlBQVksRUFBRSxPQUFPLElBQUksS0FBSyxHQUFHO0FBQUEsRUFDakMsWUFBWSxFQUFFLE9BQU8sS0FBSyxLQUFLLElBQUk7QUFBQSxFQUNuQyxlQUFlLEVBQUUsT0FBTyxLQUFLLEtBQUssSUFBSTtBQUMxQztBQU9PLElBQU0scUJBQW9CLENBQUMsT0FBZSxNQUFjLFdBQW1CLE9BQWUsV0FBa0MsZUFBK0I7QUFDOUosUUFBTSxLQUFLLEtBQUssU0FBUyxLQUFLO0FBQzlCLE1BQUksT0FBTyxHQUFHLEtBQUs7QUFDbkIsUUFBTSxZQUE0QixDQUFDO0FBQ25DLFNBQU8sQ0FBQyxLQUFLLE1BQU07QUFDZixVQUFNLFFBQVEsS0FBSztBQUNuQixRQUFJLE1BQU0sVUFBVSxPQUFPLEtBQUssTUFBTSxNQUFNLEVBQUUsTUFBTSxPQUFLLGdCQUFnQixTQUFTLENBQUMsQ0FBQyxHQUFHO0FBQ25GLFlBQU0sRUFBRSxRQUFRLFNBQVMsV0FBVyxZQUFZLFVBQVUsdUJBQXVCLHNCQUFzQixXQUFXLE1BQU07QUFDeEgsWUFBTSxhQUFhLFFBQVEsTUFBTSxRQUFRLFlBQVksR0FBRyxFQUFFLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRTtBQUMxRSxZQUFNLFdBQVcsV0FBVyxVQUFVLElBQUksV0FBVyxLQUFLLEdBQUcsV0FBVyxLQUFLLElBQUk7QUFDakYsWUFBTSxTQUFRLGlCQUFnQixVQUFVO0FBQ3hDLFlBQU0sT0FBTSxpQkFBZ0IsVUFBVTtBQUN0QyxnQkFBVSxLQUFLO0FBQUEsUUFDWCxVQUFVLE1BQU07QUFBQSxRQUNoQixVQUFVLEdBQUcsV0FBVyxLQUFLLFNBQVEsVUFBVSxLQUFLLGFBQWEsS0FBSyxhQUFhLFlBQVksV0FBVywwQkFBMEIsdUJBQXVCLFdBQVc7QUFBQSxNQUMxSyxDQUFDO0FBQUEsSUFDTDtBQUNBLFdBQU8sR0FBRyxLQUFLO0FBQUEsRUFDbkI7QUFDQSxTQUFPO0FBQ1g7QUFFQSx1QkFDSSxRQUNBLGdCQUNBLFdBQ0EsT0FDQSxxQkFBNkIsR0FDaEI7QUFBQTtBQXBEakI7QUFxREksUUFBSTtBQUNKLFFBQUksMEJBQTBCLHlCQUFPO0FBQ2pDLGFBQU87QUFBQSxJQUNYLE9BQU87QUFDSCxZQUFNLFFBQVEsT0FBTyxJQUFJLE1BQU0sc0JBQXNCLGNBQWM7QUFDbkUsVUFBSSxpQkFBaUIsMkJBQVMsTUFBTSxhQUFhLE1BQU07QUFDbkQsZUFBTztBQUFBLE1BQ1gsT0FBTztBQUNILGNBQU0sTUFBTSwwQ0FBMEM7QUFBQSxNQUMxRDtBQUFBLElBQ0o7QUFDQSxVQUFNLFVBQVcsT0FBTSxPQUFPLElBQUksTUFBTSxLQUFLLElBQUksR0FBRyxNQUFNLElBQUk7QUFDOUQsVUFBTSxjQUFjLGFBQU8sSUFBSSxjQUFjLGFBQWEsSUFBSSxNQUExQyxtQkFBNkM7QUFHakUsVUFBTSxlQUF5QixDQUFDO0FBRWhDLFVBQU0sRUFBRSxVQUFVLEVBQUUsZUFBTyxnQkFBVSxjQUFjLGNBQWMsRUFBRSxVQUFVLEVBQUUsT0FBTyxRQUFXLEtBQUssT0FBVSxFQUFFO0FBQ2xILFVBQU0sYUFBYSxRQUFRLElBQUksQ0FBQyxNQUFNLE1BQU07QUF2RWhEO0FBd0VRLFVBQUksVUFBUyxRQUFPLEtBQUssT0FBTSxRQUFRLEtBQUssS0FBSSxNQUFNO0FBQ2xELGNBQU0sUUFBUSxJQUFJLE9BQU8sSUFBSSxjQUFjLEdBQUc7QUFDOUMsY0FBTSxJQUFJLEtBQUssTUFBTSxLQUFLO0FBQzFCLFlBQUksS0FBSyxFQUFFLFNBQVMsR0FBRztBQUNuQixnQkFBTSxhQUFhLFFBQVEsTUFBTSxRQUFRLFlBQVksR0FBRyxFQUFFLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRTtBQUMxRSxnQkFBTSxXQUFXLFdBQVcsVUFBVSxJQUFJLFdBQVcsS0FBSyxJQUFJLFdBQVcsS0FBSyxJQUFJO0FBQ2xGLGlCQUFPLEdBQUcsY0FBYztBQUFBLFFBQzVCLE9BQU87QUFDSCxpQkFBTztBQUFBLFFBQ1g7QUFBQSxNQUNKLE9BQU87QUFDSCxjQUFNLGVBQWUsV0FBVyxLQUFLO0FBQ3JDLFlBQUksY0FBYyxXQUFXLElBQUk7QUFDakMsY0FBTSxpQkFBZ0IsSUFBSSxPQUFPLElBQUksaUJBQWlCLFNBQVMsdUJBQXVCLEdBQUc7QUFDekYsY0FBTSxLQUFLLFlBQVksTUFBTSxjQUFhO0FBQzFDLFlBQUksMEJBQUksV0FBVSxPQUFPLEtBQUssR0FBRyxNQUFNLEVBQUUsTUFBTSxPQUFLLGdCQUFnQixTQUFTLENBQUMsQ0FBQyxHQUFHO0FBRTlFLGdCQUFNLFFBQVEsY0FBTyxXQUFXLFlBQVksSUFBSSxLQUFLLElBQUksTUFBM0Msb0JBQThDLEtBQUssT0FBSyxFQUFFLFNBQVM7QUFDakYsY0FBSSxnQ0FBTyxVQUFTLHVCQUFrQjtBQUdsQyxrQkFBTSxTQUFTLGNBQWMsUUFBUSxNQUFNLENBQUM7QUFDNUMsZ0JBQUksUUFBUTtBQUNSLG9CQUFNLEVBQUUsZUFBTyxjQUFRO0FBQ3ZCLHVCQUFTLElBQUksU0FBUSxHQUFHLElBQUksU0FBUSxxQkFBcUIsS0FBSyxJQUFJLE9BQU0sR0FBRyxLQUFLO0FBQzVFLDZCQUFhLEtBQUssQ0FBQztBQUFBLGNBQ3ZCO0FBQUEsWUFDSjtBQUFBLFVBQ0o7QUFDQSxnQkFBTSxFQUFFLFFBQVEsU0FBUyxXQUFXLFlBQVksVUFBVSx1QkFBdUIsc0JBQXNCLFdBQVcsR0FBRztBQUNySCxnQkFBTSxhQUFhLFFBQVEsTUFBTSxRQUFRLFlBQVksR0FBRyxFQUFFLE1BQU0sR0FBRyxFQUFFLEtBQUssSUFBSSxDQUFDO0FBQy9FLGNBQUk7QUFDSixjQUFJLGNBQWM7QUFFbEIsY0FBSSxnQ0FBTyxVQUFTLHlCQUFvQixBQUFPLHNCQUFzQixTQUFTLCtCQUFPLFFBQVEsVUFBeUIsR0FBRztBQUNySCx1QkFBVyxXQUFXLFVBQVUsSUFBSSxTQUFTLFdBQVcsS0FBSyxHQUFHLFdBQVcsU0FBUyxJQUFJLE9BQU8sS0FBSyxXQUFXLElBQUksVUFBUSxPQUFPLElBQUksRUFBRSxLQUFLLElBQUk7QUFHakosMEJBQWMsbUJBQW1CLE1BQU0sZ0JBQWdCO0FBQUEsVUFDM0QsT0FBTztBQUNILHVCQUFXLFdBQVcsVUFBVSxJQUFJLFdBQVcsS0FBSyxHQUFHLFdBQVcsS0FBSyxJQUFJO0FBQUEsVUFDL0U7QUFDQSxpQkFBTyxHQUFHLFdBQVcsS0FBSyxVQUFVLEtBQUssYUFBYSxLQUFLLGFBQWEsWUFBWSxXQUFXLDBCQUEwQix1QkFBdUIsY0FBYztBQUFBLFFBQ2xLLE9BQU87QUFDSCxnQkFBTSxZQUE0QixDQUFDO0FBQ25DLGdCQUFNLDJCQUEwQixJQUFJLE9BQU8sTUFBTSxpQkFBaUIsU0FBUywyQkFBMkIsSUFBSTtBQUMxRyxnQkFBTSxzQkFBcUIsSUFBSSxPQUFPLE1BQU0saUJBQWlCLFNBQVMsMkJBQTJCLElBQUk7QUFDckcsb0JBQVUsS0FBSyxHQUFHLG1CQUFrQiwwQkFBeUIsYUFBYSxXQUFXLGNBQWMseUJBQWlCLENBQUM7QUFDckgsb0JBQVUsS0FBSyxHQUFHLG1CQUFrQixxQkFBb0IsYUFBYSxXQUFXLGNBQWMsK0JBQW9CLENBQUM7QUFDbkgsb0JBQVUsUUFBUSxXQUFTO0FBQ3ZCLGtCQUFNLGFBQWEsSUFBSSxPQUFPLE1BQU0sU0FBUyxRQUFRLHVCQUF1QixNQUFNLEdBQUcsR0FBRztBQUN4RiwwQkFBYyxZQUFZLFFBQVEsWUFBWSxNQUFNLFFBQVE7QUFBQSxVQUNoRSxDQUFDO0FBQ0QsaUJBQU8sV0FBVyxXQUFXO0FBQUEsUUFDakM7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBRUQsVUFBTSxPQUFPLElBQUksTUFBTSxPQUFPLE1BQU0sV0FBVyxPQUFPLENBQUMsTUFBTSxNQUFNLENBQUMsYUFBYSxTQUFTLENBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDO0FBRXhHLFVBQU0sU0FBUyxhQUFPLElBQUksVUFBVSxvQkFBb0IsOEJBQVksTUFBckQsbUJBQXdEO0FBQ3ZFLFFBQUksUUFBUTtBQUNSLFlBQU0sYUFBYSxPQUFPLFVBQVUsRUFBRTtBQUN0QyxhQUFPLFVBQVUsRUFBRSxNQUFNLE9BQU8sVUFBVSxFQUFFLE1BQU0sSUFBSSxPQUFPLFFBQVEsVUFBVSxFQUFFLE9BQU8sQ0FBQztBQUFBLElBQzdGO0FBQUEsRUFDSjtBQUFBOzs7QUN4SUEsd0JBQW9DOzs7QUNBcEMsd0JBQW9DO0FBSXBDLHFDQUNJLFFBQ0EsZ0JBQ0EsUUFDYTtBQUFBO0FBVGpCO0FBVUksUUFBSTtBQUNKLFFBQUksMEJBQTBCLHlCQUFPO0FBQ2pDLGFBQU87QUFBQSxJQUNYLE9BQU87QUFDSCxZQUFNLFFBQVEsT0FBTyxJQUFJLE1BQU0sc0JBQXNCLGNBQWM7QUFDbkUsVUFBSSxpQkFBaUIsMkJBQVMsTUFBTSxhQUFhLE1BQU07QUFDbkQsZUFBTztBQUFBLE1BQ1gsT0FBTztBQUNILGNBQU0sTUFBTSwwQ0FBMEM7QUFBQSxNQUMxRDtBQUFBLElBQ0o7QUFDQSxVQUFNLFVBQVUsTUFBTSxPQUFPLElBQUksTUFBTSxLQUFLLElBQUk7QUFDaEQsVUFBTSxjQUFjLFVBQVUsT0FBTyxRQUFRLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQyxXQUFXLFdBQVcsR0FBRyxjQUFjLE9BQU8sRUFBRSxLQUFLLElBQUksSUFBSztBQUV6SCxVQUFNLE9BQU8sSUFBSSxNQUFNLE9BQU8sTUFBTSxjQUFjLE9BQU87QUFDekQsVUFBTSxTQUFTLGFBQU8sSUFBSSxVQUFVLG9CQUFvQiw4QkFBWSxNQUFyRCxtQkFBd0Q7QUFDdkUsUUFBSSxRQUFRO0FBQ1IsWUFBTSxhQUFhLE9BQU8sVUFBVSxFQUFFO0FBQ3RDLGFBQU8sVUFBVSxFQUFFLE1BQU0sT0FBTyxVQUFVLEVBQUUsTUFBTSxJQUFJLE9BQU8sUUFBUSxVQUFVLEVBQUUsT0FBTyxDQUFDO0FBQUEsSUFDN0Y7QUFBQSxFQUNKO0FBQUE7OztBRHhCQSxzQkFDSSxRQUNBLGdCQUNBLFdBQ0EsT0FDQSxZQUNBLGVBQ0EsUUFBaUIsTUFDakIsU0FBa0IsT0FDbEIsWUFBcUIsT0FDUjtBQUFBO0FBaEJqQjtBQWlCSSxRQUFJO0FBQ0osUUFBSSwwQkFBMEIseUJBQU87QUFDakMsYUFBTztBQUFBLElBQ1gsT0FBTztBQUNILFlBQU0sUUFBUSxPQUFPLElBQUksTUFBTSxzQkFBc0IsY0FBYztBQUNuRSxVQUFJLGlCQUFpQiwyQkFBUyxNQUFNLGFBQWEsTUFBTTtBQUNuRCxlQUFPO0FBQUEsTUFDWCxPQUFPO0FBQ0gsY0FBTSxNQUFNLDBDQUEwQztBQUFBLE1BQzFEO0FBQUEsSUFDSjtBQUNBLFVBQU0sY0FBYyxhQUFPLElBQUksY0FBYyxhQUFhLElBQUksTUFBMUMsbUJBQTZDO0FBQ2pFLFFBQUksaUJBQWlCLGNBQWMsTUFBTSxDQUFDLGFBQWE7QUFDbkQsWUFBTSxTQUFpQyxDQUFDO0FBQ3hDLGFBQU8sYUFBYTtBQUNwQixZQUFNLDRCQUE0QixRQUFRLE1BQU0sTUFBTTtBQUFBLElBQzFELE9BQU87QUFDSCxZQUFNLFNBQVMsTUFBTSxPQUFPLElBQUksTUFBTSxLQUFLLElBQUk7QUFDL0MsVUFBSSxhQUF1QixDQUFDO0FBQzVCLFlBQU0sbUJBQW1CLGlCQUFpQixjQUFjLE1BQU0sY0FDMUQsWUFBWSxTQUFTLElBQUksT0FBTyxJQUFJO0FBQ3hDLGFBQU8sTUFBTSxJQUFJLEVBQUUsUUFBUSxDQUFDLE1BQU0sZ0JBQWdCO0FBQzlDLFlBQUksZUFBZSxrQkFBa0I7QUFDakMsY0FBSTtBQUFPLHVCQUFXLEtBQUssSUFBSTtBQUMvQixnQkFBTSxVQUFVLEdBQUcsQ0FBQyxpQkFBaUIsWUFBWSxNQUFNLEtBQUssQ0FBQyxpQkFBaUIsU0FBUyxPQUFPLEtBQUssWUFBWSxnQkFBZ0IsTUFBTSxRQUFRO0FBQzdJLHFCQUFXLEtBQUssT0FBTztBQUN2QixjQUFJLENBQUM7QUFBTyx1QkFBVyxLQUFLLElBQUk7QUFBQSxRQUNwQyxPQUFPO0FBQ0gscUJBQVcsS0FBSyxJQUFJO0FBQUEsUUFDeEI7QUFBQSxNQUNKLENBQUM7QUFFRCxZQUFNLE9BQU8sSUFBSSxNQUFNLE9BQU8sTUFBTSxXQUFXLEtBQUssSUFBSSxDQUFDO0FBQ3pELFlBQU0sU0FBUyxhQUFPLElBQUksVUFBVSxvQkFBb0IsOEJBQVksTUFBckQsbUJBQXdEO0FBQ3ZFLFVBQUksUUFBUTtBQUNSLGNBQU0sY0FBYSxPQUFPLFVBQVUsRUFBRTtBQUN0QyxlQUFPLFVBQVUsRUFBRSxNQUFNLE9BQU8sVUFBVSxFQUFFLE1BQU0sSUFBSSxPQUFPLFFBQVEsV0FBVSxFQUFFLE9BQU8sQ0FBQztBQUFBLE1BQzdGO0FBQUEsSUFDSjtBQUFBLEVBRUo7QUFBQTs7O0FFckRBLHdCQUErQjtBQUUvQiwyQkFDSSxRQUNBLE1BQ0EsV0FDQSxPQUNJO0FBWFI7QUFZSSxNQUFJLHFDQUFPLFlBQVAsbUJBQWdCLGVBQWU7QUFDL0IsVUFBTSxhQUFhO0FBQ25CLGtCQUFFLGVBQWUsUUFBUSxNQUFNLFdBQVcsSUFBSSxZQUFZLE9BQU8sT0FBTyxLQUFLO0FBQUEsRUFDakYsT0FBTztBQUNILFFBQUksbUJBQ0EsUUFDQSxNQUNBLENBQ0ksWUFDQSxPQUNBLFFBQ0EsY0FDQyxjQUFFLGVBQ0gsUUFDQSxNQUNBLFdBQ0EsSUFDQSxZQUNBLE9BQ0EsUUFDQSxTQUNKLENBQ0osRUFBRSxLQUFLO0FBQUEsRUFDWDtBQUNKO0FBRUEsdUJBQ0ksUUFDQSxJQUNBLEdBQ0EsZ0JBQ0EsV0FDQSxPQUNJO0FBN0NSO0FBOENJLFFBQU0sUUFBUSxhQUFPLFdBQVcsWUFBWSxJQUFJLEVBQUUsS0FBSyxJQUFJLE1BQTdDLG1CQUFnRCxLQUFLLFlBQVMsT0FBTSxTQUFTO0FBQzNGLE1BQUksK0JBQU8sTUFBTTtBQUNiLFVBQU0sZUFBZSxJQUFJLGFBQWEsTUFBTSxNQUFNLFFBQVEsS0FBSztBQUMvRCxpQkFBYSxjQUFjLElBQUksR0FBRyxnQkFBZ0IsS0FBSztBQUFBLEVBQzNELE9BQU87QUFDSCxVQUFNLGVBQWUsY0FBRSxjQUFjLFFBQVEsU0FBUztBQUN0RCxpQkFBYSxjQUFjLElBQUksR0FBRyxnQkFBZ0IsS0FBSztBQUFBLEVBQzNEO0FBQ0o7QUFFTyx1QkFDSCxRQUNBLElBQ0EsR0FDQSxXQUNBLE9BQ1c7QUE5RGY7QUFpRUksUUFBTSxpQkFBOEIsR0FBRyxHQUFHLE9BQU8sRUFBRTtBQUNuRCxpQkFBZSxRQUFRLFNBQVMsb0NBQW9DLFdBQVc7QUFJL0UsTUFBSSxFQUFFLGVBQWUsUUFBVztBQUM1QixRQUFJLENBQUMsc0NBQU8sWUFBUCxtQkFBZ0IsZUFBYztBQUMvQixZQUFNLGFBQWEsR0FBRyxHQUFHLFFBQVEsTUFBTSxLQUFLO0FBQzVDLHFCQUFlLFlBQVksVUFBVTtBQUFBLElBQ3pDLE9BQU87QUFDSCxZQUFNLGNBQWMsR0FBRyxHQUFHLFVBQVUsS0FBSztBQUN6QyxxQ0FBUSxhQUFhLGtCQUFrQjtBQUN2QyxrQkFBWSxVQUFVLE1BQVk7QUE3RTlDO0FBK0VnQixjQUFNLE9BQU8sT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsS0FBSyxJQUFJO0FBQy9ELFlBQUksZ0JBQWdCLDJCQUFTLEtBQUssYUFBYSxNQUFNO0FBQ2pELGdCQUFNLFFBQVEsY0FBTyxXQUFXLFlBQVksSUFBSSxLQUFLLElBQUksTUFBM0Msb0JBQThDLEtBQUssWUFBUyxPQUFNLFNBQVM7QUFDekYsY0FBSSxPQUFPO0FBQ1AsOEJBQWtCLFFBQVEsTUFBTSxXQUFXLEtBQUs7QUFBQSxVQUNwRCxPQUFPO0FBQ0gsZ0JBQUksbUJBQ0EsUUFDQSxNQUNBLENBQ0ksWUFDQSxPQUNBLFFBQ0EsY0FDQyxjQUFFLGVBQ0gsUUFDQSxNQUNBLFFBQ0EsSUFDQSxZQUNBLE9BQ0EsUUFDQSxTQUNKLENBQ0osRUFBRSxLQUFLO0FBQUEsVUFDWDtBQUFBLFFBQ0osT0FBTztBQUNILGdCQUFNLE1BQU0sMENBQTBDO0FBQUEsUUFDMUQ7QUFBQSxNQUNKO0FBQ0EscUJBQWUsWUFBWSxXQUFXO0FBQUEsSUFDMUM7QUFBQSxFQUNKLE9BQU87QUFDSCxVQUFNLE9BQU8sT0FBTyxJQUFJLE1BQU0sc0JBQXNCLEVBQUUsS0FBSyxJQUFJO0FBQy9ELFFBQUksZ0JBQWdCLDJCQUFTLEtBQUssYUFBYSxNQUFNO0FBQ2pELFlBQU0sUUFBUSxhQUFPLFdBQVcsWUFBWSxJQUFJLEtBQUssSUFBSSxNQUEzQyxtQkFBOEMsS0FBSyxZQUFTLE9BQU0sU0FBUztBQUN6RixVQUFJLE9BQU87QUFDUCxzQkFBYyxRQUFRLElBQUksR0FBRyxnQkFBZ0IsV0FBVyxLQUFLO0FBQUEsTUFDakUsT0FBTztBQUNILGNBQU0sZUFBZSxjQUFFLGNBQWMsUUFBUSxTQUFTO0FBQ3RELHFCQUFhLGNBQWMsSUFBSSxHQUFHLGdCQUFnQixLQUFLO0FBQUEsTUFDM0Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNBLFNBQU87QUFDWDs7O0FDM0hBLHdCQUFzQjtBQUlmLElBQU0sWUFBTixNQUFnQjtBQUFBLEVBQWhCO0FBQ0gsU0FBVSxPQUFtQjtBQUM3QixTQUFVLGFBQXdDO0FBQ2xELFNBQVUsWUFBcUI7QUFDL0IsU0FBVSxVQUE4QztBQUN4RCxTQUFVLFVBQW9CO0FBRTlCLFNBQVUsUUFBZ0I7QUFDMUIsU0FBVSxxQkFBOEI7QUFDeEMsU0FBTyxTQUFrQjtBQUFBO0FBQUEsRUFFekIsQUFBTyxTQUNILFFBQ0EsTUFDQSxXQUNBLE9BQ0Esd0JBQ0k7QUF0Qlo7QUF1QlEsU0FBSyxRQUFRO0FBQ2IsU0FBSyxlQUFlLE9BQU8sU0FBUyxzQkFBc0IsU0FBUyxTQUFTO0FBQzVFLFVBQU0sUUFBUSxhQUFPLFdBQVcsWUFBWSxJQUFJLEtBQUssSUFBSSxNQUEzQyxtQkFBOEMsS0FBSyxZQUFTLE9BQU0sU0FBUztBQUN6RixRQUFJLE9BQU87QUFDUCxZQUFNLGVBQWUsSUFBSSxhQUFhLE1BQU0sTUFBTSxRQUFRLEtBQUs7QUFDL0QsV0FBSyxVQUFVLGFBQWEsY0FBYyxLQUFLO0FBQy9DLFdBQUssWUFBWSxNQUFNO0FBQ3ZCLFdBQUssT0FBTyxNQUFNO0FBQ2xCLFdBQUssVUFBVSxNQUFNO0FBQ3JCLFdBQUssYUFBYSxNQUFNLGdCQUFnQixjQUFjO0FBQUEsSUFDMUQ7QUFBQSxFQUNKO0FBQ0o7QUFFTyxvQkFBb0IsUUFBc0IsZ0JBQTJEO0FBckM1RztBQXlDSSxNQUFJO0FBQ0osTUFBSSwwQkFBMEIseUJBQU87QUFDakMsV0FBTztBQUFBLEVBQ1gsT0FBTztBQUNILFVBQU0sUUFBUSxPQUFPLElBQUksTUFBTSxzQkFBc0IsY0FBYztBQUNuRSxRQUFJLGlCQUFpQiwyQkFBUyxNQUFNLGFBQWEsTUFBTTtBQUNuRCxhQUFPO0FBQUEsSUFDWCxPQUFPO0FBQ0gsWUFBTSxNQUFNLDBDQUEwQztBQUFBLElBQzFEO0FBQUEsRUFDSjtBQUNBLFFBQU0sU0FBb0MsQ0FBQztBQUMzQyxRQUFNLFFBQVEsYUFBTyxJQUFJLFFBQVEsUUFBUSxhQUEzQixtQkFBcUM7QUFFbkQsTUFBSSxPQUFPO0FBQ1AsVUFBTSxTQUFTLE1BQU0sS0FBSyxLQUFLLElBQUk7QUFDbkMsUUFBSTtBQUNBLGtCQUFZLE1BQU0sRUFBRSxRQUFRLENBQU0sUUFBTztBQUNyQyxZQUFJLFFBQVEsUUFBUTtBQUNoQixnQkFBTSxZQUFZLElBQUk7QUFDdEIsb0JBQVUsU0FBUyxDQUFDLE9BQU8sS0FBSyxNQUFNLEVBQUUsU0FBUyxHQUFHO0FBQ3BELGlCQUFPLE9BQU87QUFDZCxvQkFBVSxTQUFTLFFBQVEsTUFBTSxLQUFLLE9BQU8sSUFBSTtBQUFBLFFBQ3JEO0FBQUEsTUFDSixFQUFDO0FBQUEsSUFDTCxTQUFTLE9BQVA7QUFDRSxZQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFFQSxTQUFPO0FBQ1g7OztBQ3BETyxJQUFNLGtCQUFOLE1BQXNCO0FBQUEsRUFFekIsWUFBb0IsUUFBc0I7QUFBdEI7QUFBQSxFQUF3QjtBQUFBLEVBRTVDLEFBQU8sT0FBeUI7QUFDNUIsV0FBTztBQUFBLE1BQ0gsV0FBVyxLQUFLLFVBQVU7QUFBQSxNQUMxQixlQUFlLEtBQUssY0FBYztBQUFBLE1BQ2xDLGNBQWMsS0FBSyxhQUFhO0FBQUEsTUFDaEMsZUFBZSxLQUFLLGNBQWM7QUFBQSxNQUNsQyxZQUFZLEtBQUssV0FBVztBQUFBLE1BQzVCLHFCQUFxQixLQUFLLG9CQUFvQjtBQUFBLE1BQzlDLFlBQVksS0FBSyxXQUFXO0FBQUEsSUFDaEM7QUFBQSxFQUNKO0FBQUEsRUFFQSxBQUFRLFlBQXNGO0FBQzFGLFdBQU8sQ0FBTyxnQkFBZ0MsY0FBbUI7QUFBRyx1QkFBVSxLQUFLLFFBQVEsZ0JBQWdCLFNBQVM7QUFBQTtBQUFBLEVBQ3hIO0FBQUEsRUFFQSxBQUFRLGdCQUFxRztBQUN6RyxXQUFPLENBQU8sZ0JBQWdDLFdBQW1CLFVBQWU7QUFBRyxtQkFBTSxLQUFLLE9BQU8sZ0JBQWdCLFNBQVMsTUFBTTtBQUNoSSxnQkFBUSxLQUFLLHFEQUFxRDtBQUNsRSxzQkFBYyxLQUFLLFFBQVEsZ0JBQWdCLFdBQVcsR0FBRyxPQUFPO0FBQUEsTUFDcEUsQ0FBQztBQUFBO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxlQUEwTTtBQUM5TSxXQUFPLENBQU8sZ0JBQWdDLFdBQW1CLE9BQWUsWUFBcUIsZUFBeUIsT0FBaUIsUUFBa0IsY0FBcUI7QUFBRyxtQkFBTSxLQUFLLE9BQU8sZ0JBQWdCLFNBQVMsTUFBTTtBQUN0TyxnQkFBUSxLQUFLLG9EQUFvRDtBQUNqRSxxQkFBYSxLQUFLLFFBQVEsZ0JBQWdCLFdBQVcsT0FBTyxZQUFZLGVBQWUsT0FBTyxRQUFRLFNBQVM7QUFBQSxNQUNuSCxDQUFDO0FBQUE7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLGdCQUFnSztBQUNwSyxXQUFPLENBQUMsSUFBUyxHQUFRLFdBQW1CLFVBQThGLGNBQWMsS0FBSyxRQUFRLElBQUksR0FBRyxXQUFXLEtBQUs7QUFBQSxFQUNoTTtBQUFBLEVBRUEsQUFBUSxhQUFxRjtBQUN6RixXQUFPLENBQU8sbUJBQWdDO0FBQUcsd0JBQVcsS0FBSyxRQUFRLGNBQWM7QUFBQTtBQUFBLEVBQzNGO0FBQUEsRUFFQSxBQUFRLHNCQUEwSztBQUM5SyxXQUFPLENBQU8sZ0JBQWdDLFlBQW9CLE9BQWdCLFFBQWlCLFdBQW9CLGtCQUF3QjtBQUFHLGlDQUFvQixLQUFLLFFBQVEsZ0JBQWdCLFlBQVksT0FBTyxRQUFRLFdBQVcsYUFBYTtBQUFBO0FBQUEsRUFDMVA7QUFBQSxFQUVBLEFBQVEsYUFBcUs7QUFDekssV0FBTyxDQUFPLGdCQUFnQyxTQUF3QixZQUFxQixPQUFpQixRQUFrQixjQUFxQjtBQUFHLHdCQUFXLEtBQUssUUFBUSxTQUFTLGdCQUFnQixZQUFZLE9BQU8sUUFBUSxTQUFTO0FBQUE7QUFBQSxFQUMvTztBQUNKOzs7QUMxQ08sSUFBTSxtQkFBeUM7QUFBQSxFQUNyRCxjQUFjLENBQUM7QUFBQSxFQUNmLGtCQUFrQixDQUFDO0FBQUEsRUFDbkIsNEJBQTRCO0FBQUEsRUFDNUIsdUJBQXVCLENBQUM7QUFBQSxFQUN4QixnQkFBZ0I7QUFBQSxFQUNoQixzQkFBc0I7QUFBQSxFQUN0QixnQkFBZ0I7QUFBQSxFQUNoQixpQkFBaUI7QUFBQSxFQUNqQixpQkFBaUI7QUFBQSxFQUNqQixnQkFBZ0I7QUFBQSxFQUNoQixhQUFhO0FBQUEsRUFDYixpQkFBaUI7QUFBQSxFQUNqQixjQUFjO0FBQUEsRUFDZCxpQkFBaUI7QUFBQSxFQUNqQixlQUFlO0FBQUEsRUFDZixvQkFBb0I7QUFBQSxFQUNwQixjQUFjO0FBQUEsRUFDZCxZQUFZO0FBQUEsRUFDWixxQkFBcUI7QUFBQSxFQUNyQix3QkFBd0I7QUFDekI7OztBQ2hEQSx3QkFBdUg7OztBQ0d2SCx3QkFBdUM7QUFHaEMsSUFBTSxnQkFBTixjQUE0QixpQkFBMEI7QUFBQSxFQUV6RCxZQUNZLFFBQ0QsU0FDVDtBQUNFLFVBQU0sT0FBTztBQUhMO0FBQ0Q7QUFBQSxFQUdYO0FBQUEsRUFFQSxlQUFlLFVBQTZCO0FBQ3hDLFVBQU0sZ0JBQWdCLEtBQUssT0FBTyxJQUFJLE1BQU0sa0JBQWtCO0FBQzlELFVBQU0sVUFBcUIsQ0FBQztBQUM1QixVQUFNLG9CQUFvQixTQUFTLFlBQVk7QUFFL0Msa0JBQWMsUUFBUSxDQUFDLFdBQTBCO0FBQzdDLFVBQ0ksa0JBQWtCLDZCQUNsQixPQUFPLEtBQUssWUFBWSxFQUFFLFNBQVMsaUJBQWlCLEdBQ3REO0FBQ0UsZ0JBQVEsS0FBSyxNQUFNO0FBQUEsTUFDdkI7QUFBQSxJQUNKLENBQUM7QUFFRCxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsaUJBQWlCLE1BQWUsSUFBdUI7QUFDbkQsT0FBRyxRQUFRLEtBQUssSUFBSTtBQUFBLEVBQ3hCO0FBQUEsRUFFQSxpQkFBaUIsTUFBcUI7QUFDbEMsU0FBSyxRQUFRLFFBQVEsS0FBSztBQUMxQixTQUFLLFFBQVEsUUFBUSxPQUFPO0FBQzVCLFNBQUssTUFBTTtBQUFBLEVBQ2Y7QUFDSjs7O0FDeENBLHdCQUEySDs7O0FDRDNILHdCQUF3QjtBQUt4QixJQUFxQix3QkFBckIsY0FBbUQsMEJBQVE7QUFBQSxFQUd2RCxZQUNZLGFBQ1IsVUFDUSxRQUNWO0FBQ0UsVUFBTSxXQUFXO0FBSlQ7QUFFQTtBQUdSLFNBQUssaUJBQWlCO0FBQ3RCLFNBQUssdUJBQXVCO0FBQzVCLFNBQUssY0FBYztBQUNuQixTQUFLLGdCQUFnQjtBQUNyQixTQUFLLGdCQUFnQjtBQUNyQixTQUFLLFVBQVUsU0FBUyxXQUFXO0FBQUEsRUFDdkM7QUFBQSxFQUVBLEFBQU8seUJBQStCO0FBRWxDLFNBQUssT0FBTyxjQUFjO0FBQzFCLFNBQUssT0FBTyxTQUFTLGNBQWM7QUFDbkMsVUFBTSwwQkFBMEIsS0FBSyxPQUFPLFVBQVU7QUFFdEQsVUFBTSxnQkFBZ0Isd0JBQXdCLFNBQVMsT0FBTyxNQUFNO0FBQ3BFLGtCQUFjLFlBQVksV0FBVyxLQUFLLGVBQWU7QUFFekQsVUFBTSx5QkFBeUIsd0JBQXdCLFNBQVMsS0FBSztBQUNyRSwyQkFBdUIsWUFBWSw0QkFBNEIsS0FBSyxlQUFlO0FBRW5GLFVBQU0saUJBQWlCLHdCQUF3QixTQUFTLEtBQUs7QUFDN0QsbUJBQWUsWUFBWSx3QkFBd0IsS0FBSyxlQUFlO0FBQUEsRUFFM0U7QUFBQSxFQUVBLEFBQVEsZ0JBQXNCO0FBQzFCLFNBQUssVUFBVSxDQUFDLE1BQU07QUFDbEIsUUFBRSxRQUFRLFFBQVEsRUFDYixXQUFXLE1BQU0sRUFDakIsUUFBUSxNQUFNO0FBQ1gsWUFBSSxRQUFRLElBQUksNEJBQTRCLEtBQUssUUFBUSxLQUFLLGFBQWEsTUFBTSxLQUFLLGNBQWM7QUFDcEcsY0FBTSxLQUFLO0FBQUEsTUFDZixDQUFDO0FBQUEsSUFDVCxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxrQkFBd0I7QUFDNUIsU0FBSyxVQUFVLENBQUMsTUFBTTtBQUNsQixRQUFFLFFBQVEsT0FBTyxFQUNaLFdBQVcsUUFBUSxFQUNuQixRQUFRLE1BQU07QUF0RC9CO0FBdURvQixjQUFNLGdDQUFnQyxLQUFLLE9BQU8sd0JBQXdCLEtBQUssT0FBSyxFQUFFLE1BQU0sS0FBSyxlQUFlLEVBQUU7QUFDbEgsWUFBSSwrQkFBK0I7QUFDL0IsZUFBSyxPQUFPLHdCQUF3QixPQUFPLDZCQUE2QjtBQUFBLFFBQzVFO0FBQUM7QUFDRCxtQkFBSyxVQUFVLGtCQUFmLG1CQUE4QixZQUFZLEtBQUs7QUFDL0MsYUFBSyxPQUFPLGFBQWE7QUFBQSxNQUM3QixDQUFDO0FBQUEsSUFDVCxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsQUFBUSxrQkFBd0I7QUFDNUIsU0FBSyxVQUFVLENBQUMsTUFBTTtBQUNsQixRQUFFLFFBQVEsa0JBQWtCLEVBQ3ZCLFdBQVcsMEJBQTBCLEVBQ3JDLFFBQVEsTUFBTTtBQUNYLGNBQU0sNkJBQTZCLEtBQUssT0FBTyx3QkFBd0IsSUFBSSxTQUFPLElBQUksRUFBRSxFQUFFLFFBQVEsS0FBSyxlQUFlLEVBQUU7QUFDeEgsWUFBSSw2QkFBNkIsR0FBRztBQUNoQyxlQUFLLFlBQVksYUFBYSxLQUFLLFdBQVcsS0FBSyxVQUFVLHNCQUFzQjtBQUNuRixlQUFLLE9BQU8sd0JBQXdCLE9BQU8sNEJBQTRCLENBQUM7QUFDeEUsZUFBSyxPQUFPLHdCQUF3QixPQUFPLDZCQUE2QixHQUFHLEdBQUcsS0FBSyxjQUFjO0FBQ2pHLGVBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0I7QUFBQSxNQUNKLENBQUM7QUFBQSxJQUNULENBQUM7QUFBQSxFQUNMO0FBQ0o7OztBRDFFQSxJQUFxQiw4QkFBckIsY0FBeUQsd0JBQU07QUFBQSxFQU0zRCxZQUNZLFFBQ0Esd0JBQ0EsZUFDUixnQkFDRjtBQUNFLFVBQU0sT0FBTyxHQUFHO0FBTFI7QUFDQTtBQUNBO0FBUlosU0FBUSxRQUFpQjtBQUd6QixTQUFRLE1BQWU7QUFTbkIsU0FBSyx3QkFBd0IsSUFBSSx1QkFBZTtBQUNoRCxRQUFJLGdCQUFnQjtBQUNoQixXQUFLLE1BQU07QUFDWCxXQUFLLGlCQUFpQjtBQUN0Qiw2QkFBZSxhQUFhLEtBQUssdUJBQXVCLEtBQUssY0FBYztBQUFBLElBQy9FLE9BQU87QUFDSCxVQUFJLFFBQVE7QUFDWixXQUFLLE9BQU8sd0JBQXdCLFFBQVEsVUFBUTtBQUNoRCxZQUFJLFNBQVMsS0FBSyxFQUFFLEtBQUssU0FBUyxLQUFLLEVBQUUsS0FBSyxPQUFPO0FBQ2pELGtCQUFRLFNBQVMsS0FBSyxFQUFFLElBQUk7QUFBQSxRQUNoQztBQUFDO0FBQUEsTUFDTCxDQUFDO0FBQ0QsV0FBSyxpQkFBaUIsSUFBSSx1QkFBZTtBQUN6QyxXQUFLLGVBQWUsS0FBSyxNQUFNLFNBQVM7QUFDeEMsV0FBSyxzQkFBc0IsS0FBSyxNQUFNLFNBQVM7QUFBQSxJQUNuRDtBQUFDO0FBQ0QsU0FBSyxZQUFZLFNBQVMsZUFBZTtBQUFBLEVBQzdDO0FBQUEsRUFFQSxBQUFNLFNBQXdCO0FBQUE7QUFDMUIsVUFBSSxLQUFLLGVBQWUsUUFBUSxJQUFJO0FBQ2hDLGFBQUssUUFBUSxRQUFRLGdEQUFnRDtBQUFBLE1BQ3pFLE9BQU87QUFDSCxhQUFLLFFBQVEsUUFBUSxVQUFVLEtBQUssZUFBZSxlQUFlO0FBQUEsTUFDdEU7QUFBQztBQUNELFlBQU0sS0FBSyxXQUFXO0FBQUEsSUFDMUI7QUFBQTtBQUFBLEVBRUEsVUFBZ0I7QUFDWixXQUFPLE9BQU8sS0FBSyxnQkFBZ0IsS0FBSyxxQkFBcUI7QUFDN0QsUUFBSSxDQUFDLEtBQUssT0FBTyxLQUFLLGVBQWU7QUFDakMsV0FBSyxjQUFjLHVCQUF1QjtBQUFBLElBQzlDLFdBQVcsS0FBSyxPQUFPO0FBQ25CLFVBQUksc0JBQXNCLEtBQUssd0JBQXdCLEtBQUssZ0JBQWdCLEtBQUssTUFBTTtBQUFBLElBQzNGO0FBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLHlCQUF5QixXQUEwQztBQUN2RSxjQUFVLFVBQVUsRUFBRSxLQUFLLFNBQVMsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRSxVQUFNLFFBQVEsSUFBSSxnQ0FBYyxTQUFTO0FBQ3pDLFVBQU0sUUFBUSxTQUFTLFlBQVk7QUFDbkMsVUFBTSxRQUFRLFNBQVMsWUFBWTtBQUNuQyxVQUFNLE9BQU8sS0FBSyxlQUFlO0FBQ2pDLFVBQU0sU0FBUyxJQUFJO0FBQ25CLFVBQU0sZUFBZSw4QkFBOEI7QUFDbkQsVUFBTSxTQUFTLFdBQVM7QUFDcEIsV0FBSyxlQUFlLE9BQU87QUFDM0IsV0FBSyxRQUFRLFFBQVEsc0JBQXNCLEtBQUssZUFBZSxNQUFNO0FBQUEsSUFDekUsQ0FBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxBQUFRLGlDQUFpQyxXQUFpQztBQUN0RSxjQUFVLFVBQVUsRUFBRSxLQUFLLFNBQVMsTUFBTSxhQUFhLENBQUM7QUFDeEQsY0FBVSxVQUFVLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDckMsVUFBTSxTQUFTLElBQUksb0NBQWtCLFNBQVM7QUFDOUMsVUFBTSxpQkFBaUIsS0FBSyxPQUFPLFNBQVM7QUFDNUMsVUFBTSxjQUFjLEtBQUssT0FBTyxJQUFJLE1BQy9CLFNBQVMsRUFDVCxPQUFPLE9BQUssa0JBQWtCLEVBQUUsS0FBSyxXQUFXLGNBQWMsQ0FBQyxFQUMvRCxRQUFRO0FBQ2IsV0FBTyxVQUFVLDBCQUEwQix3QkFBd0I7QUFDbkUsZ0JBQVksUUFBUSxlQUFhO0FBQzdCLFlBQU0sZ0JBQWdCLFVBQVUseUJBQXlCLEtBQUssUUFBUSxVQUFVLElBQUk7QUFDcEYsVUFBSTtBQUFlLGVBQU8sVUFBVSxlQUFlLGFBQWE7QUFBQSxJQUNwRSxDQUFDO0FBQ0QsUUFBSSxLQUFLLGVBQWUsZUFBZTtBQUNuQyxhQUFPLFNBQVMsS0FBSyxlQUFlLGFBQWE7QUFBQSxJQUNyRDtBQUNBLFdBQU8sU0FBUyxXQUFTO0FBQ3JCLFVBQUksU0FBUywwQkFBMEI7QUFDbkMsYUFBSyxlQUFlLGdCQUFnQjtBQUFBLE1BQ3hDLE9BQU87QUFDSCxhQUFLLGVBQWUsZ0JBQWdCO0FBQUEsTUFDeEM7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxBQUFRLDBCQUEwQixXQUFpQztBQUMvRCxjQUFVLFVBQVUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ2pELFVBQU0sNEJBQTRCLFVBQVUsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDaEYsVUFBTSxtQkFBbUIsSUFBSSxvQ0FBa0IseUJBQXlCO0FBQ3hFLHFCQUFpQixRQUFRLFNBQVMsWUFBWTtBQUM5QyxxQkFBaUIsUUFBUSxPQUFPO0FBQ2hDLHFCQUFpQixTQUFTLEtBQUssZUFBZSxLQUFLO0FBQ25ELHFCQUFpQixTQUFTLFdBQVMsS0FBSyxlQUFlLFFBQVEsS0FBSztBQUFBLEVBQ3hFO0FBQUEsRUFFQSxBQUFjLGFBQTRCO0FBQUE7QUFHdEMsWUFBTSxnQkFBZ0IsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ3pFLFdBQUsseUJBQXlCLGFBQWE7QUFFM0MsWUFBTSwyQkFBMkIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ3BGLFdBQUssaUNBQWlDLHdCQUF3QjtBQUU5RCxZQUFNLDBCQUEwQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssV0FBVyxDQUFDO0FBQzVFLFdBQUssMEJBQTBCLHVCQUF1QjtBQUd0RCxZQUFNLFNBQVMsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQ2pFLGFBQU8sVUFBVSxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQ2xDLFdBQUssaUJBQWlCLE1BQU07QUFDNUIsV0FBSyxtQkFBbUIsTUFBTTtBQUFBLElBR2xDO0FBQUE7QUFBQSxFQUVBLEFBQVEsaUJBQWlCLFdBQWlDO0FBQ3RELFVBQU0sSUFBSSxJQUFJLGtDQUFnQixTQUFTO0FBQ3ZDLE1BQUUsV0FBVyxNQUFNO0FBQ25CLE1BQUUsUUFBUSxXQUFXO0FBQ3JCLE1BQUUsUUFBUSxNQUFZO0FBcEk5QjtBQXFJWSxVQUFJLEtBQUssZUFBZSxpQkFBaUIsS0FBSyxlQUFlLFFBQVEsS0FBSyxlQUFlLE9BQU87QUFDNUYsYUFBSyxRQUFRO0FBQ2IsY0FBTSxnQ0FBZ0MsS0FBSyxPQUFPLHdCQUM3QyxPQUFPLE9BQUssRUFBRSxNQUFNLEtBQUssZUFBZSxFQUFFLEVBQUU7QUFDakQsWUFBSSwrQkFBK0I7QUFDL0IsaUNBQWUsYUFBYSwrQkFBK0IsS0FBSyxjQUFjO0FBQUEsUUFDbEYsT0FBTztBQUNILGVBQUssT0FBTyx3QkFBd0IsS0FBSyxLQUFLLGNBQWM7QUFBQSxRQUNoRTtBQUFDO0FBQ0QsK0JBQWUsYUFBYSxLQUFLLHVCQUF1QixLQUFLLGNBQWM7QUFDM0UsWUFBSSxLQUFLO0FBQWUsaUNBQWUsYUFBYSxLQUFLLGNBQWMsZ0JBQWdCLEtBQUssY0FBYztBQUMxRyxtQkFBSyxrQkFBTCxtQkFBb0I7QUFDcEIsYUFBSyxPQUFPLGFBQWE7QUFDekIsYUFBSyxNQUFNO0FBQUEsTUFDZjtBQUFBLElBQ0osRUFBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLEFBQVEsbUJBQW1CLFdBQWlDO0FBQ3hELFVBQU0sSUFBSSxJQUFJLGtDQUFnQixTQUFTO0FBQ3ZDLE1BQUUsUUFBUSxPQUFPLEVBQ1osV0FBVyxRQUFRLEVBQ25CLFFBQVEsTUFBTTtBQUNYLFdBQUssUUFBUTtBQUViLFVBQUksS0FBSyxzQkFBc0IsUUFBUSxJQUFJO0FBQ3ZDLGVBQU8sT0FBTyxLQUFLLGdCQUFnQixLQUFLLHFCQUFxQjtBQUFBLE1BQ2pFO0FBQUM7QUFDRCxXQUFLLE1BQU07QUFBQSxJQUNmLENBQUM7QUFBQSxFQUNUO0FBQ0o7OztBRnhKQSxJQUFxQix5QkFBckIsY0FBb0QsbUNBQWlCO0FBQUEsRUFHcEUsWUFBWSxRQUFzQjtBQUNqQyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFDZCxTQUFLLFlBQVksU0FBUyxlQUFlO0FBQ3pDLFNBQUssWUFBWSxTQUFTLFVBQVU7QUFBQSxFQUNyQztBQUFBLEVBRUEsQUFBUSxtQkFBbUIsT0FBZSxVQUFtQixhQUFzQixPQUF1QjtBQUN6RyxVQUFNLGdCQUFnQixLQUFLLFlBQVksU0FBUyxLQUFLO0FBQ3JELFVBQU0seUJBQXlCLGNBQWMsU0FBUyxPQUFPLEVBQUUsS0FBSyxtQkFBbUIsQ0FBQztBQUN4RixVQUFNLDZCQUE2Qix1QkFBdUIsU0FBUyxPQUFPLEVBQUUsS0FBSyxpQkFBaUIsQ0FBQztBQUNuRywrQkFBMkIsU0FBUyxNQUFNLEVBQUUsTUFBTSxPQUFPLEtBQUssaUJBQWlCLENBQUM7QUFDaEYsUUFBSTtBQUFVLGlDQUEyQixTQUFTLE9BQU8sRUFBRSxNQUFNLFVBQVUsS0FBSywyQkFBMkIsQ0FBQztBQUU1RyxVQUFNLG9CQUFvQixLQUFLLFlBQVksU0FBUyxLQUFLO0FBQ3pELFFBQUksWUFBWTtBQUNmLFlBQU0sdUNBQXVDLHVCQUF1QixTQUFTLE9BQU8sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ25ILFlBQU0sOEJBQThCLElBQUksa0NBQWdCLG9DQUFvQztBQUM1RixrQ0FBNEIsU0FBUyxTQUFTLHNCQUFzQjtBQUNwRSx3QkFBa0IsS0FBSztBQUN2QixrQ0FBNEIsT0FBTztBQUNuQyxrQ0FBNEIsUUFBUSxrQkFBa0I7QUFFdEQsWUFBTSxjQUFjLE1BQU07QUFDekIsWUFBSSxrQkFBa0IsUUFBUSxHQUFHO0FBQ2hDLDRCQUFrQixLQUFLO0FBQ3ZCLHNDQUE0QixRQUFRLGtCQUFrQjtBQUN0RCxzQ0FBNEIsT0FBTztBQUFBLFFBQ3BDLE9BQU87QUFDTiw0QkFBa0IsS0FBSztBQUN2QixzQ0FBNEIsUUFBUSxrQkFBa0I7QUFDdEQsc0NBQTRCLFVBQVU7QUFBQSxRQUN2QztBQUFBLE1BQ0Q7QUFDQSxrQ0FBNEIsUUFBUSxNQUFNLFlBQVksQ0FBQztBQUFBLElBQ3hEO0FBR0EsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsUUFBSSxFQUFFLGdCQUFnQjtBQUN0QixnQkFBWSxNQUFNO0FBT2xCLFVBQU0saUJBQWlCLEtBQUssbUJBQzNCLG1CQUNBLGdEQUNBLElBQ0Q7QUFHQSxRQUFJLDBCQUFRLGNBQWMsRUFDeEIsUUFBUSx1Q0FBdUMsRUFDL0MsUUFBUSwrRUFBK0UsRUFDdkYsVUFBVSxDQUFDLFdBQTRCO0FBQ3ZDLGFBQU8sU0FBUyxLQUFLLE9BQU8sU0FBUywwQkFBMEI7QUFDL0QsYUFBTyxTQUFTLENBQU0sVUFBUztBQUM5QixhQUFLLE9BQU8sU0FBUyw2QkFBNkI7QUFDbEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLEVBQUM7QUFBQSxJQUNGLENBQUMsRUFBRSxVQUFVLFNBQVMsV0FBVztBQUVsQyxVQUFNLCtCQUErQixJQUFJLDBCQUFRLGNBQWMsRUFDN0QsUUFBUSx5QkFBeUIsRUFDakMsUUFBUSw0RUFBNEUsRUFDcEYsWUFBWSxDQUFDLFNBQVM7QUFDdEIsV0FDRSxlQUFlLHlDQUF5QyxFQUN4RCxTQUFTLEtBQUssT0FBTyxTQUFTLHNCQUFzQixLQUFLLElBQUksQ0FBQyxFQUM5RCxTQUFTLENBQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyx3QkFBd0IsTUFBTSxNQUFNLEdBQUcsRUFBRSxJQUFJLFVBQVEsS0FBSyxLQUFLLENBQUM7QUFDckYsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLEVBQUM7QUFDRixXQUFLLFFBQVEsT0FBTztBQUNwQixXQUFLLFFBQVEsT0FBTztBQUFBLElBQ3JCLENBQUM7QUFDRixpQ0FBNkIsVUFBVSxTQUFTLFVBQVU7QUFDMUQsaUNBQTZCLFVBQVUsU0FBUyxXQUFXO0FBQzNELGlDQUE2QixVQUFVLFNBQVMsWUFBWTtBQUc1RCxVQUFNLHFCQUFxQixJQUFJLDBCQUFRLGNBQWMsRUFDbkQsUUFBUSxjQUFjLEVBQ3RCLFFBQVEsOEJBQThCLEVBQ3RDLFVBQVUsUUFBTTtBQUNoQixTQUFHLFNBQVMsS0FBSyxPQUFPLFNBQVMsb0JBQW9CO0FBQ3JELFNBQUcsU0FBUyxXQUFTO0FBQ3BCLGFBQUssT0FBTyxTQUFTLHVCQUF1QjtBQUM1QyxhQUFLLE9BQU8sYUFBYTtBQUFBLE1BQzFCLENBQUM7QUFBQSxJQUNGLENBQUM7QUFDRix1QkFBbUIsVUFBVSxTQUFTLFdBQVc7QUFDakQsdUJBQW1CLFVBQVUsU0FBUyxZQUFZO0FBSWxELFVBQU0seUJBQXlCLElBQUksMEJBQVEsY0FBYyxFQUN2RCxRQUFRLDBCQUEwQixFQUNsQyxRQUFRLG9GQUFvRixFQUM1RixZQUFZLENBQUMsT0FBMEI7QUFDdkMsT0FBQyxDQUFDLFNBQVMsU0FBUyxHQUFHLENBQUMsaUJBQWlCLFFBQVEsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDLFNBQVMsV0FBdUM7QUFDN0csV0FBRyxVQUFVLE9BQU8sT0FBTztBQUFBLE1BQzVCLENBQUM7QUFDRCxTQUFHLFNBQVMsS0FBSyxPQUFPLFNBQVMsMEJBQTBCLHVCQUF3QjtBQUNuRixTQUFHLFNBQVMsQ0FBTyxVQUE0QjtBQUM5QyxhQUFLLE9BQU8sU0FBUyx5QkFBeUI7QUFDOUMsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLEVBQUM7QUFBQSxJQUNGLENBQUM7QUFDRiwyQkFBdUIsVUFBVSxTQUFTLFdBQVc7QUFDckQsMkJBQXVCLFVBQVUsU0FBUyxZQUFZO0FBR3RELFFBQUksMEJBQVEsY0FBYyxFQUN4QixRQUFRLG1CQUFtQixFQUMzQixRQUFRLHFFQUFzRSxFQUM5RSxZQUFZLENBQUMsT0FBMEI7QUFDdkMsZUFBUyxJQUFJLEdBQUcsSUFBSSxHQUFHLEtBQUs7QUFDM0IsV0FBRyxVQUFVLEVBQUUsU0FBUyxHQUFHLDhCQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsT0FBTyxNQUFNLENBQUM7QUFBQSxNQUMxRDtBQUNBLFNBQUcsU0FBUyxLQUFLLE9BQU8sU0FBUyxlQUFlLFNBQVMsS0FBSyxHQUFHO0FBQ2pFLFNBQUcsU0FBUyxDQUFPLFVBQVU7QUFDNUIsYUFBSyxPQUFPLFNBQVMsaUJBQWlCLFNBQVMsS0FBSztBQUNwRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEMsRUFBQztBQUFBLElBQ0YsQ0FBQyxFQUFFLFVBQVUsU0FBUyxXQUFXO0FBUWxDLGdCQUFZLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ2hELFVBQU0sdUJBQXVCLEtBQUssbUJBQ2pDLDBCQUNBLHVGQUNBLElBQ0Q7QUFDQSxRQUFJLDBCQUFRLG9CQUFvQixFQUM5QixRQUFRLHVCQUF1QixFQUMvQixRQUFRLG1FQUFtRSxFQUMzRSxVQUFVLENBQUMsV0FBNkM7QUFDeEQsYUFBTyxPQUNMLFdBQVcsMEJBQTBCLEVBQ3JDLGNBQWMsU0FBUyxFQUN2QixPQUFPLEVBQ1AsUUFBUSxNQUFZO0FBQ3BCLFlBQUksUUFBUSxJQUFJLG1CQUFtQixLQUFLLFFBQVEsb0JBQW9CO0FBQ3BFLGNBQU0sS0FBSztBQUFBLE1BQ1osRUFBQztBQUFBLElBQ0gsQ0FBQyxFQUFFLFVBQVUsU0FBUyxXQUFXO0FBR2xDLFNBQUssT0FBTyxrQkFBa0IsUUFBUSxVQUFRO0FBQzdDLFlBQU0sV0FBVyxJQUFJLGNBQU07QUFDM0IsYUFBTyxPQUFPLFVBQVUsSUFBSTtBQUM1QixVQUFJLGFBQWEsc0JBQXNCLFVBQVUsS0FBSyxNQUFNO0FBQUEsSUFDN0QsQ0FBQztBQVNELGdCQUFZLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ2hELFVBQU0scUJBQXFCLEtBQUssbUJBQy9CLHNCQUNBLDBLQUdBLElBQ0Q7QUFFQSxVQUFNLE9BQU8sSUFBSSwwQkFBUSxrQkFBa0IsRUFDekMsUUFBUSxrQkFBa0IsRUFDMUIsUUFBUSx1RUFBdUUsRUFDL0UsVUFBVSxDQUFDLFFBQVE7QUFDbkIsVUFBSSxjQUFjLEtBQUssUUFBUSxJQUFJLE9BQU87QUFDMUMsVUFBSSxlQUFlLFFBQVEsRUFDekIsU0FBUyxLQUFLLE9BQU8sU0FBUyxrQkFBa0IsRUFBRSxFQUNsRCxTQUFTLENBQUMsZUFBZTtBQUN6QixjQUFNLFVBQVUsV0FBVyxTQUFTLEdBQUcsS0FBSyxDQUFDLGFBQWEsYUFBYSxhQUFhO0FBQ3BGLGFBQUssT0FBTyxTQUFTLGlCQUFpQixXQUFXO0FBQ2pELGFBQUssT0FBTyxhQUFhO0FBQUEsTUFDMUIsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUNGLFNBQUssVUFBVSxTQUFTLFdBQVc7QUFDbkMsU0FBSyxVQUFVLFNBQVMsY0FBYztBQUN0QyxTQUFLLFVBQVUsU0FBUyxZQUFZO0FBRXBDLFVBQU0sUUFBUSxJQUFJLDBCQUFRLGtCQUFrQixFQUMxQyxRQUFRLHVCQUF1QixFQUMvQixRQUFRLHNGQUFzRixFQUM5RixRQUFRLENBQUMsU0FBUztBQUNsQixXQUNFLFNBQVMsS0FBSyxPQUFPLFNBQVMsY0FBYyxFQUM1QyxTQUFTLENBQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxpQkFBaUIsU0FBUztBQUMvQyxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEMsRUFBQztBQUFBLElBQ0gsQ0FBQztBQUNGLFVBQU0sVUFBVSxTQUFTLFdBQVc7QUFDcEMsVUFBTSxVQUFVLFNBQVMsY0FBYztBQUN2QyxVQUFNLFVBQVUsU0FBUyxZQUFZO0FBS3JDLFVBQU0sU0FBUyxJQUFJLDBCQUFRLGtCQUFrQixFQUMzQyxRQUFRLGtCQUFrQixFQUMxQixRQUFRLCtLQUU0QyxFQUNwRCxVQUFVLENBQUMsUUFBUTtBQUNuQixVQUFJLFlBQ0gsSUFBSSxTQUNKLEtBQUssUUFDTCxLQUFLLE9BQU8sU0FBUyxrQkFBa0IsRUFDeEM7QUFDQSxVQUFJLGVBQWUsa0JBQWtCO0FBQ3JDLFVBQUksU0FDSCxLQUFLLE9BQU8sU0FBUyxrQkFDcEIsS0FBSyxPQUFPLFNBQVMsaUJBQWlCLEtBQUssT0FBTyxTQUFTLGtCQUFrQixRQUM3RSxFQUNGLEVBQ0UsU0FBUyxDQUFDLFlBQVk7QUF6UDVCO0FBMFBNLGFBQUssT0FBTyxTQUFTLGtCQUFrQixVQUN0QyxjQUFRLE1BQU0sSUFBSSxFQUFFLElBQUksRUFBRyxNQUFNLEdBQUcsRUFBRSxJQUFJLE1BQTFDLG1CQUE2QyxRQUFRLE9BQU8sTUFDNUQ7QUFDRCxhQUFLLE9BQU8sYUFBYTtBQUFBLE1BQzFCLENBQUM7QUFBQSxJQUNILENBQUM7QUFDRixXQUFPLFVBQVUsU0FBUyxXQUFXO0FBQ3JDLFdBQU8sVUFBVSxTQUFTLGNBQWM7QUFDeEMsV0FBTyxVQUFVLFNBQVMsWUFBWTtBQU90QyxnQkFBWSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNoRCxVQUFNLDBCQUEwQixLQUFLLG1CQUNwQyx3QkFDQSw2REFDQSxJQUFJO0FBRUwsUUFBSSwwQkFBUSx1QkFBdUIsRUFDakMsUUFBUSwyQkFBMkIsRUFDbkMsUUFBUSx3REFBd0QsRUFDaEUsUUFBUSxDQUFDLFNBQVM7QUFDbEIsV0FDRSxTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsRUFDeEMsU0FBUyxDQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsYUFBYSxTQUFTO0FBQzNDLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNoQyxFQUFDO0FBQUEsSUFDSCxDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFFbEMsUUFBSSwwQkFBUSx1QkFBdUIsRUFDakMsUUFBUSxvQkFBb0IsRUFDNUIsUUFBUSxtRkFBbUYsRUFDM0YsVUFBVSxRQUFNO0FBQ2hCLFNBQUcsU0FBUyxLQUFLLE9BQU8sU0FBUyxXQUFXO0FBQzVDLFNBQUcsU0FBUyxXQUFTO0FBQ3BCLGFBQUssT0FBTyxTQUFTLGNBQWM7QUFDbkMsYUFBSyxPQUFPLGFBQWE7QUFBQSxNQUMxQixDQUFDO0FBQUEsSUFDRixDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFFbEMsUUFBSSwwQkFBUSx1QkFBdUIsRUFDakMsUUFBUSxtQkFBbUIsRUFDM0IsUUFBUSxtRkFBbUYsRUFDM0YsVUFBVSxRQUFNO0FBQ2hCLFNBQUcsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZO0FBQzdDLFNBQUcsU0FBUyxXQUFTO0FBQ3BCLGFBQUssT0FBTyxTQUFTLGVBQWU7QUFDcEMsYUFBSyxPQUFPLGFBQWE7QUFBQSxNQUMxQixDQUFDO0FBQUEsSUFDRixDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFFbEMsUUFBSSwwQkFBUSx1QkFBdUIsRUFDakMsUUFBUSxZQUFZLEVBQ3BCLFFBQVEsd0VBQXdFLEVBQ2hGLFVBQVUsUUFBTTtBQUNoQixTQUFHLFNBQVMsS0FBSyxPQUFPLFNBQVMsZUFBZTtBQUNoRCxTQUFHLFNBQVMsV0FBUztBQUNwQixhQUFLLE9BQU8sU0FBUyxrQkFBa0I7QUFDdkMsYUFBSyxPQUFPLGFBQWE7QUFBQSxNQUMxQixDQUFDO0FBQUEsSUFDRixDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFFbEMsUUFBSSwwQkFBUSx1QkFBdUIsRUFDakMsUUFBUSxXQUFXLEVBQ25CLFFBQVEsNkVBQTZFLEVBQ3JGLFVBQVUsUUFBTTtBQUNoQixTQUFHLFNBQVMsS0FBSyxPQUFPLFNBQVMsZUFBZTtBQUNoRCxTQUFHLFNBQVMsV0FBUztBQUNwQixhQUFLLE9BQU8sU0FBUyxrQkFBa0I7QUFDdkMsYUFBSyxPQUFPLGFBQWE7QUFBQSxNQUMxQixDQUFDO0FBQUEsSUFDRixDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFFbEMsUUFBSSwwQkFBUSx1QkFBdUIsRUFDakMsUUFBUSxRQUFRLEVBQ2hCLFFBQVEsMEVBQTBFLEVBQ2xGLFVBQVUsUUFBTTtBQUNoQixTQUFHLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWTtBQUM3QyxTQUFHLFNBQVMsV0FBUztBQUNwQixhQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLGFBQUssT0FBTyxhQUFhO0FBQUEsTUFDMUIsQ0FBQztBQUFBLElBQ0YsQ0FBQyxFQUFFLFVBQVUsU0FBUyxXQUFXO0FBRWxDLFFBQUksMEJBQVEsdUJBQXVCLEVBQ2pDLFFBQVEsZUFBZSxFQUN2QixRQUFRLDJFQUEyRSxFQUNuRixVQUFVLFFBQU07QUFDaEIsU0FBRyxTQUFTLEtBQUssT0FBTyxTQUFTLGtCQUFrQjtBQUNuRCxTQUFHLFNBQVMsV0FBUztBQUNwQixhQUFLLE9BQU8sU0FBUyxxQkFBcUI7QUFDMUMsYUFBSyxPQUFPLGFBQWE7QUFBQSxNQUMxQixDQUFDO0FBQUEsSUFDRixDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFFbEMsUUFBSSwwQkFBUSx1QkFBdUIsRUFDakMsUUFBUSxTQUFTLEVBQ2pCLFFBQVEsMkVBQTJFLEVBQ25GLFVBQVUsUUFBTTtBQUNoQixTQUFHLFNBQVMsS0FBSyxPQUFPLFNBQVMsYUFBYTtBQUM5QyxTQUFHLFNBQVMsV0FBUztBQUNwQixhQUFLLE9BQU8sU0FBUyxnQkFBZ0I7QUFDckMsYUFBSyxPQUFPLGFBQWE7QUFBQSxNQUMxQixDQUFDO0FBQUEsSUFDRixDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFTbEMsZ0JBQVksVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDaEQsVUFBTSx5QkFBeUIsS0FBSyxtQkFDbkMsa0NBQ0EsK0VBQ0EsSUFDRDtBQUNBLFFBQUksMEJBQVEsc0JBQXNCLEVBQ2hDLFFBQVEsNkJBQTZCLEVBQ3JDLFFBQVEsK0VBQStFLEVBQ3ZGLFVBQVUsQ0FBQyxXQUE2QztBQUN4RCxhQUFPLE9BQ0wsV0FBVyx5QkFBeUIsRUFDcEMsY0FBYyxTQUFTLEVBQ3ZCLE9BQU8sRUFDUCxRQUFRLE1BQVk7QUFDcEIsWUFBSSxRQUFRLElBQUksNEJBQTRCLEtBQUssUUFBUSxzQkFBc0I7QUFDL0UsY0FBTSxLQUFLO0FBQUEsTUFDWixFQUFDO0FBQUEsSUFDSCxDQUFDLEVBQUUsVUFBVSxTQUFTLFdBQVc7QUFHbEMsU0FBSyxPQUFPLHdCQUNWLFFBQVEsV0FBUztBQUNqQixZQUFNLGlCQUFpQixJQUFJLHVCQUFlO0FBQzFDLGFBQU8sT0FBTyxnQkFBZ0IsS0FBSztBQUNuQyxVQUFJLHNCQUFzQix3QkFBd0IsZ0JBQWdCLEtBQUssTUFBTTtBQUFBLElBQzlFLENBQUM7QUFBQSxFQUNIO0FBQ0Q7OztBSTNYTyxJQUFNLHdCQUF3QixDQUFPLFdBQXlCO0FBQ2pFLFFBQU0sZUFBZSxPQUFPLFNBQVM7QUFDckMsZUFBYSxRQUFRLENBQUMsTUFBZTtBQUNqQyxRQUFJLENBQUMsT0FBTyxLQUFLLENBQUMsRUFBRSxTQUFTLE1BQU0sR0FBRztBQUNsQyxVQUFJLEVBQUU7QUFBUyxVQUFFLE9BQU87QUFBQSxlQUNmLEVBQUU7QUFBUyxVQUFFLE9BQU87QUFBQSxlQUNwQixFQUFFO0FBQVcsVUFBRSxPQUFPO0FBQUEsZUFDdEIsRUFBRSxXQUFXLE9BQU8sS0FBSyxFQUFFLE9BQU8sRUFBRSxTQUFTO0FBQUcsVUFBRSxPQUFPO0FBQUE7QUFDN0QsVUFBRSxPQUFPO0FBQUEsSUFDbEI7QUFFQSxXQUFPLEVBQUU7QUFDVCxXQUFPLEVBQUU7QUFDVCxXQUFPLEVBQUU7QUFFVCxRQUFJLE9BQU8seUJBQXlCLEdBQUcsUUFBUSxNQUFNLFFBQVc7QUFDNUQsYUFBTyxlQUFlLEdBQUcsV0FDckIsT0FBTyx5QkFBeUIsR0FBRyxRQUFRLENBQUU7QUFDakQsYUFBTyxFQUFFO0FBQUEsSUFDYjtBQUFBLEVBQ0osQ0FBQztBQUNELFNBQU8sU0FBUyxrQkFBa0I7QUFDbEMsUUFBTSxPQUFPLFNBQVMsT0FBTyxRQUFRO0FBQ3JDLFVBQVEsSUFBSSw4Q0FBOEM7QUFDOUQ7QUFFTyxJQUFNLHdCQUF3QixDQUFPLFdBQXlCO0FBQ2pFLFFBQU0sZUFBZSxPQUFPLFNBQVM7QUFDckMsZUFBYSxRQUFRLENBQUMsTUFBZTtBQUNqQyxRQUFJLENBQUMsdUJBQWtCLG1CQUFlLEVBQUUsU0FBUyxFQUFFLElBQUksR0FBRztBQUV0RCxZQUFNLG9CQUFvQixPQUFPLEtBQUssRUFBRSxPQUFPO0FBQy9DLFFBQUUsUUFBUSxhQUFhLENBQUM7QUFDeEIsd0JBQWtCLFFBQVEsU0FBTyxFQUFFLFFBQVEsV0FBVyxPQUFPLEVBQUUsUUFBUSxJQUFJO0FBRTNFLFVBQUksRUFBRSxvQkFBb0I7QUFDdEIsY0FBTSxhQUFhO0FBQ25CLFVBQUUsUUFBUSxhQUFhO0FBQ3ZCLFVBQUUsUUFBUSxBQUFtQixJQUFJO0FBQUEsTUFDckMsT0FBTztBQUNILFVBQUUsUUFBUSxhQUFhO0FBQUEsTUFDM0I7QUFFQSxRQUFFLFFBQVEscUJBQXFCLEVBQUU7QUFFakMsd0JBQWtCLFFBQVEsU0FBTyxPQUFPLEVBQUUsUUFBUSxJQUFJO0FBRXRELFFBQUUsUUFBUSxvQkFBb0I7QUFBQSxJQUNsQztBQUNBLFdBQU8sRUFBRTtBQUFBLEVBQ2IsQ0FBQztBQUNELFNBQU8sU0FBUyxrQkFBa0I7QUFDbEMsUUFBTSxPQUFPLFNBQVMsT0FBTyxRQUFRO0FBQ3JDLFVBQVEsSUFBSSw4Q0FBOEM7QUFDOUQ7OztBQ3JFQSx3QkFVTztBQVlBLElBQU0sYUFBYTtBQUUxQixJQUFxQixlQUFyQixjQUEwQyxnQ0FBZ0M7QUFBQSxFQVF0RSxZQUFZLFFBQXNCO0FBQzlCLFVBQU0sT0FBTyxHQUFHO0FBUHBCLFNBQVEsZ0JBQXlCO0FBQ2pDLFNBQVEsYUFBc0I7QUFDOUIsU0FBUSxhQUFzQjtBQUM5QixTQUFRLFlBQXFCO0FBbUU3QixTQUFRLGVBQWUsQ0FBQyxhQUFtQyxXQUErQixXQUE0QjtBQUNsSCxhQUFPLENBQUMsZUFDSixDQUFDLDRDQUFhLFNBQVMsV0FBVyxNQUFNLE9BQU8sRUFBQyxhQUM1QyxDQUFDLENBQUMsYUFBYSxXQUFXLE1BQU0sRUFBRSxTQUFTLFNBQVM7QUFBQSxJQUNoRTtBQWxFSSxTQUFLLFNBQVM7QUFDZCxTQUFLLGdCQUFnQixDQUFDLEVBQUUsU0FBUyxTQUFTLFNBQVMsdUJBQXVCLENBQUMsQ0FBQztBQUc1RSxTQUFLLE1BQU0sU0FBUyxDQUFDLE9BQU8sR0FBRyxTQUFTLENBQUMsUUFBdUI7QUFFNUQsV0FBSyxZQUFZLGdCQUFnQixHQUFHO0FBQ3BDLGFBQU87QUFBQSxJQUNYLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxnQkFBZ0IsUUFBZ0IsUUFBaUM7QUFDN0QsUUFBSSxpQkFBcUM7QUFDekMsUUFBSSxPQUFPLFFBQVEsQ0FBQyxNQUFNLE9BQU87QUFDN0IsZUFBUyxJQUFJLEdBQUcsS0FBSyxPQUFPLFNBQVMsR0FBRyxLQUFLO0FBQ3pDLFlBQUksT0FBTyxRQUFRLENBQUMsTUFBTSxPQUFPO0FBQzdCLDJCQUFpQjtBQUNqQjtBQUFBLFFBQ0o7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUNBLFdBQU8sQ0FBQyxDQUFDLGtCQUFrQixPQUFPLE9BQU87QUFBQSxFQUM3QztBQUFBLEVBRUEsVUFDSSxRQUNBLFFBQ0EsTUFDK0I7QUFDL0IsUUFBSSxLQUFLLFdBQVc7QUFDaEIsV0FBSyxZQUFZO0FBQ2pCLGFBQU87QUFBQSxJQUNYO0FBQ0EsUUFBSSxDQUFDLEtBQUssT0FBTyxTQUFTLHNCQUFzQjtBQUM1QyxhQUFPO0FBQUEsSUFDWDtBQUFDO0FBQ0QsUUFBSSw4QkFBTSxlQUFjO0FBQU0sYUFBTztBQUNyQyxVQUFNLFdBQVcsT0FBTyxRQUFRLE9BQU8sVUFBVSxFQUFFLElBQUk7QUFDdkQsU0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsUUFBUSxNQUFNO0FBQ3hELFFBQUksS0FBSyxlQUFlO0FBQ3BCLFlBQU0sUUFBUSxJQUFJLE9BQU8sSUFBSSxtQ0FBbUMsR0FBRztBQUNuRSxVQUFJLENBQUMsTUFBTSxLQUFLLFFBQVEsS0FBSyxDQUFDLFNBQVMsV0FBVyxVQUFVLEdBQUc7QUFDM0QsZUFBTztBQUFBLE1BQ1gsT0FBTztBQUdILGNBQU0sT0FBTyxPQUFPLFFBQVEsT0FBTyxJQUFJO0FBQ3ZDLGNBQU0sZUFBZSxLQUFLLFFBQVEsR0FBRztBQUNyQyxZQUFJLENBQUMsQ0FBQyxJQUFJLEdBQUcsRUFBRSxTQUFTLEtBQUssTUFBTSxlQUFlLEdBQUcsZUFBZSxDQUFDLENBQUMsR0FBRztBQUNyRSxpQkFBTyxhQUFhLEtBQUssRUFBRSxNQUFNLE9BQU8sTUFBTSxJQUFJLGVBQWUsRUFBRSxHQUFHLEVBQUUsTUFBTSxPQUFPLE1BQU0sSUFBSSxlQUFlLEVBQUUsQ0FBQztBQUFBLFFBQ3JIO0FBQUEsTUFDSjtBQUFDO0FBQUEsSUFDTCxXQUFXLGNBQWMsUUFBUSxFQUFFLFdBQVcsR0FBRztBQUM3QyxhQUFPO0FBQUEsSUFDWDtBQUNBLFdBQU87QUFBQSxNQUNILE9BQU87QUFBQSxNQUNQLEtBQUs7QUFBQSxNQUNMLE9BQU8sT0FBTyxRQUFRLE9BQU8sSUFBSTtBQUFBLElBQ3JDO0FBQUEsRUFDSjtBQUFBLEVBUUEsQUFBUSxTQUFTLE9BQWtDO0FBdkd2RDtBQXdHUSxVQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUN4RCxRQUFJLFFBQTRCO0FBQ2hDLFFBQUksU0FBUyxZQUFLLFVBQUwsbUJBQVksUUFBUSxrQkFBaUI7QUFDOUMsY0FBUSxJQUFJLFNBQVMsUUFBUSxVQUFVLEtBQUssTUFBTSxRQUFRLGlCQUFpQixFQUFFLE1BQU0sS0FBSyxNQUFNLElBQUksQ0FBQztBQUFBLElBQ3ZHO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLEFBQU0sZUFBZSxTQUE0RDtBQUFBO0FBQzdFLFlBQU0sY0FBYyxNQUFNLEtBQUssb0JBQW9CLE9BQU87QUFDMUQsVUFBSSxZQUFZLFFBQVE7QUFDcEIsZUFBTztBQUFBLE1BQ1g7QUFDQSxhQUFPLENBQUM7QUFBQSxJQUNaO0FBQUE7QUFBQSxFQUVBLEFBQU0sb0JBQW9CLFNBQTREO0FBQUE7QUF4SDFGO0FBeUhRLFlBQU0sYUFBYSxRQUFRLE1BQU07QUFDakMsWUFBTSxhQUF3RCxFQUFFLFdBQVcsUUFBVyxRQUFRLENBQUMsRUFBRTtBQUNqRyxZQUFNLFFBQVEsV0FBSyxPQUFPLElBQUksUUFBUSxRQUFRLGFBQWhDLG1CQUEwQztBQUV4RCxZQUFNLGNBQWMsQ0FBQyxXQUErQjtBQUNoRCxlQUFPLGtDQUFRLFFBQVEsdUJBQXVCLElBQ3pDLFFBQVEsV0FBVyxJQUNuQixNQUFNLEtBQ04sSUFBSSxPQUFLLFdBQVcsRUFBRSxLQUFLLENBQUMsT0FBTSxDQUFDLEVBQUU7QUFBQSxNQUM5QztBQUVBLFlBQU0seUJBQXlCLENBQUMsT0FBYyxhQUFtQyxjQUFrQztBQXBJM0g7QUFxSVksY0FBTSxlQUFlLElBQUksYUFBYSxNQUFNLE1BQU0sS0FBSyxRQUFRLEtBQUssS0FBSztBQUN6RSxjQUFNLGNBQWUsYUFDaEIsZUFBZSxNQUFNLEtBQUssWUFBSyxZQUFMLG9CQUFjLEtBQUssSUFBSSxDQUFDLEVBQ2xELE9BQU8sWUFBVTtBQUNkLGlCQUFPLEtBQUssYUFBYSxhQUFhLFdBQVcsTUFBTTtBQUFBLFFBQzNELENBQUMsRUFDQSxJQUFJLFlBQVUsT0FBTyxFQUFFLE1BQU0sTUFBTSxNQUFNLE9BQU8sT0FBTyxDQUFDLENBQUM7QUFDOUQsZUFBTztBQUFBLE1BQ1g7QUFFQSxVQUFJLENBQUMsS0FBSyxlQUFlO0FBQ3JCLGNBQU0sYUFBYSxjQUFjLFdBQVcsUUFBUSxPQUFPLFFBQVEsVUFBVSxDQUFDLENBQUM7QUFDL0UsY0FBTSxXQUFXLFFBQVEsT0FBTyxVQUFVLEVBQUU7QUFDNUMsY0FBTSxrQkFBa0IsV0FBVyxLQUFLLGVBQWEsVUFBVSxTQUFTLFlBQVksVUFBVSxRQUFRLFVBQVUsVUFBVSxRQUFRO0FBQ2xJLFlBQUksaUJBQWlCO0FBQ2pCLGVBQUssYUFBYSxnQkFBZ0IsUUFBUTtBQUMxQyxlQUFLLGFBQWEsZ0JBQWdCLFVBQVU7QUFDNUMscUJBQVcsWUFBWSxnQkFBZ0I7QUFDdkMscUJBQVcsU0FBUyxZQUFZLGdCQUFnQixNQUFNO0FBQUEsUUFDMUQ7QUFBQSxNQUNKLE9BQU87QUFDSCxjQUFNLGFBQWEsSUFBSSxPQUFPLElBQUksb0NBQW9DLEdBQUc7QUFDekUsY0FBTSxnQkFBZ0IsSUFBSSxPQUFPLElBQUksNEJBQTRCLEdBQUc7QUFDcEUsWUFBSSxZQUFZO0FBQ2hCLGVBQU8sQ0FBQyxRQUFRLE9BQU8sUUFBUSxTQUFTLEVBQUUsU0FBUyxHQUFHLEtBQUssWUFBWTtBQUFHLHNCQUFZLFlBQVk7QUFDbEcsY0FBTSxjQUFjLFFBQVEsT0FBTyxTQUFTLEVBQUUsTUFBTSxXQUFXLElBQUksRUFBRSxHQUFHLFFBQVEsR0FBRyxFQUFFLE1BQU0sVUFBVTtBQUNyRyxZQUFJLDJDQUFhLFFBQVE7QUFDckIscUJBQVcsWUFBWSxZQUFZLE9BQU87QUFDMUMscUJBQVcsU0FBUyxZQUFZLFlBQVksT0FBTyxNQUFNO0FBQUEsUUFDN0Q7QUFDQSxZQUFJLElBQUk7QUFDUixlQUFPLFFBQVEsT0FBTyxRQUFRLFlBQVksQ0FBQyxFQUFFLFdBQVcsVUFBVSxLQUFLLFlBQVksS0FBSyxRQUFRLE9BQU8sU0FBUyxHQUFHO0FBQy9HLGdCQUFNLGVBQWMsUUFBUSxPQUFPLFFBQVEsWUFBWSxDQUFDLEVBQUUsTUFBTSxhQUFhO0FBQzdFLGNBQUksNkNBQWE7QUFBUSw2QkFBVyxXQUFYLG1CQUFtQixLQUFLLEdBQUcsWUFBWSxhQUFZLE9BQU8sTUFBTTtBQUN6RixlQUFLO0FBQUEsUUFDVDtBQUFBLE1BQ0o7QUFBQztBQUVELFVBQUksV0FBVyxXQUFXO0FBQ3RCLGNBQU0sWUFBWSxXQUFXO0FBQzdCLGFBQUssUUFBUSxXQUFLLE9BQU8sV0FBVyxZQUFZLElBQUksUUFBUSxLQUFLLElBQUksTUFBeEQsbUJBQTJELEtBQUssT0FBSyxFQUFFLFNBQVM7QUFDN0YsY0FBTSxhQUFhLFdBQVc7QUFDOUIsY0FBTSxZQUFZLHlDQUFZO0FBQzlCLGNBQU0sY0FBYyx5Q0FBWSxNQUFNLEdBQUc7QUFHekMsWUFBSSxjQUFjLFVBQVUsS0FBSyxlQUFlO0FBRTVDLGlCQUFPLE9BQU8sS0FBSyxLQUFLLE9BQU8sSUFBSSxjQUFjLFFBQVEsQ0FBQyxFQUNyRCxPQUFPLE9BQUssWUFBWSxFQUFFLFNBQVMsU0FBUyxJQUFJLENBQUMsRUFDakQsS0FBSyxFQUNMLElBQUksU0FBTyxPQUFPLEVBQUUsTUFBTSxXQUFXLE9BQU8sSUFBSSxRQUFRLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQztBQUFBLFFBQzdFO0FBQ0EsWUFBSSxLQUFLLFNBQVMsQ0FBQyxxQkFBaUIscUJBQWlCLHFCQUFnQixFQUFFLFNBQVMsS0FBSyxNQUFNLElBQUksR0FBRztBQUM5RixpQkFBTyx1QkFBdUIsS0FBSyxPQUFPLGFBQWEsU0FBUztBQUFBLFFBQ3BFLFdBQVcsS0FBSyxTQUFTLENBQUMsbUJBQWdCLDJCQUFtQixFQUFFLFNBQVMsS0FBSyxNQUFNLElBQUksR0FBRztBQUN0RixnQkFBTSxnQkFBZ0IsSUFBSSxTQUFTLEtBQUssS0FBSyxVQUFVLEtBQUssTUFBTSxRQUFRLGVBQWUsS0FDckYsU0FBVSxHQUFVLEdBQVU7QUFBRSxtQkFBTyxFQUFFLFdBQVcsRUFBRSxXQUFXLEtBQUs7QUFBQSxVQUFFO0FBQzVFLGdCQUFNLGVBQTBCLElBQUksYUFBYSxLQUFLLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSyxLQUFLO0FBQ3pGLGdCQUFNLFFBQVEsYUFBYSxTQUFTLFdBQUssWUFBTCxtQkFBYyxJQUFJLEVBQUUsS0FBSyxhQUErQztBQUM1RyxjQUFJLFdBQVc7QUFDWCxrQkFBTSxVQUFVLE1BQ1gsT0FBTyxPQUFFO0FBbk1sQztBQW1NcUMsdUJBQUUsU0FBUyxZQUFZLEVBQUUsU0FBUyxVQUFVLFlBQVksQ0FBQyxLQUMvRCxhQUFLLFNBQVMsQ0FBQyxNQUFmLG9CQUFrQixjQUFjLFNBQVMsVUFBVSxZQUFZO0FBQUEsYUFBRSxFQUN2RSxJQUFJLE9BQUs7QUFDTixxQkFBTyxPQUFPO0FBQUEsZ0JBQ1YsTUFBTTtBQUFBLGdCQUNOLE9BQU8sVUFBVSxrQkFBa0IsS0FBSyxRQUFRLFFBQVEsTUFBTSxFQUFFLFVBQVUsUUFBVyxLQUFLLFNBQVMsQ0FBQyxDQUFDO0FBQUEsY0FDekcsQ0FBQztBQUFBLFlBQ0wsQ0FBQztBQUNMLG1CQUFPO0FBQUEsVUFDWCxPQUFPO0FBQ0gsbUJBQU8sTUFDRixJQUFJLE9BQUs7QUE5TWxDO0FBK000QixrQkFBSSxRQUE0QjtBQUNoQyxrQkFBSSxTQUFTLGFBQUssVUFBTCxvQkFBWSxRQUFRLGtCQUFpQjtBQUM5Qyx3QkFBUSxJQUFJLFNBQVMsUUFBUSxVQUFVLEtBQUssTUFBTSxRQUFRLGlCQUFpQixFQUFFLE1BQU0sS0FBSyxFQUFFLElBQUksQ0FBQztBQUFBLGNBQ25HO0FBQ0EscUJBQU8sT0FBTyxFQUFFLE1BQU0sV0FBVyxPQUFPLFVBQVUsa0JBQWtCLEtBQUssUUFBUSxRQUFRLE1BQU0sRUFBRSxVQUFVLFFBQVcsS0FBSyxFQUFFLENBQUM7QUFBQSxZQUNsSSxDQUFDO0FBQUEsVUFDVDtBQUFBLFFBQ0osT0FBTztBQUNILGlCQUFPLENBQUM7QUFBQSxRQUNaO0FBQUEsTUFDSjtBQUFDO0FBQ0QsYUFBTyxDQUFDO0FBQUEsSUFDWjtBQUFBO0FBQUEsRUFFQSxpQkFBaUIsWUFBOEIsSUFBdUI7QUE3TjFFO0FBOE5RLE9BQUcsU0FBUyxlQUFlO0FBQzNCLE9BQUcsU0FBUyxXQUFXO0FBQ3ZCLFVBQU0sQ0FBQyxVQUFVLFNBQVMsR0FBRyxXQUFXLFFBQVEsUUFBUSxTQUFTLEVBQUUsRUFBRSxRQUFRLFNBQVMsRUFBRSxFQUFFLE1BQU0sR0FBRztBQUNuRyxVQUFNLGFBQWEsS0FBSyxPQUFPLElBQUksY0FBYyxxQkFBcUIsVUFBVSxLQUFLLFFBQVMsS0FBSyxJQUFJO0FBQ3ZHLFVBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBQ3hELFFBQUksU0FBUyxLQUFLLFNBQVMsS0FBSyxNQUFNLFFBQVEsbUJBQW1CLFlBQVk7QUFDekUsVUFBSSxPQUFPO0FBQ1AsY0FBTSxzQkFBc0IsR0FBRyxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNuRSw0QkFBb0IsVUFBVSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzdDLGNBQU0sV0FBVyxvQkFBb0IsVUFBVSxFQUFFLEtBQUssMkJBQTJCLENBQUM7QUFDbEYsaUJBQVMsUUFBUSxRQUFRO0FBQUEsTUFDN0IsT0FBTztBQUNILFdBQUcsUUFBUSxJQUFJLFNBQVMsUUFBUSxVQUFVLEtBQUssTUFBTSxRQUFRLGlCQUFpQixFQUFFLE1BQU0sS0FBSyxXQUFXLElBQUksQ0FBQyxDQUFDO0FBQUEsTUFDaEg7QUFBQSxJQUNKLE9BQU87QUFDSCxTQUFHLFFBQVEsUUFBUTtBQUFBLElBQ3ZCO0FBQUEsRUFDSjtBQUFBLEVBRUEsQUFBTSxpQkFBaUIsWUFBOEIsT0FBa0Q7QUFBQTtBQWpQM0c7QUFrUFEsWUFBTSxhQUFhLEtBQUssT0FBTyxJQUFJLFVBQVUsb0JBQW9CLDhCQUFZO0FBQzdFLFVBQUksQ0FBQyxZQUFZO0FBQ2I7QUFBQSxNQUNKO0FBQUM7QUFDRCxZQUFNLFNBQVMsV0FBVztBQUMxQixZQUFNLGFBQWEsT0FBTyxRQUFRLEtBQUssUUFBUyxNQUFNLElBQUk7QUFDMUQsWUFBTSxPQUFPLFdBQUssWUFBTCxtQkFBYztBQUMzQixZQUFNLFdBQVcsWUFBSyxZQUFMLG1CQUFjLE9BQU8sWUFBWSxPQUFNO0FBQ3hELFlBQU0sWUFBWSxXQUFXO0FBQzdCLFlBQU0sUUFBUSxXQUFLLE9BQU8sSUFBSSxRQUFRLFFBQVEsYUFBaEMsbUJBQTBDO0FBRXhELFlBQU0sUUFBUSxDQUFDLFNBQWlCO0FBQzVCLGVBQU8sNkJBQU0sUUFBUSxVQUFVO0FBQUEsTUFDbkM7QUFFQSxVQUFJLEtBQUssaUJBQWlCLE1BQU07QUFDNUIsWUFBSTtBQUNBLGNBQUksdUJBQXVCLEtBQUssUUFBUyxNQUFNO0FBQy9DLGNBQUkscUJBQXFCLEtBQUssUUFBUyxNQUFNO0FBQzdDLGlCQUFPLENBQUMsT0FBTyxRQUFRLG9CQUFvQixFQUFFLFdBQVcsR0FBRyxZQUFZLEtBQ2hFLHVCQUF1QjtBQUMxQixtQ0FBdUIsdUJBQXVCO0FBQ2xELGlCQUFPLENBQUMsT0FBTyxRQUFRLHFCQUFxQixDQUFDLEVBQUUsU0FBUyxHQUFHLEtBQ3BELENBQUUsUUFBTyxRQUFRLHFCQUFxQixDQUFDLE1BQU0sVUFDN0MscUJBQXFCLEtBQUssS0FBSyxRQUFTLE9BQU8sU0FBUztBQUMzRCxpQ0FBcUIscUJBQXFCO0FBQzlDLGdCQUFNLGtCQUFrQixPQUFPLFNBQzNCLEVBQUUsTUFBTSxzQkFBc0IsSUFBSSxFQUFFLEdBQ3BDLEVBQUUsTUFBTSxvQkFBb0IsSUFBSSxPQUFPLFFBQVEsa0JBQWtCLEVBQUUsT0FBTyxDQUFDO0FBQy9FLGNBQUksY0FBd0QsaUNBQVUsZUFBZTtBQUNyRixjQUFJLENBQUMsTUFBTSxjQUFjLE9BQU8sUUFBUSxXQUFXLEVBQUU7QUFDckQsY0FBSTtBQUNKLGNBQUksS0FBSyxTQUFTLEtBQUssTUFBTSxXQUFXLEtBQUssTUFBTSxNQUFNLHVCQUF5QjtBQUM5RSxrQkFBTSxlQUFlLElBQUksYUFBYSxLQUFLLE1BQU0sTUFBTSxLQUFLLFFBQVEsS0FBSyxLQUFLO0FBQzlFLGtCQUFNLFdBQVcsYUFDWixlQUFlLE1BQU0sS0FBSyxXQUFLLFlBQUwsbUJBQWMsS0FBSyxJQUFJLENBQUM7QUFFdkQsZ0JBQUksY0FBd0IsQ0FBQyxXQUFXLEtBQUs7QUFDN0MsZ0JBQUksT0FBTyxjQUFjLFVBQVU7QUFDL0IsNEJBQWMsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sVUFBVSxHQUFHLEdBQUcsV0FBVyxFQUN2RCxPQUFPLFVBQVEsU0FBUSxTQUFTLElBQUksQ0FBQyxDQUFDLENBQUM7QUFBQSxZQUNoRCxXQUFXLE1BQU0sUUFBUSxVQUFVLEdBQUc7QUFDbEMsNEJBQWMsQ0FBQyxHQUFHLElBQUksSUFBSTtBQUFBLGdCQUN0QixHQUFHLFdBQ0UsT0FBTyxPQUFLLENBQUMsQ0FBQyxDQUFDLEVBQ2YsSUFBSSxXQUFTLE1BQU0sS0FBSyxDQUFDO0FBQUEsZ0JBQzlCLEdBQUc7QUFBQSxjQUNQLEVBQUUsT0FBTyxVQUFRLFNBQVEsU0FBUyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQUEsWUFDN0M7QUFDQSx1QkFBVyxHQUFHLFNBQVMsWUFBWSxJQUFJLFdBQVM7QUFBQSxNQUFTLE1BQU0sS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFO0FBQUEsVUFDcEYsV0FBVyxjQUFjLFVBQVUsS0FBSyxPQUFPLFNBQVMsMkJBQTJCLHVCQUF5QjtBQUN4RyxnQkFBSSxjQUF3QixDQUFDLFdBQVcsS0FBSztBQUU3QyxrQkFBTSxXQUFVLE9BQU8sS0FBSyxLQUFLLE9BQU8sSUFBSSxjQUFjLFFBQVEsQ0FBQyxFQUFFLElBQUksT0FBSyxFQUFFLFFBQVEsTUFBTSxFQUFFLENBQUM7QUFDakcsZ0JBQUksT0FBTyxjQUFjLFVBQVU7QUFDL0IsNEJBQWMsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sVUFBVSxHQUFHLEdBQUcsV0FBVyxFQUN2RCxPQUFPLFVBQVEsU0FBUSxTQUFTLElBQUksQ0FBQyxDQUFDLENBQUM7QUFBQSxZQUNoRCxXQUFXLE1BQU0sUUFBUSxVQUFVLEdBQUc7QUFDbEMsNEJBQWMsQ0FBQyxHQUFHLElBQUksSUFBSTtBQUFBLGdCQUN0QixHQUFHLFdBQ0UsT0FBTyxPQUFLLENBQUMsQ0FBQyxDQUFDLEVBQ2YsSUFBSSxXQUFTLE1BQU0sS0FBSyxDQUFDO0FBQUEsZ0JBQzlCLEdBQUc7QUFBQSxjQUNQLEVBQUUsT0FBTyxVQUFRLFNBQVEsU0FBUyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQUEsWUFDN0M7QUFDQSx1QkFBVyxHQUFHLFNBQVMsWUFBWSxJQUFJLFdBQVM7QUFBQSxNQUFTLE1BQU0sS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFO0FBQUEsVUFDcEYsT0FBTztBQUVILGdCQUFJLENBQUMsWUFBWTtBQUNiLHlCQUFXLE9BQU8sT0FBTyxXQUFXO0FBQUEsWUFDeEMsV0FBVyxPQUFPLGNBQWMsVUFBVTtBQUN0QyxrQkFBSSxDQUFDLFdBQVcsU0FBUyxHQUFHLEdBQUc7QUFDM0IsMkJBQVcsT0FBTyxPQUFPLFdBQVc7QUFBQSxjQUN4QyxPQUFPO0FBQ0gsc0JBQU0sa0JBQWtCLFdBQVcsTUFBTSxHQUFHLEVBQUUsSUFBSSxPQUFLLEVBQUUsS0FBSyxDQUFDLEVBQUUsTUFBTSxHQUFHLEVBQUU7QUFDNUUsMkJBQVcsT0FBTyxRQUFRLGdCQUFnQixLQUFLLElBQUksSUFBSSxPQUFPLE1BQU0sV0FBVyxLQUFLLElBQUk7QUFBQSxjQUM1RjtBQUFBLFlBQ0osV0FBVyxNQUFNLFFBQVEsVUFBVSxHQUFHO0FBQ2xDLGtCQUFJLFdBQVcsU0FBUyxJQUFJLEtBQUssV0FBVyxTQUFTLEtBQUssR0FBRztBQUV6RCwyQkFBVyxPQUFPLFFBQVEsQ0FBQyxHQUFHLFlBQVksTUFBTSxXQUFXLEtBQUssQ0FBQyxFQUFFLEtBQUssSUFBSSxJQUFJO0FBQUEsY0FDcEYsT0FBTztBQUVILDJCQUFXLE9BQU8sUUFBUSxDQUFDLEdBQUcsV0FBVyxNQUFNLEdBQUcsRUFBRSxHQUFHLE1BQU0sV0FBVyxLQUFLLENBQUMsRUFBRSxLQUFLLElBQUksSUFBSTtBQUFBLGNBQ2pHO0FBQUEsWUFDSixPQUFPO0FBQ0gseUJBQVcsT0FBTyxRQUFRLENBQUMsR0FBRyxVQUFVLEVBQUUsS0FBSyxJQUFJLElBQUk7QUFBQSxZQUMzRDtBQUFBLFVBQ0o7QUFDQSxpQkFBTyxhQUFhLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixJQUFJLEVBQUUsR0FBRyxFQUFFLE1BQU0sb0JBQW9CLElBQUksT0FBTyxRQUFRLGtCQUFrQixFQUFFLE9BQU8sQ0FBQztBQUVoSixjQUFJLENBQUUsYUFBSyxVQUFMLG1CQUFZLFdBQVcsS0FBSyxhQUFZLDBCQUN2QyxDQUFFLGVBQWMsVUFBVSxLQUFLLE9BQU8sU0FBUywyQkFBMkIsMEJBQ3pFLE9BQU0sUUFBUSxVQUFVLEtBQUssT0FBTyxlQUFlLFlBQVksV0FBVyxTQUFTLEdBQUcsSUFBSTtBQUM5RixtQkFBTyxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsSUFBSSxTQUFTLFNBQVMsRUFBRSxDQUFDO0FBQUEsVUFDNUUsT0FBTztBQUNILGdCQUFJLHNCQUFxQixLQUFLLFFBQVMsTUFBTTtBQUM3QyxtQkFBTyxDQUFDLE9BQU8sUUFBUSxzQkFBcUIsQ0FBQyxFQUFFLFNBQVMsR0FBRyxLQUFLLENBQUUsUUFBTyxRQUFRLHNCQUFxQixDQUFDLE1BQU0sUUFBUTtBQUNqSCxxQkFBTyxRQUFRLG1CQUFrQjtBQUFHLG9DQUFxQixzQkFBcUI7QUFBQSxZQUNsRjtBQUNBLG1CQUFPLFVBQVUsRUFBRSxNQUFNLHFCQUFvQixJQUFJLE9BQU8sUUFBUSxtQkFBa0IsRUFBRSxPQUFPLENBQUM7QUFBQSxVQUNoRztBQUFBLFFBQ0osU0FBUyxPQUFQO0FBQ0Usa0JBQVEsSUFBSSxLQUFLO0FBQ2pCLGNBQUkseUJBQU8saUNBQWlDLEdBQUk7QUFDaEQsZUFBSyxNQUFNO0FBQ1g7QUFBQSxRQUNKO0FBQUEsTUFDSixXQUFXLEtBQUssY0FBYyxLQUFLLFNBQVMsTUFBTTtBQUU5QyxZQUFJLGNBQWM7QUFDbEIsZUFBTyxDQUFDLENBQUMsS0FBSyxHQUFHLEVBQUUsU0FBUyxZQUFZLE9BQU8sWUFBWSxTQUFTLENBQUMsQ0FBQyxHQUFHO0FBQ3JFLHdCQUFjLFlBQVksTUFBTSxHQUFHLEVBQUU7QUFBQSxRQUN6QztBQUNBLGVBQU8sYUFBYSxHQUFHLGNBQWMsTUFBTSxXQUFXLEtBQUssUUFBUSxXQUFXLE9BQzFFLEVBQUUsTUFBTSxLQUFLLFFBQVMsTUFBTSxNQUFNLElBQUksRUFBRSxHQUFHLEtBQUssUUFBUyxHQUFHO0FBQUEsTUFDcEUsV0FBVyxLQUFLLGNBQWMsS0FBSyxTQUFTLE1BQU07QUFFOUMsWUFBSSxlQUFlLFdBQVcsTUFBTSxHQUFHLFFBQVE7QUFDL0MsWUFBSSxjQUFjLFdBQVcsTUFBTSxRQUFRO0FBQzNDLFlBQUksZUFBZTtBQUNuQixZQUFJLHFCQUFxQjtBQUN6QixlQUFPLENBQUMsYUFBYSxTQUFTLElBQUksS0FBSyxDQUFDLGFBQWEsU0FBUyxHQUFHLEtBQUssYUFBYSxRQUFRO0FBQ3ZGLHlCQUFlLGVBQWU7QUFDOUIsK0JBQXFCLHFCQUFxQjtBQUMxQyx5QkFBZSxhQUFhLE1BQU0sR0FBRyxFQUFFO0FBQUEsUUFDM0M7QUFDQSxZQUFJLGlCQUFpQjtBQUNyQixlQUFPLENBQUMsV0FBVyxXQUFXLEVBQUUsTUFBTSxhQUFhLEtBQUssWUFBWSxRQUFRO0FBQ3hFLDJCQUFpQixpQkFBaUI7QUFDbEMsd0JBQWMsWUFBWSxNQUFNLGlCQUFpQixRQUFRO0FBQUEsUUFDN0Q7QUFDQSxlQUFPLGFBQ0gsV0FBVyxPQUNYLEVBQUUsTUFBTSxLQUFLLFFBQVMsTUFBTSxNQUFNLElBQUksYUFBYSxHQUNuRCxFQUFFLE1BQU0sS0FBSyxRQUFTLE1BQU0sTUFBTSxJQUFJLGVBQWUsQ0FDekQ7QUFDQSxlQUFPLFVBQVUsRUFBRSxNQUFNLEtBQUssUUFBUyxNQUFNLE1BQU0sSUFBSSxpQkFBaUIscUJBQXFCLFdBQVcsTUFBTSxPQUFPLENBQUM7QUFBQSxNQUMxSDtBQUNBLFdBQUssWUFBWTtBQUNqQixXQUFLLE1BQU07QUFBQSxJQUNmO0FBQUE7QUFDSjs7O0E1SmpYQSxJQUFxQixlQUFyQixjQUEwQyx5QkFBTztBQUFBLEVBQWpEO0FBQUE7QUFHQyxTQUFPLG9CQUFrQyxDQUFDO0FBQzFDLFNBQU8sMEJBQWlELENBQUM7QUFBQTtBQUFBLEVBUXpELEFBQU0sU0FBd0I7QUFBQTtBQUM3QixjQUFRLElBQUksc0JBQXNCO0FBQ2xDLFVBQUksQ0FBQyxLQUFLLElBQUksUUFBUSxlQUFlLElBQUksVUFBVSxLQUVsRCxLQUFLLElBQUksUUFBUSxRQUFRLGVBQWUsQ0FBQyxLQUFLLElBQUksUUFBUSxRQUFRLFlBQVksU0FBUyxrQkFDdEY7QUFDRCxZQUFJLHlCQUNIO0FBQUE7QUFBQTtBQUFBLDZDQUc4QyxHQUFLO0FBQUEsTUFDckQ7QUFFQSxZQUFNLEtBQUssYUFBYTtBQUN4QixVQUFJLEtBQUssU0FBUyxvQkFBb0I7QUFBVyxjQUFNLEFBQWtCLHNCQUFzQixJQUFJO0FBQ25HLFVBQUksS0FBSyxTQUFTLG9CQUFvQjtBQUFHLGNBQU0sQUFBa0Isc0JBQXNCLElBQUk7QUFHM0YsV0FBSyxhQUFhLEtBQUssU0FBUyxJQUFJLFdBQVcsTUFBTSxLQUFLLE1BQU07QUFBQSxNQUFFLENBQUMsQ0FBQztBQUNwRSxXQUFLLGtCQUFrQixLQUFLLFNBQVMsSUFBSSxnQkFBZ0IsTUFBTSxLQUFLLE1BQU07QUFBQSxNQUFFLENBQUMsQ0FBQztBQUM5RSxXQUFLLGNBQWMsS0FBSyxTQUFTLElBQUksWUFBWSxNQUFNLEtBQUssTUFBTTtBQUFBLE1BQUUsQ0FBQyxDQUFDO0FBQ3RFLFdBQUssY0FBYyxLQUFLLFNBQVMsSUFBSSxZQUFZLElBQUksQ0FBQztBQUd0RCxXQUFLLFNBQVMsYUFBYSxRQUFRLFVBQVE7QUFDMUMsY0FBTSxXQUFXLElBQUksY0FBTTtBQUMzQixlQUFPLE9BQU8sVUFBVSxJQUFJO0FBQzVCLGFBQUssa0JBQWtCLEtBQUssUUFBUTtBQUFBLE1BQ3JDLENBQUM7QUFFRCxXQUFLLFNBQVMsaUJBQWlCLFFBQVEsV0FBUztBQUMvQyxjQUFNLGlCQUFpQixJQUFJLHVCQUFlO0FBQzFDLGVBQU8sT0FBTyxnQkFBZ0IsS0FBSztBQUNuQyxhQUFLLHdCQUF3QixLQUFLLGNBQWM7QUFBQSxNQUNqRCxDQUFDO0FBRUQsV0FBSyxjQUFjLElBQUksdUJBQXVCLElBQUksQ0FBQztBQUduRCxXQUFLLHNCQUFzQixJQUFJLGFBQWEsSUFBSSxDQUFDO0FBQ2pELFdBQUssTUFBTSxJQUFJLGdCQUFnQixJQUFJLEVBQUUsS0FBSztBQUcxQyxXQUFLLGNBQ0osS0FBSyxJQUFJLFVBQVUsR0FBRyxzQkFBc0IsQ0FBQyxTQUFTO0FBQ3JELGNBQU0sT0FBTyw2QkFBTTtBQUNuQixvQkFBWSxNQUFNLElBQUk7QUFBQSxNQUN2QixDQUFDLENBQ0Y7QUFDQSxXQUFLLGNBQ0osS0FBSyxJQUFJLFVBQVUsR0FBRyx5QkFBeUIsTUFBTTtBQUNwRCxvQkFBWSxNQUFNLE1BQVM7QUFBQSxNQUM1QixDQUFDLENBQ0Y7QUFHQSxrQkFBWSxNQUFNLEtBQUssSUFBSSxVQUFVLG9CQUFvQiw4QkFBWSxDQUFDO0FBQUEsSUFDdkU7QUFBQTtBQUFBLEVBUUEsQUFBTSxlQUFlO0FBQUE7QUFDcEIsV0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFBQSxJQUMxRTtBQUFBO0FBQUEsRUFFQSxBQUFNLGVBQWU7QUFBQTtBQUNwQixXQUFLLFNBQVMsZUFBZSxLQUFLO0FBQ2xDLFdBQUssU0FBUyxtQkFBbUIsS0FBSztBQUN0QyxZQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFDakMsWUFBTSxLQUFLLFdBQVcsVUFBVSxXQUFXLE1BQU0sS0FBSztBQUN0RCxXQUFLLFlBQVksZ0JBQWdCO0FBQUEsSUFDbEM7QUFBQTtBQUFBLEVBRUEsV0FBVztBQUNWLFlBQVEsSUFBSSx3QkFBd0I7QUFBQSxFQUNyQztBQUNEOyIsCiAgIm5hbWVzIjogW10KfQo=
